/*! Moment Duration Format v1.2.2
 *  https://github.com/jsmreese/moment-duration-format 
 *  Date: 2014-07-10
 *
 *  Duration format plugin function for the Moment.js library
 *  http://momentjs.com/
 *
 *  Copyright 2014 John Madhavan-Reese
 *  Released under the MIT license
 */
(function(c,a){function h(k){var e;k=parseInt(k,10);if(!k||k<1){return""}e="";while(k){e+="0";k-=1}return e}function d(l,e,k){if(l==null){l=""}l=""+l;return(k?l:"")+h(e-l.length)+(k?"":l)}function f(m,l){var e=m.length,k;while(e--){if(l(m[e])>0){k=m[e];break}}return k}var j,g,i=(typeof require==="function");if(i){try{g=require("lodash")}catch(b){g=require("underscore")}}else{if(c._){g=c._}else{throw"Moment Duration Format cannot find Lo-Dash or Underscore"}}if(i){j=require("moment")}else{if(c.moment){j=c.moment}else{throw"Moment Duration Format cannot find Moment.js"}}j.duration.fn.format=function(){var r,q,m,e,n,o,l,p=[].slice.call(arguments),k=g.extend({},this.format.defaults),s=j.duration(this);k.duration=this;g.each(p,function(t){if(typeof t==="string"||typeof t==="function"){k.template=t;return}if(typeof t==="number"){k.precision=t;return}if(g.isObject(t)){g.extend(k,t)}});m=k.types=(g.isArray(k.types)?k.types:k.types.split(" "));if(typeof k.template==="function"){k.template=k.template.apply(k)}r=new RegExp(g.map(m,function(t){return k[t].source}).join("|"),"g");e=function(t){return g.find(m,function(u){return k[u].test(t)})};q=g.map(k.template.match(r),function(u,t){var v=e(u),w=u.length;return{index:t,length:w,token:(v==="escape"?u.replace(k.escape,"$1"):u),type:((v==="escape"||v==="general")?null:v)}},this);n=g.intersection(m,g.unique(g.compact(g.pluck(q,"type"))));if(!n.length){return g.pluck(q,"token").join("")}g.each(n,function(t,v){var z,w,y,x,u;z=s.as(t);w=(z>0?Math.floor(z):Math.ceil(z));y=z-w;x=((v+1)===n.length);u=(!v);g.each(q,function(A){if(A.type===t){g.extend(A,{value:z,wholeValue:w,decimalValue:y,isLeast:x,isMost:u});if(u){if(k.forceLength==null&&A.length>1){k.forceLength=true}}}});s.subtract(w,t)});if(k.trim){o=false;l=g[k.trim==="left"?"reduce":"reduceRight"](q,function(v,u,t){if(!(o||(u.isLeast||(u.type!=null&&u.wholeValue)))){return t}o=true;return v},-1);if(l!==-1){q=g[k.trim==="left"?"rest":"first"](q,k.trim==="left"?l+1:l)}}o=false;if(k.trim==="right"){q.reverse()}q=g.map(q,function(t){var v,u;if(!t.type){return t.token}if(t.isLeast&&(k.precision<0)){v=(Math.floor(t.wholeValue*Math.pow(10,k.precision))*Math.pow(10,-k.precision)).toString()}else{v=t.wholeValue.toString()}v=v.replace(/^\-/,"");if(t.length>1&&(o||t.isMost||k.forceLength)){v=d(v,t.length)}if(t.isLeast&&(k.precision>0)){u=t.decimalValue.toString().replace(/^\-/,"").split(/\.|e\-/);switch(u.length){case 1:v+="."+d(u[0],k.precision,true).slice(0,k.precision);break;case 2:v+="."+d(u[1],k.precision,true).slice(0,k.precision);break;case 3:v+="."+d(h((+u[2])-1)+(u[0]||"0")+u[1],k.precision,true).slice(0,k.precision);break;default:throw"Moment Duration Format: unable to parse token decimal value."}}if(t.isMost&&t.value<0){v="-"+v}o=true;return v});if(k.trim==="right"){q.reverse()}return q.join("")};j.duration.fn.format.defaults={escape:/\[(.+?)\]/,years:/[Yy]+/,months:/M+/,weeks:/[Ww]+/,days:/[Dd]+/,hours:/[Hh]+/,minutes:/m+/,seconds:/s+/,milliseconds:/S+/,general:/.+?/,types:"escape years months weeks days hours minutes seconds milliseconds general",trim:"left",precision:0,forceLength:null,template:function(){var e=this.types,l=this.duration,k;if(typeof g.findLast==="function"){k=g.findLast(e,function(m){return l._data[m]})}else{k=f(e,function(m){return l._data[m]})}switch(k){case"seconds":return"h:mm:ss";case"minutes":return"d[d] h:mm";case"hours":return"d[d] h[h]";case"days":return"M[m] d[d]";case"weeks":return"y[y] w[w]";case"months":return"y[y] M[m]";case"years":return"y[y]";default:return"y[y] M[m] d[d] h:mm:ss"}}}})(this);