/**
* @author Jason Dobry <jason.dobry@gmail.com>
* @file js-data-angular.min.js
* @version 2.2.2 - Homepage <https://www.js-data.io/js-data-angular/>
* @copyright (c) 2014-2015 Jason Dobry <https://github.com/jmdobry/>
* @license MIT <https://github.com/js-data/js-data-angular/blob/master/LICENSE>
*
* @overview Angular wrapper for js-data.
*/

!function(a,b){"use strict";"function"==typeof define&&define.amd?define(["angular","js-data"],function(c,d){return b(a,c,d,void 0)}):"object"==typeof exports&&"object"==typeof module?module.exports=b(a,require("angular")||a.angular,require("js-data")||a.JSData,void 0):"object"==typeof exports?exports.jsDataAngularModuleName=b(a,require("angular")||a.angular,require("js-data")||a.JSData,void 0):a.jsDataAngularModuleName=b(a,a.angular,a.JSData,void 0)}(this,function(a,b,c,d){"use strict";function e(){}function f(a){this.defaults=new e,i(this.defaults,a)}function g(c){var d;try{d=require(c.project)}catch(e){}d||(d=a[c["class"]]),d&&("http"===c.name&&(j=!0),c.loaded=!0,b.module("js-data").provider(c["class"],function(){var a=this;a.defaults={},a.$get=[function(){return new d(a.defaults)}]}))}if(!c||!b)throw new Error("js-data and angular must be loaded!");var h=c.DSUtils,i=h.deepMixIn,j=!1,k=[{project:"js-data-http",name:"http","class":"DSHttpAdapter"},{project:"js-data-localstorage",name:"localstorage","class":"DSLocalStorageAdapter"},{project:"js-data-localforage",name:"localforage","class":"DSLocalForageAdapter"},{project:"js-data-firebase",name:"firebase","class":"DSFirebaseAdapter"}],l=["compute","digest","eject","inject","link","linkAll","linkInverse","unlinkInverse"];b.module("js-data",["ng"]).value("DSUtils",c.DSUtils).value("DSErrors",c.DSErrors).provider("DS",function(){function a(){function a(a){var c=i.defer();try{a.call(d,b.bind(c,c.resolve),b.bind(c,c.reject))}catch(e){c.reject(e)}return c.promise}var f=Array.prototype.slice.call(arguments),g=f[f.length-2],i=f[f.length-1],j=new c.DS(e.defaults),m={};if(a.all=i.all,a.when=i.when,a.reject=i.reject,h.Promise=a,f.length)for(var n=0;n<f.length;n++)for(var o=0;o<k.length;o++)k[o].loaded&&!k[o].registered&&(k[o].registered=!0,j.registerAdapter(k[o].name,f[n]));for(var p=0;p<l.length;p++)m[l[p]]=j[l[p]],j[l[p]]=function(a){return function(){var b=arguments;return g.$$phase?m[a].apply(j,b):g.$apply(function(){return m[a].apply(j,b)})}}(l[p]);return("function"!=typeof Object.observe||"function"!=typeof Array.observe)&&g.$watch(function(){j.observe.Platform.performMicrotaskCheckpoint()}),j}for(var e=this,f=c.DSErrors,g=[],i=0;i<k.length;i++)k[i].loaded&&g.push(k[i]["class"]);e.defaults={},c.DS.prototype.bindAll=function(a,b,c,d,e){var g=this;if(b=b||{},!g.definitions[a])throw new f.NER(a);if(!h.isObject(b))throw new f.IA('"params" must be an object!');if(!h.isObject(c))throw new f.IA('"scope" must be an object!');if(!h.isString(d))throw new f.IA('"expr" must be a string!');try{return c.$watch(function(){return g.lastModified(a)},function(){var f=g.filter(a,b);h.set(c,d,f),e&&e(null,f)})}catch(i){if(!e)throw i;e(i)}},c.DS.prototype.bindOne=function(a,b,c,d,e){var g=this;if(b=h.resolveId(g.definitions[a],b),!g.definitions[a])throw new f.NER(a);if(!h.isString(b)&&!h.isNumber(b))throw new f.IA('"id" must be a string or a number!');if(!h.isObject(c))throw new f.IA('"scope" must be an object!');if(!h.isString(d))throw new f.IA('"expr" must be a string!');try{return c.$watch(function(){return g.lastModified(a,b)},function(){var f=g.get(a,b);h.set(c,d,f),e&&e(null,f)})}catch(i){if(!e)throw i;e(i)}},g.push("$rootScope"),g.push("$q"),g.push(a),e.$get=g});for(var m=0;m<k.length;m++)g(k[m]);if(!j){var n=e.prototype;n.queryTransform=function(a,b){return b},n.basePath="",n.forceTrailingSlash="",n.httpConfig={},n.log=console?function(a,b){console["function"==typeof console.info?"info":"log"](a,b)}:function(){},n.error=console?function(a,b){console["function"==typeof console.error?"error":"log"](a,b)}:function(){},n.deserialize=function(a,b){return b&&"data"in b?b.data:b},n.serialize=function(a,b){return b};var o=f.prototype;o.getPath=function(a,b,c,d){var e=this;d=d||{};var f=[d.basePath||e.defaults.basePath||b.basePath,b.getEndpoint(h.isString(c)||h.isNumber(c)||"create"===a?c:null,d)];return("find"===a||"update"===a||"destroy"===a)&&f.push(c),h.makePath.apply(h,f)},o.GET=function(a,b){return b=b||{},"method"in b||(b.method="get"),this.HTTP(i(b,{url:a}))},o.POST=function(a,b,c){return c=c||{},c=h.copy(c),"method"in c||(c.method="post"),this.HTTP(i(c,{url:a,data:b}))},o.PUT=function(a,b,c){return c=c||{},"method"in c||(c.method="put"),this.HTTP(i(c,{url:a,data:b||{}}))},o.DEL=function(a,b){return b=b||{},"method"in b||(b.method="delete"),this.HTTP(i(b,{url:a}))},o.find=function(a,b,d){var e=this;return d=d||{},d.suffix=d.suffix||a.suffix,d.params=d.params||{},d.params=e.defaults.queryTransform(a,d.params),e.GET(e.getPath("find",a,b,d),d).then(function(b){var f=(d.deserialize?d.deserialize:e.defaults.deserialize)(a,b);return f?f:c.DSUtils.Promise.reject(new Error("Not Found!"))})},o.findAll=function(a,b,c){var d=this;return c=c||{},c=h.copy(c),c.suffix=c.suffix||a.suffix,c.params=c.params||{},b&&(b=d.defaults.queryTransform(a,b),i(c.params,b)),d.GET(d.getPath("findAll",a,b,c),c).then(function(b){return(c.deserialize?c.deserialize:d.defaults.deserialize)(a,b)})},o.create=function(a,b,c){var d=this;return c=c||{},c.suffix=c.suffix||a.suffix,c.params=c.params||{},c.params=d.defaults.queryTransform(a,c.params),d.POST(d.getPath("create",a,b,c),(c.serialize?c.serialize:d.defaults.serialize)(a,b),c).then(function(b){return(c.deserialize?c.deserialize:d.defaults.deserialize)(a,b)})},o.update=function(a,b,c,d){var e=this;return d=d||{},d.suffix=d.suffix||a.suffix,d.params=d.params||{},d.params=e.defaults.queryTransform(a,d.params),e.PUT(e.getPath("update",a,b,d),(d.serialize?d.serialize:e.defaults.serialize)(a,c),d).then(function(b){return(d.deserialize?d.deserialize:e.defaults.deserialize)(a,b)})},o.updateAll=function(a,b,c,d){var e=this;return d=d||{},d=h.copy(d),d.suffix=d.suffix||a.suffix,d.params=d.params||{},c&&(c=e.defaults.queryTransform(a,c),i(d.params,c)),this.PUT(e.getPath("updateAll",a,b,d),(d.serialize?d.serialize:e.defaults.serialize)(a,b),d).then(function(b){return(d.deserialize?d.deserialize:e.defaults.deserialize)(a,b)})},o.destroy=function(a,b,c){var d=this;return c=c||{},c.suffix=c.suffix||a.suffix,c.params=c.params||{},c.params=d.defaults.queryTransform(a,c.params),d.DEL(d.getPath("destroy",a,b,c),c).then(function(b){return(c.deserialize?c.deserialize:d.defaults.deserialize)(a,b)})},o.destroyAll=function(a,b,c){var d=this;return c=c||{},c=h.copy(c),c.suffix=c.suffix||a.suffix,c.params=c.params||{},b&&(b=d.defaults.queryTransform(a,b),i(c.params,b)),this.DEL(d.getPath("destroyAll",a,b,c),c).then(function(b){return(c.deserialize?c.deserialize:d.defaults.deserialize)(a,b)})},b.module("js-data").provider("DSHttpAdapter",function(){var a=this;a.defaults={},a.$get=["$http","DS","$q",function(b,c,d){o.HTTP=function(a){function c(a){var b=f.toUTCString()+" - "+a.config.method.toUpperCase()+" "+a.config.url+" - "+a.status+" "+((new Date).getTime()-f.getTime())+"ms";return a.status>=200&&a.status<300?(e.defaults.log&&e.defaults.log(b,a),a):(e.defaults.error&&e.defaults.error("FAILED: "+b,a),d.reject(a))}var e=this,f=new Date;a=i(a,e.defaults.httpConfig),e.defaults.forceTrailingSlash&&"/"!==a.url[a.url.length-1]&&(a.url+="/"),a.method=a.method.toUpperCase(),"object"==typeof a.data&&(a.data=h.removeCircular(a.data));var g=a.suffix||e.defaults.suffix;return g&&a.url.substr(a.url.length-g.length)!==g&&(a.url+=g),b(a).then(c,c)};var e=new f(a.defaults);return c.registerAdapter("http",e,{"default":!0}),e}]}),b.module("js-data").run(["DS","DSHttpAdapter",function(a,b){a.registerAdapter("http",b,{"default":!0})}])}return"js-data"});
//# sourceMappingURL=js-data-angular.min.map