"use strict";angular.module("ngAudio",[]).directive("ngAudio",["$compile","$q","ngAudio",function(e,n,i){return{restrict:"AEC",scope:{volume:"=",start:"=",currentTime:"=",loop:"=",clickPlay:"="},controller:function(e,n,t,o){var r=i.load(n.ngAudio);e.$audio=r,t.on("click",function(){e.clickPlay!==!1&&(r.audio.play(),r.volume=e.volume||r.volume,r.loop=e.loop,r.currentTime=e.start||0,o(function(){r.play()},5))})}}}]).service("localAudioFindingService",["$q",function(e){this.find=function(n){var i=e.defer(),t=document.getElementById(n);return t?i.resolve(t):i.reject(n),i.promise}}]).service("remoteAudioFindingService",["$q",function(e){this.find=function(n){var i=e.defer(),t=new Audio;return t.addEventListener("error",function(){i.reject()}),t.addEventListener("loadstart",function(){i.resolve(t)}),setTimeout(function(){t.src=n},1),i.promise}}]).service("cleverAudioFindingService",["$q","localAudioFindingService","remoteAudioFindingService",function(e,n,i){this.find=function(t){var o=e.defer();return t=t.replace("|","/"),n.find(t).then(o.resolve,function(){return i.find(t)}).then(o.resolve,o.reject),o.promise}}]).value("ngAudioGlobals",{muting:!1,songmuting:!1,performance:25,unlock:!0}).factory("NgAudioObject",["cleverAudioFindingService","$rootScope","$interval","$timeout","ngAudioGlobals",function(e,n,i,t,o){return function(t){function r(){u=n.$watch(function(){return{volume:g.volume,currentTime:g.currentTime,progress:g.progress,muting:g.muting,loop:g.loop}},function(e,n){e.currentTime!==n.currentTime&&g.setCurrentTime(e.currentTime),e.progress!==n.progress&&g.setProgress(e.progress),e.volume!==n.volume&&g.setVolume(e.volume),e.volume!==n.volume&&g.setVolume(e.volume),s=e.loop,e.muting!==n.muting&&g.setMuting(e.muting)},!0)}o.unlock&&window.addEventListener("click",function p(){l.play(),l.pause(),window.removeEventListener("click",p)});var u,c,s,l,m=!1,a=!1,d=!1,f=!1,v=!0,g=this;this.id=t,this.safeId=t.replace("/","|"),this.loop=0,this.unbind=function(){v=!1},this.play=function(){m=!0},this.pause=function(){a=!0},this.restart=function(){d=!0},this.stop=function(){this.restart()},this.setVolume=function(e){c=e},this.setMuting=function(e){f=e},this.setProgress=function(e){l&&l.duration&&(l.currentTime=l.duration*e)},this.setCurrentTime=function(e){l&&l.duration&&(l.currentTime=e)},e.find(t).then(function(e){l=e,l.addEventListener("canplay",function(){g.canPlay=!0})},function(e){g.error=!0,console.warn(e)}),i(function(){u&&u(),l&&(f||o.isMuting?l.volume=0:l.volume=void 0!==g.volume?g.volume:1,m&&(l.play(),m=!1),d&&(l.pause(),l.currentTime=0,d=!1),a&&(l.pause(),a=!1),c&&(l.volume=c,c=void 0),v&&(g.currentTime=l.currentTime,g.duration=l.duration,g.remaining=l.duration-l.currentTime,g.progress=l.currentTime/l.duration,g.paused=l.paused,g.src=l.src,s&&g.currentTime>=g.duration&&(s!==!0&&(s--,g.loop--),g.setCurrentTime(0),g.play())),f||o.isMuting||(g.volume=l.volume),g.audio=l),r()},o.performance)}}]).service("ngAudio",["NgAudioObject","ngAudioGlobals",function(e,n){this.play=function(n){var i=new e(n);return i.play(),i},this.load=function(n){return new e(n)},this.mute=function(){n.muting=!0},this.unmute=function(){n.muting=!1},this.toggleMute=function(){n.muting=!n.muting}}]);
//# sourceMappingURL=./angular.audio.min.js.map