"use strict";angular.module("ngAudio",[]).directive("ngAudio",["$compile","$q","ngAudio",function(n,e,t){return{restrict:"AEC",scope:{volume:"=",start:"=",currentTime:"=",loop:"=",clickPlay:"=",disablePreload:"="},controller:function(n,e,o,i){function r(){u=t.load(e.ngAudio,n),n.$audio=u,u.unbind()}var u;n.disablePreload||r(),o.on("click",function(){n.clickPlay!==!1&&(n.disablePreload&&r(),u.audio.play(),u.volume=n.volume||u.volume,u.loop=n.loop,u.currentTime=n.start||0,i(function(){u.play()},5))}),o.on("$destroy",function(){u.destroy()})}}}]).directive("ngAudioHover",["$compile","$q","ngAudio",function(n,e,t){return{restrict:"AEC",controller:function(n,e,o,i){var r=t.load(e.ngAudioHover,n);o.on("mouseover rollover hover",function(){r.audio.play(),r.volume=e.volumeHover||r.volume,r.loop=e.loop,r.currentTime=e.startHover||0}),o.on("$destroy",function(){r.destroy()})}}}]).service("localAudioFindingService",["$q",function(n){this.find=function(e){var t=n.defer(),o=document.getElementById(e);return o?t.resolve(o):t.reject(e),t.promise}}]).service("remoteAudioFindingService",["$q",function(n){this.find=function(e){var t=n.defer(),o=new Audio;return o.addEventListener("error",function(){t.reject()}),o.addEventListener("loadstart",function(){t.resolve(o)}),setTimeout(function(){o.src=e},1),t.promise}}]).service("cleverAudioFindingService",["$q","localAudioFindingService","remoteAudioFindingService",function(n,e,t){this.find=function(o){var i=n.defer();return o=o.replace("|","/"),e.find(o).then(i.resolve,function(){return t.find(o)}).then(i.resolve,i.reject),i.promise}}]).value("ngAudioGlobals",{muting:!1,songmuting:!1,performance:25,unlock:!0}).factory("NgAudioObject",["cleverAudioFindingService","$rootScope","$interval","$timeout","ngAudioGlobals",function(n,e,t,o,i){return function(o,r){function u(){g.play(),g.pause(),window.removeEventListener("click",u)}function c(){k||(M&&t.cancel(M),d&&d(),s&&s(),k=!0)}function a(){k||(s=S.$watch(function(){return{volume:$.volume,currentTime:$.currentTime,progress:$.progress,muting:$.muting,loop:$.loop,playbackRate:$.playbackRate}},function(n,e){n.currentTime!==e.currentTime&&$.setCurrentTime(n.currentTime),n.progress!==e.progress&&$.setProgress(n.progress),n.volume!==e.volume&&$.setVolume(n.volume),n.playbackRate!==e.playbackRate&&$.setPlaybackRate(n.playbackRate),m=n.loop,n.muting!==e.muting&&$.setMuting(n.muting)},!0))}function l(){s&&s(),g&&(T||i.isMuting?g.volume=0:g.volume=void 0!==$.volume?$.volume:1,v&&(g.play(),v=!1),h&&(g.pause(),g.currentTime=0,h=!1),p&&(g.pause(),p=!1),y&&(g.playbackRate=A,y=!1),f&&(g.volume=f,f=void 0),b&&($.currentTime=g.currentTime,$.duration=g.duration,$.remaining=g.duration-g.currentTime,$.progress=g.currentTime/g.duration,$.paused=g.paused,$.src=g.src,$.currentTime>=$.duration&&w.forEach(function(n){n($)}),m&&$.currentTime>=$.duration&&(m!==!0&&(m--,$.loop--),$.setCurrentTime(0),$.play())),T||i.isMuting||($.volume=g.volume),$.audio=g),a()}var s,d,f,m,g,v=!1,p=!1,h=!1,y=!1,A=!1,T=!1,b=!0,k=!1,S=r||e,$=this;this.id=o,this.safeId=o.replace("/","|"),this.loop=0,this.unbind=function(){b=!1},this.play=function(){return v=!0,this};var w=[];this.complete=function(n){w.push(n)},this.pause=function(){p=!0},this.restart=function(){h=!0},this.stop=function(){this.restart()},this.setVolume=function(n){f=n},this.setPlaybackRate=function(n){A=n,y=!0},this.setMuting=function(n){T=n},this.setProgress=function(n){g&&g.duration&&isFinite(n)&&(g.currentTime=g.duration*n)},this.setCurrentTime=function(n){g&&g.duration&&(g.currentTime=n)},this.destroy=c,S.$on("$destroy",function(){c()}),n.find(o).then(function(n){g=n,i.unlock&&(window.addEventListener("click",u),g.addEventListener("playing",function(){window.removeEventListener("click",u)})),g.addEventListener("canplay",function(){$.canPlay=!0})},function(n){$.error=!0,console.warn(n)});var M=t(l,i.performance);d=S.$watch(function(){return i.performance},function(){t.cancel(M),M=t(l,i.performance)})}}]).service("ngAudio",["NgAudioObject","ngAudioGlobals",function(n,e){this.play=function(e,t){var o=new n(e,t);return o.play(),o},this.load=function(e,t){return new n(e,t)},this.mute=function(){e.muting=!0},this.unmute=function(){e.muting=!1},this.toggleMute=function(){e.muting=!e.muting},this.setUnlock=function(n){e.unlock=n}}]).filter("trackTime",function(){return function(n){var e=Math.floor(0|n),t="",o=0,i=0,r=0;return e>3599?(o=Math.floor(e/3600),i=Math.floor((e-3600*o)/60),r=e-(60*i+3600*o),1==o.toString().length&&(o="0"+Math.floor(e/3600).toString()),1==i.toString().length&&(i="0"+Math.floor((e-3600*o)/60).toString()),1==r.toString().length&&(r="0"+(e-(60*i+3600*o)).toString()),t=o+":"+i+":"+r):e>59?(i=Math.floor(e/60),r=e-60*i,1==i.toString().length&&(i="0"+Math.floor(e/60).toString()),1==r.toString().length&&(r="0"+(e-60*i).toString()),t=i+":"+r):(r=e,1==r.toString().length&&(r="0"+e.toString()),t=e+"s"),"function"==typeof Number.isNaN&&Number.isNaN(t),t}});
//# sourceMappingURL=./angular.audio.min.js.map