!function(e){"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(e):"undefined"!=typeof window?window.t=e():"undefined"!=typeof global?global.t=e():"undefined"!=typeof self&&(self.t=e())}(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){module.exports={sum:require("./lib/sum"),average:require("./lib/average"),topo:require("./lib/topo"),bezier:require("./lib/bezier"),tag:require("./lib/tag"),size:require("./lib/size"),sample:require("./lib/sample"),jenks:require("./lib/jenks"),quantile:require("./lib/quantile"),save:require("./lib/save"),envelope:require("./lib/envelope"),square:require("./lib/square"),midpoint:require("./lib/midpoint"),buffer:require("./lib/buffer"),center:require("./lib/center"),centroid:require("./lib/centroid"),combine:require("./lib/combine"),contour:require("./lib/contour"),distance:require("./lib/distance"),explode:require("./lib/explode"),extent:require("./lib/extent"),bboxPolygon:require("./lib/bboxPolygon"),featurecollection:require("./lib/featurecollection"),filter:require("./lib/filter"),grid:require("./lib/grid"),inside:require("./lib/inside"),intersect:require("./lib/intersect"),linestring:require("./lib/linestring"),load:require("./lib/load"),nearest:require("./lib/nearest"),planepoint:require("./lib/planepoint"),point:require("./lib/point"),polygon:require("./lib/polygon"),quantile:require("./lib/quantile"),reclass:require("./lib/reclass"),remove:require("./lib/remove"),tin:require("./lib/tin"),union:require("./lib/union")}},{"./lib/average":2,"./lib/bboxPolygon":3,"./lib/bezier":4,"./lib/buffer":5,"./lib/center":6,"./lib/centroid":7,"./lib/combine":8,"./lib/contour":9,"./lib/distance":10,"./lib/envelope":11,"./lib/explode":12,"./lib/extent":13,"./lib/featurecollection":14,"./lib/filter":15,"./lib/grid":16,"./lib/inside":17,"./lib/intersect":18,"./lib/jenks":19,"./lib/linestring":20,"./lib/load":21,"./lib/midpoint":22,"./lib/nearest":23,"./lib/planepoint":24,"./lib/point":25,"./lib/polygon":26,"./lib/quantile":27,"./lib/reclass":28,"./lib/remove":29,"./lib/sample":30,"./lib/save":31,"./lib/size":32,"./lib/square":33,"./lib/sum":34,"./lib/tag":35,"./lib/tin":36,"./lib/topo":37,"./lib/union":38}],2:[function(require,module,exports){var t={};var _=require("lodash");t.tag=require("./tag");module.exports=function(polyFC,PtFC,field,outField,polyID,done){t.tag(ptFC,polyFC,polyID,function(err,taggedPts){});done(new Error("not implemented"))}},{"./tag":35,lodash:39}],3:[function(require,module,exports){var t={};var point=require("../lib/point"),polygon=require("../lib/polygon");t.point=point;t.polygon=polygon;module.exports=function(bbox,done){var lowLeft=t.point(bbox[0],bbox[1]);var topLeft=t.point(bbox[0],bbox[3]);var topRight=t.point(bbox[2],bbox[3]);var lowRight=t.point(bbox[2],bbox[1]);var poly=t.polygon([[lowLeft.geometry.coordinates,lowRight.geometry.coordinates,topRight.geometry.coordinates,topLeft.geometry.coordinates]]);done(null,poly)}},{"../lib/point":25,"../lib/polygon":26}],4:[function(require,module,exports){var t={};var _=require("lodash");t.linestring=require("./linestring");module.exports=function(line,resolution,intensity,done){var lineOut=t.linestring([]);lineOut.properties=line.properties;pts=[];_.each(line.geometry.coordinates,function(pt){pts.push({x:pt[0],y:pt[1]})});var spline=new Spline({points:pts,duration:resolution,sharpness:intensity});for(var i=0;i<spline.duration;i+=10){var pos=spline.pos(i);if(Math.floor(i/100)%2==0)lineOut.geometry.coordinates.push([pos.x,pos.y])}done(null,lineOut)};Spline=function(options){this.points=options.points||[];this.duration=options.duration||1e4;this.sharpness=options.sharpness||.85;this.centers=[];this.controls=[];this.stepLength=options.stepLength||60;this.length=this.points.length;this.delay=0;for(var i=0;i<this.length;i++)this.points[i].z=this.points[i].z||0;for(var i=0;i<this.length-1;i++){var p1=this.points[i];var p2=this.points[i+1];this.centers.push({x:(p1.x+p2.x)/2,y:(p1.y+p2.y)/2,z:(p1.z+p2.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(var i=0;i<this.centers.length-1;i++){var p1=this.centers[i];var p2=this.centers[i+1];var dx=this.points[i+1].x-(this.centers[i].x+this.centers[i+1].x)/2;var dy=this.points[i+1].y-(this.centers[i].y+this.centers[i+1].y)/2;var dz=this.points[i+1].z-(this.centers[i].y+this.centers[i+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[i+1].x+this.sharpness*(this.centers[i].x+dx),y:(1-this.sharpness)*this.points[i+1].y+this.sharpness*(this.centers[i].y+dy),z:(1-this.sharpness)*this.points[i+1].z+this.sharpness*(this.centers[i].z+dz)},{x:(1-this.sharpness)*this.points[i+1].x+this.sharpness*(this.centers[i+1].x+dx),y:(1-this.sharpness)*this.points[i+1].y+this.sharpness*(this.centers[i+1].y+dy),z:(1-this.sharpness)*this.points[i+1].z+this.sharpness*(this.centers[i+1].z+dz)}])}this.controls.push([this.points[this.length-1],this.points[this.length-1]]);this.steps=this.cacheSteps(this.stepLength);return this};Spline.prototype.cacheSteps=function(mindist){var steps=[];var laststep=this.pos(0);steps.push(0);for(var t=0;t<this.duration;t+=10){var step=this.pos(t);var dist=Math.sqrt((step.x-laststep.x)*(step.x-laststep.x)+(step.y-laststep.y)*(step.y-laststep.y)+(step.z-laststep.z)*(step.z-laststep.z));if(dist>mindist){steps.push(t);laststep=step}}return steps};Spline.prototype.vector=function(t){var p1=this.pos(t+10);var p2=this.pos(t-10);return{angle:180*Math.atan2(p1.y-p2.y,p1.x-p2.x)/3.14,speed:Math.sqrt((p2.x-p1.x)*(p2.x-p1.x)+(p2.y-p1.y)*(p2.y-p1.y)+(p2.z-p1.z)*(p2.z-p1.z))}};Spline.prototype.drawControlPoints=function(ctx,color){ctx.fillStyle=color||"#f60";ctx.strokeStyle="#fff";ctx.lineWidth=2;for(var i=0;i<this.length;i++){var p=this.points[i];var c1=this.controls[i][0];var c2=this.controls[i][1];ctx.beginPath();ctx.moveTo(c1.x,c1.y);ctx.lineTo(p.x,p.y);ctx.lineTo(c2.x,c2.y);ctx.stroke();ctx.beginPath();ctx.arc(c1.x,c1.y,3,0,2*Math.PI,false);ctx.fill();ctx.stroke();ctx.beginPath();ctx.arc(c2.x,c2.y,3,0,2*Math.PI,false);ctx.fill();ctx.stroke();ctx.beginPath();ctx.arc(p.x,p.y,7,0,2*Math.PI,false);ctx.fill();ctx.stroke()}return this};Spline.prototype.pos=function(time){function bezier(t,p1,c1,c2,p2){var B=function(t){var t2=t*t,t3=t2*t;return[t3,3*t2*(1-t),3*t*(1-t)*(1-t),(1-t)*(1-t)*(1-t)]};var b=B(t);var pos={x:p2.x*b[0]+c2.x*b[1]+c1.x*b[2]+p1.x*b[3],y:p2.y*b[0]+c2.y*b[1]+c1.y*b[2]+p1.y*b[3],z:p2.z*b[0]+c2.z*b[1]+c1.z*b[2]+p1.z*b[3]};return pos}var t=time-this.delay;if(t<0)t=0;if(t>this.duration)t=this.duration-1;var t2=t/this.duration;if(t2>=1)return this.points[this.length-1];var n=Math.floor((this.points.length-1)*t2);var t1=(this.length-1)*t2-n;return bezier(t1,this.points[n],this.controls[n][1],this.controls[n+1][0],this.points[n+1])};Spline.prototype.draw=function(ctx,color){ctx.strokeStyle=color||"#7e5e38";ctx.lineWidth=14;ctx.beginPath();var pos;for(var i=0;i<this.duration;i+=10){pos=this.pos(i);if(Math.floor(i/100)%2==0)ctx.lineTo(pos.x,pos.y);else ctx.moveTo(pos.x,pos.y)}ctx.stroke();return this}},{"./linestring":20,lodash:39}],5:[function(require,module,exports){var _=require("lodash");module.exports=function(point,radius,units,done){var geometry=point.geometry;var type=geometry.type;var polygon={type:"Feature",geometry:{type:"Polygon",coordinates:[]}};switch(units){case"miles":radius=radius/69.047;break;case"kilometers":radius=radius/111.12;break;case"degrees":break}switch(type){case"Point":var coordinates=[];var x=geometry.coordinates[0];var y=geometry.coordinates[1];var range=_.range(-180,180,1);for(var i in _.range(0,360)){var xC=x+radius*Math.cos(range[i]*(Math.PI/180));var yC=y+radius*Math.sin(range[i]*(Math.PI/180));coordinates.push([xC,yC])}polygon.geometry.coordinates=[coordinates];done(null,polygon);break;case"LineString":done(new Error("LineString not implemented"));break;case"Polygon":done(new Error("Polygon not implemented"));break}}},{lodash:39}],6:[function(require,module,exports){var t={};var extent=require("./extent");t.extent=extent;module.exports=function(layer,done){t.extent(layer,function(err,extent){var x=(extent[0]+extent[2])/2;var y=(extent[1]+extent[3])/2;var center={type:"Feature",geometry:{type:"Point",coordinates:[x,y]}};done(center)})}},{"./extent":13}],7:[function(require,module,exports){var t={};var _=require("lodash"),ss=require("simple-statistics");explode=require("./explode"),point=require("./point"),t.explode=explode;t.point=point;module.exports=function(features,done){t.explode(features,function(err,vertices){var averageX,averageY,xs=[],ys=[];_.each(vertices.features,function(v){xs.push(v.geometry.coordinates[0]);ys.push(v.geometry.coordinates[1])});averageX=ss.mean(xs);averageY=ss.mean(ys);done(err,t.point(averageX,averageY))})}},{"./explode":12,"./point":25,lodash:39,"simple-statistics":40}],8:[function(require,module,exports){var _=require("lodash");module.exports=function(fc,done){var type=fc.features[0].geometry.type;var err;var geometries=_.pluck(fc.features,"geometry");switch(type){case"Point":var multiPoint={type:"Feature",geometry:{type:"MultiPoint",coordinates:[]}};multiPoint.geometry.coordinates=_.pluck(geometries,"coordinates");done(err,multiPoint);break;case"LineString":var multiLineString={type:"Feature",geometry:{type:"MultiLineString",coordinates:[]}};multiLineString.geometry.coordinates=_.pluck(geometries,"coordinates");done(err,multiLineString);break;case"Polygon":var multiPolygon={type:"Feature",geometry:{type:"MultiPolygon",coordinates:[]}};multiPolygon.geometry.coordinates=_.pluck(geometries,"coordinates");done(err,multiPolygon);break}}},{lodash:39}],9:[function(require,module,exports){var t={};var _=require("lodash"),fs=require("fs");tin=require("./tin"),inside=require("./inside"),grid=require("./grid"),extent=require("./extent"),planepoint=require("./planepoint"),featurecollection=require("./featurecollection"),polygon=require("./polygon"),square=require("./square");t.tin=tin;t.inside=inside;t.grid=grid;t.extent=extent;t.planepoint=planepoint;t.featurecollection=featurecollection;t.polygon=polygon;t.square=square;module.exports=function(points,z,resolution,breaks,done){t.tin(points,z,function(err,tinResult){t.extent(points,function(err,bbox){t.square(bbox,function(err,bbox){t.grid(bbox,resolution,function(err,gridResult){var data=[];_(gridResult.features).each(function(pt){_(tinResult.features).each(function(triangle){t.inside(pt,triangle,function(err,isInside){if(isInside){t.planepoint(pt,triangle,function(err,zValue){pt.properties={};pt.properties[z]=zValue})}else{}})})});var depth=Math.sqrt(gridResult.features.length);for(var x=0;x<depth;x++){var xGroup=gridResult.features.slice(x*depth,(x+1)*depth);var xFlat=[];_.each(xGroup,function(verticalPoint){if(verticalPoint.properties){xFlat.push(verticalPoint.properties[z])}else{xFlat.push(0)}});data.push(xFlat)}var interval=(bbox[2]-bbox[0])/depth;var xCoordinates=[];var yCoordinates=[];for(var x=0;x<depth;x++){xCoordinates.push(x*interval+bbox[0]);yCoordinates.push(x*interval+bbox[1])}var c=new Conrec;c.contour(data,0,resolution,0,resolution,xCoordinates,yCoordinates,breaks.length,breaks);var contourList=c.contourList();var fc=t.featurecollection([]);_.each(contourList,function(c){if(c.length>2){var polyCoordinates=[];_.each(c,function(coord){polyCoordinates.push([coord.x,coord.y])});var poly=t.polygon([polyCoordinates]);poly.properties={};poly.properties[z]=c.level;fc.features.push(poly)}});done(null,fc)})})})})};exports.Conrec=Conrec;var EPSILON=1e-10;function pointsEqual(a,b){var x=a.x-b.x,y=a.y-b.y;return x*x+y*y<EPSILON}function reverseList(list){var pp=list.head;while(pp){var temp=pp.next;pp.next=pp.prev;pp.prev=temp;pp=temp}var temp=list.head;list.head=list.tail;list.tail=temp}function ContourBuilder(level){this.level=level;this.s=null;this.count=0}ContourBuilder.prototype.remove_seq=function(list){if(list.prev){list.prev.next=list.next}else{this.s=list.next}if(list.next){list.next.prev=list.prev}--this.count};ContourBuilder.prototype.addSegment=function(a,b){var ss=this.s;var ma=null;var mb=null;var prependA=false;var prependB=false;while(ss){if(ma==null){if(pointsEqual(a,ss.head.p)){ma=ss;prependA=true}else if(pointsEqual(a,ss.tail.p)){ma=ss}}if(mb==null){if(pointsEqual(b,ss.head.p)){mb=ss;prependB=true}else if(pointsEqual(b,ss.tail.p)){mb=ss}}if(mb!=null&&ma!=null){break}else{ss=ss.next}}var c=(ma!=null?1:0)|(mb!=null?2:0);switch(c){case 0:var aa={p:a,prev:null};var bb={p:b,next:null};aa.next=bb;bb.prev=aa;ma={head:aa,tail:bb,next:this.s,prev:null,closed:false};if(this.s){this.s.prev=ma}this.s=ma;++this.count;break;case 1:var pp={p:b};if(prependA){pp.next=ma.head;pp.prev=null;ma.head.prev=pp;ma.head=pp}else{pp.next=null;pp.prev=ma.tail;ma.tail.next=pp;ma.tail=pp}break;case 2:var pp={p:a};if(prependB){pp.next=mb.head;pp.prev=null;mb.head.prev=pp;mb.head=pp}else{pp.next=null;pp.prev=mb.tail;mb.tail.next=pp;mb.tail=pp}break;case 3:if(ma===mb){var pp={p:ma.tail.p,next:ma.head,prev:null};ma.head.prev=pp;ma.head=pp;ma.closed=true;break}switch((prependA?1:0)|(prependB?2:0)){case 0:reverseList(ma);case 1:mb.tail.next=ma.head;ma.head.prev=mb.tail;mb.tail=ma.tail;this.remove_seq(ma);break;case 3:reverseList(ma);case 2:ma.tail.next=mb.head;mb.head.prev=ma.tail;ma.tail=mb.tail;this.remove_seq(mb);break}}};function Conrec(drawContour){if(!drawContour){var c=this;c.contours={};this.drawContour=function(startX,startY,endX,endY,contourLevel,k){var cb=c.contours[k];if(!cb){cb=c.contours[k]=new ContourBuilder(contourLevel)}cb.addSegment({x:startX,y:startY},{x:endX,y:endY})};this.contourList=function(){var l=[];var a=c.contours;for(var k in a){var s=a[k].s;var level=a[k].level;while(s){var h=s.head;var l2=[];l2.level=level;l2.k=k;while(h&&h.p){l2.push(h.p);h=h.next}l.push(l2);s=s.next}}l.sort(function(a,b){return a.k-b.k});return l}}else{this.drawContour=drawContour}this.h=new Array(5);this.sh=new Array(5);this.xh=new Array(5);this.yh=new Array(5)}Conrec.prototype.contour=function(d,ilb,iub,jlb,jub,x,y,nc,z){var h=this.h,sh=this.sh,xh=this.xh,yh=this.yh;var drawContour=this.drawContour;this.contours={};var xsect=function(p1,p2){return(h[p2]*xh[p1]-h[p1]*xh[p2])/(h[p2]-h[p1])};var ysect=function(p1,p2){return(h[p2]*yh[p1]-h[p1]*yh[p2])/(h[p2]-h[p1])};var m1;var m2;var m3;var case_value;var dmin;var dmax;var x1=0;var x2=0;var y1=0;var y2=0;var im=[0,1,1,0];var jm=[0,0,1,1];var castab=[[[0,0,8],[0,2,5],[7,6,9]],[[0,3,4],[1,3,1],[4,3,0]],[[9,6,7],[5,2,0],[8,0,0]]];for(var j=jub-1;j>=jlb;j--){for(var i=ilb;i<=iub-1;i++){var temp1,temp2;temp1=Math.min(d[i][j],d[i][j+1]);temp2=Math.min(d[i+1][j],d[i+1][j+1]);dmin=Math.min(temp1,temp2);temp1=Math.max(d[i][j],d[i][j+1]);temp2=Math.max(d[i+1][j],d[i+1][j+1]);dmax=Math.max(temp1,temp2);if(dmax>=z[0]&&dmin<=z[nc-1]){for(var k=0;k<nc;k++){if(z[k]>=dmin&&z[k]<=dmax){for(var m=4;m>=0;m--){if(m>0){h[m]=d[i+im[m-1]][j+jm[m-1]]-z[k];xh[m]=x[i+im[m-1]];yh[m]=y[j+jm[m-1]]}else{h[0]=.25*(h[1]+h[2]+h[3]+h[4]);xh[0]=.5*(x[i]+x[i+1]);yh[0]=.5*(y[j]+y[j+1])}if(h[m]>EPSILON){sh[m]=1}else if(h[m]<-EPSILON){sh[m]=-1}else sh[m]=0}for(m=1;m<=4;m++){m1=m;m2=0;if(m!=4){m3=m+1}else{m3=1}case_value=castab[sh[m1]+1][sh[m2]+1][sh[m3]+1];if(case_value!=0){switch(case_value){case 1:x1=xh[m1];y1=yh[m1];x2=xh[m2];y2=yh[m2];break;case 2:x1=xh[m2];y1=yh[m2];x2=xh[m3];y2=yh[m3];break;case 3:x1=xh[m3];y1=yh[m3];x2=xh[m1];y2=yh[m1];break;case 4:x1=xh[m1];y1=yh[m1];x2=xsect(m2,m3);y2=ysect(m2,m3);break;case 5:x1=xh[m2];y1=yh[m2];x2=xsect(m3,m1);y2=ysect(m3,m1);break;case 6:x1=xh[m3];y1=yh[m3];x2=xsect(m1,m2);y2=ysect(m1,m2);break;case 7:x1=xsect(m1,m2);y1=ysect(m1,m2);x2=xsect(m2,m3);y2=ysect(m2,m3);break;case 8:x1=xsect(m2,m3);y1=ysect(m2,m3);x2=xsect(m3,m1);y2=ysect(m3,m1);break;case 9:x1=xsect(m3,m1);y1=ysect(m3,m1);x2=xsect(m1,m2);y2=ysect(m1,m2);break;default:break}drawContour(x1,y1,x2,y2,z[k],k)}}}}}}}}},{"./extent":13,"./featurecollection":14,"./grid":16,"./inside":17,"./planepoint":24,"./polygon":26,"./square":33,"./tin":36,fs:69,lodash:39}],10:[function(require,module,exports){module.exports=function(point1,point2,units,done){var toRad=function(degree){return degree*Math.PI/180};var coordinates1=point1.geometry.coordinates;var coordinates2=point2.geometry.coordinates;var dLat=toRad(coordinates2[0]-coordinates1[0]);var dLon=toRad(coordinates2[1]-coordinates1[1]);var lat1=toRad(coordinates1[1]);var lat2=toRad(coordinates2[1]);var a=Math.sin(dLat/2)*Math.sin(dLat/2)+Math.sin(dLon/2)*Math.sin(dLon/2)*Math.cos(lat1)*Math.cos(lat2);var c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));var R=0;switch(units){case"miles":R=3960;break;case"kilometers":R=6373;break;case"degrees":R=57.2957795;break;case"radians":R=1;break}var distance=R*c;done(null,distance)}},{}],11:[function(require,module,exports){var t={};var extent=require("./extent"),bboxPolygon=require("./bboxPolygon");t.bboxPolygon=bboxPolygon;t.extent=extent;module.exports=function(features,done){t.extent(features,function(err,bbox){t.bboxPolygon(bbox,function(err,poly){done(err,poly)})})}},{"./bboxPolygon":3,"./extent":13}],12:[function(require,module,exports){var t={};var _=require("lodash"),featurecollection=require("./featurecollection"),point=require("./point");t.featurecollection=featurecollection;t.point=point;module.exports=function(features,done){var coordinates=[];if(features.type==="FeatureCollection"){for(var i in features.features){switch(features.features[i].geometry.type){case"Point":coordinates.push([features.features[i].geometry.coordinates]);break;case"LineString":coordinates.push(features.features[i].geometry.coordinates);break;case"Polygon":coordinates.push(features.features[i].geometry.coordinates);coordinates.push(_.flatten(coordinates,true));break;case"MultiPoint":coordinates.push(features.features[i].geometry.coordinates);break;case"MultiLineString":coordinates.push(features.features[i].geometry.coordinates);coordinates.push(_.flatten(coordinates,true));break;case"MultiPolygon":coordinates.push(features.features[i].geometry.coordinates);coordinates.push(_.flatten(coordinates,true));coordinates.push(_.flatten(coordinates,true));break}if(!features.features[i].geometry&&features.features[i].properties){throw new Error("Unknown Geometry Type")}}coordinates=_.flatten(coordinates,true)}else{var geometry;if(features.type==="Feature"){geometry=features.geometry}else{geometry=features}switch(geometry.type){case"Point":coordinates=[geometry.coordinates];break;case"LineString":coordinates=geometry.coordinates;break;case"Polygon":coordinates=geometry.coordinates;coordinates=_.flatten(coordinates,true);break;case"MultiPoint":coordinates=geometry.coordinates;break;case"MultiLineString":coordinates=geometry.coordinates;coordinates=_.flatten(coordinates,true);break;case"MultiPolygon":coordinates=geometry.coordinates;coordinates=_.flatten(coordinates,true);coordinates=_.flatten(coordinates,true);break}if(!geometry){throw new Error("No Geometry Found")}}var fc=t.featurecollection([]);_.each(coordinates,function(c){fc.features.push(t.point(c[0],c[1]))});done(null,fc)}},{"./featurecollection":14,"./point":25,lodash:39}],13:[function(require,module,exports){_=require("lodash");module.exports=function(layer,done){var xmin=Infinity,ymin=Infinity,xmax=-Infinity,ymax=-Infinity;if(layer.type==="FeatureCollection"){for(var i in layer.features){var coordinates;switch(layer.features[i].geometry.type){case"Point":coordinates=[layer.features[i].geometry.coordinates];break;case"LineString":coordinates=layer.features[i].geometry.coordinates;break;case"Polygon":coordinates=layer.features[i].geometry.coordinates;coordinates=_.flatten(coordinates,true);break;case"MultiPoint":coordinates=layer.features[i].geometry.coordinates;break;case"MultiLineString":coordinates=layer.features[i].geometry.coordinates;coordinates=_.flatten(coordinates,true);break;case"MultiPolygon":coordinates=layer.features[i].geometry.coordinates;coordinates=_.flatten(coordinates,true);coordinates=_.flatten(coordinates,true);break}if(!layer.features[i].geometry&&layer.features[i].properties){throw new Error("Unknown Geometry Type")}for(var n in coordinates){if(xmin>coordinates[n][0]){xmin=coordinates[n][0]}if(ymin>coordinates[n][1]){ymin=coordinates[n][1]}if(xmax<coordinates[n][0]){xmax=coordinates[n][0]}if(ymax<coordinates[n][1]){ymax=coordinates[n][1]}}}var bbox=[xmin,ymin,xmax,ymax];done(null,bbox)}else{var coordinates;var geometry;if(layer.type==="Feature"){geometry=layer.geometry}else{geometry=layer}switch(geometry.type){case"Point":coordinates=[geometry.coordinates];break;case"LineString":coordinates=geometry.coordinates;break;case"Polygon":coordinates=geometry.coordinates;coordinates=_.flatten(coordinates,true);break;case"MultiPoint":coordinates=geometry.coordinates;break;case"MultiLineString":coordinates=geometry.coordinates;coordinates=_.flatten(coordinates,true);break;case"MultiPolygon":coordinates=geometry.coordinates;coordinates=_.flatten(coordinates,true);coordinates=_.flatten(coordinates,true);break}if(!geometry){throw new Error("No Geometry Found")}for(var n in coordinates){if(xmin>coordinates[n][0]){xmin=coordinates[n][0]}if(ymin>coordinates[n][1]){ymin=coordinates[n][1]}if(xmax<coordinates[n][0]){xmax=coordinates[n][0]}if(ymax<coordinates[n][1]){ymax=coordinates[n][1]}}var bbox=[xmin,ymin,xmax,ymax];done(null,bbox)}}},{lodash:39}],14:[function(require,module,exports){module.exports=function(features){var fc={type:"FeatureCollection",features:features};return fc}},{}],15:[function(require,module,exports){var _=require("lodash");var t={};t.featurecollection=require("./featurecollection");module.exports=function(fc,field,value,done){var newFC=t.featurecollection([]);for(var i=0;i<fc.features.length;i++){if(fc.features[i].properties[field]===value){newFC.features.push(fc.features[i])}}done(null,newFC)}},{"./featurecollection":14,lodash:39}],16:[function(require,module,exports){var t={};var _=require("lodash"),point=require("./point");t.point=point;module.exports=function(extents,depth,done){var xmin=extents[0];var ymin=extents[1];var xmax=extents[2];var ymax=extents[3];var interval=(xmax-xmin)/depth;var coords=[];var fc={type:"FeatureCollection",features:[]};for(var x=0;x<=depth;x++){for(var y=0;y<=depth;y++){fc.features.push(t.point(x*interval+xmin,y*interval+ymin))}}done(null,fc)}},{"./point":25,lodash:39}],17:[function(require,module,exports){module.exports=function(point,polygon,done){var x=point.geometry.coordinates[0];var y=point.geometry.coordinates[1];var vs=polygon.geometry.coordinates[0];var isInside=false;for(var i=0,j=vs.length-1;i<vs.length;j=i++){var xi=vs[i][0],yi=vs[i][1];var xj=vs[j][0],yj=vs[j][1];var intersect=yi>y!=yj>y&&x<(xj-xi)*(y-yi)/(yj-yi)+xi;if(intersect)isInside=!isInside}done(null,isInside)}},{}],18:[function(require,module,exports){},{}],19:[function(require,module,exports){var ss=require("simple-statistics"),_=require("lodash");module.exports=function(fc,field,num,done){var vals=[];var breaks=[];_.each(fc.features,function(feature){if(!(feature.properties[field]===undefined)){vals.push(feature.properties[field])}});breaks=ss.jenks(vals,num);done(null,breaks)}},{lodash:39,"simple-statistics":40}],20:[function(require,module,exports){module.exports=function(coordinates,properties){if(coordinates===null)throw new Error("No coordinates passed");var linestring={type:"Feature",geometry:{type:"LineString",coordinates:coordinates},properties:properties};return linestring}},{}],21:[function(require,module,exports){var path=require("path"),fs=require("fs"),ext="",layer;module.exports=function(file,done){ext=path.extname(file);fs.readFile(file,function(err,res){if(err)done(err);layer=JSON.parse(res);done(null,layer)})}},{fs:69,path:70}],22:[function(require,module,exports){var t={};var point=require("./point");t.point=point;module.exports=function(point1,point2,done){if(point1===null||point2===null||point1&&point2===null)throw new Error("Less than two points passed.");var x1=point1.geometry.coordinates[0];var x2=point2.geometry.coordinates[0];var y1=point1.geometry.coordinates[1];var y2=point2.geometry.coordinates[1];var x3=x1+x2;var midX=x3/2;var y3=y1+y2;var midY=y3/2;var midpoint=t.point(midX,midY);done(null,midpoint)}},{"./point":25}],23:[function(require,module,exports){var t={};var _=require("lodash"),distance=require("./distance");t.distance=distance;module.exports=function(targetPoint,points,done){var nearestPoint;var count=0;var dist=Infinity;_.forEach(points.features,function(pt){if(!nearestPoint){nearestPoint=pt;t.distance(targetPoint,pt,"miles",function(err,dist){nearestPoint.properties.distance=dist})}else{t.distance(targetPoint,pt,"miles",function(err,dist){if(dist<nearestPoint.properties.distance){nearestPoint=pt;nearestPoint.properties.distance=dist}if(points.features.length===count+1){complete(nearestPoint)}})}count++});function complete(nPt){delete nPt.properties.distance;done(null,nPt)}}},{"./distance":10,lodash:39}],24:[function(require,module,exports){http:module.exports=function(point,triangle,done){var x=point.geometry.coordinates[0];y=point.geometry.coordinates[1];x1=triangle.geometry.coordinates[0][0][0],y1=triangle.geometry.coordinates[0][0][1],z1=triangle.properties.a;x2=triangle.geometry.coordinates[0][1][0],y2=triangle.geometry.coordinates[0][1][1],z2=triangle.properties.b;x3=triangle.geometry.coordinates[0][2][0],y3=triangle.geometry.coordinates[0][2][1],z3=triangle.properties.c;var z=(z3*(x-x1)*(y-y2)+z1*(x-x2)*(y-y3)+z2*(x-x3)*(y-y1)-z2*(x-x1)*(y-y3)-z3*(x-x2)*(y-y1)-z1*(x-x3)*(y-y2))/((x-x1)*(y-y2)+(x-x2)*(y-y3)+(x-x3)*(y-y1)-(x-x1)*(y-y3)-(x-x2)*(y-y1)-(x-x3)*(y-y2));done(null,z)}},{}],25:[function(require,module,exports){module.exports=function(x,y,properties){if(x===null||y===null)throw new Error("Invalid coordinates");var point={type:"Feature",geometry:{type:"Point",coordinates:[x,y]},properties:properties};return point}},{}],26:[function(require,module,exports){module.exports=function(coordinates,properties){if(coordinates===null)throw new Error("No coordinates passed");var polygon={type:"Feature",geometry:{type:"Polygon",coordinates:coordinates},properties:properties};return polygon}},{}],27:[function(require,module,exports){var ss=require("simple-statistics"),_=require("lodash");module.exports=function(fc,field,percentiles,done){var vals=[];var quantiles=[];_.each(fc.features,function(feature){vals.push(feature.properties[field])});_.each(percentiles,function(percentile){quantiles.push(ss.quantile(vals,percentile*.01))});done(null,quantiles)}},{lodash:39,"simple-statistics":40}],28:[function(require,module,exports){var t={};var featurecollection=require("./featurecollection");t.featurecollection=featurecollection;module.exports=function(fc,inField,outField,translations,done){var reclassed=t.featurecollection([]);_.each(fc.features,function(feature){var reclassedFeature;var found=false;for(var i=0;i<translations.length;i++){if(feature.properties[inField]>=translations[i][0]&&feature.properties[inField]<=translations[i][1]){reclassedFeature=_.clone(feature,true);reclassedFeature.properties[outField]=translations[i][2]}}reclassed.features.push(reclassedFeature)});done(null,reclassed)}},{"./featurecollection":14}],29:[function(require,module,exports){var t={};var featurecollection=require("./featurecollection");t.featurecollection=featurecollection;module.exports=function(collection,key,val,done){var newFC=t.featurecollection([]);for(var i=0;i<collection.features.length;i++){if(collection.features[i].properties[key]!=val){newFC.features.push(collection.features[i])}}done(null,newFC)}},{"./featurecollection":14}],30:[function(require,module,exports){var t={};var _=require("lodash"),featurecollection=require("./featurecollection");t.featurecollection=featurecollection;module.exports=function(fc,num,done){var outFC=t.featurecollection(_.sample(fc.features,num));done(null,outFC)}},{"./featurecollection":14,lodash:39}],31:[function(require,module,exports){var t={};var fs=require("fs");t.topo=require("./topo");module.exports=function(path,features,type,done){if(!type)type="geojson";switch(type){case"geojson":fs.writeFile(path,JSON.stringify(features),function(err){done(err,1)});break;case"topojson":t.topo(features,function(err,topology){fs.writeFile(path,JSON.stringify(features),function(err){done(err,1)})});break}}},{"./topo":37,fs:69}],32:[function(require,module,exports){module.exports=function(bbox,factor,done){var lowX=(bbox[2]-bbox[0])/2*factor+bbox[0];var lowY=(bbox[3]-bbox[1])/2*factor+bbox[1];var highX=(bbox[2]-bbox[0])/2*factor+bbox[2];var highY=(bbox[3]-bbox[1])/2*factor+bbox[3];var sized=[lowX,lowY,highX,highY];done(null,sized)}},{}],33:[function(require,module,exports){var t={};var midpoint=require("../lib/midpoint"),point=require("../lib/point"),distance=require("../lib/distance");t.midpoint=midpoint;t.point=point;t.distance=distance;module.exports=function(bbox,done){var squareBbox=[0,0,0,0];var lowLeft=t.point(bbox[0],bbox[1]);var topLeft=t.point(bbox[0],bbox[3]);var topRight=t.point(bbox[2],bbox[3]);var lowRight=t.point(bbox[2],bbox[1]);t.distance(lowLeft,lowRight,"miles",function(err,horizontalDistance){t.distance(lowLeft,topLeft,"miles",function(err,verticalDistance){if(horizontalDistance>=verticalDistance){squareBbox[0]=bbox[0];squareBbox[2]=bbox[2];t.midpoint(lowLeft,topLeft,function(err,verticalMidpoint){squareBbox[1]=verticalMidpoint.geometry.coordinates[1]-(bbox[2]-bbox[0])/2;squareBbox[3]=verticalMidpoint.geometry.coordinates[1]+(bbox[2]-bbox[0])/2;done(err,squareBbox)})}else{squareBbox[1]=bbox[1];squareBbox[3]=bbox[3];t.midpoint(lowLeft,lowRight,function(err,horzontalMidpoint){squareBbox[0]=horzontalMidpoint.geometry.coordinates[0]-(bbox[3]-bbox[1])/2;squareBbox[2]=horzontalMidpoint.geometry.coordinates[0]+(bbox[3]-bbox[1])/2;done(err,squareBbox)})}})})}},{"../lib/distance":10,"../lib/midpoint":22,"../lib/point":25}],34:[function(require,module,exports){var _=require("lodash");module.exports=function(polyFC,ptFC,field,outField,done){done(new Error("not implemented"))}},{lodash:39}],35:[function(require,module,exports){var t={};var _=require("lodash");t.inside=require("./inside");module.exports=function(points,polygons,field,done){_.each(points.features,function(pt){if(!pt.properties){pt.properties={}}_.each(polygons.features,function(poly){if(!pt.properties[field]){t.inside(pt,poly,function(err,isInside){if(isInside){pt.properties[field]=poly.properties[field]}else{pt.properties[field]=null}})}})});done(null,points)}},{"./inside":17,lodash:39}],36:[function(require,module,exports){var t={};var _=require("lodash"),polygon=require("./polygon"),nearest=require("./nearest"),point=require("./point");t.polygon=polygon;t.nearest=nearest;t.point=point;module.exports=function(points,z,done){var vertices=[];_(points.features).each(function(p){vertices.push({x:p.geometry.coordinates[0],y:p.geometry.coordinates[1]})});var triangulated=triangulate(vertices);var triangles={type:"FeatureCollection",features:[]};_(triangulated).each(function(triangle){var coords=[[[triangle.a.x,triangle.a.y],[triangle.b.x,triangle.b.y],[triangle.c.x,triangle.c.y]]];var poly=t.polygon(coords,{a:null,b:null,c:null});triangles.features.push(poly)});_.each(triangles.features,function(tri){var coordinateNumber=1;_.each(tri.geometry.coordinates[0],function(c){t.nearest(t.point(c[0],c[1]),points,function(err,closest){if(coordinateNumber===1){tri.properties.a=closest.properties[z]}else if(coordinateNumber===2){tri.properties.b=closest.properties[z]}else if(coordinateNumber===3){tri.properties.c=closest.properties[z]}coordinateNumber++})})});done(null,triangles)};function Triangle(a,b,c){this.a=a;this.b=b;
this.c=c;var A=b.x-a.x,B=b.y-a.y,C=c.x-a.x,D=c.y-a.y,E=A*(a.x+b.x)+B*(a.y+b.y),F=C*(a.x+c.x)+D*(a.y+c.y),G=2*(A*(c.y-b.y)-B*(c.x-b.x)),minx,miny,dx,dy;if(Math.abs(G)<1e-6){minx=Math.min(a.x,b.x,c.x);miny=Math.min(a.y,b.y,c.y);dx=(Math.max(a.x,b.x,c.x)-minx)*.5;dy=(Math.max(a.y,b.y,c.y)-miny)*.5;this.x=minx+dx;this.y=miny+dy;this.r=dx*dx+dy*dy}else{this.x=(D*E-B*F)/G;this.y=(A*F-C*E)/G;dx=this.x-a.x;dy=this.y-a.y;this.r=dx*dx+dy*dy}}Triangle.prototype.draw=function(ctx){ctx.beginPath();ctx.moveTo(this.a.x,this.a.y);ctx.lineTo(this.b.x,this.b.y);ctx.lineTo(this.c.x,this.c.y);ctx.closePath();ctx.stroke()};function byX(a,b){return b.x-a.x}function dedup(edges){var j=edges.length,a,b,i,m,n;outer:while(j){b=edges[--j];a=edges[--j];i=j;while(i){n=edges[--i];m=edges[--i];if(a===m&&b===n||a===n&&b===m){edges.splice(j,2);edges.splice(i,2);j-=2;continue outer}}}}function triangulate(vertices){if(vertices.length<3)return[];vertices.sort(byX);var i=vertices.length-1,xmin=vertices[i].x,xmax=vertices[0].x,ymin=vertices[i].y,ymax=ymin;while(i--){if(vertices[i].y<ymin)ymin=vertices[i].y;if(vertices[i].y>ymax)ymax=vertices[i].y}var dx=xmax-xmin,dy=ymax-ymin,dmax=dx>dy?dx:dy,xmid=(xmax+xmin)*.5,ymid=(ymax+ymin)*.5,open=[new Triangle({x:xmid-20*dmax,y:ymid-dmax,__sentinel:true},{x:xmid,y:ymid+20*dmax,__sentinel:true},{x:xmid+20*dmax,y:ymid-dmax,__sentinel:true})],closed=[],edges=[],j,a,b;i=vertices.length;while(i--){edges.length=0;j=open.length;while(j--){dx=vertices[i].x-open[j].x;if(dx>0&&dx*dx>open[j].r){closed.push(open[j]);open.splice(j,1);continue}dy=vertices[i].y-open[j].y;if(dx*dx+dy*dy>open[j].r)continue;edges.push(open[j].a,open[j].b,open[j].b,open[j].c,open[j].c,open[j].a);open.splice(j,1)}dedup(edges);j=edges.length;while(j){b=edges[--j];a=edges[--j];open.push(new Triangle(a,b,vertices[i]))}}Array.prototype.push.apply(closed,open);i=closed.length;while(i--)if(closed[i].a.__sentinel||closed[i].b.__sentinel||closed[i].c.__sentinel)closed.splice(i,1);return closed}},{"./nearest":23,"./point":25,"./polygon":26,lodash:39}],37:[function(require,module,exports){var topojson=require("topojson");module.exports=function(geojson,done){var topology=topojson.topology({geojson:geojson});done(null,topology)}},{topojson:41}],38:[function(require,module,exports){},{}],39:[function(require,module,exports){var global=typeof self!=="undefined"?self:typeof window!=="undefined"?window:{};(function(){var undefined;var arrayPool=[],objectPool=[];var idCounter=0;var keyPrefix=+new Date+"";var largeArraySize=75;var maxPoolSize=40;var whitespace=" 	\f ﻿"+"\n\r\u2028\u2029"+" ᠎             　";var reEmptyStringLeading=/\b__p \+= '';/g,reEmptyStringMiddle=/\b(__p \+=) '' \+/g,reEmptyStringTrailing=/(__e\(.*?\)|\b__t\)) \+\n'';/g;var reEsTemplate=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g;var reFlags=/\w*$/;var reFuncName=/^function[ \n\r\t]+\w/;var reInterpolate=/<%=([\s\S]+?)%>/g;var reLeadingSpacesAndZeros=RegExp("^["+whitespace+"]*0+(?=.$)");var reNoMatch=/($^)/;var reThis=/\bthis\b/;var reUnescapedString=/['\n\r\t\u2028\u2029\\]/g;var contextProps=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setImmediate","setTimeout"];var templateCounter=0;var argsClass="[object Arguments]",arrayClass="[object Array]",boolClass="[object Boolean]",dateClass="[object Date]",funcClass="[object Function]",numberClass="[object Number]",objectClass="[object Object]",regexpClass="[object RegExp]",stringClass="[object String]";var cloneableClasses={};cloneableClasses[funcClass]=false;cloneableClasses[argsClass]=cloneableClasses[arrayClass]=cloneableClasses[boolClass]=cloneableClasses[dateClass]=cloneableClasses[numberClass]=cloneableClasses[objectClass]=cloneableClasses[regexpClass]=cloneableClasses[stringClass]=true;var debounceOptions={leading:false,maxWait:0,trailing:false};var descriptor={configurable:false,enumerable:false,value:null,writable:false};var objectTypes={"boolean":false,"function":true,object:true,number:false,string:false,undefined:false};var stringEscapes={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"};var root=objectTypes[typeof window]&&window||this;var freeExports=objectTypes[typeof exports]&&exports&&!exports.nodeType&&exports;var freeModule=objectTypes[typeof module]&&module&&!module.nodeType&&module;var moduleExports=freeModule&&freeModule.exports===freeExports&&freeExports;var freeGlobal=objectTypes[typeof global]&&global;if(freeGlobal&&(freeGlobal.global===freeGlobal||freeGlobal.window===freeGlobal)){root=freeGlobal}function baseIndexOf(array,value,fromIndex){var index=(fromIndex||0)-1,length=array?array.length:0;while(++index<length){if(array[index]===value){return index}}return-1}function cacheIndexOf(cache,value){var type=typeof value;cache=cache.cache;if(type=="boolean"||value==null){return cache[value]?0:-1}if(type!="number"&&type!="string"){type="object"}var key=type=="number"?value:keyPrefix+value;cache=(cache=cache[type])&&cache[key];return type=="object"?cache&&baseIndexOf(cache,value)>-1?0:-1:cache?0:-1}function cachePush(value){var cache=this.cache,type=typeof value;if(type=="boolean"||value==null){cache[value]=true}else{if(type!="number"&&type!="string"){type="object"}var key=type=="number"?value:keyPrefix+value,typeCache=cache[type]||(cache[type]={});if(type=="object"){(typeCache[key]||(typeCache[key]=[])).push(value)}else{typeCache[key]=true}}}function charAtCallback(value){return value.charCodeAt(0)}function compareAscending(a,b){var ac=a.criteria,bc=b.criteria;if(ac!==bc){if(ac>bc||typeof ac=="undefined"){return 1}if(ac<bc||typeof bc=="undefined"){return-1}}return a.index-b.index}function createCache(array){var index=-1,length=array.length,first=array[0],mid=array[length/2|0],last=array[length-1];if(first&&typeof first=="object"&&mid&&typeof mid=="object"&&last&&typeof last=="object"){return false}var cache=getObject();cache["false"]=cache["null"]=cache["true"]=cache["undefined"]=false;var result=getObject();result.array=array;result.cache=cache;result.push=cachePush;while(++index<length){result.push(array[index])}return result}function escapeStringChar(match){return"\\"+stringEscapes[match]}function getArray(){return arrayPool.pop()||[]}function getObject(){return objectPool.pop()||{array:null,cache:null,criteria:null,"false":false,index:0,"null":false,number:null,object:null,push:null,string:null,"true":false,undefined:false,value:null}}function noop(){}function releaseArray(array){array.length=0;if(arrayPool.length<maxPoolSize){arrayPool.push(array)}}function releaseObject(object){var cache=object.cache;if(cache){releaseObject(cache)}object.array=object.cache=object.criteria=object.object=object.number=object.string=object.value=null;if(objectPool.length<maxPoolSize){objectPool.push(object)}}function slice(array,start,end){start||(start=0);if(typeof end=="undefined"){end=array?array.length:0}var index=-1,length=end-start||0,result=Array(length<0?0:length);while(++index<length){result[index]=array[start+index]}return result}function runInContext(context){context=context?_.defaults(root.Object(),context,_.pick(root,contextProps)):root;var Array=context.Array,Boolean=context.Boolean,Date=context.Date,Function=context.Function,Math=context.Math,Number=context.Number,Object=context.Object,RegExp=context.RegExp,String=context.String,TypeError=context.TypeError;var arrayRef=[];var objectProto=Object.prototype;var oldDash=context._;var reNative=RegExp("^"+String(objectProto.valueOf).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$");var ceil=Math.ceil,clearTimeout=context.clearTimeout,floor=Math.floor,fnToString=Function.prototype.toString,getPrototypeOf=reNative.test(getPrototypeOf=Object.getPrototypeOf)&&getPrototypeOf,hasOwnProperty=objectProto.hasOwnProperty,now=reNative.test(now=Date.now)&&now||function(){return+new Date},push=arrayRef.push,setImmediate=context.setImmediate,setTimeout=context.setTimeout,splice=arrayRef.splice,toString=objectProto.toString,unshift=arrayRef.unshift;var defineProperty=function(){try{var o={},func=reNative.test(func=Object.defineProperty)&&func,result=func(o,o,o)&&func}catch(e){}return result}();var nativeBind=reNative.test(nativeBind=toString.bind)&&nativeBind,nativeCreate=reNative.test(nativeCreate=Object.create)&&nativeCreate,nativeIsArray=reNative.test(nativeIsArray=Array.isArray)&&nativeIsArray,nativeIsFinite=context.isFinite,nativeIsNaN=context.isNaN,nativeKeys=reNative.test(nativeKeys=Object.keys)&&nativeKeys,nativeMax=Math.max,nativeMin=Math.min,nativeParseInt=context.parseInt,nativeRandom=Math.random,nativeSlice=arrayRef.slice;var isIeOpera=reNative.test(context.attachEvent),isV8=nativeBind&&!/\n|true/.test(nativeBind+isIeOpera);var ctorByClass={};ctorByClass[arrayClass]=Array;ctorByClass[boolClass]=Boolean;ctorByClass[dateClass]=Date;ctorByClass[funcClass]=Function;ctorByClass[objectClass]=Object;ctorByClass[numberClass]=Number;ctorByClass[regexpClass]=RegExp;ctorByClass[stringClass]=String;function lodash(value){return value&&typeof value=="object"&&!isArray(value)&&hasOwnProperty.call(value,"__wrapped__")?value:new lodashWrapper(value)}function lodashWrapper(value,chainAll){this.__chain__=!!chainAll;this.__wrapped__=value}lodashWrapper.prototype=lodash.prototype;var support=lodash.support={};support.fastBind=nativeBind&&!isV8;support.funcDecomp=!reNative.test(context.WinRTError)&&reThis.test(runInContext);support.funcNames=typeof Function.name=="string";lodash.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:reInterpolate,variable:"",imports:{_:lodash}};function baseClone(value,deep,callback,stackA,stackB){if(callback){var result=callback(value);if(typeof result!="undefined"){return result}}var isObj=isObject(value);if(isObj){var className=toString.call(value);if(!cloneableClasses[className]){return value}var ctor=ctorByClass[className];switch(className){case boolClass:case dateClass:return new ctor(+value);case numberClass:case stringClass:return new ctor(value);case regexpClass:result=ctor(value.source,reFlags.exec(value));result.lastIndex=value.lastIndex;return result}}else{return value}var isArr=isArray(value);if(deep){var initedStack=!stackA;stackA||(stackA=getArray());stackB||(stackB=getArray());var length=stackA.length;while(length--){if(stackA[length]==value){return stackB[length]}}result=isArr?ctor(value.length):{}}else{result=isArr?slice(value):assign({},value)}if(isArr){if(hasOwnProperty.call(value,"index")){result.index=value.index}if(hasOwnProperty.call(value,"input")){result.input=value.input}}if(!deep){return result}stackA.push(value);stackB.push(result);(isArr?forEach:forOwn)(value,function(objValue,key){result[key]=baseClone(objValue,deep,callback,stackA,stackB)});if(initedStack){releaseArray(stackA);releaseArray(stackB)}return result}function baseCreateCallback(func,thisArg,argCount){if(typeof func!="function"){return identity}if(typeof thisArg=="undefined"){return func}var bindData=func.__bindData__||support.funcNames&&!func.name;if(typeof bindData=="undefined"){var source=reThis&&fnToString.call(func);if(!support.funcNames&&source&&!reFuncName.test(source)){bindData=true}if(support.funcNames||!bindData){bindData=!support.funcDecomp||reThis.test(source);setBindData(func,bindData)}}if(bindData!==true&&bindData&&bindData[1]&1){return func}switch(argCount){case 1:return function(value){return func.call(thisArg,value)};case 2:return function(a,b){return func.call(thisArg,a,b)};case 3:return function(value,index,collection){return func.call(thisArg,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(thisArg,accumulator,value,index,collection)}}return bind(func,thisArg)}function baseFlatten(array,isShallow,isArgArrays,fromIndex){var index=(fromIndex||0)-1,length=array?array.length:0,result=[];while(++index<length){var value=array[index];if(value&&typeof value=="object"&&typeof value.length=="number"&&(isArray(value)||isArguments(value))){if(!isShallow){value=baseFlatten(value,isShallow,isArgArrays)}var valIndex=-1,valLength=value.length,resIndex=result.length;result.length+=valLength;while(++valIndex<valLength){result[resIndex++]=value[valIndex]}}else if(!isArgArrays){result.push(value)}}return result}function baseIsEqual(a,b,callback,isWhere,stackA,stackB){if(callback){var result=callback(a,b);if(typeof result!="undefined"){return!!result}}if(a===b){return a!==0||1/a==1/b}var type=typeof a,otherType=typeof b;if(a===a&&!(a&&objectTypes[type])&&!(b&&objectTypes[otherType])){return false}if(a==null||b==null){return a===b}var className=toString.call(a),otherClass=toString.call(b);if(className==argsClass){className=objectClass}if(otherClass==argsClass){otherClass=objectClass}if(className!=otherClass){return false}switch(className){case boolClass:case dateClass:return+a==+b;case numberClass:return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case regexpClass:case stringClass:return a==String(b)}var isArr=className==arrayClass;if(!isArr){if(hasOwnProperty.call(a,"__wrapped__ ")||hasOwnProperty.call(b,"__wrapped__")){return baseIsEqual(a.__wrapped__||a,b.__wrapped__||b,callback,isWhere,stackA,stackB)}if(className!=objectClass){return false}var ctorA=a.constructor,ctorB=b.constructor;if(ctorA!=ctorB&&!(isFunction(ctorA)&&ctorA instanceof ctorA&&isFunction(ctorB)&&ctorB instanceof ctorB)){return false}}var initedStack=!stackA;stackA||(stackA=getArray());stackB||(stackB=getArray());var length=stackA.length;while(length--){if(stackA[length]==a){return stackB[length]==b}}var size=0;result=true;stackA.push(a);stackB.push(b);if(isArr){length=a.length;size=b.length;result=size==a.length;if(!result&&!isWhere){return result}while(size--){var index=length,value=b[size];if(isWhere){while(index--){if(result=baseIsEqual(a[index],value,callback,isWhere,stackA,stackB)){break}}}else if(!(result=baseIsEqual(a[size],value,callback,isWhere,stackA,stackB))){break}}return result}forIn(b,function(value,key,b){if(hasOwnProperty.call(b,key)){size++;return result=hasOwnProperty.call(a,key)&&baseIsEqual(a[key],value,callback,isWhere,stackA,stackB)}});if(result&&!isWhere){forIn(a,function(value,key,a){if(hasOwnProperty.call(a,key)){return result=--size>-1}})}if(initedStack){releaseArray(stackA);releaseArray(stackB)}return result}function baseMerge(object,source,callback,stackA,stackB){(isArray(source)?forEach:forOwn)(source,function(source,key){var found,isArr,result=source,value=object[key];if(source&&((isArr=isArray(source))||isPlainObject(source))){var stackLength=stackA.length;while(stackLength--){if(found=stackA[stackLength]==source){value=stackB[stackLength];break}}if(!found){var isShallow;if(callback){result=callback(value,source);if(isShallow=typeof result!="undefined"){value=result}}if(!isShallow){value=isArr?isArray(value)?value:[]:isPlainObject(value)?value:{}}stackA.push(source);stackB.push(value);if(!isShallow){baseMerge(value,source,callback,stackA,stackB)}}}else{if(callback){result=callback(value,source);if(typeof result=="undefined"){result=source}}if(typeof result!="undefined"){value=result}}object[key]=value})}function baseUniq(array,isSorted,callback){var index=-1,indexOf=getIndexOf(),length=array?array.length:0,result=[];var isLarge=!isSorted&&length>=largeArraySize&&indexOf===baseIndexOf,seen=callback||isLarge?getArray():result;if(isLarge){var cache=createCache(seen);if(cache){indexOf=cacheIndexOf;seen=cache}else{isLarge=false;seen=callback?seen:(releaseArray(seen),result)}}while(++index<length){var value=array[index],computed=callback?callback(value,index,array):value;if(isSorted?!index||seen[seen.length-1]!==computed:indexOf(seen,computed)<0){if(callback||isLarge){seen.push(computed)}result.push(value)}}if(isLarge){releaseArray(seen.array);releaseObject(seen)}else if(callback){releaseArray(seen)}return result}function createAggregator(setter){return function(collection,callback,thisArg){var result={};callback=lodash.createCallback(callback,thisArg,3);var index=-1,length=collection?collection.length:0;if(typeof length=="number"){while(++index<length){var value=collection[index];setter(result,value,callback(value,index,collection),collection)}}else{forOwn(collection,function(value,key,collection){setter(result,value,callback(value,key,collection),collection)})}return result}}function createBound(func,bitmask,partialArgs,partialRightArgs,thisArg,arity){var isBind=bitmask&1,isBindKey=bitmask&2,isCurry=bitmask&4,isCurryBound=bitmask&8,isPartial=bitmask&16,isPartialRight=bitmask&32,key=func;if(!isBindKey&&!isFunction(func)){throw new TypeError}if(isPartial&&!partialArgs.length){bitmask&=~16;isPartial=partialArgs=false}if(isPartialRight&&!partialRightArgs.length){bitmask&=~32;isPartialRight=partialRightArgs=false}var bindData=func&&func.__bindData__;if(bindData){if(isBind&&!(bindData[1]&1)){bindData[4]=thisArg}if(!isBind&&bindData[1]&1){bitmask|=8}if(isCurry&&!(bindData[1]&4)){bindData[5]=arity}if(isPartial){push.apply(bindData[2]||(bindData[2]=[]),partialArgs)}if(isPartialRight){push.apply(bindData[3]||(bindData[3]=[]),partialRightArgs)}bindData[1]|=bitmask;return createBound.apply(null,bindData)}if(isBind&&!(isBindKey||isCurry||isPartialRight)&&(support.fastBind||nativeBind&&isPartial)){if(isPartial){var args=[thisArg];push.apply(args,partialArgs)}var bound=isPartial?nativeBind.apply(func,args):nativeBind.call(func,thisArg)}else{bound=function(){var args=arguments,thisBinding=isBind?thisArg:this;if(isCurry||isPartial||isPartialRight){args=nativeSlice.call(args);if(isPartial){unshift.apply(args,partialArgs)}if(isPartialRight){push.apply(args,partialRightArgs)}if(isCurry&&args.length<arity){bitmask|=16&~32;return createBound(func,isCurryBound?bitmask:bitmask&~3,args,null,thisArg,arity)}}if(isBindKey){func=thisBinding[key]}if(this instanceof bound){thisBinding=createObject(func.prototype);var result=func.apply(thisBinding,args);return isObject(result)?result:thisBinding}return func.apply(thisBinding,args)}}setBindData(bound,nativeSlice.call(arguments));return bound}function createObject(prototype){return isObject(prototype)?nativeCreate(prototype):{}}if(!nativeCreate){createObject=function(prototype){if(isObject(prototype)){noop.prototype=prototype;var result=new noop;noop.prototype=null}return result||{}}}function escapeHtmlChar(match){return htmlEscapes[match]}function getIndexOf(){var result=(result=lodash.indexOf)===indexOf?baseIndexOf:result;return result}var setBindData=!defineProperty?noop:function(func,value){descriptor.value=value;defineProperty(func,"__bindData__",descriptor)};function shimIsPlainObject(value){var ctor,result;if(!(value&&toString.call(value)==objectClass)||(ctor=value.constructor,isFunction(ctor)&&!(ctor instanceof ctor))){return false}forIn(value,function(value,key){result=key});return typeof result=="undefined"||hasOwnProperty.call(value,result)}function unescapeHtmlChar(match){return htmlUnescapes[match]}function isArguments(value){return value&&typeof value=="object"&&typeof value.length=="number"&&toString.call(value)==argsClass||false}var isArray=nativeIsArray||function(value){return value&&typeof value=="object"&&typeof value.length=="number"&&toString.call(value)==arrayClass||false};var shimKeys=function(object){var index,iterable=object,result=[];if(!iterable)return result;if(!objectTypes[typeof object])return result;for(index in iterable){if(hasOwnProperty.call(iterable,index)){result.push(index)}}return result};var keys=!nativeKeys?shimKeys:function(object){if(!isObject(object)){return[]}return nativeKeys(object)};var htmlEscapes={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};var htmlUnescapes=invert(htmlEscapes);var reEscapedHtml=RegExp("("+keys(htmlUnescapes).join("|")+")","g"),reUnescapedHtml=RegExp("["+keys(htmlEscapes).join("")+"]","g");var assign=function(object,source,guard){var index,iterable=object,result=iterable;if(!iterable)return result;var args=arguments,argsIndex=0,argsLength=typeof guard=="number"?2:args.length;if(argsLength>3&&typeof args[argsLength-2]=="function"){var callback=baseCreateCallback(args[--argsLength-1],args[argsLength--],2)}else if(argsLength>2&&typeof args[argsLength-1]=="function"){callback=args[--argsLength]}while(++argsIndex<argsLength){iterable=args[argsIndex];if(iterable&&objectTypes[typeof iterable]){var ownIndex=-1,ownProps=objectTypes[typeof iterable]&&keys(iterable),length=ownProps?ownProps.length:0;while(++ownIndex<length){index=ownProps[ownIndex];result[index]=callback?callback(result[index],iterable[index]):iterable[index]}}}return result};function clone(value,deep,callback,thisArg){if(typeof deep!="boolean"&&deep!=null){thisArg=callback;callback=deep;deep=false}return baseClone(value,deep,typeof callback=="function"&&baseCreateCallback(callback,thisArg,1))}function cloneDeep(value,callback,thisArg){return baseClone(value,true,typeof callback=="function"&&baseCreateCallback(callback,thisArg,1))}var defaults=function(object,source,guard){var index,iterable=object,result=iterable;if(!iterable)return result;var args=arguments,argsIndex=0,argsLength=typeof guard=="number"?2:args.length;while(++argsIndex<argsLength){iterable=args[argsIndex];if(iterable&&objectTypes[typeof iterable]){var ownIndex=-1,ownProps=objectTypes[typeof iterable]&&keys(iterable),length=ownProps?ownProps.length:0;while(++ownIndex<length){index=ownProps[ownIndex];if(typeof result[index]=="undefined")result[index]=iterable[index]}}}return result};function findKey(object,callback,thisArg){var result;callback=lodash.createCallback(callback,thisArg,3);forOwn(object,function(value,key,object){if(callback(value,key,object)){result=key;return false}});return result}function findLastKey(object,callback,thisArg){var result;callback=lodash.createCallback(callback,thisArg,3);forOwnRight(object,function(value,key,object){if(callback(value,key,object)){result=key;return false}});return result}var forIn=function(collection,callback,thisArg){var index,iterable=collection,result=iterable;if(!iterable)return result;if(!objectTypes[typeof iterable])return result;callback=callback&&typeof thisArg=="undefined"?callback:baseCreateCallback(callback,thisArg,3);for(index in iterable){if(callback(iterable[index],index,collection)===false)return result}return result};function forInRight(object,callback,thisArg){var pairs=[];forIn(object,function(value,key){pairs.push(key,value)});var length=pairs.length;callback=baseCreateCallback(callback,thisArg,3);while(length--){if(callback(pairs[length--],pairs[length],object)===false){break}}return object}var forOwn=function(collection,callback,thisArg){var index,iterable=collection,result=iterable;if(!iterable)return result;if(!objectTypes[typeof iterable])return result;callback=callback&&typeof thisArg=="undefined"?callback:baseCreateCallback(callback,thisArg,3);var ownIndex=-1,ownProps=objectTypes[typeof iterable]&&keys(iterable),length=ownProps?ownProps.length:0;while(++ownIndex<length){index=ownProps[ownIndex];if(callback(iterable[index],index,collection)===false)return result}return result};function forOwnRight(object,callback,thisArg){var props=keys(object),length=props.length;callback=baseCreateCallback(callback,thisArg,3);while(length--){var key=props[length];if(callback(object[key],key,object)===false){break}}return object}function functions(object){var result=[];forIn(object,function(value,key){if(isFunction(value)){result.push(key)}});return result.sort()}function has(object,property){return object?hasOwnProperty.call(object,property):false}function invert(object){var index=-1,props=keys(object),length=props.length,result={};while(++index<length){var key=props[index];result[object[key]]=key}return result}function isBoolean(value){return value===true||value===false||toString.call(value)==boolClass}function isDate(value){return value?typeof value=="object"&&toString.call(value)==dateClass:false}function isElement(value){return value?value.nodeType===1:false}function isEmpty(value){var result=true;if(!value){return result}var className=toString.call(value),length=value.length;if(className==arrayClass||className==stringClass||className==argsClass||className==objectClass&&typeof length=="number"&&isFunction(value.splice)){return!length}forOwn(value,function(){return result=false});return result}function isEqual(a,b,callback,thisArg){return baseIsEqual(a,b,typeof callback=="function"&&baseCreateCallback(callback,thisArg,2))}function isFinite(value){return nativeIsFinite(value)&&!nativeIsNaN(parseFloat(value))}function isFunction(value){return typeof value=="function"}function isObject(value){return!!(value&&objectTypes[typeof value])}function isNaN(value){return isNumber(value)&&value!=+value}function isNull(value){return value===null}function isNumber(value){return typeof value=="number"||toString.call(value)==numberClass}var isPlainObject=function(value){if(!(value&&toString.call(value)==objectClass)){return false}var valueOf=value.valueOf,objProto=typeof valueOf=="function"&&(objProto=getPrototypeOf(valueOf))&&getPrototypeOf(objProto);return objProto?value==objProto||getPrototypeOf(value)==objProto:shimIsPlainObject(value)};function isRegExp(value){return value?typeof value=="object"&&toString.call(value)==regexpClass:false}function isString(value){return typeof value=="string"||toString.call(value)==stringClass}function isUndefined(value){return typeof value=="undefined"}function merge(object){var args=arguments,length=2;if(!isObject(object)){return object}if(typeof args[2]!="number"){length=args.length}if(length>3&&typeof args[length-2]=="function"){var callback=baseCreateCallback(args[--length-1],args[length--],2)}else if(length>2&&typeof args[length-1]=="function"){callback=args[--length]}var sources=nativeSlice.call(arguments,1,length),index=-1,stackA=getArray(),stackB=getArray();while(++index<length){baseMerge(object,sources[index],callback,stackA,stackB)}releaseArray(stackA);releaseArray(stackB);return object}function omit(object,callback,thisArg){var indexOf=getIndexOf(),isFunc=typeof callback=="function",result={};if(isFunc){callback=lodash.createCallback(callback,thisArg,3)}else{var props=baseFlatten(arguments,true,false,1)}forIn(object,function(value,key,object){if(isFunc?!callback(value,key,object):indexOf(props,key)<0){result[key]=value}});return result}function pairs(object){var index=-1,props=keys(object),length=props.length,result=Array(length);while(++index<length){var key=props[index];result[index]=[key,object[key]]}return result}function pick(object,callback,thisArg){var result={};if(typeof callback!="function"){var index=-1,props=baseFlatten(arguments,true,false,1),length=isObject(object)?props.length:0;while(++index<length){var key=props[index];if(key in object){result[key]=object[key]}}}else{callback=lodash.createCallback(callback,thisArg,3);forIn(object,function(value,key,object){if(callback(value,key,object)){result[key]=value}})}return result}function transform(object,callback,accumulator,thisArg){var isArr=isArray(object);callback=baseCreateCallback(callback,thisArg,4);if(accumulator==null){if(isArr){accumulator=[]}else{var ctor=object&&object.constructor,proto=ctor&&ctor.prototype;accumulator=createObject(proto)}}(isArr?forEach:forOwn)(object,function(value,index,object){return callback(accumulator,value,index,object)});return accumulator}function values(object){var index=-1,props=keys(object),length=props.length,result=Array(length);while(++index<length){result[index]=object[props[index]]}return result}function at(collection){var args=arguments,index=-1,props=baseFlatten(args,true,false,1),length=args[2]&&args[2][args[1]]===collection?1:props.length,result=Array(length);while(++index<length){result[index]=collection[props[index]]}return result}function contains(collection,target,fromIndex){var index=-1,indexOf=getIndexOf(),length=collection?collection.length:0,result=false;fromIndex=(fromIndex<0?nativeMax(0,length+fromIndex):fromIndex)||0;if(isArray(collection)){result=indexOf(collection,target,fromIndex)>-1}else if(typeof length=="number"){result=(isString(collection)?collection.indexOf(target,fromIndex):indexOf(collection,target,fromIndex))>-1}else{forOwn(collection,function(value){if(++index>=fromIndex){return!(result=value===target)}})}return result}var countBy=createAggregator(function(result,value,key){hasOwnProperty.call(result,key)?result[key]++:result[key]=1});function every(collection,callback,thisArg){var result=true;callback=lodash.createCallback(callback,thisArg,3);var index=-1,length=collection?collection.length:0;if(typeof length=="number"){while(++index<length){if(!(result=!!callback(collection[index],index,collection))){break}}}else{forOwn(collection,function(value,index,collection){return result=!!callback(value,index,collection)})}return result}function filter(collection,callback,thisArg){var result=[];callback=lodash.createCallback(callback,thisArg,3);var index=-1,length=collection?collection.length:0;if(typeof length=="number"){while(++index<length){var value=collection[index];if(callback(value,index,collection)){result.push(value)}}}else{forOwn(collection,function(value,index,collection){if(callback(value,index,collection)){result.push(value)}})}return result}function find(collection,callback,thisArg){callback=lodash.createCallback(callback,thisArg,3);var index=-1,length=collection?collection.length:0;if(typeof length=="number"){while(++index<length){var value=collection[index];if(callback(value,index,collection)){return value}}}else{var result;forOwn(collection,function(value,index,collection){if(callback(value,index,collection)){result=value;return false}});return result}}function findLast(collection,callback,thisArg){var result;callback=lodash.createCallback(callback,thisArg,3);forEachRight(collection,function(value,index,collection){if(callback(value,index,collection)){result=value;return false}});return result}function forEach(collection,callback,thisArg){var index=-1,length=collection?collection.length:0;callback=callback&&typeof thisArg=="undefined"?callback:baseCreateCallback(callback,thisArg,3);if(typeof length=="number"){while(++index<length){if(callback(collection[index],index,collection)===false){break}}}else{forOwn(collection,callback)}return collection}function forEachRight(collection,callback,thisArg){var length=collection?collection.length:0;callback=callback&&typeof thisArg=="undefined"?callback:baseCreateCallback(callback,thisArg,3);if(typeof length=="number"){while(length--){if(callback(collection[length],length,collection)===false){break}}}else{var props=keys(collection);length=props.length;forOwn(collection,function(value,key,collection){key=props?props[--length]:--length;return callback(collection[key],key,collection)})}return collection}var groupBy=createAggregator(function(result,value,key){(hasOwnProperty.call(result,key)?result[key]:result[key]=[]).push(value)});var indexBy=createAggregator(function(result,value,key){result[key]=value});function invoke(collection,methodName){var args=nativeSlice.call(arguments,2),index=-1,isFunc=typeof methodName=="function",length=collection?collection.length:0,result=Array(typeof length=="number"?length:0);forEach(collection,function(value){result[++index]=(isFunc?methodName:value[methodName]).apply(value,args)});return result}function map(collection,callback,thisArg){var index=-1,length=collection?collection.length:0;callback=lodash.createCallback(callback,thisArg,3);if(typeof length=="number"){var result=Array(length);while(++index<length){result[index]=callback(collection[index],index,collection)}}else{result=[];forOwn(collection,function(value,key,collection){result[++index]=callback(value,key,collection)})}return result}function max(collection,callback,thisArg){var computed=-Infinity,result=computed;if(!callback&&isArray(collection)){var index=-1,length=collection.length;while(++index<length){var value=collection[index];if(value>result){result=value}}}else{callback=!callback&&isString(collection)?charAtCallback:lodash.createCallback(callback,thisArg,3);
forEach(collection,function(value,index,collection){var current=callback(value,index,collection);if(current>computed){computed=current;result=value}})}return result}function min(collection,callback,thisArg){var computed=Infinity,result=computed;if(!callback&&isArray(collection)){var index=-1,length=collection.length;while(++index<length){var value=collection[index];if(value<result){result=value}}}else{callback=!callback&&isString(collection)?charAtCallback:lodash.createCallback(callback,thisArg,3);forEach(collection,function(value,index,collection){var current=callback(value,index,collection);if(current<computed){computed=current;result=value}})}return result}function pluck(collection,property){var index=-1,length=collection?collection.length:0;if(typeof length=="number"){var result=Array(length);while(++index<length){result[index]=collection[index][property]}}return result||map(collection,property)}function reduce(collection,callback,accumulator,thisArg){if(!collection)return accumulator;var noaccum=arguments.length<3;callback=baseCreateCallback(callback,thisArg,4);var index=-1,length=collection.length;if(typeof length=="number"){if(noaccum){accumulator=collection[++index]}while(++index<length){accumulator=callback(accumulator,collection[index],index,collection)}}else{forOwn(collection,function(value,index,collection){accumulator=noaccum?(noaccum=false,value):callback(accumulator,value,index,collection)})}return accumulator}function reduceRight(collection,callback,accumulator,thisArg){var noaccum=arguments.length<3;callback=baseCreateCallback(callback,thisArg,4);forEachRight(collection,function(value,index,collection){accumulator=noaccum?(noaccum=false,value):callback(accumulator,value,index,collection)});return accumulator}function reject(collection,callback,thisArg){callback=lodash.createCallback(callback,thisArg,3);return filter(collection,function(value,index,collection){return!callback(value,index,collection)})}function sample(collection,n,guard){var length=collection?collection.length:0;if(typeof length!="number"){collection=values(collection)}if(n==null||guard){return collection?collection[random(length-1)]:undefined}var result=shuffle(collection);result.length=nativeMin(nativeMax(0,n),result.length);return result}function shuffle(collection){var index=-1,length=collection?collection.length:0,result=Array(typeof length=="number"?length:0);forEach(collection,function(value){var rand=random(++index);result[index]=result[rand];result[rand]=value});return result}function size(collection){var length=collection?collection.length:0;return typeof length=="number"?length:keys(collection).length}function some(collection,callback,thisArg){var result;callback=lodash.createCallback(callback,thisArg,3);var index=-1,length=collection?collection.length:0;if(typeof length=="number"){while(++index<length){if(result=callback(collection[index],index,collection)){break}}}else{forOwn(collection,function(value,index,collection){return!(result=callback(value,index,collection))})}return!!result}function sortBy(collection,callback,thisArg){var index=-1,length=collection?collection.length:0,result=Array(typeof length=="number"?length:0);callback=lodash.createCallback(callback,thisArg,3);forEach(collection,function(value,key,collection){var object=result[++index]=getObject();object.criteria=callback(value,key,collection);object.index=index;object.value=value});length=result.length;result.sort(compareAscending);while(length--){var object=result[length];result[length]=object.value;releaseObject(object)}return result}function toArray(collection){if(collection&&typeof collection.length=="number"){return slice(collection)}return values(collection)}var where=filter;function compact(array){var index=-1,length=array?array.length:0,result=[];while(++index<length){var value=array[index];if(value){result.push(value)}}return result}function difference(array){var index=-1,indexOf=getIndexOf(),length=array?array.length:0,seen=baseFlatten(arguments,true,true,1),result=[];var isLarge=length>=largeArraySize&&indexOf===baseIndexOf;if(isLarge){var cache=createCache(seen);if(cache){indexOf=cacheIndexOf;seen=cache}else{isLarge=false}}while(++index<length){var value=array[index];if(indexOf(seen,value)<0){result.push(value)}}if(isLarge){releaseObject(seen)}return result}function findIndex(array,callback,thisArg){var index=-1,length=array?array.length:0;callback=lodash.createCallback(callback,thisArg,3);while(++index<length){if(callback(array[index],index,array)){return index}}return-1}function findLastIndex(array,callback,thisArg){var length=array?array.length:0;callback=lodash.createCallback(callback,thisArg,3);while(length--){if(callback(array[length],length,array)){return length}}return-1}function first(array,callback,thisArg){var n=0,length=array?array.length:0;if(typeof callback!="number"&&callback!=null){var index=-1;callback=lodash.createCallback(callback,thisArg,3);while(++index<length&&callback(array[index],index,array)){n++}}else{n=callback;if(n==null||thisArg){return array?array[0]:undefined}}return slice(array,0,nativeMin(nativeMax(0,n),length))}function flatten(array,isShallow,callback,thisArg){if(typeof isShallow!="boolean"&&isShallow!=null){thisArg=callback;callback=!(thisArg&&thisArg[isShallow]===array)?isShallow:null;isShallow=false}if(callback!=null){array=map(array,callback,thisArg)}return baseFlatten(array,isShallow)}function indexOf(array,value,fromIndex){if(typeof fromIndex=="number"){var length=array?array.length:0;fromIndex=fromIndex<0?nativeMax(0,length+fromIndex):fromIndex||0}else if(fromIndex){var index=sortedIndex(array,value);return array[index]===value?index:-1}return baseIndexOf(array,value,fromIndex)}function initial(array,callback,thisArg){var n=0,length=array?array.length:0;if(typeof callback!="number"&&callback!=null){var index=length;callback=lodash.createCallback(callback,thisArg,3);while(index--&&callback(array[index],index,array)){n++}}else{n=callback==null||thisArg?1:callback||n}return slice(array,0,nativeMin(nativeMax(0,length-n),length))}function intersection(array){var args=arguments,argsLength=args.length,argsIndex=-1,caches=getArray(),index=-1,indexOf=getIndexOf(),length=array?array.length:0,result=[],seen=getArray();while(++argsIndex<argsLength){var value=args[argsIndex];caches[argsIndex]=indexOf===baseIndexOf&&(value?value.length:0)>=largeArraySize&&createCache(argsIndex?args[argsIndex]:seen)}outer:while(++index<length){var cache=caches[0];value=array[index];if((cache?cacheIndexOf(cache,value):indexOf(seen,value))<0){argsIndex=argsLength;(cache||seen).push(value);while(--argsIndex){cache=caches[argsIndex];if((cache?cacheIndexOf(cache,value):indexOf(args[argsIndex],value))<0){continue outer}}result.push(value)}}while(argsLength--){cache=caches[argsLength];if(cache){releaseObject(cache)}}releaseArray(caches);releaseArray(seen);return result}function last(array,callback,thisArg){var n=0,length=array?array.length:0;if(typeof callback!="number"&&callback!=null){var index=length;callback=lodash.createCallback(callback,thisArg,3);while(index--&&callback(array[index],index,array)){n++}}else{n=callback;if(n==null||thisArg){return array?array[length-1]:undefined}}return slice(array,nativeMax(0,length-n))}function lastIndexOf(array,value,fromIndex){var index=array?array.length:0;if(typeof fromIndex=="number"){index=(fromIndex<0?nativeMax(0,index+fromIndex):nativeMin(fromIndex,index-1))+1}while(index--){if(array[index]===value){return index}}return-1}function pull(array){var args=arguments,argsIndex=0,argsLength=args.length,length=array?array.length:0;while(++argsIndex<argsLength){var index=-1,value=args[argsIndex];while(++index<length){if(array[index]===value){splice.call(array,index--,1);length--}}}return array}function range(start,end,step){start=+start||0;step=typeof step=="number"?step:+step||1;if(end==null){end=start;start=0}var index=-1,length=nativeMax(0,ceil((end-start)/(step||1))),result=Array(length);while(++index<length){result[index]=start;start+=step}return result}function remove(array,callback,thisArg){var index=-1,length=array?array.length:0,result=[];callback=lodash.createCallback(callback,thisArg,3);while(++index<length){var value=array[index];if(callback(value,index,array)){result.push(value);splice.call(array,index--,1);length--}}return result}function rest(array,callback,thisArg){if(typeof callback!="number"&&callback!=null){var n=0,index=-1,length=array?array.length:0;callback=lodash.createCallback(callback,thisArg,3);while(++index<length&&callback(array[index],index,array)){n++}}else{n=callback==null||thisArg?1:nativeMax(0,callback)}return slice(array,n)}function sortedIndex(array,value,callback,thisArg){var low=0,high=array?array.length:low;callback=callback?lodash.createCallback(callback,thisArg,1):identity;value=callback(value);while(low<high){var mid=low+high>>>1;callback(array[mid])<value?low=mid+1:high=mid}return low}function union(array){return baseUniq(baseFlatten(arguments,true,true))}function uniq(array,isSorted,callback,thisArg){if(typeof isSorted!="boolean"&&isSorted!=null){thisArg=callback;callback=!(thisArg&&thisArg[isSorted]===array)?isSorted:null;isSorted=false}if(callback!=null){callback=lodash.createCallback(callback,thisArg,3)}return baseUniq(array,isSorted,callback)}function without(array){return difference(array,nativeSlice.call(arguments,1))}function zip(){var array=arguments.length>1?arguments:arguments[0],index=-1,length=array?max(pluck(array,"length")):0,result=Array(length<0?0:length);while(++index<length){result[index]=pluck(array,index)}return result}function zipObject(keys,values){var index=-1,length=keys?keys.length:0,result={};while(++index<length){var key=keys[index];if(values){result[key]=values[index]}else if(key){result[key[0]]=key[1]}}return result}function after(n,func){if(!isFunction(func)){throw new TypeError}return function(){if(--n<1){return func.apply(this,arguments)}}}function bind(func,thisArg){return arguments.length>2?createBound(func,17,nativeSlice.call(arguments,2),null,thisArg):createBound(func,1,null,null,thisArg)}function bindAll(object){var funcs=arguments.length>1?baseFlatten(arguments,true,false,1):functions(object),index=-1,length=funcs.length;while(++index<length){var key=funcs[index];object[key]=createBound(object[key],1,null,null,object)}return object}function bindKey(object,key){return arguments.length>2?createBound(key,19,nativeSlice.call(arguments,2),null,object):createBound(key,3,null,null,object)}function compose(){var funcs=arguments,length=funcs.length;while(length--){if(!isFunction(funcs[length])){throw new TypeError}}return function(){var args=arguments,length=funcs.length;while(length--){args=[funcs[length].apply(this,args)]}return args[0]}}function createCallback(func,thisArg,argCount){var type=typeof func;if(func==null||type=="function"){return baseCreateCallback(func,thisArg,argCount)}if(type!="object"){return function(object){return object[func]}}var props=keys(func),key=props[0],a=func[key];if(props.length==1&&a===a&&!isObject(a)){return function(object){var b=object[key];return a===b&&(a!==0||1/a==1/b)}}return function(object){var length=props.length,result=false;while(length--){if(!(result=baseIsEqual(object[props[length]],func[props[length]],null,true))){break}}return result}}function curry(func,arity){arity=typeof arity=="number"?arity:+arity||func.length;return createBound(func,4,null,null,null,arity)}function debounce(func,wait,options){var args,maxTimeoutId,result,stamp,thisArg,timeoutId,trailingCall,lastCalled=0,maxWait=false,trailing=true;if(!isFunction(func)){throw new TypeError}wait=nativeMax(0,wait)||0;if(options===true){var leading=true;trailing=false}else if(isObject(options)){leading=options.leading;maxWait="maxWait"in options&&(nativeMax(wait,options.maxWait)||0);trailing="trailing"in options?options.trailing:trailing}var delayed=function(){var remaining=wait-(now()-stamp);if(remaining<=0){if(maxTimeoutId){clearTimeout(maxTimeoutId)}var isCalled=trailingCall;maxTimeoutId=timeoutId=trailingCall=undefined;if(isCalled){lastCalled=now();result=func.apply(thisArg,args)}}else{timeoutId=setTimeout(delayed,remaining)}};var maxDelayed=function(){if(timeoutId){clearTimeout(timeoutId)}maxTimeoutId=timeoutId=trailingCall=undefined;if(trailing||maxWait!==wait){lastCalled=now();result=func.apply(thisArg,args)}};return function(){args=arguments;stamp=now();thisArg=this;trailingCall=trailing&&(timeoutId||!leading);if(maxWait===false){var leadingCall=leading&&!timeoutId}else{if(!maxTimeoutId&&!leading){lastCalled=stamp}var remaining=maxWait-(stamp-lastCalled);if(remaining<=0){if(maxTimeoutId){maxTimeoutId=clearTimeout(maxTimeoutId)}lastCalled=stamp;result=func.apply(thisArg,args)}else if(!maxTimeoutId){maxTimeoutId=setTimeout(maxDelayed,remaining)}}if(!timeoutId&&wait!==maxWait){timeoutId=setTimeout(delayed,wait)}if(leadingCall){result=func.apply(thisArg,args)}return result}}function defer(func){if(!isFunction(func)){throw new TypeError}var args=nativeSlice.call(arguments,1);return setTimeout(function(){func.apply(undefined,args)},1)}if(isV8&&moduleExports&&typeof setImmediate=="function"){defer=function(func){if(!isFunction(func)){throw new TypeError}return setImmediate.apply(context,arguments)}}function delay(func,wait){if(!isFunction(func)){throw new TypeError}var args=nativeSlice.call(arguments,2);return setTimeout(function(){func.apply(undefined,args)},wait)}function memoize(func,resolver){if(!isFunction(func)){throw new TypeError}var memoized=function(){var cache=memoized.cache,key=resolver?resolver.apply(this,arguments):keyPrefix+arguments[0];return hasOwnProperty.call(cache,key)?cache[key]:cache[key]=func.apply(this,arguments)};memoized.cache={};return memoized}function once(func){var ran,result;if(!isFunction(func)){throw new TypeError}return function(){if(ran){return result}ran=true;result=func.apply(this,arguments);func=null;return result}}function partial(func){return createBound(func,16,nativeSlice.call(arguments,1))}function partialRight(func){return createBound(func,32,null,nativeSlice.call(arguments,1))}function throttle(func,wait,options){var leading=true,trailing=true;if(!isFunction(func)){throw new TypeError}if(options===false){leading=false}else if(isObject(options)){leading="leading"in options?options.leading:leading;trailing="trailing"in options?options.trailing:trailing}debounceOptions.leading=leading;debounceOptions.maxWait=wait;debounceOptions.trailing=trailing;var result=debounce(func,wait,debounceOptions);return result}function wrap(value,wrapper){if(!isFunction(wrapper)){throw new TypeError}return function(){var args=[value];push.apply(args,arguments);return wrapper.apply(this,args)}}function escape(string){return string==null?"":String(string).replace(reUnescapedHtml,escapeHtmlChar)}function identity(value){return value}function mixin(object,source){var ctor=object,isFunc=!source||isFunction(ctor);if(!source){ctor=lodashWrapper;source=object;object=lodash}forEach(functions(source),function(methodName){var func=object[methodName]=source[methodName];if(isFunc){ctor.prototype[methodName]=function(){var value=this.__wrapped__,args=[value];push.apply(args,arguments);var result=func.apply(object,args);if(value&&typeof value=="object"&&value===result){return this}result=new ctor(result);result.__chain__=this.__chain__;return result}}})}function noConflict(){context._=oldDash;return this}var parseInt=nativeParseInt(whitespace+"08")==8?nativeParseInt:function(value,radix){return nativeParseInt(isString(value)?value.replace(reLeadingSpacesAndZeros,""):value,radix||0)};function random(min,max,floating){var noMin=min==null,noMax=max==null;if(floating==null){if(typeof min=="boolean"&&noMax){floating=min;min=1}else if(!noMax&&typeof max=="boolean"){floating=max;noMax=true}}if(noMin&&noMax){max=1}min=+min||0;if(noMax){max=min;min=0}else{max=+max||0}var rand=nativeRandom();return floating||min%1||max%1?nativeMin(min+rand*(max-min+parseFloat("1e-"+((rand+"").length-1))),max):min+floor(rand*(max-min+1))}function result(object,property){if(object){var value=object[property];return isFunction(value)?object[property]():value}}function template(text,data,options){var settings=lodash.templateSettings;text||(text="");options=defaults({},options,settings);var imports=defaults({},options.imports,settings.imports),importsKeys=keys(imports),importsValues=values(imports);var isEvaluating,index=0,interpolate=options.interpolate||reNoMatch,source="__p += '";var reDelimiters=RegExp((options.escape||reNoMatch).source+"|"+interpolate.source+"|"+(interpolate===reInterpolate?reEsTemplate:reNoMatch).source+"|"+(options.evaluate||reNoMatch).source+"|$","g");text.replace(reDelimiters,function(match,escapeValue,interpolateValue,esTemplateValue,evaluateValue,offset){interpolateValue||(interpolateValue=esTemplateValue);source+=text.slice(index,offset).replace(reUnescapedString,escapeStringChar);if(escapeValue){source+="' +\n__e("+escapeValue+") +\n'"}if(evaluateValue){isEvaluating=true;source+="';\n"+evaluateValue+";\n__p += '"}if(interpolateValue){source+="' +\n((__t = ("+interpolateValue+")) == null ? '' : __t) +\n'"}index=offset+match.length;return match});source+="';\n";var variable=options.variable,hasVariable=variable;if(!hasVariable){variable="obj";source="with ("+variable+") {\n"+source+"\n}\n"}source=(isEvaluating?source.replace(reEmptyStringLeading,""):source).replace(reEmptyStringMiddle,"$1").replace(reEmptyStringTrailing,"$1;");source="function("+variable+") {\n"+(hasVariable?"":variable+" || ("+variable+" = {});\n")+"var __t, __p = '', __e = _.escape"+(isEvaluating?", __j = Array.prototype.join;\n"+"function print() { __p += __j.call(arguments, '') }\n":";\n")+source+"return __p\n}";var sourceURL="\n/*\n//# sourceURL="+(options.sourceURL||"/lodash/template/source["+templateCounter++ +"]")+"\n*/";try{var result=Function(importsKeys,"return "+source+sourceURL).apply(undefined,importsValues)}catch(e){e.source=source;throw e}if(data){return result(data)}result.source=source;return result}function times(n,callback,thisArg){n=(n=+n)>-1?n:0;var index=-1,result=Array(n);callback=baseCreateCallback(callback,thisArg,1);while(++index<n){result[index]=callback(index)}return result}function unescape(string){return string==null?"":String(string).replace(reEscapedHtml,unescapeHtmlChar)}function uniqueId(prefix){var id=++idCounter;return String(prefix==null?"":prefix)+id}function chain(value){value=new lodashWrapper(value);value.__chain__=true;return value}function tap(value,interceptor){interceptor(value);return value}function wrapperChain(){this.__chain__=true;return this}function wrapperToString(){return String(this.__wrapped__)}function wrapperValueOf(){return this.__wrapped__}lodash.after=after;lodash.assign=assign;lodash.at=at;lodash.bind=bind;lodash.bindAll=bindAll;lodash.bindKey=bindKey;lodash.chain=chain;lodash.compact=compact;lodash.compose=compose;lodash.countBy=countBy;lodash.createCallback=createCallback;lodash.curry=curry;lodash.debounce=debounce;lodash.defaults=defaults;lodash.defer=defer;lodash.delay=delay;lodash.difference=difference;lodash.filter=filter;lodash.flatten=flatten;lodash.forEach=forEach;lodash.forEachRight=forEachRight;lodash.forIn=forIn;lodash.forInRight=forInRight;lodash.forOwn=forOwn;lodash.forOwnRight=forOwnRight;lodash.functions=functions;lodash.groupBy=groupBy;lodash.indexBy=indexBy;lodash.initial=initial;lodash.intersection=intersection;lodash.invert=invert;lodash.invoke=invoke;lodash.keys=keys;lodash.map=map;lodash.max=max;lodash.memoize=memoize;lodash.merge=merge;lodash.min=min;lodash.omit=omit;lodash.once=once;lodash.pairs=pairs;lodash.partial=partial;lodash.partialRight=partialRight;lodash.pick=pick;lodash.pluck=pluck;lodash.pull=pull;lodash.range=range;lodash.reject=reject;lodash.remove=remove;lodash.rest=rest;lodash.shuffle=shuffle;lodash.sortBy=sortBy;lodash.tap=tap;lodash.throttle=throttle;lodash.times=times;lodash.toArray=toArray;lodash.transform=transform;lodash.union=union;lodash.uniq=uniq;lodash.values=values;lodash.where=where;lodash.without=without;lodash.wrap=wrap;lodash.zip=zip;lodash.zipObject=zipObject;lodash.collect=map;lodash.drop=rest;lodash.each=forEach;lodash.eachRight=forEachRight;lodash.extend=assign;lodash.methods=functions;lodash.object=zipObject;lodash.select=filter;lodash.tail=rest;lodash.unique=uniq;lodash.unzip=zip;mixin(lodash);lodash.clone=clone;lodash.cloneDeep=cloneDeep;lodash.contains=contains;lodash.escape=escape;lodash.every=every;lodash.find=find;lodash.findIndex=findIndex;lodash.findKey=findKey;lodash.findLast=findLast;lodash.findLastIndex=findLastIndex;lodash.findLastKey=findLastKey;lodash.has=has;lodash.identity=identity;lodash.indexOf=indexOf;lodash.isArguments=isArguments;lodash.isArray=isArray;lodash.isBoolean=isBoolean;lodash.isDate=isDate;lodash.isElement=isElement;lodash.isEmpty=isEmpty;lodash.isEqual=isEqual;lodash.isFinite=isFinite;lodash.isFunction=isFunction;lodash.isNaN=isNaN;lodash.isNull=isNull;lodash.isNumber=isNumber;lodash.isObject=isObject;lodash.isPlainObject=isPlainObject;lodash.isRegExp=isRegExp;lodash.isString=isString;lodash.isUndefined=isUndefined;lodash.lastIndexOf=lastIndexOf;lodash.mixin=mixin;lodash.noConflict=noConflict;lodash.parseInt=parseInt;lodash.random=random;lodash.reduce=reduce;lodash.reduceRight=reduceRight;lodash.result=result;lodash.runInContext=runInContext;lodash.size=size;lodash.some=some;lodash.sortedIndex=sortedIndex;lodash.template=template;lodash.unescape=unescape;lodash.uniqueId=uniqueId;lodash.all=every;lodash.any=some;lodash.detect=find;lodash.findWhere=find;lodash.foldl=reduce;lodash.foldr=reduceRight;lodash.include=contains;lodash.inject=reduce;forOwn(lodash,function(func,methodName){if(!lodash.prototype[methodName]){lodash.prototype[methodName]=function(){var args=[this.__wrapped__],chainAll=this.__chain__;push.apply(args,arguments);var result=func.apply(lodash,args);return chainAll?new lodashWrapper(result,chainAll):result}}});lodash.first=first;lodash.last=last;lodash.sample=sample;lodash.take=first;lodash.head=first;forOwn(lodash,function(func,methodName){var callbackable=methodName!=="sample";if(!lodash.prototype[methodName]){lodash.prototype[methodName]=function(n,guard){var chainAll=this.__chain__,result=func(this.__wrapped__,n,guard);return!chainAll&&(n==null||guard&&!(callbackable&&typeof n=="function"))?result:new lodashWrapper(result,chainAll)}}});lodash.VERSION="2.2.1";lodash.prototype.chain=wrapperChain;lodash.prototype.toString=wrapperToString;lodash.prototype.value=wrapperValueOf;lodash.prototype.valueOf=wrapperValueOf;forEach(["join","pop","shift"],function(methodName){var func=arrayRef[methodName];lodash.prototype[methodName]=function(){var chainAll=this.__chain__,result=func.apply(this.__wrapped__,arguments);return chainAll?new lodashWrapper(result,chainAll):result}});forEach(["push","reverse","sort","unshift"],function(methodName){var func=arrayRef[methodName];lodash.prototype[methodName]=function(){func.apply(this.__wrapped__,arguments);return this}});forEach(["concat","slice","splice"],function(methodName){var func=arrayRef[methodName];lodash.prototype[methodName]=function(){return new lodashWrapper(func.apply(this.__wrapped__,arguments),this.__chain__)}});return lodash}var _=runInContext();if(typeof define=="function"&&typeof define.amd=="object"&&define.amd){root._=_;define(function(){return _})}else if(freeExports&&freeModule){if(moduleExports){(freeModule.exports=_)._=_}else{freeExports._=_}}else{root._=_}}).call(this)},{}],40:[function(require,module,exports){(function(){var ss={};if(typeof module!=="undefined"){exports=module.exports=ss}else{this.ss=ss}function linear_regression(){var linreg={},data=[];linreg.data=function(x){if(!arguments.length)return data;data=x.slice();return linreg};linreg.mb=function(){var m,b;if(data.length==1){m=0;b=data[0][1]}else{var sum_x=0,sum_y=0,sum_xx=0,sum_xy=0;for(var i=0;i<data.length;i++){sum_x+=data[i][0];sum_y+=data[i][1];sum_xx+=data[i][0]*data[i][0];sum_xy+=data[i][0]*data[i][1]}m=(data.length*sum_xy-sum_x*sum_y)/(data.length*sum_xx-sum_x*sum_x);b=sum_y/data.length-m*sum_x/data.length}return{m:m,b:b}};linreg.m=function(){return linreg.mb().m};linreg.b=function(){return linreg.mb().b};linreg.line=function(){var mb=linreg.mb(),m=mb.m,b=mb.b;return function(x){return b+m*x}};return linreg}function r_squared(data,f){if(data.length<2)return 1;var sum=0,average;for(var i=0;i<data.length;i++){sum+=data[i][1]}average=sum/data.length;var sum_of_squares=0;for(var j=0;j<data.length;j++){sum_of_squares+=Math.pow(average-data[j][1],2)}var err=0;for(var k=0;k<data.length;k++){err+=Math.pow(data[k][1]-f(data[k][0]),2)}return 1-err/sum_of_squares}function bayesian(){var bayes_model={},total_count=0,data={};bayes_model.train=function(item,category){if(!data[category])data[category]={};for(var k in item){var v=item[k];if(data[category][k]===undefined)data[category][k]={};if(data[category][k][v]===undefined)data[category][k][v]=0;data[category][k][item[k]]++}total_count++};bayes_model.score=function(item){var odds={},category;for(var k in item){var v=item[k];for(category in data){if(odds[category]===undefined)odds[category]={};if(data[category][k]){odds[category][k+"_"+v]=(data[category][k][v]||0)/total_count}else{odds[category][k+"_"+v]=0}}}var odds_sums={};for(category in odds){for(var combination in odds[category]){if(odds_sums[category]===undefined)odds_sums[category]=0;odds_sums[category]+=odds[category][combination]}}return odds_sums};return bayes_model}function sum(x){var value=0;for(var i=0;i<x.length;i++){value+=x[i]}return value}function mean(x){if(x.length===0)return null;return sum(x)/x.length}function geometric_mean(x){if(x.length===0)return null;var value=1;for(var i=0;i<x.length;i++){if(x[i]<=0)return null;value*=x[i]}return Math.pow(value,1/x.length)}function min(x){var value;for(var i=0;i<x.length;i++){if(x[i]<value||value===undefined)value=x[i]}return value}function max(x){var value;for(var i=0;i<x.length;i++){if(x[i]>value||value===undefined)value=x[i]}return value}function variance(x){if(x.length===0)return null;var mean_value=mean(x),deviations=[];for(var i=0;i<x.length;i++){deviations.push(Math.pow(x[i]-mean_value,2))}return mean(deviations)}function standard_deviation(x){if(x.length===0)return null;return Math.sqrt(variance(x))}function sum_nth_power_deviations(x,n){var mean_value=mean(x),sum=0;for(var i=0;i<x.length;i++){sum+=Math.pow(x[i]-mean_value,n)}return sum}function sample_variance(x){if(x.length<=1)return null;var sum_squared_deviations_value=sum_nth_power_deviations(x,2);return sum_squared_deviations_value/(x.length-1)}function sample_standard_deviation(x){if(x.length<=1)return null;return Math.sqrt(sample_variance(x))}function sample_covariance(x,y){if(x.length<=1||x.length!=y.length){return null}var xmean=mean(x),ymean=mean(y),sum=0;for(var i=0;i<x.length;i++){sum+=(x[i]-xmean)*(y[i]-ymean)}return sum/(x.length-1)}function sample_correlation(x,y){var cov=sample_covariance(x,y),xstd=sample_standard_deviation(x),ystd=sample_standard_deviation(y);if(cov===null||xstd===null||ystd===null){return null}return cov/xstd/ystd}function median(x){if(x.length===0)return null;var sorted=x.slice().sort(function(a,b){return a-b});if(sorted.length%2===1){return sorted[(sorted.length-1)/2]}else{var a=sorted[sorted.length/2-1];var b=sorted[sorted.length/2];return(a+b)/2}}function mode(x){if(x.length===0)return null;else if(x.length===1)return x[0];var sorted=x.slice().sort(function(a,b){return a-b});var last=sorted[0],value,max_seen=0,seen_this=1;for(var i=1;i<sorted.length+1;i++){if(sorted[i]!==last){if(seen_this>max_seen){max_seen=seen_this;seen_this=1;value=last}last=sorted[i]}else{seen_this++}}return value}function t_test(sample,x){var sample_mean=mean(sample);var sd=standard_deviation(sample);var rootN=Math.sqrt(sample.length);return(sample_mean-x)/(sd/rootN)}function quantile(sample,p){if(sample.length===0)return null;if(p>=1||p<=0)return null;var sorted=sample.slice().sort(function(a,b){return a-b});var idx=sorted.length*p;if(idx%1!==0){return sorted[Math.ceil(idx)-1]}else if(sample.length%2===0){return(sorted[idx-1]+sorted[idx])/2}else{return sorted[idx]}}function iqr(sample){if(sample.length===0)return null;return quantile(sample,.75)-quantile(sample,.25)}function mad(x){if(!x||x.length===0)return null;var median_value=median(x),median_absolute_deviations=[];for(var i=0;i<x.length;i++){median_absolute_deviations.push(Math.abs(x[i]-median_value))}return median(median_absolute_deviations)}function jenksMatrices(data,n_classes){var lower_class_limits=[],variance_combinations=[],i,j,variance=0;for(i=0;i<data.length+1;i++){var tmp1=[],tmp2=[];for(j=0;j<n_classes+1;j++){tmp1.push(0);tmp2.push(0)}lower_class_limits.push(tmp1);variance_combinations.push(tmp2)}for(i=1;i<n_classes+1;i++){lower_class_limits[1][i]=1;variance_combinations[1][i]=0;for(j=2;j<data.length+1;j++){variance_combinations[j][i]=Infinity}}for(var l=2;l<data.length+1;l++){var sum=0,sum_squares=0,w=0,i4=0;for(var m=1;m<l+1;m++){var lower_class_limit=l-m+1,val=data[lower_class_limit-1];w++;sum+=val;sum_squares+=val*val;variance=sum_squares-sum*sum/w;i4=lower_class_limit-1;if(i4!==0){for(j=2;j<n_classes+1;j++){if(variance_combinations[l][j]>=variance+variance_combinations[i4][j-1]){lower_class_limits[l][j]=lower_class_limit;variance_combinations[l][j]=variance+variance_combinations[i4][j-1]}}}}lower_class_limits[l][1]=1;variance_combinations[l][1]=variance}return{lower_class_limits:lower_class_limits,variance_combinations:variance_combinations}}function jenksBreaks(data,lower_class_limits,n_classes){var k=data.length-1,kclass=[],countNum=n_classes;kclass[n_classes]=data[data.length-1];kclass[0]=data[0];while(countNum>1){kclass[countNum-1]=data[lower_class_limits[k][countNum]-2];k=lower_class_limits[k][countNum]-1;countNum--}return kclass}function jenks(data,n_classes){if(n_classes>data.length)return null;data=data.slice().sort(function(a,b){return a-b});var matrices=jenksMatrices(data,n_classes),lower_class_limits=matrices.lower_class_limits;return jenksBreaks(data,lower_class_limits,n_classes)}function sample_skewness(x){if(x.length<3)return null;var n=x.length,cubed_s=Math.pow(sample_standard_deviation(x),3),sum_cubed_deviations=sum_nth_power_deviations(x,3);return n*sum_cubed_deviations/((n-1)*(n-2)*cubed_s)}var standard_normal_table=[.5,.504,.508,.512,.516,.5199,.5239,.5279,.5319,.5359,.5398,.5438,.5478,.5517,.5557,.5596,.5636,.5675,.5714,.5753,.5793,.5832,.5871,.591,.5948,.5987,.6026,.6064,.6103,.6141,.6179,.6217,.6255,.6293,.6331,.6368,.6406,.6443,.648,.6517,.6554,.6591,.6628,.6664,.67,.6736,.6772,.6808,.6844,.6879,.6915,.695,.6985,.7019,.7054,.7088,.7123,.7157,.719,.7224,.7257,.7291,.7324,.7357,.7389,.7422,.7454,.7486,.7517,.7549,.758,.7611,.7642,.7673,.7704,.7734,.7764,.7794,.7823,.7852,.7881,.791,.7939,.7967,.7995,.8023,.8051,.8078,.8106,.8133,.8159,.8186,.8212,.8238,.8264,.8289,.8315,.834,.8365,.8389,.8413,.8438,.8461,.8485,.8508,.8531,.8554,.8577,.8599,.8621,.8643,.8665,.8686,.8708,.8729,.8749,.877,.879,.881,.883,.8849,.8869,.8888,.8907,.8925,.8944,.8962,.898,.8997,.9015,.9032,.9049,.9066,.9082,.9099,.9115,.9131,.9147,.9162,.9177,.9192,.9207,.9222,.9236,.9251,.9265,.9279,.9292,.9306,.9319,.9332,.9345,.9357,.937,.9382,.9394,.9406,.9418,.9429,.9441,.9452,.9463,.9474,.9484,.9495,.9505,.9515,.9525,.9535,.9545,.9554,.9564,.9573,.9582,.9591,.9599,.9608,.9616,.9625,.9633,.9641,.9649,.9656,.9664,.9671,.9678,.9686,.9693,.9699,.9706,.9713,.9719,.9726,.9732,.9738,.9744,.975,.9756,.9761,.9767,.9772,.9778,.9783,.9788,.9793,.9798,.9803,.9808,.9812,.9817,.9821,.9826,.983,.9834,.9838,.9842,.9846,.985,.9854,.9857,.9861,.9864,.9868,.9871,.9875,.9878,.9881,.9884,.9887,.989,.9893,.9896,.9898,.9901,.9904,.9906,.9909,.9911,.9913,.9916,.9918,.992,.9922,.9925,.9927,.9929,.9931,.9932,.9934,.9936,.9938,.994,.9941,.9943,.9945,.9946,.9948,.9949,.9951,.9952,.9953,.9955,.9956,.9957,.9959,.996,.9961,.9962,.9963,.9964,.9965,.9966,.9967,.9968,.9969,.997,.9971,.9972,.9973,.9974,.9974,.9975,.9976,.9977,.9977,.9978,.9979,.9979,.998,.9981,.9981,.9982,.9982,.9983,.9984,.9984,.9985,.9985,.9986,.9986,.9987,.9987,.9987,.9988,.9988,.9989,.9989,.9989,.999,.999];
function cumulative_std_normal_probability(z){var absZ=Math.abs(z),row=Math.floor(absZ*10),column=10*(Math.floor(absZ*100)/10-Math.floor(absZ*100/10)),index=Math.min(row*10+column,standard_normal_table.length-1);if(z>=0){return standard_normal_table[index]}else{return(1-standard_normal_table[index]).toFixed(4)}}function z_score(x,mean,standard_deviation){return(x-mean)/standard_deviation}function mixin(){var support=!!(Object.defineProperty&&Object.defineProperties);if(!support)throw new Error("without defineProperty, simple-statistics cannot be mixed in");var arrayMethods=["median","standard_deviation","sum","mean","min","max","quantile","geometric_mean"];function wrap(method){return function(){var args=Array.prototype.slice.apply(arguments);args.unshift(this);return ss[method].apply(ss,args)}}for(var i=0;i<arrayMethods.length;i++){Object.defineProperty(Array.prototype,arrayMethods[i],{value:wrap(arrayMethods[i]),configurable:true,enumerable:false,writable:true})}}ss.linear_regression=linear_regression;ss.standard_deviation=standard_deviation;ss.r_squared=r_squared;ss.median=median;ss.mean=mean;ss.mode=mode;ss.min=min;ss.max=max;ss.sum=sum;ss.quantile=quantile;ss.iqr=iqr;ss.mad=mad;ss.sample_covariance=sample_covariance;ss.sample_correlation=sample_correlation;ss.sample_variance=sample_variance;ss.sample_standard_deviation=sample_standard_deviation;ss.sample_skewness=sample_skewness;ss.geometric_mean=geometric_mean;ss.variance=variance;ss.t_test=t_test;ss.jenksMatrices=jenksMatrices;ss.jenksBreaks=jenksBreaks;ss.jenks=jenks;ss.bayesian=bayesian;ss.z_score=z_score;ss.cumulative_std_normal_probability=cumulative_std_normal_probability;ss.standard_normal_table=standard_normal_table;ss.average=mean;ss.interquartile_range=iqr;ss.mixin=mixin;ss.median_absolute_deviation=mad})(this)},{}],41:[function(require,module,exports){var __dirname="/node_modules/topojson";var fs=require("fs");var topojson=module.exports=new Function("topojson","return "+fs.readFileSync(__dirname+"/topojson.js","utf8"))();topojson.topology=require("./lib/topojson/topology");topojson.simplify=require("./lib/topojson/simplify");topojson.clockwise=require("./lib/topojson/clockwise");topojson.filter=require("./lib/topojson/filter");topojson.prune=require("./lib/topojson/prune");topojson.bind=require("./lib/topojson/bind")},{"./lib/topojson/bind":42,"./lib/topojson/clockwise":45,"./lib/topojson/filter":49,"./lib/topojson/prune":52,"./lib/topojson/simplify":54,"./lib/topojson/topology":57,fs:69}],42:[function(require,module,exports){var type=require("./type"),topojson=require("../../");module.exports=function(topology,propertiesById){var bind=type({geometry:function(geometry){var properties0=geometry.properties,properties1=propertiesById[geometry.id];if(properties1){if(properties0)for(var k in properties1)properties0[k]=properties1[k];else for(var k in properties1){geometry.properties=properties1;break}}this.defaults.geometry.call(this,geometry)},LineString:noop,MultiLineString:noop,Point:noop,MultiPoint:noop,Polygon:noop,MultiPolygon:noop});for(var key in topology.objects){bind.object(topology.objects[key])}};function noop(){}},{"../../":41,"./type":67}],43:[function(require,module,exports){module.exports=function(objects){var x0=Infinity,y0=Infinity,x1=-Infinity,y1=-Infinity;function boundGeometry(geometry){if(geometry&&boundGeometryType.hasOwnProperty(geometry.type))boundGeometryType[geometry.type](geometry)}var boundGeometryType={GeometryCollection:function(o){o.geometries.forEach(boundGeometry)},Point:function(o){boundPoint(o.coordinates)},MultiPoint:function(o){o.coordinates.forEach(boundPoint)},LineString:function(o){boundLine(o.coordinates)},MultiLineString:function(o){o.coordinates.forEach(boundLine)},Polygon:function(o){o.coordinates.forEach(boundLine)},MultiPolygon:function(o){o.coordinates.forEach(boundMultiLine)}};function boundPoint(coordinates){var x=coordinates[0],y=coordinates[1];if(x<x0)x0=x;if(x>x1)x1=x;if(y<y0)y0=y;if(y>y1)y1=y}function boundLine(coordinates){coordinates.forEach(boundPoint)}function boundMultiLine(coordinates){coordinates.forEach(boundLine)}for(var key in objects){boundGeometry(objects[key])}return[x0,y0,x1,y1]}},{}],44:[function(require,module,exports){exports.name="cartesian";exports.formatDistance=formatDistance;exports.ringArea=ringArea;exports.absoluteArea=Math.abs;exports.triangleArea=triangleArea;exports.distance=distance;function formatDistance(d){return d.toString()}function ringArea(ring){var i=0,n=ring.length,area=ring[n-1][1]*ring[0][0]-ring[n-1][0]*ring[0][1];while(++i<n){area+=ring[i-1][1]*ring[i][0]-ring[i-1][0]*ring[i][1]}return-area*.5}function triangleArea(triangle){return Math.abs((triangle[0][0]-triangle[2][0])*(triangle[1][1]-triangle[0][1])-(triangle[0][0]-triangle[1][0])*(triangle[2][1]-triangle[0][1]))}function distance(x0,y0,x1,y1){var dx=x0-x1,dy=y0-y1;return Math.sqrt(dx*dx+dy*dy)}},{}],45:[function(require,module,exports){var type=require("./type"),systems=require("./coordinate-systems"),topojson=require("../../");module.exports=function(object,options){if(object.type==="Topology")clockwiseTopology(object,options);else clockwiseGeometry(object,options)};function clockwiseGeometry(object,options){var system=null;if(options)"coordinate-system"in options&&(system=systems[options["coordinate-system"]]);type({LineString:noop,MultiLineString:noop,Point:noop,MultiPoint:noop,Polygon:function(polygon){clockwisePolygon(polygon.coordinates)},MultiPolygon:function(multiPolygon){multiPolygon.coordinates.forEach(clockwisePolygon)}}).object(object);function clockwisePolygon(rings){if(rings.length&&system.ringArea(r=rings[0])<0)r.reverse();for(var i=1,n=rings.length,r;i<n;++i){if(system.ringArea(r=rings[i])>0)r.reverse()}}}function clockwiseTopology(topology,options){var system=null;if(options)"coordinate-system"in options&&(system=systems[options["coordinate-system"]]);var clockwise=type({LineString:noop,MultiLineString:noop,Point:noop,MultiPoint:noop,Polygon:function(polygon){clockwisePolygon(polygon.arcs)},MultiPolygon:function(multiPolygon){multiPolygon.arcs.forEach(clockwisePolygon)}});for(var key in topology.objects){clockwise.object(topology.objects[key])}function clockwisePolygon(rings){if(rings.length&&ringArea(r=rings[0])<0)reverse(r);for(var i=1,n=rings.length,r;i<n;++i){if(ringArea(r=rings[i])>0)reverse(r)}}function ringArea(ring){return system.ringArea(topojson.feature(topology,{type:"Polygon",arcs:[ring]}).geometry.coordinates[0])}function reverse(ring){var i=-1,n=ring.length;ring.reverse();while(++i<n)ring[i]=~ring[i]}}function noop(){}},{"../../":41,"./coordinate-systems":47,"./type":67}],46:[function(require,module,exports){module.exports=function(objects,id){if(arguments.length<2)id=function(d){return d.id};function idObject(object){if(object&&idObjectType.hasOwnProperty(object.type))idObjectType[object.type](object)}function idFeature(feature){var i=id(feature);if(i==null)delete feature.id;else feature.id=i}var idObjectType={Feature:idFeature,FeatureCollection:function(collection){collection.features.forEach(idFeature)}};for(var key in objects){idObject(objects[key])}return objects}},{}],47:[function(require,module,exports){module.exports={cartesian:require("./cartesian"),spherical:require("./spherical")}},{"./cartesian":44,"./spherical":55}],48:[function(require,module,exports){module.exports=function(topology){var arcs=topology.arcs,i=-1,n=arcs.length;while(++i<n){var arc=arcs[i],j=0,m=arc.length,point=arc[0],x0=point[0],y0=point[1],x1,y1;while(++j<m){point=arc[j];x1=point[0];y1=point[1];arc[j]=[x1-x0,y1-y0];x0=x1;y0=y1}}return topology}},{}],49:[function(require,module,exports){var type=require("./type"),prune=require("./prune"),clockwise=require("./clockwise"),systems=require("./coordinate-systems"),topojson=require("../../");module.exports=function(topology,options){var system=null,forceClockwise=true,minimumArea;if(options)"coordinate-system"in options&&(system=systems[options["coordinate-system"]]),"minimum-area"in options&&(minimumArea=+options["minimum-area"]),"force-clockwise"in options&&(forceClockwise=!!options["force-clockwise"]);if(forceClockwise)clockwise(topology,options);if(!(minimumArea>0))minimumArea=Number.MIN_VALUE;var filter=type({LineString:noop,MultiLineString:noop,Point:noop,MultiPoint:noop,Polygon:function(polygon){polygon.arcs=polygon.arcs.filter(ringArea);if(!polygon.arcs.length){polygon.type=null;delete polygon.arcs}},MultiPolygon:function(multiPolygon){multiPolygon.arcs=multiPolygon.arcs.map(function(polygon){return polygon.filter(ringArea)}).filter(function(polygon){return polygon.length});if(!multiPolygon.arcs.length){multiPolygon.type=null;delete multiPolygon.arcs}},GeometryCollection:function(collection){this.defaults.GeometryCollection.call(this,collection);collection.geometries=collection.geometries.filter(function(geometry){return geometry.type!=null});if(!collection.geometries.length){collection.type=null;delete collection.geometries}}});for(var key in topology.objects){filter.object(topology.objects[key])}prune(topology,options);function ringArea(ring){var topopolygon={type:"Polygon",arcs:[ring]},geopolygon=topojson.feature(topology,topopolygon),exterior=geopolygon.geometry.coordinates[0],exteriorArea=system.absoluteArea(system.ringArea(exterior));return exteriorArea>=minimumArea}};function noop(){}},{"../../":41,"./clockwise":45,"./coordinate-systems":47,"./prune":52,"./type":67}],50:[function(require,module,exports){module.exports=function(objects){function geomifyObject(object){return(object&&geomifyObjectType.hasOwnProperty(object.type)?geomifyObjectType[object.type]:geomifyGeometry)(object)}function geomifyFeature(feature){var geometry=feature.geometry;if(geometry==null){feature.type=null}else{geomifyGeometry(geometry);feature.type=geometry.type;if(geometry.geometries)feature.geometries=geometry.geometries;else if(geometry.coordinates)feature.coordinates=geometry.coordinates}delete feature.geometry;return feature}function geomifyGeometry(geometry){if(!geometry)return{type:null};if(geomifyGeometryType.hasOwnProperty(geometry.type))geomifyGeometryType[geometry.type](geometry);return geometry}var geomifyObjectType={Feature:geomifyFeature,FeatureCollection:function(collection){collection.type="GeometryCollection";collection.geometries=collection.features;collection.features.forEach(geomifyFeature);delete collection.features;return collection}};var geomifyGeometryType={GeometryCollection:function(o){var geometries=o.geometries,i=-1,n=geometries.length;while(++i<n)geometries[i]=geomifyGeometry(geometries[i])},MultiPoint:function(o){if(!o.coordinates.length){o.type=null;delete o.coordinates}else if(o.coordinates.length<2){o.type="Point";o.coordinates=o.coordinates[0]}},LineString:function(o){if(!o.coordinates.length){o.type=null;delete o.coordinates}},MultiLineString:function(o){for(var lines=o.coordinates,i=0,N=0,n=lines.length;i<n;++i){var line=lines[i];if(line.length)lines[N++]=line}if(!N){o.type=null;delete o.coordinates}else if(N<2){o.type="LineString";o.coordinates=lines[0]}else{o.coordinates.length=N}},Polygon:function(o){for(var rings=o.coordinates,i=0,N=0,n=rings.length;i<n;++i){var ring=rings[i];if(ring.length)rings[N++]=ring}if(!N){o.type=null;delete o.coordinates}else{o.coordinates.length=N}},MultiPolygon:function(o){for(var polygons=o.coordinates,j=0,M=0,m=polygons.length;j<m;++j){for(var rings=polygons[j],i=0,N=0,n=rings.length;i<n;++i){var ring=rings[i];if(ring.length)rings[N++]=ring}if(N){rings.length=N;polygons[M++]=rings}}if(!M){o.type=null;delete o.coordinates}else if(M<2){o.type="Polygon";o.coordinates=polygons[0]}else{polygons.length=M}}};for(var key in objects){objects[key]=geomifyObject(objects[key])}return objects}},{}],51:[function(require,module,exports){module.exports=function(objects,filter){function prefilterGeometry(geometry){if(!geometry)return{type:null};if(prefilterGeometryType.hasOwnProperty(geometry.type))prefilterGeometryType[geometry.type](geometry);return geometry}var prefilterGeometryType={GeometryCollection:function(o){var geometries=o.geometries,i=-1,n=geometries.length;while(++i<n)geometries[i]=prefilterGeometry(geometries[i])},Polygon:function(o){for(var rings=o.coordinates,i=0,N=0,n=rings.length;i<n;++i){var ring=rings[i];if(filter(ring))rings[N++]=ring}if(!N){o.type=null;delete o.coordinates}else{o.coordinates.length=N}},MultiPolygon:function(o){for(var polygons=o.coordinates,j=0,M=0,m=polygons.length;j<m;++j){for(var rings=polygons[j],i=0,N=0,n=rings.length;i<n;++i){var ring=rings[i];if(filter(ring))rings[N++]=ring}if(N){rings.length=N;polygons[M++]=rings}}if(!M){o.type=null;delete o.coordinates}else if(M<2){o.type="Polygon";o.coordinates=polygons[0]}else{polygons.length=M}}};for(var key in objects){objects[key]=prefilterGeometry(objects[key])}return objects}},{}],52:[function(require,module,exports){module.exports=function(topology,options){var verbose=false,objects=topology.objects,oldArcs=topology.arcs,oldArcCount=oldArcs.length,newArcs=topology.arcs=[],newArcCount=0,newIndexByOldIndex=new Array(oldArcs.length);if(options)"verbose"in options&&(verbose=!!options["verbose"]);function pruneGeometry(geometry){if(geometry&&pruneGeometryType.hasOwnProperty(geometry.type))pruneGeometryType[geometry.type](geometry)}var pruneGeometryType={GeometryCollection:function(o){o.geometries.forEach(pruneGeometry)},LineString:function(o){pruneArcs(o.arcs)},MultiLineString:function(o){o.arcs.forEach(pruneArcs)},Polygon:function(o){o.arcs.forEach(pruneArcs)},MultiPolygon:function(o){o.arcs.forEach(pruneMultiArcs)}};function pruneArcs(arcs){for(var i=0,m=0,n=arcs.length;i<n;++i){var oldIndex=arcs[i],oldReverse=oldIndex<0&&(oldIndex=~oldIndex,true),oldArc=oldArcs[oldIndex],newIndex;if(oldArc.length<3&&!oldArc[1][0]&&!oldArc[1][1])continue;if((newIndex=newIndexByOldIndex[oldIndex])==null){newIndexByOldIndex[oldIndex]=newIndex=newArcCount++;newArcs[newIndex]=oldArcs[oldIndex]}arcs[m++]=oldReverse?~newIndex:newIndex}if(!(arcs.length=m)&&n){if((newIndex=newIndexByOldIndex[oldIndex])==null){newIndexByOldIndex[oldIndex]=newIndex=newArcCount++;newArcs[newIndex]=oldArcs[oldIndex]}arcs[0]=oldReverse?~newIndex:newIndex}}function pruneMultiArcs(arcs){arcs.forEach(pruneArcs)}for(var key in objects){pruneGeometry(objects[key])}if(verbose)console.warn("prune: retained "+newArcCount+" / "+oldArcCount+" arcs ("+Math.round(newArcCount/oldArcCount*100)+"%)");return topology};function noop(){}},{}],53:[function(require,module,exports){module.exports=function(objects,bbox,Q){var x0=isFinite(bbox[0])?bbox[0]:0,y0=isFinite(bbox[1])?bbox[1]:0,x1=isFinite(bbox[2])?bbox[2]:0,y1=isFinite(bbox[3])?bbox[3]:0,kx=x1-x0?(Q-1)/(x1-x0):1,ky=y1-y0?(Q-1)/(y1-y0):1;function quantizeGeometry(geometry){if(geometry&&quantizeGeometryType.hasOwnProperty(geometry.type))quantizeGeometryType[geometry.type](geometry)}var quantizeGeometryType={GeometryCollection:function(o){o.geometries.forEach(quantizeGeometry)},Point:function(o){quantizePoint(o.coordinates)},MultiPoint:function(o){o.coordinates.forEach(quantizePoint)},LineString:function(o){var line=o.coordinates;quantizeLine(line);if(line.length<2)line[1]=line[0]},MultiLineString:function(o){for(var lines=o.coordinates,i=0,n=lines.length;i<n;++i){var line=lines[i];quantizeLine(line);if(line.length<2)line[1]=line[0]}},Polygon:function(o){for(var rings=o.coordinates,i=0,n=rings.length;i<n;++i){var ring=rings[i];quantizeLine(ring);while(ring.length<4)ring.push(ring[0])}},MultiPolygon:function(o){for(var polygons=o.coordinates,i=0,n=polygons.length;i<n;++i){for(var rings=polygons[i],j=0,m=rings.length;j<m;++j){var ring=rings[j];quantizeLine(ring);while(ring.length<4)ring.push(ring[0])}}}};function quantizePoint(coordinates){coordinates[0]=Math.round((coordinates[0]-x0)*kx);coordinates[1]=Math.round((coordinates[1]-y0)*ky)}function quantizeLine(coordinates){var i=0,j=1,n=coordinates.length,pi=coordinates[0],pj,px=pi[0]=Math.round((pi[0]-x0)*kx),py=pi[1]=Math.round((pi[1]-y0)*ky),x,y;while(++i<n){pi=coordinates[i];x=Math.round((pi[0]-x0)*kx);y=Math.round((pi[1]-y0)*ky);if(x!==px||y!==py){pj=coordinates[j++];pj[0]=px=x;pj[1]=py=y}}coordinates.length=j}for(var key in objects){quantizeGeometry(objects[key])}return{scale:[1/kx,1/ky],translate:[x0,y0]}}},{}],54:[function(require,module,exports){var topojson=require("../../"),systems=require("./coordinate-systems");module.exports=function(topology,options){var minimumArea=0,retainProportion,verbose=false,system=null,N=topology.arcs.reduce(function(p,v){return p+v.length},0),M=0;if(options)"minimum-area"in options&&(minimumArea=+options["minimum-area"]),"coordinate-system"in options&&(system=systems[options["coordinate-system"]]),"retain-proportion"in options&&(retainProportion=+options["retain-proportion"]),"verbose"in options&&(verbose=!!options["verbose"]);topojson.presimplify(topology,system.triangleArea);if(retainProportion){var areas=[];topology.arcs.forEach(function(arc){arc.forEach(function(point){areas.push(point[2])})});options["minimum-area"]=minimumArea=N?areas.sort(function(a,b){return b-a})[Math.ceil((N-1)*retainProportion)]:0;if(verbose)console.warn("simplification: effective minimum area "+minimumArea.toPrecision(3))}topology.arcs.forEach(topology.transform?function(arc){var dx=0,dy=0,i=-1,j=-1,n=arc.length,source,target;while(++i<n){source=arc[i];if(source[2]>=minimumArea){target=arc[++j];target[0]=source[0]+dx;target[1]=source[1]+dy;dx=dy=0}else{dx+=source[0];dy+=source[1]}}arc.length=++j}:function(arc){var i=-1,j=-1,n=arc.length,point;while(++i<n){point=arc[i];if(point[2]>=minimumArea){arc[++j]=point}}arc.length=++j});topology.arcs.forEach(function(arc){var i=-1,n=arc.length;while(++i<n)arc[i].length=2;M+=arc.length});if(verbose)console.warn("simplification: retained "+M+" / "+N+" points ("+Math.round(M/N*100)+"%)");return topology}},{"../../":41,"./coordinate-systems":47}],55:[function(require,module,exports){var π=Math.PI,π_4=π/4,radians=π/180;exports.name="spherical";exports.formatDistance=formatDistance;exports.ringArea=ringArea;exports.absoluteArea=absoluteArea;exports.triangleArea=triangleArea;exports.distance=haversinDistance;function formatDistance(radians){var km=radians*6371;return(km>1?km.toFixed(3)+"km":(km*1e3).toPrecision(3)+"m")+" ("+(radians*180/Math.PI).toPrecision(3)+"°)"}function ringArea(ring){if(!ring.length)return 0;var area=0,p=ring[0],λ=p[0]*radians,φ=p[1]*radians/2+π_4,λ0=λ,cosφ0=Math.cos(φ),sinφ0=Math.sin(φ);for(var i=1,n=ring.length;i<n;++i){p=ring[i],λ=p[0]*radians,φ=p[1]*radians/2+π_4;var dλ=λ-λ0,cosφ=Math.cos(φ),sinφ=Math.sin(φ),k=sinφ0*sinφ,u=cosφ0*cosφ+k*Math.cos(dλ),v=k*Math.sin(dλ);area+=Math.atan2(v,u);λ0=λ,cosφ0=cosφ,sinφ0=sinφ}return 2*(area>π?area-2*π:area<-π?area+2*π:area)}function absoluteArea(a){return a<0?a+4*π:a}function triangleArea(t){var a=distance(t[0],t[1]),b=distance(t[1],t[2]),c=distance(t[2],t[0]),s=(a+b+c)/2;return 4*Math.atan(Math.sqrt(Math.max(0,Math.tan(s/2)*Math.tan((s-a)/2)*Math.tan((s-b)/2)*Math.tan((s-c)/2))))}function distance(a,b){var Δλ=(b[0]-a[0])*radians,sinΔλ=Math.sin(Δλ),cosΔλ=Math.cos(Δλ),sinφ0=Math.sin(a[1]*radians),cosφ0=Math.cos(a[1]*radians),sinφ1=Math.sin(b[1]*radians),cosφ1=Math.cos(b[1]*radians),_;return Math.atan2(Math.sqrt((_=cosφ1*sinΔλ)*_+(_=cosφ0*sinφ1-sinφ0*cosφ1*cosΔλ)*_),sinφ0*sinφ1+cosφ0*cosφ1*cosΔλ)}function haversinDistance(x0,y0,x1,y1){x0*=radians,y0*=radians,x1*=radians,y1*=radians;return 2*Math.asin(Math.sqrt(haversin(y1-y0)+Math.cos(y0)*Math.cos(y1)*haversin(x1-x0)))}function haversin(x){return(x=Math.sin(x/2))*x}},{}],56:[function(require,module,exports){var type=require("./type");module.exports=function(objects,transform){var ε=.01,x0=-180,x0e=x0+ε,x1=180,x1e=x1-ε,y0=-90,y0e=y0+ε,y1=90,y1e=y1-ε,fragments=[];if(transform){var kx=transform.scale[0],ky=transform.scale[1],dx=transform.translate[0],dy=transform.translate[1];x0=Math.round((x0-dx)/kx);x1=Math.round((x1-dx)/kx);y0=Math.round((y0-dy)/ky);y1=Math.round((y1-dy)/ky);x0e=Math.round((x0e-dx)/kx);x1e=Math.round((x1e-dx)/kx);y0e=Math.round((y0e-dy)/ky);y1e=Math.round((y1e-dy)/ky)}function normalizePoint(y){return y<=y0e?[0,y0]:y>=y1e?[0,y1]:[x0,y]}var stitch=type({polygon:function(polygon){var rings=[];for(var j=0,m=polygon.length;j<m;++j){var ring=polygon[j],fragments=[];fragments.push(ring);for(var i=0,n=ring.length;i<n;++i){var point=ring[i],x=point[0],y=point[1];if(x<=x0e||x>=x1e||y<=y0e||y>=y1e){for(var k=i+1;k<n;++k){var pointk=ring[k],xk=pointk[0],yk=pointk[1];if(xk>x0e&&xk<x1e&&yk>y0e&&yk<y1e)break}if(k===i+1)continue;if(i){var fragmentBefore=ring.slice(0,i+1);fragmentBefore[fragmentBefore.length-1]=normalizePoint(y);fragments[fragments.length-1]=fragmentBefore}else{fragments.pop()}if(k>=n)break;fragments.push(ring=ring.slice(k-1));ring[0]=normalizePoint(ring[0][1]);i=-1;n=ring.length}}var fragmentByStart={},fragmentByEnd={};for(var i=0,n=fragments.length;i<n;++i){var fragment=fragments[i],start=fragment[0],end=fragment[fragment.length-1];if(start[0]===end[0]&&start[1]===end[1]){rings.push(fragment);fragments[i]=null;continue}fragment.index=i;fragmentByStart[start]=fragmentByEnd[end]=fragment}for(var i=0;i<n;++i){var fragment=fragments[i];if(fragment){var start=fragment[0],end=fragment[fragment.length-1],startFragment=fragmentByEnd[start],endFragment=fragmentByStart[end];delete fragmentByStart[start];delete fragmentByEnd[end];if(start[0]===end[0]&&start[1]===end[1]){rings.push(fragment);continue}if(startFragment){delete fragmentByEnd[start];delete fragmentByStart[startFragment[0]];startFragment.pop();fragments[startFragment.index]=null;fragment=startFragment.concat(fragment);if(startFragment===endFragment){rings.push(fragment)}else{fragment.index=n++;fragments.push(fragmentByStart[fragment[0]]=fragmentByEnd[fragment[fragment.length-1]]=fragment)}}else if(endFragment){delete fragmentByStart[end];delete fragmentByEnd[endFragment[endFragment.length-1]];fragment.pop();fragment=fragment.concat(endFragment);fragment.index=n++;fragments[endFragment.index]=null;fragments.push(fragmentByStart[fragment[0]]=fragmentByEnd[fragment[fragment.length-1]]=fragment)}else{fragment.push(fragment[0]);rings.push(fragment)}}}}for(var i=0,n=polygon.length=rings.length;i<n;++i){polygon[i]=rings[i]}}});for(var key in objects){stitch.object(objects[key])}}},{"./type":67}],57:[function(require,module,exports){var type=require("./type"),stitch=require("./stitch"),systems=require("./coordinate-systems"),topologize=require("./topology/index"),delta=require("./delta"),geomify=require("./geomify"),prefilter=require("./prefilter"),quantize=require("./quantize"),bounds=require("./bounds"),computeId=require("./compute-id"),transformProperties=require("./transform-properties");var ε=1e-6;module.exports=function(objects,options){var Q=1e4,id=function(d){return d.id},propertyTransform=function(){},transform,minimumArea=0,stitchPoles=true,verbose=false,system=null;if(options)"verbose"in options&&(verbose=!!options["verbose"]),"stitch-poles"in options&&(stitchPoles=!!options["stitch-poles"]),"coordinate-system"in options&&(system=systems[options["coordinate-system"]]),"minimum-area"in options&&(minimumArea=+options["minimum-area"]),"quantization"in options&&(Q=+options["quantization"]),"id"in options&&(id=options["id"]),"property-transform"in options&&(propertyTransform=options["property-transform"]);computeId(objects,id);transformProperties(objects,propertyTransform);geomify(objects);var bbox=bounds(objects);var oversize=bbox[0]<-180-ε||bbox[1]<-90-ε||bbox[2]>180+ε||bbox[3]>90+ε;if(!system){system=systems[oversize?"cartesian":"spherical"];if(options)options["coordinate-system"]=system.name}if(system===systems.spherical){if(oversize)throw new Error("spherical coordinates outside of [±180°, ±90°]");if(bbox[0]<-180+ε)bbox[0]=-180;if(bbox[1]<-90+ε)bbox[1]=-90;if(bbox[2]>180-ε)bbox[2]=180;if(bbox[3]>90-ε)bbox[3]=90}if(verbose){console.warn("bounds: "+bbox.join(" ")+" ("+system.name+")")}if(minimumArea)prefilter(objects,function(ring){return system.absoluteArea(system.ringArea(ring))>=minimumArea});if(Q){transform=quantize(objects,bbox,Q);if(verbose){console.warn("quantization: "+transform.scale.map(function(degrees){return system.formatDistance(degrees/180*Math.PI)}).join(" "))}}if(system===systems.spherical&&stitchPoles){stitch(objects,transform)}var topology=topologize(objects);topology.bbox=bbox;if(verbose){console.warn("topology: "+topology.arcs.length+" arcs, "+topology.arcs.reduce(function(p,v){return p+v.length},0)+" points")}if(Q)topology.transform=transform,delta(topology);return topology}},{"./bounds":43,"./compute-id":46,"./coordinate-systems":47,"./delta":48,"./geomify":50,"./prefilter":51,"./quantize":53,"./stitch":56,"./topology/index":62,"./transform-properties":66,"./type":67}],58:[function(require,module,exports){var join=require("./join");module.exports=function(topology){var junctionByPoint=join(topology),coordinates=topology.coordinates,lines=topology.lines,rings=topology.rings;for(var i=0,n=lines.length;i<n;++i){var line=lines[i],lineMid=line[0],lineEnd=line[1];while(++lineMid<lineEnd){if(junctionByPoint.get(coordinates[lineMid])){var next={0:lineMid,1:line[1]};line[1]=lineMid;line=line.next=next}}}for(var i=0,n=rings.length;i<n;++i){var ring=rings[i],ringStart=ring[0],ringMid=ringStart,ringEnd=ring[1],ringFixed=junctionByPoint.get(coordinates[ringStart]);while(++ringMid<ringEnd){if(junctionByPoint.get(coordinates[ringMid])){if(ringFixed){var next={0:ringMid,1:ring[1]};ring[1]=ringMid;ring=ring.next=next}else{rotateArray(coordinates,ringStart,ringEnd,ringEnd-ringMid);coordinates[ringEnd]=coordinates[ringStart];ringFixed=true;ringMid=ringStart}}}}return topology};function rotateArray(array,start,end,offset){reverse(array,start,end);reverse(array,start,start+offset);reverse(array,start+offset,end)}function reverse(array,start,end){for(var mid=start+(end-- -start>>1),t;start<mid;++start,--end){t=array[start],array[start]=array[end],array[end]=t}}},{"./join":63}],59:[function(require,module,exports){var join=require("./join"),hashtable=require("./hashtable"),hashPoint=require("./point-hash"),equalPoint=require("./point-equal");module.exports=function(topology){var coordinates=topology.coordinates,lines=topology.lines,rings=topology.rings,arcCount=lines.length+rings.length;delete topology.lines;delete topology.rings;for(var i=0,n=lines.length;i<n;++i){var line=lines[i];while(line=line.next)++arcCount}for(var i=0,n=rings.length;i<n;++i){var ring=rings[i];while(ring=ring.next)++arcCount}var arcsByEnd=hashtable(arcCount*2,hashPoint,equalPoint),arcs=topology.arcs=[];for(var i=0,n=lines.length;i<n;++i){var line=lines[i];do{dedupLine(line)}while(line=line.next)}for(var i=0,n=rings.length;i<n;++i){var ring=rings[i];if(ring.next){do{dedupLine(ring)}while(ring=ring.next)}else{dedupRing(ring)}}function dedupLine(arc){var startPoint,endPoint,startArcs,endArcs;if(startArcs=arcsByEnd.get(startPoint=coordinates[arc[0]])){for(var i=0,n=startArcs.length;i<n;++i){var startArc=startArcs[i];if(equalLine(startArc,arc)){arc[0]=startArc[0];arc[1]=startArc[1];return}}}if(endArcs=arcsByEnd.get(endPoint=coordinates[arc[1]])){for(var i=0,n=endArcs.length;i<n;++i){var endArc=endArcs[i];if(reverseEqualLine(endArc,arc)){arc[1]=endArc[0];arc[0]=endArc[1];return}}}if(startArcs)startArcs.push(arc);else arcsByEnd.set(startPoint,[arc]);if(endArcs)endArcs.push(arc);else arcsByEnd.set(endPoint,[arc]);arcs.push(arc)}function dedupRing(arc){var endPoint,endArcs;if(endArcs=arcsByEnd.get(endPoint=coordinates[arc[0]])){for(var i=0,n=endArcs.length;i<n;++i){var endArc=endArcs[i];if(equalRing(endArc,arc)){arc[0]=endArc[0];arc[1]=endArc[1];return}if(reverseEqualRing(endArc,arc)){arc[0]=endArc[1];arc[1]=endArc[0];return}}}if(endArcs=arcsByEnd.get(endPoint=coordinates[arc[0]+findMinimumOffset(arc)])){for(var i=0,n=endArcs.length;i<n;++i){var endArc=endArcs[i];if(equalRing(endArc,arc)){arc[0]=endArc[0];arc[1]=endArc[1];return}if(reverseEqualRing(endArc,arc)){arc[0]=endArc[1];arc[1]=endArc[0];return}}}if(endArcs)endArcs.push(arc);else arcsByEnd.set(endPoint,[arc]);arcs.push(arc)}function equalLine(arcA,arcB){var ia=arcA[0],ib=arcB[0],ja=arcA[1],jb=arcB[1];if(ia-ja!==ib-jb)return false;for(;ia<=ja;++ia,++ib)if(!equalPoint(coordinates[ia],coordinates[ib]))return false;return true}function reverseEqualLine(arcA,arcB){var ia=arcA[0],ib=arcB[0],ja=arcA[1],jb=arcB[1];if(ia-ja!==ib-jb)return false;for(;ia<=ja;++ia,--jb)if(!equalPoint(coordinates[ia],coordinates[jb]))return false;return true}function equalRing(arcA,arcB){var ia=arcA[0],ib=arcB[0],ja=arcA[1],jb=arcB[1],n=ja-ia;if(n!==jb-ib)return false;var ka=findMinimumOffset(arcA),kb=findMinimumOffset(arcB);for(var i=0;i<n;++i){if(!equalPoint(coordinates[ia+(i+ka)%n],coordinates[ib+(i+kb)%n]))return false}return true}function reverseEqualRing(arcA,arcB){var ia=arcA[0],ib=arcB[0],ja=arcA[1],jb=arcB[1],n=ja-ia;if(n!==jb-ib)return false;var ka=findMinimumOffset(arcA),kb=n-findMinimumOffset(arcB);for(var i=0;i<n;++i){if(!equalPoint(coordinates[ia+(i+ka)%n],coordinates[jb-(i+kb)%n]))return false}return true}function findMinimumOffset(arc){var start=arc[0],end=arc[1],mid=start,minimum=mid,minimumPoint=coordinates[mid];while(++mid<end){var point=coordinates[mid];if(point[0]<minimumPoint[0]||point[0]===minimumPoint[0]&&point[1]<minimumPoint[1]){minimum=mid;minimumPoint=point}}return minimum-start}return topology}},{"./hashtable":61,"./join":63,"./point-equal":64,"./point-hash":65}],60:[function(require,module,exports){module.exports=function(objects){var index=-1,lines=[],rings=[],coordinates=[];function extractGeometry(geometry){if(geometry&&extractGeometryType.hasOwnProperty(geometry.type))extractGeometryType[geometry.type](geometry)}var extractGeometryType={GeometryCollection:function(o){o.geometries.forEach(extractGeometry)},LineString:function(o){o.arcs=extractLine(o.coordinates);delete o.coordinates},MultiLineString:function(o){o.arcs=o.coordinates.map(extractLine);delete o.coordinates},Polygon:function(o){o.arcs=o.coordinates.map(extractRing);delete o.coordinates},MultiPolygon:function(o){o.arcs=o.coordinates.map(extractMultiRing);delete o.coordinates}};function extractLine(line){for(var i=0,n=line.length;i<n;++i)coordinates[++index]=line[i];var arc={0:index-n+1,1:index};lines.push(arc);return arc}function extractRing(ring){for(var i=0,n=ring.length;i<n;++i)coordinates[++index]=ring[i];var arc={0:index-n+1,1:index};rings.push(arc);return arc}function extractMultiRing(rings){return rings.map(extractRing)}for(var key in objects){extractGeometry(objects[key])}return{type:"Topology",coordinates:coordinates,lines:lines,rings:rings,objects:objects}}},{}],61:[function(require,module,exports){module.exports=function(size,hash,equal){var hashtable=new Array(size=1<<Math.ceil(Math.log(size)/Math.LN2)),mask=size-1,free=size;function set(key,value){var index=hash(key)&mask,match=hashtable[index],cycle=!index;while(match!=null){if(equal(match.key,key))return match.value=value;match=hashtable[index=index+1&mask];if(!index&&cycle++)throw new Error("full hashtable")}hashtable[index]={key:key,value:value};--free;return value}function get(key,missingValue){var index=hash(key)&mask,match=hashtable[index],cycle=!index;while(match!=null){if(equal(match.key,key))return match.value;match=hashtable[index=index+1&mask];if(!index&&cycle++)break}return missingValue}function remove(key){var index=hash(key)&mask,match=hashtable[index],cycle=!index;while(match!=null){if(equal(match.key,key)){hashtable[index]=null;match=hashtable[index=index+1&mask];if(match!=null){++free;hashtable[index]=null;set(match.key,match.value)}++free;return true}match=hashtable[index=index+1&mask];if(!index&&cycle++)break}return false}function keys(){var keys=[];for(var i=0,n=hashtable.length;i<n;++i){var match=hashtable[i];if(match!=null)keys.push(match.key)}return keys}return{set:set,get:get,remove:remove,keys:keys}}},{}],62:[function(require,module,exports){var hashtable=require("./hashtable"),extract=require("./extract"),cut=require("./cut"),dedup=require("./dedup");
module.exports=function(objects){var topology=dedup(cut(extract(objects))),coordinates=topology.coordinates,indexByArc=hashtable(topology.arcs.length,hashArc,equalArc);objects=topology.objects;topology.arcs=topology.arcs.map(function(arc,i){indexByArc.set(arc,i);return coordinates.slice(arc[0],arc[1]+1)});delete topology.coordinates;coordinates=null;function indexGeometry(geometry){if(geometry&&indexGeometryType.hasOwnProperty(geometry.type))indexGeometryType[geometry.type](geometry)}var indexGeometryType={GeometryCollection:function(o){o.geometries.forEach(indexGeometry)},LineString:function(o){o.arcs=indexArcs(o.arcs)},MultiLineString:function(o){o.arcs=o.arcs.map(indexArcs)},Polygon:function(o){o.arcs=o.arcs.map(indexArcs)},MultiPolygon:function(o){o.arcs=o.arcs.map(indexMultiArcs)}};function indexArcs(arc){var indexes=[];do{var index=indexByArc.get(arc);indexes.push(arc[0]<arc[1]?index:~index)}while(arc=arc.next);return indexes}function indexMultiArcs(arcs){return arcs.map(indexArcs)}for(var key in objects){indexGeometry(objects[key])}return topology};function hashArc(arc){var i=arc[0],j=arc[1],t;if(j<i)t=i,i=j,j=t;return i+31*j}function equalArc(arcA,arcB){var ia=arcA[0],ja=arcA[1],ib=arcB[0],jb=arcB[1],t;if(ja<ia)t=ia,ia=ja,ja=t;if(jb<ib)t=ib,ib=jb,jb=t;return ia===ib&&ja===jb}},{"./cut":58,"./dedup":59,"./extract":60,"./hashtable":61}],63:[function(require,module,exports){var hashtable=require("./hashtable"),hashPoint=require("./point-hash"),equalPoint=require("./point-equal");module.exports=function(topology){var coordinates=topology.coordinates,lines=topology.lines,rings=topology.rings,visitedByPoint,neighborsByPoint=hashtable(coordinates.length,hashPoint,equalPoint),junctionByPoint=hashtable(coordinates.length,hashPoint,equalPoint);for(var i=0,n=lines.length;i<n;++i){var line=lines[i],lineStart=line[0],lineEnd=line[1],previousPoint=null,currentPoint=coordinates[lineStart],nextPoint=coordinates[++lineStart];visitedByPoint=hashtable(lineEnd-lineStart,hashPoint,equalPoint);junctionByPoint.set(currentPoint,true);while(++lineStart<=lineEnd){sequence(previousPoint=currentPoint,currentPoint=nextPoint,nextPoint=coordinates[lineStart])}junctionByPoint.set(nextPoint,true)}for(var i=0,n=rings.length;i<n;++i){var ring=rings[i],ringStart=ring[0]+1,ringEnd=ring[1],previousPoint=coordinates[ringEnd-1],currentPoint=coordinates[ringStart-1],nextPoint=coordinates[ringStart];visitedByPoint=hashtable(ringEnd-ringStart+1,hashPoint,equalPoint);sequence(previousPoint,currentPoint,nextPoint);while(++ringStart<=ringEnd){sequence(previousPoint=currentPoint,currentPoint=nextPoint,nextPoint=coordinates[ringStart])}}function sequence(previousPoint,currentPoint,nextPoint){if(visitedByPoint.get(currentPoint))return;visitedByPoint.set(currentPoint,true);var neighbors=neighborsByPoint.get(currentPoint);if(neighbors){if(!(equalPoint(neighbors[0],previousPoint)&&equalPoint(neighbors[1],nextPoint))&&!(equalPoint(neighbors[0],nextPoint)&&equalPoint(neighbors[1],previousPoint))){junctionByPoint.set(currentPoint,true)}}else{neighborsByPoint.set(currentPoint,[previousPoint,nextPoint])}}return junctionByPoint}},{"./hashtable":61,"./point-equal":64,"./point-hash":65}],64:[function(require,module,exports){module.exports=function(pointA,pointB){return pointA[0]===pointB[0]&&pointA[1]===pointB[1]}},{}],65:[function(require,module,exports){var hashBuffer=new ArrayBuffer(8),hashFloats=new Float64Array(hashBuffer),hashInts=new Int32Array(hashBuffer);function hashFloat(x){hashFloats[0]=x;x=hashInts[1]^hashInts[0];x^=x>>>20^x>>>12;x^=x>>>7^x>>>4;return x}module.exports=function(point){var h=hashFloat(point[0])+31*hashFloat(point[1])|0;return h<0?~h:h}},{}],66:[function(require,module,exports){module.exports=function(objects,propertyTransform){if(arguments.length<2)propertyTransform=function(){};function transformObject(object){if(object&&transformObjectType.hasOwnProperty(object.type))transformObjectType[object.type](object)}function transformFeature(feature){if(feature.properties){var properties0=feature.properties,properties1={},empty=true;for(var key0 in properties0){if(propertyTransform(properties1,key0,properties0[key0])){empty=false}}if(empty)delete feature.properties;else feature.properties=properties1}}var transformObjectType={Feature:transformFeature,FeatureCollection:function(collection){collection.features.forEach(transformFeature)}};for(var key in objects){transformObject(objects[key])}return objects}},{}],67:[function(require,module,exports){module.exports=function(types){for(var type in typeDefaults){if(!(type in types)){types[type]=typeDefaults[type]}}types.defaults=typeDefaults;return types};var typeDefaults={Feature:function(feature){if(feature.geometry)this.geometry(feature.geometry)},FeatureCollection:function(collection){var features=collection.features,i=-1,n=features.length;while(++i<n)this.Feature(features[i])},GeometryCollection:function(collection){var geometries=collection.geometries,i=-1,n=geometries.length;while(++i<n)this.geometry(geometries[i])},LineString:function(lineString){this.line(lineString.coordinates)},MultiLineString:function(multiLineString){var coordinates=multiLineString.coordinates,i=-1,n=coordinates.length;while(++i<n)this.line(coordinates[i])},MultiPoint:function(multiPoint){var coordinates=multiPoint.coordinates,i=-1,n=coordinates.length;while(++i<n)this.point(coordinates[i])},MultiPolygon:function(multiPolygon){var coordinates=multiPolygon.coordinates,i=-1,n=coordinates.length;while(++i<n)this.polygon(coordinates[i])},Point:function(point){this.point(point.coordinates)},Polygon:function(polygon){this.polygon(polygon.coordinates)},object:function(object){return object==null?null:typeObjects.hasOwnProperty(object.type)?this[object.type](object):this.geometry(object)},geometry:function(geometry){return geometry==null?null:typeGeometries.hasOwnProperty(geometry.type)?this[geometry.type](geometry):null},point:function(){},line:function(coordinates){var i=-1,n=coordinates.length;while(++i<n)this.point(coordinates[i])},polygon:function(coordinates){var i=-1,n=coordinates.length;while(++i<n)this.line(coordinates[i])}};var typeGeometries={LineString:1,MultiLineString:1,MultiPoint:1,MultiPolygon:1,Point:1,Polygon:1,GeometryCollection:1};var typeObjects={Feature:1,FeatureCollection:1}},{}],68:[function(require,module,exports){var toString=Object.prototype.toString;var hasOwnProperty=Object.prototype.hasOwnProperty;function isArray(xs){return toString.call(xs)==="[object Array]"}exports.isArray=typeof Array.isArray==="function"?Array.isArray:isArray;exports.indexOf=function indexOf(xs,x){if(xs.indexOf)return xs.indexOf(x);for(var i=0;i<xs.length;i++){if(x===xs[i])return i}return-1};exports.filter=function filter(xs,fn){if(xs.filter)return xs.filter(fn);var res=[];for(var i=0;i<xs.length;i++){if(fn(xs[i],i,xs))res.push(xs[i])}return res};exports.forEach=function forEach(xs,fn,self){if(xs.forEach)return xs.forEach(fn,self);for(var i=0;i<xs.length;i++){fn.call(self,xs[i],i,xs)}};exports.map=function map(xs,fn){if(xs.map)return xs.map(fn);var out=new Array(xs.length);for(var i=0;i<xs.length;i++){out[i]=fn(xs[i],i,xs)}return out};exports.reduce=function reduce(array,callback,opt_initialValue){if(array.reduce)return array.reduce(callback,opt_initialValue);var value,isValueSet=false;if(2<arguments.length){value=opt_initialValue;isValueSet=true}for(var i=0,l=array.length;l>i;++i){if(array.hasOwnProperty(i)){if(isValueSet){value=callback(value,array[i],i,array)}else{value=array[i];isValueSet=true}}}return value};if("ab".substr(-1)!=="b"){exports.substr=function(str,start,length){if(start<0)start=str.length+start;return str.substr(start,length)}}else{exports.substr=function(str,start,length){return str.substr(start,length)}}exports.trim=function(str){if(str.trim)return str.trim();return str.replace(/^\s+|\s+$/g,"")};exports.bind=function(){var args=Array.prototype.slice.call(arguments);var fn=args.shift();if(fn.bind)return fn.bind.apply(fn,args);var self=args.shift();return function(){fn.apply(self,args.concat([Array.prototype.slice.call(arguments)]))}};function create(prototype,properties){var object;if(prototype===null){object={__proto__:null}}else{if(typeof prototype!=="object"){throw new TypeError("typeof prototype["+typeof prototype+"] != 'object'")}var Type=function(){};Type.prototype=prototype;object=new Type;object.__proto__=prototype}if(typeof properties!=="undefined"&&Object.defineProperties){Object.defineProperties(object,properties)}return object}exports.create=typeof Object.create==="function"?Object.create:create;function notObject(object){return typeof object!="object"&&typeof object!="function"||object===null}function keysShim(object){if(notObject(object)){throw new TypeError("Object.keys called on a non-object")}var result=[];for(var name in object){if(hasOwnProperty.call(object,name)){result.push(name)}}return result}function propertyShim(object){if(notObject(object)){throw new TypeError("Object.getOwnPropertyNames called on a non-object")}var result=keysShim(object);if(exports.isArray(object)&&exports.indexOf(object,"length")===-1){result.push("length")}return result}var keys=typeof Object.keys==="function"?Object.keys:keysShim;var getOwnPropertyNames=typeof Object.getOwnPropertyNames==="function"?Object.getOwnPropertyNames:propertyShim;if((new Error).hasOwnProperty("description")){var ERROR_PROPERTY_FILTER=function(obj,array){if(toString.call(obj)==="[object Error]"){array=exports.filter(array,function(name){return name!=="description"&&name!=="number"&&name!=="message"})}return array};exports.keys=function(object){return ERROR_PROPERTY_FILTER(object,keys(object))};exports.getOwnPropertyNames=function(object){return ERROR_PROPERTY_FILTER(object,getOwnPropertyNames(object))}}else{exports.keys=keys;exports.getOwnPropertyNames=getOwnPropertyNames}function valueObject(value,key){return{value:value[key]}}if(typeof Object.getOwnPropertyDescriptor==="function"){try{Object.getOwnPropertyDescriptor({a:1},"a");exports.getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor}catch(e){exports.getOwnPropertyDescriptor=function(value,key){try{return Object.getOwnPropertyDescriptor(value,key)}catch(e){return valueObject(value,key)}}}}else{exports.getOwnPropertyDescriptor=valueObject}},{}],69:[function(require,module,exports){},{}],70:[function(require,module,exports){var process=require("__browserify_process");var util=require("util");var shims=require("_shims");function normalizeArray(parts,allowAboveRoot){var up=0;for(var i=parts.length-1;i>=0;i--){var last=parts[i];if(last==="."){parts.splice(i,1)}else if(last===".."){parts.splice(i,1);up++}else if(up){parts.splice(i,1);up--}}if(allowAboveRoot){for(;up--;up){parts.unshift("..")}}return parts}var splitPathRe=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;var splitPath=function(filename){return splitPathRe.exec(filename).slice(1)};exports.resolve=function(){var resolvedPath="",resolvedAbsolute=false;for(var i=arguments.length-1;i>=-1&&!resolvedAbsolute;i--){var path=i>=0?arguments[i]:process.cwd();if(!util.isString(path)){throw new TypeError("Arguments to path.resolve must be strings")}else if(!path){continue}resolvedPath=path+"/"+resolvedPath;resolvedAbsolute=path.charAt(0)==="/"}resolvedPath=normalizeArray(shims.filter(resolvedPath.split("/"),function(p){return!!p}),!resolvedAbsolute).join("/");return(resolvedAbsolute?"/":"")+resolvedPath||"."};exports.normalize=function(path){var isAbsolute=exports.isAbsolute(path),trailingSlash=shims.substr(path,-1)==="/";path=normalizeArray(shims.filter(path.split("/"),function(p){return!!p}),!isAbsolute).join("/");if(!path&&!isAbsolute){path="."}if(path&&trailingSlash){path+="/"}return(isAbsolute?"/":"")+path};exports.isAbsolute=function(path){return path.charAt(0)==="/"};exports.join=function(){var paths=Array.prototype.slice.call(arguments,0);return exports.normalize(shims.filter(paths,function(p,index){if(!util.isString(p)){throw new TypeError("Arguments to path.join must be strings")}return p}).join("/"))};exports.relative=function(from,to){from=exports.resolve(from).substr(1);to=exports.resolve(to).substr(1);function trim(arr){var start=0;for(;start<arr.length;start++){if(arr[start]!=="")break}var end=arr.length-1;for(;end>=0;end--){if(arr[end]!=="")break}if(start>end)return[];return arr.slice(start,end-start+1)}var fromParts=trim(from.split("/"));var toParts=trim(to.split("/"));var length=Math.min(fromParts.length,toParts.length);var samePartsLength=length;for(var i=0;i<length;i++){if(fromParts[i]!==toParts[i]){samePartsLength=i;break}}var outputParts=[];for(var i=samePartsLength;i<fromParts.length;i++){outputParts.push("..")}outputParts=outputParts.concat(toParts.slice(samePartsLength));return outputParts.join("/")};exports.sep="/";exports.delimiter=":";exports.dirname=function(path){var result=splitPath(path),root=result[0],dir=result[1];if(!root&&!dir){return"."}if(dir){dir=dir.substr(0,dir.length-1)}return root+dir};exports.basename=function(path,ext){var f=splitPath(path)[2];if(ext&&f.substr(-1*ext.length)===ext){f=f.substr(0,f.length-ext.length)}return f};exports.extname=function(path){return splitPath(path)[3]}},{__browserify_process:72,_shims:68,util:71}],71:[function(require,module,exports){var shims=require("_shims");var formatRegExp=/%[sdj%]/g;exports.format=function(f){if(!isString(f)){var objects=[];for(var i=0;i<arguments.length;i++){objects.push(inspect(arguments[i]))}return objects.join(" ")}var i=1;var args=arguments;var len=args.length;var str=String(f).replace(formatRegExp,function(x){if(x==="%%")return"%";if(i>=len)return x;switch(x){case"%s":return String(args[i++]);case"%d":return Number(args[i++]);case"%j":try{return JSON.stringify(args[i++])}catch(_){return"[Circular]"}default:return x}});for(var x=args[i];i<len;x=args[++i]){if(isNull(x)||!isObject(x)){str+=" "+x}else{str+=" "+inspect(x)}}return str};function inspect(obj,opts){var ctx={seen:[],stylize:stylizeNoColor};if(arguments.length>=3)ctx.depth=arguments[2];if(arguments.length>=4)ctx.colors=arguments[3];if(isBoolean(opts)){ctx.showHidden=opts}else if(opts){exports._extend(ctx,opts)}if(isUndefined(ctx.showHidden))ctx.showHidden=false;if(isUndefined(ctx.depth))ctx.depth=2;if(isUndefined(ctx.colors))ctx.colors=false;if(isUndefined(ctx.customInspect))ctx.customInspect=true;if(ctx.colors)ctx.stylize=stylizeWithColor;return formatValue(ctx,obj,ctx.depth)}exports.inspect=inspect;inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};inspect.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"};function stylizeWithColor(str,styleType){var style=inspect.styles[styleType];if(style){return"["+inspect.colors[style][0]+"m"+str+"["+inspect.colors[style][1]+"m"}else{return str}}function stylizeNoColor(str,styleType){return str}function arrayToHash(array){var hash={};shims.forEach(array,function(val,idx){hash[val]=true});return hash}function formatValue(ctx,value,recurseTimes){if(ctx.customInspect&&value&&isFunction(value.inspect)&&value.inspect!==exports.inspect&&!(value.constructor&&value.constructor.prototype===value)){var ret=value.inspect(recurseTimes);if(!isString(ret)){ret=formatValue(ctx,ret,recurseTimes)}return ret}var primitive=formatPrimitive(ctx,value);if(primitive){return primitive}var keys=shims.keys(value);var visibleKeys=arrayToHash(keys);if(ctx.showHidden){keys=shims.getOwnPropertyNames(value)}if(keys.length===0){if(isFunction(value)){var name=value.name?": "+value.name:"";return ctx.stylize("[Function"+name+"]","special")}if(isRegExp(value)){return ctx.stylize(RegExp.prototype.toString.call(value),"regexp")}if(isDate(value)){return ctx.stylize(Date.prototype.toString.call(value),"date")}if(isError(value)){return formatError(value)}}var base="",array=false,braces=["{","}"];if(isArray(value)){array=true;braces=["[","]"]}if(isFunction(value)){var n=value.name?": "+value.name:"";base=" [Function"+n+"]"}if(isRegExp(value)){base=" "+RegExp.prototype.toString.call(value)}if(isDate(value)){base=" "+Date.prototype.toUTCString.call(value)}if(isError(value)){base=" "+formatError(value)}if(keys.length===0&&(!array||value.length==0)){return braces[0]+base+braces[1]}if(recurseTimes<0){if(isRegExp(value)){return ctx.stylize(RegExp.prototype.toString.call(value),"regexp")}else{return ctx.stylize("[Object]","special")}}ctx.seen.push(value);var output;if(array){output=formatArray(ctx,value,recurseTimes,visibleKeys,keys)}else{output=keys.map(function(key){return formatProperty(ctx,value,recurseTimes,visibleKeys,key,array)})}ctx.seen.pop();return reduceToSingleString(output,base,braces)}function formatPrimitive(ctx,value){if(isUndefined(value))return ctx.stylize("undefined","undefined");if(isString(value)){var simple="'"+JSON.stringify(value).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return ctx.stylize(simple,"string")}if(isNumber(value))return ctx.stylize(""+value,"number");if(isBoolean(value))return ctx.stylize(""+value,"boolean");if(isNull(value))return ctx.stylize("null","null")}function formatError(value){return"["+Error.prototype.toString.call(value)+"]"}function formatArray(ctx,value,recurseTimes,visibleKeys,keys){var output=[];for(var i=0,l=value.length;i<l;++i){if(hasOwnProperty(value,String(i))){output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,String(i),true))}else{output.push("")}}shims.forEach(keys,function(key){if(!key.match(/^\d+$/)){output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,key,true))}});return output}function formatProperty(ctx,value,recurseTimes,visibleKeys,key,array){var name,str,desc;desc=shims.getOwnPropertyDescriptor(value,key)||{value:value[key]};if(desc.get){if(desc.set){str=ctx.stylize("[Getter/Setter]","special")}else{str=ctx.stylize("[Getter]","special")}}else{if(desc.set){str=ctx.stylize("[Setter]","special")}}if(!hasOwnProperty(visibleKeys,key)){name="["+key+"]"}if(!str){if(shims.indexOf(ctx.seen,desc.value)<0){if(isNull(recurseTimes)){str=formatValue(ctx,desc.value,null)}else{str=formatValue(ctx,desc.value,recurseTimes-1)}if(str.indexOf("\n")>-1){if(array){str=str.split("\n").map(function(line){return"  "+line}).join("\n").substr(2)}else{str="\n"+str.split("\n").map(function(line){return"   "+line}).join("\n")}}}else{str=ctx.stylize("[Circular]","special")}}if(isUndefined(name)){if(array&&key.match(/^\d+$/)){return str}name=JSON.stringify(""+key);if(name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)){name=name.substr(1,name.length-2);name=ctx.stylize(name,"name")}else{name=name.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'");name=ctx.stylize(name,"string")}}return name+": "+str}function reduceToSingleString(output,base,braces){var numLinesEst=0;var length=shims.reduce(output,function(prev,cur){numLinesEst++;if(cur.indexOf("\n")>=0)numLinesEst++;return prev+cur.replace(/\u001b\[\d\d?m/g,"").length+1},0);if(length>60){return braces[0]+(base===""?"":base+"\n ")+" "+output.join(",\n  ")+" "+braces[1]}return braces[0]+base+" "+output.join(", ")+" "+braces[1]}function isArray(ar){return shims.isArray(ar)}exports.isArray=isArray;function isBoolean(arg){return typeof arg==="boolean"}exports.isBoolean=isBoolean;function isNull(arg){return arg===null}exports.isNull=isNull;function isNullOrUndefined(arg){return arg==null}exports.isNullOrUndefined=isNullOrUndefined;function isNumber(arg){return typeof arg==="number"}exports.isNumber=isNumber;function isString(arg){return typeof arg==="string"}exports.isString=isString;function isSymbol(arg){return typeof arg==="symbol"}exports.isSymbol=isSymbol;function isUndefined(arg){return arg===void 0}exports.isUndefined=isUndefined;function isRegExp(re){return isObject(re)&&objectToString(re)==="[object RegExp]"}exports.isRegExp=isRegExp;function isObject(arg){return typeof arg==="object"&&arg}exports.isObject=isObject;function isDate(d){return isObject(d)&&objectToString(d)==="[object Date]"}exports.isDate=isDate;function isError(e){return isObject(e)&&objectToString(e)==="[object Error]"}exports.isError=isError;function isFunction(arg){return typeof arg==="function"}exports.isFunction=isFunction;function isPrimitive(arg){return arg===null||typeof arg==="boolean"||typeof arg==="number"||typeof arg==="string"||typeof arg==="symbol"||typeof arg==="undefined"}exports.isPrimitive=isPrimitive;function isBuffer(arg){return arg&&typeof arg==="object"&&typeof arg.copy==="function"&&typeof arg.fill==="function"&&typeof arg.binarySlice==="function"}exports.isBuffer=isBuffer;function objectToString(o){return Object.prototype.toString.call(o)}function pad(n){return n<10?"0"+n.toString(10):n.toString(10)}var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function timestamp(){var d=new Date;var time=[pad(d.getHours()),pad(d.getMinutes()),pad(d.getSeconds())].join(":");return[d.getDate(),months[d.getMonth()],time].join(" ")}exports.log=function(){console.log("%s - %s",timestamp(),exports.format.apply(exports,arguments))};exports.inherits=function(ctor,superCtor){ctor.super_=superCtor;ctor.prototype=shims.create(superCtor.prototype,{constructor:{value:ctor,enumerable:false,writable:true,configurable:true}})};exports._extend=function(origin,add){if(!add||!isObject(add))return origin;var keys=shims.keys(add);var i=keys.length;while(i--){origin[keys[i]]=add[keys[i]]}return origin};function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}},{_shims:68}],72:[function(require,module,exports){var process=module.exports={};process.nextTick=function(){var canSetImmediate=typeof window!=="undefined"&&window.setImmediate;var canPost=typeof window!=="undefined"&&window.postMessage&&window.addEventListener;if(canSetImmediate){return function(f){return window.setImmediate(f)}}if(canPost){var queue=[];window.addEventListener("message",function(ev){if(ev.source===window&&ev.data==="process-tick"){ev.stopPropagation();if(queue.length>0){var fn=queue.shift();fn()}}},true);return function nextTick(fn){queue.push(fn);window.postMessage("process-tick","*")}}return function nextTick(fn){setTimeout(fn,0)}}();process.title="browser";process.browser=true;process.env={};process.argv=[];process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")}},{}]},{},[1])(1)});