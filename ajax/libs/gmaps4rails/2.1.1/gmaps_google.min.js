(function(){this.Gmaps={build:function(c,b){var a;if(b==null){b={}}a=_.isFunction(b.handler)?b.handler:Gmaps.Objects.Handler;return new a(c,b)},Builders:{},Objects:{},Google:{Objects:{},Builders:{}}}}).call(this);(function(){var a,b=[].indexOf||function(e){for(var d=0,c=this.length;d<c;d++){if(d in this&&this[d]===e){return d}}return -1};a=["extended","included"];this.Gmaps.Base=(function(){function c(){}c.extend=function(g){var d,f,e;for(d in g){f=g[d];if(b.call(a,d)<0){this[d]=f}}if((e=g.extended)!=null){e.apply(this)}return this};c.include=function(g){var d,f,e;for(d in g){f=g[d];if(b.call(a,d)<0){this.prototype[d]=f}}if((e=g.included)!=null){e.apply(this)}return this};return c})()}).call(this);(function(){this.Gmaps.Objects.BaseBuilder=(function(){function a(){}a.prototype.build=function(){return new (this.model_class())(this.serviceObject)};a.prototype.before_init=function(){};a.prototype.after_init=function(){};a.prototype.addListener=function(c,b){return this.primitives().addListener(this.getServiceObject(),c,b)};a.prototype.getServiceObject=function(){return this.serviceObject};a.prototype.primitives=function(){return this.constructor.PRIMITIVES};a.prototype.model_class=function(){return this.constructor.OBJECT};return a})()}).call(this);(function(){this.Gmaps.Objects.Builders=function(b,a,c){a.PRIMITIVES=c;b.OBJECT=a;b.PRIMITIVES=c;return{build:function(g,f,e){var d;d=new b(g,f,e);return d.build()}}}}).call(this);(function(){this.Gmaps.Objects.Handler=(function(){function a(c,b){this.type=c;if(b==null){b={}}this.setPrimitives(b);this.setOptions(b);this.resetBounds()}a.prototype.buildMap=function(c,b){var d=this;if(b==null){b=function(){}}return this.map=this._builder("Map").build(c,function(){d._createClusterer();return b()})};a.prototype.addMarkers=function(b,c){var d=this;return _.map(b,function(e){return d.addMarker(e,c)})};a.prototype.addMarker=function(d,c){var b;b=this._builder("Marker").build(d,c,this.marker_options);b.setMap(this.getMap());this.clusterer.addMarker(b);return b};a.prototype.addCircles=function(c,b){var d=this;return _.map(c,function(e){return d.addCircle(e,b)})};a.prototype.addCircle=function(c,b){return this._addResource("circle",c,b)};a.prototype.addPolylines=function(b,c){var d=this;return _.map(b,function(e){return d.addPolyline(e,c)})};a.prototype.addPolyline=function(c,b){return this._addResource("polyline",c,b)};a.prototype.addPolygons=function(b,c){var d=this;return _.map(b,function(e){return d.addPolygon(e,c)})};a.prototype.addPolygon=function(c,b){return this._addResource("polygon",c,b)};a.prototype.addKmls=function(c,b){var d=this;return _.map(c,function(e){return d.addKml(e,b)})};a.prototype.addKml=function(c,b){return this._addResource("kml",c,b)};a.prototype.removeMarkers=function(b){var c=this;return _.map(b,function(d){return c.removeMarker(d)})};a.prototype.removeMarker=function(b){b.clear();return this.clusterer.removeMarker(b)};a.prototype.fitMapToBounds=function(){return this.map.fitToBounds(this.bounds.getServiceObject())};a.prototype.getMap=function(){return this.map.getServiceObject()};a.prototype.setOptions=function(b){this.marker_options=_.extend(this._default_marker_options(),b.markers);this.builders=_.extend(this._default_builders(),b.builders);return this.models=_.extend(this._default_models(),b.models)};a.prototype.resetBounds=function(){return this.bounds=this._builder("Bound").build()};a.prototype.setPrimitives=function(b){return this.primitives=b.primitives===void 0?this._rootModule().Primitives():_.isFunction(b.primitives)?b.primitives():b.primitives};a.prototype.currentInfowindow=function(){return this.builders.Marker.CURRENT_INFOWINDOW};a.prototype._addResource=function(e,c,b){var d;d=this._builder(e).build(c,b);d.setMap(this.getMap());return d};a.prototype._clusterize=function(){return _.isObject(this.marker_options.clusterer)};a.prototype._createClusterer=function(){return this.clusterer=this._builder("Clusterer").build({map:this.getMap()},this.marker_options.clusterer)};a.prototype._default_marker_options=function(){return{singleInfowindow:true,maxRandomDistance:100,clusterer:{maxZoom:5,gridSize:50}}};a.prototype._builder=function(c){var b;c=this._capitalize(c);if(this[b="__builder"+c]==null){this[b]=Gmaps.Objects.Builders(this.builders[c],this.models[c],this.primitives)}return this["__builder"+c]};a.prototype._default_models=function(){var b;b=this._rootModule().Objects;if(this._clusterize()){return b}else{b.Clusterer=Gmaps.Objects.NullClusterer;return b}};a.prototype._capitalize=function(b){return b.charAt(0).toUpperCase()+b.slice(1)};a.prototype._default_builders=function(){return this._rootModule().Builders};a.prototype._rootModule=function(){if(this.__rootModule==null){this.__rootModule=Gmaps[this.type]}return this.__rootModule};return a})()}).call(this);(function(){this.Gmaps.Objects.NullClusterer=(function(){function a(){}a.prototype.addMarkers=function(){};a.prototype.addMarker=function(){};a.prototype.clear=function(){};a.prototype.removeMarker=function(){};return a})()}).call(this);(function(){this.Gmaps.Google.Objects.Common={getServiceObject:function(){return this.serviceObject},setMap:function(a){return this.getServiceObject().setMap(a)},clear:function(){return this.getServiceObject().setMap(null)},show:function(){return this.getServiceObject().setVisible(true)},hide:function(){return this.getServiceObject().setVisible(false)},isVisible:function(){return this.getServiceObject().getVisible()},primitives:function(){return this.constructor.PRIMITIVES}}}).call(this);(function(){var a={}.hasOwnProperty,b=function(f,d){for(var c in d){if(a.call(d,c)){f[c]=d[c]}}function e(){this.constructor=f}e.prototype=d.prototype;f.prototype=new e();f.__super__=d.prototype;return f};this.Gmaps.Google.Builders.Bound=(function(d){b(c,d);function c(e){this.before_init();this.serviceObject=new (this.primitives().latLngBounds);this.after_init()}return c})(Gmaps.Objects.BaseBuilder)}).call(this);(function(){var a={}.hasOwnProperty,b=function(f,d){for(var c in d){if(a.call(d,c)){f[c]=d[c]}}function e(){this.constructor=f}e.prototype=d.prototype;f.prototype=new e();f.__super__=d.prototype;return f};this.Gmaps.Google.Builders.Circle=(function(d){b(c,d);function c(f,e){this.args=f;this.provider_options=e!=null?e:{};this.before_init();this.serviceObject=this.create_circle();this.after_init()}c.prototype.create_circle=function(){return new (this.primitives().circle)(this.circle_options())};c.prototype.circle_options=function(){var e;e={center:new (this.primitives().latLng)(this.args.lat,this.args.lng),radius:this.args.radius};return _.defaults(e,this.provider_options)};return c})(Gmaps.Objects.BaseBuilder)}).call(this);(function(){var a={}.hasOwnProperty,b=function(f,d){for(var c in d){if(a.call(d,c)){f[c]=d[c]}}function e(){this.constructor=f}e.prototype=d.prototype;f.prototype=new e();f.__super__=d.prototype;return f};this.Gmaps.Google.Builders.Clusterer=(function(d){b(c,d);function c(f,e){this.args=f;this.options=e;this.before_init();this.serviceObject=new (this.primitives().clusterer)(this.args.map,[],this.options);this.after_init()}return c})(Gmaps.Objects.BaseBuilder)}).call(this);(function(){var a={}.hasOwnProperty,b=function(f,d){for(var c in d){if(a.call(d,c)){f[c]=d[c]}}function e(){this.constructor=f}e.prototype=d.prototype;f.prototype=new e();f.__super__=d.prototype;return f};this.Gmaps.Google.Builders.Kml=(function(c){b(d,c);function d(f,e){this.args=f;this.provider_options=e!=null?e:{};this.before_init();this.serviceObject=this.create_kml();this.after_init()}d.prototype.create_kml=function(){return new (this.primitives().kml)(this.args.url,this.kml_options())};d.prototype.kml_options=function(){var e;e={};return _.defaults(e,this.provider_options)};return d})(Gmaps.Objects.BaseBuilder)}).call(this);(function(){var a={}.hasOwnProperty,b=function(f,d){for(var c in d){if(a.call(d,c)){f[c]=d[c]}}function e(){this.constructor=f}e.prototype=d.prototype;f.prototype=new e();f.__super__=d.prototype;return f};this.Gmaps.Google.Builders.Map=(function(d){b(c,d);function c(g,e){var f;this.before_init();f=_.extend(this.default_options(),g.provider);this.internal_options=g.internal;this.serviceObject=new (this.primitives().map)(document.getElementById(this.internal_options.id),f);this.on_map_load(e);this.after_init()}c.prototype.build=function(){return new (this.model_class())(this.serviceObject,this.primitives())};c.prototype.on_map_load=function(e){return this.primitives().addListenerOnce(this.serviceObject,"idle",e)};c.prototype.default_options=function(){return{mapTypeId:this.primitives().mapTypes("ROADMAP"),center:new (this.primitives().latLng)(0,0),zoom:8}};return c})(Gmaps.Objects.BaseBuilder)}).call(this);(function(){var b=function(d,e){return function(){return d.apply(e,arguments)}},a={}.hasOwnProperty,c=function(g,e){for(var d in e){if(a.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f();g.__super__=e.prototype;return g};this.Gmaps.Google.Builders.Marker=(function(e){c(d,e);d.CURRENT_INFOWINDOW=void 0;d.CACHE_STORE={};function d(h,g,f){this.args=h;this.provider_options=g!=null?g:{};this.internal_options=f!=null?f:{};this.infowindow_binding=b(this.infowindow_binding,this);this.before_init();this.create_marker();this.create_infowindow_on_click();this.after_init()}d.prototype.build=function(){return this.marker=new (this.model_class())(this.serviceObject)};d.prototype.create_marker=function(){return this.serviceObject=new (this.primitives().marker)(this.marker_options())};d.prototype.create_infowindow=function(){if(!_.isString(this.args.infowindow)){return null}return new (this.primitives().infowindow)({content:this.args.infowindow})};d.prototype.marker_options=function(){var f,g;g=this._randomized_coordinates();f={title:this.args.marker_title,position:new (this.primitives().latLng)(g[0],g[1]),icon:this._get_picture("picture"),shadow:this._get_picture("shadow")};return _.extend(this.provider_options,f)};d.prototype.create_infowindow_on_click=function(){return this.addListener("click",this.infowindow_binding)};d.prototype.infowindow_binding=function(){var f;if(this._should_close_infowindow()){this.constructor.CURRENT_INFOWINDOW.close()}this.marker.panTo();if(this.infowindow==null){this.infowindow=this.create_infowindow()}if(this.infowindow==null){return}this.infowindow.open(this.getServiceObject().getMap(),this.getServiceObject());if((f=this.marker).infowindow==null){f.infowindow=this.infowindow}return this.constructor.CURRENT_INFOWINDOW=this.infowindow};d.prototype._get_picture=function(f){if(!_.isObject(this.args[f])||!_.isString(this.args[f].url)){return null}return this._create_or_retrieve_image(this._picture_args(f))};d.prototype._create_or_retrieve_image=function(f){if(this.constructor.CACHE_STORE[f.url]===void 0){this.constructor.CACHE_STORE[f.url]=new (this.primitives().markerImage)(f.url,f.size,f.origin,f.anchor,f.scaledSize)}return this.constructor.CACHE_STORE[f.url]};d.prototype._picture_args=function(f){return{url:this.args[f].url,anchor:this._createImageAnchorPosition(this.args[f].anchor),size:new (this.primitives().size)(this.args[f].width,this.args[f].height),scaledSize:null,origin:null}};d.prototype._createImageAnchorPosition=function(f){if(!_.isArray(f)){return null}return new (this.primitives().point)(f[0],f[1])};d.prototype._should_close_infowindow=function(){return this.internal_options.singleInfowindow&&(this.constructor.CURRENT_INFOWINDOW!=null)};d.prototype._randomized_coordinates=function(){var h,j,g,f,i;if(!_.isNumber(this.internal_options.maxRandomDistance)){return[this.args.lat,this.args.lng]}i=function(){return Math.random()*2-1};g=this.internal_options.maxRandomDistance*i();f=this.internal_options.maxRandomDistance*i();h=parseFloat(this.args.lat)+(180/Math.PI)*(f/6378137);j=parseFloat(this.args.lng)+(90/Math.PI)*(g/6378137)/Math.cos(this.args.lat);return[h,j]};return d})(Gmaps.Objects.BaseBuilder)}).call(this);(function(){var a={}.hasOwnProperty,b=function(f,d){for(var c in d){if(a.call(d,c)){f[c]=d[c]}}function e(){this.constructor=f}e.prototype=d.prototype;f.prototype=new e();f.__super__=d.prototype;return f};this.Gmaps.Google.Builders.Polygon=(function(d){b(c,d);function c(f,e){this.args=f;this.provider_options=e!=null?e:{};this.before_init();this.serviceObject=this.create_polygon();this.after_init()}c.prototype.create_polygon=function(){return new (this.primitives().polygon)(this.polygon_options())};c.prototype.polygon_options=function(){var e;e={path:this._build_path()};return _.defaults(e,this.provider_options)};c.prototype._build_path=function(){var e=this;return _.map(this.args,function(f){return new (e.primitives().latLng)(f.lat,f.lng)})};return c})(Gmaps.Objects.BaseBuilder)}).call(this);(function(){var a={}.hasOwnProperty,b=function(f,d){for(var c in d){if(a.call(d,c)){f[c]=d[c]}}function e(){this.constructor=f}e.prototype=d.prototype;f.prototype=new e();f.__super__=d.prototype;return f};this.Gmaps.Google.Builders.Polyline=(function(d){b(c,d);function c(f,e){this.args=f;this.provider_options=e!=null?e:{};this.before_init();this.serviceObject=this.create_polyline();this.after_init()}c.prototype.create_polyline=function(){return new (this.primitives().polyline)(this.polyline_options())};c.prototype.polyline_options=function(){var e;e={path:this._build_path()};return _.defaults(e,this.provider_options)};c.prototype._build_path=function(){var e=this;return _.map(this.args,function(f){return new (e.primitives().latLng)(f.lat,f.lng)})};return c})(Gmaps.Objects.BaseBuilder)}).call(this);(function(){var a={}.hasOwnProperty,b=function(f,d){for(var c in d){if(a.call(d,c)){f[c]=d[c]}}function e(){this.constructor=f}e.prototype=d.prototype;f.prototype=new e();f.__super__=d.prototype;return f};this.Gmaps.Google.Objects.Bound=(function(d){b(c,d);c.include(Gmaps.Google.Objects.Common);function c(e){this.serviceObject=e}c.prototype.extendWith=function(e){var f,g=this;f=_.isArray(e)?e:[e];return _.each(f,function(h){return h.updateBounds(g)})};c.prototype.extend=function(e){return this.getServiceObject().extend(this.primitives().latLngFromPosition(e))};return c})(Gmaps.Base)}).call(this);(function(){var a={}.hasOwnProperty,b=function(f,d){for(var c in d){if(a.call(d,c)){f[c]=d[c]}}function e(){this.constructor=f}e.prototype=d.prototype;f.prototype=new e();f.__super__=d.prototype;return f};this.Gmaps.Google.Objects.Circle=(function(d){b(c,d);c.include(Gmaps.Google.Objects.Common);function c(e){this.serviceObject=e}c.prototype.updateBounds=function(e){e.extend(this.getServiceObject().getBounds().getNorthEast());return e.extend(this.getServiceObject().getBounds().getSouthWest())};return c})(Gmaps.Base)}).call(this);(function(){this.Gmaps.Google.Objects.Clusterer=(function(){function a(b){this.serviceObject=b}a.prototype.addMarkers=function(b){var c=this;return _.each(b,function(d){return c.addMarker(d)})};a.prototype.addMarker=function(b){return this.getServiceObject().addMarker(b.getServiceObject())};a.prototype.clear=function(){return this.getServiceObject().clearMarkers()};a.prototype.removeMarker=function(b){return this.getServiceObject().removeMarker(b.getServiceObject())};a.prototype.getServiceObject=function(){return this.serviceObject};return a})()}).call(this);(function(){var a={}.hasOwnProperty,b=function(f,d){for(var c in d){if(a.call(d,c)){f[c]=d[c]}}function e(){this.constructor=f}e.prototype=d.prototype;f.prototype=new e();f.__super__=d.prototype;return f};this.Gmaps.Google.Objects.Kml=(function(c){b(d,c);function d(e){this.serviceObject=e}d.prototype.updateBounds=function(e){};d.prototype.setMap=function(e){return this.getServiceObject().setMap(e)};d.prototype.getServiceObject=function(){return this.serviceObject};d.prototype.primitives=function(){return this.constructor.PRIMITIVES};return d})(Gmaps.Base)}).call(this);(function(){var a={}.hasOwnProperty,b=function(f,d){for(var c in d){if(a.call(d,c)){f[c]=d[c]}}function e(){this.constructor=f}e.prototype=d.prototype;f.prototype=new e();f.__super__=d.prototype;return f};this.Gmaps.Google.Objects.Map=(function(d){b(c,d);function c(e){this.serviceObject=e}c.prototype.getServiceObject=function(){return this.serviceObject};c.prototype.centerOn=function(e){return this.getServiceObject().setCenter(this.primitives().latLngFromPosition(e))};c.prototype.fitToBounds=function(e){if(!e.isEmpty()){return this.getServiceObject().fitBounds(e)}};c.prototype.primitives=function(){return this.constructor.PRIMITIVES};return c})(Gmaps.Base)}).call(this);(function(){var a={}.hasOwnProperty,b=function(f,d){for(var c in d){if(a.call(d,c)){f[c]=d[c]}}function e(){this.constructor=f}e.prototype=d.prototype;f.prototype=new e();f.__super__=d.prototype;return f};this.Gmaps.Google.Objects.Marker=(function(d){b(c,d);c.include(Gmaps.Google.Objects.Common);function c(e){this.serviceObject=e}c.prototype.updateBounds=function(e){return e.extend(this.getServiceObject().position)};c.prototype.panTo=function(){return this.getServiceObject().getMap().panTo(this.getServiceObject().getPosition())};return c})(Gmaps.Base)}).call(this);(function(){var a={}.hasOwnProperty,b=function(f,d){for(var c in d){if(a.call(d,c)){f[c]=d[c]}}function e(){this.constructor=f}e.prototype=d.prototype;f.prototype=new e();f.__super__=d.prototype;return f};this.Gmaps.Google.Objects.Polygon=(function(d){b(c,d);c.include(Gmaps.Google.Objects.Common);function c(e){this.serviceObject=e}c.prototype.updateBounds=function(g){var j,i,f,h,e;h=this.serviceObject.getPath().getArray();e=[];for(i=0,f=h.length;i<f;i++){j=h[i];e.push(g.extend(j))}return e};return c})(Gmaps.Base)}).call(this);(function(){var a={}.hasOwnProperty,b=function(f,d){for(var c in d){if(a.call(d,c)){f[c]=d[c]}}function e(){this.constructor=f}e.prototype=d.prototype;f.prototype=new e();f.__super__=d.prototype;return f};this.Gmaps.Google.Objects.Polyline=(function(d){b(c,d);c.include(Gmaps.Google.Objects.Common);function c(e){this.serviceObject=e}c.prototype.updateBounds=function(g){var j,i,f,h,e;h=this.serviceObject.getPath().getArray();e=[];for(i=0,f=h.length;i<f;i++){j=h[i];e.push(g.extend(j))}return e};return c})(Gmaps.Base)}).call(this);(function(){this.Gmaps.Google.Primitives=function(){var a;a={point:google.maps.Point,size:google.maps.Size,circle:google.maps.Circle,latLng:google.maps.LatLng,latLngBounds:google.maps.LatLngBounds,map:google.maps.Map,mapTypez:google.maps.MapTypeId,markerImage:google.maps.MarkerImage,marker:google.maps.Marker,infowindow:google.maps.InfoWindow,listener:google.maps.event.addListener,clusterer:MarkerClusterer,listenerOnce:google.maps.event.addListenerOnce,polyline:google.maps.Polyline,polygon:google.maps.Polygon,kml:google.maps.KmlLayer,addListener:function(b,d,c){return a.listener(b,d,c)},addListenerOnce:function(b,d,c){return a.listenerOnce(b,d,c)},mapTypes:function(b){return a.mapTypez[b]},latLngFromPosition:function(b){if(_.isArray(b)){return new a.latLng(b[0],b[1])}else{if(_.isNumber(b.lat)&&_.isNumber(b.lng)){return new a.latLng(b.lat,b.lng)}else{return b}}}};return a}}).call(this);(function(){}).call(this);