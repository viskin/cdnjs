(function(){var q,f,o,n,h,l,c,j,b,t,d,e,a,r,i,k,p,v,s,g,m={}.hasOwnProperty,u=function(z,x){for(var w in x){if(m.call(x,w)){z[w]=x[w]}}function y(){this.constructor=z}y.prototype=x.prototype;z.prototype=new y();z.__super__=x.prototype;return z};g=Tether.Utils,t=g.extend,j=g.addClass,k=g.removeClass,a=g.hasClass,d=g.getBounds,n=g.Evented;f=13;o=27;h=32;c=38;q=40;s="ontouchstart" in document.documentElement;b=s?"touchstart":"click";r=function(w){return Array.prototype.reduce.call(w,function(y,x){if(y===x){return x}else{return false}})};e=function(){var w;return(w=document.querySelector(".select-target-focused"))!=null?w.selectInstance:void 0};p="";v=void 0;i=void 0;document.addEventListener("keypress",function(A){var y,x,w,z;if(!(w=e())){return}if(A.charCode===0){return}if(A.keyCode===h){A.preventDefault()}clearTimeout(v);v=setTimeout(function(){return p=""},500);p+=String.fromCharCode(A.charCode);y=w.findOptionsByPrefix(p);if(y.length===1){w.selectOption(y[0]);return}if(p.length>1&&r(p)){x=w.findOptionsByPrefix(p[0]);if(x.length){z=x.indexOf(w.getChosen());z+=1;z=z%x.length;w.selectOption(x[z]);return}}if(y.length){w.selectOption(y[0])}});document.addEventListener("keydown",function(y){var x,w,z;if(!(x=e())){return}if((w=y.keyCode)===c||w===q||w===o){y.preventDefault()}if(x.isOpen()){switch(y.keyCode){case c:case q:return x.moveHighlight(y.keyCode);case f:return x.selectHighlightedOption();case o:x.close();return x.target.focus()}}else{if((z=y.keyCode)===c||z===q||z===h){return x.open()}}});l=(function(w){u(x,w);x.defaults={alignToHighlighed:"auto",className:"select-theme-default"};function x(y){this.options=y;this.options=t({},x.defaults,this.options);this.select=this.options.el;if(this.select.selectInstance!=null){throw new Error("This element has already been turned into a Select")}this.setupTarget();this.renderTarget();this.setupDrop();this.renderDrop();this.setupSelect();this.setupTether();this.bindClick();this.value=this.select.value}x.prototype.setupTarget=function(){var y,z=this;this.target=document.createElement("a");this.target.href="javascript:;";j(this.target,"select-target");y=this.select.getAttribute("tabindex")||0;this.target.setAttribute("tabindex",y);if(this.options.className){j(this.target,this.options.className)}this.target.selectInstance=this;this.target.addEventListener("click",function(){if(!z.isOpen()){return z.target.focus()}else{return z.target.blur()}});this.target.addEventListener("focus",function(){return j(z.target,"select-target-focused")});this.target.addEventListener("blur",function(A){if(z.isOpen()){if(A.relatedTarget&&!z.drop.contains(A.relatedTarget)){return z.close()}}else{return k(z.target,"select-target-focused")}});this.select.parentNode.insertBefore(this.target,this.select.nextSibling);return this.select.style.display="none"};x.prototype.setupDrop=function(){var y=this;this.drop=document.createElement("div");j(this.drop,"select");if(this.options.className){j(this.drop,this.options.className)}document.body.appendChild(this.drop);this.drop.addEventListener("click",function(z){if(a(z.target,"select-option")){return y.pickOption(z.target)}});this.drop.addEventListener("mousemove",function(z){if(a(z.target,"select-option")){return y.highlightOption(z.target)}});this.content=document.createElement("div");j(this.content,"select-content");return this.drop.appendChild(this.content)};x.prototype.open=function(){var z,y,A=this;j(this.drop,"select-open");j(this.target,"select-open");setTimeout(function(){return A.tether.enable()});y=this.drop.querySelector(".select-option-selected");if(!y){return}this.highlightOption(y);this.scrollDropContentToOption(y);z=function(){var C,D,B;if(a(A.drop,"tether-abutted-left")||a(A.drop,"tether-abutted-bottom")){C=d(A.drop);B=d(y);D=C.top-(B.top+B.height);return A.drop.style.top=(parseFloat(A.drop.style.top)||0)+D+"px"}};if(this.options.alignToHighlighted==="always"||(this.options.alignToHighlighted==="auto"&&this.content.scrollHeight<=this.content.clientHeight)){setTimeout(z)}return this.trigger("open")};x.prototype.close=function(){this.tether.disable();k(this.drop,"select-open");k(this.target,"select-open");return this.trigger("close")};x.prototype.toggle=function(){if(this.isOpen()){return this.close()}else{return this.open()}};x.prototype.isOpen=function(){return a(this.drop,"select-open")};x.prototype.bindClick=function(){var y=this;this.target.addEventListener(b,function(){return y.toggle()});return document.addEventListener(b,function(z){if(!y.isOpen()){return}if(z.target===y.drop||y.drop.contains(z.target)){return}if(z.target===y.target||y.target.contains(z.target)){return}return y.close()})};x.prototype.setupTether=function(){return this.tether=new Tether({element:this.drop,target:this.target,attachment:"top left",targetAttachment:"bottom left",classPrefix:"select",constraints:[{to:"window",pin:true,attachment:"together"}]})};x.prototype.renderTarget=function(){var A,B,z,y;this.target.innerHTML="";y=this.select.querySelectorAll("option");for(B=0,z=y.length;B<z;B++){A=y[B];if(A.selected){this.target.innerHTML=A.innerHTML;break}}return this.target.appendChild(document.createElement("b"))};x.prototype.renderDrop=function(){var B,A,D,C,z,y;D=document.createElement("ul");j(D,"select-options");y=this.select.querySelectorAll("option");for(C=0,z=y.length;C<z;C++){B=y[C];A=document.createElement("li");j(A,"select-option");A.setAttribute("data-value",B.value);A.innerHTML=B.innerHTML;if(B.selected){j(A,"select-option-selected")}D.appendChild(A)}this.content.innerHTML="";return this.content.appendChild(D)};x.prototype.setupSelect=function(){var y=this;this.select.selectInstance=this;j(this.select,"select-select");return this.select.addEventListener("change",function(){y.renderDrop();return y.renderTarget()})};x.prototype.findOptionsByPrefix=function(z){var y;y=this.drop.querySelectorAll(".select-option");z=z.toLowerCase();return Array.prototype.filter.call(y,function(A){return A.innerHTML.toLowerCase().substr(0,z.length)===z})};x.prototype.findOptionsByValue=function(z){var y;y=this.drop.querySelectorAll(".select-option");return Array.prototype.filter.call(y,function(A){return A.getAttribute("data-value")===z})};x.prototype.getChosen=function(){if(this.isOpen()){return this.drop.querySelector(".select-option-highlight")}else{return this.drop.querySelector(".select-option-selected")}};x.prototype.selectOption=function(y){if(this.isOpen()){this.highlightOption(y);return this.scrollDropContentToOption(y)}else{return this.pickOption(y,false)}};x.prototype.resetSelection=function(){return this.selectOption(this.drop.querySelector(".select-option"))};x.prototype.highlightOption=function(y){var z;z=this.drop.querySelector(".select-option-highlight");if(z!=null){k(z,"select-option-highlight")}j(y,"select-option-highlight");return this.trigger("highlight",{option:y})};x.prototype.moveHighlight=function(C){var A,y,B,z;if(!(A=this.drop.querySelector(".select-option-highlight"))){this.highlightOption(this.drop.querySelector(".select-option"));return}z=this.drop.querySelectorAll(".select-option");y=Array.prototype.indexOf.call(z,A);if(!(y>=0)){return}if(C===c){y-=1}else{y+=1}if(y<0||y>=z.length){return}B=z[y];this.highlightOption(B);return this.scrollDropContentToOption(B)};x.prototype.scrollDropContentToOption=function(A){var y,z;if(this.content.scrollHeight>this.content.clientHeight){y=d(this.content);z=d(A);return this.content.scrollTop=z.top-(y.top-this.content.scrollTop)}};x.prototype.selectHighlightedOption=function(){return this.pickOption(this.drop.querySelector(".select-option-highlight"))};x.prototype.pickOption=function(y,z){var A=this;if(z==null){z=true}this.value=this.select.value=y.getAttribute("data-value");this.triggerChange();if(z){return setTimeout(function(){A.close();return A.target.focus()})}};x.prototype.triggerChange=function(){var y;y=document.createEvent("HTMLEvents");y.initEvent("change",true,false);this.select.dispatchEvent(y);return this.trigger("change",{value:this.select.value})};x.prototype.change=function(z){var y;y=this.findOptionsByValue(z);if(!y.length){throw new Error('Select Error: An option with the value "'+z+"\" doesn't exist")}return this.pickOption(y[0],false)};return x})(n);l.init=function(z){var A,B,y,w,x;if(z==null){z={}}if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",function(){return l.init(z)});return}if(z.selector==null){z.selector="select"}w=document.querySelectorAll(z.selector);x=[];for(B=0,y=w.length;B<y;B++){A=w[B];if(!A.selectInstance){x.push(new l(t({el:A},z)))}else{x.push(void 0)}}return x};window.Select=l}).call(this);