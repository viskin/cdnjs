(function(){var q,f,o,n,h,l,c,j,b,u,d,e,a,r,i,k,p,w,s,t,g,m={}.hasOwnProperty,v=function(A,y){for(var x in y){if(m.call(y,x)){A[x]=y[x]}}function z(){this.constructor=A}z.prototype=y.prototype;A.prototype=new z();A.__super__=y.prototype;return A};g=Tether.Utils,u=g.extend,j=g.addClass,k=g.removeClass,a=g.hasClass,d=g.getBounds,n=g.Evented;f=13;o=27;h=32;c=38;q=40;s="ontouchstart" in document.documentElement;b=s?"touchstart":"click";t=function(){return s&&(innerWidth<=640||innerHeight<=640)};r=function(x){return Array.prototype.reduce.call(x,function(z,y){if(z===y){return y}else{return false}})};e=function(){var x;return(x=document.querySelector(".select-target-focused"))!=null?x.selectInstance:void 0};p="";w=void 0;i=void 0;document.addEventListener("keypress",function(B){var z,y,x,A;if(!(x=e())){return}if(B.charCode===0){return}if(B.keyCode===h){B.preventDefault()}clearTimeout(w);w=setTimeout(function(){return p=""},500);p+=String.fromCharCode(B.charCode);z=x.findOptionsByPrefix(p);if(z.length===1){x.selectOption(z[0]);return}if(p.length>1&&r(p)){y=x.findOptionsByPrefix(p[0]);if(y.length){A=y.indexOf(x.getChosen());A+=1;A=A%y.length;x.selectOption(y[A]);return}}if(z.length){x.selectOption(z[0])}});document.addEventListener("keydown",function(z){var y,x,A;if(!(y=e())){return}if((x=z.keyCode)===c||x===q||x===o){z.preventDefault()}if(y.isOpen()){switch(z.keyCode){case c:case q:return y.moveHighlight(z.keyCode);case f:return y.selectHighlightedOption();case o:y.close();return y.target.focus()}}else{if((A=z.keyCode)===c||A===q||A===h){return y.open()}}});l=(function(x){v(y,x);y.defaults={alignToHighlighed:"auto",className:"select-theme-default"};function y(z){this.options=z;this.options=u({},y.defaults,this.options);this.select=this.options.el;if(this.select.selectInstance!=null){throw new Error("This element has already been turned into a Select")}this.setupTarget();this.renderTarget();this.setupDrop();this.renderDrop();this.setupSelect();this.setupTether();this.bindClick();this.value=this.select.value}y.prototype.useNative=function(){return this.options.useNative===true||(t()&&this.options.useNative!==false)};y.prototype.setupTarget=function(){var z,A=this;this.target=document.createElement("a");this.target.href="javascript:;";j(this.target,"select-target");z=this.select.getAttribute("tabindex")||0;this.target.setAttribute("tabindex",z);if(this.options.className){j(this.target,this.options.className)}this.target.selectInstance=this;this.target.addEventListener("click",function(){if(!A.isOpen()){return A.target.focus()}else{return A.target.blur()}});this.target.addEventListener("focus",function(){return j(A.target,"select-target-focused")});this.target.addEventListener("blur",function(B){if(A.isOpen()){if(B.relatedTarget&&!A.drop.contains(B.relatedTarget)){return A.close()}}else{return k(A.target,"select-target-focused")}});return this.select.parentNode.insertBefore(this.target,this.select.nextSibling)};y.prototype.setupDrop=function(){var z=this;this.drop=document.createElement("div");j(this.drop,"select");if(this.options.className){j(this.drop,this.options.className)}document.body.appendChild(this.drop);this.drop.addEventListener("click",function(A){if(a(A.target,"select-option")){return z.pickOption(A.target)}});this.drop.addEventListener("mousemove",function(A){if(a(A.target,"select-option")){return z.highlightOption(A.target)}});this.content=document.createElement("div");j(this.content,"select-content");return this.drop.appendChild(this.content)};y.prototype.open=function(){var A,z,B=this;j(this.target,"select-open");if(this.useNative()){this.select.style.display="block";setTimeout(function(){var C;C=document.createEvent("MouseEvents");C.initEvent("mousedown",true,true);return B.select.dispatchEvent(C)});return}j(this.drop,"select-open");setTimeout(function(){return B.tether.enable()});z=this.drop.querySelector(".select-option-selected");if(!z){return}this.highlightOption(z);this.scrollDropContentToOption(z);A=function(){var D,E,C;if(a(B.drop,"tether-abutted-left")||a(B.drop,"tether-abutted-bottom")){D=d(B.drop);C=d(z);E=D.top-(C.top+C.height);return B.drop.style.top=(parseFloat(B.drop.style.top)||0)+E+"px"}};if(this.options.alignToHighlighted==="always"||(this.options.alignToHighlighted==="auto"&&this.content.scrollHeight<=this.content.clientHeight)){setTimeout(A)}return this.trigger("open")};y.prototype.close=function(){k(this.target,"select-open");if(this.useNative()){this.select.style.display="none";return}this.tether.disable();k(this.drop,"select-open");return this.trigger("close")};y.prototype.toggle=function(){if(this.isOpen()){return this.close()}else{return this.open()}};y.prototype.isOpen=function(){return a(this.drop,"select-open")};y.prototype.bindClick=function(){var z=this;this.target.addEventListener(b,function(A){A.preventDefault();return z.toggle()});return document.addEventListener(b,function(A){if(!z.isOpen()){return}if(A.target===z.drop||z.drop.contains(A.target)){return}if(A.target===z.target||z.target.contains(A.target)){return}return z.close()})};y.prototype.setupTether=function(){return this.tether=new Tether({element:this.drop,target:this.target,attachment:"top left",targetAttachment:"bottom left",classPrefix:"select",constraints:[{to:"window",pin:true,attachment:"together"}]})};y.prototype.renderTarget=function(){var B,C,A,z;this.target.innerHTML="";z=this.select.querySelectorAll("option");for(C=0,A=z.length;C<A;C++){B=z[C];if(B.selected){this.target.innerHTML=B.innerHTML;break}}return this.target.appendChild(document.createElement("b"))};y.prototype.renderDrop=function(){var C,B,E,D,A,z;E=document.createElement("ul");j(E,"select-options");z=this.select.querySelectorAll("option");for(D=0,A=z.length;D<A;D++){C=z[D];B=document.createElement("li");j(B,"select-option");B.setAttribute("data-value",C.value);B.innerHTML=C.innerHTML;if(C.selected){j(B,"select-option-selected")}E.appendChild(B)}this.content.innerHTML="";return this.content.appendChild(E)};y.prototype.setupSelect=function(){var z=this;this.select.selectInstance=this;j(this.select,"select-select");return this.select.addEventListener("change",function(){z.renderDrop();return z.renderTarget()})};y.prototype.findOptionsByPrefix=function(A){var z;z=this.drop.querySelectorAll(".select-option");A=A.toLowerCase();return Array.prototype.filter.call(z,function(B){return B.innerHTML.toLowerCase().substr(0,A.length)===A})};y.prototype.findOptionsByValue=function(A){var z;z=this.drop.querySelectorAll(".select-option");return Array.prototype.filter.call(z,function(B){return B.getAttribute("data-value")===A})};y.prototype.getChosen=function(){if(this.isOpen()){return this.drop.querySelector(".select-option-highlight")}else{return this.drop.querySelector(".select-option-selected")}};y.prototype.selectOption=function(z){if(this.isOpen()){this.highlightOption(z);return this.scrollDropContentToOption(z)}else{return this.pickOption(z,false)}};y.prototype.resetSelection=function(){return this.selectOption(this.drop.querySelector(".select-option"))};y.prototype.highlightOption=function(z){var A;A=this.drop.querySelector(".select-option-highlight");if(A!=null){k(A,"select-option-highlight")}j(z,"select-option-highlight");return this.trigger("highlight",{option:z})};y.prototype.moveHighlight=function(D){var B,z,C,A;if(!(B=this.drop.querySelector(".select-option-highlight"))){this.highlightOption(this.drop.querySelector(".select-option"));return}A=this.drop.querySelectorAll(".select-option");z=Array.prototype.indexOf.call(A,B);if(!(z>=0)){return}if(D===c){z-=1}else{z+=1}if(z<0||z>=A.length){return}C=A[z];this.highlightOption(C);return this.scrollDropContentToOption(C)};y.prototype.scrollDropContentToOption=function(B){var z,A;if(this.content.scrollHeight>this.content.clientHeight){z=d(this.content);A=d(B);return this.content.scrollTop=A.top-(z.top-this.content.scrollTop)}};y.prototype.selectHighlightedOption=function(){return this.pickOption(this.drop.querySelector(".select-option-highlight"))};y.prototype.pickOption=function(z,A){var B=this;if(A==null){A=true}this.value=this.select.value=z.getAttribute("data-value");this.triggerChange();if(A){return setTimeout(function(){B.close();return B.target.focus()})}};y.prototype.triggerChange=function(){var z;z=document.createEvent("HTMLEvents");z.initEvent("change",true,false);this.select.dispatchEvent(z);return this.trigger("change",{value:this.select.value})};y.prototype.change=function(A){var z;z=this.findOptionsByValue(A);if(!z.length){throw new Error('Select Error: An option with the value "'+A+"\" doesn't exist")}return this.pickOption(z[0],false)};return y})(n);l.init=function(A){var B,C,z,x,y;if(A==null){A={}}if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",function(){return l.init(A)});return}if(A.selector==null){A.selector="select"}x=document.querySelectorAll(A.selector);y=[];for(C=0,z=x.length;C<z;C++){B=x[C];if(!B.selectInstance){y.push(new l(u({el:B},A)))}else{y.push(void 0)}}return y};window.Select=l}).call(this);