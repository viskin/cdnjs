(function(){var a={};if(typeof module!=="undefined"){exports=module.exports=a}else{this.ss=a}a.linear_regression=function(){var b={},c=[];b.data=function(d){if(!arguments.length){return c}c=d.slice();return b};b.line=function(){if(c.length==1){e=0;d=c[0][1]}else{var k=0,j=0,g=0,f=0,e,d;for(var h=0;h<c.length;h++){k+=c[h][0];j+=c[h][1];g+=c[h][0]*c[h][0];f+=c[h][0]*c[h][1]}e=((c.length*f)-(k*j))/((c.length*g)-(k*k));d=(j/c.length)-((e*k)/c.length)}return function(i){return d+(e*i)}};return b};a.r_squared=function(h,m){if(h.length<2){return 1}var n=0,b;for(var l=0;l<h.length;l++){n+=h[l][1]}b=n/h.length;var e=0;for(var g=0;g<h.length;g++){e+=Math.pow(b-h[g][1],2)}var d=0;for(var c=0;c<h.length;c++){d+=Math.pow(h[c][1]-m(h[c][0]),2)}return 1-(d/e)};a.bayesian=function(){var b={},c=0,d={};b.train=function(h,g){if(!d[g]){d[g]={}}for(var f in h){var e=h[f];if(d[g][f]===undefined){d[g][f]={}}if(d[g][f][e]===undefined){d[g][f][e]=0}d[g][f][h[f]]++}c++};b.score=function(l){var e={},j;for(var g in l){var f=l[g];for(j in d){if(e[j]===undefined){e[j]={}}if(d[j][g]){e[j][g+"_"+f]=(d[j][g][f]||0)/c}else{e[j][g+"_"+f]=0}}}var h={};for(j in e){for(var i in e[j]){if(h[j]===undefined){h[j]=0}h[j]+=e[j][i]}}return h};return b};a.sum=function(b){var d=0;for(var c=0;c<b.length;c++){d+=b[c]}return d};a.mean=function(b){if(b.length===0){return null}return a.sum(b)/b.length};a.geometric_mean=function(b){if(b.length===0){return null}var d=1;for(var c=0;c<b.length;c++){if(b[c]<=0){return null}d*=b[c]}return Math.pow(d,1/b.length)};a.average=a.mean;a.min=function(b){var d;for(var c=0;c<b.length;c++){if(b[c]<d||d===undefined){d=b[c]}}return d};a.max=function(c){var b;for(var d=0;d<c.length;d++){if(c[d]>b||b===undefined){b=c[d]}}return b};a.variance=function(b){if(b.length===0){return null}var c=a.mean(b),d=[];for(var e=0;e<b.length;e++){d.push(Math.pow(b[e]-c,2))}return a.mean(d)};a.standard_deviation=function(b){if(b.length===0){return null}return Math.sqrt(a.variance(b))};a.sum_squared_deviations=function(b){if(b.length<=1){return null}var c=a.mean(b),e=0;for(var d=0;d<b.length;d++){e+=Math.pow(b[d]-c,2)}return e};a.sample_variance=function(b){var c=a.sum_squared_deviations(b);if(c===null){return null}return c/(b.length-1)};a.sample_standard_deviation=function(b){if(b.length<=1){return null}return Math.sqrt(a.sample_variance(b))};a.sample_covariance=function(b,g){if(b.length<=1||b.length!=g.length){return null}var f=a.mean(b),c=a.mean(g),e=0;for(var d=0;d<b.length;d++){e+=(b[d]-f)*(g[d]-c)}return e/(b.length-1)};a.sample_correlation=function(b,f){var e=a.sample_covariance(b,f),d=a.sample_standard_deviation(b),c=a.sample_standard_deviation(f);if(e===null||d===null||c===null){return null}return e/d/c};a.median=function(d){if(d.length===0){return null}var f=d.slice().sort(function(h,g){return h-g});if(f.length%2===1){return f[(f.length-1)/2]}else{var e=f[(f.length/2)-1];var c=f[(f.length/2)];return(e+c)/2}};a.mode=function(b){if(b.length===0){return null}else{if(b.length===1){return b[0]}}var c=b.slice().sort(function(j,i){return j-i});var g=c[0],h,f=0,e=1;for(var d=1;d<c.length+1;d++){if(c[d]!==g){if(e>f){f=e;e=1;h=g}g=c[d]}else{e++}}return h};a.t_test=function(e,b){var c=a.mean(e);var f=a.standard_deviation(e);var d=Math.sqrt(e.length);return(c-b)/(f/d)};a.quantile=function(d,e){if(d.length===0){return null}if(e>=1||e<=0){return null}var c=d.slice().sort(function(g,f){return g-f});var b=(c.length)*e;if(b%1!==0){return c[Math.ceil(b)-1]}else{if(d.length%2===0){return(c[b-1]+c[b])/2}else{return c[b]}}};a.jenksMatrices=function(q,u){var t=[],b=[],r,p,c=0;for(r=0;r<q.length+1;r++){var o=[],n=[];for(p=0;p<u+1;p++){o.push(0);n.push(0)}t.push(o);b.push(n)}for(r=1;r<u+1;r++){t[1][r]=1;b[1][r]=0;for(p=2;p<q.length+1;p++){b[p][r]=Infinity}}for(var k=2;k<q.length+1;k++){var s=0,h=0,v=0,f=0;for(var g=1;g<k+1;g++){var e=k-g+1,d=q[e-1];v++;s+=d;h+=d*d;c=h-(s*s)/v;f=e-1;if(f!==0){for(p=2;p<u+1;p++){if(b[k][p]>=(c+b[f][p-1])){t[k][p]=e;b[k][p]=c+b[f][p-1]}}}}t[k][1]=1;b[k][1]=c}return{lower_class_limits:t,variance_combinations:b}};a.jenksBreaks=function(e,f,d){var c=e.length-1,b=[],g=d;b[d]=e[e.length-1];b[0]=e[0];while(g>1){b[g-1]=e[f[c][g]-2];c=f[c][g]-1;g--}return b};a.jenks=function(d,b){if(b>d.length){return null}d=d.slice().sort(function(g,f){return g-f});var c=a.jenksMatrices(d,b),e=c.lower_class_limits;return a.jenksBreaks(d,e,b)};a.mixin=function(){var e=!!(Object.defineProperty&&Object.defineProperties);if(!e){throw new Error("without defineProperty, simple-statistics cannot be mixed in")}var b=["median","standard_deviation","sum","mean","min","max","quantile","geometric_mean"];function d(f){return function(){var g=Array.prototype.slice.apply(arguments);g.unshift(this);return a[f].apply(a,g)}}for(var c=0;c<b.length;c++){Object.defineProperty(Array.prototype,b[c],{value:d(b[c]),configurable:true,enumerable:false,writable:true})}}})(this);