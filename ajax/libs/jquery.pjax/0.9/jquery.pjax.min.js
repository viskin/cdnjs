!function(t){function e(t,e){return this.live("click.pjax",function(a){r(a,t,e)})}function r(e,r,a){a=d(r,a);var o=e.currentTarget;if("A"!==o.tagName.toUpperCase())throw"$.fn.pjax or $.pjax.click requires an anchor element";if(!(e.which>1||e.metaKey||e.ctrlKey||location.protocol!==o.protocol||location.host!==o.host||o.hash&&o.href.replace(o.hash,"")===location.href.replace(location.hash,"")||o.href===location.href+"#")){var i={url:o.href,container:t(o).attr("data-pjax"),target:o,clickedElement:t(o),fragment:null};n(t.extend({},i,a)),e.preventDefault()}}function a(e,r,a){a=d(r,a);var o=e.currentTarget;if("FORM"!==o.tagName.toUpperCase())throw"$.pjax.submit requires a form element";var i={type:o.method,url:o.action,data:t(o).serializeArray(),container:t(o).attr("data-pjax"),target:o,fragment:null,timeout:0};n(t.extend({},i,a)),e.preventDefault()}function n(e){function r(e,r){var n=t.Event(e,{relatedTarget:a});return g.trigger(n,r),!n.isDefaultPrevented()}e=t.extend(!0,{},t.ajaxSettings,n.defaults,e),t.isFunction(e.url)&&(e.url=e.url());var a=e.target;!a&&e.clickedElement&&(a=e.clickedElement[0]);var o=p(e.url).hash,l=e.beforeSend,c=e.complete,d=e.success,h=e.error,g=e.context=f(e.container);e.data||(e.data={}),e.data._pjax=g.selector;var j;e.beforeSend=function(t,a){"GET"!==a.type&&(a.timeout=0),a.timeout>0&&(j=setTimeout(function(){r("pjax:timeout",[t,e])&&t.abort("timeout")},a.timeout),a.timeout=0),t.setRequestHeader("X-PJAX","true"),t.setRequestHeader("X-PJAX-Container",g.selector);var n;return l&&(n=l.apply(this,arguments),n===!1)?!1:r("pjax:beforeSend",[t,a])?void(e.requestUrl=p(a.url).href):!1},e.complete=function(t,a){j&&clearTimeout(j),c&&c.apply(this,arguments),r("pjax:complete",[t,a,e]),r("pjax:end",[t,e]),r("end.pjax",[t,e])},e.error=function(t,a,n){var o=m("",t,e);h&&h.apply(this,arguments);var l=r("pjax:error",[t,a,n,e]);"abort"!==a&&l&&i(o.url)},e.success=function(a,l,c){var s=m(a,c,e);if(!s.contents)return void i(s.url);if(n.state={id:e.id||u(),url:s.url,title:s.title,container:g.selector,fragment:e.fragment,timeout:e.timeout},(e.push||e.replace)&&window.history.replaceState(n.state,s.title,s.url),s.title&&(document.title=s.title),g.html(s.contents),"number"==typeof e.scrollTo&&t(window).scrollTop(e.scrollTo),(e.replace||e.push)&&window._gaq&&_gaq.push(["_trackPageview"]),""!==o){var f=p(s.url);f.hash=o,n.state.url=f.href,window.history.replaceState(n.state,s.title,f.href);var h=t(f.hash);h.length&&t(window).scrollTop(h.offset().top)}d&&d.apply(this,arguments),r("pjax:success",[a,l,c,e])},n.state||(n.state={id:u(),url:window.location.href,title:document.title,container:g.selector,fragment:e.fragment,timeout:e.timeout},window.history.replaceState(n.state,document.title));var v=n.xhr;v&&v.readyState<4&&(v.onreadystatechange=t.noop,v.abort()),n.options=e;var v=n.xhr=t.ajax(e);return v.readyState>0&&(t(document).trigger("pjax",[v,e]),e.push&&!e.replace&&(x(n.state.id,g.clone().contents()),window.history.pushState(null,"",s(e.requestUrl))),r("pjax:start",[v,e]),r("start.pjax",[v,e]),r("pjax:send",[v,e])),n.xhr}function o(e,r){var a={url:window.location.href,push:!1,replace:!0,scrollTo:!1};return n(t.extend(a,d(e,r)))}function i(t){window.history.replaceState(null,"","#"),window.location.replace(t)}function l(e){var r=e.state;if(r&&r.container){var a=t(r.container);if(a.length){var o=w[r.id];if(n.state){var l=n.state.id<r.id?"forward":"back";g(l,n.state.id,a.clone().contents())}var c=t.Event("pjax:popstate",{state:r,direction:l});a.trigger(c);var u={id:r.id,url:r.url,container:a,push:!1,fragment:r.fragment,timeout:r.timeout,scrollTo:!1};o?(t(document).trigger("pjax",[null,u]),a.trigger("pjax:start",[null,u]),a.trigger("start.pjax",[null,u]),r.title&&(document.title=r.title),a.html(o),n.state=r,a.trigger("pjax:end",[null,u]),a.trigger("end.pjax",[null,u])):n(u),a[0].offsetHeight}else i(location.href)}}function c(e){var r=t.isFunction(e.url)?e.url():e.url,a=e.type?e.type.toUpperCase():"GET",n=t("<form>",{method:"GET"===a?"GET":"POST",action:r,style:"display:none"});"GET"!==a&&"POST"!==a&&n.append(t("<input>",{type:"hidden",name:"_method",value:a.toLowerCase()}));var o=e.data;if("string"==typeof o)t.each(o.split("&"),function(e,r){var a=r.split("=");n.append(t("<input>",{type:"hidden",name:a[0],value:a[1]}))});else if("object"==typeof o)for(key in o)n.append(t("<input>",{type:"hidden",name:key,value:o[key]}));t(document.body).append(n),n.submit()}function u(){return(new Date).getTime()}function s(t){return t.replace(/\?_pjax=[^&]+&?/,"?").replace(/_pjax=[^&]+&?/,"").replace(/[\?&]$/,"")}function p(t){var e=document.createElement("a");return e.href=t,e}function d(e,r){return e&&r?r.container=e:r=t.isPlainObject(e)?e:{container:e},r.container&&(r.container=f(r.container)),r}function f(e){if(e=t(e),e.length){if(""!==e.selector&&e.context===document)return e;if(e.attr("id"))return t("#"+e.attr("id"));throw"cant get selector for pjax container!"}throw"no pjax container for "+e.selector}function h(t,e){return t.filter(e).add(t.find(e))}function m(e,r,a){var n={};n.url=s(r.getResponseHeader("X-PJAX-URL")||a.requestUrl);var o=t(e);if(0===o.length)return n;if(n.title=h(o,"title").last().text(),a.fragment){var i=h(o,a.fragment).first();i.length&&(n.contents=i.contents(),n.title||(n.title=i.attr("title")||i.data("title")))}else/<html/i.test(e)||(n.contents=o);return n.contents&&(n.contents=n.contents.not("title"),n.contents.find("title").remove()),n.title&&(n.title=t.trim(n.title)),n}function x(t,e){for(w[t]=e,b.push(t);y.length;)delete w[y.shift()];for(;b.length>n.defaults.maxCacheLength;)delete w[b.shift()]}function g(t,e,r){var a,n;w[e]=r,"forward"===t?(a=b,n=y):(a=y,n=b),a.push(e),(e=n.pop())&&delete w[e]}function j(){t.fn.pjax=e,t.pjax=n,t.pjax.enable=t.noop,t.pjax.disable=v,t.pjax.click=r,t.pjax.submit=a,t.pjax.reload=o,t.pjax.defaults={timeout:650,push:!0,replace:!1,type:"GET",dataType:"html",scrollTo:0,maxCacheLength:20},t(window).bind("popstate.pjax",l)}function v(){t.fn.pjax=function(){return this},t.pjax=c,t.pjax.enable=j,t.pjax.disable=t.noop,t.pjax.click=t.noop,t.pjax.submit=t.noop,t.pjax.reload=window.location.reload,t(window).unbind("popstate.pjax",l)}var w={},y=[],b=[];t.inArray("state",t.event.props)<0&&t.event.props.push("state"),t.support.pjax=window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]|WebApps\/.+CFNetwork)/),t.support.pjax?j():v()}(jQuery);