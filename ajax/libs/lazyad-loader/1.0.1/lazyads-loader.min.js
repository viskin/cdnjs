/**
* lazyads-loader
* lazy-load ads for responsive sites without messing with the ad code.
* Madgex. Build date: 01-04-2014
*/


!function(){function a(a,h){a=a||"",h=h||{};for(var i in b)b.hasOwnProperty(i)&&(h.autoFix&&(h["fix_"+i]=!0),h.fix=h.fix||h["fix_"+i]);var j=[],k=function(b){a+=b},l=function(b){a=b+a},m={comment:/^<!--/,endTag:/^<\//,atomicTag:/^<\s*(script|style|noscript|iframe|textarea)[\s>]/i,startTag:/^</,chars:/^[^<]/},n={comment:function(){var b=a.indexOf("-->");return b>=0?{content:a.substr(4,b),length:b+3}:void 0},endTag:function(){var b=a.match(d);return b?{tagName:b[1],length:b[0].length}:void 0},atomicTag:function(){var b=n.startTag();if(b){var c=a.slice(b.length);if(c.match(new RegExp("</\\s*"+b.tagName+"\\s*>","i"))){var d=c.match(new RegExp("([\\s\\S]*?)</\\s*"+b.tagName+"\\s*>","i"));if(d)return{tagName:b.tagName,attrs:b.attrs,content:d[1],length:d[0].length+b.length}}}},startTag:function(){var b=a.match(c);if(b){var d={};return b[2].replace(e,function(a,b){var c=arguments[2]||arguments[3]||arguments[4]||f.test(b)&&b||null;d[b]=c}),{tagName:b[1],attrs:d,unary:!!b[3],length:b[0].length}}},chars:function(){var b=a.indexOf("<");return{length:b>=0?b:a.length}}},o=function(){for(var b in m)if(m[b].test(a)){g&&console.log("suspected "+b);var c=n[b]();return c?(g&&console.log("parsed "+b,c),c.type=c.type||b,c.text=a.substr(0,c.length),a=a.slice(c.length),c):null}},p=function(a){for(var b;b=o();)if(a[b.type]&&a[b.type](b)===!1)return},q=function(){var b=a;return a="",b},r=function(){return a};return h.fix&&!function(){var b=/^(AREA|BASE|BASEFONT|BR|COL|FRAME|HR|IMG|INPUT|ISINDEX|LINK|META|PARAM|EMBED)$/i,c=/^(COLGROUP|DD|DT|LI|OPTIONS|P|TD|TFOOT|TH|THEAD|TR)$/i,d=[];d.last=function(){return this[this.length-1]},d.lastTagNameEq=function(a){var b=this.last();return b&&b.tagName&&b.tagName.toUpperCase()===a.toUpperCase()},d.containsTagName=function(a){for(var b,c=0;b=this[c];c++)if(b.tagName===a)return!0;return!1};var e=function(a){return a&&"startTag"===a.type&&(a.unary=b.test(a.tagName)||a.unary),a},f=o,g=function(){var b=a,c=e(f());return a=b,c},i=function(){var a=d.pop();l("</"+a.tagName+">")},j={startTag:function(a){var b=a.tagName;"TR"===b.toUpperCase()&&d.lastTagNameEq("TABLE")?(l("<TBODY>"),m()):h.fix_selfClose&&c.test(b)&&d.containsTagName(b)?d.lastTagNameEq(b)?i():(l("</"+a.tagName+">"),m()):a.unary||d.push(a)},endTag:function(a){var b=d.last();b?h.fix_tagSoup&&!d.lastTagNameEq(a.tagName)?i():d.pop():h.fix_tagSoup&&k()}},k=function(){f(),m()},m=function(){var a=g();a&&j[a.type]&&j[a.type](a)};o=function(){return m(),e(f())}}(),{append:k,readToken:o,readTokens:p,clear:q,rest:r,stack:j}}var b=function(){var a,b={},c=this.document.createElement("div");return a="<P><I></P></I>",c.innerHTML=a,b.tagSoup=c.innerHTML!==a,c.innerHTML="<P><i><P></P></i></P>",b.selfClose=2===c.childNodes.length,b}(),c=/^<([\-A-Za-z0-9_]+)((?:\s+[\w\-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,d=/^<\/([\-A-Za-z0-9_]+)[^>]*>/,e=/([\-A-Za-z0-9_]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,f=/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noresize|noshade|nowrap|readonly|selected)$/i,g=!1;a.supports=b,a.tokenToString=function(a){var b={comment:function(a){return"<--"+a.content+"-->"},endTag:function(a){return"</"+a.tagName+">"},atomicTag:function(a){return console.log(a),b.startTag(a)+a.content+b.endTag(a)},startTag:function(a){var b="<"+a.tagName;for(var c in a.attrs){var d=a.attrs[c];b+=" "+c+'="'+(d?d.replace(/(^|[^\\])"/g,'$1\\"'):"")+'"'}return b+(a.unary?"/>":">")},chars:function(a){return a.text}};return b[a.type](a)},a.escapeAttributes=function(a){var b={};for(var c in a){var d=a[c];b[c]=d&&d.replace(/(^|[^\\])"/g,'$1\\"')}return b};for(var h in b)a.browserHasFlaw=a.browserHasFlaw||!b[h]&&h;this.htmlParser=a}(),Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){if(void 0===this||null===this)throw new TypeError('"this" is null or not defined');var c=this.length>>>0;for(b=+b||0,1/0===Math.abs(b)&&(b=0),0>b&&(b+=c,0>b&&(b=0));c>b;b++)if(this[b]===a)return b;return-1}),window.matchMedia||(window.matchMedia=function(a){"use strict";var b=a.document,c=b.documentElement,d=[],e=0,f="",g={},h=/\s*(only|not)?\s*(screen|print|[a-z\-]+)\s*(and)?\s*/i,i=/^\s*\(\s*(-[a-z]+-)?(min-|max-)?([a-z\-]+)\s*(:?\s*([0-9]+(\.[0-9]+)?|portrait|landscape)(px|em|dppx|dpcm|rem|%|in|cm|mm|ex|pt|pc|\/([0-9]+(\.[0-9]+)?))?)?\s*\)\s*$/,j=0,k=function(a){var b=-1!==a.indexOf(",")&&a.split(",")||[a],c=b.length-1,d=c,e=null,j=null,k="",l=0,m=!1,n="",o="",p=null,q=0,r=0,s=null,t="",u="",v="",w="",x="",y=!1;if(""===a)return!0;do if(e=b[d-c],m=!1,j=e.match(h),j&&(k=j[0],l=j.index),!j||-1===e.substring(0,l).indexOf("(")&&(l||!j[3]&&k!==j.input))y=!1;else{if(o=e,m="not"===j[1],l||(n=j[2],o=e.substring(k.length)),y=n===f||"all"===n||""===n,p=-1!==o.indexOf(" and ")&&o.split(" and ")||[o],q=p.length-1,r=q,y&&q>=0&&""!==o)do{if(s=p[q].match(i),!s||!g[s[3]]){y=!1;break}if(t=s[2],u=s[5],w=u,v=s[7],x=g[s[3]],v&&(w="px"===v?Number(u):"em"===v||"rem"===v?16*u:s[8]?(u/s[8]).toFixed(2):"dppx"===v?96*u:"dpcm"===v?.3937*u:Number(u)),y="min-"===t&&w?x>=w:"max-"===t&&w?w>=x:w?x===w:!!x,!y)break}while(q--);if(y)break}while(c--);return m?!y:y},l=function(){var b=a.innerWidth||c.clientWidth,d=a.innerHeight||c.clientHeight,e=a.screen.width,f=a.screen.height,h=a.screen.colorDepth,i=a.devicePixelRatio;g.width=b,g.height=d,g["aspect-ratio"]=(b/d).toFixed(2),g["device-width"]=e,g["device-height"]=f,g["device-aspect-ratio"]=(e/f).toFixed(2),g.color=h,g["color-index"]=Math.pow(2,h),g.orientation=d>=b?"portrait":"landscape",g.resolution=i&&96*i||a.screen.deviceXDPI||96,g["device-pixel-ratio"]=i||1},m=function(){clearTimeout(j),j=setTimeout(function(){var b=null,c=e-1,f=c,g=!1;if(c>=0){l();do if(b=d[f-c],b&&(g=k(b.mql.media),(g&&!b.mql.matches||!g&&b.mql.matches)&&(b.mql.matches=g,b.listeners)))for(var h=0,i=b.listeners.length;i>h;h++)b.listeners[h]&&b.listeners[h].call(a,b.mql);while(c--)}},10)},n=function(){var c=b.getElementsByTagName("head")[0],d=b.createElement("style"),e=null,g=["screen","print","speech","projection","handheld","tv","braille","embossed","tty"],h=0,i=g.length,j="#mediamatchjs { position: relative; z-index: 0; }",k="",n=a.addEventListener||(k="on")&&a.attachEvent;for(d.type="text/css",d.id="mediamatchjs",c.appendChild(d),e=a.getComputedStyle&&a.getComputedStyle(d)||d.currentStyle;i>h;h++)j+="@media "+g[h]+" { #mediamatchjs { position: relative; z-index: "+h+" } }";d.styleSheet?d.styleSheet.cssText=j:d.textContent=j,f=g[1*e.zIndex||0],c.removeChild(d),l(),n(k+"resize",m),n(k+"orientationchange",m)};return n(),function(a){var b=e,c={matches:!1,media:a,addListener:function(a){d[b].listeners||(d[b].listeners=[]),a&&d[b].listeners.push(a)},removeListener:function(a){var c=d[b],e=0,f=0;if(c)for(f=c.listeners.length;f>e;e++)c.listeners[e]===a&&c.listeners.splice(e,1)}};return""===a?(c.matches=!0,c):(c.matches=k(a),e=d.push({mql:c,listeners:null}),c)}}(window)),function(){function a(){}function b(a){return"function"==typeof a}function c(a,b,c){var d,e=a&&a.length||0;for(d=0;e>d;d++)b.call(c,a[d],d)}function d(a,b,c){var d;for(d in a)a.hasOwnProperty(d)&&b.call(c,d,a[d])}function e(a,b){return d(b,function(b,c){a[b]=c}),a}function f(a,b){return a=a||{},d(b,function(b,c){null==a[b]&&(a[b]=c)}),a}function g(a){try{return k.call(a)}catch(b){var d=[];return c(a,function(a){d.push(a)}),d}}function h(a){return/^script$/i.test(a.tagName)}var i=this;if(!i.postscribe){var j=!1,k=Array.prototype.slice,l=function(){function a(a,b,c){var d=k+b;if(2===arguments.length){var e=a.getAttribute(d);return null==e?e:String(e)}null!=c&&""!==c?a.setAttribute(d,c):a.removeAttribute(d)}function f(b,c){var d=b.ownerDocument;e(this,{root:b,options:c,win:d.defaultView||d.parentWindow,doc:d,parser:i.htmlParser("",{autoFix:!0}),actuals:[b],proxyHistory:"",proxyRoot:d.createElement(b.nodeName),scriptStack:[],writeQueue:[]}),a(this.proxyRoot,"proxyof",0)}var k="data-ps-";return f.prototype.write=function(){[].push.apply(this.writeQueue,arguments);for(var a;!this.deferredRemote&&this.writeQueue.length;)a=this.writeQueue.shift(),b(a)?this.callFunction(a):this.writeImpl(a)},f.prototype.callFunction=function(a){var b={type:"function",value:a.name||a.toString()};this.onScriptStart(b),a.call(this.win,this.doc),this.onScriptDone(b)},f.prototype.writeImpl=function(a){this.parser.append(a);for(var b,c=[];(b=this.parser.readToken())&&!h(b);)c.push(b);this.writeStaticTokens(c),b&&this.handleScriptToken(b)},f.prototype.writeStaticTokens=function(a){var b=this.buildChunk(a);if(b.actual)return b.html=this.proxyHistory+b.actual,this.proxyHistory+=b.proxy,this.proxyRoot.innerHTML=b.html,j&&(b.proxyInnerHTML=this.proxyRoot.innerHTML),this.walkChunk(),j&&(b.actualInnerHTML=this.root.innerHTML),b},f.prototype.buildChunk=function(a){var b=this.actuals.length,d=[],e=[],f=[];return c(a,function(a){if(d.push(a.text),a.attrs){if(!/^noscript$/i.test(a.tagName)){var c=b++;e.push(a.text.replace(/(\/?>)/," "+k+"id="+c+" $1")),"ps-script"!==a.attrs.id&&f.push("atomicTag"===a.type?"":"<"+a.tagName+" "+k+"proxyof="+c+(a.unary?"/>":">"))}}else e.push(a.text),f.push("endTag"===a.type?a.text:"")}),{tokens:a,raw:d.join(""),actual:e.join(""),proxy:f.join("")}},f.prototype.walkChunk=function(){for(var b,c=[this.proxyRoot];null!=(b=c.shift());){var d=1===b.nodeType,e=d&&a(b,"proxyof");if(!e){d&&(this.actuals[a(b,"id")]=b,a(b,"id",null));var f=b.parentNode&&a(b.parentNode,"proxyof");f&&this.actuals[f].appendChild(b)}c.unshift.apply(c,g(b.childNodes))}},f.prototype.handleScriptToken=function(a){var b=this.parser.clear();b&&this.writeQueue.unshift(b),a.src=a.attrs.src||a.attrs.SRC,a.src&&this.scriptStack.length?this.deferredRemote=a:this.onScriptStart(a);var c=this;this.writeScriptToken(a,function(){c.onScriptDone(a)})},f.prototype.onScriptStart=function(a){a.outerWrites=this.writeQueue,this.writeQueue=[],this.scriptStack.unshift(a)},f.prototype.onScriptDone=function(a){return a!==this.scriptStack[0]?void this.options.error({message:"Bad script nesting or script finished twice"}):(this.scriptStack.shift(),this.write.apply(this,a.outerWrites),void(!this.scriptStack.length&&this.deferredRemote&&(this.onScriptStart(this.deferredRemote),this.deferredRemote=null)))},f.prototype.writeScriptToken=function(a,b){var c=this.buildScript(a);a.src&&(c.src=a.src,this.scriptLoadHandler(c,b));try{this.insertScript(c),a.src||b()}catch(d){this.options.error(d),b()}},f.prototype.buildScript=function(a){var b=this.doc.createElement(a.tagName);return d(a.attrs,function(a,c){b.setAttribute(a,c)}),a.content&&(b.text=a.content),b},f.prototype.insertScript=function(a){this.writeImpl('<span id="ps-script"/>');var b=this.doc.getElementById("ps-script");b.parentNode.replaceChild(a,b)},f.prototype.scriptLoadHandler=function(a,b){function c(){a=a.onload=a.onreadystatechange=a.onerror=null,b()}var d=this.options.error;e(a,{onload:function(){c()},onreadystatechange:function(){/^(loaded|complete)$/.test(a.readyState)&&c()},onerror:function(){d({message:"remote script failed "+a.src}),c()}})},f}(),m=function(){function c(){var a=k.shift();a&&(a.stream=d.apply(null,a))}function d(b,d,f){function i(a){a=f.beforeWrite(a),m.write(a),f.afterWrite(a)}m=new l(b,f),m.id=j++,m.name=f.name||m.id,h.streams[m.name]=m;var k=b.ownerDocument,n={write:k.write,writeln:k.writeln};e(k,{write:function(){return i(g(arguments).join(""))},writeln:function(){return i(g(arguments).join("")+"\n")}});var o=m.win.onerror||a;return m.win.onerror=function(a,b,c){f.error({msg:a+" - "+b+":"+c}),o.apply(m.win,arguments)},m.write(d,function(){e(k,n),m.win.onerror=o,f.done(),m=null,c()}),m}function h(d,e,g){b(g)&&(g={done:g}),g=f(g,{done:a,error:function(a){throw a},beforeWrite:function(a){return a},afterWrite:a}),d=/^#/.test(d)?i.document.getElementById(d.substr(1)):d.jquery?d[0]:d;var h=[d,e,g];return d.postscribe={cancel:function(){h.stream?h.stream.abort():h[1]=a}},k.push(h),m||c(),d.postscribe}var j=0,k=[],m=null;return e(h,{streams:{},queue:k,WriteStream:l})}();i.postscribe=m}}(),!function(a,b){"undefined"!=typeof module?module.exports=b():"function"==typeof define&&"object"==typeof define.amd?define(b):this[a]=b()}("domready",function(a){function b(a){for(n=1;a=d.shift();)a()}var c,d=[],e=!1,f=document,g=f.documentElement,h=g.doScroll,i="DOMContentLoaded",j="addEventListener",k="onreadystatechange",l="readyState",m=h?/^loaded|^c/:/^loaded|c/,n=m.test(f[l]);return f[j]&&f[j](i,c=function(){f.removeEventListener(i,c,e),b()},e),h&&f.attachEvent(k,c=function(){/^c/.test(f[l])&&(f.detachEvent(k,c),b())}),a=h?function(b){self!=top?n?b():d.push(b):function(){try{g.doScroll("left")}catch(c){return setTimeout(function(){a(b)},50)}b()}()}:function(a){n?a():d.push(a)}}),function(){function a(){b===!0&&window.console&&(a=Function.prototype.bind?Function.prototype.bind.call(console.log,console):function(){Function.prototype.apply.call(console.log,console,arguments)},a.apply(this,arguments))}var b=!0,c={containerElement:"script"},d=0,e=(new Date).getTime(),f=window.jQuery||window.Zepto?!0:!1;window.LazyAds=LazyAds={},console.time("lazyAds"),LazyAds.find=function(b,c,d){var e,g,h,i,j,k=[],d=d||document;if(f===!0)return a("Using jquery"),$(d).find(tagname+"."+c);if(i="classList"in document.createElement("_"),j="querySelectorAll"in document)e=b,e+=c?"."+c:"",k=d.querySelectorAll(e);else for(q=d.getElementsByTagName(b),h=0;h<q.length;h++)g=q[h],c===!1?k.push(g):i?g.classList.contains(c)&&k.push(g):g.className&&-1!==g.className.split(/\s/).indexOf(c)&&k.push(g);return k},LazyAds.findAdContainers=function(){for(var a,b,d=LazyAds.find(c.containerElement,c.containerClass),e=[],f=0;f<d.length;f++)a=d[f],b=null!==a.getAttribute("data-lazyad"),b&&e.push(a);return e},LazyAds.findAdScripts=function(a){for(var b,c,d=find("script",!1,a),e=[],f=0;f<d.length;f++)b=d[f],c=b.getAttribute("type"),c&&"text/lazyad"===c&&e.push(b);return e},LazyAds.stripCommentBlock=function(a){return a=a.replace(/^\s+|\s+$/g,""),a.replace("<!--","").replace("-->","")},LazyAds.adReplace=function(b,c){var e,f;a("Injecting lazy-loaded Ad",b),c=LazyAds.stripCommentBlock(c),e=document.createElement("div"),e.className="lazy-ad-injected",f=b.parentNode.appendChild(e),postscribe(f,c),d++},LazyAds.processAll=function(b){for(var c,d,e,f,g,h,i,j,k,l=0;l<b.length;l++){if(c=b[l],d=c.parentNode,j=c.getAttribute("data-matchmedia")||!1,h=parseInt(c.getAttribute("data-adwidth"))||!1,i=parseInt(c.getAttribute("data-adheight"))||!1,e=c,(h||i)&&(f=d.offsetWidth,g=d.offsetHeight,k=!0,h&&h>f&&(k=!1),i&&i>g&&(k=!1),k===!1)){a("Lazy-loaded container dimensions fulfilment not met.",h,i,f,g,c,e);break}if(j!==!1&&matchMedia(j).matches===!1){a("Lazy-loaded Ad media-query fulfilment not met.",c,e);break}LazyAds.adReplace(c,e.innerHTML)}},LazyAds.init=function(){a("Lazyad init. Using jQuery/Zepto: "+f);var b,c;b=LazyAds.findAdContainers(),b&&b.length&&LazyAds.processAll(b),c=(new Date).getTime()-e,c="~"+c+"ms",a("Lazy-loaded count: ",d,c),console.timeEnd("lazyAds")},domready(function(){LazyAds.init()})}();
//# sourceMappingURL=lazyads-loader.min.map