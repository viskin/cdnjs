!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.JSData=e()}}(function(){var define,module,exports;return function e(t,r,n){function i(s,a){if(!r[s]){if(!t[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=r[s]={exports:{}};t[s][0].call(l.exports,function(e){var r=t[s][1][e];return i(r?r:e)},l,l.exports,e,t,r,n)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(require,module,exports){!function(global){"use strict";function detectObjectObserve(){function e(e){t=e}if("function"!=typeof Object.observe||"function"!=typeof Array.observe)return!1;var t=[],r={},n=[];return Object.observe(r,e),Array.observe(n,e),r.id=1,r.id=2,delete r.id,n.push(1,2),n.length=0,Object.deliverChangeRecords(e),5!==t.length?!1:"add"!=t[0].type||"update"!=t[1].type||"delete"!=t[2].type||"splice"!=t[3].type||"splice"!=t[4].type?!1:(Object.unobserve(r,e),Array.unobserve(n,e),!0)}function detectEval(){if("undefined"!=typeof chrome&&chrome.app&&chrome.app.runtime)return!1;try{var e=new Function("","return true;");return e()}catch(t){return!1}}function dirtyCheck(e){for(var t=0;MAX_DIRTY_CHECK_CYCLES>t&&e.check_();)t++;return global.testingExposeCycleCount&&(global.dirtyCheckCycleCount=t),t>0}function objectIsEmpty(e){for(var t in e)return!1;return!0}function diffIsEmpty(e){return objectIsEmpty(e.added)&&objectIsEmpty(e.removed)&&objectIsEmpty(e.changed)}function isBlacklisted(e,t){if(!t||!t.length)return!1;for(var r,n=0;n<t.length;n++)if("[object RegExp]"===Object.prototype.toString.call(t[n])&&t[n].test(e)||t[n]===e)return r=e;return!!r}function diffObjectFromOldObject(e,t,r,n){var i={},o={},s={};for(var a in t){var c=e[a];isBlacklisted(a,n)||void 0!==c&&(r?r(c,t[a]):c===t[a])||(a in e?(r?r(c,t[a]):c===t[a])||(s[a]=c):o[a]=void 0)}for(var a in e)a in t||isBlacklisted(a,n)||(i[a]=e[a]);return Array.isArray(e)&&e.length!==t.length&&(s.length=e.length),{added:i,removed:o,changed:s}}function runEOMTasks(){if(!eomTasks.length)return!1;for(var e=0;e<eomTasks.length;e++)eomTasks[e]();return eomTasks.length=0,!0}function newObservedObject(){function e(e){t&&t.state_===OPENED&&!n&&t.check_(e)}var t,r,n=!1,i=!0;return{open:function(r){if(t)throw Error("ObservedObject in use");i||Object.deliverChangeRecords(e),t=r,i=!1},observe:function(t,n){r=t,n?Array.observe(r,e):Object.observe(r,e)},deliver:function(t){n=t,Object.deliverChangeRecords(e),n=!1},close:function(){t=void 0,Object.unobserve(r,e),observedObjectCache.push(this)}}}function getObservedObject(e,t,r){var n=observedObjectCache.pop()||newObservedObject();return n.open(e),n.observe(t,r),n}function Observer(){this.state_=UNOPENED,this.callback_=void 0,this.target_=void 0,this.directObserver_=void 0,this.value_=void 0,this.id_=nextObserverId++}function addToAll(e){Observer._allObserversCount++,collectObservers&&allObservers.push(e)}function removeFromAll(){Observer._allObserversCount--}function ObjectObserver(e){Observer.call(this),this.value_=e,this.oldObject_=void 0}function diffObjectFromChangeRecords(e,t,r){for(var n={},i={},o=0;o<t.length;o++){var s=t[o];expectedRecordTypes[s.type]?(s.name in r||(r[s.name]=s.oldValue),"update"!=s.type&&("add"!=s.type?s.name in n?(delete n[s.name],delete r[s.name]):i[s.name]=!0:s.name in i?delete i[s.name]:n[s.name]=!0)):(console.error("Unknown changeRecord type: "+s.type),console.error(s))}for(var a in n)n[a]=e[a];for(var a in i)i[a]=void 0;var c={};for(var a in r)if(!(a in n||a in i)){var u=e[a];r[a]!==u&&(c[a]=u)}return{added:n,removed:i,changed:c}}var equalityFn=function(e,t){return e===t},blacklist=[],hasObserve=detectObjectObserve(),hasEval=detectEval(),createObject="__proto__"in{}?function(e){return e}:function(e){var t=e.__proto__;if(!t)return e;var r=Object.create(t);return Object.getOwnPropertyNames(e).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(e,t))}),r},MAX_DIRTY_CHECK_CYCLES=1e3,eomTasks=[],runEOM=hasObserve?function(){var e={pingPong:!0},t=!1;return Object.observe(e,function(){runEOMTasks(),t=!1}),function(r){eomTasks.push(r),t||(t=!0,e.pingPong=!e.pingPong)}}():function(){return function(e){eomTasks.push(e)}}(),observedObjectCache=[],UNOPENED=0,OPENED=1,CLOSED=2,nextObserverId=1;Observer.prototype={open:function(e,t){if(this.state_!=UNOPENED)throw Error("Observer has already been opened.");return addToAll(this),this.callback_=e,this.target_=t,this.connect_(),this.state_=OPENED,this.value_},close:function(){this.state_==OPENED&&(removeFromAll(this),this.disconnect_(),this.value_=void 0,this.callback_=void 0,this.target_=void 0,this.state_=CLOSED)},deliver:function(){this.state_==OPENED&&dirtyCheck(this)},report_:function(e){try{this.callback_.apply(this.target_,e)}catch(t){Observer._errorThrownDuringCallback=!0,console.error("Exception caught during observer callback: "+(t.stack||t))}},discardChanges:function(){return this.check_(void 0,!0),this.value_}};var collectObservers=!hasObserve,allObservers;Observer._allObserversCount=0,collectObservers&&(allObservers=[]);var runningMicrotaskCheckpoint=!1,hasDebugForceFullDelivery=hasObserve&&hasEval&&function(){try{return eval("%RunMicrotasks()"),!0}catch(ex){return!1}}();global.Platform=global.Platform||{},global.Platform.performMicrotaskCheckpoint=function(){if(!runningMicrotaskCheckpoint){if(hasDebugForceFullDelivery)return void eval("%RunMicrotasks()");if(collectObservers){runningMicrotaskCheckpoint=!0;var cycles=0,anyChanged,toCheck;do{cycles++,toCheck=allObservers,allObservers=[],anyChanged=!1;for(var i=0;i<toCheck.length;i++){var observer=toCheck[i];observer.state_==OPENED&&(observer.check_()&&(anyChanged=!0),allObservers.push(observer))}runEOMTasks()&&(anyChanged=!0)}while(MAX_DIRTY_CHECK_CYCLES>cycles&&anyChanged);global.testingExposeCycleCount&&(global.dirtyCheckCycleCount=cycles),runningMicrotaskCheckpoint=!1}}},collectObservers&&(global.Platform.clearObservers=function(){allObservers=[]}),ObjectObserver.prototype=createObject({__proto__:Observer.prototype,arrayObserve:!1,connect_:function(){hasObserve?this.directObserver_=getObservedObject(this,this.value_,this.arrayObserve):this.oldObject_=this.copyObject(this.value_)},copyObject:function(e){var t=Array.isArray(e)?[]:{};for(var r in e)t[r]=e[r];return Array.isArray(e)&&(t.length=e.length),t},check_:function(e){var t,r;if(hasObserve){if(!e)return!1;r={},t=diffObjectFromChangeRecords(this.value_,e,r)}else r=this.oldObject_,t=diffObjectFromOldObject(this.value_,this.oldObject_,equalityFn,blacklist);return diffIsEmpty(t)?!1:(hasObserve||(this.oldObject_=this.copyObject(this.value_)),this.report_([t.added||{},t.removed||{},t.changed||{},function(e){return r[e]}]),!0)},disconnect_:function(){hasObserve?(this.directObserver_.close(),this.directObserver_=void 0):this.oldObject_=void 0},deliver:function(){this.state_==OPENED&&(hasObserve?this.directObserver_.deliver(!1):dirtyCheck(this))},discardChanges:function(){return this.directObserver_?this.directObserver_.deliver(!0):this.oldObject_=this.copyObject(this.value_),this.value_}});var observerSentinel={},expectedRecordTypes={add:!0,update:!0,"delete":!0};global.Observer=Observer,global.diffObjectFromOldObject=diffObjectFromOldObject,global.setEqualityFn=function(e){equalityFn=e},global.setBlacklist=function(e){blacklist=e},global.Observer.runEOM_=runEOM,global.Observer.observerSentinel_=observerSentinel,global.Observer.hasObjectObserve=hasObserve,global.ObjectObserver=ObjectObserver}(exports)},{}],2:[function(e,t){(function(e,r){(function(){"use strict";function n(e){return"function"==typeof e||"object"==typeof e&&null!==e}function i(e){return"function"==typeof e}function o(e){return"object"==typeof e&&null!==e}function s(){}function a(){return function(){e.nextTick(f)}}function c(){var e=0,t=new K(f),r=document.createTextNode("");return t.observe(r,{characterData:!0}),function(){r.data=e=++e%2}}function u(){var e=new MessageChannel;return e.port1.onmessage=f,function(){e.port2.postMessage(0)}}function l(){return function(){setTimeout(f,1)}}function f(){for(var e=0;P>e;e+=2){var t=L[e],r=L[e+1];t(r),L[e]=void 0,L[e+1]=void 0}P=0}function d(){}function p(){return new TypeError("You cannot resolve a promise with itself")}function h(){return new TypeError("A promises callback cannot return that same promise.")}function v(e){try{return e.then}catch(t){return Y.error=t,Y}}function m(e,t,r,n){try{e.call(t,r,n)}catch(i){return i}}function g(e,t,r){T(function(e){var n=!1,i=m(r,t,function(r){n||(n=!0,t!==r?w(e,r):A(e,r))},function(t){n||(n=!0,E(e,t))},"Settle: "+(e._label||" unknown promise"));!n&&i&&(n=!0,E(e,i))},e)}function b(e,t){t._state===B?A(e,t._result):e._state===V?E(e,t._result):j(t,void 0,function(t){w(e,t)},function(t){E(e,t)})}function y(e,t){if(t.constructor===e.constructor)b(e,t);else{var r=v(t);r===Y?E(e,Y.error):void 0===r?A(e,t):i(r)?g(e,t,r):A(e,t)}}function w(e,t){e===t?E(e,p()):n(t)?y(e,t):A(e,t)}function O(e){e._onerror&&e._onerror(e._result),_(e)}function A(e,t){e._state===q&&(e._result=t,e._state=B,0===e._subscribers.length||T(_,e))}function E(e,t){e._state===q&&(e._state=V,e._result=t,T(O,e))}function j(e,t,r,n){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+B]=r,i[o+V]=n,0===o&&e._state&&T(_,e)}function _(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n,i,o=e._result,s=0;s<t.length;s+=3)n=t[s],i=t[s+r],n?F(r,n,i,o):i(o);e._subscribers.length=0}}function x(){this.error=null}function S(e,t){try{return e(t)}catch(r){return W.error=r,W}}function F(e,t,r,n){var o,s,a,c,u=i(r);if(u){if(o=S(r,n),o===W?(c=!0,s=o.error,o=null):a=!0,t===o)return void E(t,h())}else o=n,a=!0;t._state!==q||(u&&a?w(t,o):c?E(t,s):e===B?A(t,o):e===V&&E(t,o))}function C(e,t){try{t(function(t){w(e,t)},function(t){E(e,t)})}catch(r){E(e,r)}}function D(e,t,r,n){this._instanceConstructor=e,this.promise=new e(d,n),this._abortOnReject=r,this._validateInput(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._init(),0===this.length?A(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&A(this.promise,this._result))):E(this.promise,this._validationError())}function k(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function I(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function M(e){this._id=G++,this._state=void 0,this._result=void 0,this._subscribers=[],d!==e&&(i(e)||k(),this instanceof M||I(),C(this,e))}var R;R=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var N,U=R,P=(Date.now||function(){return(new Date).getTime()},Object.create||function(e){if(arguments.length>1)throw new Error("Second argument not supported");if("object"!=typeof e)throw new TypeError("Argument must be an object");return s.prototype=e,new s},0),T=function(e,t){L[P]=e,L[P+1]=t,P+=2,2===P&&N()},H="undefined"!=typeof window?window:{},K=H.MutationObserver||H.WebKitMutationObserver,Q="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,L=new Array(1e3);N="undefined"!=typeof e&&"[object process]"==={}.toString.call(e)?a():K?c():Q?u():l();var q=void 0,B=1,V=2,Y=new x,W=new x;D.prototype._validateInput=function(e){return U(e)},D.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},D.prototype._init=function(){this._result=new Array(this.length)};var $=D;D.prototype._enumerate=function(){for(var e=this.length,t=this.promise,r=this._input,n=0;t._state===q&&e>n;n++)this._eachEntry(r[n],n)},D.prototype._eachEntry=function(e,t){var r=this._instanceConstructor;o(e)?e.constructor===r&&e._state!==q?(e._onerror=null,this._settledAt(e._state,t,e._result)):this._willSettleAt(r.resolve(e),t):(this._remaining--,this._result[t]=this._makeResult(B,t,e))},D.prototype._settledAt=function(e,t,r){var n=this.promise;n._state===q&&(this._remaining--,this._abortOnReject&&e===V?E(n,r):this._result[t]=this._makeResult(e,t,r)),0===this._remaining&&A(n,this._result)},D.prototype._makeResult=function(e,t,r){return r},D.prototype._willSettleAt=function(e,t){var r=this;j(e,void 0,function(e){r._settledAt(B,t,e)},function(e){r._settledAt(V,t,e)})};var J=function(e,t){return new $(this,e,!0,t).promise},z=function(e,t){function r(e){w(o,e)}function n(e){E(o,e)}var i=this,o=new i(d,t);if(!U(e))return E(o,new TypeError("You must pass an array to race.")),o;for(var s=e.length,a=0;o._state===q&&s>a;a++)j(i.resolve(e[a]),void 0,r,n);return o},X=function(e,t){var r=this;if(e&&"object"==typeof e&&e.constructor===r)return e;var n=new r(d,t);return w(n,e),n},Z=function(e,t){var r=this,n=new r(d,t);return E(n,e),n},G=0,et=M;M.all=J,M.race=z,M.resolve=X,M.reject=Z,M.prototype={constructor:M,then:function(e,t){var r=this,n=r._state;if(n===B&&!e||n===V&&!t)return this;var i=new this.constructor(d),o=r._result;if(n){var s=arguments[n-1];T(function(){F(n,i,s,o)})}else j(r,i,e,t);return i},"catch":function(e){return this.then(null,e)}};var tt=function(){var e;e="undefined"!=typeof r?r:"undefined"!=typeof window&&window.document?window:self;var t="Promise"in e&&"resolve"in e.Promise&&"reject"in e.Promise&&"all"in e.Promise&&"race"in e.Promise&&function(){var t;return new e.Promise(function(e){t=e}),i(t)}();t||(e.Promise=et)},rt={Promise:et,polyfill:tt};"function"==typeof define&&define.amd?define(function(){return rt}):"undefined"!=typeof t&&t.exports?t.exports=rt:"undefined"!=typeof this&&(this.ES6Promise=rt)}).call(this)}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:3}],3:[function(e,t){function r(){}var n=t.exports={};n.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.MutationObserver,r="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};var n=[];if(t){var i=document.createElement("div"),o=new MutationObserver(function(){var e=n.slice();n.length=0,e.forEach(function(e){e()})});return o.observe(i,{attributes:!0}),function(e){n.length||i.setAttribute("yes","no"),n.push(e)}}return r?(window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(e){n.push(e),window.postMessage("process-tick","*")}):function(e){setTimeout(e,0)}}(),n.title="browser",n.browser=!0,n.env={},n.argv=[],n.on=r,n.addListener=r,n.once=r,n.off=r,n.removeListener=r,n.removeAllListeners=r,n.emit=r,n.binding=function(){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(){throw new Error("process.chdir is not supported")}},{}],4:[function(e,t){function r(e,t){return-1!==n(e,t)}var n=e("./indexOf");t.exports=r},{"./indexOf":6}],5:[function(e,t){function r(e,t,r){if(null!=e)for(var n=-1,i=e.length;++n<i&&t.call(r,e[n],n,e)!==!1;);}t.exports=r},{}],6:[function(e,t){function r(e,t,r){if(r=r||0,null==e)return-1;for(var n=e.length,i=0>r?n+r:r;n>i;){if(e[i]===t)return i;i++}return-1}t.exports=r},{}],7:[function(e,t){function r(e,t){var r=n(e,t);-1!==r&&e.splice(r,1)}var n=e("./indexOf");t.exports=r},{"./indexOf":6}],8:[function(e,t){function r(e,t,r){var n=e.length;t=null==t?0:0>t?Math.max(n+t,0):Math.min(t,n),r=null==r?n:0>r?Math.max(n+r,0):Math.min(r,n);for(var i=[];r>t;)i.push(e[t++]);return i}t.exports=r},{}],9:[function(e,t){function r(e,t){if(null==e)return[];if(e.length<2)return e;null==t&&(t=n);var o,s,a;return o=~~(e.length/2),s=r(e.slice(0,o),t),a=r(e.slice(o,e.length),t),i(s,a,t)}function n(e,t){return t>e?-1:e>t?1:0}function i(e,t,r){for(var n=[];e.length&&t.length;)n.push(r(e[0],t[0])<=0?e.shift():t.shift());return e.length&&n.push.apply(n,e),t.length&&n.push.apply(n,t),n}t.exports=r},{}],10:[function(e,t){function r(e){return!!e&&"object"==typeof e&&e.constructor===Object}t.exports=r},{}],11:[function(e,t){function r(e){return null==e?"":e.toString()}t.exports=r},{}],12:[function(e,t){function r(e){for(var t,r=0,o=arguments.length;++r<o;)t=arguments[r],t&&i(t,n,e);return e}function n(e,t){var n=this[t];o(e)&&o(n)?r(n,e):this[t]=e}var i=e("./forOwn"),o=e("../lang/isPlainObject");t.exports=r},{"../lang/isPlainObject":10,"./forOwn":14}],13:[function(e,t){function r(){s=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],o=!0;for(var e in{toString:null})o=!1}function n(e,t,n){var c,u=0;null==o&&r();for(c in e)if(i(t,e,c,n)===!1)break;if(o)for(var l=e.constructor,f=!!l&&e===l.prototype;(c=s[u++])&&("constructor"===c&&(f||!a(e,c))||e[c]===Object.prototype[c]||i(t,e,c,n)!==!1););}function i(e,t,r,n){return e.call(n,t[r],r,t)}var o,s,a=e("./hasOwn");t.exports=n},{"./hasOwn":15}],14:[function(e,t){function r(e,t,r){i(e,function(i,o){return n(e,o)?t.call(r,e[o],o,e):void 0})}var n=e("./hasOwn"),i=e("./forIn");t.exports=r},{"./forIn":13,"./hasOwn":15}],15:[function(e,t){function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=r},{}],16:[function(e,t){function r(e,t){return t?(n(t.split("."),function(t){e[t]||(e[t]={}),e=e[t]}),e):e}var n=e("../array/forEach");t.exports=r},{"../array/forEach":5}],17:[function(e,t){function r(e){for(var t,r="string"!=typeof arguments[1]?arguments[1]:n(arguments,1),i={},o=0;t=r[o++];)i[t]=e[t];return i}var n=e("../array/slice");t.exports=r},{"../array/slice":8}],18:[function(e,t){function r(e,t,r){var i=/^(.+)\.(.+)$/.exec(t);i?n(e,i[1])[i[2]]=r:e[t]=r}var n=e("./namespace");t.exports=r},{"./namespace":16}],19:[function(e,t){function r(e){return e=n(e),e=i(e),e=o(e).replace(/[\-_]/g," ").replace(/\s[a-z]/g,s).replace(/\s+/g,"").replace(/^[A-Z]/g,a)}var n=e("../lang/toString"),i=e("./replaceAccents"),o=e("./removeNonWord"),s=e("./upperCase"),a=e("./lowerCase");t.exports=r},{"../lang/toString":11,"./lowerCase":20,"./removeNonWord":22,"./replaceAccents":23,"./upperCase":24}],20:[function(e,t){function r(e){return e=n(e),e.toLowerCase()}var n=e("../lang/toString");t.exports=r},{"../lang/toString":11}],21:[function(e,t){function r(e){return e=n(e),i(e).replace(/^[a-z]/,o)}var n=e("../lang/toString"),i=e("./camelCase"),o=e("./upperCase");t.exports=r},{"../lang/toString":11,"./camelCase":19,"./upperCase":24}],22:[function(e,t){function r(e){return e=n(e),e.replace(i,"")}var n=e("../lang/toString"),i=/[^\x20\x2D0-9A-Z\x5Fa-z\xC0-\xD6\xD8-\xF6\xF8-\xFF]/g;t.exports=r},{"../lang/toString":11}],23:[function(e,t){function r(e){return e=n(e),e.search(/[\xC0-\xFF]/g)>-1&&(e=e.replace(/[\xC0-\xC5]/g,"A").replace(/[\xC6]/g,"AE").replace(/[\xC7]/g,"C").replace(/[\xC8-\xCB]/g,"E").replace(/[\xCC-\xCF]/g,"I").replace(/[\xD0]/g,"D").replace(/[\xD1]/g,"N").replace(/[\xD2-\xD6\xD8]/g,"O").replace(/[\xD9-\xDC]/g,"U").replace(/[\xDD]/g,"Y").replace(/[\xDE]/g,"P").replace(/[\xE0-\xE5]/g,"a").replace(/[\xE6]/g,"ae").replace(/[\xE7]/g,"c").replace(/[\xE8-\xEB]/g,"e").replace(/[\xEC-\xEF]/g,"i").replace(/[\xF1]/g,"n").replace(/[\xF2-\xF6\xF8]/g,"o").replace(/[\xF9-\xFC]/g,"u").replace(/[\xFE]/g,"p").replace(/[\xFD\xFF]/g,"y")),e}var n=e("../lang/toString");t.exports=r},{"../lang/toString":11}],24:[function(e,t){function r(e){return e=n(e),e.toUpperCase()}var n=e("../lang/toString");t.exports=r},{"../lang/toString":11}],25:[function(e,t){function r(e,t,r){var o=this,s=o.definitions[e];r=r||{},t=t||{};var a;if(s)if(n.isObject(t)){if(r=n._(s,r),r.upsert&&(n.isString(t[s.idAttribute])||n.isNumber(t[s.idAttribute])))return o.update(e,t[s.idAttribute],t,r);r.logFn("create",t,r)}else a=new i.IA('"attrs" must be an object!');else a=new i.NER(e);return new n.Promise(function(e,r){a?r(a):e(t)}).then(function(e){return r.beforeValidate.call(e,r,e)}).then(function(e){return r.validate.call(e,r,e)}).then(function(e){return r.afterValidate.call(e,r,e)}).then(function(e){return r.beforeCreate.call(e,r,e)}).then(function(e){return r.notify&&o.emit(r,"beforeCreate",n.copy(e)),o.getAdapter(r).create(s,e,r)}).then(function(e){return r.afterCreate.call(e,r,e)}).then(function(t){if(r.notify&&o.emit(r,"afterCreate",n.copy(t)),r.cacheResponse){var i=o.inject(s.name,t,r),a=i[s.idAttribute];return o.store[e].completedQueries[a]=(new Date).getTime(),i}return o.createInstance(e,t,r)})}var n=e("../../utils"),i=e("../../errors");t.exports=r},{"../../errors":46,"../../utils":48}],26:[function(e,t){function r(e,t,r){var o,s=this,a=s.definitions[e];return new n.Promise(function(c,u){t=n.resolveId(a,t),a?n.isString(t)||n.isNumber(t)?(o=s.get(e,t)||{id:t},r=n._(a,r),r.logFn("destroy",t,r),c(o)):u(new i.IA('"id" must be a string or a number!')):u(new i.NER(e))}).then(function(e){return r.beforeDestroy.call(e,r,e)}).then(function(i){return r.notify&&s.emit(r,"beforeDestroy",n.copy(i)),r.eagerEject&&s.eject(e,t),s.getAdapter(r).destroy(a,t,r)}).then(function(){return r.afterDestroy.call(o,r,o)}).then(function(i){return r.notify&&s.emit(r,"afterDestroy",n.copy(i)),s.eject(e,t),t})["catch"](function(t){throw r&&r.eagerEject&&o&&s.inject(e,o,{notify:!1}),t})}var n=e("../../utils"),i=e("../../errors");t.exports=r},{"../../errors":46,"../../utils":48}],27:[function(e,t){function r(e,t,r){var o,s,a=this,c=a.definitions[e];return t=t||{},new n.Promise(function(o,s){c?n.isObject(t)?(r=n._(c,r),r.logFn("destroyAll",t,r),o()):s(new i.IA('"params" must be an object!')):s(new i.NER(e))}).then(function(){return s=a.defaults.defaultFilter.call(a,e,t),r.beforeDestroy(r,s)}).then(function(){return r.notify&&a.emit(r,"beforeDestroy",n.copy(s)),r.eagerEject&&(o=a.ejectAll(e,t)),a.getAdapter(r).destroyAll(c,t,r)}).then(function(){return r.afterDestroy(r,s)}).then(function(){return r.notify&&a.emit(r,"afterDestroy",n.copy(s)),o||a.ejectAll(e,t)})["catch"](function(t){throw r&&r.eagerEject&&o&&a.inject(e,o,{notify:!1}),t})}var n=e("../../utils"),i=e("../../errors");t.exports=r},{"../../errors":46,"../../utils":48}],28:[function(e,t){function r(e,t,r){var o=this,s=o.definitions[e],a=o.store[e];return new n.Promise(function(c,u){s?n.isString(t)||n.isNumber(t)?(r=n._(s,r),r.logFn("find",t,r),r.params&&(r.params=n.copy(r.params)),(r.bypassCache||!r.cacheResponse)&&delete a.completedQueries[t],t in a.completedQueries?c(o.get(e,t)):c()):u(new i.IA('"id" must be a string or a number!')):u(new i.NER(e))}).then(function(n){function i(e){return o.getAdapter((r.findFallbackAdapters||r.fallbackAdapters)[e]).find(s,t,r)["catch"](function(t){return e++,e<r.fallbackAdapters.length?i(e):Promise.reject(t)})}if(t in a.completedQueries)return n;if(!(t in a.pendingQueries)){var c,u=r.findStrategy||r.strategy;c="fallback"===u?i(0):o.getAdapter(r).find(s,t,r),a.pendingQueries[t]=c.then(function(n){return delete a.pendingQueries[t],r.cacheResponse?(a.completedQueries[t]=(new Date).getTime(),o.inject(e,n,r)):o.createInstance(e,n,r)})}return a.pendingQueries[t]})["catch"](function(e){throw a&&delete a.pendingQueries[t],e})}var n=e("../../utils"),i=e("../../errors");t.exports=r},{"../../errors":46,"../../utils":48}],29:[function(e,t){function r(e,t,r,n){var o=this,s=o.store[t],a=o.definitions[t].idAttribute,c=(new Date).getTime();e=e||[],delete s.pendingQueries[r],s.completedQueries[r]=c,s.collectionModified=i.updateTimestamp(s.collectionModified);var u=o.inject(t,e,n);return i.isArray(u)?i.forEach(u,function(e){e&&e[a]&&(s.completedQueries[e[a]]=c)}):(n.errorFn("response is expected to be an array!"),s.completedQueries[u[a]]=c),u}function n(e,t,n){var s,a=this,c=a.definitions[e],u=a.store[e];return new i.Promise(function(r,l){t=t||{},a.definitions[e]?i.isObject(t)?(n=i._(c,n),s=i.toJson(t),n.logFn("findAll",t,n),n.params&&(n.params=i.copy(n.params)),(n.bypassCache||!n.cacheResponse)&&(delete u.completedQueries[s],delete u.queryData[s]),s in u.completedQueries?r(n.useFilter?a.filter(e,t,n):u.queryData[s]):r()):l(new o.IA('"params" must be an object!')):l(new o.NER(e))}).then(function(o){function l(e){return a.getAdapter((n.findAllFallbackAdapters||n.fallbackAdapters)[e]).findAll(c,t,n)["catch"](function(t){return e++,e<n.fallbackAdapters.length?l(e):Promise.reject(t)})}if(s in u.completedQueries)return o;if(!(s in u.pendingQueries)){var f,d=n.findAllStrategy||n.strategy;f="fallback"===d?l(0):a.getAdapter(n).findAll(c,t,n),u.pendingQueries[s]=f.then(function(t){return delete u.pendingQueries[s],n.cacheResponse?(u.queryData[s]=r.call(a,t,e,s,n),u.queryData[s].$$injected=!0,u.queryData[s]):(i.forEach(t,function(r,i){t[i]=a.createInstance(e,r,n)}),t)})}return u.pendingQueries[s]})["catch"](function(e){throw u&&delete u.pendingQueries[s],e})}var i=e("../../utils"),o=e("../../errors");t.exports=n},{"../../errors":46,"../../utils":48}],30:[function(e,t){function r(e,t){var r=this,n=r.definitions[e],o=r.store[e];return new i.Promise(function(s,a){if(n){t=i._(n,t),t.hasOwnProperty("notify")||(t.notify=!1),t.logFn("reap",t);for(var c,u=[],l=(new Date).getTime();(c=o.expiresHeap.peek())&&c.expires<l;)u.push(c.item),delete c.item,o.expiresHeap.pop();s(u)}else a(new r.errors.NER(e))}).then(function(s){if((t.isInterval||t.notify)&&(n.beforeReap(t,s),r.emit(t,"beforeReap",i.copy(s))),"inject"===t.reapAction)i.forEach(s,function(e){var t=e[n.idAttribute];o.expiresHeap.push({item:e,timestamp:o.saved[t],expires:n.maxAge?o.saved[t]+n.maxAge:Number.MAX_VALUE})});else if("eject"===t.reapAction)i.forEach(s,function(t){r.eject(e,t[n.idAttribute])});else if("refresh"===t.reapAction){var a=[];return i.forEach(s,function(t){a.push(r.refresh(e,t[n.idAttribute]))}),i.Promise.all(a)}return s}).then(function(e){return(t.isInterval||t.notify)&&(n.afterReap(t,e),r.emit(t,"afterReap",i.copy(e))),e})}function n(e,t,r){var n=this;return new i.Promise(function(s,a){var c=n.definitions[e];t=i.resolveId(n.definitions[e],t),c?i.isString(t)||i.isNumber(t)?(r=i._(c,r),r.bypassCache=!0,r.logFn("refresh",t,r),s(n.get(e,t))):a(new o.IA('"id" must be a string or a number!')):a(new n.errors.NER(e))}).then(function(i){return i?n.find(e,t,r):i})}var i=e("../../utils"),o=e("../../errors");t.exports={create:e("./create"),destroy:e("./destroy"),destroyAll:e("./destroyAll"),find:e("./find"),findAll:e("./findAll"),loadRelations:e("./loadRelations"),reap:r,refresh:n,save:e("./save"),update:e("./update"),updateAll:e("./updateAll")}},{"../../errors":46,"../../utils":48,"./create":25,"./destroy":26,"./destroyAll":27,"./find":28,"./findAll":29,"./loadRelations":31,"./save":32,"./update":33,"./updateAll":34}],31:[function(e,t){function r(e,t,r,o){var s=this,a=s.definitions[e],c=[];return new n.Promise(function(u,l){if((n.isString(t)||n.isNumber(t))&&(t=s.get(e,t)),n.isString(r)&&(r=[r]),a)if(n.isObject(t))if(n.isArray(r)){o=n._(a,o),o.hasOwnProperty("findBelongsTo")||(o.findBelongsTo=!0),o.hasOwnProperty("findHasMany")||(o.findHasMany=!0),o.logFn("loadRelations",t,r,o);var f=[];n.forEach(a.relationList,function(e){var i=e.relation;if(n.contains(r,i)){var u,l={};o.allowSimpleWhere?l[e.foreignKey]=t[a.idAttribute]:(l.where={},l.where[e.foreignKey]={"==":t[a.idAttribute]}),"hasMany"===e.type&&l[e.foreignKey]?u=s.findAll(i,l,o):"hasOne"===e.type?e.localKey&&t[e.localKey]?u=s.find(i,t[e.localKey],o):e.foreignKey&&l[e.foreignKey]&&(u=s.findAll(i,l,o).then(function(e){return e.length?e[0]:null})):t[e.localKey]&&(u=s.find(i,t[e.localKey],o)),u&&(f.push(u),c.push(e.localField))}}),u(f)}else l(new i.IA('"relations" must be a string or an array!'));else l(new i.IA('"instance(id)" must be a string, number or object!'));else l(new i.NER(e))}).then(function(e){return n.Promise.all(e)}).then(function(e){return n.forEach(c,function(r,n){t[r]=e[n]}),t})}var n=e("../../utils"),i=e("../../errors");t.exports=r},{"../../errors":46,"../../utils":48}],32:[function(e,t){function r(e,t,r){var o,s=this,a=s.definitions[e];return new n.Promise(function(c,u){t=n.resolveId(a,t),a?n.isString(t)||n.isNumber(t)?s.get(e,t)?(o=s.get(e,t),r=n._(a,r),r.logFn("save",t,r),c(o)):u(new i.R('id "'+t+'" not found in cache!')):u(new i.IA('"id" must be a string or a number!')):u(new i.NER(e))}).then(function(e){return r.beforeValidate.call(e,r,e)}).then(function(e){return r.validate.call(e,r,e)}).then(function(e){return r.afterValidate.call(e,r,e)}).then(function(e){return r.beforeUpdate.call(e,r,e)}).then(function(i){if(r.notify&&s.emit(r,"beforeUpdate",n.copy(i)),r.changesOnly){var o=s.store[e];n.w&&o.observers[t].deliver();var c=[],u=s.changes(e,t);for(var l in u.added)c.push(l);for(l in u.changed)c.push(l);if(u=n.pick(i,c),n.isEmpty(u))return i;i=u}return s.getAdapter(r).update(a,t,i,r)}).then(function(e){return r.afterUpdate.call(e,r,e)}).then(function(e){return r.notify&&s.emit(r,"afterUpdate",n.copy(e)),r.cacheResponse?s.inject(a.name,e,r):e})}var n=e("../../utils"),i=e("../../errors");t.exports=r},{"../../errors":46,"../../utils":48}],33:[function(e,t){function r(e,t,r,o){var s=this,a=s.definitions[e];return new n.Promise(function(s,c){t=n.resolveId(a,t),a?n.isString(t)||n.isNumber(t)?(o=n._(a,o),o.logFn("update",t,r,o),s(r)):c(new i.IA('"id" must be a string or a number!')):c(new i.NER(e))}).then(function(e){return o.beforeValidate.call(e,o,e)}).then(function(e){return o.validate.call(e,o,e)}).then(function(e){return o.afterValidate.call(e,o,e)}).then(function(e){return o.beforeUpdate.call(e,o,e)}).then(function(e){return o.notify&&s.emit(o,"beforeUpdate",n.copy(e)),s.getAdapter(o).update(a,t,e,o)}).then(function(e){return o.afterUpdate.call(e,o,e)}).then(function(e){return o.notify&&s.emit(o,"afterUpdate",n.copy(e)),o.cacheResponse?s.inject(a.name,e,o):e})}var n=e("../../utils"),i=e("../../errors");t.exports=r},{"../../errors":46,"../../utils":48}],34:[function(e,t){function r(e,t,r,o){var s=this,a=s.definitions[e];return new n.Promise(function(s,c){a?(o=n._(a,o),o.logFn("updateAll",t,r,o),s(t)):c(new i.NER(e))}).then(function(e){return o.beforeValidate.call(e,o,e)}).then(function(e){return o.validate.call(e,o,e)}).then(function(e){return o.afterValidate.call(e,o,e)}).then(function(e){return o.beforeUpdate.call(e,o,e)}).then(function(e){return o.notify&&s.emit(o,"beforeUpdate",n.copy(e)),s.getAdapter(o).updateAll(a,e,r,o)}).then(function(e){return o.afterUpdate.call(e,o,e)}).then(function(e){return o.notify&&s.emit(o,"afterUpdate",n.copy(t)),o.cacheResponse?s.inject(a.name,e,o):e})}var n=e("../../utils"),i=e("../../errors");t.exports=r},{"../../errors":46,"../../utils":48}],35:[function(e,t){function r(e,t,r){r(null,t)}function n(e,t){return t}function i(e,t,r,n){var o=e[t],s=r[o[0]],a=n[o[0]];return c.isString(s)&&(s=c.upperCase(s)),c.isString(a)&&(a=c.upperCase(a)),"DESC"===o[1]?s>a?-1:a>s?1:t<e.length-1?i(e,t+1,r,n):0:a>s?-1:s>a?1:t<e.length-1?i(e,t+1,r,n):0}function o(){}function s(t){var r=this;t=t||{};try{a=e("js-data-schema")}catch(n){}if(!a)try{a=window.Schemator}catch(n){}(a||t.schemator)&&(r.schemator=t.schemator||new a),r.store={},r.definitions={},r.adapters={},r.defaults=new o,r.observe=c.observe,c.deepMixIn(r.defaults,t),r.defaults.logFn("new data store created",r.defaults)}var a,c=e("../utils"),u=(e("../errors"),e("./sync_methods")),l=e("./async_methods"),f=o.prototype;f.actions={},f.afterCreate=r,f.afterCreateInstance=n,f.afterDestroy=r,f.afterEject=n,f.afterInject=n,f.afterReap=n,f.afterUpdate=r,f.afterValidate=r,f.allowSimpleWhere=!0,f.basePath="",f.beforeCreate=r,f.beforeCreateInstance=n,f.beforeDestroy=r,f.beforeEject=n,f.beforeInject=n,f.beforeReap=n,f.beforeUpdate=r,f.beforeValidate=r,f.bypassCache=!1,f.cacheResponse=!!c.w,f.defaultAdapter="http",f.debug=!0,f.eagerEject=!1,f.eagerInject=!1,f.endpoint="",f.error=console?function(e,t,r){console["function"==typeof console.error?"error":"log"](e,t,r)
}:!1,f.errorFn=function(e,t){if(this.error&&"function"==typeof this.error){try{throw"string"==typeof e?new Error(e):e}catch(r){e=r}this.error(this.name||null,e||null,t||null)}},f.fallbackAdapters=["http"],f.findBelongsTo=!0,f.findHasOne=!0,f.findHasMany=!0,f.findInverseLinks=!0,f.idAttribute="id",f.ignoredChanges=[/\$/],f.ignoreMissing=!1,f.keepChangeHistory=!1,f.loadFromServer=!1,f.log=console?function(e,t,r,n,i){console["function"==typeof console.info?"info":"log"](e,t,r,n,i)}:!1,f.logFn=function(e,t,r,n){this.debug&&this.log&&"function"==typeof this.log&&this.log(this.name||null,e||null,t||null,r||null,n||null)},f.maxAge=!1,f.notify=!!c.w,f.reapAction=c.w?"inject":"none",f.reapInterval=c.w?3e4:!1,f.resetHistoryOnInject=!0,f.strategy="single",f.upsert=!!c.w,f.useClass=!0,f.useFilter=!1,f.validate=r,f.defaultFilter=function(e,t,r,n){var o=this,s=e,a=null,u={skip:"",offset:"",where:"",limit:"",orderBy:"",sort:""};r=r||{},n=n||{},a=c.isObject(r.where)?r.where:{},n.allowSimpleWhere&&c.forOwn(r,function(e,t){t in u||t in a||(a[t]={"==":e})}),c.isEmpty(a)&&(a=null),a&&(s=c.filter(s,function(e){var t=!0,r=!0;return c.forOwn(a,function(n,i){c.isString(n)?n={"===":n}:(c.isNumber(n)||c.isBoolean(n))&&(n={"==":n}),c.isObject(n)&&c.forOwn(n,function(n,o){var s,a="|"===o[0],u=e[i];o=a?o.substr(1):o,"=="===o?s=u==n:"==="===o?s=u===n:"!="===o?s=u!=n:"!=="===o?s=u!==n:">"===o?s=u>n:">="===o?s=u>=n:"<"===o?s=n>u:"<="===o?s=n>=u:"isectEmpty"===o?s=!c.intersection(u||[],n||[]).length:"isectNotEmpty"===o?s=c.intersection(u||[],n||[]).length:"in"===o?s=c.isString(n)?-1!==n.indexOf(u):c.contains(n,u):"notIn"===o&&(s=c.isString(n)?-1===n.indexOf(u):!c.contains(n,u)),void 0!==s&&(r=t?s:a?r||s:r&&s),t=!1})}),r}));var l=null;if(c.isString(r.orderBy)?l=[[r.orderBy,"ASC"]]:c.isArray(r.orderBy)&&(l=r.orderBy),!l&&c.isString(r.sort)?l=[[r.sort,"ASC"]]:!l&&c.isArray(r.sort)&&(l=r.sort),l){var f=0;c.forEach(l,function(e,t){if(c.isString(e))l[t]=[e,"ASC"];else if(!c.isArray(e))throw new o.errors.IllegalArgumentError("DS.filter(resourceName[, params][, options]): "+c.toJson(e)+": Must be a string or an array!",{params:{"orderBy[i]":{actual:typeof e,expected:"string|array"}}})}),s=c.sort(s,function(e,t){return i(l,f,e,t)})}var d=c.isNumber(r.limit)?r.limit:null,p=null;return c.isNumber(r.skip)?p=r.skip:c.isNumber(r.offset)&&(p=r.offset),d&&p?s=c.slice(s,p,Math.min(s.length,p+d)):c.isNumber(d)?s=c.slice(s,0,Math.min(s.length,d)):c.isNumber(p)&&(s=p<s.length?c.slice(s,p):[]),s};var d=s.prototype;d.getAdapter=function(e){var t=!1;e=e||{},this.defaults.logFn("getAdapter",e),c.isString(e)&&(t=!0,e={adapter:e});var r=this.adapters[e.adapter];if(r)return r;if(t)throw new Error(e.adapter+" is not a registered adapter!");return this.adapters[e.defaultAdapter]},d.registerAdapter=function(e,t,r){var n=this;r=r||{},n.defaults.logFn("registerAdapter",e,t,r),n.adapters[e]=c.isFunction(t)?new t(r):t,r.default&&(n.defaults.defaultAdapter=e),n.defaults.logFn("default adapter is "+n.defaults.defaultAdapter)},d.emit=function(e,t){var r=Array.prototype.slice.call(arguments,2);r.unshift(e.name),r.unshift("DS."+t),e.emit.apply(e,r)},d.errors=e("../errors"),d.utils=c,c.deepMixIn(d,u),c.deepMixIn(d,l),t.exports=s},{"../errors":46,"../utils":48,"./async_methods":30,"./sync_methods":40,"js-data-schema":"js-data-schema"}],36:[function(require,module,exports){function Resource(e){DSUtils.deepMixIn(this,e),this.endpoint="endpoint"in e?e.endpoint:this.name}function defineResource(definition){var _this=this,definitions=_this.definitions;if(DSUtils.isString(definition)&&(definition={name:definition.replace(/\s/gi,"")}),!DSUtils.isObject(definition))throw new DSErrors.IA('"definition" must be an object!');if(!DSUtils.isString(definition.name))throw new DSErrors.IA('"name" must be a string!');if(_this.store[definition.name])throw new DSErrors.R(definition.name+" is already registered!");try{Resource.prototype=_this.defaults,definitions[definition.name]=new Resource(definition);var def=definitions[definition.name];if(def.logFn("Preparing resource."),!DSUtils.isString(def.idAttribute))throw new DSErrors.IA('"idAttribute" must be a string!');def.relations&&(def.relationList=[],def.relationFields=[],DSUtils.forOwn(def.relations,function(e,t){DSUtils.forOwn(e,function(r,n){DSUtils.isArray(r)||(e[n]=[r]),DSUtils.forEach(e[n],function(e){e.type=t,e.relation=n,e.name=def.name,def.relationList.push(e),def.relationFields.push(e.localField)})})}),def.relations.belongsTo&&DSUtils.forOwn(def.relations.belongsTo,function(e,t){DSUtils.forEach(e,function(e){e.parent&&(def.parent=t,def.parentKey=e.localKey,def.parentField=e.localField)})}),"function"==typeof Object.freeze&&(Object.freeze(def.relations),Object.freeze(def.relationList))),def.getEndpoint=function(e,t){t.params=t.params||{};var r,n=def.parentKey,i=t.hasOwnProperty("endpoint")?t.endpoint:def.endpoint,o=def.parentField,s=definitions[def.parent],a=t.params[n];if(a!==!1&&n&&s){if(delete t.params[n],DSUtils.isNumber(e)||DSUtils.isString(e)?r=def.get(e):DSUtils.isObject(e)&&(r=e),r&&(a=a||r[n]||(r[o]?r[o][s.idAttribute]:null)),a){delete t.endpoint;var c={};DSUtils.forOwn(t,function(e,t){c[t]=e});var u=DSUtils.makePath(s.getEndpoint(a,DSUtils._(s,c)),a,i);return u}return i}return a===!1&&delete t.params[n],i},def.filter&&(def.defaultFilter=def.filter,delete def.filter),def["class"]=DSUtils.pascalCase(definition.name);try{eval("function "+def["class"]+"() {}"),def[def["class"]]=eval(def["class"])}catch(e){def[def["class"]]=function(){}}def.methods&&DSUtils.deepMixIn(def[def["class"]].prototype,def.methods),def.computed&&DSUtils.forOwn(def.computed,function(e,t){DSUtils.isFunction(e)&&(def.computed[t]=[e],e=def.computed[t]),def.methods&&t in def.methods&&def.errorFn('Computed property "'+t+'" conflicts with previously defined prototype method!');var r;if(1===e.length){var n=e[0].toString().match(/function.*?\(([\s\S]*?)\)/);r=n[1].split(","),def.computed[t]=r.concat(e),e=def.computed[t],r.length&&def.errorFn("Use the computed property array syntax for compatibility with minified code!")}r=e.slice(0,e.length-1),DSUtils.forEach(r,function(e,t){r[t]=e.trim()}),e.deps=DSUtils.filter(r,function(e){return!!e})}),definition.schema&&_this.schemator&&(def.schema=_this.schemator.defineSchema(def.name,definition.schema),definition.hasOwnProperty("validate")||(def.validate=function(e,t,r){def.schema.validate(t,{ignoreMissing:def.ignoreMissing},function(e){return e?r(e):r(null,t)})})),DSUtils.forEach(instanceMethods,function(e){def[def["class"]].prototype["DS"+DSUtils.pascalCase(e)]=function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this[def.idAttribute]||this),t.unshift(def.name),_this[e].apply(_this,t)}}),def[def["class"]].prototype.DSCreate=function(){var e=Array.prototype.slice.call(arguments);return e.unshift(this),e.unshift(def.name),_this.create.apply(_this,e)},_this.store[def.name]={collection:[],expiresHeap:new DSUtils.DSBinaryHeap(function(e){return e.expires},function(e,t){return e.item===t}),completedQueries:{},queryData:{},pendingQueries:{},index:{},modified:{},saved:{},previousAttributes:{},observers:{},changeHistories:{},changeHistory:[],collectionModified:0},def.reapInterval&&setInterval(function(){_this.reap(def.name,{isInterval:!0})},def.reapInterval);for(var key in _this)"function"==typeof _this[key]&&"defineResource"!==key&&!function(e){def[e]=function(){var t=Array.prototype.slice.call(arguments);return t.unshift(def.name),_this[e].apply(_this,t)}}(key);return def.beforeValidate=DSUtils.promisify(def.beforeValidate),def.validate=DSUtils.promisify(def.validate),def.afterValidate=DSUtils.promisify(def.afterValidate),def.beforeCreate=DSUtils.promisify(def.beforeCreate),def.afterCreate=DSUtils.promisify(def.afterCreate),def.beforeUpdate=DSUtils.promisify(def.beforeUpdate),def.afterUpdate=DSUtils.promisify(def.afterUpdate),def.beforeDestroy=DSUtils.promisify(def.beforeDestroy),def.afterDestroy=DSUtils.promisify(def.afterDestroy),DSUtils.forOwn(def.actions,function(e,t){if(def[t])throw new Error('Cannot override existing method "'+t+'"!');def[t]=function(r){r=r||{};var n=DSUtils.deepMixIn({},e);return n.url=DSUtils.makePath(def.getEndpoint(null,r),t),n.method=n.method||"GET",DSUtils.deepMixIn(n,r),_this.getAdapter(e.adapter||"http").HTTP(n)}}),DSUtils.Events(def),def.logFn("Done preparing resource."),def}catch(err){throw delete definitions[definition.name],delete _this.store[definition.name],err}}var DSUtils=require("../../utils"),DSErrors=require("../../errors"),instanceMethods=["compute","refresh","save","update","destroy","loadRelations","changeHistory","changes","hasChanges","lastModified","lastSaved","link","linkInverse","previous","unlinkInverse"];module.exports=defineResource},{"../../errors":46,"../../utils":48}],37:[function(e,t){function r(e,t,r){var o,s=this,a=s.definitions[e],c=s.store[e],u=!1;if(t=n.resolveId(a,t),!a)throw new i.NER(e);if(!n.isString(t)&&!n.isNumber(t))throw new i.IA('"id" must be a string or a number!');r=n._(a,r),r.logFn("eject",t,r);for(var l=0;l<c.collection.length;l++)if(c.collection[l][a.idAttribute]==t){o=c.collection[l],c.expiresHeap.remove(o),u=!0;break}return u?(r.notify&&(a.beforeEject(r,o),s.emit(r,"beforeEject",n.copy(o))),s.unlinkInverse(a.name,t),c.collection.splice(l,1),n.w&&c.observers[t].close(),delete c.observers[t],delete c.index[t],delete c.previousAttributes[t],delete c.completedQueries[t],delete c.pendingQueries[t],n.forEach(c.changeHistories[t],function(e){n.remove(c.changeHistory,e)}),n.forOwn(c.queryData,function(e){e.$$injected&&n.remove(e,o)}),delete c.changeHistories[t],delete c.modified[t],delete c.saved[t],c.collectionModified=n.updateTimestamp(c.collectionModified),r.notify&&(a.afterEject(r,o),s.emit(r,"afterEject",n.copy(o))),o):void 0}var n=e("../../utils"),i=e("../../errors");t.exports=r},{"../../errors":46,"../../utils":48}],38:[function(e,t){function r(e,t,r){var o=this,s=o.definitions[e];if(t=t||{},!s)throw new i.NER(e);if(!n.isObject(t))throw new i.IA('"params" must be an object!');s.logFn("ejectAll",t,r);var a=o.store[e];n.isEmpty(t)&&(a.completedQueries={});var c=n.toJson(t),u=o.filter(s.name,t),l=[];return n.forEach(u,function(e){e&&e[s.idAttribute]&&l.push(e[s.idAttribute])}),n.forEach(l,function(e){o.eject(s.name,e,r)}),delete a.completedQueries[c],a.collectionModified=n.updateTimestamp(a.collectionModified),u}var n=e("../../utils"),i=e("../../errors");t.exports=r},{"../../errors":46,"../../utils":48}],39:[function(e,t){function r(e,t,r){var o=this,s=o.definitions[e],a=o.store[e];if(!s)throw new i.NER(e);if(t&&!n.isObject(t))throw new i.IA('"params" must be an object!');r=n._(s,r),r.logFn("filter",t,r),t=t||{};var c=n.toJson(t);return c in a.completedQueries||!r.loadFromServer||a.pendingQueries[c]||o.findAll(e,t,r),s.defaultFilter.call(o,a.collection,e,t,r)}var n=e("../../utils"),i=e("../../errors");t.exports=r},{"../../errors":46,"../../utils":48}],40:[function(e,t){function r(e,t,r){var n=this,i=n.definitions[e];if(r=r||{},t=h.resolveId(i,t),!i)throw new m(e);if(!h.isString(t)&&!h.isNumber(t))throw new g('"id" must be a string or a number!');r=h._(i,r),r.logFn("changes",t,r);var o=n.get(e,t);if(o){h.w&&n.store[e].observers[t].deliver();var s=h.diffObjectFromOldObject(o,n.store[e].previousAttributes[t],h.equals,r.ignoredChanges);return h.forOwn(s,function(e,t){var r=[];h.forOwn(e,function(e,t){h.isFunction(e)||r.push(t)}),s[t]=h.pick(s[t],r)}),h.forEach(i.relationFields,function(e){delete s.added[e],delete s.removed[e],delete s.changed[e]}),s}}function n(e,t){var r=this,n=r.definitions[e],i=r.store[e];if(t=h.resolveId(n,t),e&&!r.definitions[e])throw new m(e);if(t&&!h.isString(t)&&!h.isNumber(t))throw new g('"id" must be a string or a number!');if(n.logFn("changeHistory",t),n.keepChangeHistory){if(!e)return i.changeHistory;var o=r.get(e,t);if(o)return i.changeHistories[t]}else n.errorFn("changeHistory is disabled for this resource!")}function i(e,t){var r=this,n=r.definitions[e];if(t=h.resolveItem(r.store[e],t),!n)throw new m(e);if(!t)throw new b("Item not in the store!");if(!h.isObject(t)&&!h.isString(t)&&!h.isNumber(t))throw new g('"instance" must be an object, string or number!');return n.logFn("compute",t),h.forOwn(n.computed,function(e,r){h.compute.call(t,e,r)}),t}function o(e,t,r){var n,i=this.definitions[e];if(t=t||{},!i)throw new m(e);if(t&&!h.isObject(t))throw new g('"attrs" must be an object!');if(r=h._(i,r),r.logFn("createInstance",t,r),r.notify&&r.beforeCreateInstance(r,t),r.useClass){var o=i[i.class];n=new o}else n={};return h.deepMixIn(n,t),r.notify&&r.afterCreateInstance(r,t),n}function s(e){return!(h.isEmpty(e.added)&&h.isEmpty(e.removed)&&h.isEmpty(e.changed))}function a(){this.observe.Platform.performMicrotaskCheckpoint()}function c(e,t,r){var n=this,i=n.definitions[e];if(!i)throw new m(e);if(!h.isString(t)&&!h.isNumber(t))throw new g('"id" must be a string or a number!');r=h._(i,r),r.logFn("get",t,r);var o=n.store[e].index[t];return!o&&r.loadFromServer&&n.find(e,t,r),o}function u(e,t){var r=this,n=r.definitions[e],i=r.store[e],o=[];if(!n)throw new m(e);if(t&&!h.isArray(t))throw new g('"ids" must be an array!');if(n.logFn("getAll",t),h.isArray(t))for(var s=t.length,a=0;s>a;a++)i.index[t[a]]&&o.push(i.index[t[a]]);else o=i.collection.slice();return o}function l(e,t){var r=this,n=r.definitions[e];if(t=h.resolveId(n,t),!n)throw new m(e);if(!h.isString(t)&&!h.isNumber(t))throw new g('"id" must be a string or a number!');return n.logFn("hasChanges",t),r.get(e,t)?s(r.changes(e,t)):!1}function f(e,t){var r=this.definitions[e],n=this.store[e];if(t=h.resolveId(r,t),!r)throw new m(e);return r.logFn("lastModified",t),t?(t in n.modified||(n.modified[t]=0),n.modified[t]):n.collectionModified}function d(e,t){var r=this.definitions[e],n=this.store[e];if(t=h.resolveId(r,t),!r)throw new m(e);return r.logFn("lastSaved",t),t in n.saved||(n.saved[t]=0),n.saved[t]}function p(e,t){var r=this,n=r.definitions[e],i=r.store[e];if(t=h.resolveId(n,t),!n)throw new m(e);if(!h.isString(t)&&!h.isNumber(t))throw new g('"id" must be a string or a number!');return n.logFn("previous",t),i.previousAttributes[t]?h.copy(i.previousAttributes[t]):void 0}var h=e("../../utils"),v=e("../../errors"),m=v.NER,g=v.IA,b=v.R;t.exports={changes:r,changeHistory:n,compute:i,createInstance:o,defineResource:e("./defineResource"),digest:a,eject:e("./eject"),ejectAll:e("./ejectAll"),filter:e("./filter"),get:c,getAll:u,hasChanges:l,inject:e("./inject"),lastModified:f,lastSaved:d,link:e("./link"),linkAll:e("./linkAll"),linkInverse:e("./linkInverse"),previous:p,unlinkInverse:e("./unlinkInverse")}},{"../../errors":46,"../../utils":48,"./defineResource":36,"./eject":37,"./ejectAll":38,"./filter":39,"./inject":41,"./link":42,"./linkAll":43,"./linkInverse":44,"./unlinkInverse":45}],41:[function(e,t){function r(e,t,r){var n=t.name;return function(i,o,a,c,u){var l,f=this,d=c&&c(t.idAttribute)?c(t.idAttribute):f[t.idAttribute];if(s.forEach(t.relationFields,function(e){delete i[e],delete o[e],delete a[e]}),(!s.isEmpty(i)||!s.isEmpty(o)||!s.isEmpty(a)||u)&&(l=e.get(n,d),r.modified[d]=s.updateTimestamp(r.modified[d]),r.collectionModified=s.updateTimestamp(r.collectionModified),t.keepChangeHistory)){var p={resourceName:n,target:l,added:i,removed:o,changed:a,timestamp:r.modified[d]};r.changeHistories[d].push(p),r.changeHistory.push(p)}t.computed&&(l=l||e.get(n,d),s.forOwn(t.computed,function(e,t){var r=!1;s.forEach(e.deps,function(e){(e in i||e in o||e in a||!(t in l))&&(r=!0)}),r=r||!e.deps.length,r&&s.compute.call(l,e,t)})),t.relations&&(l=l||e.get(n,d),s.forEach(t.relationList,function(r){l[r.localField]&&(r.localKey in i||r.localKey in o||r.localKey in a)&&e.link(n,l[t.idAttribute],[r.relation])})),t.idAttribute in a&&t.errorFn('Doh! You just changed the primary key of an object! Your data for the "'+n+'" resource is now in an undefined (probably broken) state.')}}function n(e,t,i,o){var c,u=this,l=r(u,e,t,i,o);if(s.isArray(i)){c=[];for(var f=0;f<i.length;f++)c.push(n.call(u,e,t,i[f],o))}else{var d=e.computed,p=e.idAttribute;if(d&&d[p]){var h=[];s.forEach(d[p].deps,function(e){h.push(i[e])}),i[p]=d[p][d[p].length-1].apply(i,h)}if(!(p in i)){var v=new a.R(e.name+'.inject: "attrs" must contain the property specified by `idAttribute`!');throw o.errorFn(v),v}try{s.forEach(e.relationList,function(t){var r=t.relation,n=u.definitions[r],c=i[t.localField];if(c){if(!n)throw new a.R(e.name+" relation is defined but the resource is not!");if(s.isArray(c)){var l=[];s.forEach(c,function(s){if(s!==u.store[r][s[n.idAttribute]])try{var a=u.inject(r,s,o);t.foreignKey&&(a[t.foreignKey]=i[e.idAttribute]),l.push(a)}catch(c){o.errorFn(c,"Failed to inject "+t.type+' relation: "'+r+'"!')}}),i[t.localField]=l}else if(c!==u.store[r][c[n.idAttribute]])try{i[t.localField]=u.inject(r,i[t.localField],o),t.foreignKey&&(i[t.localField][t.foreignKey]=i[e.idAttribute])}catch(f){o.errorFn(f,"Failed to inject "+t.type+' relation: "'+r+'"!')}}});var m=i[p],g=u.get(e.name,m),b=g?t.modified[m]:0;g?(s.deepMixIn(g,i),e.resetHistoryOnInject&&(t.previousAttributes[m]={},s.deepMixIn(t.previousAttributes[m],i),t.changeHistories[m].length&&(s.forEach(t.changeHistories[m],function(e){s.remove(t.changeHistory,e)}),t.changeHistories[m].splice(0,t.changeHistories[m].length))),s.w&&t.observers[m].deliver()):(g=o.useClass?i instanceof e[e["class"]]?i:new e[e["class"]]:{},t.previousAttributes[m]=s.copy(i),s.deepMixIn(g,i),t.collection.push(g),t.changeHistories[m]=[],s.w&&(t.observers[m]=new u.observe.ObjectObserver(g),t.observers[m].open(l,g)),t.index[m]=g,l.call(g,{},{},{},null,!0)),t.saved[m]=s.updateTimestamp(t.saved[m]),t.modified[m]=b&&t.modified[m]===b?s.updateTimestamp(t.modified[m]):t.modified[m],t.expiresHeap.remove(g),t.expiresHeap.push({item:g,timestamp:t.saved[m],expires:e.maxAge?t.saved[m]+e.maxAge:Number.MAX_VALUE}),c=g}catch(y){o.errorFn(y,i)}}return c}function i(e,t,r){var n=this;s.forEach(e.relationList,function(i){r.findBelongsTo&&"belongsTo"===i.type&&t[e.idAttribute]?n.link(e.name,t[e.idAttribute],[i.relation]):(r.findHasMany&&"hasMany"===i.type||r.findHasOne&&"hasOne"===i.type)&&n.link(e.name,t[e.idAttribute],[i.relation])})}function o(e,t,r){var o,c=this,u=c.definitions[e],l=c.store[e];if(!u)throw new a.NER(e);if(!s.isObject(t)&&!s.isArray(t))throw new a.IA(e+'.inject: "attrs" must be an object or an array!');var f=u.name;return r=s._(u,r),r.logFn("inject",t,r),r.notify&&(r.beforeInject(r,t),c.emit(r,"beforeInject",s.copy(t))),o=n.call(c,u,l,t,r),l.collectionModified=s.updateTimestamp(l.collectionModified),r.findInverseLinks&&(s.isArray(o)?o.length&&c.linkInverse(f,o[0][u.idAttribute]):c.linkInverse(f,o[u.idAttribute])),s.isArray(o)?s.forEach(o,function(e){i.call(c,u,e,r)}):i.call(c,u,o,r),r.notify&&(r.afterInject(r,o),c.emit(r,"afterInject",s.copy(o))),o}var s=e("../../utils"),a=e("../../errors");t.exports=o},{"../../errors":46,"../../utils":48}],42:[function(e,t){function r(e,t,r){var o=this,s=o.definitions[e];if(r=r||[],t=n.resolveId(s,t),!s)throw new i.NER(e);if(!n.isString(t)&&!n.isNumber(t))throw new i.IA('"id" must be a string or a number!');if(!n.isArray(r))throw new i.IA('"relations" must be an array!');s.logFn("link",t,r);var a=o.get(e,t);return a&&n.forEach(s.relationList,function(e){var t=e.relation;if(!r.length||n.contains(r,t)){var i={};if("belongsTo"===e.type){var c=a[e.localKey]?o.get(t,a[e.localKey]):null;c&&(a[e.localField]=c)}else if("hasMany"===e.type)i[e.foreignKey]=a[s.idAttribute],a[e.localField]=o.defaults.constructor.prototype.defaultFilter.call(o,o.store[t].collection,t,i,{allowSimpleWhere:!0});else if("hasOne"===e.type){i[e.foreignKey]=a[s.idAttribute];var u=o.defaults.constructor.prototype.defaultFilter.call(o,o.store[t].collection,t,i,{allowSimpleWhere:!0});u.length&&(a[e.localField]=u[0])}}}),a}var n=e("../../utils"),i=e("../../errors");t.exports=r},{"../../errors":46,"../../utils":48}],43:[function(e,t){function r(e,t,r){var o=this,s=o.definitions[e];if(r=r||[],!s)throw new i.NER(e);if(!n.isArray(r))throw new i.IA('"relations" must be an array!');s.logFn("linkAll",t,r);var a=o.filter(e,t);return a&&n.forEach(s.relationList,function(e){var t=e.relation;(!r.length||n.contains(r,t))&&("belongsTo"===e.type?n.forEach(a,function(r){var n=r[e.localKey]?o.get(t,r[e.localKey]):null;n&&(r[e.localField]=n)}):"hasMany"===e.type?n.forEach(a,function(r){var n={};n[e.foreignKey]=r[s.idAttribute],r[e.localField]=o.defaults.constructor.prototype.defaultFilter.call(o,o.store[t].collection,t,n,{allowSimpleWhere:!0})}):"hasOne"===e.type&&n.forEach(a,function(r){var n={};n[e.foreignKey]=r[s.idAttribute];var i=o.defaults.constructor.prototype.defaultFilter.call(o,o.store[t].collection,t,n,{allowSimpleWhere:!0});i.length&&(r[e.localField]=i[0])}))}),a}var n=e("../../utils"),i=e("../../errors");t.exports=r},{"../../errors":46,"../../utils":48}],44:[function(e,t){function r(e,t,r){var o=this,s=o.definitions[e];if(r=r||[],t=n.resolveId(s,t),!s)throw new i.NER(e);if(!n.isString(t)&&!n.isNumber(t))throw new i.IA('"id" must be a string or a number!');if(!n.isArray(r))throw new i.IA('"relations" must be an array!');s.logFn("linkInverse",t,r);var a=o.get(e,t);return a&&n.forOwn(o.definitions,function(e){n.forOwn(e.relations,function(t){n.forOwn(t,function(t,i){(!r.length||n.contains(r,e.name))&&s.name===i&&o.linkAll(e.name,{},[s.name])})})}),a}var n=e("../../utils"),i=e("../../errors");t.exports=r},{"../../errors":46,"../../utils":48}],45:[function(e,t){function r(e,t,r){var o=this,s=o.definitions[e];if(r=r||[],t=n.resolveId(s,t),!s)throw new i.NER(e);if(!n.isString(t)&&!n.isNumber(t))throw new i.IA('"id" must be a string or a number!');if(!n.isArray(r))throw new i.IA('"relations" must be an array!');s.logFn("unlinkInverse",t,r);var a=o.get(e,t);return a&&n.forOwn(o.definitions,function(e){n.forOwn(e.relations,function(e){n.forOwn(e,function(e,t){s.name===t&&n.forEach(e,function(e){n.forEach(o.store[e.name].collection,function(t){if("hasMany"===e.type&&t[e.localField]){var r;n.forEach(t[e.localField],function(e,t){e===a&&(r=t)}),t[e.localField].splice(r,1)}else t[e.localField]===a&&delete t[e.localField]})})})})}),a}var n=e("../../utils"),i=e("../../errors");t.exports=r},{"../../errors":46,"../../utils":48}],46:[function(e,t){function r(e){Error.call(this),"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.type=this.constructor.name,this.message=e||"Illegal Argument!"}function n(e){Error.call(this),"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.type=this.constructor.name,this.message=e||"RuntimeError Error!"}function i(e){Error.call(this),"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.type=this.constructor.name,this.message=(e||"")+" is not a registered resource!"}r.prototype=new Error,r.prototype.constructor=r,n.prototype=new Error,n.prototype.constructor=n,i.prototype=new Error,i.prototype.constructor=i,t.exports={IllegalArgumentError:r,IA:r,RuntimeError:n,R:n,NonexistentResourceError:i,NER:i}},{}],47:[function(e,t){var r=e("./datastore");t.exports={DS:r,createStore:function(e){return new r(e)},DSUtils:e("./utils"),DSErrors:e("./errors"),version:{full:"1.0.0-beta.1",major:parseInt("1",10),minor:parseInt("0",10),patch:parseInt("0",10),alpha:!1,beta:"1"}}},{"./datastore":35,"./errors":46,"./utils":48}],48:[function(e,t){function r(e){return"[object RegExp]"==F.call(e)||!1}function n(e){return e===!0||e===!1||e&&"object"==typeof e&&"[object Boolean]"==F.call(e)||!1}function i(e){return"string"==typeof e||e&&"object"==typeof e&&"[object String]"==F.call(e)||!1}function o(e){return"[object Object]"==F.call(e)||!1}function s(e){return e&&"object"==typeof e&&"[object Date]"==F.call(e)||!1}function a(e){var t=typeof e;return"number"==t||e&&"object"==t&&"[object Number]"==F.call(e)||!1}function c(e){return"function"==typeof e||e&&"[object Function]"===F.call(e)||!1}function u(e){if(null==e)return!0;if("string"==typeof e||N(e))return!e.length;if("object"==typeof e){var t=!0;return I(e,function(){return t=!1,!1}),t}return!0}function l(e,t){if(!e||!t)return[];for(var r,n=[],i=0,o=e.length;o>i;i++)r=e[i],H.contains(n,r)||H.contains(t,r)&&n.push(r);return n}function f(e,t,r){var n=[];return D(e,function(e,r,i){t(e,r,i)&&n.push(e)},r),n}function d(e){var t=this.constructor;return this.then(function(r){return t.resolve(e()).then(function(){return r})},function(r){return t.resolve(e()).then(function(){throw r})})}function p(e){var t="function"==typeof Date.now?Date.now():(new Date).getTime();return e&&e>=t?e+1:t}function h(e){var t={};e=e||this,e.on=function(e,r,n){t[e]=t[e]||[],t[e].push({f:r,c:n})},e.off=function(e,r){var n=t[e];if(n)if(r){for(var i=0;i<n.length;i++)if(n[i]===r){n.splice(i,1);break}}else n.splice(0,n.length);else t={}},e.emit=function(){var e=Array.prototype.slice.call(arguments),r=t[e.shift()]||[];if(r)for(var n=0;n<r.length;n++)r[n].f.apply(r[n].c,e)}}function v(e,t,r){for(var n=e[r],i=t(n);r>0;){var o=Math.floor((r+1)/2)-1,s=e[o];if(i>=t(s))break;e[o]=n,e[r]=s,r=o}}function m(e,t,r){for(var n=e.length,i=e[r],o=t(i);;){var s=2*(r+1),a=s-1,c=null;if(n>a){var u=e[a],l=t(u);o>l&&(c=a)}if(n>s){var f=e[s],d=t(f);d<(null===c?o:t(e[a]))&&(c=s)}if(null===c)break;e[r]=e[c],e[c]=i,r=c}}function g(e,t){if(e&&!c(e))throw new Error("DSBinaryHeap(weightFunc): weightFunc: must be a function!");e=e||function(e){return e},t=t||function(e,t){return e===t},this.weightFunc=e,this.compareFunc=t,this.heap=[]}function b(e,t,n,i){if(t){if(e===t)throw new Error("Cannot copy! Source and destination are identical.");if(n=n||[],i=i||[],o(e)){var a=n.indexOf(e);if(-1!==a)return i[a];n.push(e),i.push(t)}var c;if(N(e)){t.length=0;for(var u=0;u<e.length;u++)c=b(e[u],null,n,i),o(e[u])&&(n.push(e[u]),i.push(c)),t.push(c)}else{N(t)?t.length=0:D(t,function(e,r){delete t[r]});for(var l in e)e.hasOwnProperty(l)&&(c=b(e[l],null,n,i),o(e[l])&&(n.push(e[l]),i.push(c)),t[l]=c)}}else if(t=e,e)if(N(e))t=b(e,[],n,i);else if(s(e))t=new Date(e.getTime());else if(r(e))t=new RegExp(e.source,e.toString().match(/[^\/]*$/)[0]),t.lastIndex=e.lastIndex;else if(o(e)){var f=Object.create(Object.getPrototypeOf(e));t=b(e,f,n,i)}return t}function y(e,t){if(e===t)return!0;if(null===e||null===t)return!1;if(e!==e&&t!==t)return!0;var n,i,o,a=typeof e,u=typeof t;if(a==u&&"object"==a){if(!N(e)){if(s(e))return s(t)?y(e.getTime(),t.getTime()):!1;if(r(e)&&r(t))return e.toString()==t.toString();if(N(t))return!1;o={};for(i in e)if("$"!==i.charAt(0)&&!c(e[i])){if(!y(e[i],t[i]))return!1;o[i]=!0}for(i in t)if(!o.hasOwnProperty(i)&&"$"!==i.charAt(0)&&void 0!==t[i]&&!c(t[i]))return!1;return!0}if(!N(t))return!1;if((n=e.length)==t.length){for(i=0;n>i;i++)if(!y(e[i],t[i]))return!1;return!0}}return!1}function w(e,t){return this.isString(t)||a(t)?t:t&&e?t[e.idAttribute]||t:t}function O(e,t){return e&&(i(t)||a(t))?e.index[t]||t:t}function A(e){return null!=e&&""!==e}function E(e,t){return t=t||"",f(e,A).join(t)}function j(){var e=E(k(arguments),"/");return e.replace(/([^:\/]|^)\/{2,}/g,"$1/")}var _,x,S=Object.prototype,F=S.toString,C=e("./errors"),D=e("mout/array/forEach"),k=e("mout/array/slice"),I=e("mout/object/forOwn"),M=e("../lib/observe-js/observe-js"),R=e("es6-promise");R.polyfill();var N=Array.isArray||function(e){return"[object Array]"==F.call(e)||!1};try{_=window,_.Promise.prototype["finally"]||(_.Promise.prototype["finally"]=d),x=_.Promise,_={}}catch(U){_=null,x=e("bluebird")}var P=g.prototype;P.push=function(e){this.heap.push(e),v(this.heap,this.weightFunc,this.heap.length-1)},P.peek=function(){return this.heap[0]},P.pop=function(){var e=this.heap[0],t=this.heap.pop();return this.heap.length>0&&(this.heap[0]=t,m(this.heap,this.weightFunc,0)),e},P.remove=function(e){for(var t=this.heap.length,r=0;t>r;r++)if(this.compareFunc(this.heap[r],e)){var n=this.heap[r],i=this.heap.pop();return r!==t-1&&(this.heap[r]=i,v(this.heap,this.weightFunc,r),m(this.heap,this.weightFunc,r)),n}return null},P.removeAll=function(){this.heap=[]},P.size=function(){return this.heap.length};var T=["beforeValidate","validate","afterValidate","beforeCreate","afterCreate","beforeUpdate","afterUpdate","beforeDestroy","afterDestroy"];M.setEqualityFn(y);var H={_:function(e,t){var r=this;if(t=t||{},t&&t.constructor===e.constructor)return t;if(!o(t))throw new C.IA('"options" must be an object!');D(T,function(e){"function"==typeof t[e]&&-1===t[e].toString().indexOf("var args = Array")&&(t[e]=r.promisify(t[e]))});var n=function(e){var t=this;I(e,function(e,r){t[r]=e})};return n.prototype=e,new n(t)},compute:function(e,t){var r=this,n=[];D(e.deps,function(e){n.push(r[e])}),r[t]=e[e.length-1].apply(r,n)},contains:e("mout/array/contains"),copy:b,deepMixIn:e("mout/object/deepMixIn"),diffObjectFromOldObject:M.diffObjectFromOldObject,DSBinaryHeap:g,equals:y,Events:h,filter:f,forEach:D,forOwn:I,fromJson:function(e){return i(e)?JSON.parse(e):e},intersection:l,isArray:N,isBoolean:n,isDate:s,isEmpty:u,isFunction:c,isObject:o,isNumber:a,isRegExp:r,isString:i,makePath:j,observe:M,pascalCase:e("mout/string/pascalCase"),pick:e("mout/object/pick"),Promise:x,promisify:function(e,t){var r=this.Promise;if(e){if("function"!=typeof e)throw new Error("Can only promisify functions!");return function(){var n=Array.prototype.slice.apply(arguments);return new r(function(r,i){n.push(function(e,t){e?i(e):r(t)});try{var o=e.apply(t||this,n);o&&o.then&&o.then(r,i)}catch(s){i(s)}})}}},remove:e("mout/array/remove"),set:e("mout/object/set"),slice:k,sort:e("mout/array/sort"),toJson:JSON.stringify,updateTimestamp:p,upperCase:e("mout/string/upperCase"),resolveItem:O,resolveId:w,w:_};t.exports=H},{"../lib/observe-js/observe-js":1,"./errors":46,bluebird:"bluebird","es6-promise":2,"mout/array/contains":4,"mout/array/forEach":5,"mout/array/remove":7,"mout/array/slice":8,"mout/array/sort":9,"mout/object/deepMixIn":12,"mout/object/forOwn":14,"mout/object/pick":17,"mout/object/set":18,"mout/string/pascalCase":21,"mout/string/upperCase":24}]},{},[47])(47)});