!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.JSData=e()}}(function(){var define,module,exports;return function e(t,r,n){function i(s,a){if(!r[s]){if(!t[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var u=r[s]={exports:{}};t[s][0].call(u.exports,function(e){var r=t[s][1][e];return i(r?r:e)},u,u.exports,e,t,r,n)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(require,module,exports){!function(global){"use strict";function detectObjectObserve(){function e(e){t=e}if("function"!=typeof Object.observe||"function"!=typeof Array.observe)return!1;var t=[],r={},n=[];return Object.observe(r,e),Array.observe(n,e),r.id=1,r.id=2,delete r.id,n.push(1,2),n.length=0,Object.deliverChangeRecords(e),5!==t.length?!1:"add"!=t[0].type||"update"!=t[1].type||"delete"!=t[2].type||"splice"!=t[3].type||"splice"!=t[4].type?!1:(Object.unobserve(r,e),Array.unobserve(n,e),!0)}function detectEval(){if("undefined"!=typeof chrome&&chrome.app&&chrome.app.runtime)return!1;try{var e=new Function("","return true;");return e()}catch(t){return!1}}function dirtyCheck(e){for(var t=0;MAX_DIRTY_CHECK_CYCLES>t&&e.check_();)t++;return global.testingExposeCycleCount&&(global.dirtyCheckCycleCount=t),t>0}function objectIsEmpty(e){for(var t in e)return!1;return!0}function diffIsEmpty(e){return objectIsEmpty(e.added)&&objectIsEmpty(e.removed)&&objectIsEmpty(e.changed)}function isBlacklisted(e,t){if(!t||!t.length)return!1;for(var r,n=0;n<t.length;n++)if("[object RegExp]"===Object.prototype.toString.call(t[n])&&t[n].test(e)||t[n]===e)return r=e;return!!r}function diffObjectFromOldObject(e,t,r,n){var i={},o={},s={};for(var a in t){var c=e[a];isBlacklisted(a,n)||void 0!==c&&(r?r(c,t[a]):c===t[a])||(a in e?(r?r(c,t[a]):c===t[a])||(s[a]=c):o[a]=void 0)}for(var a in e)a in t||isBlacklisted(a,n)||(i[a]=e[a]);return Array.isArray(e)&&e.length!==t.length&&(s.length=e.length),{added:i,removed:o,changed:s}}function runEOMTasks(){if(!eomTasks.length)return!1;for(var e=0;e<eomTasks.length;e++)eomTasks[e]();return eomTasks.length=0,!0}function newObservedObject(){function e(e){t&&t.state_===OPENED&&!n&&t.check_(e)}var t,r,n=!1,i=!0;return{open:function(r){if(t)throw Error("ObservedObject in use");i||Object.deliverChangeRecords(e),t=r,i=!1},observe:function(t,n){r=t,n?Array.observe(r,e):Object.observe(r,e)},deliver:function(t){n=t,Object.deliverChangeRecords(e),n=!1},close:function(){t=void 0,Object.unobserve(r,e),observedObjectCache.push(this)}}}function getObservedObject(e,t,r){var n=observedObjectCache.pop()||newObservedObject();return n.open(e),n.observe(t,r),n}function Observer(){this.state_=UNOPENED,this.callback_=void 0,this.target_=void 0,this.directObserver_=void 0,this.value_=void 0,this.id_=nextObserverId++}function addToAll(e){Observer._allObserversCount++,collectObservers&&allObservers.push(e)}function removeFromAll(){Observer._allObserversCount--}function ObjectObserver(e){Observer.call(this),this.value_=e,this.oldObject_=void 0}function diffObjectFromChangeRecords(e,t,r){for(var n={},i={},o=0;o<t.length;o++){var s=t[o];expectedRecordTypes[s.type]?(s.name in r||(r[s.name]=s.oldValue),"update"!=s.type&&("add"!=s.type?s.name in n?(delete n[s.name],delete r[s.name]):i[s.name]=!0:s.name in i?delete i[s.name]:n[s.name]=!0)):(console.error("Unknown changeRecord type: "+s.type),console.error(s))}for(var a in n)n[a]=e[a];for(var a in i)i[a]=void 0;var c={};for(var a in r)if(!(a in n||a in i)){var l=e[a];r[a]!==l&&(c[a]=l)}return{added:n,removed:i,changed:c}}var equalityFn=function(e,t){return e===t},blacklist=[],hasObserve=detectObjectObserve(),hasEval=detectEval(),createObject="__proto__"in{}?function(e){return e}:function(e){var t=e.__proto__;if(!t)return e;var r=Object.create(t);return Object.getOwnPropertyNames(e).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(e,t))}),r},MAX_DIRTY_CHECK_CYCLES=1e3,eomTasks=[],runEOM=hasObserve?function(){var e={pingPong:!0},t=!1;return Object.observe(e,function(){runEOMTasks(),t=!1}),function(r){eomTasks.push(r),t||(t=!0,e.pingPong=!e.pingPong)}}():function(){return function(e){eomTasks.push(e)}}(),observedObjectCache=[],UNOPENED=0,OPENED=1,CLOSED=2,nextObserverId=1;Observer.prototype={open:function(e,t){if(this.state_!=UNOPENED)throw Error("Observer has already been opened.");return addToAll(this),this.callback_=e,this.target_=t,this.connect_(),this.state_=OPENED,this.value_},close:function(){this.state_==OPENED&&(removeFromAll(this),this.disconnect_(),this.value_=void 0,this.callback_=void 0,this.target_=void 0,this.state_=CLOSED)},deliver:function(){this.state_==OPENED&&dirtyCheck(this)},report_:function(e){try{this.callback_.apply(this.target_,e)}catch(t){Observer._errorThrownDuringCallback=!0,console.error("Exception caught during observer callback: "+(t.stack||t))}},discardChanges:function(){return this.check_(void 0,!0),this.value_}};var collectObservers=!hasObserve,allObservers;Observer._allObserversCount=0,collectObservers&&(allObservers=[]);var runningMicrotaskCheckpoint=!1,hasDebugForceFullDelivery=hasObserve&&hasEval&&function(){try{return eval("%RunMicrotasks()"),!0}catch(ex){return!1}}();global.Platform=global.Platform||{},global.Platform.performMicrotaskCheckpoint=function(){if(!runningMicrotaskCheckpoint){if(hasDebugForceFullDelivery)return void eval("%RunMicrotasks()");if(collectObservers){runningMicrotaskCheckpoint=!0;var cycles=0,anyChanged,toCheck;do{cycles++,toCheck=allObservers,allObservers=[],anyChanged=!1;for(var i=0;i<toCheck.length;i++){var observer=toCheck[i];observer.state_==OPENED&&(observer.check_()&&(anyChanged=!0),allObservers.push(observer))}runEOMTasks()&&(anyChanged=!0)}while(MAX_DIRTY_CHECK_CYCLES>cycles&&anyChanged);global.testingExposeCycleCount&&(global.dirtyCheckCycleCount=cycles),runningMicrotaskCheckpoint=!1}}},collectObservers&&(global.Platform.clearObservers=function(){allObservers=[]}),ObjectObserver.prototype=createObject({__proto__:Observer.prototype,arrayObserve:!1,connect_:function(){hasObserve?this.directObserver_=getObservedObject(this,this.value_,this.arrayObserve):this.oldObject_=this.copyObject(this.value_)},copyObject:function(e){var t=Array.isArray(e)?[]:{};for(var r in e)t[r]=e[r];return Array.isArray(e)&&(t.length=e.length),t},check_:function(e){var t,r;if(hasObserve){if(!e)return!1;r={},t=diffObjectFromChangeRecords(this.value_,e,r)}else r=this.oldObject_,t=diffObjectFromOldObject(this.value_,this.oldObject_);return diffIsEmpty(t)?!1:(hasObserve||(this.oldObject_=this.copyObject(this.value_)),this.report_([t.added||{},t.removed||{},t.changed||{},function(e){return r[e]}]),!0)},disconnect_:function(){hasObserve?(this.directObserver_.close(),this.directObserver_=void 0):this.oldObject_=void 0},deliver:function(){this.state_==OPENED&&(hasObserve?this.directObserver_.deliver(!1):dirtyCheck(this))},discardChanges:function(){return this.directObserver_?this.directObserver_.deliver(!0):this.oldObject_=this.copyObject(this.value_),this.value_}});var observerSentinel={},expectedRecordTypes={add:!0,update:!0,"delete":!0};global.Observer=Observer,global.diffObjectFromOldObject=diffObjectFromOldObject,global.setEqualityFn=function(e){equalityFn=e},global.setBlacklist=function(e){blacklist=e},global.Observer.runEOM_=runEOM,global.Observer.observerSentinel_=observerSentinel,global.Observer.hasObjectObserve=hasObserve,global.ObjectObserver=ObjectObserver}(exports)},{}],2:[function(e,t){(function(e,r){(function(){"use strict";function n(e){return"function"==typeof e||"object"==typeof e&&null!==e}function i(e){return"function"==typeof e}function o(e){return"object"==typeof e&&null!==e}function s(){}function a(){return function(){e.nextTick(f)}}function c(){var e=0,t=new K(f),r=document.createTextNode("");return t.observe(r,{characterData:!0}),function(){r.data=e=++e%2}}function l(){var e=new MessageChannel;return e.port1.onmessage=f,function(){e.port2.postMessage(0)}}function u(){return function(){setTimeout(f,1)}}function f(){for(var e=0;T>e;e+=2){var t=L[e],r=L[e+1];t(r),L[e]=void 0,L[e+1]=void 0}T=0}function d(){}function p(){return new TypeError("You cannot resolve a promise with itself")}function h(){return new TypeError("A promises callback cannot return that same promise.")}function v(e){try{return e.then}catch(t){return Y.error=t,Y}}function g(e,t,r,n){try{e.call(t,r,n)}catch(i){return i}}function y(e,t,r){N(function(e){var n=!1,i=g(r,t,function(r){n||(n=!0,t!==r?_(e,r):E(e,r))},function(t){n||(n=!0,O(e,t))},"Settle: "+(e._label||" unknown promise"));!n&&i&&(n=!0,O(e,i))},e)}function m(e,t){t._state===q?E(e,t._result):e._state===V?O(e,t._result):A(t,void 0,function(t){_(e,t)},function(t){O(e,t)})}function b(e,t){if(t.constructor===e.constructor)m(e,t);else{var r=v(t);r===Y?O(e,Y.error):void 0===r?E(e,t):i(r)?y(e,t,r):E(e,t)}}function _(e,t){e===t?O(e,p()):n(t)?b(e,t):E(e,t)}function w(e){e._onerror&&e._onerror(e._result),j(e)}function E(e,t){e._state===B&&(e._result=t,e._state=q,0===e._subscribers.length||N(j,e))}function O(e,t){e._state===B&&(e._state=V,e._result=t,N(w,e))}function A(e,t,r,n){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+q]=r,i[o+V]=n,0===o&&e._state&&N(j,e)}function j(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n,i,o=e._result,s=0;s<t.length;s+=3)n=t[s],i=t[s+r],n?S(r,n,i,o):i(o);e._subscribers.length=0}}function x(){this.error=null}function D(e,t){try{return e(t)}catch(r){return W.error=r,W}}function S(e,t,r,n){var o,s,a,c,l=i(r);if(l){if(o=D(r,n),o===W?(c=!0,s=o.error,o=null):a=!0,t===o)return void O(t,h())}else o=n,a=!0;t._state!==B||(l&&a?_(t,o):c?O(t,s):e===q?E(t,o):e===V&&O(t,o))}function F(e,t){try{t(function(t){_(e,t)},function(t){O(e,t)})}catch(r){O(e,r)}}function C(e,t,r,n){this._instanceConstructor=e,this.promise=new e(d,n),this._abortOnReject=r,this._validateInput(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._init(),0===this.length?E(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&E(this.promise,this._result))):O(this.promise,this._validationError())}function k(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function I(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function R(e){this._id=G++,this._state=void 0,this._result=void 0,this._subscribers=[],d!==e&&(i(e)||k(),this instanceof R||I(),F(this,e))}var P;P=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var M,U=P,T=(Date.now||function(){return(new Date).getTime()},Object.create||function(e){if(arguments.length>1)throw new Error("Second argument not supported");if("object"!=typeof e)throw new TypeError("Argument must be an object");return s.prototype=e,new s},0),N=function(e,t){L[T]=e,L[T+1]=t,T+=2,2===T&&M()},H="undefined"!=typeof window?window:{},K=H.MutationObserver||H.WebKitMutationObserver,Q="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,L=new Array(1e3);M="undefined"!=typeof e&&"[object process]"==={}.toString.call(e)?a():K?c():Q?l():u();var B=void 0,q=1,V=2,Y=new x,W=new x;C.prototype._validateInput=function(e){return U(e)},C.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},C.prototype._init=function(){this._result=new Array(this.length)};var $=C;C.prototype._enumerate=function(){for(var e=this.length,t=this.promise,r=this._input,n=0;t._state===B&&e>n;n++)this._eachEntry(r[n],n)},C.prototype._eachEntry=function(e,t){var r=this._instanceConstructor;o(e)?e.constructor===r&&e._state!==B?(e._onerror=null,this._settledAt(e._state,t,e._result)):this._willSettleAt(r.resolve(e),t):(this._remaining--,this._result[t]=this._makeResult(q,t,e))},C.prototype._settledAt=function(e,t,r){var n=this.promise;n._state===B&&(this._remaining--,this._abortOnReject&&e===V?O(n,r):this._result[t]=this._makeResult(e,t,r)),0===this._remaining&&E(n,this._result)},C.prototype._makeResult=function(e,t,r){return r},C.prototype._willSettleAt=function(e,t){var r=this;A(e,void 0,function(e){r._settledAt(q,t,e)},function(e){r._settledAt(V,t,e)})};var J=function(e,t){return new $(this,e,!0,t).promise},z=function(e,t){function r(e){_(o,e)}function n(e){O(o,e)}var i=this,o=new i(d,t);if(!U(e))return O(o,new TypeError("You must pass an array to race.")),o;for(var s=e.length,a=0;o._state===B&&s>a;a++)A(i.resolve(e[a]),void 0,r,n);return o},X=function(e,t){var r=this;if(e&&"object"==typeof e&&e.constructor===r)return e;var n=new r(d,t);return _(n,e),n},Z=function(e,t){var r=this,n=new r(d,t);return O(n,e),n},G=0,et=R;R.all=J,R.race=z,R.resolve=X,R.reject=Z,R.prototype={constructor:R,then:function(e,t){var r=this,n=r._state;if(n===q&&!e||n===V&&!t)return this;var i=new this.constructor(d),o=r._result;if(n){var s=arguments[n-1];N(function(){S(n,i,s,o)})}else A(r,i,e,t);return i},"catch":function(e){return this.then(null,e)}};var tt=function(){var e;e="undefined"!=typeof r?r:"undefined"!=typeof window&&window.document?window:self;var t="Promise"in e&&"resolve"in e.Promise&&"reject"in e.Promise&&"all"in e.Promise&&"race"in e.Promise&&function(){var t;return new e.Promise(function(e){t=e}),i(t)}();t||(e.Promise=et)},rt={Promise:et,polyfill:tt};"function"==typeof define&&define.amd?define(function(){return rt}):"undefined"!=typeof t&&t.exports?t.exports=rt:"undefined"!=typeof this&&(this.ES6Promise=rt)}).call(this)}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:3}],3:[function(e,t){function r(){if(!s){s=!0;for(var e,t=o.length;t;){e=o,o=[];for(var r=-1;++r<t;)e[r]();t=o.length}s=!1}}function n(){}var i=t.exports={},o=[],s=!1;i.nextTick=function(e){o.push(e),s||setTimeout(r,0)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.on=n,i.addListener=n,i.once=n,i.off=n,i.removeListener=n,i.removeAllListeners=n,i.emit=n,i.binding=function(){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],4:[function(e,t){function r(e,t){return-1!==n(e,t)}var n=e("./indexOf");t.exports=r},{"./indexOf":6}],5:[function(e,t){function r(e,t,r){if(null!=e)for(var n=-1,i=e.length;++n<i&&t.call(r,e[n],n,e)!==!1;);}t.exports=r},{}],6:[function(e,t){function r(e,t,r){if(r=r||0,null==e)return-1;for(var n=e.length,i=0>r?n+r:r;n>i;){if(e[i]===t)return i;i++}return-1}t.exports=r},{}],7:[function(e,t){function r(e,t){var r=n(e,t);-1!==r&&e.splice(r,1)}var n=e("./indexOf");t.exports=r},{"./indexOf":6}],8:[function(e,t){function r(e,t,r){var n=e.length;t=null==t?0:0>t?Math.max(n+t,0):Math.min(t,n),r=null==r?n:0>r?Math.max(n+r,0):Math.min(r,n);for(var i=[];r>t;)i.push(e[t++]);return i}t.exports=r},{}],9:[function(e,t){function r(e,t){if(null==e)return[];if(e.length<2)return e;null==t&&(t=n);var o,s,a;return o=~~(e.length/2),s=r(e.slice(0,o),t),a=r(e.slice(o,e.length),t),i(s,a,t)}function n(e,t){return t>e?-1:e>t?1:0}function i(e,t,r){for(var n=[];e.length&&t.length;)n.push(r(e[0],t[0])<=0?e.shift():t.shift());return e.length&&n.push.apply(n,e),t.length&&n.push.apply(n,t),n}t.exports=r},{}],10:[function(e,t){function r(e){return!!e&&"object"==typeof e&&e.constructor===Object}t.exports=r},{}],11:[function(e,t){function r(e){switch(typeof e){case"string":case"number":case"boolean":return!0}return null==e}t.exports=r},{}],12:[function(e,t){function r(e){return null==e?"":e.toString()}t.exports=r},{}],13:[function(e,t){function r(e){for(var t,r=0,o=arguments.length;++r<o;)t=arguments[r],t&&i(t,n,e);return e}function n(e,t){var n=this[t];o(e)&&o(n)?r(n,e):this[t]=e}var i=e("./forOwn"),o=e("../lang/isPlainObject");t.exports=r},{"../lang/isPlainObject":10,"./forOwn":15}],14:[function(e,t){function r(){s=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],o=!0;for(var e in{toString:null})o=!1}function n(e,t,n){var c,l=0;null==o&&r();for(c in e)if(i(t,e,c,n)===!1)break;if(o)for(var u=e.constructor,f=!!u&&e===u.prototype;(c=s[l++])&&("constructor"===c&&(f||!a(e,c))||e[c]===Object.prototype[c]||i(t,e,c,n)!==!1););}function i(e,t,r,n){return e.call(n,t[r],r,t)}var o,s,a=e("./hasOwn");t.exports=n},{"./hasOwn":17}],15:[function(e,t){function r(e,t,r){i(e,function(i,o){return n(e,o)?t.call(r,e[o],o,e):void 0})}var n=e("./hasOwn"),i=e("./forIn");t.exports=r},{"./forIn":14,"./hasOwn":17}],16:[function(e,t){function r(e,t){for(var r=t.split("."),n=r.pop();t=r.shift();)if(e=e[t],null==e)return;return e[n]}e("../lang/isPrimitive");t.exports=r},{"../lang/isPrimitive":11}],17:[function(e,t){function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=r},{}],18:[function(e,t){function r(e,t){return t?(n(t.split("."),function(t){e[t]||(e[t]={}),e=e[t]}),e):e}var n=e("../array/forEach");t.exports=r},{"../array/forEach":5}],19:[function(e,t){function r(e){for(var t,r="string"!=typeof arguments[1]?arguments[1]:n(arguments,1),i={},o=0;t=r[o++];)i[t]=e[t];return i}var n=e("../array/slice");t.exports=r},{"../array/slice":8}],20:[function(e,t){function r(e,t,r){var i=/^(.+)\.(.+)$/.exec(t);i?n(e,i[1])[i[2]]=r:e[t]=r}var n=e("./namespace");t.exports=r},{"./namespace":18}],21:[function(e,t){function r(e){return e=n(e),e=i(e),e=o(e).replace(/[\-_]/g," ").replace(/\s[a-z]/g,s).replace(/\s+/g,"").replace(/^[A-Z]/g,a)}var n=e("../lang/toString"),i=e("./replaceAccents"),o=e("./removeNonWord"),s=e("./upperCase"),a=e("./lowerCase");t.exports=r},{"../lang/toString":12,"./lowerCase":22,"./removeNonWord":24,"./replaceAccents":25,"./upperCase":26}],22:[function(e,t){function r(e){return e=n(e),e.toLowerCase()}var n=e("../lang/toString");t.exports=r},{"../lang/toString":12}],23:[function(e,t){function r(e){return e=n(e),i(e).replace(/^[a-z]/,o)}var n=e("../lang/toString"),i=e("./camelCase"),o=e("./upperCase");t.exports=r},{"../lang/toString":12,"./camelCase":21,"./upperCase":26}],24:[function(e,t){function r(e){return e=n(e),e.replace(i,"")}var n=e("../lang/toString"),i=/[^\x20\x2D0-9A-Z\x5Fa-z\xC0-\xD6\xD8-\xF6\xF8-\xFF]/g;t.exports=r},{"../lang/toString":12}],25:[function(e,t){function r(e){return e=n(e),e.search(/[\xC0-\xFF]/g)>-1&&(e=e.replace(/[\xC0-\xC5]/g,"A").replace(/[\xC6]/g,"AE").replace(/[\xC7]/g,"C").replace(/[\xC8-\xCB]/g,"E").replace(/[\xCC-\xCF]/g,"I").replace(/[\xD0]/g,"D").replace(/[\xD1]/g,"N").replace(/[\xD2-\xD6\xD8]/g,"O").replace(/[\xD9-\xDC]/g,"U").replace(/[\xDD]/g,"Y").replace(/[\xDE]/g,"P").replace(/[\xE0-\xE5]/g,"a").replace(/[\xE6]/g,"ae").replace(/[\xE7]/g,"c").replace(/[\xE8-\xEB]/g,"e").replace(/[\xEC-\xEF]/g,"i").replace(/[\xF1]/g,"n").replace(/[\xF2-\xF6\xF8]/g,"o").replace(/[\xF9-\xFC]/g,"u").replace(/[\xFE]/g,"p").replace(/[\xFD\xFF]/g,"y")),e}var n=e("../lang/toString");t.exports=r},{"../lang/toString":12}],26:[function(e,t){function r(e){return e=n(e),e.toUpperCase()}var n=e("../lang/toString");t.exports=r},{"../lang/toString":12}],27:[function(e,t){function r(e,t,r){var o=this,s=o.defs[e];r=r||{},t=t||{};var a;if(s)if(n._o(t)){if(r=n._(s,r),r.upsert&&n._sn(t[s.idAttribute]))return o.update(e,t[s.idAttribute],t,r);r.logFn("create",t,r)}else a=n._oErr("attrs");else a=new i.NER(e);return new n.Promise(function(e,r){a?r(a):e(t)}).then(function(e){return r.beforeValidate.call(e,r,e)}).then(function(e){return r.validate.call(e,r,e)}).then(function(e){return r.afterValidate.call(e,r,e)}).then(function(e){return r.beforeCreate.call(e,r,e)}).then(function(e){return r.notify&&s.emit("DS.beforeCreate",s,e),o.getAdapter(r).create(s,e,r)}).then(function(e){return r.afterCreate.call(e,r,e)}).then(function(t){if(r.notify&&s.emit("DS.afterCreate",s,t),r.cacheResponse){var i=o.inject(s.n,t,r),a=i[s.idAttribute],c=o.s[e];return c.completedQueries[a]=(new Date).getTime(),c.saved[a]=n.updateTimestamp(c.saved[a]),i}return o.createInstance(e,t,r)})}var n=e("../../utils"),i=e("../../errors");t.exports=r},{"../../errors":48,"../../utils":50}],28:[function(e,t){function r(e,t,r){var o,s=this,a=s.defs[e];return new n.Promise(function(c,l){t=n.resolveId(a,t),a?n._sn(t)?(o=s.get(e,t)||{id:t},r=n._(a,r),r.logFn("destroy",t,r),c(o)):l(n._snErr("id")):l(new i.NER(e))}).then(function(e){return r.beforeDestroy.call(e,r,e)}).then(function(n){return r.notify&&a.emit("DS.beforeDestroy",a,n),r.eagerEject&&s.eject(e,t),s.getAdapter(r).destroy(a,t,r)}).then(function(){return r.afterDestroy.call(o,r,o)}).then(function(n){return r.notify&&a.emit("DS.afterDestroy",a,n),s.eject(e,t),t})["catch"](function(t){throw r&&r.eagerEject&&o&&s.inject(e,o,{notify:!1}),t})}var n=e("../../utils"),i=e("../../errors");t.exports=r},{"../../errors":48,"../../utils":50}],29:[function(e,t){function r(e,t,r){var o,s,a=this,c=a.defs[e];return t=t||{},new n.Promise(function(o,s){c?n._o(t)?(r=n._(c,r),r.logFn("destroyAll",t,r),o()):s(n._oErr("attrs")):s(new i.NER(e))}).then(function(){return s=a.defaults.defaultFilter.call(a,e,t),r.beforeDestroy(r,s)}).then(function(){return r.notify&&c.emit("DS.beforeDestroy",c,s),r.eagerEject&&(o=a.ejectAll(e,t)),a.getAdapter(r).destroyAll(c,t,r)}).then(function(){return r.afterDestroy(r,s)}).then(function(){return r.notify&&c.emit("DS.afterDestroy",c,s),o||a.ejectAll(e,t)})["catch"](function(t){throw r&&r.eagerEject&&o&&a.inject(e,o,{notify:!1}),t})}var n=e("../../utils"),i=e("../../errors");t.exports=r},{"../../errors":48,"../../utils":50}],30:[function(e,t){function r(e,t,r){var o=this,s=o.defs[e],a=o.s[e];return new n.Promise(function(c,l){s?n._sn(t)?(r=n._(s,r),r.logFn("find",t,r),r.params&&(r.params=n.copy(r.params)),(r.bypassCache||!r.cacheResponse)&&delete a.completedQueries[t],t in a.completedQueries&&o.get(e,t)?c(o.get(e,t)):(delete a.completedQueries[t],c())):l(n._snErr("id")):l(new i.NER(e))}).then(function(i){function c(e){return o.getAdapter((r.findFallbackAdapters||r.fallbackAdapters)[e]).find(s,t,r)["catch"](function(t){return e++,e<r.fallbackAdapters.length?c(e):Promise.reject(t)})}if(i)return i;if(!(t in a.pendingQueries)){var l,u=r.findStrategy||r.strategy;l="fallback"===u?c(0):o.getAdapter(r).find(s,t,r),a.pendingQueries[t]=l.then(function(i){if(delete a.pendingQueries[t],r.cacheResponse){var s=o.inject(e,i,r);return a.completedQueries[t]=(new Date).getTime(),a.saved[t]=n.updateTimestamp(a.saved[t]),s}return o.createInstance(e,i,r)})}return a.pendingQueries[t]})["catch"](function(e){throw a&&delete a.pendingQueries[t],e})}var n=e("../../utils"),i=e("../../errors");t.exports=r},{"../../errors":48,"../../utils":50}],31:[function(e,t){function r(e,t,r,n){var o=this,s=o.s[t],a=o.defs[t].idAttribute,c=(new Date).getTime();e=e||[],delete s.pendingQueries[r],s.completedQueries[r]=c,s.collectionModified=i.updateTimestamp(s.collectionModified);var l=o.inject(t,e,n);return i._a(l)?i.forEach(l,function(e){if(e){var t=e[a];t&&(s.completedQueries[t]=c,s.saved[t]=i.updateTimestamp(s.saved[t]))}}):(n.errorFn("response is expected to be an array!"),s.completedQueries[l[a]]=c),l}function n(e,t,n){var s,a=this,c=a.defs[e],l=a.s[e];return new i.Promise(function(r,u){t=t||{},a.defs[e]?i._o(t)?(n=i._(c,n),s=i.toJson(t),n.logFn("findAll",t,n),n.params&&(n.params=i.copy(n.params)),(n.bypassCache||!n.cacheResponse)&&(delete l.completedQueries[s],delete l.queryData[s]),s in l.completedQueries?r(n.useFilter?a.filter(e,t,n):l.queryData[s]):r()):u(i._oErr("params")):u(new o.NER(e))}).then(function(o){function u(e){return a.getAdapter((n.findAllFallbackAdapters||n.fallbackAdapters)[e]).findAll(c,t,n)["catch"](function(t){return e++,e<n.fallbackAdapters.length?u(e):Promise.reject(t)})}if(s in l.completedQueries)return o;if(!(s in l.pendingQueries)){var f,d=n.findAllStrategy||n.strategy;f="fallback"===d?u(0):a.getAdapter(n).findAll(c,t,n),l.pendingQueries[s]=f.then(function(t){return delete l.pendingQueries[s],n.cacheResponse?(l.queryData[s]=r.call(a,t,e,s,n),l.queryData[s].$$injected=!0,l.queryData[s]):(i.forEach(t,function(r,i){t[i]=a.createInstance(e,r,n)}),t)})}return l.pendingQueries[s]})["catch"](function(e){throw l&&delete l.pendingQueries[s],e})}var i=e("../../utils"),o=e("../../errors");t.exports=n},{"../../errors":48,"../../utils":50}],32:[function(e,t){function r(e,t){var r=this,n=r.defs[e],o=r.s[e];return new i.Promise(function(s,a){if(n){t=i._(n,t),t.hasOwnProperty("notify")||(t.notify=!1),t.logFn("reap",t);for(var c,l=[],u=(new Date).getTime();(c=o.expiresHeap.peek())&&c.expires<u;)l.push(c.item),delete c.item,o.expiresHeap.pop();s(l)}else a(new r.errors.NER(e))}).then(function(s){if((t.isInterval||t.notify)&&(n.beforeReap(t,s),n.emit("DS.beforeReap",n,s)),"inject"===t.reapAction){var a=(new Date).getTime();i.forEach(s,function(e){e[n.idAttribute];o.expiresHeap.push({item:e,timestamp:a,expires:n.maxAge?a+n.maxAge:Number.MAX_VALUE})})}else if("eject"===t.reapAction)i.forEach(s,function(t){r.eject(e,t[n.idAttribute])});else if("refresh"===t.reapAction){var c=[];return i.forEach(s,function(t){c.push(r.refresh(e,t[n.idAttribute]))}),i.Promise.all(c)}return s}).then(function(e){return(t.isInterval||t.notify)&&(n.afterReap(t,e),n.emit("DS.afterReap",n,e)),e})}function n(e,t,r){var n=this;return new i.Promise(function(o,s){var a=n.defs[e];t=i.resolveId(n.defs[e],t),a?i._sn(t)?(r=i._(a,r),r.bypassCache=!0,r.logFn("refresh",t,r),o(n.get(e,t))):s(i._snErr("id")):s(new n.errors.NER(e))}).then(function(i){return i?n.find(e,t,r):i})}{var i=e("../../utils");e("../../errors")}t.exports={create:e("./create"),destroy:e("./destroy"),destroyAll:e("./destroyAll"),find:e("./find"),findAll:e("./findAll"),loadRelations:e("./loadRelations"),reap:r,refresh:n,save:e("./save"),update:e("./update"),updateAll:e("./updateAll")}},{"../../errors":48,"../../utils":50,"./create":27,"./destroy":28,"./destroyAll":29,"./find":30,"./findAll":31,"./loadRelations":33,"./save":34,"./update":35,"./updateAll":36}],33:[function(e,t){function r(e,t,r,o){var s=this,a=s.defs[e],c=[];return new n.Promise(function(l,u){if(n._sn(t)&&(t=s.get(e,t)),n._s(r)&&(r=[r]),a)if(n._o(t))if(n._a(r)){var f=n._(a,o);f.hasOwnProperty("findBelongsTo")||(f.findBelongsTo=!0),f.hasOwnProperty("findHasMany")||(f.findHasMany=!0),f.logFn("loadRelations",t,r,f);var d=[];n.forEach(a.relationList,function(e){var i=e.relation,l=a.getResource(i),u=n._(l,o);if(n.contains(r,i)||n.contains(r,e.localField)){var f,p={};u.allowSimpleWhere?p[e.foreignKey]=t[a.idAttribute]:(p.where={},p.where[e.foreignKey]={"==":t[a.idAttribute]}),"hasMany"===e.type&&p[e.foreignKey]?f=s.findAll(i,p,u):"hasOne"===e.type?e.localKey&&t[e.localKey]?f=s.find(i,t[e.localKey],u):e.foreignKey&&p[e.foreignKey]&&(f=s.findAll(i,p,u).then(function(e){return e.length?e[0]:null})):t[e.localKey]&&(f=s.find(i,t[e.localKey],o)),f&&(d.push(f),c.push(e.localField))}}),l(d)}else u(new i.IA('"relations" must be a string or an array!'));else u(new i.IA('"instance(id)" must be a string, number or object!'));else u(new i.NER(e))}).then(function(e){return n.Promise.all(e)}).then(function(e){return n.forEach(c,function(r,n){t[r]=e[n]}),t})}var n=e("../../utils"),i=e("../../errors");t.exports=r},{"../../errors":48,"../../utils":50}],34:[function(e,t){function r(e,t,r){var o,s=this,a=s.defs[e];return new n.Promise(function(c,l){t=n.resolveId(a,t),a?n._sn(t)?s.get(e,t)?(o=s.get(e,t),r=n._(a,r),r.logFn("save",t,r),c(o)):l(new i.R('id "'+t+'" not found in cache!')):l(n._snErr("id")):l(new i.NER(e))}).then(function(e){return r.beforeValidate.call(e,r,e)}).then(function(e){return r.validate.call(e,r,e)}).then(function(e){return r.afterValidate.call(e,r,e)}).then(function(e){return r.beforeUpdate.call(e,r,e)}).then(function(i){if(r.notify&&a.emit("DS.beforeUpdate",a,i),r.changesOnly){var o=s.s[e];n.w&&o.observers[t].deliver();var c=[],l=s.changes(e,t);for(var u in l.added)c.push(u);for(u in l.changed)c.push(u);if(l=n.pick(i,c),n.isEmpty(l))return i;i=l}return s.getAdapter(r).update(a,t,i,r)}).then(function(e){return r.afterUpdate.call(e,r,e)}).then(function(t){if(r.notify&&a.emit("DS.afterUpdate",a,t),r.cacheResponse){var i=s.inject(a.n,t,r),o=s.s[e].saved;return o[i[a.idAttribute]]=n.updateTimestamp(o[i[a.idAttribute]]),i}return s.createInstance(e,t,r)})}var n=e("../../utils"),i=e("../../errors");t.exports=r},{"../../errors":48,"../../utils":50}],35:[function(e,t){function r(e,t,r,o){var s=this,a=s.defs[e];return new n.Promise(function(s,c){t=n.resolveId(a,t),a?n._sn(t)?(o=n._(a,o),o.logFn("update",t,r,o),s(r)):c(n._snErr("id")):c(new i.NER(e))}).then(function(e){return o.beforeValidate.call(e,o,e)}).then(function(e){return o.validate.call(e,o,e)}).then(function(e){return o.afterValidate.call(e,o,e)}).then(function(e){return o.beforeUpdate.call(e,o,e)}).then(function(e){return o.notify&&a.emit("DS.beforeUpdate",a,e),s.getAdapter(o).update(a,t,e,o)}).then(function(e){return o.afterUpdate.call(e,o,e)}).then(function(t){if(o.notify&&a.emit("DS.afterUpdate",a,t),o.cacheResponse){var r=s.inject(a.n,t,o),i=s.s[e].saved;return i[r[a.idAttribute]]=n.updateTimestamp(i[r[a.idAttribute]]),r}return s.createInstance(e,t,o)})}var n=e("../../utils"),i=e("../../errors");t.exports=r},{"../../errors":48,"../../utils":50}],36:[function(e,t){function r(e,t,r,o){var s=this,a=s.defs[e];return new n.Promise(function(s,c){a?(o=n._(a,o),o.logFn("updateAll",t,r,o),s(t)):c(new i.NER(e))}).then(function(e){return o.beforeValidate.call(e,o,e)}).then(function(e){return o.validate.call(e,o,e)}).then(function(e){return o.afterValidate.call(e,o,e)}).then(function(e){return o.beforeUpdate.call(e,o,e)}).then(function(e){return o.notify&&a.emit("DS.beforeUpdate",a,e),s.getAdapter(o).updateAll(a,e,r,o)}).then(function(e){return o.afterUpdate.call(e,o,e)}).then(function(r){if(o.notify&&a.emit("DS.afterUpdate",a,t),o.cacheResponse){var i=s.inject(a.n,r,o),c=s.s[e].saved;return n.forEach(i,function(e){c[e[a.idAttribute]]=n.updateTimestamp(c[e[a.idAttribute]])}),i}var l=[];return n.forEach(r,function(t){l.push(s.createInstance(e,t,o))}),l})}var n=e("../../utils"),i=e("../../errors");t.exports=r},{"../../errors":48,"../../utils":50}],37:[function(e,t){function r(e,t,r){r(null,t)}function n(e,t){return t}function i(e,t,r,n){var o=e[t],s=c.get(r,o[0]),a=c.get(n,o[0]);return c._s(s)&&(s=c.upperCase(s)),c._s(a)&&(a=c.upperCase(a)),"DESC"===o[1]?s>a?-1:a>s?1:t<e.length-1?i(e,t+1,r,n):0:a>s?-1:s>a?1:t<e.length-1?i(e,t+1,r,n):0}function o(){}function s(t){var r=this;t=t||{};try{a=e("js-data-schema")}catch(n){}if(!a||c.isEmpty(a))try{a=window.Schemator}catch(n){}(a||t.schemator)&&(r.schemator=t.schemator||new a),r.store={},r.s=r.store,r.definitions={},r.defs=r.definitions,r.adapters={},r.defaults=new o,r.observe=c.observe,c.forOwn(t,function(e,t){r.defaults[t]=e}),r.defaults.logFn("new data store created",r.defaults)}var a,c=e("../utils"),l=e("../errors"),u=e("./sync_methods"),f=e("./async_methods"),d=o.prototype;d.actions={},d.afterCreate=r,d.afterCreateInstance=n,d.afterDestroy=r,d.afterEject=n,d.afterInject=n,d.afterReap=n,d.afterUpdate=r,d.afterValidate=r,d.allowSimpleWhere=!0,d.basePath="",d.beforeCreate=r,d.beforeCreateInstance=n,d.beforeDestroy=r,d.beforeEject=n,d.beforeInject=n,d.beforeReap=n,d.beforeUpdate=r,d.beforeValidate=r,d.bypassCache=!1,d.cacheResponse=!!c.w,d.defaultAdapter="http",d.debug=!0,d.eagerEject=!1,d.eagerInject=!1,d.endpoint="",d.error=console?function(e,t,r){console["function"==typeof console.error?"error":"log"](e,t,r)}:!1,d.errorFn=function(e,t){if(this.error&&"function"==typeof this.error){try{throw"string"==typeof e?new Error(e):e}catch(r){e=r}this.error(this.name||null,e||null,t||null)
}},d.fallbackAdapters=["http"],d.findBelongsTo=!0,d.findHasOne=!0,d.findHasMany=!0,d.findInverseLinks=!0,d.idAttribute="id",d.ignoredChanges=[/\$/],d.ignoreMissing=!1,d.keepChangeHistory=!1,d.loadFromServer=!1,d.log=console?function(e,t,r,n,i){console["function"==typeof console.info?"info":"log"](e,t,r,n,i)}:!1,d.logFn=function(e,t,r,n){this.debug&&this.log&&"function"==typeof this.log&&this.log(this.name||null,e||null,t||null,r||null,n||null)},d.maxAge=!1,d.notify=!!c.w,d.reapAction=c.w?"inject":"none",d.reapInterval=c.w?3e4:!1,d.resetHistoryOnInject=!0,d.strategy="single",d.upsert=!!c.w,d.useClass=!0,d.useFilter=!1,d.validate=r,d.defaultFilter=function(e,t,r,n){var o=e,s=null,a={skip:"",offset:"",where:"",limit:"",orderBy:"",sort:""};r=r||{},n=n||{},s=c._o(r.where)?r.where:{},n.allowSimpleWhere&&c.forOwn(r,function(e,t){t in a||t in s||(s[t]={"==":e})}),c.isEmpty(s)&&(s=null),s&&(o=c.filter(o,function(e){var t=!0,r=!0;return c.forOwn(s,function(n,i){c._s(n)?n={"===":n}:(c._n(n)||c.isBoolean(n))&&(n={"==":n}),c._o(n)&&c.forOwn(n,function(n,o){var s,a="|"===o[0],l=e[i];o=a?o.substr(1):o,"=="===o?s=l==n:"==="===o?s=l===n:"!="===o?s=l!=n:"!=="===o?s=l!==n:">"===o?s=l>n:">="===o?s=l>=n:"<"===o?s=n>l:"<="===o?s=n>=l:"isectEmpty"===o?s=!c.intersection(l||[],n||[]).length:"isectNotEmpty"===o?s=c.intersection(l||[],n||[]).length:"in"===o?s=c._s(n)?-1!==n.indexOf(l):c.contains(n,l):"notIn"===o?s=c._s(n)?-1===n.indexOf(l):!c.contains(n,l):"contains"===o?s=c._s(l)?-1!==l.indexOf(n):c.contains(l,n):"notContains"===o&&(s=c._s(l)?-1===l.indexOf(n):!c.contains(l,n)),void 0!==s&&(r=t?s:a?r||s:r&&s),t=!1})}),r}));var u=null;if(c._s(r.orderBy)?u=[[r.orderBy,"ASC"]]:c._a(r.orderBy)&&(u=r.orderBy),!u&&c._s(r.sort)?u=[[r.sort,"ASC"]]:!u&&c._a(r.sort)&&(u=r.sort),u){var f=0;c.forEach(u,function(e,t){if(c._s(e))u[t]=[e,"ASC"];else if(!c._a(e))throw new l.IA("DS.filter(resourceName[, params][, options]): "+c.toJson(e)+": Must be a string or an array!",{params:{"orderBy[i]":{actual:typeof e,expected:"string|array"}}})}),o=c.sort(o,function(e,t){return i(u,f,e,t)})}var d=c._n(r.limit)?r.limit:null,p=null;return c._n(r.skip)?p=r.skip:c._n(r.offset)&&(p=r.offset),d&&p?o=c.slice(o,p,Math.min(o.length,p+d)):c._n(d)?o=c.slice(o,0,Math.min(o.length,d)):c._n(p)&&(o=p<o.length?c.slice(o,p):[]),o};var p=s.prototype;p.getAdapter=function(e){var t=!1;e=e||{},this.defaults.logFn("getAdapter",e),c._s(e)&&(t=!0,e={adapter:e});var r=this.adapters[e.adapter];if(r)return r;if(t)throw new Error(e.adapter+" is not a registered adapter!");return this.adapters[e.defaultAdapter]},p.getAdapter.shorthand=!1,p.registerAdapter=function(e,t,r){var n=this;r=r||{},n.defaults.logFn("registerAdapter",e,t,r),n.adapters[e]=c.isFunction(t)?new t(r):t,r.default&&(n.defaults.defaultAdapter=e),n.defaults.logFn("default adapter is "+n.defaults.defaultAdapter)},p.registerAdapter.shorthand=!1,p.is=function(e,t){var r=this.defs[e];if(!r)throw new l.NER(e);return t instanceof r[r.class]},p.errors=e("../errors"),p.utils=c,c.deepMixIn(p,u),c.deepMixIn(p,f),t.exports=s},{"../errors":48,"../utils":50,"./async_methods":32,"./sync_methods":42,"js-data-schema":"js-data-schema"}],38:[function(require,module,exports){function Resource(e){DSUtils.deepMixIn(this,e),this.endpoint="endpoint"in e?e.endpoint:this.name}function defineResource(definition){var _this=this,definitions=_this.defs;if(DSUtils._s(definition)&&(definition={name:definition.replace(/\s/gi,"")}),!DSUtils._o(definition))throw DSUtils._oErr("definition");if(!DSUtils._s(definition.name))throw new DSErrors.IA('"name" must be a string!');if(_this.s[definition.name])throw new DSErrors.R(definition.name+" is already registered!");try{Resource.prototype=_this.defaults,definitions[definition.name]=new Resource(definition);var def=definitions[definition.name];if(def.n=def.name,def.logFn("Preparing resource."),!DSUtils._s(def.idAttribute))throw new DSErrors.IA('"idAttribute" must be a string!');def.relations&&(def.relationList=[],def.relationFields=[],DSUtils.forOwn(def.relations,function(e,t){DSUtils.forOwn(e,function(r,n){DSUtils._a(r)||(e[n]=[r]),DSUtils.forEach(e[n],function(e){e.type=t,e.relation=n,e.name=def.n,def.relationList.push(e),def.relationFields.push(e.localField)})})}),def.relations.belongsTo&&DSUtils.forOwn(def.relations.belongsTo,function(e,t){DSUtils.forEach(e,function(e){e.parent&&(def.parent=t,def.parentKey=e.localKey,def.parentField=e.localField)})}),"function"==typeof Object.freeze&&(Object.freeze(def.relations),Object.freeze(def.relationList))),def.getResource=function(e){return _this.defs[e]},def.getEndpoint=function(e,t){t.params=t.params||{};var r,n=def.parentKey,i=t.hasOwnProperty("endpoint")?t.endpoint:def.endpoint,o=def.parentField,s=definitions[def.parent],a=t.params[n];if(a!==!1&&n&&s){if(delete t.params[n],DSUtils._sn(e)?r=def.get(e):DSUtils._o(e)&&(r=e),r&&(a=a||r[n]||(r[o]?r[o][s.idAttribute]:null)),a){delete t.endpoint;var c={};return DSUtils.forOwn(t,function(e,t){c[t]=e}),DSUtils.makePath(s.getEndpoint(a,DSUtils._(s,c)),a,i)}return i}return a===!1&&delete t.params[n],i},def.filter&&(def.defaultFilter=def.filter,delete def.filter),def["class"]=DSUtils.pascalCase(def.name);try{"function"==typeof def.useClass?(eval("function "+def["class"]+"() { def.useClass.call(this); }"),def[def["class"]]=eval(def["class"]),def[def["class"]].prototype=function(e){function t(){}return t.prototype=e,new t}(def.useClass.prototype)):(eval("function "+def["class"]+"() {}"),def[def["class"]]=eval(def["class"]))}catch(e){def[def["class"]]=function(){}}def.methods&&DSUtils.deepMixIn(def[def["class"]].prototype,def.methods),def[def["class"]].prototype.set=function(e,t){DSUtils.set(this,e,t);var r=_this.s[def.n].observers[this[def.idAttribute]];return r&&!DSUtils.observe.hasObjectObserve?r.deliver():_this.compute(def.n,this),this},def[def["class"]].prototype.get=function(e){return DSUtils.get(this,e)},def.computed&&DSUtils.forOwn(def.computed,function(e,t){DSUtils.isFunction(e)&&(def.computed[t]=[e],e=def.computed[t]),def.methods&&t in def.methods&&def.errorFn('Computed property "'+t+'" conflicts with previously defined prototype method!');var r;if(1===e.length){var n=e[0].toString().match(/function.*?\(([\s\S]*?)\)/);r=n[1].split(","),def.computed[t]=r.concat(e),e=def.computed[t],r.length&&def.errorFn("Use the computed property array syntax for compatibility with minified code!")}r=e.slice(0,e.length-1),DSUtils.forEach(r,function(e,t){r[t]=e.trim()}),e.deps=DSUtils.filter(r,function(e){return!!e})}),definition.schema&&_this.schemator&&(def.schema=_this.schemator.defineSchema(def.n,definition.schema),definition.hasOwnProperty("validate")||(def.validate=function(e,t,r){def.schema.validate(t,{ignoreMissing:def.ignoreMissing},function(e){return e?r(e):r(null,t)})})),DSUtils.forEach(instanceMethods,function(e){def[def["class"]].prototype["DS"+DSUtils.pascalCase(e)]=function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this[def.idAttribute]||this),t.unshift(def.n),_this[e].apply(_this,t)}}),def[def["class"]].prototype.DSCreate=function(){var e=Array.prototype.slice.call(arguments);return e.unshift(this),e.unshift(def.n),_this.create.apply(_this,e)},_this.s[def.n]={collection:[],expiresHeap:new DSUtils.DSBinaryHeap(function(e){return e.expires},function(e,t){return e.item===t}),completedQueries:{},queryData:{},pendingQueries:{},index:{},modified:{},saved:{},previousAttributes:{},observers:{},changeHistories:{},changeHistory:[],collectionModified:0},def.reapInterval&&setInterval(function(){_this.reap(def.n,{isInterval:!0})},def.reapInterval);for(var key in _this)"function"==typeof _this[key]&&(_this[key].shorthand!==!1?!function(e){def[e]=function(){var t=Array.prototype.slice.call(arguments);return t.unshift(def.n),_this[e].apply(_this,t)}}(key):!function(e){def[e]=function(){return _this[e].apply(_this,Array.prototype.slice.call(arguments))}}(key));return def.beforeValidate=DSUtils.promisify(def.beforeValidate),def.validate=DSUtils.promisify(def.validate),def.afterValidate=DSUtils.promisify(def.afterValidate),def.beforeCreate=DSUtils.promisify(def.beforeCreate),def.afterCreate=DSUtils.promisify(def.afterCreate),def.beforeUpdate=DSUtils.promisify(def.beforeUpdate),def.afterUpdate=DSUtils.promisify(def.afterUpdate),def.beforeDestroy=DSUtils.promisify(def.beforeDestroy),def.afterDestroy=DSUtils.promisify(def.afterDestroy),DSUtils.forOwn(def.actions,function(e,t){if(def[t])throw new Error('Cannot override existing method "'+t+'"!');def[t]=function(r){r=r||{};var n=_this.getAdapter(e.adapter||"http"),i=DSUtils.deepMixIn({},e);return!r.hasOwnProperty("endpoint")&&i.endpoint&&(r.endpoint=i.endpoint),i.url="function"==typeof r.getEndpoint?r.getEndpoint(def,r):DSUtils.makePath(r.basePath||n.defaults.basePath||def.basePath,def.getEndpoint(null,r),t),i.method=i.method||"GET",DSUtils.deepMixIn(i,r),n.HTTP(i)}}),DSUtils.Events(def),def.logFn("Done preparing resource."),def}catch(err){throw delete definitions[definition.name],delete _this.s[definition.name],err}}var DSUtils=require("../../utils"),DSErrors=require("../../errors"),instanceMethods=["compute","refresh","save","update","destroy","loadRelations","changeHistory","changes","hasChanges","lastModified","lastSaved","link","linkInverse","previous","unlinkInverse"];module.exports=defineResource},{"../../errors":48,"../../utils":50}],39:[function(e,t){function r(e,t,r){var o,s=this,a=s.defs[e],c=s.s[e],l=!1;if(t=n.resolveId(a,t),!a)throw new i.NER(e);if(!n._sn(t))throw n._snErr("id");r=n._(a,r),r.logFn("eject",t,r);for(var u=0;u<c.collection.length;u++)if(c.collection[u][a.idAttribute]==t){o=c.collection[u],c.expiresHeap.remove(o),l=!0;break}if(l){r.notify&&(a.beforeEject(r,o),a.emit("DS.beforeEject",a,o)),s.unlinkInverse(a.n,t),c.collection.splice(u,1),n.w&&c.observers[t].close(),delete c.observers[t],delete c.index[t],delete c.previousAttributes[t],delete c.completedQueries[t],delete c.pendingQueries[t],n.forEach(c.changeHistories[t],function(e){n.remove(c.changeHistory,e)});var f=[];return n.forOwn(c.queryData,function(e,t){e.$$injected&&n.remove(e,o),e.length||f.push(t)}),n.forEach(f,function(e){delete c.completedQueries[e],delete c.queryData[e]}),delete c.changeHistories[t],delete c.modified[t],delete c.saved[t],c.collectionModified=n.updateTimestamp(c.collectionModified),r.notify&&(a.afterEject(r,o),a.emit("DS.afterEject",a,o)),o}}var n=e("../../utils"),i=e("../../errors");t.exports=r},{"../../errors":48,"../../utils":50}],40:[function(e,t){function r(e,t,r){var o=this,s=o.defs[e];if(t=t||{},!s)throw new i.NER(e);if(!n._o(t))throw n._oErr("params");s.logFn("ejectAll",t,r);var a=o.s[e];n.isEmpty(t)&&(a.completedQueries={});var c=n.toJson(t),l=o.filter(s.n,t),u=[];return n.forEach(l,function(e){e&&e[s.idAttribute]&&u.push(e[s.idAttribute])}),n.forEach(u,function(e){o.eject(s.n,e,r)}),delete a.completedQueries[c],a.collectionModified=n.updateTimestamp(a.collectionModified),l}var n=e("../../utils"),i=e("../../errors");t.exports=r},{"../../errors":48,"../../utils":50}],41:[function(e,t){function r(e,t,r){var o=this,s=o.defs[e],a=o.s[e];if(!s)throw new i.NER(e);if(t&&!n._o(t))throw n._oErr("params");r=n._(s,r),r.logFn("filter",t,r),t=t||{};var c=n.toJson(t);return c in a.completedQueries||!r.loadFromServer||a.pendingQueries[c]||o.findAll(e,t,r),s.defaultFilter.call(o,a.collection,e,t,r)}var n=e("../../utils"),i=e("../../errors");t.exports=r},{"../../errors":48,"../../utils":50}],42:[function(e,t){function r(e,t,r){var n=this,i=n.defs[e];if(r=r||{},t=h.resolveId(i,t),!i)throw new g(e);if(!h._sn(t))throw h._snErr("id");r=h._(i,r),r.logFn("changes",t,r);var o=n.get(e,t);if(o){h.w&&n.s[e].observers[t].deliver();var s=h.diffObjectFromOldObject(o,n.s[e].previousAttributes[t],h.equals,r.ignoredChanges);return h.forOwn(s,function(e,t){var r=[];h.forOwn(e,function(e,t){h.isFunction(e)||r.push(t)}),s[t]=h.pick(s[t],r)}),h.forEach(i.relationFields,function(e){delete s.added[e],delete s.removed[e],delete s.changed[e]}),s}}function n(e,t){var r=this,n=r.defs[e],i=r.s[e];if(t=h.resolveId(n,t),e&&!r.defs[e])throw new g(e);if(t&&!h._sn(t))throw h._snErr("id");if(n.logFn("changeHistory",t),n.keepChangeHistory){if(!e)return i.changeHistory;var o=r.get(e,t);if(o)return i.changeHistories[t]}else n.errorFn("changeHistory is disabled for this resource!")}function i(e,t){var r=this,n=r.defs[e];if(t=h.resolveItem(r.s[e],t),!n)throw new g(e);if(!t)throw new m("Item not in the store!");if(!h._o(t)&&!h._sn(t))throw new y('"instance" must be an object, string or number!');return n.logFn("compute",t),h.forOwn(n.computed,function(e,r){h.compute.call(t,e,r)}),t}function o(e,t,r){var n,i=this.defs[e];if(t=t||{},!i)throw new g(e);if(t&&!h.isObject(t))throw new y('"attrs" must be an object!');if(r=h._(i,r),r.logFn("createInstance",t,r),r.notify&&r.beforeCreateInstance(r,t),r.useClass){var o=i[i.class];n=new o}else n={};return h.deepMixIn(n,t),r.notify&&r.afterCreateInstance(r,t),n}function s(e){return!(h.isEmpty(e.added)&&h.isEmpty(e.removed)&&h.isEmpty(e.changed))}function a(){this.observe.Platform.performMicrotaskCheckpoint()}function c(e,t,r){var n=this,i=n.defs[e];if(!i)throw new g(e);if(!h._sn(t))throw h._snErr("id");r=h._(i,r),r.logFn("get",t,r);var o=n.s[e].index[t];return!o&&r.loadFromServer&&n.find(e,t,r),o}function l(e,t){var r=this,n=r.defs[e],i=r.s[e],o=[];if(!n)throw new g(e);if(t&&!h._a(t))throw h._aErr("ids");if(n.logFn("getAll",t),h._a(t))for(var s=t.length,a=0;s>a;a++)i.index[t[a]]&&o.push(i.index[t[a]]);else o=i.collection.slice();return o}function u(e,t){var r=this,n=r.defs[e];if(t=h.resolveId(n,t),!n)throw new g(e);if(!h._sn(t))throw h._snErr("id");return n.logFn("hasChanges",t),r.get(e,t)?s(r.changes(e,t)):!1}function f(e,t){var r=this.defs[e],n=this.s[e];if(t=h.resolveId(r,t),!r)throw new g(e);return r.logFn("lastModified",t),t?(t in n.modified||(n.modified[t]=0),n.modified[t]):n.collectionModified}function d(e,t){var r=this.defs[e],n=this.s[e];if(t=h.resolveId(r,t),!r)throw new g(e);return r.logFn("lastSaved",t),t in n.saved||(n.saved[t]=0),n.saved[t]}function p(e,t){var r=this,n=r.defs[e],i=r.s[e];if(t=h.resolveId(n,t),!n)throw new g(e);if(!h._sn(t))throw h._snErr("id");return n.logFn("previous",t),i.previousAttributes[t]?h.copy(i.previousAttributes[t]):void 0}var h=e("../../utils"),v=e("../../errors"),g=v.NER,y=v.IA,m=v.R;t.exports={changes:r,changeHistory:n,compute:i,createInstance:o,defineResource:e("./defineResource"),digest:a,eject:e("./eject"),ejectAll:e("./ejectAll"),filter:e("./filter"),get:c,getAll:l,hasChanges:u,inject:e("./inject"),lastModified:f,lastSaved:d,link:e("./link"),linkAll:e("./linkAll"),linkInverse:e("./linkInverse"),previous:p,unlinkInverse:e("./unlinkInverse")}},{"../../errors":48,"../../utils":50,"./defineResource":38,"./eject":39,"./ejectAll":40,"./filter":41,"./inject":43,"./link":44,"./linkAll":45,"./linkInverse":46,"./unlinkInverse":47}],43:[function(e,t){function r(e,t,r){var n=t.n;return function(i,o,a,c,l){var u,f=this,d=c&&c(t.idAttribute)?c(t.idAttribute):f[t.idAttribute];if(s.forEach(t.relationFields,function(e){delete i[e],delete o[e],delete a[e]}),(!s.isEmpty(i)||!s.isEmpty(o)||!s.isEmpty(a)||l)&&(u=e.get(n,d),r.modified[d]=s.updateTimestamp(r.modified[d]),r.collectionModified=s.updateTimestamp(r.collectionModified),t.keepChangeHistory)){var p={resourceName:n,target:u,added:i,removed:o,changed:a,timestamp:r.modified[d]};r.changeHistories[d].push(p),r.changeHistory.push(p)}t.computed&&(u=u||e.get(n,d),s.forOwn(t.computed,function(e,t){var r=!1;s.forEach(e.deps,function(e){(e in i||e in o||e in a||!(t in u))&&(r=!0)}),r=r||!e.deps.length,r&&s.compute.call(u,e,t)})),t.relations&&(u=u||e.get(n,d),s.forEach(t.relationList,function(r){u[r.localField]&&(r.localKey in i||r.localKey in o||r.localKey in a)&&e.link(n,u[t.idAttribute],[r.relation])})),t.idAttribute in a&&t.errorFn('Doh! You just changed the primary key of an object! Your data for the "'+n+'" resource is now in an undefined (probably broken) state.')}}function n(e,t,i,o){var c,l=this,u=r(l,e,t,i,o);if(s._a(i)){c=[];for(var f=0;f<i.length;f++)c.push(n.call(l,e,t,i[f],o))}else{var d=e.computed,p=e.idAttribute;if(d&&d[p]){var h=[];s.forEach(d[p].deps,function(e){h.push(i[e])}),i[p]=d[p][d[p].length-1].apply(i,h)}if(!(p in i)){var v=new a.R(e.n+'.inject: "attrs" must contain the property specified by `idAttribute`!');throw o.errorFn(v),v}try{s.forEach(e.relationList,function(t){var r=t.relation,n=l.defs[r],c=i[t.localField];if(c){if(!n)throw new a.R(e.n+" relation is defined but the resource is not!");if(s._a(c)){var u=[];s.forEach(c,function(s){if(s!==l.s[r][s[n.idAttribute]])try{var a=l.inject(r,s,o);t.foreignKey&&(a[t.foreignKey]=i[e.idAttribute]),u.push(a)}catch(c){o.errorFn(c,"Failed to inject "+t.type+' relation: "'+r+'"!')}}),i[t.localField]=u}else if(c!==l.s[r][c[n.idAttribute]])try{i[t.localField]=l.inject(r,i[t.localField],o),t.foreignKey&&(i[t.localField][t.foreignKey]=i[e.idAttribute])}catch(f){o.errorFn(f,"Failed to inject "+t.type+' relation: "'+r+'"!')}}});var g=i[p],y=l.get(e.n,g),m=y?t.modified[g]:0;y?(s.deepMixIn(y,i),e.resetHistoryOnInject&&(t.previousAttributes[g]={},s.deepMixIn(t.previousAttributes[g],i),t.changeHistories[g].length&&(s.forEach(t.changeHistories[g],function(e){s.remove(t.changeHistory,e)}),t.changeHistories[g].splice(0,t.changeHistories[g].length))),s.w&&t.observers[g].deliver()):(y=o.useClass?i instanceof e[e["class"]]?i:new e[e["class"]]:{},s.deepMixIn(y,i),t.collection.push(y),t.changeHistories[g]=[],s.w&&(t.observers[g]=new l.observe.ObjectObserver(y),t.observers[g].open(u,y)),t.index[g]=y,u.call(y,{},{},{},null,!0),t.previousAttributes[g]={},s.deepMixIn(t.previousAttributes[g],y)),t.modified[g]=m&&t.modified[g]===m?s.updateTimestamp(t.modified[g]):t.modified[g],t.expiresHeap.remove(y);var b=(new Date).getTime();t.expiresHeap.push({item:y,timestamp:b,expires:e.maxAge?b+e.maxAge:Number.MAX_VALUE}),c=y}catch(_){o.errorFn(_,i)}}return c}function i(e,t,r){var n=this;s.forEach(e.relationList,function(i){r.findBelongsTo&&"belongsTo"===i.type&&t[e.idAttribute]?n.link(e.n,t[e.idAttribute],[i.relation]):(r.findHasMany&&"hasMany"===i.type||r.findHasOne&&"hasOne"===i.type)&&n.link(e.n,t[e.idAttribute],[i.relation])})}function o(e,t,r){var o,c=this,l=c.defs[e],u=c.s[e];if(!l)throw new a.NER(e);if(!s._o(t)&&!s._a(t))throw new a.IA(e+'.inject: "attrs" must be an object or an array!');var f=l.n;return r=s._(l,r),r.logFn("inject",t,r),r.notify&&(r.beforeInject(r,t),l.emit("DS.beforeInject",l,t)),o=n.call(c,l,u,t,r),u.collectionModified=s.updateTimestamp(u.collectionModified),r.findInverseLinks&&(s._a(o)?o.length&&c.linkInverse(f,o[0][l.idAttribute]):c.linkInverse(f,o[l.idAttribute])),s._a(o)?s.forEach(o,function(e){i.call(c,l,e,r)}):i.call(c,l,o,r),r.notify&&(r.afterInject(r,o),l.emit("DS.afterInject",l,o)),o}var s=e("../../utils"),a=e("../../errors");t.exports=o},{"../../errors":48,"../../utils":50}],44:[function(e,t){function r(e,t,r){var o=this,s=o.defs[e];if(r=r||[],t=n.resolveId(s,t),!s)throw new i.NER(e);if(!n._sn(t))throw n._snErr("id");if(!n._a(r))throw n._aErr("relations");s.logFn("link",t,r);var a=o.get(e,t);return a&&n.forEach(s.relationList,function(e){var t=e.relation;if(!r.length||n.contains(r,t)){var i={};if("belongsTo"===e.type){var c=a[e.localKey]?o.get(t,a[e.localKey]):null;c&&(a[e.localField]=c)}else if("hasMany"===e.type)i[e.foreignKey]=a[s.idAttribute],a[e.localField]=o.defaults.constructor.prototype.defaultFilter.call(o,o.s[t].collection,t,i,{allowSimpleWhere:!0});else if("hasOne"===e.type){i[e.foreignKey]=a[s.idAttribute];var l=o.defaults.constructor.prototype.defaultFilter.call(o,o.s[t].collection,t,i,{allowSimpleWhere:!0});l.length&&(a[e.localField]=l[0])}}}),a}var n=e("../../utils"),i=e("../../errors");t.exports=r},{"../../errors":48,"../../utils":50}],45:[function(e,t){function r(e,t,r){var o=this,s=o.defs[e];if(r=r||[],!s)throw new i.NER(e);if(!n._a(r))throw n._aErr("relations");s.logFn("linkAll",t,r);var a=o.filter(e,t);return a&&n.forEach(s.relationList,function(e){var t=e.relation;(!r.length||n.contains(r,t))&&("belongsTo"===e.type?n.forEach(a,function(r){var n=r[e.localKey]?o.get(t,r[e.localKey]):null;n&&(r[e.localField]=n)}):"hasMany"===e.type?n.forEach(a,function(r){var n={};n[e.foreignKey]=r[s.idAttribute],r[e.localField]=o.defaults.constructor.prototype.defaultFilter.call(o,o.s[t].collection,t,n,{allowSimpleWhere:!0})}):"hasOne"===e.type&&n.forEach(a,function(r){var n={};n[e.foreignKey]=r[s.idAttribute];var i=o.defaults.constructor.prototype.defaultFilter.call(o,o.s[t].collection,t,n,{allowSimpleWhere:!0});i.length&&(r[e.localField]=i[0])}))}),a}var n=e("../../utils"),i=e("../../errors");t.exports=r},{"../../errors":48,"../../utils":50}],46:[function(e,t){function r(e,t,r){var o=this,s=o.defs[e];if(r=r||[],t=n.resolveId(s,t),!s)throw new i.NER(e);if(!n._sn(t))throw n._snErr("id");if(!n._a(r))throw n._aErr("relations");s.logFn("linkInverse",t,r);var a=o.get(e,t);return a&&n.forOwn(o.defs,function(e){n.forOwn(e.relations,function(t){n.forOwn(t,function(t,i){(!r.length||n.contains(r,e.n))&&s.n===i&&o.linkAll(e.n,{},[s.n])})})}),a}var n=e("../../utils"),i=e("../../errors");t.exports=r},{"../../errors":48,"../../utils":50}],47:[function(e,t){function r(e,t,r){var o=this,s=o.defs[e];if(r=r||[],t=n.resolveId(s,t),!s)throw new i.NER(e);if(!n._sn(t))throw n._snErr("id");if(!n._a(r))throw n._aErr("relations");s.logFn("unlinkInverse",t,r);var a=o.get(e,t);return a&&n.forOwn(o.defs,function(e){n.forOwn(e.relations,function(e){n.forOwn(e,function(e,t){s.n===t&&n.forEach(e,function(e){n.forEach(o.s[e.name].collection,function(t){if("hasMany"===e.type&&t[e.localField]){var r;n.forEach(t[e.localField],function(e,t){e===a&&(r=t)}),t[e.localField].splice(r,1)}else t[e.localField]===a&&delete t[e.localField]})})})})}),a}var n=e("../../utils"),i=e("../../errors");t.exports=r},{"../../errors":48,"../../utils":50}],48:[function(e,t){function r(e){Error.call(this),"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.type=this.constructor.name,this.message=e||"Illegal Argument!"}function n(e){Error.call(this),"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.type=this.constructor.name,this.message=e||"RuntimeError Error!"}function i(e){Error.call(this),"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.type=this.constructor.name,this.message=(e||"")+" is not a registered resource!"}r.prototype=new Error,r.prototype.constructor=r,n.prototype=new Error,n.prototype.constructor=n,i.prototype=new Error,i.prototype.constructor=i,t.exports={IllegalArgumentError:r,IA:r,RuntimeError:n,R:n,NonexistentResourceError:i,NER:i}},{}],49:[function(e,t){var r=e("./datastore");t.exports={DS:r,createStore:function(e){return new r(e)},DSUtils:e("./utils"),DSErrors:e("./errors"),version:{full:"1.5.1",major:parseInt("1",10),minor:parseInt("5",10),patch:parseInt("1",10),alpha:!1,beta:!1}}},{"./datastore":37,"./errors":48,"./utils":50}],50:[function(e,t){function r(e){return"[object RegExp]"==I.call(e)||!1}function n(e){return e===!0||e===!1||e&&"object"==typeof e&&"[object Boolean]"==I.call(e)||!1}function i(e){return"string"==typeof e||e&&"object"==typeof e&&"[object String]"==I.call(e)||!1}function o(e){return"[object Object]"==I.call(e)||!1}function s(e){return e&&"object"==typeof e&&"[object Date]"==I.call(e)||!1}function a(e){var t=typeof e;return"number"==t||e&&"object"==t&&"[object Number]"==I.call(e)||!1}function c(e){return"function"==typeof e||e&&"[object Function]"===I.call(e)||!1}function l(e){return i(e)||a(e)}function u(e){return new R.IA('"'+e+'" must be a string or a number!')}function f(e){return new R.IA('"'+e+'" must be an object!')}function d(e){return new R.IA('"'+e+'" must be an array!')}function p(e){if(null==e)return!0;if("string"==typeof e||H(e))return!e.length;if("object"==typeof e){var t=!0;return U(e,function(){return t=!1,!1}),t}return!0}function h(e,t){if(!e||!t)return[];for(var r,n=[],i=0,o=e.length;o>i;i++)r=e[i],B.contains(n,r)||B.contains(t,r)&&n.push(r);return n}function v(e,t,r){var n=[];return P(e,function(e,r,i){t(e,r,i)&&n.push(e)},r),n}function g(e){var t=this.constructor;return this.then(function(r){return t.resolve(e()).then(function(){return r})},function(r){return t.resolve(e()).then(function(){throw r})})}function y(e){var t="function"==typeof Date.now?Date.now():(new Date).getTime();return e&&e>=t?e+1:t}function m(e){var t={};e=e||this,e.on=function(e,r,n){t[e]=t[e]||[],t[e].push({f:r,c:n})},e.off=function(e,r){var n=t[e];if(n)if(r){for(var i=0;i<n.length;i++)if(n[i]===r){n.splice(i,1);break}}else n.splice(0,n.length);else t={}},e.emit=function(){var e=Array.prototype.slice.call(arguments),r=t[e.shift()]||[];if(r)for(var n=0;n<r.length;n++)r[n].f.apply(r[n].c,e)}}function b(e,t,r){for(var n=e[r],i=t(n);r>0;){var o=Math.floor((r+1)/2)-1,s=e[o];if(i>=t(s))break;e[o]=n,e[r]=s,r=o}}function _(e,t,r){for(var n=e.length,i=e[r],o=t(i);;){var s=2*(r+1),a=s-1,c=null;if(n>a){var l=e[a],u=t(l);o>u&&(c=a)}if(n>s){var f=e[s],d=t(f);d<(null===c?o:t(e[a]))&&(c=s)}if(null===c)break;e[r]=e[c],e[c]=i,r=c}}function w(e,t){if(e&&!c(e))throw new Error("DSBinaryHeap(weightFunc): weightFunc: must be a function!");e=e||function(e){return e},t=t||function(e,t){return e===t},this.weightFunc=e,this.compareFunc=t,this.heap=[]}function E(e,t,n,i){if(t){if(e===t)throw new Error("Cannot copy! Source and destination are identical.");if(n=n||[],i=i||[],o(e)){var a=n.indexOf(e);if(-1!==a)return i[a];n.push(e),i.push(t)}var c;if(H(e)){t.length=0;for(var l=0;l<e.length;l++)c=E(e[l],null,n,i),o(e[l])&&(n.push(e[l]),i.push(c)),t.push(c)}else{H(t)?t.length=0:P(t,function(e,r){delete t[r]});for(var u in e)e.hasOwnProperty(u)&&(c=E(e[u],null,n,i),o(e[u])&&(n.push(e[u]),i.push(c)),t[u]=c)}}else if(t=e,e)if(H(e))t=E(e,[],n,i);else if(s(e))t=new Date(e.getTime());else if(r(e))t=new RegExp(e.source,e.toString().match(/[^\/]*$/)[0]),t.lastIndex=e.lastIndex;else if(o(e)){var f=Object.create(Object.getPrototypeOf(e));t=E(e,f,n,i)}return t}function O(e,t){if(e===t)return!0;if(null===e||null===t)return!1;if(e!==e&&t!==t)return!0;var n,i,o,a=typeof e,l=typeof t;if(a==l&&"object"==a){if(!H(e)){if(s(e))return s(t)?O(e.getTime(),t.getTime()):!1;if(r(e)&&r(t))return e.toString()==t.toString();if(H(t))return!1;o={};for(i in e)if("$"!==i.charAt(0)&&!c(e[i])){if(!O(e[i],t[i]))return!1;o[i]=!0}for(i in t)if(!o.hasOwnProperty(i)&&"$"!==i.charAt(0)&&void 0!==t[i]&&!c(t[i]))return!1;return!0}if(!H(t))return!1;if((n=e.length)==t.length){for(i=0;n>i;i++)if(!O(e[i],t[i]))return!1;return!0}}return!1}function A(e,t){return this.isString(t)||a(t)?t:t&&e?t[e.idAttribute]||t:t}function j(e,t){return e&&(i(t)||a(t))?e.index[t]||t:t}function x(e){return null!=e&&""!==e}function D(e,t){return t=t||"",v(e,x).join(t)}function S(){var e=D(M(arguments),"/");return e.replace(/([^:\/]|^)\/{2,}/g,"$1/")}var F,C,k=Object.prototype,I=k.toString,R=e("./errors"),P=e("mout/array/forEach"),M=e("mout/array/slice"),U=e("mout/object/forOwn"),T=e("../lib/observe-js/observe-js"),N=e("es6-promise");N.polyfill();var H=Array.isArray||function(e){return"[object Array]"==I.call(e)||!1};try{F=window,F.Promise.prototype["finally"]||(F.Promise.prototype["finally"]=g),C=F.Promise,F={}}catch(K){F=null,C=e("bluebird")}var Q=w.prototype;Q.push=function(e){this.heap.push(e),b(this.heap,this.weightFunc,this.heap.length-1)},Q.peek=function(){return this.heap[0]},Q.pop=function(){var e=this.heap[0],t=this.heap.pop();return this.heap.length>0&&(this.heap[0]=t,_(this.heap,this.weightFunc,0)),e},Q.remove=function(e){for(var t=this.heap.length,r=0;t>r;r++)if(this.compareFunc(this.heap[r],e)){var n=this.heap[r],i=this.heap.pop();return r!==t-1&&(this.heap[r]=i,b(this.heap,this.weightFunc,r),_(this.heap,this.weightFunc,r)),n}return null},Q.removeAll=function(){this.heap=[]},Q.size=function(){return this.heap.length};var L=["beforeValidate","validate","afterValidate","beforeCreate","afterCreate","beforeUpdate","afterUpdate","beforeDestroy","afterDestroy"];T.setEqualityFn(O);var B={_:function(e,t){var r=this;if(t=t||{},t&&t.constructor===e.constructor)return t;if(!o(t))throw new R.IA('"options" must be an object!');P(L,function(e){"function"==typeof t[e]&&-1===t[e].toString().indexOf("var args = Array")&&(t[e]=r.promisify(t[e]))});var n=function(e){var t=this;U(e,function(e,r){t[r]=e})};return n.prototype=e,new n(t)},_n:a,_s:i,_sn:l,_snErr:u,_o:o,_oErr:f,_a:H,_aErr:d,compute:function(e,t){var r=this,n=[];P(e.deps,function(e){n.push(r[e])}),r[t]=e[e.length-1].apply(r,n)},contains:e("mout/array/contains"),copy:E,deepMixIn:e("mout/object/deepMixIn"),diffObjectFromOldObject:T.diffObjectFromOldObject,DSBinaryHeap:w,equals:O,Events:m,filter:v,forEach:P,forOwn:U,fromJson:function(e){return i(e)?JSON.parse(e):e},get:e("mout/object/get"),intersection:h,isArray:H,isBoolean:n,isDate:s,isEmpty:p,isFunction:c,isObject:o,isNumber:a,isRegExp:r,isString:i,makePath:S,observe:T,pascalCase:e("mout/string/pascalCase"),pick:e("mout/object/pick"),Promise:C,promisify:function(e,t){var r=this.Promise;if(e){if("function"!=typeof e)throw new Error("Can only promisify functions!");return function(){var n=Array.prototype.slice.apply(arguments);return new r(function(r,i){n.push(function(e,t){e?i(e):r(t)});try{var o=e.apply(t||this,n);o&&o.then&&o.then(r,i)}catch(s){i(s)}})}}},remove:e("mout/array/remove"),set:e("mout/object/set"),slice:M,sort:e("mout/array/sort"),toJson:JSON.stringify,updateTimestamp:y,upperCase:e("mout/string/upperCase"),removeCircular:function(e){var t=[];return function r(e){var n,i;if(!("object"!=typeof e||null===e||e instanceof Boolean||e instanceof Date||e instanceof Number||e instanceof RegExp||e instanceof String)){for(n=0;n<t.length;n+=1)if(t[n]===e)return void 0;if(t.push(e),B.isArray(e))for(i=[],n=0;n<e.length;n+=1)i[n]=r(e[n]);else i={},U(e,function(t,n){i[n]=r(e[n])});return i}return e}(e)},resolveItem:j,resolveId:A,w:F};t.exports=B},{"../lib/observe-js/observe-js":1,"./errors":48,bluebird:"bluebird","es6-promise":2,"mout/array/contains":4,"mout/array/forEach":5,"mout/array/remove":7,"mout/array/slice":8,"mout/array/sort":9,"mout/object/deepMixIn":13,"mout/object/forOwn":15,"mout/object/get":16,"mout/object/pick":19,"mout/object/set":20,"mout/string/pascalCase":23,"mout/string/upperCase":26}]},{},[49])(49)});