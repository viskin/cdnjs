(function(b,a){b(function(g){H.promise=I;H.resolve=t;H.reject=w;H.defer=i;H.join=l;H.all=r;H.map=z;H.reduce=o;H.settle=B;H.any=C;H.some=J;H.isPromise=d;H.isPromiseLike=d;function H(W,Z,X,Y){return t(W).then(Z,X,Y)}function G(W,X){this._message=W;this.inspect=X}G.prototype={then:function(aa,X,Z){var W,Y;W=arguments;Y=this._message;return j(function(ad,ac,ab){Y("when",W,ad,ab)},this._status&&this._status.observed())},otherwise:function(W){return this.then(x,W)},ensure:function(X){return this.then(W,W)["yield"](this);function W(){return t(X())}},yield:function(W){return this.then(function(){return W})},tap:function(W){return this.then(W)["yield"](this)},spread:function(W){return this.then(function(X){return r(X,function(Y){return W.apply(x,Y)})})},always:function(W,X){return this.then(W,W,X)}};function t(W){return I(function(X){X(W)})}function w(W){return H(W,s)}function i(){var Y,Z,X;Y={promise:x,resolve:x,reject:x,notify:x,resolver:{resolve:x,reject:x,notify:x}};Y.promise=Z=I(W);return Y;function W(aa,ab,ac){Y.resolve=Y.resolver.resolve=function(ad){if(X){return t(ad)}X=true;aa(ad);return Z};Y.reject=Y.resolver.reject=function(ad){if(X){return t(s(ad))}X=true;ab(ad);return Z};Y.notify=Y.resolver.notify=function(ad){ac(ad);return ad}}}function I(W){return j(W,R.PromiseStatus&&R.PromiseStatus())}function j(W,Y){var ag,ab,Z=[];ag=new G(ae,ad);ag._status=Y;try{W(X,af,ac)}catch(aa){af(aa)}return ag;function ae(aj,ah,ak,ai){Z?Z.push(al):k(function(){al(ab)});function al(am){am._message(aj,ah,ak,ai)}}function ad(){return ab?ab.inspect():v()}function X(ah){if(!Z){return}ab=E(ag,ah);O(Z,ab);Z=x;if(Y){u(ab,Y)}}function af(ah){X(s(ah))}function ac(ah){if(Z){O(Z,P(ah))}}}function F(W){return D(new m(W),function(){return f(W)})}function s(W){return D(new S(W),function(){return U(W)})}function D(W,X){return new G(function(Z,Y,aa){try{aa(W[Z].apply(W,Y))}catch(ab){aa(s(ab))}},X)}function P(W){return new G(function(aa,Y,X,Z){var ac=Y[2];try{Z(typeof ac==="function"?ac(W):W)}catch(ab){Z(ab)}})}function E(X,W){if(W===X){return s(new TypeError())}if(W instanceof G){return W}if(!(W===Object(W)&&"then" in W)){return F(W)}return I(function(aa,Z,Y){k(function(){try{var ab=W.then;if(typeof ab==="function"){h(ab,W,aa,Z,Y)}else{aa(F(W))}}catch(ac){Z(ac)}})})}function m(W){this.value=W}m.prototype.when=function(W){return typeof W==="function"?W(this.value):this.value};function S(W){this.reason=W}S.prototype.when=function(W,X){if(typeof X==="function"){return X(this.reason)}else{throw this.reason}};function O(W,X){k(function(){var Z,Y=0;while(Z=W[Y++]){Z(X)}})}function u(Y,X){Y.then(W,Z);function W(){X.fulfilled()}function Z(aa){X.rejected(aa)}}function d(W){return W&&typeof W.then==="function"}function J(Y,X,aa,W,Z){return H(Y,function(ab){return I(ac).then(aa,W,Z);function ac(an,ap,ao){var al,ak,am,ae,aj,ag,ai,ah;ai=ab.length>>>0;al=Math.max(0,Math.min(X,ai));am=[];ak=(ai-al)+1;ae=[];if(!al){an(am)}else{ag=function(aq){ae.push(aq);if(!--ak){aj=ag=N;ap(ae)}};aj=function(aq){am.push(aq);if(!--al){aj=ag=N;an(am)}};for(ah=0;ah<ai;++ah){if(ah in ab){H(ab[ah],ad,af,ao)}}}function af(aq){ag(aq)}function ad(aq){aj(aq)}}})}function C(X,aa,W,Y){function Z(ab){return aa?aa(ab[0]):ab[0]}return J(X,1,Z,W,Y)}function r(X,Z,W,Y){return A(X,N).then(Z,W,Y)}function l(){return A(arguments,N)}function B(W){return A(W,f,U)}function z(X,W){return A(X,W)}function A(Y,W,X){return H(Y,function(aa){return j(Z);function Z(ai,ah,ag){var af,ac,ae,ad;ae=ac=aa.length>>>0;af=[];if(!ae){ai(af);return}for(ad=0;ad<ac;ad++){if(ad in aa){ab(aa[ad],ad)}else{--ae}}function ab(ak,aj){H(ak,W,X).then(function(al){af[aj]=al;if(!--ae){ai(af)}},ah,ag)}}})}function o(Y,X){var W=h(p,arguments,1);return H(Y,function(aa){var Z;Z=aa.length;W[0]=function(ac,ad,ab){return H(ac,function(ae){return H(ad,function(af){return X(ae,af,ab,Z)})})};return M.apply(aa,W)})}function f(W){return{state:"fulfilled",value:W}}function U(W){return{state:"rejected",reason:W}}function v(){return{state:"pending"}}var M,p,h,T,n,L,V,c,q,R,K,y,x;K=g;n=[];function k(W){if(n.push(W)===1){T(Q)}}function Q(){var W,X=0;while(W=n[X++]){W()}n=[]}L=a.setTimeout;R=typeof console!="undefined"?console:H;if(typeof process==="object"&&process.nextTick){T=process.nextTick}else{if(y=a.MutationObserver||a.WebKitMutationObserver){T=(function(W,Y,Z){var X=W.createElement("div");new Y(Z).observe(X,{attributes:true});return function(){X.setAttribute("x","x")}}(document,y,Q))}else{try{T=K("vertx").runOnLoop||K("vertx").runOnContext}catch(e){T=function(W){L(W,0)}}}}V=Function.prototype;c=V.call;h=V.bind?c.bind(c):function(X,W){return X.apply(W,p.call(arguments,2))};q=[];p=q.slice;M=q.reduce||function(ab){var X,Z,Y,W,aa;aa=0;X=Object(this);W=X.length>>>0;Z=arguments;if(Z.length<=1){for(;;){if(aa in X){Y=X[aa++];break}if(++aa>=W){throw new TypeError()}}}else{Y=Z[1]}for(;aa<W;++aa){if(aa in X){Y=ab(Y,X[aa],aa,X)}}return Y};function N(W){return W}return H})})(typeof define==="function"&&define.amd?define:function(a){module.exports=a(require)},this);