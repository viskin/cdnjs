(function(a){a(function(f){J.promise=K;J.resolve=u;J.reject=y;J.defer=i;J.join=l;J.all=s;J.map=A;J.reduce=p;J.settle=C;J.any=D;J.some=L;J.isPromise=c;J.isPromiseLike=c;function J(Z,ac,aa,ab){return I(Z).then(ac,aa,ab)}function I(Z){return Z instanceof H?Z:u(Z)}function H(Z,aa){this._message=Z;this.inspect=aa}var m=H.prototype;m.then=function(ad,aa,ac){var Z,ab;Z=arguments;ab=this._message;return j(function(ag,af,ae){ab("when",Z,ag,ae)},this._status&&this._status.observed())};m["catch"]=m.otherwise=function(Z){return this.then(z,Z)};m["finally"]=m.ensure=function(aa){return typeof aa==="function"?this.then(Z,Z)["yield"](this):this;function Z(){return u(aa())}};m.done=function(Z,aa){this.then(Z,aa).otherwise(Q)};m.yield=function(Z){return this.then(function(){return Z})};m.tap=function(Z){return this.then(Z)["yield"](this)};m.spread=function(Z){return this.then(function(aa){return s(aa,function(ab){return Z.apply(z,ab)})})};m.always=function(Z,aa){return this.then(Z,Z,aa)};function u(Z){return K(function(aa){aa(Z)})}function y(Z){return J(Z,t)}function i(){var ab,ac,aa;ab={promise:z,resolve:z,reject:z,notify:z,resolver:{resolve:z,reject:z,notify:z}};ab.promise=ac=K(Z);return ab;function Z(ad,ae,af){ab.resolve=ab.resolver.resolve=function(ag){if(aa){return u(ag)}aa=true;ad(ag);return ac};ab.reject=ab.resolver.reject=function(ag){if(aa){return u(t(ag))}aa=true;ae(ag);return ac};ab.notify=ab.resolver.notify=function(ag){af(ag);return ag}}}function K(Z){return j(Z,U.PromiseStatus&&U.PromiseStatus())}function j(Z,ab){var aj,ae,ac=[];aj=new H(ah,ag);aj._status=ab;try{Z(aa,ai,af)}catch(ad){ai(ad)}return aj;function ah(am,ak,an,al){ac?ac.push(ao):k(function(){ao(ae)});function ao(ap){ap._message(am,ak,an,al)}}function ag(){return ae?ae.inspect():x()}function aa(al){if(!ac){return}var ak=ac;ac=z;k(function(){ae=F(aj,al);if(ab){v(ae,ab)}w(ak,ae)})}function ai(ak){aa(t(ak))}function af(al){if(ac){var ak=ac;k(function(){w(ak,S(al))})}}}function w(Z,ab){for(var aa=0;aa<Z.length;aa++){Z[aa](ab)}}function G(Z){return E(new n(Z),function(){return e(Z)})}function t(Z){return E(new V(Z),function(){return X(Z)})}function E(Z,aa){return new H(function(ac,ab,ad){try{ad(Z[ac].apply(Z,ab))}catch(ae){ad(t(ae))}},aa)}function S(Z){return new H(function(ad,ab,aa,ac){var af=ab[2];try{ac(typeof af==="function"?af(Z):Z)}catch(ae){ac(ae)}})}function F(ab,aa){if(aa===ab){return t(new TypeError())}if(aa instanceof H){return aa}try{var Z=aa===Object(aa)&&aa.then;return typeof Z==="function"?g(Z,aa):G(aa)}catch(ac){return t(ac)}}function g(aa,Z){return K(function(ac,ab){h(aa,Z,ac,ab)})}function n(Z){this.value=Z}n.prototype.when=function(Z){return typeof Z==="function"?Z(this.value):this.value};function V(Z){this.reason=Z}V.prototype.when=function(Z,aa){if(typeof aa==="function"){return aa(this.reason)}else{throw this.reason}};function v(ab,aa){ab.then(Z,ac);function Z(){aa.fulfilled()}function ac(ad){aa.rejected(ad)}}function c(Z){return Z&&typeof Z.then==="function"}function L(ab,aa,ad,Z,ac){return J(ab,function(ae){return K(af).then(ad,Z,ac);function af(aq,at,ar){var ao,an,ap,ah,am,aj,al,ak;al=ae.length>>>0;ao=Math.max(0,Math.min(aa,al));ap=[];an=(al-ao)+1;ah=[];if(!ao){aq(ap)}else{aj=function(au){ah.push(au);if(!--an){am=aj=O;at(ah)}};am=function(au){ap.push(au);if(!--ao){am=aj=O;aq(ap)}};for(ak=0;ak<al;++ak){if(ak in ae){J(ae[ak],ag,ai,ar)}}}function ai(au){aj(au)}function ag(au){am(au)}}})}function D(aa,ad,Z,ab){function ac(ae){return ad?ad(ae[0]):ae[0]}return L(aa,1,ac,Z,ab)}function s(aa,ac,Z,ab){return B(aa,O).then(ac,Z,ab)}function l(){return B(arguments,O)}function C(Z){return B(Z,e,X)}function A(aa,Z){return B(aa,Z)}function B(ab,Z,aa){return J(ab,function(ad){return j(ac);function ac(al,ak,aj){var ai,af,ah,ag;ah=af=ad.length>>>0;ai=[];if(!ah){al(ai);return}for(ag=0;ag<af;ag++){if(ag in ad){ae(ad[ag],ag)}else{--ah}}function ae(an,am){J(an,Z,aa).then(function(ao){ai[am]=ao;if(!--ah){al(ai)}},ak,aj)}}})}function p(ab,aa){var Z=h(q,arguments,1);return J(ab,function(ad){var ac;ac=ad.length;Z[0]=function(af,ag,ae){return J(af,function(ah){return J(ag,function(ai){return aa(ah,ai,ae,ac)})})};return N.apply(ad,Z)})}function e(Z){return{state:"fulfilled",value:Z}}function X(Z){return{state:"rejected",reason:Z}}function x(){return{state:"pending"}}var N,q,h,W,o,Y,b,r,U,P,M,R,z;M=f;o=[];function k(Z){if(o.push(Z)===1){W(T)}}function T(){w(o);o=[]}U=typeof console!=="undefined"?console:J;if(typeof process==="object"&&process.nextTick){W=process.nextTick}else{if(R=(typeof MutationObserver==="function"&&MutationObserver)||(typeof WebKitMutationObserver==="function"&&WebKitMutationObserver)){W=(function(Z,ab,ac){var aa=Z.createElement("div");new ab(ac).observe(aa,{attributes:true});return function(){aa.setAttribute("x","x")}}(document,R,T))}else{try{W=M("vertx").runOnLoop||M("vertx").runOnContext}catch(d){P=setTimeout;W=function(Z){P(Z,0)}}}}Y=Function.prototype;b=Y.call;h=Y.bind?b.bind(b):function(aa,Z){return aa.apply(Z,q.call(arguments,2))};r=[];q=r.slice;N=r.reduce||function(ae){var aa,ac,ab,Z,ad;ad=0;aa=Object(this);Z=aa.length>>>0;ac=arguments;if(ac.length<=1){for(;;){if(ad in aa){ab=aa[ad++];break}if(++ad>=Z){throw new TypeError()}}}else{ab=ac[1]}for(;ad<Z;++ad){if(ad in aa){ab=ae(ab,aa[ad],ad,aa)}}return ab};function O(Z){return Z}function Q(Z){if(typeof U.reportUnhandled==="function"){U.reportUnhandled()}else{k(function(){throw Z})}throw Z}return J})})(typeof define==="function"&&define.amd?define:function(a){module.exports=a(require)});