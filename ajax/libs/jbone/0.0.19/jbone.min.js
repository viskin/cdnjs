/*!
 * jBone v0.0.19 - 2013-11-23 - Library for DOM manipulation
 *
 * https://github.com/kupriyanenko/jbone
 *
 * Copyright 2013 Alexey Kupriyanenko
 * Released under the MIT license.
 */

!function(){function a(a,b){var c,d;this.originalEvent=a,d=function(a,b){this[a]="preventDefault"===a?function(){return this.defaultPrevented=!0,b[a]()}:k(b[a])?function(){return b[a]()}:b[a]};for(c in a)d.call(this,c,a);jBone.extend(this,b)}var b=/^<(\w+)\s*\/?>$/,c=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,d=[].slice,e=[].splice,f=Object.keys,g=document,h=window,i=function(a){return"string"==typeof a},j=function(a){return a instanceof Object},k=function(a){return"function"==typeof a};jBone=function(a,b){return new jBone.fn.init(a,b)},jBone.fn=jBone.prototype={init:function(a,e){var f,h,l,m;if(i(a)){if(h=b.exec(a))return this[0]=g.createElement(h[1]),this.length=1,j(e)&&this.attr(e),this;if((h=c.exec(a))&&h[1]){for(m=g.createDocumentFragment(),l=g.createElement("div"),l.innerHTML=a;l.childNodes.length;)m.appendChild(l.firstChild);return f=d.call(m.childNodes),jBone.merge(this,f)}if(jBone.isElement(e))return jBone(e).find(a);try{return f=d.call(g.querySelectorAll(a)),jBone.merge(this,f)}catch(n){return this}}else{if(k(a))return a();if(a instanceof jBone)return a;if(a)return a=Array.isArray(a)?a:[a],jBone.merge(this,a)}return this},pop:[].pop,push:[].push,reverse:[].reverse,shift:[].shift,sort:[].sort,splice:[].splice,slice:[].slice,indexOf:[].indexOf,forEach:[].forEach,unshift:[].unshift,concat:[].concat,join:[].join,every:[].every,some:[].some,filter:[].filter,map:[].map,reduce:[].reduce,reduceRight:[].reduceRight,length:0},jBone.fn.constructor=jBone,jBone.fn.init.prototype=jBone.fn,jBone.setId=function(a){var b=a.jid;a===h?b="window":void 0===a.jid&&(a.jid=b=++jBone._cache.jid),jBone._cache.events[b]||(jBone._cache.events[b]={})},jBone.getData=function(a){a=a instanceof jBone?a[0]:a;var b=a===h?"window":a.jid;return{jid:b,events:jBone._cache.events[b]}},jBone.isElement=function(a){return a instanceof jBone||a instanceof HTMLElement||i(a)},jBone._cache={events:{},jid:0},jBone.merge=function(a,b){for(var c=b.length,d=a.length,e=0;c>e;)a[d++]=b[e++];return a.length=d,a},jBone.contains=function(a,b){var c;return a.some(function(a){return a.contains(b)?c=a:void 0}),c},jBone.extend=function(a){var b,c,d,g;return e.call(arguments,1).forEach(function(e){if(e)for(b=f(e),c=b.length,d=0,g=a;c>d;d++)g[b[d]]=e[b[d]]}),a},jBone.Event=function(a,b){var c,d;return a.type&&!b&&(b=a,a=a.type),c=a.split(".").splice(1).join("."),d=a.split(".")[0],a=g.createEvent("Event"),a.initEvent(d,!0,!0),jBone.extend(a,{namespace:c,isDefaultPrevented:function(){return a.defaultPrevented}},b)},jBone.fn.on=function(b){var c,d,e,f,g,h,i,j,k=arguments,l=this.length,m=0;for(2===k.length?c=k[1]:(d=k[1],c=k[2]),j=function(j){jBone.setId(j),g=jBone.getData(j).events,b.split(" ").forEach(function(b){h=b.split(".")[0],e=b.split(".").splice(1).join("."),g[h]=g[h]||[],f=function(b){b.namespace&&b.namespace!==e||(i=null,d?(~jBone(j).find(d).indexOf(b.target)||(i=jBone.contains(jBone(j).find(d),b.target)))&&(i=i||b.target,b=new a(b,{currentTarget:i}),c.call(i,b)):c.call(j,b))},g[h].push({namespace:e,fn:f,originfn:c}),j.addEventListener&&j.addEventListener(h,f,!1)})};l>m;m++)j(this[m]);return this},jBone.fn.one=function(a){var b,c,d,e=arguments,f=0,g=this.length;for(2===e.length?b=e[1]:(c=e[1],b=e[2]),d=function(d){a.split(" ").forEach(function(a){var e=function(c){jBone(d).off(a,e),b.call(d,c)};c?jBone(d).on(a,c,e):jBone(d).on(a,e)})};g>f;f++)d(this[f]);return this},jBone.fn.trigger=function(a){var b,c=[],d=0,e=this.length;if(!a)return this;for(i(a)?c=a.split(" ").map(function(a){return jBone.Event(a)}):(a=a instanceof Event?a:$.Event(a),c=[a]),b=function(a){c.forEach(function(b){b.type&&a.dispatchEvent&&a.dispatchEvent(b)})};e>d;d++)b(this[d]);return this},jBone.fn.off=function(a,b){var c,d,e,g,h,i=0,j=this.length,k=function(a){return b&&a.originfn===b?a.fn:b?void 0:a.fn};for(h=function(b){c=jBone.getData(b).events,c&&a.split(" ").forEach(function(a){g=a.split(".")[0],e=a.split(".").splice(1).join("."),c[g]?c[g].forEach(function(a){d=k(a),(!e||e&&a.namespace===e)&&b.removeEventListener(g,d)}):e&&f(c).forEach(function(a){c[a].forEach(function(c){d=k(c),c.namespace.split(".")[0]===e.split(".")[0]&&b.removeEventListener(a,d)})})})};j>i;i++)h(this[i]);return this},jBone.fn.find=function(a){var b,c=[],d=0,e=this.length;for(b=function(b){k(b.querySelectorAll)&&[].forEach.call(b.querySelectorAll(a),function(a){c.push(a)})};e>d;d++)b(this[d]);return jBone(c)},jBone.fn.get=function(a){return this[a]},jBone.fn.eq=function(a){return jBone(this[a])},jBone.fn.parent=function(){var a,b=[];return this.forEach(function(c){!~b.indexOf(a=c.parentElement)&&a&&b.push(a)}),jBone(b)},jBone.fn.toArray=function(){return d.call(this)},jBone.fn.is=function(){var a=arguments;return this.some(function(b){return b.tagName.toLowerCase()===a[0]})},jBone.fn.has=function(){var a=arguments;return this.some(function(b){return b.querySelectorAll(a[0]).length})},jBone.fn.attr=function(a,b){var c,d=arguments,e=0,g=this.length;if(i(a)&&1===d.length)return this[0].getAttribute(a);for(2===d.length?c=function(c){c.setAttribute(a,b)}:j(a)&&(c=function(b){f(a).forEach(function(c){b.setAttribute(c,a[c])})});g>e;e++)c(this[e]);return this},jBone.fn.val=function(a){var b=0,c=this.length;if(0===arguments.length)return this[0].value;for(;c>b;b++)this[b].value=a;return this},jBone.fn.css=function(a,b){var c,d=arguments,e=0,g=this.length;if(i(a)&&1===d.length)return h.getComputedStyle(this[0])[a];for(2===d.length?c=function(c){c.style[a]=b}:j(a)&&(c=function(b){f(a).forEach(function(c){b.style[c]=a[c]})});g>e;e++)c(this[e]);return this},jBone.fn.data=function(a,b){var c,d=arguments,e={},g=0,h=this.length,k=function(a,b,c){j(c)?(a.jdata=a.jdata||{},a.jdata[b]=c):a.dataset[b]=c},l=function(a){return"true"===a?!0:"false"===a?!1:a};if(0===d.length)return this[0].jdata&&(e=this[0].jdata),f(this[0].dataset).forEach(function(a){e[a]=l(this[0].dataset[a])},this),e;if(1===d.length&&i(a))return l(this[0].dataset[a]||this[0].jdata&&this[0].jdata[a]);for(1===d.length&&j(a)?c=function(b){f(a).forEach(function(c){k(b,c,a[c])})}:2===d.length&&(c=function(c){k(c,a,b)});h>g;g++)c(this[g]);return this},jBone.fn.html=function(a){var b,c=[];return void 0!==a?(this.empty().append(a),this):(b=this[0]||{},b instanceof HTMLElement&&(c=b.innerHTML),c)},jBone.fn.append=function(a){var b,d=0,e=this.length;for(i(a)&&c.exec(a)?a=jBone(a):j(a)||(a=document.createTextNode(a)),a instanceof jBone?b=function(b,c){a.forEach(function(a){c?b.appendChild(a.cloneNode()):b.appendChild(a)})}:a instanceof Node&&(b=function(b){b.appendChild(a)});e>d;d++)b(this[d]);return this},jBone.fn.appendTo=function(a){return jBone(a).append(this),this},jBone.fn.empty=function(){return this.forEach(function(a){for(;a.lastChild;)a.removeChild(a.lastChild)}),this},jBone.fn.remove=function(){return this.forEach(function(a){a.jdata={},delete jBone._cache.events[a.jid],a.parentNode&&a.parentNode.removeChild(a)}),this},"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=jBone:"function"==typeof define&&define.amd&&define("jbone",[],function(){return jBone}),"object"==typeof h&&"object"==typeof h.document&&(h.jBone=h.$=jBone)}();