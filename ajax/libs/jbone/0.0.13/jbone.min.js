/*!
 * jBone v0.0.13 - 2013-11-16 - Library for DOM manipulation
 *
 * https://github.com/kupriyanenko/jbone
 *
 * Copyright 2013 Alexey Kupriyanenko
 * Released under the MIT license.
 */

!function(a,b){"function"==typeof define&&define.amd?define(b):a.jBone=a.$=b()}(this,function(){var a=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,b=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,c=[].slice,d=document,e=window,f=function(a){return"string"==typeof a},g=function(a){return a instanceof Object},h=function(a,b){return this instanceof h?i.call(this,a,b):new h(a,b)},i=function(a,b){var c;if("function"==typeof a)a();else{if(a instanceof h)return a;Array.isArray(a)?c=a.map(function(a){return j(a,b)}):a&&(c=j(a,b))}return c instanceof h?c:c?(c=Array.isArray(c)?c:[c],h.merge(this,c),g(b)&&!h.isElement(b)&&this.attr(b),this):this},j=function(e,g){var i,j;if(f(e)&&(i=a.exec(e)))return d.createElement(i[1]);if(f(e)&&(i=b.exec(e))&&i[1])return j=d.createElement("div"),j.innerHTML=e,c.call(j.childNodes);if(f(e)){if(h.isElement(g))return h(g).find(e);try{return c.call(d.querySelectorAll(e))}catch(k){return}}return e};return h.setId=function(a){var b=a.jid||void 0;a===e?b="window":a.jid||(b=++h._cache.jid,a.jid=b),h._cache.events[b]||(h._cache.events[b]={})},h.getData=function(a){a=a instanceof h?a[0]:a;var b=a===e?"window":a.jid;return{jid:b,events:h._cache.events[b]}},h.isElement=function(a){return a instanceof h||a instanceof HTMLElement||f(a)},h._cache={events:{},jid:0},h.fn=h.prototype=[],h.merge=function(a,b){for(var c=b.length,d=a.length,e=0;c>e;)a[d++]=b[e],e++;return a.length=d,a},h.contains=function(a,b){var c,d;return c=function(a,b){return a===b?d=a:(a.parentNode&&c(a.parentNode,b),void 0)},a.forEach(function(a){c(b.parentNode,a)}),d},h.extend=function(a){return[].splice.call(arguments,1).forEach(function(b){for(var c in b)a[c]=b[c]}),a},h.Event=function(a){var b,c;return b=a.split(".").splice(1).join("."),c=a.split(".")[0],a=d.createEvent("Event"),a.initEvent(c,!0,!0),a.namespace=b,a.isDefaultPrevented=function(){return a.defaultPrevented},a},h.fn.on=function(a){var b,c,d,e,f,g,i=arguments;return 2===i.length?b=i[1]:(c=i[1],b=i[2]),this.forEach(function(i){h.setId(i),f=h.getData(i).events,a.split(" ").forEach(function(a){g=a.split(".")[0],d=a.split(".").splice(1).join("."),f[g]=f[g]?f[g]:[],e=function(a){a.namespace&&a.namespace!==d||(c?(~h(i).find(c).indexOf(a.target)||h.contains(h(i).find(c),a.target))&&b.call(a.target,a):b.call(i,a))},f[g].push({namespace:d,fn:e,originfn:b}),i.addEventListener&&i.addEventListener(g,e,!1)})}),this},h.fn.one=function(){var a,b,c=arguments[0],d=arguments;return 2===d.length?a=d[1]:(b=d[1],a=d[2]),this.forEach(function(e){c.split(" ").forEach(function(c){var f=function(b){a.call(e,b),h(e).off(c,f)};2===d.length?h(e).on(c,f):h(e).on(c,b,f)})}),this},h.fn.trigger=function(a){var b=[];return a?(b=f(a)?a.split(" ").map(function(a){return $.Event(a)}):[a],this.forEach(function(a){b.forEach(function(b){b.type&&a.dispatchEvent&&a.dispatchEvent(b)})}),this):this},h.fn.off=function(a,b){var c,d,e,f,g=function(a){return b&&a.originfn===b?a.fn:b?void 0:a.fn};return this.forEach(function(b){c=h.getData(b).events,c&&a.split(" ").forEach(function(a){f=a.split(".")[0],e=a.split(".").splice(1).join("."),c[f]?c[f].forEach(function(a){d=g(a),(!e||e&&a.namespace===e)&&b.removeEventListener(f,d)}):e&&Object.keys(c).forEach(function(a){c[a].forEach(function(c){d=g(c),c.namespace===e&&b.removeEventListener(a,d)})})})}),this},h.fn.find=function(a){var b=[];return this.forEach(function(c){[].forEach.call(c.querySelectorAll(a),function(a){b.push(a)})}),h(b)},h.fn.get=function(a){return this[a]},h.fn.eq=function(a){return h(this[a])},h.fn.parent=function(){var a,b=[];return this.forEach(function(c){~b.indexOf(a=c.parentNode)||b.push(a)}),h(b)},h.fn.toArray=function(){return c.call(this)},h.fn.is=function(){var a=arguments;return this.some(function(b){return b.tagName.toLowerCase()===a[0]})},h.fn.has=function(){var a=arguments;return this.some(function(b){return b.querySelectorAll(a[0]).length})},h.fn.attr=function(){var a=arguments;return f(a[0])&&1===a.length?this[0].getAttribute(a[0]):(2===a.length?this.forEach(function(b){b.setAttribute(a[0],a[1])}):g(a[0])&&this.forEach(function(b){Object.keys(a[0]).forEach(function(c){b.setAttribute(c,a[0][c])})}),this)},h.fn.val=function(a){return 0===arguments.length?this[0].value:(this.forEach(function(b){b.value=a}),this)},h.fn.css=function(){var a=arguments;return f(a[0])&&1===a.length?e.getComputedStyle(this[0])[a[0]]:(2===a.length?this.forEach(function(b){b.style[a[0]]=a[1]}):g(a[0])&&this.forEach(function(b){Object.keys(a[0]).forEach(function(c){b.style[c]=a[0][c]})}),this)},h.fn.data=function(a,b){var c=arguments,d=function(a,b,c){g(c)?(a.jdata=a.jdata||{},a.jdata[b]=c):a.dataset[b]=c};if(0===c.length)return h.extend({},this[0].dataset,this[0].jdata);if(1===c.length){if(f(a))return this[0].dataset[a]||this[0].jdata&&this[0].jdata[a];g(a)&&Object.keys(a).forEach(function(b){this.forEach(function(c){d(c,b,a[b])})},this)}else 2===c.length&&this.forEach(function(c){d(c,a,b)});return this},h.fn.html=function(a){var c=[];return void 0!==a?(this.empty.call(this),g(a)||b.exec(a)?this.append.call(this,a):this.forEach(function(b){b instanceof HTMLElement&&(b.innerHTML=a)}),this):(this.forEach(function(a){a instanceof HTMLElement&&c.push(a.innerHTML)}),c.length?c.join(""):null)},h.fn.append=function(a){return f(a)&&(a=h(a)),a instanceof h?this.forEach(function(b,c){a.forEach(function(a){c?b.appendChild(a.cloneNode()):b.appendChild(a)})}):(a instanceof HTMLElement||a instanceof DocumentFragment)&&this.forEach(function(b){b.appendChild(a)}),this},h.fn.appendTo=function(a){return h(a).append(this),this},h.fn.empty=function(){return this.forEach(function(a){for(;a.hasChildNodes();)a.removeChild(a.lastChild)}),this},h.fn.remove=function(){return this.forEach(function(a){a.parentNode&&a.parentNode.removeChild(a)}),this},e.jBone=e.$=h,h});