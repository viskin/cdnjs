/*!
 * jBone v0.0.15 - 2013-11-18 - Library for DOM manipulation
 *
 * https://github.com/kupriyanenko/jbone
 *
 * Copyright 2013 Alexey Kupriyanenko
 * Released under the MIT license.
 */

!function(a,b){"function"==typeof define&&define.amd?define(b):a.jBone=a.$=b()}(this,function(){function a(a,b){var c,d;this.originalEvent=a,d=function(a,b){this[a]="preventDefault"===a?function(){return this.defaultPrevented=!0,b[a]()}:"function"==typeof b[a]?function(){return b[a]()}:b[a]};for(c in a)d.call(this,c,a);j.extend(this,b)}var b=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,c=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,d=[].slice,e=Object.keys,f=document,g=window,h=function(a){return"string"==typeof a},i=function(a){return a instanceof Object},j=function(a,b){return this instanceof j?k.call(this,a,b):new j(a,b)},k=function(a,b){var c;if("function"==typeof a)a();else{if(a instanceof j)return a;Array.isArray(a)?c=a.map(function(a){return l(a,b)}):a&&(c=l(a,b))}return c instanceof j?c:c?(c=Array.isArray(c)?c:[c],j.merge(this,c),i(b)&&!j.isElement(b)&&this.attr(b),this):this},l=function(a,e){var g,i,k=f.createDocumentFragment();if(h(a)&&(g=b.exec(a)))return f.createElement(g[1]);if(h(a)&&(g=c.exec(a))&&g[1]){for(i=f.createElement("div"),i.innerHTML=a;i.childNodes.length;)k.appendChild(i.firstChild);return d.call(k.childNodes)}if(h(a)){if(j.isElement(e))return j(e).find(a);try{return d.call(f.querySelectorAll(a))}catch(l){return}}return a};return j.setId=function(a){var b=a.jid;a===g?b="window":void 0===a.jid&&(a.jid=b=++j._cache.jid),j._cache.events[b]||(j._cache.events[b]={})},j.getData=function(a){a=a instanceof j?a[0]:a;var b=a===g?"window":a.jid;return{jid:b,events:j._cache.events[b]}},j.isElement=function(a){return a instanceof j||a instanceof HTMLElement||h(a)},j._cache={events:{},jid:0},j.fn=j.prototype=[],j.merge=function(a,b){for(var c=b.length,d=a.length,e=0;c>e;)a[d++]=b[e++];return a.length=d,a},j.contains=function(a,b){var c;return a.some(function(d){return d.contains(b)?c=a:void 0}),c},j.extend=function(a){return[].splice.call(arguments,1).forEach(function(b){for(var c in b)a[c]=b[c]}),a},j.Event=function(a,b){var c,d;return a.type&&!b&&(b=a,a=a.type),c=a.split(".").splice(1).join("."),d=a.split(".")[0],a=f.createEvent("Event"),a.initEvent(d,!0,!0),j.extend(a,{namespace:c,isDefaultPrevented:function(){return a.defaultPrevented}},b)},j.fn.on=function(b){var c,d,e,f,g,h,i,k=arguments;return 2===k.length?c=k[1]:(d=k[1],c=k[2]),this.forEach(function(k){j.setId(k),g=j.getData(k).events,b.split(" ").forEach(function(b){h=b.split(".")[0],e=b.split(".").splice(1).join("."),g[h]=g[h]||[],f=function(b){b.namespace&&b.namespace!==e||(d?(~j(k).find(d).indexOf(b.target)||j.contains(i=j(k).find(d),b.target))&&(b=new a(b,{currentTarget:i?i[0]:b.target}),c.call(i,b)):c.call(k,b))},g[h].push({namespace:e,fn:f,originfn:c}),k.addEventListener&&k.addEventListener(h,f,!1)})}),this},j.fn.one=function(){var a,b,c=arguments[0],d=arguments;return 2===d.length?a=d[1]:(b=d[1],a=d[2]),this.forEach(function(d){c.split(" ").forEach(function(c){var e=function(b){j(d).off(c,e),a.call(d,b)};b?j(d).on(c,b,e):j(d).on(c,e)})}),this},j.fn.trigger=function(b){var c=[];return b?(h(b)?c=b.split(" ").map(function(a){return j.Event(a)}):(b=b instanceof a?b:$.Event(b),c=[b]),this.forEach(function(a){c.forEach(function(b){b.type&&a.dispatchEvent&&a.dispatchEvent(b)})}),this):this},j.fn.off=function(a,b){var c,d,f,g,h=function(a){return b&&a.originfn===b?a.fn:b?void 0:a.fn};return this.forEach(function(b){c=j.getData(b).events,c&&a.split(" ").forEach(function(a){g=a.split(".")[0],f=a.split(".").splice(1).join("."),c[g]?c[g].forEach(function(a){d=h(a),(!f||f&&a.namespace===f)&&b.removeEventListener(g,d)}):f&&e(c).forEach(function(a){c[a].forEach(function(c){d=h(c),c.namespace.split(".")[0]===f.split(".")[0]&&b.removeEventListener(a,d)})})})}),this},j.fn.find=function(a){var b=[];return this.forEach(function(c){try{[].forEach.call(c.querySelectorAll(a),function(a){b.push(a)})}catch(d){}}),j(b)},j.fn.get=function(a){return this[a]},j.fn.eq=function(a){return j(this[a])},j.fn.parent=function(){var a,b=[];return this.forEach(function(c){!~b.indexOf(a=c.parentElement)&&a&&b.push(a)}),j(b)},j.fn.toArray=function(){return d.call(this)},j.fn.is=function(){var a=arguments;return this.some(function(b){return b.tagName.toLowerCase()===a[0]})},j.fn.has=function(){var a=arguments;return this.some(function(b){return b.querySelectorAll(a[0]).length})},j.fn.attr=function(a,b){var c,d=arguments;return h(a)&&1===d.length?this[0].getAttribute(a):(2===d.length?c=function(c){c.setAttribute(a,b)}:i(a)&&(c=function(b){e(a).forEach(function(c){b.setAttribute(c,a[c])})}),this.forEach(c),this)},j.fn.val=function(a){return 0===arguments.length?this[0].value:(this.forEach(function(b){b.value=a}),this)},j.fn.css=function(a,b){var c,d=arguments;return h(a)&&1===d.length?g.getComputedStyle(this[0])[a]:(2===d.length?c=function(c){c.style[a]=b}:i(a)&&(c=function(b){e(a).forEach(function(c){b.style[c]=a[c]})}),this.forEach(c),this)},j.fn.data=function(a,b){var c,d=arguments,f={},g=function(a,b,c){i(c)?(a.jdata=a.jdata||{},a.jdata[b]=c):a.dataset[b]=c},j=function(a){return"true"===a?!0:"false"===a?!1:a};return 0===d.length?(this[0].jdata&&(f=this[0].jdata),e(this[0].dataset).forEach(function(a){f[a]=j(this[0].dataset[a])},this),f):1===d.length&&h(a)?j(this[0].dataset[a]||this[0].jdata&&this[0].jdata[a]):(1===d.length&&i(a)?c=function(b){e(a).forEach(function(c){g(b,c,a[c])})}:2===d.length&&(c=function(c){g(c,a,b)}),this.forEach(c),this)},j.fn.html=function(a){var b,c=[];return void 0!==a?(this.empty().append(a),this):(b=this[0]||{},b instanceof HTMLElement&&(c=b.innerHTML),c)},j.fn.append=function(a){var b;return h(a)&&c.exec(a)?a=j(a):i(a)||(a=document.createTextNode(a)),a instanceof j?b=function(b,c){a.forEach(function(a){c?b.appendChild(a.cloneNode()):b.appendChild(a)})}:a instanceof Node&&(b=function(b){b.appendChild(a)}),this.forEach(b),this},j.fn.appendTo=function(a){return j(a).append(this),this},j.fn.empty=function(){return this.forEach(function(a){for(;a.hasChildNodes();)a.removeChild(a.lastChild)}),this},j.fn.remove=function(){return this.forEach(function(a){a.jdata={},a.parentNode&&a.parentNode.removeChild(a)}),this},g.jBone=g.$=j,j});