/*!
 * jBone v0.0.14 - 2013-11-18 - Library for DOM manipulation
 *
 * https://github.com/kupriyanenko/jbone
 *
 * Copyright 2013 Alexey Kupriyanenko
 * Released under the MIT license.
 */

!function(a,b){"function"==typeof define&&define.amd?define(b):a.jBone=a.$=b()}(this,function(){var a=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,b=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,c=[].slice,d=Object.keys,e=document,f=window,g=function(a){return"string"==typeof a},h=function(a){return a instanceof Object},i=function(a,b){return this instanceof i?j.call(this,a,b):new i(a,b)},j=function(a,b){var c;if("function"==typeof a)a();else{if(a instanceof i)return a;Array.isArray(a)?c=a.map(function(a){return k(a,b)}):a&&(c=k(a,b))}return c instanceof i?c:c?(c=Array.isArray(c)?c:[c],i.merge(this,c),h(b)&&!i.isElement(b)&&this.attr(b),this):this},k=function(d,f){var h,j,k=e.createDocumentFragment();if(g(d)&&(h=a.exec(d)))return e.createElement(h[1]);if(g(d)&&(h=b.exec(d))&&h[1]){for(j=e.createElement("div"),j.innerHTML=d;j.childNodes.length;)k.appendChild(j.firstChild);return c.call(k.childNodes)}if(g(d)){if(i.isElement(f))return i(f).find(d);try{return c.call(e.querySelectorAll(d))}catch(l){return}}return d};return i.setId=function(a){var b=a.jid;a===f?b="window":void 0===a.jid&&(a.jid=b=++i._cache.jid),i._cache.events[b]||(i._cache.events[b]={})},i.getData=function(a){a=a instanceof i?a[0]:a;var b=a===f?"window":a.jid;return{jid:b,events:i._cache.events[b]}},i.isElement=function(a){return a instanceof i||a instanceof HTMLElement||g(a)},i._cache={events:{},jid:0},i.fn=i.prototype=[],i.merge=function(a,b){for(var c=b.length,d=a.length,e=0;c>e;)a[d++]=b[e],e++;return a.length=d,a},i.contains=function(a,b){var c;return a.some(function(d){return d.contains(b)?c=a:void 0}),c},i.extend=function(a){return[].splice.call(arguments,1).forEach(function(b){for(var c in b)a[c]=b[c]}),a},i.Event=function(a,b){var c,d;return a.type&&!b&&(b=a,a=a.type),c=a.split(".").splice(1).join("."),d=a.split(".")[0],a=e.createEvent("Event"),a.initEvent(d,!0,!0),i.extend(a,{namespace:c,isDefaultPrevented:function(){return a.defaultPrevented}},b)},i.fn.on=function(a){var b,c,d,e,f,g,h=arguments;return 2===h.length?b=h[1]:(c=h[1],b=h[2]),this.forEach(function(h){i.setId(h),f=i.getData(h).events,a.split(" ").forEach(function(a){g=a.split(".")[0],d=a.split(".").splice(1).join("."),f[g]=f[g]||[],e=function(a){a.namespace&&a.namespace!==d||(c?(~i(h).find(c).indexOf(a.target)||i.contains(i(h).find(c),a.target))&&b.call(a.target,a):b.call(h,a))},f[g].push({namespace:d,fn:e,originfn:b}),h.addEventListener&&h.addEventListener(g,e,!1)})}),this},i.fn.one=function(){var a,b,c=arguments[0],d=arguments;return 2===d.length?a=d[1]:(b=d[1],a=d[2]),this.forEach(function(d){c.split(" ").forEach(function(c){var e=function(b){i(d).off(c,e),a.call(d,b)};b?i(d).on(c,b,e):i(d).on(c,e)})}),this},i.fn.trigger=function(a){var b=[];return a?(g(a)?b=a.split(" ").map(function(a){return i.Event(a)}):(a=a instanceof Event?a:$.Event(a),b=[a]),this.forEach(function(a){b.forEach(function(b){b.type&&a.dispatchEvent&&a.dispatchEvent(b)})}),this):this},i.fn.off=function(a,b){var c,e,f,g,h=function(a){return b&&a.originfn===b?a.fn:b?void 0:a.fn};return this.forEach(function(b){c=i.getData(b).events,c&&a.split(" ").forEach(function(a){g=a.split(".")[0],f=a.split(".").splice(1).join("."),c[g]?c[g].forEach(function(a){e=h(a),(!f||f&&a.namespace===f)&&b.removeEventListener(g,e)}):f&&d(c).forEach(function(a){c[a].forEach(function(c){e=h(c),c.namespace.split(".")[0]===f.split(".")[0]&&b.removeEventListener(a,e)})})})}),this},i.fn.find=function(a){var b=[];return this.forEach(function(c){try{[].forEach.call(c.querySelectorAll(a),function(a){b.push(a)})}catch(d){}}),i(b)},i.fn.get=function(a){return this[a]},i.fn.eq=function(a){return i(this[a])},i.fn.parent=function(){var a,b=[];return this.forEach(function(c){!~b.indexOf(a=c.parentElement)&&a&&b.push(a)}),i(b)},i.fn.toArray=function(){return c.call(this)},i.fn.is=function(){var a=arguments;return this.some(function(b){return b.tagName.toLowerCase()===a[0]})},i.fn.has=function(){var a=arguments;return this.some(function(b){return b.querySelectorAll(a[0]).length})},i.fn.attr=function(a,b){var c,e=arguments;return g(a)&&1===e.length?this[0].getAttribute(a):(2===e.length?c=function(c){c.setAttribute(a,b)}:h(a)&&(c=function(b){d(a).forEach(function(c){b.setAttribute(c,a[c])})}),this.forEach(c),this)},i.fn.val=function(a){return 0===arguments.length?this[0].value:(this.forEach(function(b){b.value=a}),this)},i.fn.css=function(a,b){var c,e=arguments;return g(a)&&1===e.length?f.getComputedStyle(this[0])[a]:(2===e.length?c=function(c){c.style[a]=b}:h(a)&&(c=function(b){d(a).forEach(function(c){b.style[c]=a[c]})}),this.forEach(c),this)},i.fn.data=function(a,b){var c,e=arguments,f={},i=function(a,b,c){h(c)?(a.jdata=a.jdata||{},a.jdata[b]=c):a.dataset[b]=c},j=function(a){return"true"===a?!0:"false"===a?!1:a};return 0===e.length?(this[0].jdata&&(f=this[0].jdata),d(this[0].dataset).forEach(function(a){f[a]=j(this[0].dataset[a])},this),f):1===e.length&&g(a)?j(this[0].dataset[a]||this[0].jdata&&this[0].jdata[a]):(1===e.length&&h(a)?c=function(b){d(a).forEach(function(c){i(b,c,a[c])})}:2===e.length&&(c=function(c){i(c,a,b)}),this.forEach(c),this)},i.fn.html=function(a){var b=[];return void 0!==a?(this.empty().append(a),this):(this.forEach(function(a){a instanceof HTMLElement&&b.push(a.innerHTML)}),b.length?b.join(""):null)},i.fn.append=function(a){var c;return g(a)&&b.exec(a)?a=i(a):h(a)||(a=document.createTextNode(a)),a instanceof i?c=function(b,c){a.forEach(function(a){c?b.appendChild(a.cloneNode()):b.appendChild(a)})}:a instanceof Node&&(c=function(b){b.appendChild(a)}),this.forEach(c),this},i.fn.appendTo=function(a){return i(a).append(this),this},i.fn.empty=function(){return this.forEach(function(a){for(;a.hasChildNodes();)a.removeChild(a.lastChild)}),this},i.fn.remove=function(){return this.forEach(function(a){a.jdata={},a.parentNode&&a.parentNode.removeChild(a)}),this},f.jBone=f.$=i,i});