/*!
 * jBone v1.0.11 - 2014-05-03 - Library for DOM manipulation
 *
 * https://github.com/kupriyanenko/jbone
 *
 * Copyright 2014 Alexey Kupriyanenko
 * Released under the MIT license.
 */

!function(a){function b(a,b){var c,d;this.originalEvent=a,d=function(a,b){this[a]="preventDefault"===a?function(){return this.defaultPrevented=!0,b[a]()}:n(b[a])?function(){return b[a]()}:b[a]};for(c in a)(a.hasOwnProperty(c)||"function"==typeof a[c])&&d.call(this,c,a);o.extend(this,b)}var c,d=a.$,e=a.jBone,f=/^<(\w+)\s*\/?>$/,g=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,h=[].slice,i=[].splice,j=Object.keys,k=document,l=function(a){return"string"==typeof a},m=function(a){return a instanceof Object},n=function(a){return"function"==typeof a},o=function(a,b){return new c.init(a,b)};o.noConflict=function(){return a.$=d,a.jBone=e,o},c=o.fn=o.prototype={init:function(a,b){var c,d,e,i;if(!a)return this;if(l(a)){if(d=f.exec(a))return this[0]=k.createElement(d[1]),this.length=1,m(b)&&this.attr(b),this;if((d=g.exec(a))&&d[1]){for(i=k.createDocumentFragment(),e=k.createElement("div"),e.innerHTML=a;e.lastChild;)i.appendChild(e.firstChild);return c=h.call(i.childNodes),o.merge(this,c)}if(o.isElement(b))return o(b).find(a);try{return c=k.querySelectorAll(a),o.merge(this,c)}catch(j){return this}}return a.nodeType?(this[0]=a,this.length=1,this):n(a)?a():a instanceof o?a:a?(a=Array.isArray(a)?a:[a],o.merge(this,a)):this},pop:[].pop,push:[].push,reverse:[].reverse,shift:[].shift,sort:[].sort,splice:[].splice,slice:[].slice,indexOf:[].indexOf,forEach:[].forEach,unshift:[].unshift,concat:[].concat,join:[].join,every:[].every,some:[].some,filter:[].filter,map:[].map,reduce:[].reduce,reduceRight:[].reduceRight,length:0},c.constructor=o,c.init.prototype=c,o.setId=function(b){var c=b.jid;b===a?c="window":void 0===b.jid&&(b.jid=c=++o._cache.jid),o._cache.events[c]||(o._cache.events[c]={})},o.getData=function(b){b=b instanceof o?b[0]:b;var c=b===a?"window":b.jid;return{jid:c,events:o._cache.events[c]}},o.isElement=function(a){return a&&a instanceof o||a instanceof HTMLElement||l(a)},o._cache={events:{},jid:0},o.merge=function(a,b){for(var c=b.length,d=a.length,e=0;c>e;)a[d++]=b[e++];return a.length=d,a},o.contains=function(a,b){var c;return a.reverse().some(function(a){return a.contains(b)?c=a:void 0}),c},o.extend=function(a){var b,c,d,e;return i.call(arguments,1).forEach(function(f){if(f)for(b=j(f),c=b.length,d=0,e=a;c>d;d++)e[b[d]]=f[b[d]]}),a},o.Event=function(a,b){var c,d;return a.type&&!b&&(b=a,a=a.type),c=a.split(".").splice(1).join("."),d=a.split(".")[0],a=k.createEvent("Event"),a.initEvent(d,!0,!0),o.extend(a,{namespace:c,isDefaultPrevented:function(){return a.defaultPrevented}},b)},c.on=function(a){var c,d,e,f,g,h,i,j,k=arguments,l=this.length,m=0;for(2===k.length?c=k[1]:(d=k[1],c=k[2]),j=function(j){o.setId(j),g=o.getData(j).events,a.split(" ").forEach(function(a){h=a.split(".")[0],e=a.split(".").splice(1).join("."),g[h]=g[h]||[],f=function(a){a.namespace&&a.namespace!==e||(i=null,d?(~o(j).find(d).indexOf(a.target)||(i=o.contains(o(j).find(d),a.target)))&&(i=i||a.target,a=new b(a,{currentTarget:i}),c.call(i,a)):c.call(j,a))},g[h].push({namespace:e,fn:f,originfn:c}),j.addEventListener&&j.addEventListener(h,f,!1)})};l>m;m++)j(this[m]);return this},c.one=function(a){var b,c,d,e=arguments,f=0,g=this.length;for(2===e.length?b=e[1]:(c=e[1],b=e[2]),d=function(d){a.split(" ").forEach(function(a){var e=function(c){o(d).off(a,e),b.call(d,c)};c?o(d).on(a,c,e):o(d).on(a,e)})};g>f;f++)d(this[f]);return this},c.trigger=function(a){var b,c=[],d=0,e=this.length;if(!a)return this;for(l(a)?c=a.split(" ").map(function(a){return o.Event(a)}):(a=a instanceof Event?a:$.Event(a),c=[a]),b=function(a){c.forEach(function(b){b.type&&a.dispatchEvent&&a.dispatchEvent(b)})};e>d;d++)b(this[d]);return this},c.off=function(a,b){var c,d,e,f,g=0,h=this.length,i=function(a,c,d,e,f){var g;(b&&f.originfn===b||!b)&&(g=f.fn),a[c][d].fn===g&&(e.removeEventListener(c,g),o._cache.events[o.getData(e).jid][c].splice(d,1))};for(e=function(b){return(c=o.getData(b).events)?!a&&c?j(c).forEach(function(a){c[a].forEach(function(d,e){i(c,a,e,b,d)})}):void a.split(" ").forEach(function(a){f=a.split(".")[0],d=a.split(".").splice(1).join("."),c[f]?c[f].forEach(function(a,e){(!d||d&&a.namespace===d)&&i(c,f,e,b,a)}):d&&j(c).forEach(function(a){c[a].forEach(function(e,f){e.namespace.split(".")[0]===d.split(".")[0]&&i(c,a,f,b,e)})})}):void 0};h>g;g++)e(this[g]);return this},c.find=function(a){for(var b=[],c=0,d=this.length,e=function(c){n(c.querySelectorAll)&&[].forEach.call(c.querySelectorAll(a),function(a){b.push(a)})};d>c;c++)e(this[c]);return o(b)},c.get=function(a){return this[a]},c.eq=function(a){return o(this[a])},c.parent=function(){for(var a,b=[],c=0,d=this.length;d>c;c++)!~b.indexOf(a=this[c].parentElement)&&a&&b.push(a);return o(b)},c.toArray=function(){return h.call(this)},c.is=function(){var a=arguments;return this.some(function(b){return b.tagName.toLowerCase()===a[0]})},c.has=function(){var a=arguments;return this.some(function(b){return b.querySelectorAll(a[0]).length})},c.attr=function(a,b){var c,d=arguments,e=0,f=this.length;if(l(a)&&1===d.length)return this[0]&&this[0].getAttribute(a);for(2===d.length?c=function(c){c.setAttribute(a,b)}:m(a)&&(c=function(b){j(a).forEach(function(c){b.setAttribute(c,a[c])})});f>e;e++)c(this[e]);return this},c.val=function(a){var b=0,c=this.length;if(0===arguments.length)return this[0]&&this[0].value;for(;c>b;b++)this[b].value=a;return this},c.css=function(b,c){var d,e=arguments,f=0,g=this.length;if(l(b)&&1===e.length)return this[0]&&a.getComputedStyle(this[0])[b];for(2===e.length?d=function(a){a.style[b]=c}:m(b)&&(d=function(a){j(b).forEach(function(c){a.style[c]=b[c]})});g>f;f++)d(this[f]);return this},c.data=function(a,b){var c,d=arguments,e={},f=0,g=this.length,h=function(a,b,c){m(c)?(a.jdata=a.jdata||{},a.jdata[b]=c):a.dataset[b]=c},i=function(a){return"true"===a?!0:"false"===a?!1:a};if(0===d.length)return this[0].jdata&&(e=this[0].jdata),j(this[0].dataset).forEach(function(a){e[a]=i(this[0].dataset[a])},this),e;if(1===d.length&&l(a))return this[0]&&i(this[0].dataset[a]||this[0].jdata&&this[0].jdata[a]);for(1===d.length&&m(a)?c=function(b){j(a).forEach(function(c){h(b,c,a[c])})}:2===d.length&&(c=function(c){h(c,a,b)});g>f;f++)c(this[f]);return this},c.html=function(a){var b,c=arguments;return 1===c.length&&void 0!==a?this.empty().append(a):0===c.length&&(b=this[0])?b.innerHTML:this},c.append=function(a){var b,c=0,d=this.length;for(l(a)&&g.exec(a)?a=o(a):m(a)||(a=document.createTextNode(a)),a instanceof o?b=function(b,c){a.forEach(function(a){b.appendChild(c?a.cloneNode():a)})}:a instanceof Node&&(b=function(b){b.appendChild(a)});d>c;c++)b(this[c],c);return this},c.appendTo=function(a){return o(a).append(this),this},c.empty=function(){for(var a,b=0,c=this.length;c>b;b++)for(a=this[b];a.lastChild;)a.removeChild(a.lastChild);return this},c.remove=function(){var a,b=0,c=this.length;for(this.off();c>b;b++)a=this[b],delete a.jdata,a.parentNode&&a.parentNode.removeChild(a);return this},"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=o:"function"==typeof define&&define.amd?(define(function(){return o}),a.jBone=a.$=o):"object"==typeof a&&"object"==typeof a.document&&(a.jBone=a.$=o)}(window);