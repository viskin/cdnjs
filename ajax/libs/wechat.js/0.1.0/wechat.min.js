/*! CopyRight: sofish http://github.com/sofish/wechat.js, Licensed under: MIT */
;(function(d,f){var c=function(){};var b=function(){this.calls=[];this.map={events:{friend:"menu:share:appmessage",timeline:"menu:share:timeline",weibo:"menu:share:weibo"},actions:{friend:"sendAppMessage",timeline:"shareTimeline",weibo:"shareWeibo"},direct:{network:"getNetworkType",hideToolbar:"hideToolbar",hideOptionMenu:"hideOptionMenu",showOptionMenu:"showOptionMenu"}}};b.prototype._data=function(h){var g={};for(var i in h){if(!h.hasOwnProperty(i)){return}g[i]=(typeof h[i]==="function")?h[i]():h[i]}g.appid=g.app;g.img_url=g.img;delete g.app;delete g.img;return g};b.prototype._make=function(j){if(typeof WeixinJSBridge==="undefined"){return this.calls.push(j)}var g=j.name,l=this.map.direct[g],i=j.data,k=j.callback;if(l){if(g==="network"){return WeixinJSBridge.invoke(l,{},k)}return WeixinJSBridge.call(l,k)}if(g==="weibo"){i.content=i.desc;i.url=i.link}else{if(g==="timeline"){i.title=i.title+" - "+i.desc;i.desc=i.title}}var h=this;WeixinJSBridge.on(this.map.events[g],function(){WeixinJSBridge.invoke(h.map.actions[g],i,k)})};b.prototype.on=function(g,h,i){if(!g){return}if(typeof h==="function"){i=h;h=null}this._make({name:g,data:h?this._data(h):{},callback:i||c});return this};var a=function(){for(var h=0,g=e.calls.length;h<g;h++){e._make(e.calls[h])}};var e=new b();d.wechat=d.wechat||function(){return e.on.apply(e,arguments)};if(typeof WeixinJSBridge==="undefined"){if(f.addEventListener){f.addEventListener("WeixinJSBridgeReady",a,false)}else{f.attachEvent("WeixinJSBridgeReady",a);f.attachEvent("onWeixinJSBridgeReady",a)}}else{a()}})(window,document);