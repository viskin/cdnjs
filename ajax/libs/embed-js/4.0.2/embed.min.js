/*
 *  embed-js - v4.0.2
 *  A JavaScript plugin that analyses the string and embeds emojis, media, tweets, code and services.
 *  http://riteshkr.com/embed.js
 *
 *  Made by Ritesh Kumar
 *  Under MIT License
 */
!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.EmbedJS=b()}(this,function(){"use strict";function a(a,b){return b={exports:{}},a(b,b.exports,E),b.exports}function b(a,b){return a.substr(0,b-1)+(a.length>b?"...":"")}function c(a){return-1===a.indexOf("//")?"//"+a:a}function d(a,b){for(var c in b)b.hasOwnProperty(c)&&b[c]&&b[c].constructor===Object?(a[c]=a[c]||{},d(a[c],b[c])):a[c]=b[c];return a}function e(a){return a.replace(/[\-\[\]\/\{}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function f(a){return a.sort(function(a,b){return a.index-b.index})}function g(a,b){for(var c=f(b),d=0;d<c.length;d++)a+=" "+c[d].text;return a}function h(a,b){return a.exec(b)}function i(a,b){return a.singleEmbed&&a.served.length?void 0:-1==a.excludeEmbed.indexOf(b)&&!("all"===a.excludeEmbed)}function j(a,b){return a.inlineEmbed.indexOf(b)>=0||"all"===a.inlineEmbed}function k(a){return a.videoWidth=a.videoWidth||a.videoHeight/3*4||800,a.videoHeight=a.videoHeight||a.videoWidth/4*3||600,a}function l(a){if(null===a||"object"!==("undefined"==typeof a?"undefined":F["typeof"](a)))return a;var b=a.constructor();for(var c in a)b[c]=l(a[c]);return b}function m(){return/((href|src)=["']|)(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])|(?:https?:\/\/)?(?:(?:0rz\.tw)|(?:1link\.in)|(?:1url\.com)|(?:2\.gp)|(?:2big\.at)|(?:2tu\.us)|(?:3\.ly)|(?:307\.to)|(?:4ms\.me)|(?:4sq\.com)|(?:4url\.cc)|(?:6url\.com)|(?:7\.ly)|(?:a\.gg)|(?:a\.nf)|(?:aa\.cx)|(?:abcurl\.net)|(?:ad\.vu)|(?:adf\.ly)|(?:adjix\.com)|(?:afx\.cc)|(?:all\.fuseurl.com)|(?:alturl\.com)|(?:amzn\.to)|(?:ar\.gy)|(?:arst\.ch)|(?:atu\.ca)|(?:azc\.cc)|(?:b23\.ru)|(?:b2l\.me)|(?:bacn\.me)|(?:bcool\.bz)|(?:binged\.it)|(?:bit\.ly)|(?:buff\.ly)|(?:bizj\.us)|(?:bloat\.me)|(?:bravo\.ly)|(?:bsa\.ly)|(?:budurl\.com)|(?:canurl\.com)|(?:chilp\.it)|(?:chzb\.gr)|(?:cl\.lk)|(?:cl\.ly)|(?:clck\.ru)|(?:cli\.gs)|(?:cliccami\.info)|(?:clickthru\.ca)|(?:clop\.in)|(?:conta\.cc)|(?:cort\.as)|(?:cot\.ag)|(?:crks\.me)|(?:ctvr\.us)|(?:cutt\.us)|(?:dai\.ly)|(?:decenturl\.com)|(?:dfl8\.me)|(?:digbig\.com)|(?:digg\.com)|(?:disq\.us)|(?:dld\.bz)|(?:dlvr\.it)|(?:do\.my)|(?:doiop\.com)|(?:dopen\.us)|(?:easyuri\.com)|(?:easyurl\.net)|(?:eepurl\.com)|(?:eweri\.com)|(?:fa\.by)|(?:fav\.me)|(?:fb\.me)|(?:fbshare\.me)|(?:ff\.im)|(?:fff\.to)|(?:fire\.to)|(?:firsturl\.de)|(?:firsturl\.net)|(?:flic\.kr)|(?:flq\.us)|(?:fly2\.ws)|(?:fon\.gs)|(?:freak\.to)|(?:fuseurl\.com)|(?:fuzzy\.to)|(?:fwd4\.me)|(?:fwib\.net)|(?:g\.ro.lt)|(?:gizmo\.do)|(?:gl\.am)|(?:go\.9nl.com)|(?:go\.ign.com)|(?:go\.usa.gov)|(?:goo\.gl)|(?:goshrink\.com)|(?:gurl\.es)|(?:hex\.io)|(?:hiderefer\.com)|(?:hmm\.ph)|(?:href\.in)|(?:hsblinks\.com)|(?:htxt\.it)|(?:huff\.to)|(?:hulu\.com)|(?:hurl\.me)|(?:hurl\.ws)|(?:icanhaz\.com)|(?:idek\.net)|(?:ilix\.in)|(?:is\.gd)|(?:its\.my)|(?:ix\.lt)|(?:j\.mp)|(?:jijr\.com)|(?:kl\.am)|(?:klck\.me)|(?:korta\.nu)|(?:krunchd\.com)|(?:l9k\.net)|(?:lat\.ms)|(?:liip\.to)|(?:liltext\.com)|(?:linkbee\.com)|(?:linkbun\.ch)|(?:liurl\.cn)|(?:ln-s\.net)|(?:ln-s\.ru)|(?:lnk\.gd)|(?:lnk\.ms)|(?:lnkd\.in)|(?:lnkurl\.com)|(?:lru\.jp)|(?:lt\.tl)|(?:lurl\.no)|(?:macte\.ch)|(?:mash\.to)|(?:merky\.de)|(?:migre\.me)|(?:miniurl\.com)|(?:minurl\.fr)|(?:mke\.me)|(?:moby\.to)|(?:moourl\.com)|(?:mrte\.ch)|(?:myloc\.me)|(?:myurl\.in)|(?:n\.pr)|(?:nbc\.co)|(?:nblo\.gs)|(?:nn\.nf)|(?:not\.my)|(?:notlong\.com)|(?:nsfw\.in)|(?:nutshellurl\.com)|(?:nxy\.in)|(?:nyti\.ms)|(?:o-x\.fr)|(?:oc1\.us)|(?:om\.ly)|(?:omf\.gd)|(?:omoikane\.net)|(?:on\.cnn.com)|(?:on\.mktw.net)|(?:onforb\.es)|(?:orz\.se)|(?:ow\.ly)|(?:ping\.fm)|(?:pli\.gs)|(?:pnt\.me)|(?:politi\.co)|(?:post\.ly)|(?:pp\.gg)|(?:profile\.to)|(?:ptiturl\.com)|(?:pub\.vitrue.com)|(?:qlnk\.net)|(?:qte\.me)|(?:qu\.tc)|(?:qy\.fi)|(?:r\.im)|(?:rb6\.me)|(?:read\.bi)|(?:readthis\.ca)|(?:reallytinyurl\.com)|(?:redir\.ec)|(?:redirects\.ca)|(?:redirx\.com)|(?:retwt\.me)|(?:ri\.ms)|(?:rickroll\.it)|(?:riz\.gd)|(?:rt\.nu)|(?:ru\.ly)|(?:rubyurl\.com)|(?:rurl\.org)|(?:rww\.tw)|(?:s4c\.in)|(?:s7y\.us)|(?:safe\.mn)|(?:sameurl\.com)|(?:sdut\.us)|(?:shar\.es)|(?:shink\.de)|(?:shorl\.com)|(?:short\.ie)|(?:short\.to)|(?:shortlinks\.co.uk)|(?:shorturl\.com)|(?:shout\.to)|(?:show\.my)|(?:shrinkify\.com)|(?:shrinkr\.com)|(?:shrt\.fr)|(?:shrt\.st)|(?:shrten\.com)|(?:shrunkin\.com)|(?:simurl\.com)|(?:slate\.me)|(?:smallr\.com)|(?:smsh\.me)|(?:smurl\.name)|(?:sn\.im)|(?:snipr\.com)|(?:snipurl\.com)|(?:snurl\.com)|(?:sp2\.ro)|(?:spedr\.com)|(?:srnk\.net)|(?:srs\.li)|(?:starturl\.com)|(?:su\.pr)|(?:surl\.co.uk)|(?:surl\.hu)|(?:t\.cn)|(?:t\.co)|(?:t\.lh.com)|(?:ta\.gd)|(?:tbd\.ly)|(?:tcrn\.ch)|(?:tgr\.me)|(?:tgr\.ph)|(?:tighturl\.com)|(?:tiniuri\.com)|(?:tiny\.cc)|(?:tiny\.ly)|(?:tiny\.pl)|(?:tinylink\.in)|(?:tinyuri\.ca)|(?:tinyurl\.com)|(?:tl\.gd)|(?:tmi\.me)|(?:tnij\.org)|(?:tnw\.to)|(?:tny\.com)|(?:to\.ly)|(?:togoto\.us)|(?:totc\.us)|(?:toysr\.us)|(?:tpm\.ly)|(?:tr\.im)|(?:tra\.kz)|(?:trunc\.it)|(?:twhub\.com)|(?:twirl\.at)|(?:twitclicks\.com)|(?:twitterurl\.net)|(?:twitterurl\.org)|(?:twiturl\.de)|(?:twurl\.cc)|(?:twurl\.nl)|(?:u\.mavrev.com)|(?:u\.nu)|(?:u76\.org)|(?:ub0\.cc)|(?:ulu\.lu)|(?:updating\.me)|(?:ur1\.ca)|(?:url\.az)|(?:url\.co.uk)|(?:url\.ie)|(?:url360\.me)|(?:url4\.eu)|(?:urlborg\.com)|(?:urlbrief\.com)|(?:urlcover\.com)|(?:urlcut\.com)|(?:urlenco\.de)|(?:urli\.nl)|(?:urls\.im)|(?:urlshorteningservicefortwitter\.com)|(?:urlx\.ie)|(?:urlzen\.com)|(?:usat\.ly)|(?:use\.my)|(?:vb\.ly)|(?:vgn\.am)|(?:vl\.am)|(?:vm\.lc)|(?:w55\.de)|(?:wapo\.st)|(?:wapurl\.co.uk)|(?:wipi\.es)|(?:wp\.me)|(?:x\.vu)|(?:xr\.com)|(?:xrl\.in)|(?:xrl\.us)|(?:xurl\.es)|(?:xurl\.jp)|(?:y\.ahoo.it)|(?:yatuc\.com)|(?:ye\.pe)|(?:yep\.it)|(?:yfrog\.com)|(?:yhoo\.it)|(?:yiyd\.com)|(?:youtu\.be)|(?:yuarel\.com)|(?:z0p\.de)|(?:zi\.ma)|(?:zi\.mu)|(?:zipmyurl\.com)|(?:zud\.me)|(?:zurl\.ws)|(?:zz\.gd)|(?:zzang\.kr)|(?:›\.ws)|(?:✩\.ws)|(?:✿\.ws)|(?:❥\.ws)|(?:➔\.ws)|(?:➞\.ws)|(?:➡\.ws)|(?:➨\.ws)|(?:➯\.ws)|(?:➹\.ws)|(?:➽\.ws))\/[a-z0-9]*/gi}function n(a,b){return"string"!=typeof a[b]&&(a[b]=a[b].map(function(a){return a.toLowerCase()})),a}function o(a){return a=k(a),a=n(a,"excludeEmbed"),a=n(a,"inlineEmbed"),n(a,"openGraphExclude")}function p(a){return a[a.length-1]}function q(a,b){return b.template.vimeo(a,b)||b.template.youtube(a,b)}function r(a){if(a.customVideoClickHandler)return a.videoClickHandler(a,q);for(var b=document.getElementsByClassName(a.videoClickClass),c=0;c<b.length;c++)b[c].onclick=function(){a.onVideoShow();var b=this.getAttribute("data-ejs-url")+"?autoplay=true";this.parentNode.parentNode.innerHTML=q(b,a)}}function s(a,b,c,d){return"vimeo"===a.host?d.template.detailsVimeo(a,b,c,d):"youtube"===a.host?d.template.detailsYoutube(a,b,c,d):void 0}function t(a){if(a.videojsOptions.width=a.videoWidth,a.videojsOptions.height=a.videoHeight,a.videoJS){if(!a.plugins.videojs)throw new ReferenceError("You have enabled videojs but you haven't loaded the library.Find it at http://videojs.com/");for(var b=a.plugins.videojs,c=a.input.getElementsByClassName("ejs-video-js"),d=0;d<c.length;d++)b(c[d],a.videojsOptions,function(){return a.videojsCallback()})}}function u(a){for(var b=document.getElementsByClassName(a),c=0;c<b.length;c++)b[c].onclick=null}function v(a){var b=a.options.link?new RegExp("([^>]*"+a.regex.source+")</a>","gm"):new RegExp("([^\\s]*"+a.regex.source+")","gm");return a.output=a.output.replace(b,function(b){var c=a.options.link?b.slice(0,-4):b;return-1===a.options.served.indexOf(c)?(a.options.served.push(c),a.options.link?a.options.inlineText?b+a.template(b.slice(0,-4)):a.template(b.slice(0,-4))+"</a>":a.options.inlineText?b+a.template(b):a.template(b)):b}),[a.output,a.embeds]}function w(a){for(var b=void 0;null!==(b=h(a.regex,a.input));){var c=b[0];if(!(-1!==a.options.served.indexOf(c)||a.options.served.length&&a.options.singleEmbed)){a.options.served.push(c);var d=a.template(c);a.embeds.push({text:d,index:b.index})}}return[a.output,a.embeds]}function x(a){return j(a.options,a.service)?v(a):w(a)}function y(a,b,c,d,e,f,g){return i(d,f)||i(d,f)&&g?new N(a,b,c,d,e,f).process():[b,c]}function z(a,b,c){var d=(a.options.link?c[0].slice(0,-4):c[0])||c[1];return a.options.served.indexOf(d)>=0?Promise.resolve(null):new Promise(function(e){b(a,c,d).then(function(b){return b?(a.options.served.push(d),void e(b)):e()})})}function A(a,b){for(var c=a.options.link?new RegExp("([^>]*"+a.regex.source+")</a>","gi"):new RegExp("([^\\s]*"+a.regex.source+")","gi"),d=void 0,e=[];null!==(d=h(c,a.output));)e.push(z(a,b,d));return new Promise(function(b){h.length?Promise.all(e).then(function(d){var e=0;a.output=a.output.replace(c,function(b){return a.options.link?a.options.inlineText?b+d[e++]:d[e]+"</a>":a.options.inlineText?b+d[e++]:d[e]}),b(a.output)}):b(a.output)})}function B(a,b,c){var d=c[0];if(!(a.options.served.indexOf(d)>=0))return new Promise(function(e){b(a,c,d,!0).then(function(b){b||e(),a.options.served.push(d),a.embeds.push({text:b,index:c.index}),e()})})}function C(a,b){for(var c=void 0,d=[];null!==(c=h(a.regex,a.input));)d.push(B(a,b,c));return new Promise(function(b){Promise.all(d).then(function(){b(a.embeds)})})}function D(a,b){return new Promise(function(c){j(a.options,a.service)?A(a,b).then(function(b){return c([b,a.embeds])}):C(a,b).then(function(b){return c([a.output,b])})})}var E="undefined"!=typeof window?window:"undefined"!=typeof global?global:this,F={};F["typeof"]="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a},F.classCallCheck=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},F.createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),F.slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();var G=function(){function a(b){F.classCallCheck(this,a),this.options=b||{}}return F.createClass(a,[{key:"url",value:function(a,b){var d=b.linkOptions;return'<a href="'+c(a)+'" rel="'+d.rel+'" target="'+d.target+'">'+a+"</a>"}},{key:"smiley",value:function(a,b,c){return'<span class="icon-emoticon" title="'+a+'">'+b+c+"</span>"}},{key:"emoji",value:function(a){return'<span class="emoticon emoticon-'+a+'" title=":'+a+':"></span>'}},{key:"audio",value:function(a){return'<div class="ejs-audio ejs-embed"><audio src="'+a+'" controls class="video-js ejs-video-js"></audio></div>'}},{key:"soundcloud",value:function(a,b){var c=b.soundCloudOptions;return'<div class="ejs-embed">\n		<iframe height="160" scrolling="no" src="https://w.soundcloud.com/player/?url='+a+"\n		&auto_play     = "+c.autoPlay+"\n		&hide_related  = "+c.hideRelated+"\n		&show_comments = "+c.showComments+"\n		&show_user     = "+c.showUser+"\n		&show_reposts  = "+c.showReposts+"\n		&visual        = "+c.visual+"\n		&download      = "+c.download+"\n		&color         = "+c.themeColor+"\n		&theme_color   = "+c.themeColor+'"></iframe>\n		</div>'}},{key:"spotify",value:function(a){var b=p(a.split("/"));return'<div class="ejs-embed"><iframe src="https://embed.spotify.com/?uri=spotify:track:'+b+'" height="80"></iframe></div>'}},{key:"codepen",value:function(a,b){return'<div class="ejs-embed ejs-codepen"><iframe scrolling="no" height="'+b.codeEmbedHeight+'" src="'+a.replace(/\/pen\//,"/embed/")+"/?height="+b.codeEmbedHeight+'"></iframe></div>'}},{key:"ideone",value:function(a,b){return'<div class="ejs-ideone ejs-embed"><iframe src="http://ideone.com/embed/'+a.split("/")[1]+'" frameborder="0" height="'+b.codeEmbedHeight+'"></iframe></div>'}},{key:"jsbin",value:function(a,b){return'<div class="ejs-jsbin ejs-embed"><iframe height="'+b.codeEmbedHeight+'" class="jsbin-embed foo" src="http://'+a+'/embed?html,js,output"></iframe></div>'}},{key:"jsfiddle",value:function(a,b){return a="/"==p(a)?a.slice(0,-1):a,a=-1!==a.indexOf("//")?a:"//"+a,'<div class="ejs-embed ejs-jsfiddle"><iframe height="'+b.codeEmbedHeight+'" src="'+a+'/embedded"></iframe></div>'}},{key:"plunker",value:function(a,b){return'<div class="ejs-embed ejs-plunker"><iframe class="ne-plunker" src="http://embed.plnkr.co/'+a+'" height="'+b.codeEmbedHeight+'"></iframe></div>'}},{key:"image",value:function(a){return'<div class="ejs-image ejs-embed"><div class="ne-image-wrapper"><img src="'+a+'"/></div></div>'}},{key:"flickr",value:function(a,b){return'<div class="ejs-embed"><div class="ne-image-wrapper"><iframe src="'+c(a.split("/?")[0])+'/player/" width="'+b.videoWidth+'" height="'+b.videoHeight+'"></iframe></div></div>'}},{key:"instagram",value:function(a,b){return'<div class="ejs-embed ejs-instagram"><iframe src="'+c(a.split("/?")[0])+'/embed/" height="'+b.videoHeight+'"></iframe></div>'}},{key:"slideShare",value:function(a){return'<div class="ejs-embed ejs-slideshare">'+a+"</div>"}},{key:"video",value:function(a){return'<div class="ejs-video ejs-embed"><div class="ejs-video-player"><div class="ejs-player"><video src="'+a+'" class="ejs-video-js video-js" controls></video></div></div></div>'}},{key:"dailymotion",value:function(a,b){var c=p(a.split("/"));return'<div class="ejs-video ejs-embed"><iframe src="http://www.dailymotion.com/embed/video/'+c+'" height="'+b.videoHeight+'" width="'+b.videoWidth+'"></iframe></div>'}},{key:"liveleak",value:function(a,b){return'<div class="ejs-video ejs-embed"><iframe src="http://www.liveleak.com/e/'+a.split("=")[1]+'" height="'+b.videoHeight+'" width="'+b.videoWidth+'"></iframe></div>'}},{key:"ted",value:function(a,b){var c=a.split("/"),d=c[c.length-1];return'<div class="ejs-embed ejs-ted"><iframe src="http://embed.ted.com/talks/'+d+'.html" height="'+b.videoHeight+'" width="'+b.videoWidth+'"></iframe></div>'}},{key:"ustream",value:function(a,b){var c=a.split("/");return c.splice(1,0,"embed"),'<div class="ejs-embed ejs-ustream"><iframe src="//www.'+c.join("/")+'" height="'+b.videoHeight+'" width="'+b.videoWidth+'"></iframe></div>'}},{key:"detailsVimeo",value:function(a,b,c){return'<div class="ejs-video ejs-embed"><div class="ejs-video-preview"><div class="ejs-video-thumb" data-ejs-url="'+c+'"><div class="ejs-thumb" style="background-image:url('+a.thumbnail+')"></div><i class="fa fa-play-circle-o"></i></div><div class="ejs-video-detail"><div class="ejs-video-title"><a href="'+a.url+'">'+a.title+'</a></div><div class="ejs-video-desc">'+a.description+'</div><div class="ejs-video-stats"><span><i class="fa fa-eye"></i>'+a.views+'</span><span><i class="fa fa-heart"></i>'+a.likes+"</span></div></div></div></div>"}},{key:"detailsYoutube",value:function(a,b,c){return'<div class="ejs-video ejs-embed"><div class="ejs-video-preview"><div class="ejs-video-thumb" data-ejs-url="'+c+'"><div class="ejs-thumb" style="background-image:url('+a.thumbnail+')"></div><i class="fa fa-play-circle-o"></i></div><div class="ejs-video-detail"><div class="ejs-video-title"><a href="'+a.url+'">'+a.title+'</a></div><div class="ejs-video-desc">'+a.description+'</div><div class="ejs-video-stats"><span><i class="fa fa-eye"></i>'+a.views+'</span><span><i class="fa fa-heart"></i>'+a.likes+"</span></div></div></div></div>"}},{key:"vine",value:function(a,b){var c=p(a.split("/")),d=b.vineOptions;return'<div class="ejs-vine"><iframe class="ejs-vine-iframe" src="https://vine.co/v/'+c+"/embed/"+d.type+'" height="'+d.height+'" width="'+d.width+'"></iframe></div>'}},{key:"vimeo",value:function(a,b){return'<div class="ejs-video-player ejs-embed"><iframe src="'+a+'" frameBorder="0" width="'+b.videoWidth+'" height="'+b.videoHeight+'"></iframe></div>'}},{key:"youtube",value:function(a,b){return'<div class="ejs-video-player ejs-embed"><iframe src="'+a+'" frameBorder="0" width="'+b.videoWidth+'" height="'+b.videoHeight+'"></iframe></div>'}},{key:"openGraph",value:function(a,b){return'<div class="ejs-embed ejs-ogp"><div class="ejs-ogp-thumb" style="background-image:url('+a.image+')"></div><div class="ejs-ogp-details"><div class="ejs-ogp-title"><a href="'+a.url+'" target="'+b.linkOptions.target+'">'+a.title+'</a></div><div class="ejs-ogb-details">'+a.description+"</div></div></div>"}},{key:"github",value:function(a,b){return'<div class="ejs-embed ejs-github"><div class="ejs-ogp-thumb" style="background-image:url('+a.owner.avatar_url+')"></div><div class="ejs-ogp-details"><div class="ejs-ogp-title"><a href="'+a.html_url+'" target="'+b.linkOptions.target+'">'+a.full_name+'</a></div><div class="ejs-ogb-details">'+a.description+'</div><div class="ejs-github-stats"><span><i class="fa fa-star"></i>'+a.stargazers_count+'</span><span><i class="fa fa-code-fork"></i>'+a.network_count+"</span></div></div></div>"}}]),a}(),H={basicAudio:/((?:https?):\/\/\S*\.(?:wav|mp3|ogg))/gi,soundCloud:/(soundcloud.com)\/[a-zA-Z0-9-_]+\/[a-zA-Z0-9-_]+/gi,spotify:/spotify.com\/track\/[a-zA-Z0-9_]+/gi,codepen:/http:\/\/codepen.io\/([A-Za-z0-9_]+)\/pen\/([A-Za-z0-9_]+)/gi,gist:/gist.github.com\/[a-zA-Z0-9_-]+\/([a-zA-Z0-9]+)/gi,highlightCode:/(`{3})(\s|[a-z]+)\s*([\s\S]*?[^`])\s*\1(?!`)/gm,inlineCode:/(`)\s*([\s\S]*?[^`])\s*\1(?!`)/gm,ideone:/ideone.com\/[a-zA-Z0-9]{6}/gi,jsbin:/jsbin.com\/[a-zA-Z0-9_]+\/[0-9_]+/gi,jsfiddle:/jsfiddle.net\/[a-zA-Z0-9_]+\/[a-zA-Z0-9_\/]+/gi,plunker:/plnkr.co\/edit\/[a-zA-Z0-9\?=]+/gi,basicImage:/((?:https?):\/\/\S*\.(?:gif|jpg|jpeg|tiff|png|svg|webp))/gi,flickr:/flickr.com\/[a-z]+\/[a-zA-Z@_$!\d\-\]+\/[\d]+/gi,instagram:/instagram.com\/p\/[a-zA-Z0-9_\/\?\-\=]+/gi,slideShare:/slideshare.net\/[a-zA-Z0-9_-]*\/[a-zA-Z0-9_-]*/gi,github:/[^\.]github.com\/([\w\.\-]+)\/([\w\.\-]+)/gi,basicVideo:/(?:https?):\/\/\S*\.(?:ogv|webm|mp4)/gi,dailymotion:/dailymotion.com\/video\/[a-zA-Z0-9-_]+/gi,liveleak:/liveleak.com\/view\?i=[a-zA-Z0-9_]+/gi,ted:/ted.com\/talks\/[a-zA-Z0-9_]+/gi,ustream:/ustream.tv\/[a-z\/0-9]*/gi,vimeo:/https?:\/\/(?:www\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|album\/(\d+)\/video\/|)(\d+)(?:$|\/|\?)*/gi,vine:/vine.co\/v\/[a-zA-Z0-9]+/gi,youtube:/https?:\/\/(?:[0-9A-Z-]+\.)?(?:youtu\.be\/|youtube\.com(?:\/embed\/|\/v\/|\/watch\?v=|\/ytscreeningroom\?v=|\/feeds\/api\/videos\/|\/user\S*[^\w\-\s]|\S*[^\w\-\s]))([\w\-]{11})[?=&+%\w-]*/gi,gmap:/@\((.+)\)/gi,twitter:/https:\/\/twitter\.com\/\w+\/\w+\/\d+/gi,smileys:/(\:\w+\:|\<[\/\\]?3|[\(\)\\\D|\*\$][\-\^]?[\:\;\=]|[\:\;\=B8][\-\^]?[3DOPp\@\$\*\\\)\(\/\|])(?=\s|[\!\.\?]|$)/gi},I=function(){function a(b,c){F.classCallCheck(this,a),this.output=b,this.options=c,this.emojiRegex=H.smileys}return F.createClass(a,[{key:"process",value:function(){var b=this;return this.output.replace(this.emojiRegex,function(c){var d=a.getEmoji(c);return d?b.options.template.emoji(d,b.options):c})}}],[{key:"getEmoji",value:function(a){return":"===a[0]&&":"===a[a.length-1]&&a.substring(1,a.length-1)}}]),a}(),J=function(){function a(b,c){F.classCallCheck(this,a),this.input=b,this.options=c;var d=[{text:":)",code:"&#xe60a"},{text:":D",code:"&#xe608"},{text:":d",code:"&#xe608"},{text:":(",code:"&#xe60e"},{text:":/",code:"&#xe620"},{text:":P",code:"&#xe60c"},{text:":p",code:"&#xe60c"},{text:"3:)",code:"&#xe618"},{text:"(^)",code:"&#xe607"},{text:";)",code:"&#xe610"},{text:":o",code:"&#xe61a"},{text:"-_-",code:"&#xe61e"},{text:"(y)",code:"&#xe606"},{text:":*",code:"&#xe604"},{text:"&lt;3",code:"&#xe604"},{text:"<3",code:"&#xe604"},{text:"&lt;/3",code:"&#xe605"},{text:"</3",code:"&#xe605"},{text:"^_^",code:"&#xe612"},{text:"8-)",code:"&#xe614"},{text:"8|",code:"&#xe614"},{text:":S",code:"&#xe61c"},{text:":s",code:"&#xe61c"}];this.icons=c.customFontIcons.length?c.customFontIcons:d,this.escapedSymbols=this.icons.map(function(a){return e(a.text)}),this.smileyRegex=new RegExp("(^|\\s)("+this.escapedSymbols.join("|")+")(?=\\s|$)","gi")}return F.createClass(a,[{key:"process",value:function(){var a=this;return this.input.replace(this.smileyRegex,function(b,c,d){var f=a.escapedSymbols.indexOf(e(d)),g=a.icons[f].code;return a.options.template.smiley(d,c,g,a.options)})}}]),a}(),K=function(){function a(b,c){F.classCallCheck(this,a),this.input=b,this.options=c,this.urlRegex=m()}return F.createClass(a,[{key:"process",value:function(){var a=this,b=this.options.linkOptions;return this.input.replace(this.urlRegex,function(c){var d=p(c.split("."));return"/"===p(c)&&(c=c.slice(0,-1)),-1===b.exclude.indexOf(d)?a.options.template.url(c,a.options):c})}}]),a}(),L=a(function(a,b,c){!function(c,d){if("function"==typeof define&&define.amd)define(["exports","module"],d);else if("undefined"!=typeof b&&"undefined"!=typeof a)d(b,a);else{var e={exports:{}};d(e.exports,e),c.fetchJsonp=e.exports}}(E,function(a,b){function c(){return"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random())}function d(a){try{delete window[a]}catch(b){window[a]=void 0}}function e(a){var b=document.getElementById(a);document.getElementsByTagName("head")[0].removeChild(b)}var f={timeout:5e3,jsonpCallback:"callback",jsonpCallbackFunction:null},g=function(a){var b=void 0===arguments[1]?{}:arguments[1],g=null!=b.timeout?b.timeout:f.timeout,h=null!=b.jsonpCallback?b.jsonpCallback:f.jsonpCallback,i=void 0;return new Promise(function(f,j){var k=b.jsonpCallbackFunction||c();window[k]=function(a){f({ok:!0,json:function(){return Promise.resolve(a)}}),i&&clearTimeout(i),e(h+"_"+k),d(k)},a+=-1===a.indexOf("?")?"?":"&";var l=document.createElement("script");l.setAttribute("src",a+h+"="+k),l.id=h+"_"+k,document.getElementsByTagName("head")[0].appendChild(l),i=setTimeout(function(){j(new Error("JSONP request to "+a+" timed out")),d(k),e(h+"_"+k)},g)})};b.exports=g})}),M=L&&"object"===("undefined"==typeof L?"undefined":F["typeof"](L))&&"default"in L?L["default"]:L,N=function(){function a(b,c,d,e,f,g){F.classCallCheck(this,a),this.input=b,this.output=c,this.options=e,this.embeds=d,this.regex=f,this.service=g}return F.createClass(a,[{key:"template",value:function(a){return this.options.template[this.service](a,this.options)}},{key:"process",value:function(){return x(this)}}]),a}(),O=function(){function a(b,c,d,e){F.classCallCheck(this,a),this.input=b,this.output=c,this.options=d,this.embeds=e,this.regex=H.twitter,this.service="twitter",this.load=this.load.bind(this),this.options.input.addEventListener("rendered",this.load,!1)}return F.createClass(a,[{key:"tweetData",value:function(a){var b=this.options.tweetOptions,c="https://api.twitter.com/1/statuses/oembed.json?omit_script=true&url="+a+"&maxwidth="+b.maxWidth+"&hide_media="+b.hideMedia+"&hide_thread="+b.hideThread+"&align="+b.align+"&lang="+b.lang;return new Promise(function(a){M(c,{credentials:"include"}).then(function(a){return a.json()}).then(function(b){return a(b)})})}},{key:"load",value:function(){var a=this.options.plugins.twitter;a.widgets.load(this.options.element),a.events.bind("loaded",this.options.onTweetsLoad)}},{key:"process",value:function(){var b=this;return new Promise(function(c){return D(b,a.urlToText).then(function(a){return c(a)})})}}],[{key:"urlToText",value:function(a,b,c){return new Promise(function(b){return a.tweetData(c).then(function(a){return b(a.html)})})}}]),a}();!function(a){function b(a){if("string"!=typeof a&&(a=String(a)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(a))throw new TypeError("Invalid character in header field name");return a.toLowerCase()}function c(a){return"string"!=typeof a&&(a=String(a)),a}function d(a){this.map={},a instanceof d?a.forEach(function(a,b){this.append(b,a)},this):a&&Object.getOwnPropertyNames(a).forEach(function(b){this.append(b,a[b])},this)}function e(a){return a.bodyUsed?Promise.reject(new TypeError("Already read")):void(a.bodyUsed=!0)}function f(a){return new Promise(function(b,c){a.onload=function(){b(a.result)},a.onerror=function(){c(a.error)}})}function g(a){var b=new FileReader;return b.readAsArrayBuffer(a),f(b)}function h(a){var b=new FileReader;return b.readAsText(a),f(b)}function i(){return this.bodyUsed=!1,this._initBody=function(a){if(this._bodyInit=a,"string"==typeof a)this._bodyText=a;else if(o.blob&&Blob.prototype.isPrototypeOf(a))this._bodyBlob=a;else if(o.formData&&FormData.prototype.isPrototypeOf(a))this._bodyFormData=a;else if(a){if(!o.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(a))throw new Error("unsupported BodyInit type")}else this._bodyText="";this.headers.get("content-type")||("string"==typeof a?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type&&this.headers.set("content-type",this._bodyBlob.type))},o.blob?(this.blob=function(){var a=e(this);if(a)return a;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(g)},this.text=function(){var a=e(this);if(a)return a;if(this._bodyBlob)return h(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){var a=e(this);return a?a:Promise.resolve(this._bodyText)},o.formData&&(this.formData=function(){return this.text().then(l)}),this.json=function(){return this.text().then(JSON.parse)},this}function j(a){var b=a.toUpperCase();return p.indexOf(b)>-1?b:a}function k(a,b){b=b||{};var c=b.body;if(k.prototype.isPrototypeOf(a)){if(a.bodyUsed)throw new TypeError("Already read");this.url=a.url,this.credentials=a.credentials,b.headers||(this.headers=new d(a.headers)),this.method=a.method,this.mode=a.mode,c||(c=a._bodyInit,a.bodyUsed=!0)}else this.url=a;if(this.credentials=b.credentials||this.credentials||"omit",!b.headers&&this.headers||(this.headers=new d(b.headers)),this.method=j(b.method||this.method||"GET"),this.mode=b.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&c)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(c)}function l(a){var b=new FormData;return a.trim().split("&").forEach(function(a){if(a){var c=a.split("="),d=c.shift().replace(/\+/g," "),e=c.join("=").replace(/\+/g," ");b.append(decodeURIComponent(d),decodeURIComponent(e))}}),b}function m(a){var b=new d,c=a.getAllResponseHeaders().trim().split("\n");return c.forEach(function(a){var c=a.trim().split(":"),d=c.shift().trim(),e=c.join(":").trim();b.append(d,e)}),b}function n(a,b){b||(b={}),this.type="default",this.status=b.status,this.ok=this.status>=200&&this.status<300,this.statusText=b.statusText,this.headers=b.headers instanceof d?b.headers:new d(b.headers),this.url=b.url||"",this._initBody(a)}if(!a.fetch){d.prototype.append=function(a,d){a=b(a),d=c(d);var e=this.map[a];e||(e=[],this.map[a]=e),e.push(d)},d.prototype["delete"]=function(a){delete this.map[b(a)]},d.prototype.get=function(a){var c=this.map[b(a)];return c?c[0]:null},d.prototype.getAll=function(a){return this.map[b(a)]||[]},d.prototype.has=function(a){return this.map.hasOwnProperty(b(a))},d.prototype.set=function(a,d){this.map[b(a)]=[c(d)]},d.prototype.forEach=function(a,b){Object.getOwnPropertyNames(this.map).forEach(function(c){this.map[c].forEach(function(d){a.call(b,d,c,this)},this)},this)};var o={blob:"FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch(a){return!1}}(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a},p=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];k.prototype.clone=function(){return new k(this)},i.call(k.prototype),i.call(n.prototype),n.prototype.clone=function(){return new n(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},n.error=function(){var a=new n(null,{status:0,statusText:""});return a.type="error",a};var q=[301,302,303,307,308];n.redirect=function(a,b){if(-1===q.indexOf(b))throw new RangeError("Invalid status code");return new n(null,{status:b,headers:{location:a}})},a.Headers=d,a.Request=k,a.Response=n,a.fetch=function(a,b){return new Promise(function(c,d){function e(){return"responseURL"in g?g.responseURL:/^X-Request-URL:/m.test(g.getAllResponseHeaders())?g.getResponseHeader("X-Request-URL"):void 0}var f;f=k.prototype.isPrototypeOf(a)&&!b?a:new k(a,b);var g=new XMLHttpRequest;g.onload=function(){var a=1223===g.status?204:g.status;if(100>a||a>599)return void d(new TypeError("Network request failed"));var b={status:a,statusText:g.statusText,headers:m(g),url:e()},f="response"in g?g.response:g.responseText;c(new n(f,b))},g.onerror=function(){d(new TypeError("Network request failed"))},g.open(f.method,f.url,!0),"include"===f.credentials&&(g.withCredentials=!0),"responseType"in g&&o.blob&&(g.responseType="blob"),f.headers.forEach(function(a,b){g.setRequestHeader(b,a)}),g.send("undefined"==typeof f._bodyInit?null:f._bodyInit)})},a.fetch.polyfill=!0}}("undefined"!=typeof self?self:this);var P=function(){function a(b,c,d,e){F.classCallCheck(this,a),this.input=b,this.output=c,this.options=d,this.embeds=e,this.service="map",this.regex=H.gmap}return F.createClass(a,[{key:"process",value:function(){for(var b=this,c=void 0,d=[],e=[];null!==(c=h(this.regex,this.output));){this.options.served.push(c);var f="place"!==this.options.mapOptions.mode?a.getCoordinate(c[0]):Promise.resolve([null,null]);d.push(f),e.push(c)}return new Promise(function(c){Promise.all(d).then(function(f){var g=function(){var c=F.slicedToArray(f[h],2),d=c[0],g=c[1],i=a.template(e[h][0],d,g,b.options);j(b.options,b.service)?b.output=b.output.replace(b.regex,function(b){return'<span class="ejs-location">'+a.locationText(b)+"</span>"+i}):(b.embeds.push({text:i,index:e[h][0].index}),b.output=b.output.replace(b.regex,function(b){return'<span class="ejs-location">'+a.locationText(b)+"</span>"}))};for(var h in d)g();c([b.output,b.embeds])})})}}],[{key:"getCoordinate",value:function(a){var b="http://maps.googleapis.com/maps/api/geocode/json?address="+a+"&sensor=false";return new Promise(function(a){fetch(b).then(function(a){return a.json()}).then(function(b){return a([b.results[0].geometry.location.lat,b.results[0].geometry.location.lng])})})}},{key:"template",value:function(b,c,d,e){var f=a.locationText(b),g=e.mapOptions;return"place"===g.mode?'<div class="ejs-embed ejs-map"><iframe width="'+e.videoWidth+'" height="'+e.videoHeight+'" src="https://www.google.com/maps/embed/v1/place?key='+e.googleAuthKey+"&q="+f+'"></iframe></div>':"streetview"===g.mode?'<div class="ejs-embed ejs-map"><iframe width="'+e.videoWidth+'" height="'+e.videoHeight+'" src="https://www.google.com/maps/embed/v1/streetview?key='+e.googleAuthKey+"&location="+c+","+d+'&heading=210&pitch=10&fov=35"></iframe></div>':"view"===g.mode?'<div class="ejs-embed ejs-map"><iframe width="'+e.videoWidth+'" height="'+e.videoHeight+'" src="https://www.google.com/maps/embed/v1/view?key='+e.googleAuthKey+"&center="+c+","+d+'&zoom=18&maptype=satellite"></iframe></div>':void 0}},{key:"locationText",value:function(a){return a.split("(")[1].split(")")[0]}}]),a}(),Q=function(){function a(b,c){if(F.classCallCheck(this,a),!c.plugins.marked)throw new ReferenceError("marked.js is not loaded.");this.output=b,this.options=c}return F.createClass(a,[{key:"process",value:function(){var a=this,b=this.options.plugins.marked,c=new b.Renderer;return c.link=function(b,c,d){return-1===b.indexOf("&lt;/a")?b:b.match(/&gt;(.+)&lt;\/a/gi)?(c||(c=""),'<a href="'+RegExp.$1+'" rel='+a.options.linkOptions.rel+'" target="'+a.options.linkOptions.target+'" title="'+c+'">'+d+"</a>"):void 0},c.image=function(a,b,c){return-1===a.indexOf("&lt;/a")?a:a.match(/&gt;(.+)&lt;\/a/gi)?(b||(b=""),'<div class="ejs-image ejs-embed"><div class="ne-image-wrapper"><img src="'+RegExp.$1+'" title="'+b+'" alt="'+c+'"/></div></div>'):void 0},c.paragraph=function(a){return"<p> "+a+" </p>"},b.Lexer.rules.gfm.heading=b.Lexer.rules.normal.heading,
b.Lexer.rules.tables.heading=b.Lexer.rules.normal.heading,this.options.markedOptions.renderer=c,this.options.markedOptions.highlight=!1,b(this.output,this.options.markedOptions)}}]),a}(),R=function(){function a(b,c){if(F.classCallCheck(this,a),!c.plugins.highlightjs&&!this.isPrism())throw new ReferenceError("'hljs is not defined. HighlightJS library is needed to highlight code. Visit https://highlightjs.org/'");this.output=b,this.options=c,this.regex=H.highlightCode,this.inlineCodeRegex=H.inlineCode}return F.createClass(a,[{key:"process",value:function(){var b=this;return this.output=this.output.replace(this.inlineCodeRegex,function(a,b,c){return"<code>"+c+"</code>"}),this.output.replace(this.regex,function(c,d,e,f){var g=f;g=a.trimSpace(g),g=a.encode(g),g=g.replace(/:\/\//g,"~P");var h=e.split("\n")[0],i=void 0,j=b.options.plugins.highlightjs;return h?i=j.highlightAuto(g,[h]):(i=j.highlightAuto(g),h=i.language),a.addTemplate(i,h)})}}],[{key:"encode",value:function(a){return a=a.replace(/&amp;/gm,""),a=a.replace(/&lt;/g,"<"),a=a.replace(/&gt;/g,">")}},{key:"trimSpace",value:function(a){return a=a.replace(/^([ \t]*)/g,""),a=a.replace(/[ \t]*$/g,"")}},{key:"addTemplate",value:function(a,b){return'<pre><code class="ejs-code hljs '+b+'">'+(a.value||a)+"</code></pre>"}}]),a}(),S=function(){function a(b,c,d,e){var f=this;F.classCallCheck(this,a),this.input=b,this.output=c,this.options=d,this.embeds=e,this.regex=H.gist,this.service="gist",this.options.input.addEventListener("rendered",function(){f.load()})}return F.createClass(a,[{key:"template",value:function(a){return'<div class="ejs-gist" data-src="'+a+'"></div>'}},{key:"load",value:function(){for(var a=this.options.input.getElementsByClassName("ejs-gist"),b=0;b<a.length;b++){var c=document.createElement("iframe");c.setAttribute("width","100%"),c.id="ejs-gist-"+b;var d=a[b];d.innerHTML="",d.appendChild(c);var e=a[b].getAttribute("data-src");e=-1===e.indexOf("http")?"https://"+e:e;var f='<html><base target="_parent"/><body onload="parent.document.getElementById(\'ejs-gist-'+b+'\').style.height=parseInt(document.body.scrollHeight)+20+\'px\'"><script type="text/javascript" src="'+e+'.js"></script></body></html>',g=c.document;c.contentDocument?g=c.contentDocument:c.contentWindow&&(g=c.contentWindow.document),g.open(),g.writeln(f),g.close()}}},{key:"process",value:function(){return x(this)}}]),a}(),T=function(){function a(b,c,d,e){F.classCallCheck(this,a),this.input=b,this.output=c,this.options=d,this.embeds=e,this.regex=H.youtube,this.service="youtube"}return F.createClass(a,[{key:"data",value:function(a){var b="https://www.googleapis.com/youtube/v3/videos?id="+a+"&key="+this.options.googleAuthKey+"&part=snippet,statistics";return new Promise(function(a){fetch(b).then(function(a){return a.json()}).then(function(b){return a(b.items[0])})})}},{key:"process",value:function(){var b=this;return new Promise(function(c){return D(b,a.urlToText).then(function(a){return c(a)})})}}],[{key:"formatData",value:function(a,b){return{title:a.snippet.title,thumbnail:a.snippet.thumbnails.medium.url,rawDescription:a.snippet.description,views:a.statistics.viewCount,likes:a.statistics.likeCount,description:b(a.snippet.description,150),url:"https://www.youtube.com/watch?v="+a.id,id:a.id,host:"youtube"}}},{key:"urlToText",value:function(c,d,e,f){var g=f?d[1]:d[2],h="https://www.youtube.com/embed/"+g;return c.options.videoDetails?new Promise(function(d){c.data(g).then(function(e){return d(s(a.formatData(e,b),e,h,c.options))})}):new Promise(function(a){return a(q(h,c.options))})}}]),a}(),U=function(){function a(b,c,d,e){F.classCallCheck(this,a),this.input=b,this.output=c,this.options=d,this.embeds=e,this.regex=H.vimeo,this.service="vimeo"}return F.createClass(a,[{key:"data",value:function(a){var b="https://vimeo.com/api/v2/video/"+a+".json";return new Promise(function(a){fetch(b).then(function(a){return a.json()}).then(function(b){return a(b[0])})})}},{key:"process",value:function(){var b=this;return new Promise(function(c){return D(b,a.urlToText).then(function(a){return c(a)})})}}],[{key:"formatData",value:function(a,b){return{title:a.title,thumbnail:a.thumbnail_medium,rawDescription:a.description.replace(/\n/g,"<br/>").replace(/&#10;/g,"<br/>"),views:a.stats_number_of_plays,likes:a.stats_number_of_likes,description:b(a.description.replace(/((<|&lt;)br\s*\/*(>|&gt;)\r\n)/g," "),150),url:a.url,id:a.id,host:"vimeo"}}},{key:"urlToText",value:function(c,d,e,f){var g=void 0;if(g=f?d[3]:c.options.link?d[0].slice(0,-4).split("/").slice(-1).pop():d[0].split("/").slice(-1).pop()){var h="https://player.vimeo.com/video/"+g;return c.options.videoDetails?new Promise(function(d){c.data(g).then(function(e){return d(s(a.formatData(e,b),e,h,c.options))})}):new Promise(function(a){return a(q(h,c.options))})}}}]),a}(),V=function(){function a(b,c,d,e){F.classCallCheck(this,a),this.input=b,this.output=c,this.options=d,this.embeds=e,this.regex=H.slideShare,this.service="slideshare"}return F.createClass(a,[{key:"template",value:function(a){return this.options.template.slideShare(a,this.options)}},{key:"process",value:function(){var b=this;return new Promise(function(c){return D(b,a.urlToText).then(function(a){return c(a)})})}}],[{key:"fetchData",value:function(a,b){var c="http://www.slideshare.net/api/oembed/2?url="+b+"&format=jsonp&maxwidth="+a.options.videoWidth+"&maxheight="+a.options.videoHeight;return new Promise(function(a){M(c,{credentials:"include"}).then(function(a){return a.json()}).then(function(b){return a(b.html)})})}},{key:"urlToText",value:function(b,c,d){return new Promise(function(c){a.fetchData(b,d).then(function(a){return c(b.template(a))})})}}]),a}(),W=function(){function a(b,c,d,e){F.classCallCheck(this,a),this.input=b,this.output=c,this.options=d,this.embeds=e,this.service="opengraph",this.regex=m(),this.excludeRegex=new RegExp([".mp4|.mp3|.gif|.pdf|.doc|.ppt|.docx|.jpg|.jpeg|.ogg"].concat(d.openGraphExclude).join("|"),"gi")}return F.createClass(a,[{key:"template",value:function(a){return this.options.template.openGraph(a,this.options)}},{key:"process",value:function(){var b=this;return new Promise(function(c){return D(b,a.urlToText).then(function(a){return c(a)})})}}],[{key:"fetchData",value:function(a,b){a=encodeURIComponent(a);var c=new Function("url","return `"+b.options.openGraphEndpoint+"`")(a);return new Promise(function(a){fetch(c).then(function(a){return a.json()}).then(function(c){return a(b.options.onOpenGraphFetch(c)||c)})})}},{key:"urlToText",value:function(b,c,d){return d.match(b.excludeRegex)?Promise.resolve():new Promise(function(c){a.fetchData(d,b).then(function(a){return c(a&&a.success?b.template(a):"")})})}}]),a}(),X=function(){function a(b,c,d,e){F.classCallCheck(this,a),this.input=b,this.output=c,this.options=d,this.embeds=e,this.service="github",this.regex=H.github}return F.createClass(a,[{key:"process",value:function(){var b=this;return new Promise(function(c){return D(b,a.urlToText).then(function(a){return c(a)})})}}],[{key:"fetchRepo",value:function(a){var b="https://api.github.com/repos/"+a.user+"/"+a.repo;return new Promise(function(a){fetch(b).then(function(a){return a.json()}).then(function(b){return a(b)})})}},{key:"template",value:function(a,b){return b.template.github(a,b)}},{key:"urlToText",value:function(b,c,d,e){var f=e?{user:c[1],repo:c[2]}:{user:c[2],repo:c[3]};if(f.repo)return new Promise(function(c){a.fetchRepo(f).then(function(d){return c(a.template(d,b.options))})})}}]),a}(),Y={},Z={marked:!1,markedOptions:{},link:!0,linkOptions:{target:"self",exclude:["pdf"],rel:""},emoji:!0,customEmoji:[],fontIcons:!0,customFontIcons:[],highlightCode:!1,videoJS:!1,videojsOptions:{fluid:!0,preload:"metadata"},locationEmbed:!0,mapOptions:{mode:"place"},tweetsEmbed:!1,tweetOptions:{maxWidth:550,hideMedia:!1,hideThread:!1,align:"none",lang:"en"},singleEmbed:!1,openGraphEndpoint:null,openGraphExclude:[],videoEmbed:!0,videoHeight:null,videoWidth:null,videoDetails:!0,audioEmbed:!0,imageEmbed:!0,excludeEmbed:[],inlineEmbed:[],inlineText:!0,codeEmbedHeight:500,vineOptions:{maxWidth:null,type:"postcard",responsive:!0,width:350,height:460},plugins:{marked:window.marked,videojs:window.videojs,highlightjs:window.hljs,prismjs:window.Prism,twitter:window.twttr},googleAuthKey:"",soundCloudOptions:{height:160,themeColor:"f50000",autoPlay:!1,hideRelated:!1,showComments:!0,showUser:!0,showReposts:!1,visual:!1,download:!1},videoClickClass:"ejs-video-thumb",customVideoClickHandler:!1,beforeEmbedJSApply:function(){},afterEmbedJSApply:function(){},onVideoShow:function(){},onTweetsLoad:function(){},videojsCallback:function(){},onOpenGraphFetch:function(){},onOpenGraphFail:function(){},videoClickHandler:function(){},served:[]},$=[],_=[],aa=[],ba=function(){function a(b,c){F.classCallCheck(this,a);var e=l(Z),f=l(Y),g=d(e,f);if(this.options=d(g,b),this.options.template=c||new G,!this.options.input||"string"!=typeof this.options.input&&"object"!==F["typeof"](this.options.input))throw ReferenceError("You need to pass an element or the string that needs to be processed");this.input="object"===F["typeof"](this.options.input)?this.options.input.innerHTML:this.options.input}return F.createClass(a,[{key:"process",value:function(){var a=this,b=this.input,c=o(this.options),d=[],e=b;return this.options.beforeEmbedJSApply(),new Promise(function(f){c.link&&(e=new K(b,c).process());var h=c.openGraphEndpoint?new W(b,e,c,d).process():Promise.resolve([e,d]);h.then(function(a){var d=F.slicedToArray(a,2),e=d[0],f=d[1];c.highlightCode&&(e=new R(e,c).process()),c.marked&&(e=new Q(e,c).process()),c.emoji&&(e=new I(e,c).process()),c.fontIcons&&(e=new J(e,c).process());var g=y(b,e,f,c,H.ideone,"ideone"),h=F.slicedToArray(g,2);e=h[0],f=h[1];var j=y(b,e,f,c,H.plunker,"plunker"),k=F.slicedToArray(j,2);e=k[0],f=k[1];var l=y(b,e,f,c,H.jsbin,"jsbin"),m=F.slicedToArray(l,2);e=m[0],f=m[1];var n=y(b,e,f,c,H.codepen,"codepen"),o=F.slicedToArray(n,2);e=o[0],f=o[1];var p=y(b,e,f,c,H.jsfiddle,"jsfiddle"),q=F.slicedToArray(p,2);e=q[0],f=q[1];var r=y(b,e,f,c,H.ted,"ted"),s=F.slicedToArray(r,2);e=s[0],f=s[1];var t=y(b,e,f,c,H.dailymotion,"dailymotion"),u=F.slicedToArray(t,2);e=u[0],f=u[1];var v=y(b,e,f,c,H.ustream,"ustream"),w=F.slicedToArray(v,2);e=w[0],f=w[1];var x=y(b,e,f,c,H.liveleak,"liveleak"),z=F.slicedToArray(x,2);e=z[0],f=z[1];var A=y(b,e,f,c,H.basicVideo,"video",c.videoEmbed),B=F.slicedToArray(A,2);e=B[0],f=B[1];var C=y(b,e,f,c,H.vine,"vine"),D=F.slicedToArray(C,2);e=D[0],f=D[1];var E=y(b,e,f,c,H.soundCloud,"soundcloud"),G=F.slicedToArray(E,2);e=G[0],f=G[1];var K=y(b,e,f,c,H.spotify,"spotify"),L=F.slicedToArray(K,2);e=L[0],f=L[1];var M=y(b,e,f,c,H.basicAudio,"audio",c.audioEmbed),N=F.slicedToArray(M,2);e=N[0],f=N[1];var O=y(b,e,f,c,H.flickr,"flickr"),P=F.slicedToArray(O,2);e=P[0],f=P[1];var U=y(b,e,f,c,H.instagram,"instagram"),V=F.slicedToArray(U,2);e=V[0],f=V[1];var W=y(b,e,f,c,H.basicImage,"image",c.imageEmbed),X=F.slicedToArray(W,2);if(e=X[0],f=X[1],i(c,"gist")){var Y=new S(b,e,c,f).process(),Z=F.slicedToArray(Y,2);e=Z[0],f=Z[1]}return i(c,"youtube")?new T(b,e,c,f).process():Promise.resolve([e,f])}).then(function(a){var d=F.slicedToArray(a,2),e=d[0],f=d[1];return i(c,"vimeo")?new U(b,e,c,f).process():Promise.resolve([e,f])}).then(function(a){var d=F.slicedToArray(a,2),e=d[0],f=d[1];return i(c,"github")?new X(b,e,c,f).process():Promise.resolve([e,f])}).then(function(a){var d=F.slicedToArray(a,2),e=d[0],f=d[1];return c.locationEmbed&&i(c,"gmap")?new P(b,e,c,f).process():Promise.resolve([e,f])}).then(function(a){var d=F.slicedToArray(a,2),e=d[0],f=d[1];return i(c,"slideshare")?new V(b,e,c,f).process():Promise.resolve([e,f])}).then(function(d){var e=F.slicedToArray(d,2),f=e[0],g=e[1];return c.tweetsEmbed&&i(c,"twitter")?(a.twitter=new O(b,f,c,g),a.twitter.process()):Promise.resolve([f,g])}).then(function(b){var d=F.slicedToArray(b,2),e=d[0],h=d[1];a.data={input:c.input,output:e,options:c,inputString:a.input,services:c.served,template:c.template},f(g(e,h))})})}},{key:"render",value:function(){var a=this;if("string"==typeof this.options.input)throw new Error("You cannot call render method for a string");if(!this.options.input)throw new Error("You didn't pass an element while creating this instance. render() method can't work without an input element");return new Promise(function(b){a.process().then(function(c){a.options.input.innerHTML=c,a.applyListeners(),b(a.data)})})}},{key:"applyListeners",value:function(){t(this.options),r(this.options);var a=new Event("rendered");this.options.input.dispatchEvent(a),this.options.afterEmbedJSApply()}},{key:"update",value:function(a,b){if(a&&(this.options=d(this.options,a)),b&&(this.options.template=b),!this.options.input||"string"!=typeof this.options.input&&"object"!==F["typeof"](this.options.input))throw ReferenceError("You need to pass an element or the string that needs to be processed");this.input="object"===F["typeof"](this.options.input)?this.options.input.innerHTML:this.options.input}},{key:"text",value:function(a){var b=this;this.process().then(function(c){return a(c,b.input)})}},{key:"destroy",value:function(){if(!this.element)throw new Error("destroy() method only if an element had been passed in the options object");u("ejs-video-thumb"),this.element.removeEventListener("rendered",this.twitter.load(),!1),this.element.innerHTML=this.input}}],[{key:"setOptions",value:function(a){Y=d(Z,a)}},{key:"applyEmbedJS",value:function(b){for(var c=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],d=arguments.length<=2||void 0===arguments[2]?new G:arguments[2],e=document.querySelectorAll(b),f=0;f<e.length;f++)c.input=e[f],$[f]=new a(c,d),aa[f]=$[f].render();return new Promise(function(a){Promise.all(aa).then(function(b){a(b)})})}},{key:"destroyEmbedJS",value:function(){for(var a=0;a<$.length;a++)$[a].destroy()}},{key:"destroyAll",value:function(){for(var a=0;a<_.length;a++)_[a].destroy()}},{key:"Template",value:function(){return new G}}]),a}();return ba});