/**
 * @license jquery.panzoom.js v0.2.5
 * Updated: Tue Apr 02 2013
 * Add pan and zoom functionality to any element
 * Copyright (c) 2013 timmy willison
 * Released under the MIT license
 * https://github.com/timmywil/jquery.panzoom/blob/master/MIT-License.txt
 */
(function(t,e){"function"==typeof define&&define.amd?define(["jquery"],e):e(t.jQuery)})(this,function(t){"use strict";var e=Modernizr&&Modernizr.touch;if(e){var n={props:["touches","pageX","pageY"]};t.each(["touchstart","touchmove","touchend"],function(e,s){t.event.fixHooks[s]=n})}var s="__pz__",i=Array.prototype.slice,o=/([A-Z])/g,a=/^http:[\w\.\/]+svg$/,r="(\\-?[\\d\\.e]+)",c="\\,?\\s*",h=RegExp("^matrix\\("+r+c+r+c+r+c+r+c+r+c+r+"\\)$"),m=function(e,n){1!==e.nodeType&&t.error("Panzoom called on non-Element node"),t.contains(document,e)||t.error("Panzoom element must be attached to the document");var i=t.data(e,s);if(i)return i;if(!(this instanceof m))return new m(e,n);this.options=n=t.extend({},m.defaults,n),this.origTransform=t.style(e,"transform"),this.transform=t.cssProps.transform.replace(o,"-$1").toLowerCase(),this._buildTransition(),this.elem=e,this.isSVG=a.test(e.namespaceURI)&&"svg"!==e.nodeName.toLowerCase();var r=this.$elem=t(e);this.$parent=r.parent();var c=t(),h=this;return t.each(["$zoomIn","$zoomOut","$zoomRange","$reset"],function(t,e){h[e]=n[e]||c}),this._initStyle(),this._bind(),t.data(e,s,this),this};return m.rmatrix=h,m.defaults={eventNamespace:".panzoom",transition:!0,cursor:"move",disablePan:!1,disableZoom:!1,increment:.3,minScale:.4,maxScale:5,duration:200,easing:"ease-in-out"},m.prototype={constructor:m,instance:function(){return this},zoom:function(e,n){var s=this.options;if(!s.disableZoom){var i=this.getMatrix();"number"!=typeof e&&(e=+i[0]+this.options.increment*(e?-1:1),s.transition&&t.style(this.elem,"transition",this.transition)),e>s.maxScale?e=s.maxScale:s.minScale>e&&(e=s.minScale),n||this.$zoomRange.val(e),i[0]=i[3]=e,this.setMatrix(i)}},reset:function(){this.options.transition&&t.style(this.elem,"transition",this.transition),t.style(this.elem,"transform","none"),this.$zoomRange.val(1)},destroy:function(){this._resetStyle(),this._unbind(),t.removeData(this.elem,s)},option:function(e,n){var s;if(!e)return t.extend({},this.options);if("string"==typeof e){if(1===arguments.length)return this.options[e];s={},s[e]=n}else s=e;this._setOptions(s)},_setOptions:function(e){var n=this;t.each(e,function(e,s){switch(e){case"disablePan":n._resetStyle();case"disableZoom":case"$zoomIn":case"$zoomOut":case"$zoomRange":case"$reset":case"onEnd":case"eventNamespace":n._unbind()}switch(n.options[e]=s,e){case"disablePan":n._initStyle();case"disableZoom":case"$zoomIn":case"$zoomOut":case"$zoomRange":case"$reset":case"onEnd":case"eventNamespace":n._bind();break;case"cursor":t.style(n.elem,"cursor",s);break;case"minScale":n.$zoomRange.attr("min",s);break;case"maxScale":n.$zoomRange.attr("max",s);break;case"duration":case"easing":n._buildTransition();break;case"transition":s||t.style(this.elem,"transition","none")}})},_buildTransition:function(){var t=this.options;this.transform&&(this.transition=this.transform+" "+t.duration+"ms "+t.easing)},_initStyle:function(){this.options.disablePan||this.$elem.css("cursor",this.options.cursor);var t=this.$parent,e={overflow:"hidden"};"static"===t.css("position")&&(e.position="relative"),t.css(e)},_resetStyle:function(){this.$elem[this.isSVG?"attr":"css"]("transform",this.origTransform).css({cursor:"",transition:""}),this.$parent.css({overflow:"",position:""})},_bind:function(){var n=this,s=this.options.eventNamespace,i=(e?"touchend":"click")+s,o=(e?"touchstart":"mousedown")+s,a=this.options,r={};if(t.isFunction(a.onEnd)&&(r["panzoomend"+s]=a.onEnd),e?a.disablePan&&a.disableZoom||(r[o]=function(t){var e=t.touches;e&&(1!==e.length||a.disablePan?2!==e.length||a.disableZoom||(t.preventDefault(),n._startMove(e)):(t.preventDefault(),n._startMove(t.pageX,t.pageY)))}):a.disablePan||(r[o]=function(t){1===t.which&&null!=t.pageX&&null!=t.pageY&&(t.preventDefault(),n._startMove(t.pageX,t.pageY))}),r&&this.$elem.on(r),!a.disableZoom){var c=this.$zoomIn,h=this.$zoomOut,m=this.$zoomRange,u=this.$reset;c.length&&h.length&&(c.on(i,function(t){t.preventDefault(),n.zoom()}),h.on(i,function(t){t.preventDefault(),n.zoom(!0)})),m.length&&(m.attr({min:a.minScale,max:a.maxScale,step:.05,value:1}),r={},r[o]=function(){t.style(n.elem,"transition","none")},r["change"+s]=function(){n.zoom(+this.value,!0)},m.on(r)),u.length&&u.on(i,function(t){t.preventDefault(),n.reset()})}},_unbind:function(){this.$elem.add(this.$zoomIn).add(this.$zoomOut).add(this.$reset).off(this.options.eventNamespace)},getMatrix:function(){var e=this.isSVG?this.elem.getAttribute("transform"):t.style(this.elem,"transform"),n=h.exec(e);return n&&n.shift(),n||[1,0,0,1,0,0]},setMatrix:function(e){e="matrix("+e.join(",")+")",this.isSVG?this.elem.setAttribute("transform",e):t.style(this.elem,"transform",e)},_getDistance:function(t){var e=t[0],n=t[1];return Math.sqrt(Math.pow(Math.abs(n.pageX-e.pageX),2)+Math.pow(Math.abs(n.pageY-e.pageY),2))},_trigger:function(t){this.$elem.triggerHandler("panzoom"+t,[this])},_startMove:function(n,s){var i,o,a,r,c=this,h=this.options,m=h.eventNamespace,u=t(document).off(m),l=this.getMatrix(),f=l.slice(0);t.style(this.elem,"transition","none"),1===arguments.length?(i=n,o=this._getDistance(i),a=+l[0],r=function(t){t.preventDefault();var e=c._getDistance(t.touches)-o;c.zoom(e/300+a)}):r=function(t){t.preventDefault();var e=t.pageX-n,i=t.pageY-s;l[4]=+f[4]+e,l[5]=+f[5]+i,c.setMatrix(l)},u.on((e?"touchend":"mouseup")+m,function(e){e.preventDefault(),t(this).off(m),c._trigger("end")}).on((e?"touchmove":"mousemove")+m,r)}},t.fn.panzoom=function(e){var n,o,a,r;return"string"==typeof e?(r=[],o=i.call(arguments,1),this.each(function(){n=t.data(this,s),n?"_"!==e.charAt(0)&&"function"==typeof(a=n[e])&&void 0!==(a=a.apply(n,o))&&r.push(a):r.push(void 0)}),r.length?1===r.length?r[0]:r:this):this.each(function(){new m(this,e)})},m});