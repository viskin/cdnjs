(function(a){if(typeof define!=="undefined"&&define.amd){define(["jquery"],a)}else{if(typeof module!=="undefined"&&module.exports){var b=require("jquery");module.exports=a(b)}else{window.scrollMonitor=a(jQuery)}}})(function(g){var F={};var v=g(window);var D=g(document);var f=[];var C="visibilityChange";var A="enterViewport";var y="fullyEnterViewport";var m="exitViewport";var h="partiallyExitViewport";var w="locationChange";var l="stateChange";var n=[C,A,y,m,h,w,l];var E={top:0,bottom:0};F.viewportTop;F.viewportBottom;F.documentHeight;F.viewportHeight=p();var u;var r;function p(){return window.innerHeight||document.documentElement.clientHeight}var a;function s(){F.viewportTop=v.scrollTop();F.viewportBottom=F.viewportTop+F.viewportHeight;F.documentHeight=D.height();if(F.documentHeight!==u){a=f.length;while(a--){f[a].recalculateLocation()}u=F.documentHeight}}function q(){F.viewportHeight=p();s();o()}var b;function t(){clearTimeout(b);b=setTimeout(q,100)}var e;function o(){e=f.length;while(e--){f[e].update()}e=f.length;while(e--){f[e].triggerCallbacks()}}function k(P,I){var S=this;this.watchItem=P;if(!I){this.offsets=E}else{if(I===+I){this.offsets={top:I,bottom:I}}else{this.offsets=g.extend({},E,I)}}this.callbacks={};for(var N=0,M=n.length;N<M;N++){S.callbacks[n[N]]=[]}this.locked=false;var L;var Q;var R;var O;var H;var G;function K(i){if(i.length===0){return}H=i.length;while(H--){G=i[H];G.callback.call(S,r);if(G.isOne){i.splice(H,1)}}}this.triggerCallbacks=function J(){if(this.isInViewport&&!L){K(this.callbacks[A])}if(this.isFullyInViewport&&!Q){K(this.callbacks[y])}if(this.isAboveViewport!==R&&this.isBelowViewport!==O){K(this.callbacks[C]);if(!Q&&!this.isFullyInViewport){K(this.callbacks[y]);K(this.callbacks[h])}if(!L&&!this.isInViewport){K(this.callbacks[A]);K(this.callbacks[m])}}if(!this.isFullyInViewport&&Q){K(this.callbacks[h])}if(!this.isInViewport&&L){K(this.callbacks[m])}if(this.isInViewport!==L){K(this.callbacks[C])}switch(true){case L!==this.isInViewport:case Q!==this.isFullyInViewport:case R!==this.isAboveViewport:case O!==this.isBelowViewport:K(this.callbacks[l])}L=this.isInViewport;Q=this.isFullyInViewport;R=this.isAboveViewport;O=this.isBelowViewport};this.recalculateLocation=function(){if(this.locked){return}var U=this.top;var T=this.bottom;if(this.watchItem.nodeName){var i=this.watchItem.style.display;if(i==="none"){this.watchItem.style.display=""}var j=g(this.watchItem).offset();this.top=j.top;this.bottom=j.top+this.watchItem.offsetHeight;if(i==="none"){this.watchItem.style.display=i}}else{if(this.watchItem===+this.watchItem){if(this.watchItem>0){this.top=this.bottom=this.watchItem}else{this.top=this.bottom=F.documentHeight-this.watchItem}}else{this.top=this.watchItem.top;this.bottom=this.watchItem.bottom}}this.top-=this.offsets.top;this.bottom+=this.offsets.bottom;this.height=this.bottom-this.top;if((U!==undefined||T!==undefined)&&(this.top!==U||this.bottom!==T)){K(this.callbacks[w])}};this.recalculateLocation();this.update();L=this.isInViewport;Q=this.isFullyInViewport;R=this.isAboveViewport;O=this.isBelowViewport}k.prototype={on:function(i,G,j){switch(true){case i===C&&!this.isInViewport&&this.isAboveViewport:case i===A&&this.isInViewport:case i===y&&this.isFullyInViewport:case i===m&&this.isAboveViewport&&!this.isInViewport:case i===h&&this.isAboveViewport:G();if(j){return}}if(this.callbacks[i]){this.callbacks[i].push({callback:G,isOne:j})}else{throw new Error("Tried to add a scroll monitor listener of type "+i+". Your options are: "+n.join(", "))}},off:function(H,I){if(this.callbacks[H]){for(var j=0,G;G=this.callbacks[H][j];j++){if(G.callback===I){this.callbacks[H].splice(j,1);break}}}else{throw new Error("Tried to remove a scroll monitor listener of type "+H+". Your options are: "+n.join(", "))}},one:function(i,j){this.on(i,j,true)},recalculateSize:function(){this.height=this.watchItem.offsetHeight+this.offsets.top+this.offsets.bottom;this.bottom=this.top+this.height},update:function(){this.isAboveViewport=this.top<F.viewportTop;this.isBelowViewport=this.bottom>F.viewportBottom;this.isInViewport=(this.top<=F.viewportBottom&&this.bottom>=F.viewportTop);this.isFullyInViewport=(this.top>=F.viewportTop&&this.bottom<=F.viewportBottom)||(this.isAboveViewport&&this.isBelowViewport)},destroy:function(){var I=f.indexOf(this),G=this;f.splice(I,1);for(var J=0,H=n.length;J<H;J++){G.callbacks[n[J]].length=0}},lock:function(){this.locked=true},unlock:function(){this.locked=false}};var d=function(i){return function(G,j){this.on.call(this,i,G,j)}};for(var B=0,z=n.length;B<z;B++){var c=n[B];k.prototype[c]=d(c)}s();function x(i){r=i;s();o()}v.on("scroll",x);v.on("resize",t);F.beget=F.create=function(j,G){if(typeof j==="string"){j=g(j)[0]}if(j instanceof g){j=j[0]}var i=new k(j,G);f.push(i);i.update();return i};F.update=function(){r=null;s();o()};F.recalculateLocations=function(){F.documentHeight=0;F.update()};return F});