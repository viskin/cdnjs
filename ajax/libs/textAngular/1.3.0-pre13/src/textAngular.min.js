!function(){"Use Strict";function e(e){try{return 0!==angular.element(e).length}catch(t){return!1}}function t(e,n){var a=[],r=e.children();return r.length&&angular.forEach(r,function(e){a=a.concat(t(angular.element(e),n))}),void 0!==e.attr(n)&&a.push(e),a}function n(t,n){if(!t||""===t||y.hasOwnProperty(t))throw"textAngular Error: A unique name is required for a Tool Definition";if(n.display&&(""===n.display||!e(n.display))||!n.display&&!n.buttontext&&!n.iconclass)throw'textAngular Error: Tool Definition for "'+t+'" does not have a valid display/iconclass/buttontext value';y[t]=n}var a={ie:function(){for(var e,t=3,n=document.createElement("div"),a=n.getElementsByTagName("i");n.innerHTML="<!--[if gt IE "+ ++t+"]><i></i><![endif]-->",a[0];);return t>4?t:e}(),webkit:/AppleWebKit\/([\d.]+)/i.test(navigator.userAgent)},r=!1;a.webkit&&(document.addEventListener("mousedown",function(e){var t=e||window.event,n=t.target;if(r&&null!==n){for(var a=!1,l=n;null!==l&&"html"!==l.tagName.toLowerCase()&&!a;)a="true"===l.contentEditable,l=l.parentNode;a||(document.getElementById("textAngular-editableFix-010203040506070809").setSelectionRange(0,0),n.focus(),n.select&&n.select())}r=!1},!1),angular.element(document).ready(function(){angular.element(document.body).append(angular.element('<input id="textAngular-editableFix-010203040506070809" style="width:1px;height:1px;border:none;margin:0;padding:0;position:absolute; top: -10000px; left: -10000px;" unselectable="on" tabIndex="-1">'))}));var l=/^(address|article|aside|audio|blockquote|canvas|dd|div|dl|fieldset|figcaption|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hgroup|hr|noscript|ol|output|p|pre|section|table|tfoot|ul|video)$/gi,o=/^(ul|li|ol)$/gi,i=/^(address|article|aside|audio|blockquote|canvas|dd|div|dl|fieldset|figcaption|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hgroup|hr|noscript|ol|output|p|pre|section|table|tfoot|ul|video|li)$/gi;String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var s,d,u,c,f;if(a.ie>8||void 0===a.ie){for(var p,m=document.styleSheets,h=0;h<m.length;h++)if((0===m[h].media.length||m[h].media.mediaText.match(/(all|screen)/gi))&&m[h].href){if(m[h].href.match(/textangular\.(min\.|)css/gi)){s=m[h];break}p=m[h]}!s&&p?s=p:s||(s=function(){var e=document.createElement("style");return a.webkit&&e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet}()),d=function(e,t){c(s,e,t)},c=function(e,t,n){var a;return e.cssRules?a=Math.max(e.cssRules.length-1,0):e.rules&&(a=Math.max(e.rules.length-1,0)),e.insertRule?e.insertRule(t+"{"+n+"}",a):e.addRule(t,n,a),a},u=function(e){f(s,e)},f=function(e,t){e.removeRule?e.removeRule(t):e.deleteRule(t)}}var g=!1,v=angular.module("textAngular",["ngSanitize","textAngularSetup"]),y={};v.constant("taRegisterTool",n),v.value("taTools",y),v.config([function(){angular.forEach(y,function(e,t){delete y[t]})}]),v.run([function(){if(!window.rangy)throw"rangy-core.js and rangy-selectionsaverestore.js are required for textAngular to work correctly, rangy-core is not yet loaded.";if(window.rangy.init(),!window.rangy.saveSelection)throw"rangy-selectionsaverestore.js is required for textAngular to work correctly."}]),v.directive("textAngular",["$compile","$timeout","taOptions","taSelection","taExecCommand","textAngularManager","$window","$document","$animate","$log","$q",function(e,t,n,a,r,l,o,i,s,d,u){return{require:"?ngModel",scope:{},restrict:"EA",link:function(c,f,p,m){var h,g,v,y,E,b,x,T,w,C=p.serial?p.serial:Math.floor(1e16*Math.random()),$=p.name?p.name:"textAngularEditor"+C,S=function(e,n,a){t(function(){var t=function(){e.off(n,t),a()};e.on(n,t)},100)};w=r(p.taDefaultWrap),angular.extend(c,angular.copy(n),{wrapSelection:function(e,t,n){"undo"===e.toLowerCase()?c["$undoTaBindtaTextElement"+C]():"redo"===e.toLowerCase()?c["$redoTaBindtaTextElement"+C]():(w(e,!1,t),n&&c["reApplyOnSelectorHandlerstaTextElement"+C](),c.displayElements.text[0].focus())},showHtml:!1}),p.taFocussedClass&&(c.classes.focussed=p.taFocussedClass),p.taTextEditorClass&&(c.classes.textEditor=p.taTextEditorClass),p.taHtmlEditorClass&&(c.classes.htmlEditor=p.taHtmlEditorClass),p.taTextEditorSetup&&(c.setup.textEditorSetup=c.$parent.$eval(p.taTextEditorSetup)),p.taHtmlEditorSetup&&(c.setup.htmlEditorSetup=c.$parent.$eval(p.taHtmlEditorSetup)),p.taFileDrop?c.fileDropHandler=c.$parent.$eval(p.taFileDrop):c.fileDropHandler=c.defaultFileDropHandler,x=f[0].innerHTML,f[0].innerHTML="",c.displayElements={forminput:angular.element("<input type='hidden' tabindex='-1' style='display: none;'>"),html:angular.element("<textarea></textarea>"),text:angular.element("<div></div>"),scrollWindow:angular.element("<div class='ta-scroll-window'></div>"),popover:angular.element('<div class="popover fade bottom" style="max-width: none; width: 305px;"></div>'),popoverArrow:angular.element('<div class="arrow"></div>'),popoverContainer:angular.element('<div class="popover-content"></div>'),resize:{overlay:angular.element('<div class="ta-resizer-handle-overlay"></div>'),background:angular.element('<div class="ta-resizer-handle-background"></div>'),anchors:[angular.element('<div class="ta-resizer-handle-corner ta-resizer-handle-corner-tl"></div>'),angular.element('<div class="ta-resizer-handle-corner ta-resizer-handle-corner-tr"></div>'),angular.element('<div class="ta-resizer-handle-corner ta-resizer-handle-corner-bl"></div>'),angular.element('<div class="ta-resizer-handle-corner ta-resizer-handle-corner-br"></div>')],info:angular.element('<div class="ta-resizer-handle-info"></div>')}},c.displayElements.popover.append(c.displayElements.popoverArrow),c.displayElements.popover.append(c.displayElements.popoverContainer),c.displayElements.scrollWindow.append(c.displayElements.popover),c.displayElements.popover.on("mousedown",function(e,t){return t&&angular.extend(e,t),e.preventDefault(),!1}),c.showPopover=function(e){c.displayElements.popover.css("display","block"),c.reflowPopover(e),s.addClass(c.displayElements.popover,"in"),S(f,"click keyup",function(){c.hidePopover()})},c.reflowPopover=function(e){c.displayElements.text[0].offsetHeight-51>e[0].offsetTop?(c.displayElements.popover.css("top",e[0].offsetTop+e[0].offsetHeight+"px"),c.displayElements.popover.removeClass("top").addClass("bottom")):(c.displayElements.popover.css("top",e[0].offsetTop-54+"px"),c.displayElements.popover.removeClass("bottom").addClass("top"));var t=c.displayElements.text[0].offsetWidth-c.displayElements.popover[0].offsetWidth,n=e[0].offsetLeft+e[0].offsetWidth/2-c.displayElements.popover[0].offsetWidth/2;c.displayElements.popover.css("left",Math.max(0,Math.min(t,n))+"px"),c.displayElements.popoverArrow.css("margin-left",Math.min(n,Math.max(0,n-t))-11+"px")},c.hidePopover=function(){var e=function(){c.displayElements.popover.css("display",""),c.displayElements.popoverContainer.attr("style",""),c.displayElements.popoverContainer.attr("class","popover-content")};u.when(s.removeClass(c.displayElements.popover,"in",e)).then(e)},c.displayElements.resize.overlay.append(c.displayElements.resize.background),angular.forEach(c.displayElements.resize.anchors,function(e){c.displayElements.resize.overlay.append(e)}),c.displayElements.resize.overlay.append(c.displayElements.resize.info),c.displayElements.scrollWindow.append(c.displayElements.resize.overlay),c.reflowResizeOverlay=function(e){e=angular.element(e)[0],c.displayElements.resize.overlay.css({display:"block",left:e.offsetLeft-5+"px",top:e.offsetTop-5+"px",width:e.offsetWidth+10+"px",height:e.offsetHeight+10+"px"}),c.displayElements.resize.info.text(e.offsetWidth+" x "+e.offsetHeight)},c.showResizeOverlay=function(e){var t=function(t){var n={width:parseInt(e.attr("width")),height:parseInt(e.attr("height")),x:t.clientX,y:t.clientY};void 0===n.width&&(n.width=e[0].offsetWidth),void 0===n.height&&(n.height=e[0].offsetHeight),c.hidePopover();var a=n.height/n.width,r=function(t){var r={x:Math.max(0,n.width+(t.clientX-n.x)),y:Math.max(0,n.height+(t.clientY-n.y))},l=function(e,t){e=angular.element(e),"img"===e[0].tagName.toLowerCase()&&(t.height&&(e.attr("height",t.height),delete t.height),t.width&&(e.attr("width",t.width),delete t.width)),e.css(t)};if(t.shiftKey){var o=r.y/r.x;l(e,{width:a>o?r.x:r.y/a,height:a>o?r.x*a:r.y})}else l(e,{width:r.x,height:r.y});c.reflowResizeOverlay(e)};i.find("body").on("mousemove",r),S(c.displayElements.resize.overlay,"mouseup",function(){i.find("body").off("mousemove",r),c.showPopover(e)}),t.stopPropagation(),t.preventDefault()};c.displayElements.resize.anchors[3].on("mousedown",t),c.reflowResizeOverlay(e),S(f,"click",function(){c.hideResizeOverlay()})},c.hideResizeOverlay=function(){c.displayElements.resize.overlay.css("display","")},c.setup.htmlEditorSetup(c.displayElements.html),c.setup.textEditorSetup(c.displayElements.text),c.displayElements.html.attr({id:"taHtmlElement"+C,"ng-show":"showHtml","ta-bind":"ta-bind","ng-model":"html"}),c.displayElements.text.attr({id:"taTextElement"+C,contentEditable:"true","ta-bind":"ta-bind","ng-model":"html"}),c.displayElements.scrollWindow.attr({"ng-hide":"showHtml"}),p.taDefaultWrap&&c.displayElements.text.attr("ta-default-wrap",p.taDefaultWrap),p.taUnsafeSanitizer&&(c.displayElements.text.attr("ta-unsafe-sanitizer",p.taUnsafeSanitizer),c.displayElements.html.attr("ta-unsafe-sanitizer",p.taUnsafeSanitizer)),c.displayElements.scrollWindow.append(c.displayElements.text),f.append(c.displayElements.scrollWindow),f.append(c.displayElements.html),c.displayElements.forminput.attr("name",$),f.append(c.displayElements.forminput),p.tabindex&&(f.removeAttr("tabindex"),c.displayElements.text.attr("tabindex",p.tabindex),c.displayElements.html.attr("tabindex",p.tabindex)),p.placeholder&&(c.displayElements.text.attr("placeholder",p.placeholder),c.displayElements.html.attr("placeholder",p.placeholder)),p.taDisabled&&(c.displayElements.text.attr("ta-readonly","disabled"),c.displayElements.html.attr("ta-readonly","disabled"),c.disabled=c.$parent.$eval(p.taDisabled),c.$parent.$watch(p.taDisabled,function(e){c.disabled=e,c.disabled?f.addClass(c.classes.disabled):f.removeClass(c.classes.disabled)})),e(c.displayElements.scrollWindow)(c),e(c.displayElements.html)(c),c.updateTaBindtaTextElement=c["updateTaBindtaTextElement"+C],c.updateTaBindtaHtmlElement=c["updateTaBindtaHtmlElement"+C],f.addClass("ta-root"),c.displayElements.scrollWindow.addClass("ta-text ta-editor "+c.classes.textEditor),c.displayElements.html.addClass("ta-html ta-editor "+c.classes.htmlEditor),c._actionRunning=!1;var L=!1;if(c.startAction=function(){return c._actionRunning=!0,L=o.rangy.saveSelection(),function(){L&&o.rangy.restoreSelection(L)}},c.endAction=function(){c._actionRunning=!1,L&&o.rangy.removeMarkers(L),L=!1,c.updateSelectedStyles(),c.showHtml||c["updateTaBindtaTextElement"+C]()},E=function(){f.addClass(c.classes.focussed),T.focus()},c.displayElements.html.on("focus",E),c.displayElements.text.on("focus",E),b=function(e){return c._actionRunning||i[0].activeElement===c.displayElements.html[0]||i[0].activeElement===c.displayElements.text[0]||(f.removeClass(c.classes.focussed),T.unfocus(),t(function(){f.triggerHandler("blur")},0)),e.preventDefault(),!1},c.displayElements.html.on("blur",b),c.displayElements.text.on("blur",b),c.queryFormatBlockState=function(e){return!c.showHtml&&e.toLowerCase()===i[0].queryCommandValue("formatBlock").toLowerCase()},c.queryCommandState=function(e){return c.showHtml?"":i[0].queryCommandState(e)},c.switchView=function(){c.showHtml=!c.showHtml,s.enabled(!1,c.displayElements.html),s.enabled(!1,c.displayElements.text),c.showHtml?t(function(){return s.enabled(!0,c.displayElements.html),s.enabled(!0,c.displayElements.text),c.displayElements.html[0].focus()},100):t(function(){return s.enabled(!0,c.displayElements.html),s.enabled(!0,c.displayElements.text),c.displayElements.text[0].focus()},100)},p.ngModel){var N=!0;m.$render=function(){if(N){N=!1;var e=c.$parent.$eval(p.ngModel);void 0!==e&&null!==e||!x||""===x||m.$setViewValue(x)}c.displayElements.forminput.val(m.$viewValue),c._elementSelectTriggered||i[0].activeElement===c.displayElements.html[0]||i[0].activeElement===c.displayElements.text[0]||(c.html=m.$viewValue||"")};var M=function(e){return p.required&&m.$setValidity("required",!(!e||""===e.trim())),e};m.$parsers.push(M),m.$formatters.push(M)}else c.displayElements.forminput.val(x),c.html=x;if(c.$watch("html",function(e,t){e!==t&&(p.ngModel&&m.$viewValue!==e&&m.$setViewValue(e),c.displayElements.forminput.val(e))}),p.taTargetToolbars)T=l.registerEditor($,c,p.taTargetToolbars.split(","));else{var A=angular.element('<div text-angular-toolbar name="textAngularToolbar'+C+'">');p.taToolbar&&A.attr("ta-toolbar",p.taToolbar),p.taToolbarClass&&A.attr("ta-toolbar-class",p.taToolbarClass),p.taToolbarGroupClass&&A.attr("ta-toolbar-group-class",p.taToolbarGroupClass),p.taToolbarButtonClass&&A.attr("ta-toolbar-button-class",p.taToolbarButtonClass),p.taToolbarActiveButtonClass&&A.attr("ta-toolbar-active-button-class",p.taToolbarActiveButtonClass),p.taFocussedClass&&A.attr("ta-focussed-class",p.taFocussedClass),f.prepend(A),e(A)(c.$parent),T=l.registerEditor($,c,["textAngularToolbar"+C])}c.$on("$destroy",function(){l.unregisterEditor($)}),c.$on("ta-element-select",function(e,t){T.triggerElementSelect(e,t)&&c["reApplyOnSelectorHandlerstaTextElement"+C]()}),c.$on("ta-drop-event",function(e,n,a,r){c.displayElements.text[0].focus(),r&&r.files&&r.files.length>0?(angular.forEach(r.files,function(e){try{u.when(c.fileDropHandler(e,c.wrapSelection)||c.fileDropHandler!==c.defaultFileDropHandler&&u.when(c.defaultFileDropHandler(e,c.wrapSelection))).then(function(){c["updateTaBindtaTextElement"+C]()})}catch(t){d.error(t)}}),a.preventDefault(),a.stopPropagation()):t(function(){c["updateTaBindtaTextElement"+C]()},0)}),c._bUpdateSelectedStyles=!1,c.updateSelectedStyles=function(){var e;void 0!==(e=a.getSelectionElement())&&e.parentNode!==c.displayElements.text[0]?T.updateSelectedStyles(angular.element(e)):T.updateSelectedStyles(),c._bUpdateSelectedStyles&&t(c.updateSelectedStyles,200)},h=function(){c._bUpdateSelectedStyles||(c._bUpdateSelectedStyles=!0,c.$apply(function(){c.updateSelectedStyles()}))},c.displayElements.html.on("keydown",h),c.displayElements.text.on("keydown",h),g=function(){c._bUpdateSelectedStyles=!1},c.displayElements.html.on("keyup",g),c.displayElements.text.on("keyup",g),v=function(e,t){t&&angular.extend(e,t),c.$apply(function(){return T.sendKeyCommand(e)?(c._bUpdateSelectedStyles||c.updateSelectedStyles(),e.preventDefault(),!1):void 0})},c.displayElements.html.on("keypress",v),c.displayElements.text.on("keypress",v),y=function(){c._bUpdateSelectedStyles=!1,c.$apply(function(){c.updateSelectedStyles()})},c.displayElements.html.on("mouseup",y),c.displayElements.text.on("mouseup",y)}}}]).factory("taBrowserTag",[function(){return function(e){return e?""===e?void 0===a.ie?"div":a.ie<=8?"P":"p":a.ie<=8?e.toUpperCase():e:a.ie<=8?"P":"p"}}]).factory("taExecCommand",["taSelection","taBrowserTag","$document",function(e,t,n){var a=function(t,n){var a,r,l=t.find("li");for(r=l.length-1;r>=0;r--)a=angular.element("<"+n+">"+l[r].innerHTML+"</"+n+">"),t.after(a);t.remove(),e.setSelectionToElementEnd(a[0])},r=function(t){/(<br(|\/)>)$/i.test(t.innerHTML.trim())?e.setSelectionBeforeElement(angular.element(t).find("br")[0]):e.setSelectionToElementEnd(t)},i=function(e,t){var n=angular.element("<"+t+">"+e[0].innerHTML+"</"+t+">");e.after(n),e.remove(),r(n.find("li")[0])},s=function(e,n,a){for(var l="",o=0;o<e.length;o++)l+="<"+t("li")+">"+e[o].innerHTML+"</"+t("li")+">";var i=angular.element("<"+a+">"+l+"</"+a+">");n.after(i),n.remove(),r(i.find("li")[0])};return function(r,d){return r=t(r),function(u,c,f){var p,m,h,g,v,y,E,b=angular.element("<"+r+">");try{E=e.getSelectionElement()}catch(x){}var T=angular.element(E);if(void 0!==E){var w=E.tagName.toLowerCase();if("insertorderedlist"===u.toLowerCase()||"insertunorderedlist"===u.toLowerCase()){var C=t("insertorderedlist"===u.toLowerCase()?"ol":"ul");if(w===C)return a(T,r);if("li"===w&&T.parent()[0].tagName.toLowerCase()===C&&1===T.parent().children().length)return a(T.parent(),r);if("li"===w&&T.parent()[0].tagName.toLowerCase()!==C&&1===T.parent().children().length)return i(T.parent(),C);if(w.match(l)&&!T.hasClass("ta-bind")){if("ol"===w||"ul"===w)return i(T,C);var $=!1;return angular.forEach(T.children(),function(e){e.tagName.match(l)&&($=!0)}),$?s(T.children(),T,C):s([angular.element("<div>"+E.innerHTML+"</div>")[0]],T,C)}if(w.match(l)){if(g=e.getOnlySelectedElements(),0===g.length)m=angular.element("<"+C+"><li>"+E.innerHTML+"</li></"+C+">"),T.html(""),T.append(m);else{if(1===g.length&&("ol"===g[0].tagName.toLowerCase()||"ul"===g[0].tagName.toLowerCase()))return g[0].tagName.toLowerCase()===C?a(angular.element(g[0]),r):i(angular.element(g[0]),C);h="";var S=[];for(p=0;p<g.length;p++)if(3!==g[p].nodeType){var L=angular.element(g[p]);if("li"===g[p].tagName.toLowerCase())continue;h+="ol"===g[p].tagName.toLowerCase()||"ul"===g[p].tagName.toLowerCase()?L[0].innerHTML:"<"+t("li")+">"+L[0].innerHTML+"</"+t("li")+">",S.unshift(L)}m=angular.element("<"+C+">"+h+"</"+C+">"),S.pop().replaceWith(m),angular.forEach(S,function(e){e.remove()})}return void e.setSelectionToElementEnd(m[0])}}else{if("formatblock"===u.toLowerCase()){for(y=f.toLowerCase().replace(/[<>]/gi,""),"default"===y.trim()&&(y=r,f="<"+r+">"),m="li"===w?T.parent():T;!m[0].tagName||!m[0].tagName.match(l)&&!m.parent().attr("contenteditable");)m=m.parent(),w=(m[0].tagName||"").toLowerCase();if(w===y){g=m.children();var N=!1;for(p=0;p<g.length;p++)N=N||g[p].tagName.match(l);N?(m.after(g),v=m.next(),m.remove(),m=v):(b.append(m[0].childNodes),m.after(b),m.remove(),m=b)}else if(m.parent()[0].tagName.toLowerCase()!==y||m.parent().hasClass("ta-bind"))if(w.match(o))m.wrap(f);else{for(g=e.getOnlySelectedElements(),0===g.length&&(g=[m[0]]),p=0;p<g.length;p++)if(3===g[p].nodeType||!g[p].tagName.match(l))for(;3===g[p].nodeType||!g[p].tagName||!g[p].tagName.match(l);)g[p]=g[p].parentNode;if(angular.element(g[0]).hasClass("ta-bind"))m=angular.element(f),m[0].innerHTML=g[0].innerHTML,g[0].innerHTML=m[0].outerHTML;else if("blockquote"===y){for(h="",p=0;p<g.length;p++)h+=g[p].outerHTML;for(m=angular.element(f),m[0].innerHTML=h,g[0].parentNode.insertBefore(m[0],g[0]),p=g.length-1;p>=0;p--)g[p].parentNode&&g[p].parentNode.removeChild(g[p])}else for(p=0;p<g.length;p++)m=angular.element(f),m[0].innerHTML=g[p].innerHTML,g[p].parentNode.insertBefore(m[0],g[p]),g[p].parentNode.removeChild(g[p])}else{var M=m.parent(),A=M.contents();for(p=0;p<A.length;p++)M.parent().hasClass("ta-bind")&&3===A[p].nodeType&&(b=angular.element("<"+r+">"),b[0].innerHTML=A[p].outerHTML,A[p]=b[0]),M.parent()[0].insertBefore(A[p],M[0]);M.remove()}return void e.setSelectionToElementEnd(m[0])}if("createlink"===u.toLowerCase()){var H=e.getSelection();if(H.collapsed)return void e.insertHtml('<a href="'+f+'">'+f+"</a>",d)}else if("inserthtml"===u.toLowerCase())return void e.insertHtml(f,d)}}try{n[0].execCommand(u,c,f)}catch(x){}}}}]).directive("taBind",["taSanitize","$timeout","$window","$document","taFixChrome","taBrowserTag","taSelection","taSelectableElements","taApplyCustomRenderers","taOptions",function(e,t,n,l,o,s,c,f,p,m){return{require:"ngModel",link:function(s,h,v,y){var E,b,x,T=void 0!==h.attr("contenteditable")&&h.attr("contenteditable"),w=T||"textarea"===h[0].tagName.toLowerCase()||"input"===h[0].tagName.toLowerCase(),C=!1,$=!1,S=v.taUnsafeSanitizer||m.disableSanitizer,L=/^(9|19|20|27|33|34|35|36|37|38|39|40|45|112|113|114|115|116|117|118|119|120|121|122|123|144|145)$/i,N=/^(8|13|32|46|59|61|107|109|186|187|188|189|190|191|192|219|220|221|222)$/i,M=/<(a|abbr|acronym|bdi|bdo|big|cite|code|del|dfn|img|ins|kbd|label|map|mark|q|ruby|rp|rt|s|samp|time|tt|var)[^>]*>/i,A=/^<[^>]+>(\s|&nbsp;)*<\/[^>]+>$/gi;void 0===v.taDefaultWrap&&(v.taDefaultWrap="p"),""===v.taDefaultWrap?(b="",x=void 0===a.ie?"<div><br></div>":a.ie>=11?"<p><br></p>":a.ie<=8?"<P>&nbsp;</P>":"<p>&nbsp;</p>"):(b=void 0===a.ie||a.ie>=11?"<"+v.taDefaultWrap+"><br></"+v.taDefaultWrap+">":a.ie<=8?"<"+v.taDefaultWrap.toUpperCase()+"></"+v.taDefaultWrap.toUpperCase()+">":"<"+v.taDefaultWrap+"></"+v.taDefaultWrap+">",x=void 0===a.ie||a.ie>=11?"<"+v.taDefaultWrap+"><br></"+v.taDefaultWrap+">":a.ie<=8?"<"+v.taDefaultWrap.toUpperCase()+">&nbsp;</"+v.taDefaultWrap.toUpperCase()+">":"<"+v.taDefaultWrap+">&nbsp;</"+v.taDefaultWrap+">");var H=function(e){return e=e.trim(),0===e.length||e===x||A.test(e)||!(/>\s*(([^\s<]+)\s*)+</i.test(e)||/^([^\s<>]+\s*)+$/i.test(e)||M.test(e))};h.addClass("ta-bind");var k;s["$undoManager"+(v.id||"")]=y.$undoManager={_stack:[],_index:0,_max:1e3,push:function(e){return"undefined"==typeof e||null===e||"undefined"!=typeof this.current()&&null!==this.current()&&e===this.current()?e:(this._index<this._stack.length-1&&(this._stack=this._stack.slice(0,this._index+1)),this._stack.push(e),k&&t.cancel(k),this._stack.length>this._max&&this._stack.shift(),this._index=this._stack.length-1,e)},undo:function(){return this.setToIndex(this._index-1)},redo:function(){return this.setToIndex(this._index+1)},setToIndex:function(e){return 0>e||e>this._stack.length-1?void 0:(this._index=e,this.current())},current:function(){return this._stack[this._index]}};var D=s["$undoTaBind"+(v.id||"")]=function(){if(!C&&T){var e=y.$undoManager.undo();"undefined"!=typeof e&&null!==e&&(h[0].innerHTML=e,_(e,!1),h[0].childNodes.length?c.setSelectionToElementEnd(h[0].childNodes[h[0].childNodes.length-1]):c.setSelectionToElementEnd(h[0]))}},W=s["$redoTaBind"+(v.id||"")]=function(){if(!C&&T){var e=y.$undoManager.redo();"undefined"!=typeof e&&null!==e&&(h[0].innerHTML=e,_(e,!1),h[0].childNodes.length?c.setSelectionToElementEnd(h[0].childNodes[h[0].childNodes.length-1]):c.setSelectionToElementEnd(h[0]))}},z=function(){if(T)return h[0].innerHTML;if(w)return h.val();throw"textAngular Error: attempting to update non-editable taBind"},_=function(e,t){"undefined"!=typeof t&&null!==t||(t=T),"undefined"!=typeof e&&null!==e||(e=z()),H(e)?(""!==y.$viewValue&&y.$setViewValue(""),t&&""!==y.$undoManager.current()&&y.$undoManager.push("")):y.$viewValue!==e&&(y.$setViewValue(e),t&&y.$undoManager.push(e))};if(s["updateTaBind"+(v.id||"")]=function(){C||_()},w)if(T){var B=function(e,t,n){h[0].childNodes&&h[0].childNodes.length>0?n(e,t):(that={s:e,_:t,cb:n},that.callself=function(){B(that.s,that._,that.cb)},setTimeout(that.callself,20))},V=function(a,r){if(text=h[0].innerHTML,h[0].innerHTML=a,n.rangy.restoreSelection(r),text.trim().length){if(text.match(/class=["']*Mso(Normal|List)/i)){var l=text.match(/<!--StartFragment-->([\s\S]*?)<!--EndFragment-->/i);l=l?l[1]:text,l=l.replace(/<o:p>[\s\S]*?<\/o:p>/gi,"").replace(/class=(["']|)MsoNormal(["']|)/gi,"");var o=angular.element("<div>"+l+"</div>"),i=angular.element("<div></div>"),s={element:null,lastIndent:[],lastLi:null,isUl:!1};s.lastIndent.peek=function(){var e=this.length;return e>0?this[e-1]:void 0};for(var d=function(e){s.isUl=e,s.element=angular.element(e?"<ul>":"<ol>"),s.lastIndent=[],s.lastIndent.peek=function(){var e=this.length;return e>0?this[e-1]:void 0},s.lastLevelMatch=null},u=0;u<=o[0].childNodes.length;u++)if(o[0].childNodes[u]&&"#text"!==o[0].childNodes[u].nodeName&&"p"===o[0].childNodes[u].tagName.toLowerCase()){var f=angular.element(o[0].childNodes[u]),p=(f.attr("class")||"").match(/MsoList(Bullet|Number|Paragraph)(CxSp(First|Middle|Last)|)/i);if(p){if(f[0].childNodes.length<2||f[0].childNodes[1].childNodes.length<1)continue;var m="bullet"===p[1].toLowerCase()||"number"!==p[1].toLowerCase()&&!(/^[^0-9a-z<]*[0-9a-z]+[^0-9a-z<>]</i.test(f[0].childNodes[1].innerHTML)||/^[^0-9a-z<]*[0-9a-z]+[^0-9a-z<>]</i.test(f[0].childNodes[1].childNodes[0].innerHTML)),g=(f.attr("style")||"").match(/margin-left:([\-\.0-9]*)/i),v=parseFloat(g?g[1]:0),E=(f.attr("style")||"").match(/mso-list:l([0-9]+) level([0-9]+) lfo[0-9+]($|;)/i);if(E&&E[2]&&(v=parseInt(E[2])),E&&(!s.lastLevelMatch||E[1]!==s.lastLevelMatch[1])||!p[3]||"first"===p[3].toLowerCase()||null===s.lastIndent.peek()||s.isUl!==m&&s.lastIndent.peek()===v)d(m),i.append(s.element);else if(null!=s.lastIndent.peek()&&s.lastIndent.peek()<v)s.element=angular.element(m?"<ul>":"<ol>"),s.lastLi.append(s.element);else if(null!=s.lastIndent.peek()&&s.lastIndent.peek()>v){for(;null!=s.lastIndent.peek()&&s.lastIndent.peek()>v;)if("li"!==s.element.parent()[0].tagName.toLowerCase()){if(!/[uo]l/i.test(s.element.parent()[0].tagName.toLowerCase()))break;s.element=s.element.parent(),s.lastIndent.pop()}else s.element=s.element.parent();s.isUl="ul"===s.element[0].tagName.toLowerCase(),m!==s.isUl&&(d(m),i.append(s.element))}s.lastLevelMatch=E,v!==s.lastIndent.peek()&&s.lastIndent.push(v),s.lastLi=angular.element("<li>"),s.element.append(s.lastLi),s.lastLi.html(f.html().replace(/<!(--|)\[if !supportLists\](--|)>[\s\S]*?<!(--|)\[endif\](--|)>/gi,"")),f.remove()}else d(!1),i.append(f)}var b=function(e){e=angular.element(e);for(var t=e[0].childNodes.length-1;t>=0;t--)e.after(e[0].childNodes[t]);e.remove()};angular.forEach(i.find("span"),function(e){e.removeAttribute("lang"),e.attributes.length<=0&&b(e)}),angular.forEach(i.find("font"),b),text=i.html()}text=e(text,"",S),c.insertHtml(text,h[0]),t(function(){y.$setViewValue(z())},0)}};if(h.on("paste",function(e,t){t&&angular.extend(e,t);var a=n.rangy.saveSelection();if(C)return e.stopPropagation(),e.preventDefault(),!1;var r=h[0].innerHTML,l=(e.originalEvent||e).clipboardData;if(l&&l.getData){for(var o="",i=0;i<l.types.length;i++)o+=" "+l.types[i];return/text\/html/i.test(o)?h[0].innerHTML=l.getData("text/html"):/text\/plain/i.test(o)?h[0].innerHTML=l.getData("text/plain"):h[0].innerHTML="",B(r,a,V),e.stopPropagation(),e.preventDefault(),!1}return h[0].innerHTML="",B(r,a,V),!0}),h.on("cut",function(e){C?e.preventDefault():t(function(){y.$setViewValue(z())},0)}),h.on("keydown",function(e,t){if(t&&angular.extend(e,t),!C)if(e.metaKey||e.ctrlKey)90!==e.keyCode||e.shiftKey?(90===e.keyCode&&e.shiftKey||89===e.keyCode&&!e.shiftKey)&&(W(),e.preventDefault()):(D(),e.preventDefault());else if(13===e.keyCode&&!e.shiftKey){var n=c.getSelectionElement();if(!n.tagName.match(i))return;var a=angular.element(b);if(/^<br(|\/)>$/i.test(n.innerHTML.trim())&&"blockquote"===n.parentNode.tagName.toLowerCase()&&!n.nextSibling){$selection=angular.element(n);var r=$selection.parent();r.after(a),$selection.remove(),0===r.children().length&&r.remove(),c.setSelectionToElementStart(a[0]),e.preventDefault()}else/^<[^>]+><br(|\/)><\/[^>]+>$/i.test(n.innerHTML.trim())&&"blockquote"===n.tagName.toLowerCase()&&($selection=angular.element(n),$selection.after(a),$selection.remove(),c.setSelectionToElementStart(a[0]),e.preventDefault())}}),h.on("keyup",function(e,n){if(n&&angular.extend(e,n),k&&t.cancel(k),!C&&!L.test(e.keyCode)){if(""!==b&&13===e.keyCode&&!e.shiftKey){for(var a=c.getSelectionElement();!a.tagName.match(i)&&a!==h[0];)a=a.parentNode;if(a.tagName.toLowerCase()!==v.taDefaultWrap&&"li"!==a.tagName.toLowerCase()&&(""===a.innerHTML.trim()||"<br>"===a.innerHTML.trim())){var r=angular.element(b);angular.element(a).replaceWith(r),c.setSelectionToElementStart(r[0])}}var l=z();""!==b&&""===l.trim()&&(h[0].innerHTML=b,c.setSelectionToElementStart(h.children()[0]));var o=E!==e.keyCode&&N.test(e.keyCode);_(l,o),o||(k=t(function(){y.$undoManager.push(l)},250)),E=e.keyCode}}),h.on("blur",function(){$=!1,C||_(),y.$render()}),v.placeholder&&(a.ie>8||void 0===a.ie)){var R;if(!v.id)throw"textAngular Error: An unique ID is required for placeholders to work";R=d("#"+v.id+".placeholder-text:before",'content: "'+v.placeholder+'"'),s.$on("$destroy",function(){u(R)})}h.on("focus",function(){$=!0,y.$render()}),h.on("mousedown",function(e,t){t&&angular.extend(e,t),e.stopPropagation()})}else h.on("change blur",function(){C||y.$setViewValue(z())});var q=function(t){return y.$oldViewValue=e(o(t),y.$oldViewValue,S)},I=function(e){return v.required&&y.$setValidity("required",!H(e)),e};y.$parsers.push(q),y.$parsers.push(I),y.$formatters.push(q),y.$formatters.push(function(e){if(H(e))return e;var t=angular.element("<div>"+e+"</div>");return 0===t.children().length&&(e="<"+v.taDefaultWrap+">"+e+"</"+v.taDefaultWrap+">"),e}),y.$formatters.push(I),y.$formatters.push(function(e){return y.$undoManager.push(e||"")});var F=function(e){return s.$emit("ta-element-select",this),e.preventDefault(),!1},O=function(e,n){if(n&&angular.extend(e,n),!g&&!C){g=!0;var a;a=e.originalEvent?e.originalEvent.dataTransfer:e.dataTransfer,s.$emit("ta-drop-event",this,e,a),t(function(){g=!1,_(),U()},100)}},U=s["reApplyOnSelectorHandlers"+(v.id||"")]=function(){C||angular.forEach(f,function(e){h.find(e).off("click",F).on("click",F)})},P=function(e){h[0].innerHTML=e};y.$render=function(){var e=y.$viewValue||"";l[0].activeElement!==h[0]?T?(v.placeholder?""===e?($?h.removeClass("placeholder-text"):h.addClass("placeholder-text"),P(b)):(h.removeClass("placeholder-text"),P(e)):P(""===e?b:e),C?h.off("drop",O):(U(),h.on("drop",O))):"textarea"!==h[0].tagName.toLowerCase()&&"input"!==h[0].tagName.toLowerCase()?P(p(e)):h.val(e):T&&h.removeClass("placeholder-text")},v.taReadonly&&(C=s.$eval(v.taReadonly),C?(h.addClass("ta-readonly"),"textarea"!==h[0].tagName.toLowerCase()&&"input"!==h[0].tagName.toLowerCase()||h.attr("disabled","disabled"),void 0!==h.attr("contenteditable")&&h.attr("contenteditable")&&h.removeAttr("contenteditable")):(h.removeClass("ta-readonly"),"textarea"===h[0].tagName.toLowerCase()||"input"===h[0].tagName.toLowerCase()?h.removeAttr("disabled"):T&&h.attr("contenteditable","true")),s.$watch(v.taReadonly,function(e,t){t!==e&&(e?(h.addClass("ta-readonly"),"textarea"!==h[0].tagName.toLowerCase()&&"input"!==h[0].tagName.toLowerCase()||h.attr("disabled","disabled"),void 0!==h.attr("contenteditable")&&h.attr("contenteditable")&&h.removeAttr("contenteditable"),angular.forEach(f,function(e){h.find(e).on("click",F)}),h.off("drop",O)):(h.removeClass("ta-readonly"),"textarea"===h[0].tagName.toLowerCase()||"input"===h[0].tagName.toLowerCase()?h.removeAttr("disabled"):T&&h.attr("contenteditable","true"),angular.forEach(f,function(e){h.find(e).off("click",F)}),h.on("drop",O)),C=e)})),T&&!C&&(angular.forEach(f,function(e){h.find(e).on("click",F)}),h.on("drop",O),h.on("blur",function(){a.webkit&&(r=!0)}))}}}]).factory("taApplyCustomRenderers",["taCustomRenderers",function(e){return function(n){var a=angular.element("<div></div>");return a[0].innerHTML=n,angular.forEach(e,function(e){var n=[];e.selector&&""!==e.selector?n=a.find(e.selector):e.customAttribute&&""!==e.customAttribute&&(n=t(a,e.customAttribute)),angular.forEach(n,function(t){t=angular.element(t),e.selector&&""!==e.selector&&e.customAttribute&&""!==e.customAttribute?void 0!==t.attr(e.customAttribute)&&e.renderLogic(t):e.renderLogic(t)})}),a[0].innerHTML}}]).directive("taMaxText",function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,a){function r(e){var t=angular.element("<div/>");t.html(e);var n=t.text().length;return l>=n?(a.$setValidity("taMaxText",!0),e):void a.$setValidity("taMaxText",!1)}var l=parseInt(e.$eval(n.taMaxText));if(isNaN(l))throw"Max text must be an integer";n.$observe("taMaxText",function(e){if(l=parseInt(e),isNaN(l))throw"Max text must be an integer";a.$dirty&&a.$setViewValue(a.$viewValue)}),a.$parsers.unshift(r)}}}).directive("taMinText",function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,a){function r(e){var t=angular.element("<div/>");t.html(e);var n=t.text().length;return!n||n>=l?(a.$setValidity("taMinText",!0),e):void a.$setValidity("taMinText",!1)}var l=parseInt(e.$eval(n.taMinText));if(isNaN(l))throw"Min text must be an integer";n.$observe("taMinText",function(e){if(l=parseInt(e),isNaN(l))throw"Min text must be an integer";a.$dirty&&a.$setViewValue(a.$viewValue)}),a.$parsers.unshift(r)}}}).factory("taFixChrome",function(){var e=function(e){for(var t=angular.element("<div>"+e+"</div>"),n=angular.element(t).find("span"),a=0;a<n.length;a++){var r=angular.element(n[a]);
r.attr("style")&&r.attr("style").match(/line-height: 1.428571429;|color: inherit; line-height: 1.1;/i)&&(r.attr("style",r.attr("style").replace(/( |)font-family: inherit;|( |)line-height: 1.428571429;|( |)line-height:1.1;|( |)color: inherit;/gi,"")),r.attr("style")&&""!==r.attr("style")||(r.next().length>0&&"BR"===r.next()[0].tagName&&r.next().remove(),r.replaceWith(r[0].innerHTML)))}var l=t[0].innerHTML.replace(/style="[^"]*?(line-height: 1.428571429;|color: inherit; line-height: 1.1;)[^"]*"/gi,"");return l!==t[0].innerHTML&&(t[0].innerHTML=l),t[0].innerHTML};return e}).factory("taSanitize",["$sanitize",function(e){return function(n,a,r){var l=angular.element("<div>"+n+"</div>");angular.forEach(t(l,"align"),function(e){e.css("text-align",e.attr("align")),e.removeAttr("align")});var o;n=l[0].innerHTML;try{o=e(n),r&&(o=n)}catch(i){o=a||""}return o}}]).directive("textAngularToolbar",["$compile","textAngularManager","taOptions","taTools","taToolExecuteAction","$window",function(e,t,n,a,r,l){return{scope:{name:"@"},restrict:"EA",link:function(o,i,s){if(!o.name||""===o.name)throw"textAngular Error: A toolbar requires a name";angular.extend(o,angular.copy(n)),s.taToolbar&&(o.toolbar=o.$parent.$eval(s.taToolbar)),s.taToolbarClass&&(o.classes.toolbar=s.taToolbarClass),s.taToolbarGroupClass&&(o.classes.toolbarGroup=s.taToolbarGroupClass),s.taToolbarButtonClass&&(o.classes.toolbarButton=s.taToolbarButtonClass),s.taToolbarActiveButtonClass&&(o.classes.toolbarButtonActive=s.taToolbarActiveButtonClass),s.taFocussedClass&&(o.classes.focussed=s.taFocussedClass),o.disabled=!0,o.focussed=!1,o._$element=i,i[0].innerHTML="",i.addClass("ta-toolbar "+o.classes.toolbar),o.$watch("focussed",function(){o.focussed?i.addClass(o.classes.focussed):i.removeClass(o.classes.focussed)});var d=function(t,n){var a;if(a=t&&t.display?angular.element(t.display):angular.element("<button type='button'>"),t&&t["class"]?a.addClass(t["class"]):a.addClass(o.classes.toolbarButton),a.attr("name",n.name),a.attr("unselectable","on"),a.attr("ng-disabled","isDisabled()"),a.attr("tabindex","-1"),a.attr("ng-click","executeAction()"),a.attr("ng-class","displayActiveToolClass(active)"),t&&t.tooltiptext&&a.attr("title",t.tooltiptext),a.on("mousedown",function(e,t){return t&&angular.extend(e,t),e.preventDefault(),!1}),t&&!t.display&&!n._display&&(a[0].innerHTML="",t.buttontext&&(a[0].innerHTML=t.buttontext),t.iconclass)){var r=angular.element("<i>"),l=a[0].innerHTML;r.addClass(t.iconclass),a[0].innerHTML="",a.append(r),l&&""!==l&&a.append("&nbsp;"+l)}return n._lastToolDefinition=angular.copy(t),e(a)(n)};o.tools={},o._parent={disabled:!0,showHtml:!1,queryFormatBlockState:function(){return!1},queryCommandState:function(){return!1}};var u={$window:l,$editor:function(){return o._parent},isDisabled:function(){return"function"!=typeof this.$eval("disabled")&&this.$eval("disabled")||this.$eval("disabled()")||"html"!==this.name&&this.$editor().showHtml||this.$parent.disabled||this.$editor().disabled},displayActiveToolClass:function(e){return e?o.classes.toolbarButtonActive:""},executeAction:r};angular.forEach(o.toolbar,function(e){var t=angular.element("<div>");t.addClass(o.classes.toolbarGroup),angular.forEach(e,function(e){o.tools[e]=angular.extend(o.$new(!0),a[e],u,{name:e}),o.tools[e].$element=d(a[e],o.tools[e]),t.append(o.tools[e].$element)}),i.append(t)}),o.updateToolDisplay=function(e,t,n){var a=o.tools[e];if(a){if(a._lastToolDefinition&&!n&&(t=angular.extend({},a._lastToolDefinition,t)),null===t.buttontext&&null===t.iconclass&&null===t.display)throw'textAngular Error: Tool Definition for updating "'+e+'" does not have a valid display/iconclass/buttontext value';null===t.buttontext&&delete t.buttontext,null===t.iconclass&&delete t.iconclass,null===t.display&&delete t.display;var r=d(t,a);a.$element.replaceWith(r),a.$element=r}},o.addTool=function(e,t,n,r){o.tools[e]=angular.extend(o.$new(!0),a[e],u,{name:e}),o.tools[e].$element=d(a[e],o.tools[e]);var l;void 0===n&&(n=o.toolbar.length-1),l=angular.element(i.children()[n]),void 0===r?(l.append(o.tools[e].$element),o.toolbar[n][o.toolbar[n].length-1]=e):(l.children().eq(r).after(o.tools[e].$element),o.toolbar[n][r]=e)},t.registerToolbar(o),o.$on("$destroy",function(){t.unregisterToolbar(o.name)})}}}]).service("taToolExecuteAction",["$q","$log",function(e,t){return function(n){void 0!==n&&(this.$editor=function(){return n});var a=e.defer(),r=a.promise,l=this.$editor();r["finally"](function(){l.endAction.call(l)});var o;try{o=this.action(a,l.startAction())}catch(i){t.error(i)}(o||void 0===o)&&a.resolve()}}]).service("textAngularManager",["taToolExecuteAction","taTools","taRegisterTool",function(e,t,n){var a={},r={};return{registerEditor:function(n,l,o){if(!n||""===n)throw"textAngular Error: An editor requires a name";if(!l)throw"textAngular Error: An editor requires a scope";if(r[n])throw'textAngular Error: An Editor with name "'+n+'" already exists';var i=[];return angular.forEach(o,function(e){a[e]&&i.push(a[e])}),r[n]={scope:l,toolbars:o,_registerToolbar:function(e){this.toolbars.indexOf(e.name)>=0&&i.push(e)},editorFunctions:{disable:function(){angular.forEach(i,function(e){e.disabled=!0})},enable:function(){angular.forEach(i,function(e){e.disabled=!1})},focus:function(){angular.forEach(i,function(e){e._parent=l,e.disabled=!1,e.focussed=!0})},unfocus:function(){angular.forEach(i,function(e){e.disabled=!0,e.focussed=!1})},updateSelectedStyles:function(e){angular.forEach(i,function(t){angular.forEach(t.tools,function(n){n.activeState&&(t._parent=l,n.active=n.activeState(e))})})},sendKeyCommand:function(n){var a=!1;return(n.ctrlKey||n.metaKey)&&angular.forEach(t,function(t,r){if(t.commandKeyCode&&t.commandKeyCode===n.which)for(var o=0;o<i.length;o++)if(void 0!==i[o].tools[r]){e.call(i[o].tools[r],l),a=!0;break}}),a},triggerElementSelect:function(e,n){var a=function(e,t){for(var n=!0,a=0;a<t.length;a++)n=n&&e.attr(t[a]);return n},r=[],o={},s=!1;n=angular.element(n);var d=!1;if(angular.forEach(t,function(e,t){e.onElementSelect&&e.onElementSelect.element&&e.onElementSelect.element.toLowerCase()===n[0].tagName.toLowerCase()&&(!e.onElementSelect.filter||e.onElementSelect.filter(n))&&(d=d||angular.isArray(e.onElementSelect.onlyWithAttrs)&&a(n,e.onElementSelect.onlyWithAttrs),e.onElementSelect.onlyWithAttrs&&!a(n,e.onElementSelect.onlyWithAttrs)||(o[t]=e))}),d?(angular.forEach(o,function(e,t){e.onElementSelect.onlyWithAttrs&&a(n,e.onElementSelect.onlyWithAttrs)&&r.push({name:t,tool:e})}),r.sort(function(e,t){return t.tool.onElementSelect.onlyWithAttrs.length-e.tool.onElementSelect.onlyWithAttrs.length})):angular.forEach(o,function(e,t){r.push({name:t,tool:e})}),r.length>0)for(var u=0;u<r.length;u++){for(var c=r[u].tool,f=r[u].name,p=0;p<i.length;p++)if(void 0!==i[p].tools[f]){c.onElementSelect.action.call(i[p].tools[f],e,n,l),s=!0;break}if(s)break}return s}}},r[n].editorFunctions},retrieveEditor:function(e){return r[e]},unregisterEditor:function(e){delete r[e]},registerToolbar:function(e){if(!e)throw"textAngular Error: A toolbar requires a scope";if(!e.name||""===e.name)throw"textAngular Error: A toolbar requires a name";if(a[e.name])throw'textAngular Error: A toolbar with name "'+e.name+'" already exists';a[e.name]=e,angular.forEach(r,function(t){t._registerToolbar(e)})},retrieveToolbar:function(e){return a[e]},retrieveToolbarsViaEditor:function(e){var t=[],n=this;return angular.forEach(this.retrieveEditor(e).toolbars,function(e){t.push(n.retrieveToolbar(e))}),t},unregisterToolbar:function(e){delete a[e]},updateToolsDisplay:function(e){var t=this;angular.forEach(e,function(e,n){t.updateToolDisplay(n,e)})},resetToolsDisplay:function(){var e=this;angular.forEach(t,function(t,n){e.resetToolDisplay(n)})},updateToolDisplay:function(e,t){var n=this;angular.forEach(a,function(a,r){n.updateToolbarToolDisplay(r,e,t)})},resetToolDisplay:function(e){var t=this;angular.forEach(a,function(n,a){t.resetToolbarToolDisplay(a,e)})},updateToolbarToolDisplay:function(e,t,n){if(!a[e])throw'textAngular Error: No Toolbar with name "'+e+'" exists';a[e].updateToolDisplay(t,n)},resetToolbarToolDisplay:function(e,n){if(!a[e])throw'textAngular Error: No Toolbar with name "'+e+'" exists';a[e].updateToolDisplay(n,t[n],!0)},removeTool:function(e){delete t[e],angular.forEach(a,function(t){delete t.tools[e];for(var n=0;n<t.toolbar.length;n++){for(var a,r=0;r<t.toolbar[n].length;r++){if(t.toolbar[n][r]===e){a={group:n,index:r};break}if(void 0!==a)break}void 0!==a&&(t.toolbar[a.group].slice(a.index,1),t._$element.children().eq(a.group).children().eq(a.index).remove())}})},addTool:function(e,t,r,l){n(e,t),angular.forEach(a,function(n){n.addTool(e,t,r,l)})},addToolToToolbar:function(e,t,r,l,o){n(e,t),a[r].addTool(e,t,l,o)},refreshEditor:function(e){if(!r[e])throw'textAngular Error: No Editor with name "'+e+'" exists';r[e].scope.updateTaBindtaTextElement(),r[e].scope.$$phase||r[e].scope.$digest()}}}]).service("taSelection",["$window","$document",function(e,t){var n=t[0],a=e.rangy,r={getSelection:function(){var e=a.getSelection().getRangeAt(0),t=e.commonAncestorContainer;return t=3===t.nodeType?t.parentNode:t,{start:{element:e.startContainer,offset:e.startOffset},end:{element:e.endContainer,offset:e.endOffset},container:t,collapsed:e.collapsed}},getOnlySelectedElements:function(){var e=a.getSelection();return e.getRangeAt(0).getNodes([1])},getSelectionElement:function(){return r.getSelection().container},setSelection:function(e,t,n){var r=a.createRange();r.setStart(e,t),r.setEnd(e,n),a.getSelection().setSingleRange(r)},setSelectionBeforeElement:function(e){var t=a.createRange();t.selectNode(e),t.collapse(!0),a.getSelection().setSingleRange(t)},setSelectionAfterElement:function(e){var t=a.createRange();t.selectNode(e),t.collapse(!1),a.getSelection().setSingleRange(t)},setSelectionToElementStart:function(e){var t=a.createRange();t.selectNodeContents(e),t.collapse(!0),a.getSelection().setSingleRange(t)},setSelectionToElementEnd:function(e){var t=a.createRange();t.selectNodeContents(e),t.collapse(!1),a.getSelection().setSingleRange(t)},insertHtml:function(e,t){var o,i,s,d,u,c,f,p,m,h=angular.element("<div>"+e+"</div>"),g=a.getSelection().getRangeAt(0),v=n.createDocumentFragment(),y=h[0].childNodes,E=!0;if(y.length>0){for(d=[],s=0;s<y.length;s++)"p"===y[s].nodeName.toLowerCase()&&""===y[s].innerHTML.trim()||3===y[s].nodeType&&""===y[s].nodeValue.trim()||(E=E&&!l.test(y[s].nodeName),d.push(y[s]));for(var b in d)m=v.appendChild(d[b])}else E=!0,m=v=n.createTextNode(e);if(E)g.deleteContents();else if(g.collapsed&&g.startContainer!==t&&g.startContainer.parentNode!==t){if(3===g.startContainer.nodeType){for(o=g.startContainer.parentNode,d=o.childNodes,c=[],f=[],u=0;u<d.length&&(c.push(d[u]),d[u]!==g.startContainer);u++);for(f.push(n.createTextNode(g.startContainer.nodeValue.substring(g.startOffset))),g.startContainer.nodeValue=g.startContainer.nodeValue.substring(0,g.startOffset),p=u+1;p<d.length;p++)f.push(d[p]);i=o.cloneNode(),o.childNodes=c,i.childNodes=f}else o=g.startContainer,i=o.cloneNode(),i.innerHTML=o.innerHTML.substring(g.startOffset),o.innerHTML=o.innerHTML.substring(0,g.startOffset);angular.element(o).after(i),g.setStartAfter(o),g.setEndAfter(o),/^(|<br(|\/)>)$/i.test(o.innerHTML.trim())&&(g.setStartBefore(o),g.setEndBefore(o),angular.element(o).remove()),/^(|<br(|\/)>)$/i.test(i.innerHTML.trim())&&angular.element(i).remove()}else g.deleteContents();g.insertNode(v),m&&r.setSelectionToElementEnd(m)}};return r}])}();
//# sourceMappingURL=./textAngular.min.js.map