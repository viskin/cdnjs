!function(){"Use Strict";function e(e){try{return 0!==angular.element(e).length}catch(t){return!1}}function t(e,t){var a=Math.max(r.rules.length-1,0);return r.insertRule?r.insertRule(e+"{"+t+"}",a):r.addRule(e,t,a),a}function a(e){r.removeRule?r.removeRule(e):r.deleteRule(e)}function n(e,t){var a=[],o=e.children();return o.length&&angular.forEach(o,function(e){a=a.concat(n(angular.element(e),t))}),void 0!==e.attr(t)&&a.push(e),a}function o(t,a){if(!t||""===t||u.hasOwnProperty(t))throw"textAngular Error: A unique name is required for a Tool Definition";if(a.display&&(""===a.display||!e(a.display))||!a.display&&!a.buttontext&&!a.iconclass)throw'textAngular Error: Tool Definition for "'+t+'" does not have a valid display/iconclass/buttontext value';u[t]=a}var l=function(){var e,t=-1,a=window.navigator.userAgent,n=a.indexOf("MSIE "),o=a.indexOf("Trident/");if(n>0)t=parseInt(a.substring(n+5,a.indexOf(".",n)),10);else if(o>0){var l=a.indexOf("rv:");t=parseInt(a.substring(l+3,a.indexOf(".",l)),10)}return t>-1?t:e}(),r=function(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet}(),i=!1,s=angular.module("textAngular",["ngSanitize"]);if(void 0===textAngularSetup)throw"textAngular Error: Setup Options are not defined, see textAngularSetup.js for example.";s.value("taOptions",textAngularSetup.options),s.value("taSelectableElements",textAngularSetup.selectableElements),s.value("taCustomRenderers",textAngularSetup.customDisplayRenderers);var u={};s.constant("taTranslations",textAngularSetup.translationStrings),s.constant("taRegisterTool",o),s.value("taTools",u),s.run(["taRegisterTool","$window","taTranslations",function(e,t,a){angular.forEach(u,function(e,t){delete u[t]}),textAngularSetup.registerToolsFunction(e,t,a)}]),s.directive("textAngular",["$compile","$timeout","taOptions","taSanitize","textAngularManager","$window","$animate","$log",function(e,t,a,n,o,l,r,i){return{require:"?ngModel",scope:{},restrict:"EA",link:function(n,s,u,d){var c,p,f,m,g,h,v,y,b=Math.floor(1e16*Math.random()),E=u.name?u.name:"textAngularEditor"+b;angular.extend(n,angular.copy(a),{wrapSelection:function(e,t,a){try{document.execCommand(e,!1,t)}catch(o){}a&&n["reApplyOnSelectorHandlerstaTextElement"+b](),n.displayElements.text[0].focus()},showHtml:!1}),u.taFocussedClass&&(n.classes.focussed=u.taFocussedClass),u.taTextEditorClass&&(n.classes.textEditor=u.taTextEditorClass),u.taHtmlEditorClass&&(n.classes.htmlEditor=u.taHtmlEditorClass),u.taTextEditorSetup&&(n.setup.textEditorSetup=n.$parent.$eval(u.taTextEditorSetup)),u.taHtmlEditorSetup&&(n.setup.htmlEditorSetup=n.$parent.$eval(u.taHtmlEditorSetup)),u.taFileDrop?n.fileDropHandler=n.$parent.$eval(u.taFileDrop):n.fileDropHandler=n.defaultFileDropHandler,v=s[0].innerHTML,s[0].innerHTML="",n.displayElements={forminput:angular.element("<input type='hidden' tabindex='-1' style='display: none;'>"),html:angular.element("<textarea></textarea>"),text:angular.element("<div></div>"),popover:angular.element('<div class="popover fade bottom" style="max-width: none; width: 305px;"><div class="arrow"></div></div>'),popoverContainer:angular.element('<div class="popover-content"></div>')},n.displayElements.popover.append(n.displayElements.popoverContainer),s.append(n.displayElements.popover),n.displayElements.popover.on("mousedown",function(e,t){return t&&angular.extend(e,t),e.preventDefault(),!1}),n.showPopover=function(e){n.displayElements.popover.css("top",e[0].offsetTop+e[0].offsetHeight+"px"),n.displayElements.popover.css("left",e[0].offsetLeft+e[0].offsetWidth/2-152.5+"px"),n.displayElements.popover.css("display","block"),r.addClass(n.displayElements.popover,"in"),t(function(){var e=function(){s.off("click",e),n.hidePopover()};s.on("click",e)},100)},n.hidePopover=function(){r.removeClass(n.displayElements.popover,"in",function(){n.displayElements.popover.css("display",""),n.displayElements.popoverContainer.attr("style",""),n.displayElements.popoverContainer.attr("class","popover-content")})},n.setup.htmlEditorSetup(n.displayElements.html),n.setup.textEditorSetup(n.displayElements.text),n.displayElements.html.attr({id:"taHtmlElement"+b,"ng-show":"showHtml","ta-bind":"ta-bind","ng-model":"html"}),n.displayElements.text.attr({id:"taTextElement"+b,contentEditable:"true","ng-hide":"showHtml","ta-bind":"ta-bind","ng-model":"html"}),u.taDefaultWrap&&n.displayElements.text.attr("ta-default-wrap",u.taDefaultWrap),s.append(n.displayElements.text),s.append(n.displayElements.html),n.displayElements.forminput.attr("name",E),s.append(n.displayElements.forminput),u.tabindex&&(s.removeAttr("tabindex"),n.displayElements.text.attr("tabindex",u.tabindex),n.displayElements.html.attr("tabindex",u.tabindex)),u.placeholder&&(n.displayElements.text.attr("placeholder",u.placeholder),n.displayElements.html.attr("placeholder",u.placeholder)),u.taDisabled&&(n.displayElements.text.attr("ta-readonly","disabled"),n.displayElements.html.attr("ta-readonly","disabled"),n.disabled=n.$parent.$eval(u.taDisabled),n.$parent.$watch(u.taDisabled,function(e){n.disabled=e,n.disabled?s.addClass(n.classes.disabled):s.removeClass(n.classes.disabled)})),e(n.displayElements.text)(n),e(n.displayElements.html)(n),n.updateTaBindtaTextElement=n["updateTaBindtaTextElement"+b],n.updateTaBindtaHtmlElement=n["updateTaBindtaHtmlElement"+b],s.addClass("ta-root"),n.displayElements.text.addClass("ta-text ta-editor "+n.classes.textEditor),n.displayElements.html.addClass("ta-html ta-editor "+n.classes.textEditor),n._actionRunning=!1;var x=!1;if(n.startAction=function(){return n._actionRunning=!0,l.rangy&&l.rangy.saveSelection?(x=l.rangy.saveSelection(),function(){x&&l.rangy.restoreSelection(x)}):void 0},n.endAction=function(){n._actionRunning=!1,x&&l.rangy.removeMarkers(x),x=!1,n.updateSelectedStyles(),n.showHtml||n["updateTaBindtaTextElement"+b]()},g=function(){s.addClass(n.classes.focussed),y.focus()},n.displayElements.html.on("focus",g),n.displayElements.text.on("focus",g),h=function(e){return n._actionRunning||document.activeElement===n.displayElements.html[0]||document.activeElement===n.displayElements.text[0]||(s.removeClass(n.classes.focussed),y.unfocus(),t(function(){s.triggerHandler("blur")},0)),e.preventDefault(),!1},n.displayElements.html.on("blur",h),n.displayElements.text.on("blur",h),n.queryFormatBlockState=function(e){return e.toLowerCase()===document.queryCommandValue("formatBlock").toLowerCase()},n.switchView=function(){n.showHtml=!n.showHtml,n.showHtml?t(function(){return n.displayElements.html[0].focus()},100):t(function(){return n.displayElements.text[0].focus()},100)},u.ngModel){var T=!0;d.$render=function(){if(T){T=!1;var e=n.$parent.$eval(u.ngModel);void 0!==e&&null!==e||!v||""===v||d.$setViewValue(v)}n.displayElements.forminput.val(d.$viewValue),n._elementSelectTriggered||document.activeElement===n.displayElements.html[0]||document.activeElement===n.displayElements.text[0]||(n.html=d.$viewValue||"")}}else n.displayElements.forminput.val(v),n.html=v;if(n.$watch("html",function(e,t){e!==t&&(u.ngModel&&d.$viewValue!==e&&d.$setViewValue(e),n.displayElements.forminput.val(e))}),u.taTargetToolbars)y=o.registerEditor(E,n,u.taTargetToolbars.split(","));else{var w=angular.element('<div text-angular-toolbar name="textAngularToolbar'+b+'">');u.taToolbar&&w.attr("ta-toolbar",u.taToolbar),u.taToolbarClass&&w.attr("ta-toolbar-class",u.taToolbarClass),u.taToolbarGroupClass&&w.attr("ta-toolbar-group-class",u.taToolbarGroupClass),u.taToolbarButtonClass&&w.attr("ta-toolbar-button-class",u.taToolbarButtonClass),u.taToolbarActiveButtonClass&&w.attr("ta-toolbar-active-button-class",u.taToolbarActiveButtonClass),u.taFocussedClass&&w.attr("ta-focussed-class",u.taFocussedClass),s.prepend(w),e(w)(n.$parent),y=o.registerEditor(E,n,["textAngularToolbar"+b])}n.$on("$destroy",function(){o.unregisterEditor(E)}),n.$on("ta-element-select",function(e,t){y.triggerElementSelect(e,t)}),n.$on("ta-drop-event",function(e,t,a,o){n.displayElements.text[0].focus(),o&&o.files&&o.files.length>0&&(angular.forEach(o.files,function(e){try{return n.fileDropHandler(e,n.wrapSelection)||n.fileDropHandler!==n.defaultFileDropHandler&&n.defaultFileDropHandler(e,n.wrapSelection)}catch(t){i.error(t)}}),a.preventDefault(),a.stopPropagation())}),n._bUpdateSelectedStyles=!1,n.updateSelectedStyles=function(){var e;l.rangy&&l.rangy.getSelection&&1===(e=l.rangy.getSelection().getAllRanges()).length&&e[0].commonAncestorContainer.parentNode!==n.displayElements.text[0]?y.updateSelectedStyles(angular.element(e[0].commonAncestorContainer.parentNode)):y.updateSelectedStyles(),n._bUpdateSelectedStyles&&t(n.updateSelectedStyles,200)},c=function(){n._bUpdateSelectedStyles||(n._bUpdateSelectedStyles=!0,n.$apply(function(){n.updateSelectedStyles()}))},n.displayElements.html.on("keydown",c),n.displayElements.text.on("keydown",c),p=function(){n._bUpdateSelectedStyles=!1},n.displayElements.html.on("keyup",p),n.displayElements.text.on("keyup",p),f=function(e,t){t&&angular.extend(e,t),n.$apply(function(){return y.sendKeyCommand(e)?(n._bUpdateSelectedStyles||n.updateSelectedStyles(),e.preventDefault(),!1):void 0})},n.displayElements.html.on("keypress",f),n.displayElements.text.on("keypress",f),m=function(){n._bUpdateSelectedStyles=!1,n.$apply(function(){n.updateSelectedStyles()})},n.displayElements.html.on("mouseup",m),n.displayElements.text.on("mouseup",m)}}}]).directive("taBind",["taSanitize","$timeout","$window","taFixChrome","taSelectableElements","taApplyCustomRenderers",function(e,n,o,r,s,u){return{require:"ngModel",scope:{},link:function(d,c,p,f){var m,g=void 0!==c.attr("contenteditable")&&c.attr("contenteditable"),h=g||"textarea"===c[0].tagName.toLowerCase()||"input"===c[0].tagName.toLowerCase(),v=!1,y=!1;void 0===p.taDefaultWrap&&(p.taDefaultWrap="p"),m=""===p.taDefaultWrap?"":void 0===l?"<"+p.taDefaultWrap+"><br></"+p.taDefaultWrap+">":"<"+p.taDefaultWrap+"></"+p.taDefaultWrap+">";var b=function(){if(g)return c[0].innerHTML;if(h)return c.val();throw"textAngular Error: attempting to update non-editable taBind"};if(d.$parent["updateTaBind"+(p.id||"")]=function(){v||f.$setViewValue(b())},h)if(g){if(c.on("cut",function(e){v?e.preventDefault():n(function(){f.$setViewValue(b())},0)}),c.on("paste",function(e,t){t&&angular.extend(e,t);var a;if(e.clipboardData||e.originalEvent&&e.originalEvent.clipboardData?a=(e.originalEvent||e).clipboardData.getData("text/plain"):o.clipboardData&&(a=o.clipboardData.getData("Text")),!a&&!v)return!0;if(e.preventDefault(),!v){var n=angular.element("<div></div>");n[0].innerHTML=a,a=n.text(),document.execCommand("insertText",!1,a),f.$setViewValue(b())}}),c.on("keyup",function(){v||f.$setViewValue(b())}),c.on("blur",function(){y=!1;var e=b();v||(e===m?f.$setViewValue(""):f.$setViewValue(b())),f.$render()}),p.placeholder){var E;if(!p.id)throw"textAngular Error: An unique ID is required for placeholders to work";E=t("#"+p.id+".placeholder-text:before",'content: "'+p.placeholder+'"'),d.$on("$destroy",function(){a(E)})}c.on("focus",function(){y=!0,f.$render()})}else c.on("paste cut",function(){v||n(function(){f.$setViewValue(b())},0)}),c.on("change blur",function(){v||f.$setViewValue(b())});var x=function(t){return f.$oldViewValue=e(r(t),f.$oldViewValue)};f.$parsers.push(x),f.$formatters.push(x);var T=function(e){return d.$emit("ta-element-select",this),e.preventDefault(),!1},w=function(e,t){if(t&&angular.extend(e,t),!i&&!v){i=!0;var a;a=e.originalEvent?e.originalEvent.dataTransfer:e.dataTransfer,d.$emit("ta-drop-event",this,e,a),n(function(){i=!1},100)}};d.$parent["reApplyOnSelectorHandlers"+(p.id||"")]=function(){v||angular.forEach(s,function(e){c.find(e).off("click",T).on("click",T)})},f.$render=function(){var e=f.$viewValue||"";document.activeElement!==c[0]?g?(p.placeholder?""===e?(y?c.removeClass("placeholder-text"):c.addClass("placeholder-text"),c[0].innerHTML=m):(c.removeClass("placeholder-text"),c[0].innerHTML=e):""===e?c[0].innerHTML=m:c[0].innerHTML=e,v?c.off("drop",w):(angular.forEach(s,function(e){c.find(e).on("click",T)}),c.on("drop",w))):"textarea"!==c[0].tagName.toLowerCase()&&"input"!==c[0].tagName.toLowerCase()?c[0].innerHTML=u(e):c.val(e):g&&c.removeClass("placeholder-text")},p.taReadonly&&(v=d.$parent.$eval(p.taReadonly),v?("textarea"!==c[0].tagName.toLowerCase()&&"input"!==c[0].tagName.toLowerCase()||c.attr("disabled","disabled"),void 0!==c.attr("contenteditable")&&c.attr("contenteditable")&&c.removeAttr("contenteditable")):"textarea"===c[0].tagName.toLowerCase()||"input"===c[0].tagName.toLowerCase()?c.removeAttr("disabled"):g&&c.attr("contenteditable","true"),d.$parent.$watch(p.taReadonly,function(e,t){t!==e&&(e?("textarea"!==c[0].tagName.toLowerCase()&&"input"!==c[0].tagName.toLowerCase()||c.attr("disabled","disabled"),void 0!==c.attr("contenteditable")&&c.attr("contenteditable")&&c.removeAttr("contenteditable"),angular.forEach(s,function(e){c.find(e).on("click",T)}),c.off("drop",w)):("textarea"===c[0].tagName.toLowerCase()||"input"===c[0].tagName.toLowerCase()?c.removeAttr("disabled"):g&&c.attr("contenteditable","true"),angular.forEach(s,function(e){c.find(e).off("click",T)}),c.on("drop",w)),v=e)})),g&&!v&&(angular.forEach(s,function(e){c.find(e).on("click",T)}),c.on("drop",w))}}}]).factory("taApplyCustomRenderers",["taCustomRenderers",function(e){return function(t){var a=angular.element("<div></div>");return a[0].innerHTML=t,angular.forEach(e,function(e){var t=[];e.selector&&""!==e.selector?t=a.find(e.selector):e.customAttribute&&""!==e.customAttribute&&(t=n(a,e.customAttribute)),angular.forEach(t,function(t){t=angular.element(t),e.selector&&""!==e.selector&&e.customAttribute&&""!==e.customAttribute?void 0!==t.attr(e.customAttribute)&&e.renderLogic(t):e.renderLogic(t)})}),a[0].innerHTML}}]).directive("taMaxText",function(){return{restrict:"A",require:"ngModel",link:function(e,t,a,n){function o(e){var t=angular.element("<div/>");t.html(e);var a=t.text().length;return l>=a?(n.$setValidity("taMaxText",!0),e):void n.$setValidity("taMaxText",!1)}var l=parseInt(e.$eval(a.taMaxText));if(isNaN(l))throw"Max text must be an integer";a.$observe("taMaxText",function(e){if(l=parseInt(e),isNaN(l))throw"Max text must be an integer";n.$dirty&&n.$setViewValue(n.$viewValue)}),n.$parsers.unshift(o)}}}).factory("taFixChrome",function(){var e=function(e){for(var t=angular.element("<div>"+e+"</div>"),a=angular.element(t).find("span"),n=0;n<a.length;n++){var o=angular.element(a[n]);o.attr("style")&&o.attr("style").match(/line-height: 1.428571429;|color: inherit; line-height: 1.1;/i)&&(o.attr("style",o.attr("style").replace(/( |)font-family: inherit;|( |)line-height: 1.428571429;|( |)line-height:1.1;|( |)color: inherit;/gi,"")),o.attr("style")&&""!==o.attr("style")||(o.next().length>0&&"BR"===o.next()[0].tagName&&o.next().remove(),o.replaceWith(o[0].innerHTML)))}var l=t[0].innerHTML.replace(/style="[^"]*?(line-height: 1.428571429;|color: inherit; line-height: 1.1;)[^"]*"/gi,"");return l!==t[0].innerHTML&&(t[0].innerHTML=l),t[0].innerHTML};return e}).factory("taSanitize",["$sanitize",function(e){return function(t,a){var o=angular.element("<div>"+t+"</div>");angular.forEach(n(o,"align"),function(e){e.css("text-align",e.attr("align")),e.removeAttr("align")}),t=o[0].innerHTML;var l;try{l=e(t)}catch(r){l=a||""}return l}}]).directive("textAngularToolbar",["$compile","textAngularManager","taOptions","taTools","taToolExecuteAction","$window",function(e,t,a,n,o,l){return{scope:{name:"@"},restrict:"EA",link:function(r,i,s){if(!r.name||""===r.name)throw"textAngular Error: A toolbar requires a name";angular.extend(r,angular.copy(a)),s.taToolbar&&(r.toolbar=r.$parent.$eval(s.taToolbar)),s.taToolbarClass&&(r.classes.toolbar=s.taToolbarClass),s.taToolbarGroupClass&&(r.classes.toolbarGroup=s.taToolbarGroupClass),s.taToolbarButtonClass&&(r.classes.toolbarButton=s.taToolbarButtonClass),s.taToolbarActiveButtonClass&&(r.classes.toolbarButtonActive=s.taToolbarActiveButtonClass),s.taFocussedClass&&(r.classes.focussed=s.taFocussedClass),r.disabled=!0,r.focussed=!1,r._$element=i,i[0].innerHTML="",i.addClass("ta-toolbar "+r.classes.toolbar),r.$watch("focussed",function(){r.focussed?i.addClass(r.classes.focussed):i.removeClass(r.classes.focussed)});var u=function(t,a){var n;if(n=t&&t.display?angular.element(t.display):angular.element("<button type='button'>"),n.addClass(r.classes.toolbarButton),n.attr("name",a.name),n.attr("unselectable","on"),n.attr("ng-disabled","isDisabled()"),n.attr("tabindex","-1"),n.attr("ng-click","executeAction()"),n.attr("ng-class","displayActiveToolClass(active)"),n.on("mousedown",function(e,t){return t&&angular.extend(e,t),e.preventDefault(),!1}),t&&!t.display&&!a._display&&(n[0].innerHTML="",t.buttontext&&(n[0].innerHTML=t.buttontext),t.iconclass)){var o=angular.element("<i>"),l=n[0].innerHTML;o.addClass(t.iconclass),n[0].innerHTML="",n.append(o),l&&""!==l&&n.append("&nbsp;"+l)}return a._lastToolDefinition=angular.copy(t),e(n)(a)};r.tools={},r._parent={disabled:!0,showHtml:!1,queryFormatBlockState:function(){return!1}};var d={$window:l,$editor:function(){return r._parent},isDisabled:function(){return this.$eval("disabled")||this.$eval("disabled()")||"html"!==this.name&&this.$editor().showHtml||this.$parent.disabled||this.$editor().disabled},displayActiveToolClass:function(e){return e?r.classes.toolbarButtonActive:""},executeAction:o};angular.forEach(r.toolbar,function(e){var t=angular.element("<div>");t.addClass(r.classes.toolbarGroup),angular.forEach(e,function(e){r.tools[e]=angular.extend(r.$new(!0),n[e],d,{name:e}),r.tools[e].$element=u(n[e],r.tools[e]),t.append(r.tools[e].$element)}),i.append(t)}),r.updateToolDisplay=function(e,t,a){var n=r.tools[e];if(n){if(n._lastToolDefinition&&!a&&(t=angular.extend({},n._lastToolDefinition,t)),null===t.buttontext&&null===t.iconclass&&null===t.display)throw'textAngular Error: Tool Definition for updating "'+e+'" does not have a valid display/iconclass/buttontext value';null===t.buttontext&&delete t.buttontext,null===t.iconclass&&delete t.iconclass,null===t.display&&delete t.display;var o=u(t,n);n.$element.replaceWith(o),n.$element=o}},r.addTool=function(e,t,a,o){r.tools[e]=angular.extend(r.$new(!0),n[e],d,{name:e}),r.tools[e].$element=u(n[e],r.tools[e]);var l;void 0===a&&(a=r.toolbar.length-1),l=angular.element(i.children()[a]),void 0===o?(l.append(r.tools[e].$element),r.toolbar[a][r.toolbar[a].length-1]=e):(l.children().eq(o).after(r.tools[e].$element),r.toolbar[a][o]=e)},t.registerToolbar(r),r.$on("$destroy",function(){t.unregisterToolbar(r.name)})}}}]).service("taToolExecuteAction",["$q",function(e){return function(t){void 0!==t&&(this.$editor=function(){return t});var a=e.defer(),n=a.promise,o=this.$editor();n["finally"](function(){o.endAction.call(o)});var l;try{l=this.action(a,o.startAction())}catch(r){}(l||void 0===l)&&a.resolve()}}]).service("textAngularManager",["taToolExecuteAction","taTools","taRegisterTool",function(e,t,a){var n={},o={};return{registerEditor:function(a,l,r){if(!a||""===a)throw"textAngular Error: An editor requires a name";if(!l)throw"textAngular Error: An editor requires a scope";if(o[a])throw'textAngular Error: An Editor with name "'+a+'" already exists';var i=[];return angular.forEach(r,function(e){n[e]&&i.push(n[e])}),o[a]={scope:l,toolbars:r,_registerToolbar:function(e){this.toolbars.indexOf(e.name)>=0&&i.push(e)},editorFunctions:{disable:function(){angular.forEach(i,function(e){e.disabled=!0})},enable:function(){angular.forEach(i,function(e){e.disabled=!1})},focus:function(){angular.forEach(i,function(e){e._parent=l,e.disabled=!1,e.focussed=!0})},unfocus:function(){angular.forEach(i,function(e){e.disabled=!0,e.focussed=!1})},updateSelectedStyles:function(e){angular.forEach(i,function(t){angular.forEach(t.tools,function(t){t.activeState&&(t.active=t.activeState(e))})})},sendKeyCommand:function(a){var n=!1;return(a.ctrlKey||a.metaKey)&&angular.forEach(t,function(t,o){if(t.commandKeyCode&&t.commandKeyCode===a.which)for(var r=0;r<i.length;r++)if(void 0!==i[r].tools[o]){e.call(i[r].tools[o],l),n=!0;break}}),n},triggerElementSelect:function(e,a){var n=function(e,t){for(var a=!0,n=0;n<t.length;n++)a=a&&e.attr(t[n]);return a},o=[],r={},s=!1;a=angular.element(a);var u=!1;if(angular.forEach(t,function(e,t){e.onElementSelect&&e.onElementSelect.element&&e.onElementSelect.element.toLowerCase()===a[0].tagName.toLowerCase()&&(!e.onElementSelect.filter||e.onElementSelect.filter(a))&&(u=u||angular.isArray(e.onElementSelect.onlyWithAttrs)&&n(a,e.onElementSelect.onlyWithAttrs),e.onElementSelect.onlyWithAttrs&&!n(a,e.onElementSelect.onlyWithAttrs)||(r[t]=e))}),u?(angular.forEach(r,function(e,t){e.onElementSelect.onlyWithAttrs&&n(a,e.onElementSelect.onlyWithAttrs)&&o.push({name:t,tool:e})}),o.sort(function(e,t){return t.tool.onElementSelect.onlyWithAttrs.length-e.tool.onElementSelect.onlyWithAttrs.length})):angular.forEach(r,function(e,t){o.push({name:t,tool:e})}),o.length>0)for(var d=o[0].tool,c=o[0].name,p=0;p<i.length;p++)if(void 0!==i[p].tools[c]){d.onElementSelect.action.call(i[p].tools[c],e,a,l),s=!0;break}return s}}},o[a].editorFunctions},retrieveEditor:function(e){return o[e]},unregisterEditor:function(e){delete o[e]},registerToolbar:function(e){if(!e)throw"textAngular Error: A toolbar requires a scope";if(!e.name||""===e.name)throw"textAngular Error: A toolbar requires a name";if(n[e.name])throw'textAngular Error: A toolbar with name "'+e.name+'" already exists';n[e.name]=e,angular.forEach(o,function(t){t._registerToolbar(e)})},retrieveToolbar:function(e){return n[e]},retrieveToolbarsViaEditor:function(e){var t=[],a=this;return angular.forEach(this.retrieveEditor(e).toolbars,function(e){t.push(a.retrieveToolbar(e))}),t},unregisterToolbar:function(e){delete n[e]},updateToolsDisplay:function(e){var t=this;angular.forEach(e,function(e,a){t.updateToolDisplay(a,e)})},resetToolsDisplay:function(){var e=this;angular.forEach(t,function(t,a){e.resetToolDisplay(a)})},updateToolDisplay:function(e,t){var a=this;angular.forEach(n,function(n,o){a.updateToolbarToolDisplay(o,e,t)})},resetToolDisplay:function(e){var t=this;angular.forEach(n,function(a,n){t.resetToolbarToolDisplay(n,e)})},updateToolbarToolDisplay:function(e,t,a){if(!n[e])throw'textAngular Error: No Toolbar with name "'+e+'" exists';n[e].updateToolDisplay(t,a)},resetToolbarToolDisplay:function(e,a){if(!n[e])throw'textAngular Error: No Toolbar with name "'+e+'" exists';n[e].updateToolDisplay(a,t[a],!0)},removeTool:function(e){delete t[e],angular.forEach(n,function(t){delete t.tools[e];for(var a=0;a<t.toolbar.length;a++){for(var n,o=0;o<t.toolbar[a].length;o++){if(t.toolbar[a][o]===e){n={group:a,index:o};break}if(void 0!==n)break}void 0!==n&&(t.toolbar[n.group].slice(n.index,1),t._$element.children().eq(n.group).children().eq(n.index).remove())}})},addTool:function(e,t,o,l){a(e,t),angular.forEach(n,function(a){a.addTool(e,t,o,l)})},addToolToToolbar:function(e,t,o,l,r){a(e,t),n[o].addTool(e,t,l,r)},refreshEditor:function(e){if(!o[e])throw'textAngular Error: No Editor with name "'+e+'" exists';o[e].scope.updateTaBindtaTextElement(),o[e].scope.$$phase||o[e].scope.$digest()}}}])}();
//# sourceMappingURL=./textAngular.min.js.map