/*!
 * jQuery Raty - A Star Rating Plugin
 *
 * The MIT License
 *
 * @author  : Washington Botelho
 * @doc     : http://wbotelhos.com/raty
 * @version : 2.6.0
 *
 */
;(function(b){var a={init:function(c){return this.each(function(){this.self=b(this);a.destroy.call(this.self);this.opt=b.extend(true,{},b.fn.raty.defaults,c);a._adjustCallback.call(this);a._adjustNumber.call(this);if(this.opt.starType!=="img"){a._adjustStarType.call(this)}a._adjustPath.call(this);a._createStars.call(this);if(this.opt.cancel){a._createCancel.call(this)}if(this.opt.precision){a._adjustPrecision.call(this)}a._createScore.call(this);a._apply.call(this,this.opt.score);a._target.call(this,this.opt.score);if(this.opt.readOnly){a._lock.call(this)}else{this.style.cursor="pointer";a._binds.call(this)}this.self.data("options",this.opt)})},_adjustCallback:function(){var c=["number","readOnly","score","scoreName","target"];for(var d=0;d<c.length;d++){if(typeof this.opt[c[d]]==="function"){this.opt[c[d]]=this.opt[c[d]].call(this)}}},_adjustNumber:function(){this.opt.number=a._between(this.opt.number,1,this.opt.numberMax)},_adjustPath:function(){this.opt.path=this.opt.path||"";if(this.opt.path&&this.opt.path.charAt(this.opt.path.length-1)!=="/"){this.opt.path+="/"}},_adjustPrecision:function(){this.opt.half=true;this.opt.targetType="score"},_adjustStarType:function(){this.opt.path="";var c=["cancelOff","cancelOn","starHalf","starOff","starOn"];for(var d=0;d<c.length;d++){this.opt[c[d]]=this.opt[c[d]].replace(".","-")}},_apply:function(c){a._fill.call(this,c);if(c){if(c>0){this.score.val(a._between(c,0,this.opt.number))}a._roundStars.call(this,c)}},_between:function(e,d,c){return Math.min(Math.max(parseFloat(e),d),c)},_binds:function(){if(this.cancel){a._bindOverCancel.call(this);a._bindClickCancel.call(this);a._bindOutCancel.call(this)}a._bindOver.call(this);a._bindClick.call(this);a._bindOut.call(this)},_bindClick:function(){var c=this;c.stars.on("click.raty",function(d){var e=b(this);c.score.val((c.opt.half||c.opt.precision)?c.self.data("score"):(this.alt||e.data("alt")));if(c.opt.click){c.opt.click.call(c,+c.score.val(),d)}})},_bindClickCancel:function(){var c=this;c.cancel.on("click.raty",function(d){c.score.removeAttr("value");if(c.opt.click){c.opt.click.call(c,null,d)}})},_bindOut:function(){var c=this;c.self.on("mouseleave.raty",function(d){var e=+c.score.val()||undefined;a._apply.call(c,e);a._target.call(c,e,d);if(c.opt.mouseout){c.opt.mouseout.call(c,e,d)}})},_bindOutCancel:function(){var c=this;c.cancel.on("mouseleave.raty",function(d){var e=c.opt.cancelOff;if(c.opt.starType!=="img"){e=c.opt.cancelClass+" "+e}a._setIcon.call(c,this,e);if(c.opt.mouseout){var f=+c.score.val()||undefined;c.opt.mouseout.call(c,f,d)}})},_bindOver:function(){var c=this,d=c.opt.half?"mousemove.raty":"mouseover.raty";c.stars.on(d,function(e){var f=a._getScoreByPosition.call(c,e,this);a._fill.call(c,f);if(c.opt.half){a._roundStars.call(c,f);c.self.data("score",f)}a._target.call(c,f,e);if(c.opt.mouseover){c.opt.mouseover.call(c,f,e)}})},_bindOverCancel:function(){var c=this;c.cancel.on("mouseover.raty",function(d){var f=c.opt.path+c.opt.starOff,e=c.opt.cancelOn;if(c.opt.starType==="img"){c.stars.attr("src",f)}else{e=c.opt.cancelClass+" "+e;c.stars.attr("class",f)}a._setIcon.call(c,this,e);a._target.call(c,null,d);if(c.opt.mouseover){c.opt.mouseover.call(c,null)}})},_buildScoreField:function(){return b("<input />",{name:this.opt.scoreName,type:"hidden"}).appendTo(this)},_createCancel:function(){var c=this.opt.path+this.opt.cancelOff,d=b("<"+this.opt.starType+" />",{title:this.opt.cancelHint,"class":this.opt.cancelClass});if(this.opt.starType==="img"){d.attr({src:c,alt:"x"})}else{d.attr("data-alt","x").addClass(c)}if(this.opt.cancelPlace==="left"){this.self.prepend("&#160;").prepend(d)}else{this.self.append("&#160;").append(d)}this.cancel=d},_createScore:function(){var c=b(this.opt.targetScore);this.score=c.length?c:a._buildScoreField.call(this)},_createStars:function(){for(var e=1;e<=this.opt.number;e++){var d=a._nameForIndex.call(this,e),c={alt:e,src:this.opt.path+this.opt[d]};if(this.opt.starType!=="img"){c={"data-alt":e,"class":c.src}}c.title=a._getHint.call(this,e);b("<"+this.opt.starType+" />",c).appendTo(this);if(this.opt.space){this.self.append(e<this.opt.number?"&#160;":"")}}this.stars=this.self.children(this.opt.starType)},_error:function(c){b(this).text(c);b.error(c)},_fill:function(j){var g=0;for(var c=1;c<=this.stars.length;c++){var d,f=this.stars[c-1],e=a._turnOn.call(this,c,j);if(this.opt.iconRange&&this.opt.iconRange.length>g){var h=this.opt.iconRange[g];d=a._getRangeIcon.call(this,h,e);if(c<=h.range){a._setIcon.call(this,f,d)}if(c===h.range){g++}}else{d=this.opt[e?"starOn":"starOff"];a._setIcon.call(this,f,d)}}},_getRangeIcon:function(d,c){return c?d.on||this.opt.starOn:d.off||this.opt.starOff},_getScoreByPosition:function(c,e){var g=parseInt(e.alt||e.getAttribute("data-alt"),10);if(this.opt.half){var d=a._getSize.call(this),f=parseFloat((c.pageX-b(e).offset().left)/d);if(this.opt.precision){g=g-1+f}else{g=g-1+(f>0.5?1:0.5)}}return g},_getSize:function(){var c;if(this.opt.starType==="img"){c=this.stars[0].width}else{c=parseFloat(this.stars.eq(0).css("font-size"))}if(!c){a._error.call(this,"Could not be possible get the icon size!")}return c},_turnOn:function(c,d){return this.opt.single?(c===d):(c<=d)},_getHint:function(d){var c=this.opt.hints[d-1];return c===""?"":c||d},_lock:function(){var d=parseInt(this.score.val(),10),c=d?a._getHint.call(this,d):this.opt.noRatedMsg;this.style.cursor="";this.title=c;this.score.prop("readonly",true);this.stars.prop("title",c);if(this.cancel){this.cancel.hide()}this.self.data("readonly",true)},_nameForIndex:function(c){return this.opt.score&&this.opt.score>=c?"starOn":"starOff"},_roundStars:function(g){var e=(g%1).toFixed(2);if(e>this.opt.round.down){var c="starOn";if(this.opt.halfShow&&e<this.opt.round.up){c="starHalf"}else{if(e<this.opt.round.full){c="starOff"}}var d=this.opt[c],f=this.stars[Math.ceil(g)-1];a._setIcon.call(this,f,d)}},_setIcon:function(d,c){d[this.opt.starType==="img"?"src":"className"]=this.opt.path+c},_setTarget:function(c,d){if(d){d=this.opt.targetFormat.toString().replace("{score}",d)}if(c.is(":input")){c.val(d)}else{c.html(d)}},_target:function(g,d){if(this.opt.target){var f=b(this.opt.target);if(!f.length){a._error.call(this,"Target selector invalid or missing!")}var c=d&&d.type==="mouseover";if(g===undefined){g=this.opt.targetText}else{if(g===null){g=c?this.opt.cancelHint:this.opt.targetText}else{if(this.opt.targetType==="hint"){g=a._getHint.call(this,Math.ceil(g))}else{if(this.opt.precision){g=parseFloat(g).toFixed(1)}}var e=d&&d.type==="mousemove";if(!c&&!e&&!this.opt.targetKeep){g=this.opt.targetText}}}a._setTarget.call(this,f,g)}},_unlock:function(){this.style.cursor="pointer";this.removeAttribute("title");this.score.removeAttr("readonly");this.self.data("readonly",false);for(var c=0;c<this.opt.number;c++){this.stars[c].title=a._getHint.call(this,c+1)}if(this.cancel){this.cancel.css("display","")}},cancel:function(c){return this.each(function(){var d=b(this);if(d.data("readonly")!==true){a[c?"click":"score"].call(d,null);this.score.removeAttr("value")}})},click:function(c){return this.each(function(){if(b(this).data("readonly")!==true){a._apply.call(this,c);if(this.opt.click){this.opt.click.call(this,c,b.Event("click"))}a._target.call(this,c)}})},destroy:function(){return this.each(function(){var c=b(this),d=c.data("raw");if(d){c.off(".raty").empty().css({cursor:d.style.cursor}).removeData("readonly")}else{c.data("raw",c.clone()[0])}})},getScore:function(){var d=[],c;this.each(function(){c=this.score.val();d.push(c?+c:undefined)});return(d.length>1)?d:d[0]},move:function(c){return this.each(function(){var g=parseInt(c,10),i=b(this).data("options"),f=(+c).toFixed(1).split(".")[1];if(g>=i.number){g=i.number-1;f=10}var h=a._getSize.call(this),d=h/10,k=b(this.stars[g]),j=k.offset().left+d*parseInt(f,10),e=b.Event("mousemove",{pageX:j});k.trigger(e)})},readOnly:function(c){return this.each(function(){var d=b(this);if(d.data("readonly")!==c){if(c){d.off(".raty").children("img").off(".raty");a._lock.call(this)}else{a._binds.call(this);a._unlock.call(this)}d.data("readonly",c)}})},reload:function(){return a.set.call(this,{})},score:function(){var c=b(this);return arguments.length?a.setScore.apply(c,arguments):a.getScore.call(c)},set:function(c){return this.each(function(){var d=b(this),f=d.data("options"),e=b.extend({},f,c);d.raty(e)})},setScore:function(c){return this.each(function(){if(b(this).data("readonly")!==true){a._apply.call(this,c);a._target.call(this,c)}})}};b.fn.raty=function(c){if(a[c]){return a[c].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof c==="object"||!c){return a.init.apply(this,arguments)}else{b.error("Method "+c+" does not exist!")}}};b.fn.raty.defaults={cancel:false,cancelClass:"raty-cancel",cancelHint:"Cancel this rating!",cancelOff:"cancel-off.png",cancelOn:"cancel-on.png",cancelPlace:"left",click:undefined,half:false,halfShow:true,hints:["bad","poor","regular","good","gorgeous"],iconRange:undefined,mouseout:undefined,mouseover:undefined,noRatedMsg:"Not rated yet!",number:5,numberMax:20,path:undefined,precision:false,readOnly:false,round:{down:0.25,full:0.6,up:0.76},score:undefined,scoreName:"score",single:false,space:true,starHalf:"star-half.png",starOff:"star-off.png",starOn:"star-on.png",starType:"img",target:undefined,targetFormat:"{score}",targetKeep:false,targetScore:undefined,targetText:"",targetType:"hint"}})(jQuery);