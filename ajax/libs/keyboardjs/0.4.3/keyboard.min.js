!function(e,t){function n(){function n(e){var r;return r=t(e,"amd"),r.fork=n,r}return n(e)}function r(){function n(e){var r;return r=t(e,"CommonJS"),r.fork=n,r}module.exports=n(e)}function o(){function n(e){function r(){var t,n;for(n=Array.prototype.slice.apply(arguments),t=0;t<a.length;t+=1)"undefined"==typeof i[a[t]]?delete e[a[t]]:e[a[t]]=i[a[t]];for(i={},t=0;t<n.length;t+=1){if("string"!=typeof n[t])throw new Error("Cannot replace namespaces. All new namespaces must be strings.");i[n[t]]=e[n[t]],e[n[t]]=o}return a=n}var o,a=[],i={};return o=t(e,"global"),o.fork=n,o.noConflict=r,o.noConflict("KeyboardJS","k"),o}var r;r=n(e)}[].indexOf||(Array.prototype.indexOf=function(e,t,n){for(n=this.length,t=(n+~~t)%n;n>t&&(!(t in this)||this[t]!==e);t++);return t^n?t:-1}),"function"==typeof define&&define.amd?define(n):"undefined"!=typeof module?r():o()}(this,function(e,t){function n(){e.addEventListener?(e.document.addEventListener("keydown",a,!1),e.document.addEventListener("keyup",i,!1),e.addEventListener("blur",o,!1),e.addEventListener("webkitfullscreenchange",o,!1),e.addEventListener("mozfullscreenchange",o,!1)):e.attachEvent&&(e.document.attachEvent("onkeydown",a),e.document.attachEvent("onkeyup",i),e.attachEvent("onblur",o))}function r(){o(),e.removeEventListener?(e.document.removeEventListener("keydown",a,!1),e.document.removeEventListener("keyup",i,!1),e.removeEventListener("blur",o,!1),e.removeEventListener("webkitfullscreenchange",o,!1),e.removeEventListener("mozfullscreenchange",o,!1)):e.detachEvent&&(e.document.detachEvent("onkeydown",a),e.document.detachEvent("onkeyup",i),e.detachEvent("onblur",o))}function o(e){F=[],h(),y(e)}function a(e){var t,n,r;if(t=c(e.keyCode),!(t.length<1)){for(e.isRepeat=!1,r=0;r<t.length;r+=1)n=t[r],-1!=E().indexOf(n)&&(e.isRepeat=!0),A(n);u(),d(e)}}function i(e){var t,n;if(t=c(e.keyCode),!(t.length<1)){for(n=0;n<t.length;n+=1)x(t[n]);h(),y(e)}}function c(e){return S[e]||[]}function f(e){var t;for(t in S)if(S.hasOwnProperty(t)&&S[t].indexOf(e)>-1)return t;return!1}function s(e,t){if("string"!=typeof e&&("object"!=typeof e||"function"!=typeof e.push))throw new Error("Cannot create macro. The combo must be a string or array.");if("object"!=typeof t||"function"!=typeof t.push)throw new Error("Cannot create macro. The injectedKeys must be an array.");T.push([e,t])}function l(e){var t;if("string"!=typeof e&&("object"!=typeof e||"function"!=typeof e.push))throw new Error("Cannot remove macro. The combo must be a string or array.");for(mI=0;mI<T.length;mI+=1)if(t=T[mI],b(e,t[0])){x(t[1]),T.splice(mI,1);break}}function u(){var e,t,n;for(e=0;e<T.length;e+=1)if(t=w(T[e][0]),-1===J.indexOf(T[e])&&k(t))for(J.push(T[e]),n=0;n<T[e][1].length;n+=1)A(T[e][1][n])}function h(){var e,t,n;for(e=0;e<J.length;e+=1)if(t=w(J[e][0]),k(t)===!1){for(n=0;n<J[e][1].length;n+=1)x(J[e][1][n]);J.splice(e,1),e-=1}}function p(e,t,n){function r(){var e;for(e=0;e<s.length;e+=1)q.splice(q.indexOf(s[e]),1)}function o(e){function t(){var t,r;for(t=0;t<n.length;t+=1)if("function"==typeof n[t])if("keyup"===e)for(r=0;r<s.length;r+=1)s[r].keyUpCallback.splice(s[r].keyUpCallback.indexOf(n[t]),1);else for(r=0;r<s.length;r+=1)s[r].keyDownCallback.splice(s[r].keyDownCallback.indexOf(n[t]),1)}var n,r,o,a={};if("string"!=typeof e)throw new Error("Cannot bind callback. The event name must be a string.");if("keyup"!==e&&"keydown"!==e)throw new Error('Cannot bind callback. The event name must be a "keyup" or "keydown".');for(n=Array.prototype.slice.apply(arguments,[1]),r=0;r<n.length;r+=1)if("function"==typeof n[r])if("keyup"===e)for(o=0;o<s.length;o+=1)s[o].keyUpCallback.push(n[r]);else if("keydown"===e)for(o=0;o<s.length;o+=1)s[o].keyDownCallback.push(n[r]);return a.clear=t,a}var a,i,c,f={},s=[];for("string"==typeof e&&(e=w(e)),i=0;i<e.length;i+=1){if(a={},c=C([e[i]]),"string"!=typeof c)throw new Error("Failed to bind key combo. The key combo must be string.");a.keyCombo=c,a.keyDownCallback=[],a.keyUpCallback=[],t&&a.keyDownCallback.push(t),n&&a.keyUpCallback.push(n),q.push(a),s.push(a)}return f.clear=r,f.on=o,f}function m(e){var t,n;for(t=0;t<q.length;t+=1)n=q[t],b(e,n.keyCombo)&&(q.splice(t,1),t-=1)}function g(e){var t,n,r;if(e){for(t=0;t<q.length;t+=1)for(r=q[t],n=0;n<r.keyCombo.length;n+=1)if(r.keyCombo[n].indexOf(e)>-1){q.splice(t,1),t-=1;break}}else q=[]}function d(e){var t,n,r,o,a,i,c,f,s,l,u,h=[];for(a=[].concat(F),t=0;t<q.length;t+=1)u=v(q[t].keyCombo).length,h[u]||(h[u]=[]),h[u].push(q[t]);for(n=h.length-1;n>=0;n-=1)if(h[n])for(t=0;t<h[n].length;t+=1){for(r=h[n][t],o=v(r.keyCombo),s=!0,f=0;f<o.length;f+=1)if(-1===a.indexOf(o[f])){s=!1;break}if(s&&k(r.keyCombo)){for(z.push(r),f=0;f<o.length;f+=1)l=a.indexOf(o[f]),l>-1&&(a.splice(l,1),f-=1);for(i=0;i<r.keyDownCallback.length;i+=1)r.keyDownCallback[i](e,E(),r.keyCombo)===!1&&(c=!0);c===!0&&(e.preventDefault(),e.stopPropagation())}}}function y(e){var t,n,r,o;for(t=0;t<z.length;t+=1)if(r=z[t],k(r.keyCombo)===!1){for(n=0;n<r.keyUpCallback.length;n+=1)r.keyUpCallback[n](e,E(),r.keyCombo)===!1&&(o=!0);o===!0&&(e.preventDefault(),e.stopPropagation()),z.splice(t,1),t-=1}}function b(e,t){var n,r,o;if(e=w(e),t=w(t),e.length!==t.length)return!1;for(n=0;n<e.length;n+=1){if(e[n].length!==t[n].length)return!1;for(r=0;r<e[n].length;r+=1){if(e[n][r].length!==t[n][r].length)return!1;for(o=0;o<e[n][r].length;o+=1)if(-1===t[n][r].indexOf(e[n][r][o]))return!1}}return!0}function k(e){var t,n,r,o,a,i,c=0;for(e=w(e),t=0;t<e.length;t+=1){for(i=!0,c=0,n=0;n<e[t].length;n+=1){for(r=[].concat(e[t][n]),o=c;o<F.length;o+=1)a=r.indexOf(F[o]),a>-1&&(r.splice(a,1),c=o);if(0!==r.length){i=!1;break}}if(i)return!0}return!1}function v(e){var t,n,r=[];for(e=w(e),t=0;t<e.length;t+=1)for(n=0;n<e[t].length;n+=1)r=r.concat(e[t][n]);return r}function w(e){var t=e,n=0,r=0,o=!1,a=!1,i=[],c=[],f=[],s="";if("object"==typeof e&&"function"==typeof e.push)return e;if("string"!=typeof e)throw new Error('Cannot parse "keyCombo" because its type is "'+typeof e+'". It must be a "string".');for(;" "===t.charAt(n);)n+=1;for(;;){if(" "===t.charAt(n)){for(;" "===t.charAt(n);)n+=1;o=!0}else if(","===t.charAt(n)){if(r||a)throw new Error("Failed to parse key combo. Unexpected , at character index "+n+".");a=!0,n+=1}else if("+"===t.charAt(n)){if(s.length&&(f.push(s),s=""),r||a)throw new Error("Failed to parse key combo. Unexpected + at character index "+n+".");r=!0,n+=1}else if(">"===t.charAt(n)){if(s.length&&(f.push(s),s=""),f.length&&(c.push(f),f=[]),r||a)throw new Error("Failed to parse key combo. Unexpected > at character index "+n+".");r=!0,n+=1}else if(n<t.length-1&&"!"===t.charAt(n)&&(">"===t.charAt(n+1)||","===t.charAt(n+1)||"+"===t.charAt(n+1)))s+=t.charAt(n+1),r=!1,o=!1,a=!1,n+=2;else{if(!(n<t.length&&"+"!==t.charAt(n)&&">"!==t.charAt(n)&&","!==t.charAt(n)&&" "!==t.charAt(n))){n+=1;continue}for((r===!1&&o===!0||a===!0)&&(s.length&&(f.push(s),s=""),f.length&&(c.push(f),f=[]),c.length&&(i.push(c),c=[])),r=!1,o=!1,a=!1;n<t.length&&"+"!==t.charAt(n)&&">"!==t.charAt(n)&&","!==t.charAt(n)&&" "!==t.charAt(n);)s+=t.charAt(n),n+=1}if(n>=t.length){s.length&&(f.push(s),s=""),f.length&&(c.push(f),f=[]),c.length&&(i.push(c),c=[]);break}}return i}function C(e){var t,n,r=[];if("string"==typeof e)return e;if("object"!=typeof e||"function"!=typeof e.push)throw new Error("Cannot stringify key combo.");for(t=0;t<e.length;t+=1){for(r[t]=[],n=0;n<e[t].length;n+=1)r[t][n]=e[t][n].join(" + ");r[t]=r[t].join(" > ")}return r.join(" ")}function E(){return[].concat(F)}function A(e){if(e.match(/\s/))throw new Error("Cannot add key name "+e+" to active keys because it contains whitespace.");F.indexOf(e)>-1||F.push(e)}function x(e){var t=f(e);"91"===t||"92"===t?F=[]:F.splice(F.indexOf(e),1),/^Mac/.test(navigator.platform)&&((/Chrome/.test(navigator.userAgent)||/Safari/.test(navigator.userAgent))&&("91"!==t&&"93"!==t||(F=[])),/Opera/.test(navigator.userAgent)&&"17"==t&&(F=[]),/Firefox/.test(navigator.userAgent)&&"224"==t&&(F=[]))}function O(e,t){if("string"!=typeof e)throw new Error("Cannot register new locale. The locale name must be a string.");if("object"!=typeof t)throw new Error("Cannot register "+e+" locale. The locale map must be an object.");if("object"!=typeof t.map)throw new Error("Cannot register "+e+" locale. The locale map is invalid.");t.macros||(t.macros=[]),K[e]=t}function j(e){if(e){if("string"!=typeof e)throw new Error("Cannot set locale. The locale name must be a string.");if(!K[e])throw new Error("Cannot set locale to "+e+" because it does not exist. If you would like to submit a "+e+" locale map for KeyboardJS please submit it at https://github.com/RobertWHurst/KeyboardJS/issues.");S=K[e].map,T=K[e].macros,L=e}return L}var L,S,T,U,D,I={},K={},F=[],q=[],z=[],J=[];for(e=e||window,D={map:{3:["cancel"],8:["backspace"],9:["tab"],12:["clear"],13:["enter"],16:["shift"],17:["ctrl"],18:["alt","menu"],19:["pause","break"],20:["capslock"],27:["escape","esc"],32:["space","spacebar"],33:["pageup"],34:["pagedown"],35:["end"],36:["home"],37:["left"],38:["up"],39:["right"],40:["down"],41:["select"],42:["printscreen"],43:["execute"],44:["snapshot"],45:["insert","ins"],46:["delete","del"],47:["help"],91:["command","windows","win","super","leftcommand","leftwindows","leftwin","leftsuper"],92:["command","windows","win","super","rightcommand","rightwindows","rightwin","rightsuper"],145:["scrolllock","scroll"],186:["semicolon",";"],187:["equal","equalsign","="],188:["comma",","],189:["dash","-"],190:["period","."],191:["slash","forwardslash","/"],192:["graveaccent","`"],219:["openbracket","["],220:["backslash","\\"],221:["closebracket","]"],222:["apostrophe","'"],48:["zero","0"],49:["one","1"],50:["two","2"],51:["three","3"],52:["four","4"],53:["five","5"],54:["six","6"],55:["seven","7"],56:["eight","8"],57:["nine","9"],96:["numzero","num0"],97:["numone","num1"],98:["numtwo","num2"],99:["numthree","num3"],100:["numfour","num4"],101:["numfive","num5"],102:["numsix","num6"],103:["numseven","num7"],104:["numeight","num8"],105:["numnine","num9"],106:["nummultiply","num*"],107:["numadd","num+"],108:["numenter"],109:["numsubtract","num-"],110:["numdecimal","num."],111:["numdivide","num/"],144:["numlock","num"],112:["f1"],113:["f2"],114:["f3"],115:["f4"],116:["f5"],117:["f6"],118:["f7"],119:["f8"],120:["f9"],121:["f10"],122:["f11"],123:["f12"]},macros:[["shift + `",["tilde","~"]],["shift + 1",["exclamation","exclamationpoint","!"]],["shift + 2",["at","@"]],["shift + 3",["number","#"]],["shift + 4",["dollar","dollars","dollarsign","$"]],["shift + 5",["percent","%"]],["shift + 6",["caret","^"]],["shift + 7",["ampersand","and","&"]],["shift + 8",["asterisk","*"]],["shift + 9",["openparen","("]],["shift + 0",["closeparen",")"]],["shift + -",["underscore","_"]],["shift + =",["plus","+"]],["shift + (",["opencurlybrace","opencurlybracket","{"]],["shift + )",["closecurlybrace","closecurlybracket","}"]],["shift + \\",["verticalbar","|"]],["shift + ;",["colon",":"]],["shift + '",["quotationmark",'"']],["shift + !,",["openanglebracket","<"]],["shift + .",["closeanglebracket",">"]],["shift + /",["questionmark","?"]]]},U=65;90>=U;U+=1)D.map[U]=String.fromCharCode(U+32),D.macros.push(["shift + "+String.fromCharCode(U+32)+", capslock + "+String.fromCharCode(U+32),[String.fromCharCode(U)]]);return/^Mac/.test(navigator.platform)&&((/Chrome/.test(navigator.userAgent)||/Safari/.test(navigator.userAgent))&&(D.map[93]=D.map[92]),/Opera/.test(navigator.userAgent)&&(D.map[17]=D.map[91],delete D.map[91]),/Firefox/.test(navigator.userAgent)&&(D.map[224]=D.map[91],delete D.map[91]),delete D.map[92]),O("us",D),j("us"),n(),I.enable=n,I.disable=r,I.activeKeys=E,I.releaseKey=x,I.pressKey=A,I.on=p,I.clear=m,I.clear.key=g,I.locale=j,I.locale.register=O,I.macro=s,I.macro.remove=l,I.key={},I.key.name=c,I.key.code=f,I.combo={},I.combo.active=k,I.combo.parse=w,I.combo.stringify=C,I});