/*!
 * MotaJS v0.8.0
 * http://motapc.js.org/motajs
 *
 * Released under the MIT license
 * https://github.com/motapc97/MotaJS/blob/master/LICENSE.md
 *
 * Project
 * https://github.com/motapc97/MotaJS
 *
 * Date: 2015-06-15T18:05Z
 */
!function(t){if("function"==typeof define&&define.amd)define(function(){return t()});else if("undefined"!=typeof exports){var e=t();"undefined"!=typeof module&&module.exports&&(exports=module.exports=e),exports.mota=e}else window.mota=t()}(function(){function t(){}function e(t){return t>>>1&1073741824|3221225471&t}function n(t){var n,r=t.length,i=r>X,o=i&&J[t];if(!o&&0!==o){for(o=0,n=0;r>n;n++)o=31*o+t.charCodeAt(n)|0;o=e(o),i&&(K===G&&(K=0,J={}),K++,J[t]=o)}return o}function r(t,e){return t^e+2654435769+(t<<6)+(t>>2)|0}function i(t){var n=!1,i=!0,o=n?1:0,u=t.forEach(i?n?function(t,e){o=31*o+r(a(t),a(e))|0}:function(t,e){o=o+r(a(t),a(e))|0}:n?function(t){o=31*o+a(t)|0}:function(t){o=o+a(t)|0});return o=Q(o,3432918353),o=Q(o<<15|o>>>-15,461845907),o=Q(o<<13|o>>>-13,5),o=(o+3864292196|0)^u,o=Q(o^o>>>16,2246822507),o=Q(o^o>>>13,3266489909),o=e(o^o>>>16)}function o(e){return B?B.get(e):t.get(e,"hash")}function a(r){var a,u;if(!r)return 0;if("function"==typeof r.valueOf&&(r=r.valueOf(),!r))return 0;if(r===!0)return 1;if(a=typeof r,"number"===a){for(u=0|r,u!==r&&(u^=4294967295*r);r>4294967295;)r/=4294967295,u^=r;return e(u)}return"string"===a?n(r):(u=o(r),void 0!==u?u:("function"==typeof r.isImmutable&&r.isImmutable()?u=i(r):(u=Y++,1073741824&Y&&(Y=1)),B?B.set(r,u):t.setup(r,"hash",u),u))}function u(t,e){for(var n=e,r=n+1,i=t.length;i>r;n+=1,r+=1)t[n]=t[r];t.pop()}function s(t,e,n){this.owner=t,this.hash=e,this.children=n}function c(t,e,n){this.owner=t,this.count=e,this.children=n}function l(t,e,n){this.owner=t,this.bitmap=e,this.children=n}function h(t,e,n,r){this.owner=t,this.hash=e,this.key=n,this.value=r}function f(t){return Se(t)?t:ze(!0).merge(t,Me)}function p(t){this.mutable=!!t,this.type="map"}function d(t){this.attributes={},this.setAll(t),this.initialize&&E(this.initialize,this,arguments)}function g(t,e){return t.charAt(0)===e?t:e+t}function v(t,e){return t.charAt(t.length-1)===e?t:t+e}function m(t){if("string"==typeof t)return t;var e,n,r,i="";for(e in t)n=encodeURIComponent(e),r=encodeURIComponent(t[e]),i+="&"+n+("true"!==r?"="+r:"");return i.substring(1)}function y(t){}function b(){}function w(t,e,n,r){t||H("mota.Router.route","Provide a name for this route"),e||H("mota.Router.route","Provide a non-empty path"),this.name=t,this.parent=r,this.path=(r.path||"")+"/"+e.replace(er,""),this.params=ir(this.path),this.routes=[],this.routesMap={},mt(n)&&n.call(this)}function _(){this.routes=[],this.routesMap={},this.location=Ct.location,this.history=Ct.history,this.window=Zn.select(Ct),this._hasPushState=!(!this.history||!this.history.pushState),this.initialize&&E(this.initialize,this,arguments)}function x(){}var E=function(t,e,n){var r=n&&n.length;if(t){if(!r)return t.call(e);switch(r){case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2]);case 4:return t.call(e,n[0],n[1],n[2],n[3]);case 5:return t.call(e,n[0],n[1],n[2],n[3],n[4]);default:return t.apply(e,n)}}},j=Object.create,k=Array.isArray,M={}.toString,S={"[object Array]":"array","[object Boolean]":"boolean","[object Date]":"date","[object Error]":"error","[object Function]":"function","[object Number]":"number","[object Object]":"object","[object RegExp]":"regexp","[object String]":"string"},z=function(t){var e=typeof t;return"object"===e||"function"===e?null===t?"null":S[M.call(t)]||"object":e},C=function(t){return"object"===z(t)},R=function(t){var e;return!!t&&("function"==(e=typeof t)||"object"===e)},A=function(t){var e,n,r,i,o,a,u=1,s=arguments.length,c=!1;if(t===!0&&(c=t,t=arguments[u],u++),!R(t))return t;for(;s>u;u++)if(null!=(e=arguments[u]))for(n in e)r=t[n],i=e[n],t!==i&&(c&&i&&("object"===(o=z(i))||"array"===o)?(a="array"===o?r&&k(r)?r:[]:r&&C(r)?r:{},t[n]=A(c,a,i)):void 0!==i&&(t[n]=i));return t},P={}.hasOwnProperty,T=function(t,e){return null!=t&&P.call(t,e)},N={},L=function(t,e,n){var r,i,o=this;return i=t&&T(t,"constructor")?t.constructor:o,r=n?function(t,e){return this instanceof r?t===N?E(i,this,e):E(i,this,arguments):new r(N,arguments)}:function(){return E(i,this,arguments)},r.prototype=j(o.prototype),r.prototype.constructor=r,t&&A(r.prototype,t),A(r,o,e),r.__super__=o.prototype,r},I=[],V=I.slice,D=function(t){var e,n,r;if(t===!0&&T(arguments,1)&&(e=t,t=arguments[1]),!R(t))return t;switch(z(t)){case"array":return e?A(e,[],t):V.call(t);case"number":case"string":case"date":case"boolean":return new(n=t.constructor)(t);case"regexp":return n=t.constructor,r=new n(t),r.lastIndex=t.lastIndex,r;default:return e?A(e,{},t):A({},t)}},O=Object.keys,F=function(t,e){if(!R(t))return[];if(e){var n,r=[];for(n in t)r.push(n);return r}return O(t)},U=function(t,e){return function(n){var r,i,o,a,u,s,c=arguments.length;if(2>c||null==n)return n;for(r=1;c>r;r++)for(i=arguments[r],o=F(i,t),a=o.length,u=0;a>u;u++)s=o[u],e&&void 0!==n[s]||(n[s]=i[s]);return n}},W=U(!0,!0),H=function(t,e){throw t+" ERROR: "+e},$="__mota__"+(""+Math.random()).replace(/\D/g,""),q=Object.defineProperty;t.setup=function(e,n,r,i){var o=e[$];return o||(o=new t,i?e[$]=o:q(e,$,{writable:!0,value:o})),n?o[n]?o[n]:o[n]=r:o},t.get=function(t,e){var n=t[$];return e?n&&n[e]:n},t.set=function(t,e,n){var r=t[$];return r?r[e]=n:void 0},t.del=function(e,n){var r=e[$];if(r){if(!n)return!!(e[$]=new t);if(null!=r[n])return!(r[n]=void 0)}return!1};var B="function"==typeof WeakMap?new WeakMap:void 0,Y=1,X=16,G=255,K=0,J={},Q=Math.imul;("function"!=typeof Q||-2!==Q(4294967295,2))&&(Q=function(t,e){var n=t>>>16&65535,r=65535&t,i=e>>>16&65535,o=65535&e;return r*o+(n*o+r*i<<16>>>0)|0});var Z=function(t,e,n){if(t===e)return n?0!==t||1/t==1/e:!0;if(t!==t)return e!==e;if(null==t||null==e)return t===e;var r=typeof t;if("function"!==r&&"object"!==r&&"object"!=typeof e)return!1;var i=M.call(t);if(i!=M.call(e))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return t=+t,e=+e,t!==t?e!==e:t===e?n?0!==t||1/t==1/e:!0:!1;case"[object Date]":case"[object Boolean]":return+t===+e}return i},tt=function(t,e){var n=Z(t,e);if(n===!0||n===!1)return n;if(t.size!==e.size)return!1;if(t.isMutable&&e.isMutable&&!t.isMutable()&&!e.isMutable()){var r=o(t),i=o(e);if(null!=r&&null!=i&&r!==i)return!1;var a=!0,u={};return t.forEach(function(t,n){var r=e.get(n,u);return r!==u&&tt(t,r)?void 0:a=!1}),a}return!1},et=function(t){return"[object Arguments]"===M.call(t)},nt="[object process]"===("undefined"!=typeof global&&global&&M.call(global.process)),rt="[object Window]",it="[object global]",ot=function(t){if(!t||"object"!=typeof t)return!1;if(!nt&&t.window!==t)return!1;var e=M.call(t);return e===rt||e===it},at=Math.pow(2,53)-1,ut=function(t){var e,n=z(t);return"array"===n?!0:"object"!==n||ot(t)?!1:(e="length"in t&&t.length,0===e?!0:"number"==typeof e&&e>0&&at>=e&&e-1 in t)},st=function(t){return t===!0||t===!1||"boolean"===z(t)},ct=function(t){return"date"===z(t)},lt="[object HTMLDocument]",ht="[object Document]",ft=function(t){var e;if(!t||null!==t.parentNode||!(e=t.defaultView))return!1;if(nt)return ot(e);var n=M.call(t);return n===lt||n===ht},pt=function(t){return t&&1===t.nodeType?nt?!0:M.call(t).indexOf("Element")>-1:!1},dt=function(t){return"string"===z(t)},gt=function(t){if(null==t)return!0;if(k(t)||dt(t)||et(t))return 0===t.length;for(var e in t)if(T(t,e))return!1;return!0},vt=function(t){return"function"===z(t)};"function"!=typeof/./&&"object"!=typeof Int8Array&&(vt=function(t){return"function"==typeof t||!1});var mt=vt,yt=function(t){var e;return!t||"object"!=typeof t||"[object Object]"!==M.call(t)||T(t,"constructor")?!1:(e=t.constructor)?mt(e)&&e instanceof e:!0},bt=function(t,e,n,r){var i=Z(t,e,!0);if(i===!0||i===!1)return i;var o="[object Array]"===i;if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var a=t.constructor,u=e.constructor;if(!(a===u||yt(t)&&yt(e)))return!1}n=n||[],r=r||[];for(var s=n.length;s--;)if(n[s]===t)return r[s]===e;if(n.push(t),r.push(e),o){if(s=t.length,s!==e.length)return!1;for(;s--;)if(!bt(t[s],e[s],n,r))return!1}else{var c,l=F(t);if(s=l.length,F(e).length!==s)return!1;for(;s--;)if(c=l[s],!T(e,c)||!bt(t[c],e[c],n,r))return!1}return n.pop(),r.pop(),!0},wt=function(t,e){return bt(t,e)},_t=function(t){return"error"===z(t)},xt=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},Et=function(t){return"number"===z(t)},jt=function(t){return t!==+t&&Et(t)},kt=function(t){return null===t},Mt=function(t){return"regexp"===z(t)},St=function(t){return void 0===t},zt=function(t,e){console.log(t+" LOG: "+e)},Ct="object"==typeof self&&self.self==self&&self||"object"==typeof global&&global.global==global&&global,Rt=Ct&&Ct.document,At=function(t){Ct=t,Rt=t&&t.document},Pt=Ct.mota,Tt=function(){return Pt&&(Ct.mota=Pt),this},Nt=function(t){for(var e=F(t),n=e.length,r=Array(n),i=0;n>i;i++)r[i]=[e[i],t[e[i]]];return r},Lt={},It=function(t){return t=t?t+"":"",Lt[t]||(Lt[t]=0),t+ ++Lt[t]},Vt=function(t,e){var n,r;for(n in e)if(r=e[n],r&&!r(t[n],n,t))return!1;return!0},Dt=function(t,e){console.warn?console.warn(t+" WARNS: "+e):console.log(t+" WARNS: "+e)},Ot={apply:E,classExtend:L,clone:D,extend:A,defaults:W,err:H,has:T,is:tt,isArguments:et,isArray:k,isArrayLike:ut,isBoolean:st,isDate:ct,isDocument:ft,isElement:pt,isEmpty:gt,isEqual:wt,isError:_t,isFinite:xt,isFunction:mt,isNaN:jt,isNull:kt,isNumber:Et,isObject:C,isObjectLike:R,isPlainObject:yt,isRegExp:Mt,isString:dt,isUndefined:St,isWindow:ot,keys:F,log:zt,noConflict:Tt,pairs:Nt,type:z,uniqueId:It,validate:Vt,warn:Dt},Ft=I.indexOf,Ut=function(t,e){var n,r,i;for(t.length>e.length?(n=e,r=t):(n=t,r=e),i=n.length;i--;)if(-1!==Ft.call(r,n[i]))return!0;return!1},Wt=function(t,e,n,r){var i,o,a,u=[],s="getFirst"===r,c="trigger"===r,l=e?e.length:0,h=n.type,f=n.namespaces,p=n.handler,d=n.context;for(o=0;l>o&&(i=e[o],i!==n&&(n._listener===!0||!(!h||tt(i.type,h)||c&&i.isRegExp&&(a=h.match(i.type)))||p&&i.handler!==p||!(!f||0===f.length||i.namespaces&&Ut(i.namespaces,f))||d&&i.context!==d)||(u.push([i,{index:o,match:{string:h,match:a}}]),!s));o++);return u},Ht=/\S+/g,$t=/\.[^.]+/g,qt=/^[^.]+/g,Bt=function(t){this.type=t.type,this.namespaces=t.namespaces,this.handler=t.handler,this.context=t.context,this.isRegExp=t.isRegExp,this.once=!1,this._listener=!0},Yt=function(t){if(t._listener)return[t];var e,n,r,i,o=[],a=t.eventType,u=t.handler,s=t.context,c=Mt(a);if(c)return[{type:a,handler:u,context:s,isRegExp:c}];for(a=(a||"").match(Ht)||[""],n=a.length,e=0;n>e;e++)r=(a[e].match(qt)||[])[0],i=a[e].match($t),o.push({type:r,namespaces:i,handler:u,context:s,isRegExp:c});return o},Xt=function(e,n,r,i,o){var a,u,s,c,l,h;if(e){for(s="on"===n?t.setup(e,"events",[]):t.get(e,"events"),c=Yt(i),a=0;a<c.length;a++)if("on"===n)r.call(e,s,new Bt(c[a]),void 0,o);else for(l=Wt(e,s,c[a],n),u=0;u<l.length&&(h=l[u],r.call(e,s,h[0],h[1],o)!==!1);u++);return e}},Gt=function(t,e,n,r){r.push(e)},Kt=function(t,e,n){var r=[];return Xt(this,"get",Gt,{eventType:t,handler:e,context:n},r),r},Jt=function(t,e,n,r){r.value=!0},Qt=function(t,e,n){var r={value:!1};return Xt(this,"getFirst",Jt,{eventType:t,handler:e,context:n},r),r.value},Zt=function(t,e,n,r){e.handler=void 0,u(t,n.index-r.value),r.value++},te=function(t,e,n){return Xt(this,"off",Zt,{eventType:t,handler:e,context:n},{value:0})},ee=function(t,e,n,r){r&&(e.once=!0),t.push(e)},ne=function(t,e,n,r){return t&&e?Xt(this,"on",ee,{eventType:t,handler:e,context:n},r):this},re=function(t,e,n){return ne.call(this,t,e,n,!0)},ie=function(t,e,n){e.once&&(e.handler=void 0,Xt(this,"off",Zt,e,{value:0}))},oe=function(t,e,n,r){var i=e.handler;ie.call(this,t,e,n),E(i,void 0!==e.context?e.context:this,r)},ae=function(t){return Xt(this,"trigger",oe,{eventType:t,handler:void 0,context:void 0},V.call(arguments,1))},ue=function(t,e,n,r){oe(t,e,n,[n.match].concat(r))},se=function(t){return Xt(this,"trigger",ue,{eventType:t,handler:void 0,context:void 0},V.call(arguments,1))},ce={getListeners:Kt,hasListeners:Qt,off:te,on:ne,once:re,trigger:ae,triggerMatch:se},le=5,he=32,fe=he-1,pe=he/2,de=he/4,ge={},ve=function(t,e,n){var r,i,o,a=t.length-1;if(n&&e===a)return t.pop(),t;for(r=new Array(a),i=o=0;a>i;i++)i===e&&(o=1),r[i]=t[i+o];return r},me=function(t,e,n,r){var i,o,a;if(r)a=t;else for(i=0,o=t.length,a=new Array(o);o>i;i++)a[i]=t[i];return void 0!==e&&(a[e]=n),a},ye=function(t,e){for(var n,r=this.children,i=0,o=r.length;o>i;i++)if(n=r[i],n&&n.forEach(t,e)===!1)return!1},be=function(t){return this.owner===t&&t.mutable};A(s.prototype,{isLeaf:!0,isEditable:be,forEach:ye,lookup:function(t,e,n){for(var r,i=0,o=this.children.length;o>i;i++)if(r=this.children[i],tt(r.key,n))return r.value;return ge},modify:function(t,e,n,r,i,o){var a,u,c,l,f,p,d,g=i===ge;if(n!==this.hash)return g?this:(o.changeValue=!0,o.changeSize=!0,ke(this,t,e,new h(t,n,r,i)));for(l=this.children,a=0,u=l.length;u>a;a++)if(d=l[a],tt(d.key,r)){o.oldValue=d.value;break}return c=u>a,(c?d.value===i:g)?this:(o.changeValue=!0,(g||!c)&&(o.changeSize=!0),g&&2===u?(d=l[1^a],new h(t,this.hash,d.key,d.value)):(f=this.isEditable(t),p=f?l:me(l),c?g?a===u-1?p.pop():p[a]=p.pop():p[a]=new h(t,n,r,i):p.push(new h(t,n,r,i)),f?(this.children=p,this):new s(t,this.hash,p)))}});var we=function(t,e,n,r,i,o,a){return t?t.modify(e,n,r,i,o,a):o===ge?t:(a.changeValue=!0,a.changeSize=!0,new h(e,r,i,o))},_e=function(t,e,n,r){var i,o,a,u=t.length+1;if(r&&e+1===u)return t[e]=n,t;for(i=new Array(u),o=a=0;u>o;o++)o===e?(i[o]=n,a=-1):i[o]=t[o+a];return i},xe=function(t,e,n,r){for(var i,o=new Array(n),a=0,u=0,s=0,c=1,h=e.length;h>s;s++)i=e[s],i&&s!==r&&(u|=c,o[a++]=i),c<<=1;return new l(t,u,o)};A(c.prototype,{isEditable:be,forEach:ye,lookup:function(t,e,n){var r=this.children[e>>>t&fe];return r?r.lookup(t+le,e,n):ge},modify:function(t,e,n,r,i,o){var a,u,s,l,h=i===ge,f=n>>>e&fe,p=this.children,d=p[f];if(h&&!d)return this;if(a=we(d,t,e+le,n,r,i,o),a===d)return this;if(u=this.count,d){if(!a&&(u--,de>u))return xe(t,p,u,f)}else u++;return s=this.isEditable(t),l=me(p,f,a,s),s?(this.count=u,this.children=l,this):new c(t,u,l)}});var Ee=function(t){return t-=t>>1&1431655765,t=(858993459&t)+(t>>2&858993459),t=t+(t>>4)&252645135,t+=t>>8,t+=t>>16,127&t},je=function(t,e,n,r,i){for(var o=new Array(he),a=0,u=0;n;a++)1&n&&(o[a]=e[u],u++),n>>>=1;return o[r]=i,new c(t,u+1,o)};A(l.prototype,{isEditable:be,forEach:ye,lookup:function(t,e,n){var r=1<<(e>>>t&fe),i=this.bitmap;return i&r?this.children[Ee(i&r-1)].lookup(t+le,e,n):ge},modify:function(t,e,n,r,i,o){var a,u,s,c,h,f,p,d,g=n>>>e&fe,v=1<<g,m=this.bitmap,y=0!==(m&v);return y||i!==ge?(a=Ee(m&v-1),s=this.children,c=y?s[a]:void 0,h=we(c,t,e+le,n,r,i,o),h===c?this:(u=s.length,!y&&h&&u>=pe?je(t,s,m,g,h):y&&!h&&2===u&&s[1^a].isLeaf?s[1^a]:y&&h&&1===u&&h.isLeaf?h:(f=this.isEditable(t),p=y?h?m:m^v:m|v,d=y?h?me(s,a,h,f):ve(s,a,f):_e(s,a,h,f),f?(this.bitmap=p,this.children=d,this):new l(t,p,d)))):this}});var ke=function(t,e,n,r){var i,o,a=t.hash,u=r.hash;return a===u?new s(e,a,[r,t]):(i=a>>>n&fe,o=u>>>n&fe,new l(e,1<<i|1<<o,i===o?[ke(t,e,n+le,r)]:o>i?[t,r]:[r,t]))};A(h.prototype,{isLeaf:!0,isEditable:be,lookup:function(t,e,n){return tt(this.key,n)?this.value:ge},modify:function(t,e,n,r,i,o){var a=i===ge,u=tt(this.key,r);return(u?this.value===i:a)?this:(o.changeValue=!0,o.oldValue=this.value,a?void(o.changeSize=!0):u?this.isEditable(t)?(this.value=i,this):new h(t,this.hash,r,i):(o.changeSize=!0,ke(this,t,e,new h(t,n,r,i))))},forEach:function(t,e){return t(e,this)}});var Me={},Se=f.isMap=function(t){return!(!t||!t.__owner||"map"!==t.__owner.type)},ze=function(t,e,n){var r=j(Pe);return r.size=e||0,r.__root=n,r.__owner=new p(t),r},Ce={pairs:function(t,e){t.push([e.key,e.value])},keys:function(t,e){t.push(e.key)},values:function(t,e){t.push(e.value)}},Re=function(t){var e="__"+t,n=Ce[t];return function(){if(void 0!==this[e]&&this.isImmutable())return this[e];var t=[];return this.__root&&this.__root.forEach(n,t),this[e]=t}},Ae=function(t,e){var n,r,i,o=t&&z(t);if("object"===o){if("function"==typeof t.forEach)return t.forEach(e);for(n in t)e.call(null,t[n],n)}else if("array"===o)for(r=0,i=t.length;i>r;r++)e.call(null,t[r][1],t[r][0])},Pe=A(f.prototype,ce,{get:function(t,e){var n=this.__root,r=n?n.lookup(0,a(t),t):ge;return r===ge?e:r},has:function(t){var e=this.__root,n=e?e.lookup(0,a(t),t):ge;return ge!==n},set:function(t,e,n){var r,i,o,u={changeSize:!1,changeValue:!1},s=e===ge,c=this.isMutable();return r=c?this:ze(),this.__root?r.__root=this.__root.modify(r.__owner,0,a(t),t,e,u):s||(u.changeValue=!0,u.changeSize=!0,r.__root=new h(r.__owner,a(t),t,e)),u.changeValue?(r.size=this.size+(u.changeSize?s?-1:1:0),n===Me?u:r.size||c?(c&&(i={type:s?"delete":u.changeSize?"add":"update"},i.key=i.name=t,s?i.oldValue=u.oldValue:u.changeSize?i.value=i.newValue=e:(i.value=i.newValue=e,i.oldValue=u.oldValue),o=this.__changes,o||(o=this.__changes=[]),o.push(i),n||this.__triggerChangeEvent()),r):Te):n===Me?u:this},__triggerChangeEvent:function(){if(this.isMutable()){var t=this.__changes;if(this.__changes=[],t&&t.length)return this.trigger("change",t),!0}return!1},remove:function(t){return this.set(t,ge)},clear:function(){if(this.isImmutable())return Te;if(this.hasListeners()){var t=this.__changes;t||(t=this.__changes=[]),this.forEach(function(e,n){t.push({type:"delete",key:n,name:n,oldValue:e})})}return this.size=0,this.__root=void 0,this.__triggerChangeEvent(),this},count:function(){return this.size},pairs:Re("pairs"),keys:Re("keys"),values:Re("values"),forEach:function(t,e){var n=this,r=0;return this.size&&this.__root.forEach(function(i,o){return r++,t.call(e,o.value,o.key,n)}),r},isMutable:function(){return this.__owner.mutable},isImmutable:function(){return!this.isMutable()},asMutable:function(){return this.isMutable()?this:ze(!0,this.size,this.__root)},asImmutable:function(){return this.isMutable()?this.size?ze(!1,this.size,this.__root):Te:this},merge:function(t,e){if(!t)return this;var n=this.asMutable(),r=!1;return Ae(t,function(t,i){e===Me?n.set(i,t,Me).changeValue&&(r=!0):n.set(i,t,!0)}),r||n.__triggerChangeEvent()?n===this?n:n.asImmutable():this}}),Te=ze(!1);f.prototype.entries=f.prototype.pairs,f.prototype.unset=f.prototype.remove,f.prototype["delete"]=f.prototype.remove;var Ne=function(){return this.unsetAll(Nt(this.attributes))},Le=function(){return new this.constructor(Nt(this.attributes))},Ie={},Ve=function(t,e){if(dt(e)&&(e=Ie[e]||(Ie[e]=e.split("."))),!e||!e.length)return t;for(var n,r,i,o,a=0,u=e.length-1,s=!1;T(t,e[a])&&u>a;)t=t[e[a]],a++;return a===u&&null!=t&&(n=t,r=V.call(e,0,-1),o=e[a],i=t[o],s=T(t,o)),{path:e,parent:n,parentPath:r,name:o,value:i,exists:s}},De=function(t){return Ve(this.attributes,t).value},Oe=function(t){return Ve(this.attributes,t).exists},Fe=I.splice,Ue=function(t,e,n,r,i){var o,a,u,s,c,l,h,f,p=Ve(this.attributes,t),d=p.value;if(t=p.path,k(d)&&(h=n-0,!(jt(h)||(f=d.length,e&&f>h)))){for(0>h&&(h=f+h),c=V.call(arguments,2),l=c.length,a=2>l?0:l-2;h&&h>f;)h--,e&&a++;return e?(d[n]=i,u=[]):u=E(Fe,d,c),s=u.length,s||a?(o=V.call(V.call(d,h),0,a),{model:this,path:t,added:o,addedCount:a,index:h,object:d,removed:u,removedCount:s,type:"splice"}):void 0}},We=function(t,e,n){var r,i,o,a,u,s,c,l=null;if(null==t)return this;if(c=Ve(this.attributes,t),r=c.parent,null==r)return this;if(t=c.path,i=c.parentPath,o=c.value,a=c.exists,u=c.name,n?a&&(l="delete"):a?wt(o,e)||(l="update"):l="add",l){switch(l){case"add":s=Ue.call(this,i,!0,u,0,e),s?l="splice":r[u]=e;break;case"update":r[u]=e;break;case"delete":delete r[u]}return s||(s={model:this,path:t,name:u,object:r,type:l},"add"!==l&&(s.oldValue=o),"delete"!==l&&(s.newValue=n?void 0:e)),s}},He=function(t,e,n){var r=We.call(this,t,e,n);return r&&this.trigger("change",[r]),this},$e=function(t,e){var n=[],r=this;return t&&t.forEach(function(t){var i=We.call(r,t[0],t[1],e);i&&n.push(i)}),n.length&&this.trigger("change",n),this},qe=function(t,e,n){var r,i;return i=V.call(arguments),Fe.call(i,1,0,!1),r=[E(Ue,this,i)],r[0]?(this.trigger("change",r),r[0].removed):void 0},Be=function(t){return this.set(t,null,!0)},Ye=function(t){return this.setAll(t,!0)};d.extend=L,A(d.prototype,ce,{clear:Ne,clone:Le,get:De,has:Oe,set:He,setAll:$e,splice:qe,unset:Be,unsetAll:Ye});var Xe=/[\-{}\[\]+?.,\\\^$|#\s]/g,Ge=/\((.*?)\)/g,Ke=/(\(\?)?:\w+/g,Je=/\*\w+/g,Qe=/(?:(\(\?)?:\w+)|(?:\*\w+)/g,Ze=/^\/+/,tn=/\/+$/,en=/#.*/,nn=/\?.*/,rn=new RegExp("^(?:(?:((?:https?|ftp):)//)(?:(\\S+(?::\\S*)?)@)?((?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*)?(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))?)(?::(\\d{2,5}))?)?(/?\\S*)?$","i"),on=function(t,e){var n,r,i,o,a,u,s,c;if(n=(t||"").match(rn)||[],r={auth:n[2]||"",hash:"",hostname:n[3]||"",port:n[4]||"",protocol:n[1]||"",search:""},r.pathname=(n[5]||"").replace(en,function(t){return r.hash=t||"",""}).replace(nn,function(t){return r.search=t||"",""}).replace(Ze,"/"),"/"!==r.pathname&&(r.pathname=r.pathname.replace(tn,"")),r.path=r.pathname+r.search,r.host=r.hostname+(r.port?":"+r.port:""),r.href="",r.host&&(r.href+=r.protocol+"//",r.auth&&(r.href+=r.auth+"@"),r.href+=r.host),r.fragment=r.path+r.hash,r.href+=r.fragment,i=r.query=r.search.substring(1),e)for(o=i.split("&"),a=0,i=r.query={};a<o.length;a++)c=o[a].split("="),u=decodeURIComponent(c[0]),s=c[1]?decodeURIComponent(c[1]):!0,i[u]=s;return r},an=function(t){var e,n,r="";return t.protocol&&(r+=v(t.protocol,":")+"//"),t.auth&&(r+=t.auth+"@"),t.host?r+=t.host:(t.hostname&&(r+=t.hostname),t.port&&(r+=":"+t.port)),t.pathname&&(e=t.pathname.replace(Ze,"/"),e=r?g(e,"/"):e,r+="/"!==e?e.replace(tn,""):e),t.search?r+=g(t.search,"?"):t.query&&(n=m(t.query),n&&(r+="?"+t.query)),t.hash&&(r+=g(t.hash,"#")),r},un=function(t,e){var n,r,i,o,a;for(t=on(t),e=on(e),o=e.pathname.split("/"),a="/"===e.pathname.charAt(0),i=a?["",""]:t.pathname.split("/"),n=0;n<o.length;n++)r=o[n],r&&"."!==r&&(".."===r?i.pop():i.push(r));return t.pathname=i.join("/"),t.search=e.search,t.hash=e.hash,an(t)};y.parse=on,y.resolve=un,y.format=an;var sn=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,cn=function(){return null==this?"":(this+"").replace(sn,"")},ln=function(t){var e,n,r,i,o="",a=0;if(!t)return"";if(e=z(t),"array"===e)for(n=t.length;n>a;a++)t[a]&&(o+=" "+t[a]);else if("object"===e)for(r=F(t),n=r.length;n>a;a++)i=r[a],t[i]&&(o+=" "+i);else o=t+"";return cn.call(o)},hn={},fn=1,pn="vComp",dn=function(t){return t.nodeType&&3!==t.nodeType?1:t===t.window?2:0},gn={add:function(e){var n,r=e.el,i=dn(r);return i?(n=t.get(r,pn),n||(n=fn++,t.setup(r,pn,n,1===i)),hn[n]=e):void 0},remove:function(e){var n=dn(e)&&t.get(e,pn);n&&(hn[n]=null)},get:function(e){return hn[dn(e)&&t.get(e,pn)]}},vn=/^on/,mn=function(t){return k(t)?E(A,null,[{}].concat(t)):t},yn=["Webkit","Moz","ms"],bn=Rt?Rt.createElement("div").style:{},wn={boxFlex:1,boxFlexGroup:1,columnCount:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,fontWeight:1,lineClamp:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,fillOpacity:1,strokeDashoffset:1,strokeOpacity:1,strokeWidth:1},_n=function(t){return t.charAt(0).toUpperCase()+t.substring(1)},xn={},En=function(t){var e,n,r=t;if(void 0!==xn[t])return xn[t];if(t in bn)return xn[t]=t,t;for(e=_n(t),n=yn.length;n--;)if(t=yn[n]+e,t in bn)return xn[r]=t,t;xn[r]=!1},jn=function(t,e,n){var r,i,o;return(i=En(e))?(r=null==n||"boolean"==typeof n?"":n,o=1!==wn[i]&&Et(r),r=o?r+"px":cn.call(r+""),void(t[i]!==r&&(t[i]=r))):Dt("mota.view.Component.update","`"+e+"` is not a style property.")};F(wn).forEach(function(t){for(var e=yn.length;e--;)wn[yn[e]+_n(t)]=1});var kn=function(t,e,n,r,i){var o,a,u,s,c,l;if(r!==i)switch(n){case"key":case"data-mota":case"children":case"childNodes":case"innerHTML":case"outerHTML":return;case"daugerousInnerHTML":case"dangerouslySetInnerHTML":return void(i&&e.innerHTML!==i.__html&&(e.innerHTML=i.__html));case"style":for(s=e.style,r=mn(r)||{},i=mn(i)||{},l=F(i),o=l.length;o--;)c=l[o],jn(s,c,i[c]);for(l=F(r),o=l.length;o--;)c=l[o],void 0===i[c]&&jn(s,c,null);return;case"class":case"className":return a=ln(i),void("svg"===e.nodeName?e.setAttribute("class",a):e.className!==a&&(e.className=a));default:return u=n.replace(vn,""),void(n!==u?(u=u.toLowerCase(),r&&ce.off.call(t,u,r),i&&ce.on.call(t,u,i)):n in e&&"list"!==n&&"form"!==n&&"type"!==n&&"width"!==n&&"height"!==n?e[n]!==i&&(e[n]=i):i?e.setAttribute(n,i+""):e.removeAttribute(n))}},Mn={},Sn=0,zn=function(t){function e(){this.initialize&&E(this.initialize,this,arguments)}var n,r=[];t&&mt(t.render)||H("mota.view.createClass","Provide an object with a `render` property containing a function"),e.prototype=new b,t=A(e.prototype,t);for(n in t)mt(t[n])&&r.push(n);return t.constructor=e,t.__methods=r,e.__type=Sn++,e},Cn=zn({render:function(){return this.props}}),Rn=function(t,e,n,r,i,o,a,u,s,c){var l,h,f,p,d,g,v,m,y,b,w=0,_=t?t.length:w;for(s=s||0;_>w;w++)l=t[w],null!=l&&l!==!1&&""!==l&&(h=z(l),"array"!==h?("object"!==h&&(l={type:"#textNode",text:l+""}),f=l.props||{},p=l.type,d=mt(p),g=d?p.__type:p,null==e[g]&&(e[g]=0),v=g+(null==f.key?":noKey:"+e[g]++:":key:"+f.key),m=r&&r[v],null!=m?(b=n[m],n&&(n[m]=void 0),y=b,d?y.props=y.componentWillReceiveProps(f):y.props=l,i.push({component:y,index:s})):(d?(y=new l.type,y.props=y.componentWillReceiveProps(f)):(y=new Cn,y.props=l),In.call(y,Mn,c[s]),o.push({component:y,index:s})),a[s]=y,u[v]=s,s++):s=Rn(l,e,n,r,i,o,a,u,s,c));return s},An=function(t,e,n){var r,i,o,a,u={};if(null!=e)for(r in e)T(e,r)&&(u[r]=e[r]);if(i=arguments.length-2,1===i)u.children=k(n)?n:[n];else if(i>1){for(o=Array(i),a=0;i>a;a++)o[a]=arguments[a+2];u.children=o}return{type:t,props:u}},Pn={area:1,base:1,br:1,col:1,command:1,embed:1,hr:1,img:1,input:1,keygen:1,link:1,menuitem:1,meta:1,param:1,source:1,track:1,wbr:1},Tn=function(t){t.componentWillUnmount&&t.componentWillUnmount();var e=t.__cache.children,n=e&&e.length;for(gn.remove(t.el),t.el=t.props=t.__cache=void 0;n--;)Tn(e[n])},Nn=function(t){return t&&t.getAttribute&&t.setAttribute("data-mota","client"),t},Ln=function(t,e){return Nn(!t||t.getAttribute&&"server"!==t.getAttribute("data-mota")?e:t.nodeType===e.nodeType&&t.nodeName===e.nodeName&&t.nodeValue===e.nodeValue?t:e)},In=function(t,e){this.__cache||(this.__cache={}),t===Mn&&this.componentWillMount&&this.componentWillMount();var n,r,i,o,a,u,s,c,l,h,f,p,d,g,v,m,y,b,w,_,x,E,j,k,M,S=this.el,z=this.render(An)||{},C=z.type,R=z.props||{},A=R.children,P=this.__cache,T=P.result;if(T!==z){if(n=T&&T.props,x=n===R,E=(n&&n.children)===A,P.result=z,t===Mn&&("string"==typeof C?(P.type=C,"#textNode"===C?S=Rt.createTextNode(z.text):(("script"===C||"style"===C)&&H("mota.view.Component.update","For security reasons, <script> and <style> elements are not allowed"),R.xmlns?r=R.xmlns:"svg"===C?r="http://www.w3.org/2000/svg":"math"===C&&(r="http://www.w3.org/1998/Math/MathML"),S=r?Rt.createElementNS(r,C):Rt.createElement(C)),S=this.el=Ln(e,S),gn.add(this)):H("mota.view.Component.update","`render` must return an object containing a `type` property with a primitive string.")),S||H("mota.view.Component.update","The `el` property is missing"),C!==P.type&&H("mota.view.Component.update","You must not change the type of an component between updates. You have changed '"+P.type+"' to '"+C+"'."),Pn[C]&&(null!=R.daugerousInnerHTML||null!=A&&A.length>0)&&H("mota.view.Component.update",C+" is a void element tag and must not have `children` or use `daugerousInnerHTML`."),"#textNode"===C)return i=z.text,void(i!=S.nodeValue&&(S.nodeValue=i));if(!x){for(j=P.attrs||{},M=F(R),g=M.length;g--;)k=M[g],kn(this,S,k,j[k],R[k]);for(M=F(j),g=M.length;g--;)k=M[g],void 0===R[k]&&kn(this,S,k,j[k]);if(P.attrs=R,!E&&!Pn[C]&&null==R.daugerousInnerHTML){for(a=P.children,u=P.childrenMap,s=[],c={},l=[],h=[],o=S.childNodes,d={},Rn(A,d,a,u,h,l,s,c,0,o),P.children=s,P.childrenMap=c,g=a?a.length:0;g--;)_=a[g],_&&(w=s[g],(!w||w.el.parentNode)&&(a[g]=null,S.removeChild(_.el),Tn(_)));for(a&&a.length||!(s.length>10)||(m=Rt.createDocumentFragment()),g=0,v=l.length;v>g;g++)nt&&(o=S.childNodes),f=l[g],p=f.index,w=f.component,y=o[p],b=w.el,m?m.insertBefore(b,null):(_=a&&a[p],_?(a[p]=null,S.replaceChild(b,_.el),Tn(_)):S.insertBefore(b,y||null)),w.componentDidMount&&w.componentDidMount();for(g=0,v=h.length;v>g;g++)nt&&(o=S.childNodes),f=h[g],w=f.component,y=o[f.index],b=w.el,(!w.shouldComponentUpdate||w.shouldComponentUpdate())&&(w.componentWillUpdate&&w.componentWillUpdate(),In.call(w),y!==b&&S.insertBefore(b,y||null),w.componentDidUpdate&&w.componentDidUpdate());m&&S.insertBefore(m,null),"select"===C&&kn(this,S,"value",j.value,R.value)}}}};A(b.prototype,ce,{update:In,componentWillReceiveProps:function(t){return t},bindMethodsToThis:function(){for(var t,e=this.__methods.length;e--;)t=this.__methods[e],this[t]=this[t].bind(this)}});var Vn=function(t){if(t){var e=gn.get(t)||new b;return e.el||(e.el=t),gn.add(e)?e:void 0}},Dn=function(t,e,n){var r=Vn(e);return r||H("mota.view.render","`parent` should be an DOM element"),r.render=function(){return{props:{children:[t]}}},r.update(),mt(n)&&n(),r.__cache.children[0]},On=function(t){var e=Vn(Rt.createElement("div"));return e.render=function(){return{props:{children:[t]}}},e.update(),e.el.innerHTML.replace(/data-mota="client"/g,'data-mota="server"')},Fn=Date.now,Un={},Wn=function(t){Un[t]=!0,Object.defineProperty(Hn.prototype,t,{enumerable:!0,configurable:!0,get:function(){var e,n;return this.originalEvent&&(n=Yn[t],e=n?n(this.originalEvent):this.originalEvent[t]),this[t]=e},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},Hn=function(t){var e,n;t&&t.type?(this.originalEvent=t,this.type=t.type):this.type=t;for(e in this.originalEvent)Un[e]||null!=this[e]||Wn(e);this.type in Bn&&(this.type=Bn[this.type]),this.timeStamp||(this.timeStamp=Fn()),n=this.target,n&&3===n.nodeType&&(this.target=n.parentNode)};Hn.prototype={constructor:Hn,isDefaultPrevented:!1,isPropagationStopped:!1,isImmediatePropagationStopped:!1,stopPropagation:function(){this.isPropagationStopped=!0},stopImmediatePropagation:function(){this.isPropagationStopped=!0,this.isImmediatePropagationStopped=!0},preventDefault:function(){this.isDefaultPrevented=!0,this.originalEvent.preventDefault()}};var $n=/^key/,qn=/^(?:mouse|touch|pointer|contextmenu|drag|drop)|click/,Bn={mousewheel:"wheel",DOMMouseScroll:"whell"},Yn={which:function(t){if(qn.test(t.type)){var e=t.button;return t.which||void 0===e?t.which:1&e?1:2&e?3:4&e?2:0}return $n.test(t.type)?null==t.which?null!=t.charCode?t.charCode:t.keyCode:t.which:void 0},pageX:function(t){var e,n,r;return null==t.pageX&&null!=t.clientX?(e=t.target.ownerDocument||Rt,n=e.documentElement,r=e.body,t.clientX+(n&&n.scrollLeft||r&&r.scrollLeft||0)-(n&&n.clientLeft||r&&r.clientLeft||0)):t.pageX},pageY:function(t){var e,n,r;return null==t.pageY&&null!=t.clientY?(e=t.target.ownerDocument||Rt,n=e.documentElement,r=e.body,t.clientY+(n&&n.scrollTop||r&&r.scrollTop||0)-(n&&n.clientTop||r&&r.clientTop||0)):t.pageY}};F(Yn).forEach(Wn);var Xn=function(t,e){return t?t.parentNode?t.parentNode:ft(t)?t.defaultView:void 0:e},Gn=function(t,e,n,r){var i=e.handler;return ie.call(this,t,e,n),r.isImmediatePropagationStopped?!1:(r.currentTarget=this.el,void(i&&(r.result=i.call(void 0!==e.context?e.context:this,r))))},Kn=function(t){t=new Hn(t);for(var e,n,r=t.target,i=t.type;!t.isPropagationStopped&&(e=Xn(e,r));)t.bubbles||t.stopPropagation(),n=gn.get(e),Xt(n,"trigger",Gn,{eventType:i,handler:void 0,context:void 0},t)},Jn={pointermove:1,pointerdown:1,pointerup:1,pointerover:1,pointerout:1,pointerenter:1,pointerleave:1,pointercancel:1},Qn=function(){if(Ct.addEventListener){var t,e;for(t in Ct)e=t.replace(vn,""),t!==e&&(e in Jn||Ct.addEventListener(e,Kn));F(Jn).forEach(function(t){Ct.addEventListener(t,Kn)})}};Qn();var Zn={classSet:ln,Component:b,create:An,createClass:zn,render:Dn,renderToString:On,select:Vn,styleSet:mn},tr=function(t){
return un("/",t)},er=/^\/+|\/+$/g,nr={},rr=function(t){return t.replace(Xe,"\\$&").replace(Ge,"(?:$1)?").replace(Ke,function(t,e){return e?t:"([^/?]+)"}).replace(Je,"([^?]*)")},ir=function(t){var e,n,r=nr[t];return r?r:(e=new RegExp("^"+rr(t)),n=(t.match(Qe)||[]).map(function(t){return t.slice(1)}),r={regexp:e,names:n},nr[t]=r)};w.prototype={constructor:w,normalize:tr,route:function(t,e,n){var r=new w(t,e,n,this);return this.routesMap[r.name]&&motaErr("mota.Router.route","There is already a route with the name `"+t+"`"),this.routes.push(r),this.routesMap[r.name]=r,this},setCallback:function(t){return this.callback=t,this},setDefaultCallback:function(t){return this.defaultCallback=t,this},triggerRoutes:function(t,e){var n,r,i=0,o=this.routes.length,a=function(t,r){var i=n.params.names[r];e[i]=t?decodeURIComponent(t):null};for(t=this.normalize(t),this.callback&&this.callback(e,t);o>i;i++)if(n=this.routes[i],r=t.match(n.params.regexp))return e={},r.slice(1).forEach(a),void n.triggerRoutes(t,e);this.defaultCallback&&this.defaultCallback(t)}};var or=/#(.*)$/;return _.extend=L,A(_.prototype,w.prototype,{constructor:_,_join:function(t){return"/"!==this.root?this.root+t:t},atRoot:function(){return this.location.search?!1:this.root===this.normalize(this.location.pathname)},checkUrl:function(t){return t&&"hashchange"===t.type?this.triggerRoutes(this.fragment=this.getHash(t.newURL)):this.triggerRoutes(this.fragment=this.getFragment())},getHash:function(t){var e=(t||this.location.href).match(or);return this.normalize(e?e[1]:"")},getPath:function(){var t=this.root,e=this.location.pathname+this.location.search;return 0===e.indexOf(t)&&(e=e.slice(t.length)),this.normalize(e)},getFragment:function(){return this.normalize(this._hasPushState?this.getPath():this.getHash())},start:function(t){if(!this._started){this._started=!0,this.root=this.normalize(t&&t.root);var e=this.getFragment();if(!this._hasPushState&&!this.atRoot())return void this.location.replace(this._join("/#"+this.getPath()));this._hasPushState&&this.atRoot()?this.navigate(this.getHash(),{replace:!0}):(this.triggerRoutes(e),this.fragment=e),this.window.on(this._hasPushState?"popstate":"hashchange",this.checkUrl,this)}},stop:function(){this._started&&(this._started=!1,this.window.off(this._hasPushState?"popstate":"hashchange",this.checkUrl,this))},navigate:function(t,e){var n;return this._started?(e&&e!==!0||(e={replace:!!e}),t=this.normalize(t),void(this.fragment!==t&&(this.fragment=t,this._hasPushState?(this.history[e.replace?"replaceState":"pushState"]({},Rt.title,this._join(t)),this.triggerRoutes(t)):e.replace?(n=location.href.replace(/(javascript:|#).*$/,""),this.location.replace(n+"#"+t)):this.location.hash="#"+t))):!1}}),x.VERSION="0.8.0",Ot.extend(x,Ot,{hashCode:a,events:ce,Map:f,Model:d,path:y,Router:_,util:Ot,view:Zn,setWindow:At}),x.developmentMode=!1,x});
//# sourceMappingURL=mota.min.js.map