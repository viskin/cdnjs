/*!
 * data.js v0.2.0 (https://github.com/yanhaijing/data.js)
 * Copyright 2013 yanhaijing. All Rights Reserved
 * Licensed under MIT (https://github.com/yanhaijing/data.js/blob/master/MIT-LICENSE.txt)
 */
!function(a,b){var c=b(a);if("function"==typeof define&&define.amd)define("data",function(){return c});else if("object"==typeof exports)module.exports=c;else{var d=a.Data;c.noConflict=function(){return a.Data===c&&(a.Data=d),c},a.Data=c}}(this,function(){"use strict";function a(a){return"[object Function]"===k.call(a)}function b(b){return a(Array.isArray)?Array.isArray(b):"[object Array]"===k.call(b)}function c(a){return"[object Object]"===k.call(a)}function d(){for(var a,e,f=arguments[0]||{},g=i.call(arguments,1),h=g.length,j=0;h>j;j++){var k=g[j];for(var l in k){var m=f[l],n=k[l];f!==n&&(n&&(c(n)||(a=b(n)))?(a?(a=!1,e=m&&b(m)?m:[]):e=m&&c(m)?m:{},f[l]=d(e,n)):"undefined"!=typeof n&&(f[l]=n))}}return f}function e(a,d,f,g){var i;for(var j in g){var k,l=f[j],m=g[j];f!==m&&(i=("undefined"==typeof a?"":a+".")+j,h(d,"set",i,m),"undefined"==typeof m?h(d,"delete",i,m):"undefined"==typeof f[j]?h(d,"add",i,m):h(d,"update",i,m),m&&(c(m)||(k=b(m)))?(k?(k=!1,f[j]=l&&b(l)?l:[]):f[j]=l&&c(l)?l:{},f[j]=e(i,d,f[j],m)):f[j]=m)}return f}function f(a){return a.split(".")}function g(a){return c(a)?d({},a):b(a)?d([],a):a}function h(a,b,d,e){if(a=a[b][d],c(a))for(var f in a)a.hasOwnProperty(f)&&a[f]({type:b,key:d,data:e})}var i=[].slice,j={},k=j.toString,l=(j.hasOwnProperty,0),m=function(){return this instanceof m?void this._init():new m};d(m.prototype,{_init:function(){this._context={},this._events={set:{},"delete":{},add:{},update:{}}},set:function(a,d){var g=this._context;if("string"!=typeof a)return!1;var h,i,j=f(a),k=j.length,l=0;if(2>k)return i={},i[a]=d,e(void 0,this._events,g,i),!0;for(;k-1>l;l++){if(h=j[l],!b(g[h])&&!c(g[h])){if("undefined"==typeof d)return!1;g[h]=isNaN(Number(h))?{}:[]}g=g[h]}return h=j.pop(),i=b(g)?[]:{},i[h]=d,g=e(j.join("."),this._events,g,i),!0},get:function(a){if("string"!=typeof a)return void 0;for(var b,c=f(a),d=c.length,e=0,h=this._context;d>e;e++)if(b=c[e],h=h[b],"undefined"==typeof h||null===h)return h;return g(h)},has:function(a){return"undefined"==typeof this.get(a)?!1:!0},sub:function(b,c,d){if("string"!=typeof b||"string"!=typeof c||!a(d))return-1;var e=this._events[b]||{};return e[c]=e[c]||{},e[c][l++]=d,l-1},unsub:function(a,b,d){if("string"!=typeof a||"string"!=typeof b)return!1;var e=this._events[a]||{};return c(e[b])?"number"!=typeof d?(delete e[b],!0):(delete e[b][d],!0):!1}});var n=new m;return d(m,{version:"0.2.1",has:function(a){return n.has(a)},get:function(a){return n.get(a)},set:function(a,b){return n.set(a,b)},sub:function(a,b,c){return n.sub(a,b,c)},unsub:function(a,b,c){return n.unsub(a,b,c)}}),m});