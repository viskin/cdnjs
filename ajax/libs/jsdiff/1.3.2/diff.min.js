!function(e,n){var t=function(){function e(e,n,t){if(Array.prototype.map)return Array.prototype.map.call(e,n,t);for(var r=new Array(e.length),o=0,i=e.length;i>o;o++)r[o]=n.call(t,e[o],o,e);return r}function t(e){return{newPos:e.newPos,components:e.components.slice(0)}}function r(e){for(var n=[],t=0;t<e.length;t++)e[t]&&n.push(e[t]);return n}function o(e){var n=e;return n=n.replace(/&/g,"&amp;"),n=n.replace(/</g,"&lt;"),n=n.replace(/>/g,"&gt;"),n=n.replace(/"/g,"&quot;")}function i(n,t,r,o){for(var i=0,u=n.length,s=0,f=0;u>i;i++){var l=n[i];if(l.removed)l.value=r.slice(f,f+l.count).join(""),f+=l.count;else{if(!l.added&&o){var a=t.slice(s,s+l.count);a=e(a,function(e,n){var t=r[f+n];return t.length>e.length?t:e}),l.value=a.join("")}else l.value=t.slice(s,s+l.count).join("");s+=l.count,l.added||(f+=l.count)}}return n}function u(e,n,t){n=n||[],t=t||[];for(var r,r=0;r<n.length;r+=1)if(n[r]===e)return t[r];var o;if("[object Array]"===g.call(e)){for(n.push(e),o=new Array(e.length),t.push(o),r=0;r<e.length;r+=1)o[r]=u(e[r],n,t);n.pop(),t.pop()}else if("object"==typeof e&&null!==e){n.push(e),o={},t.push(o);var i=[];for(var s in e)i.push(s);for(i.sort(),r=0;r<i.length;r+=1){var s=i[r];o[s]=u(e[s],n,t)}n.pop(),t.pop()}else o=e;return o}var s=function(e){this.ignoreWhitespace=e};s.prototype={diff:function(e,r,o){function u(e){return o?(setTimeout(function(){o(n,e)},0),!0):e}function s(){for(var o=-1*c;c>=o;o+=2){var s,p=d[o-1],h=d[o+1];m=(h?h.newPos:0)-o,p&&(d[o-1]=n);var v=p&&p.newPos+1<l,g=h&&m>=0&&a>m;if(v||g){!v||g&&p.newPos<h.newPos?(s=t(h),f.pushComponent(s.components,n,!0)):(s=p,s.newPos++,f.pushComponent(s.components,!0,n));var m=f.extractCommon(s,r,e,o);if(s.newPos+1>=l&&m+1>=a)return u(i(s.components,r,e,f.useLongestToken));d[o]=s}else d[o]=n}c++}var f=this;if(r===e)return u([{value:r}]);if(!r)return u([{value:e,removed:!0}]);if(!e)return u([{value:r,added:!0}]);r=this.tokenize(r),e=this.tokenize(e);var l=r.length,a=e.length,p=l+a,d=[{newPos:-1,components:[]}],h=this.extractCommon(d[0],r,e,0);if(d[0].newPos+1>=l&&h+1>=a)return u([{value:r.join("")}]);var c=1;if(o)!function g(){setTimeout(function(){return c>p?o():void(s()||g())},0)}();else for(;p>=c;){var v=s();if(v)return v}},pushComponent:function(e,n,t){var r=e[e.length-1];r&&r.added===n&&r.removed===t?e[e.length-1]={count:r.count+1,added:n,removed:t}:e.push({count:1,added:n,removed:t})},extractCommon:function(e,n,t,r){for(var o=n.length,i=t.length,u=e.newPos,s=u-r,f=0;o>u+1&&i>s+1&&this.equals(n[u+1],t[s+1]);)u++,s++,f++;return f&&e.components.push({count:f}),e.newPos=u,s},equals:function(e,n){var t=/\S/;return e===n||this.ignoreWhitespace&&!t.test(e)&&!t.test(n)},tokenize:function(e){return e.split("")}};var f=new s,l=new s(!0),a=new s;l.tokenize=a.tokenize=function(e){return r(e.split(/(\s+|\b)/))};var p=new s(!0);p.tokenize=function(e){return r(e.split(/([{}:;,]|\s+)/))};var d=new s,h=new s;h.ignoreTrim=!0,d.tokenize=h.tokenize=function(e){for(var n=[],t=e.split(/^/m),r=0;r<t.length;r++){var o=t[r],i=t[r-1],u=i?i[i.length-1]:"";"\n"===o&&"\r"===u?n[n.length-1]=n[n.length-1].slice(0,-1)+"\r\n":o&&(this.ignoreTrim&&(o=o.trim(),r<t.length-1&&(o+="\n")),n.push(o))}return n};var c=new s;c.tokenize=function(e){return r(e.split(/(\S.+?[.!?])(?=\s+|$)/))};var v=new s;v.useLongestToken=!0,v.tokenize=d.tokenize,v.equals=function(e,n){return d.equals(e.replace(/,([\r\n])/g,"$1"),n.replace(/,([\r\n])/g,"$1"))};var g=Object.prototype.toString;return{Diff:s,diffChars:function(e,n,t){return f.diff(e,n,t)},diffWords:function(e,n,t){return l.diff(e,n,t)},diffWordsWithSpace:function(e,n,t){return a.diff(e,n,t)},diffLines:function(e,n,t){return d.diff(e,n,t)},diffTrimmedLines:function(e,n,t){return h.diff(e,n,t)},diffSentences:function(e,n,t){return c.diff(e,n,t)},diffCss:function(e,n,t){return p.diff(e,n,t)},diffJson:function(e,t,r){return v.diff("string"==typeof e?e:JSON.stringify(u(e),n,"  "),"string"==typeof t?t:JSON.stringify(u(t),n,"  "),r)},createPatch:function(n,t,r,o,i){function u(n){return e(n,function(e){return" "+e})}function s(e,n,t){var r=l[l.length-2],o=n===l.length-2,i=n===l.length-3&&(t.added!==r.added||t.removed!==r.removed);/\n$/.test(t.value)||!o&&!i||e.push("\\ No newline at end of file")}var f=[];f.push("Index: "+n),f.push("==================================================================="),f.push("--- "+n+("undefined"==typeof o?"":"	"+o)),f.push("+++ "+n+("undefined"==typeof i?"":"	"+i));var l=d.diff(t,r);l[l.length-1].value||l.pop(),l.push({value:"",lines:[]});for(var a=0,p=0,h=[],c=1,v=1,g=0;g<l.length;g++){var m=l[g],w=m.lines||m.value.replace(/\n$/,"").split("\n");if(m.lines=w,m.added||m.removed){if(!a){var y=l[g-1];a=c,p=v,y&&(h=u(y.lines.slice(-4)),a-=h.length,p-=h.length)}h.push.apply(h,e(w,function(e){return(m.added?"+":"-")+e})),s(h,g,m),m.added?v+=w.length:c+=w.length}else{if(a)if(w.length<=8&&g<l.length-2)h.push.apply(h,u(w));else{var P=Math.min(w.length,4);f.push("@@ -"+a+","+(c-a+P)+" +"+p+","+(v-p+P)+" @@"),f.push.apply(f,h),f.push.apply(f,u(w.slice(0,P))),w.length<=4&&s(f,g,m),a=0,p=0,h=[]}c+=w.length,v+=w.length}}return f.join("\n")+"\n"},applyPatch:function(e,n){for(var t=n.split("\n"),r=[],o=0,i=!1,u=!1;o<t.length&&!/^@@/.test(t[o]);)o++;for(;o<t.length;o++)if("@"===t[o][0]){var s=t[o].split(/@@ -(\d+),(\d+) \+(\d+),(\d+) @@/);r.unshift({start:s[3],oldlength:s[2],oldlines:[],newlength:s[4],newlines:[]})}else"+"===t[o][0]?r[0].newlines.push(t[o].substr(1)):"-"===t[o][0]?r[0].oldlines.push(t[o].substr(1)):" "===t[o][0]?(r[0].newlines.push(t[o].substr(1)),r[0].oldlines.push(t[o].substr(1))):"\\"===t[o][0]&&("+"===t[o-1][0]?i=!0:"-"===t[o-1][0]&&(u=!0));for(var f=e.split("\n"),o=r.length-1;o>=0;o--){for(var l=r[o],a=0;a<l.oldlength;a++)if(f[l.start-1+a]!==l.oldlines[a])return!1;Array.prototype.splice.apply(f,[l.start-1,+l.oldlength].concat(l.newlines))}if(i)for(;!f[f.length-1];)f.pop();else u&&f.push("");return f.join("\n")},convertChangesToXML:function(e){for(var n=[],t=0;t<e.length;t++){var r=e[t];r.added?n.push("<ins>"):r.removed&&n.push("<del>"),n.push(o(r.value)),r.added?n.push("</ins>"):r.removed&&n.push("</del>")}return n.join("")},convertChangesToDMP:function(e){for(var n,t=[],r=0;r<e.length;r++)n=e[r],t.push([n.added?1:n.removed?-1:0,n.value]);return t},canonicalize:u}}();"undefined"!=typeof module&&module.exports?module.exports=t:"function"==typeof define&&define.amd?define([],function(){return t}):"undefined"==typeof e.JsDiff&&(e.JsDiff=t)}(this);