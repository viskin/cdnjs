var JsDiff=function(){function e(e){return{newPos:e.newPos,components:e.components.slice(0)}}function n(e){for(var n=[],t=0;t<e.length;t++)e[t]&&n.push(e[t]);return n}function t(e){var n=e;return n=n.replace(/&/g,"&amp;"),n=n.replace(/</g,"&lt;"),n=n.replace(/>/g,"&gt;"),n=n.replace(/"/g,"&quot;")}var o=function(e){this.ignoreWhitespace=e};o.prototype={diff:function(n,t){if(t===n)return[{value:t}];if(!t)return[{value:n,removed:!0}];if(!n)return[{value:t,added:!0}];t=this.tokenize(t),n=this.tokenize(n);var o=t.length,r=n.length,s=o+r,i=[{newPos:-1,components:[]}],u=this.extractCommon(i[0],t,n,0);if(i[0].newPos+1>=o&&u+1>=r)return i[0].components;for(var l=1;s>=l;l++)for(var a=-1*l;l>=a;a+=2){var f,d=i[a-1],h=i[a+1];u=(h?h.newPos:0)-a,d&&(i[a-1]=void 0);var p=d&&d.newPos+1<o,v=h&&u>=0&&r>u;if(p||v){!p||v&&d.newPos<h.newPos?(f=e(h),this.pushComponent(f.components,n[u],void 0,!0)):(f=e(d),f.newPos++,this.pushComponent(f.components,t[f.newPos],!0,void 0));var u=this.extractCommon(f,t,n,a);if(f.newPos+1>=o&&u+1>=r)return f.components;i[a]=f}else i[a]=void 0}},pushComponent:function(e,n,t,o){var r=e[e.length-1];r&&r.added===t&&r.removed===o?e[e.length-1]={value:this.join(r.value,n),added:t,removed:o}:e.push({value:n,added:t,removed:o})},extractCommon:function(e,n,t,o){for(var r=n.length,s=t.length,i=e.newPos,u=i-o;r>i+1&&s>u+1&&this.equals(n[i+1],t[u+1]);)i++,u++,this.pushComponent(e.components,n[i],void 0,void 0);return e.newPos=i,u},equals:function(e,n){var t=/\S/;return!this.ignoreWhitespace||t.test(e)||t.test(n)?e===n:!0},join:function(e,n){return e+n},tokenize:function(e){return e}};var r=new o,s=new o(!0),i=new o;s.tokenize=i.tokenize=function(e){return n(e.split(/(\s+|\b)/))};var u=new o(!0);u.tokenize=function(e){return n(e.split(/([{}:;,]|\s+)/))};var l=new o;return l.tokenize=function(e){for(var n=[],t=e.split(/^/m),o=0;o<t.length;o++){var r=t[o],s=t[o-1];"\n"==r&&s&&"\r"===s[s.length-1]?n[n.length-1]+="\n":r&&n.push(r)}return n},{Diff:o,diffChars:function(e,n){return r.diff(e,n)},diffWords:function(e,n){return s.diff(e,n)},diffWordsWithSpace:function(e,n){return i.diff(e,n)},diffLines:function(e,n){return l.diff(e,n)},diffCss:function(e,n){return u.diff(e,n)},createPatch:function(e,n,t,o,r){function s(e){return e.map(function(e){return" "+e})}function i(e,n,t){var o=a[a.length-2],r=n===a.length-2,s=n===a.length-3&&(t.added!==o.added||t.removed!==o.removed);/\n$/.test(t.value)||!r&&!s||e.push("\\ No newline at end of file")}var u=[];u.push("Index: "+e),u.push("==================================================================="),u.push("--- "+e+("undefined"==typeof o?"":"	"+o)),u.push("+++ "+e+("undefined"==typeof r?"":"	"+r));var a=l.diff(n,t);a[a.length-1].value||a.pop(),a.push({value:"",lines:[]});for(var f=0,d=0,h=[],p=1,v=1,c=0;c<a.length;c++){var g=a[c],m=g.lines||g.value.replace(/\n$/,"").split("\n");if(g.lines=m,g.added||g.removed){if(!f){var w=a[c-1];f=p,d=v,w&&(h=s(w.lines.slice(-4)),f-=h.length,d-=h.length)}h.push.apply(h,m.map(function(e){return(g.added?"+":"-")+e})),i(h,c,g),g.added?v+=m.length:p+=m.length}else{if(f)if(m.length<=8&&c<a.length-2)h.push.apply(h,s(m));else{var P=Math.min(m.length,4);u.push("@@ -"+f+","+(p-f+P)+" +"+d+","+(v-d+P)+" @@"),u.push.apply(u,h),u.push.apply(u,s(m.slice(0,P))),m.length<=4&&i(u,c,g),f=0,d=0,h=[]}p+=m.length,v+=m.length}}return u.join("\n")+"\n"},applyPatch:function(e,n){for(var t=n.split("\n"),o=[],r=!1,s=!1,i="I"===t[0][0]?4:0;i<t.length;i++)if("@"===t[i][0]){var u=t[i].split(/@@ -(\d+),(\d+) \+(\d+),(\d+) @@/);o.unshift({start:u[3],oldlength:u[2],oldlines:[],newlength:u[4],newlines:[]})}else"+"===t[i][0]?o[0].newlines.push(t[i].substr(1)):"-"===t[i][0]?o[0].oldlines.push(t[i].substr(1)):" "===t[i][0]?(o[0].newlines.push(t[i].substr(1)),o[0].oldlines.push(t[i].substr(1))):"\\"===t[i][0]&&("+"===t[i-1][0]?r=!0:"-"===t[i-1][0]&&(s=!0));for(var l=e.split("\n"),i=o.length-1;i>=0;i--){for(var a=o[i],f=0;f<a.oldlength;f++)if(l[a.start-1+f]!==a.oldlines[f])return!1;Array.prototype.splice.apply(l,[a.start-1,+a.oldlength].concat(a.newlines))}if(r)for(;!l[l.length-1];)l.pop();else s&&l.push("");return l.join("\n")},convertChangesToXML:function(e){for(var n=[],o=0;o<e.length;o++){var r=e[o];r.added?n.push("<ins>"):r.removed&&n.push("<del>"),n.push(t(r.value)),r.added?n.push("</ins>"):r.removed&&n.push("</del>")}return n.join("")},convertChangesToDMP:function(e){for(var n,t=[],o=0;o<e.length;o++)n=e[o],t.push([n.added?1:n.removed?-1:0,n.value]);return t}}}();"undefined"!=typeof module&&(module.exports=JsDiff);