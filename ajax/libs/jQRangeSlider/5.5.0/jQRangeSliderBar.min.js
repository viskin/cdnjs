(function(b,c){b.widget("ui.rangeSliderBar",b.ui.rangeSliderDraggable,{options:{leftHandle:null,rightHandle:null,bounds:{min:0,max:100},type:"rangeSliderHandle",range:false,drag:function(){},stop:function(){},values:{min:0,max:20},wheelSpeed:4,wheelMode:null},_values:{min:0,max:20},_waitingToInit:2,_wheelTimeout:false,_create:function(){b.ui.rangeSliderDraggable.prototype._create.apply(this);this.element.css("position","absolute").css("top",0).addClass("ui-rangeSlider-bar");this.options.leftHandle.bind("initialize",b.proxy(this._onInitialized,this)).bind("mousestart",b.proxy(this._cache,this)).bind("stop",b.proxy(this._onHandleStop,this));this.options.rightHandle.bind("initialize",b.proxy(this._onInitialized,this)).bind("mousestart",b.proxy(this._cache,this)).bind("stop",b.proxy(this._onHandleStop,this));this._bindHandles();this._values=this.options.values;this._setWheelModeOption(this.options.wheelMode)},destroy:function(){this.options.leftHandle.unbind(".bar");this.options.rightHandle.unbind(".bar");this.options=null;b.ui.rangeSliderDraggable.prototype.destroy.apply(this)},_setOption:function(d,e){if(d==="range"){this._setRangeOption(e)}else{if(d==="wheelSpeed"){this._setWheelSpeedOption(e)}else{if(d==="wheelMode"){this._setWheelModeOption(e)}}}},_setRangeOption:function(f){if(typeof f!=="object"||f===null){f=false}if(f===false&&this.options.range===false){return}if(f!==false){var e=a(f.min,this.options.range.min),d=a(f.max,this.options.range.max);this.options.range={min:e,max:d}}else{this.options.range=false}this._setLeftRange();this._setRightRange()},_setWheelSpeedOption:function(d){if(typeof d==="number"&&d>0){this.options.wheelSpeed=d}},_setWheelModeOption:function(d){if(d===null||d===false||d==="zoom"||d==="scroll"){if(this.options.wheelMode!==d){this.element.parent().unbind("mousewheel.bar")}this._bindMouseWheel(d);this.options.wheelMode=d}},_bindMouseWheel:function(d){if(d==="zoom"){this.element.parent().bind("mousewheel.bar",b.proxy(this._mouseWheelZoom,this))}else{if(d==="scroll"){this.element.parent().bind("mousewheel.bar",b.proxy(this._mouseWheelScroll,this))}}},_setLeftRange:function(){if(this.options.range===false){return false}var d=this._values.max,e={min:false,max:false};if((this.options.range.min||false)!==false){e.max=this._leftHandle("substract",d,this.options.range.min)}else{e.max=false}if((this.options.range.max||false)!==false){e.min=this._leftHandle("substract",d,this.options.range.max)}else{e.min=false}this._leftHandle("option","range",e)},_setRightRange:function(){var e=this._values.min,d={min:false,max:false};if((this.options.range.min||false)!==false){d.min=this._rightHandle("add",e,this.options.range.min)}else{d.min=false}if((this.options.range.max||false)!==false){d.max=this._rightHandle("add",e,this.options.range.max)}else{d.max=false}this._rightHandle("option","range",d)},_deactivateRange:function(){this._leftHandle("option","range",false);this._rightHandle("option","range",false)},_reactivateRange:function(){this._setRangeOption(this.options.range)},_onInitialized:function(){this._waitingToInit--;if(this._waitingToInit===0){this._initMe()}},_initMe:function(){this._cache();this.min(this._values.min);this.max(this._values.max);var e=this._leftHandle("position"),d=this._rightHandle("position")+this.options.rightHandle.width();this.element.offset({left:e});this.element.css("width",d-e)},_leftHandle:function(){return this._handleProxy(this.options.leftHandle,arguments)},_rightHandle:function(){return this._handleProxy(this.options.rightHandle,arguments)},_handleProxy:function(e,d){var f=Array.prototype.slice.call(d);return e[this.options.type].apply(e,f)},_cache:function(){b.ui.rangeSliderDraggable.prototype._cache.apply(this);this._cacheHandles()},_cacheHandles:function(){this.cache.rightHandle={};this.cache.rightHandle.width=this.options.rightHandle.width();this.cache.rightHandle.offset=this.options.rightHandle.offset();this.cache.leftHandle={};this.cache.leftHandle.offset=this.options.leftHandle.offset()},_mouseStart:function(d){b.ui.rangeSliderDraggable.prototype._mouseStart.apply(this,[d]);this._deactivateRange()},_mouseStop:function(d){b.ui.rangeSliderDraggable.prototype._mouseStop.apply(this,[d]);this._cacheHandles();this._values.min=this._leftHandle("value");this._values.max=this._rightHandle("value");this._reactivateRange();this._leftHandle().trigger("stop");this._rightHandle().trigger("stop")},_onDragLeftHandle:function(d,e){this._cacheIfNecessary();if(e.element[0]!==this.options.leftHandle[0]){return}if(this._switchedValues()){this._switchHandles();this._onDragRightHandle(d,e);return}this._values.min=e.value;this.cache.offset.left=e.offset.left;this.cache.leftHandle.offset=e.offset;this._positionBar()},_onDragRightHandle:function(d,e){this._cacheIfNecessary();if(e.element[0]!==this.options.rightHandle[0]){return}if(this._switchedValues()){this._switchHandles();this._onDragLeftHandle(d,e);return}this._values.max=e.value;this.cache.rightHandle.offset=e.offset;this._positionBar()},_positionBar:function(){var d=this.cache.rightHandle.offset.left+this.cache.rightHandle.width-this.cache.leftHandle.offset.left;this.cache.width.inner=d;this.element.css("width",d).offset({left:this.cache.leftHandle.offset.left})},_onHandleStop:function(){this._setLeftRange();this._setRightRange()},_switchedValues:function(){if(this.min()>this.max()){var d=this._values.min;this._values.min=this._values.max;this._values.max=d;return true}return false},_switchHandles:function(){var d=this.options.leftHandle;this.options.leftHandle=this.options.rightHandle;this.options.rightHandle=d;this._leftHandle("option","isLeft",true);this._rightHandle("option","isLeft",false);this._bindHandles();this._cacheHandles()},_bindHandles:function(){this.options.leftHandle.unbind(".bar").bind("sliderDrag.bar update.bar moving.bar",b.proxy(this._onDragLeftHandle,this));this.options.rightHandle.unbind(".bar").bind("sliderDrag.bar update.bar moving.bar",b.proxy(this._onDragRightHandle,this))},_constraintPosition:function(f){var d={},e;d.left=b.ui.rangeSliderDraggable.prototype._constraintPosition.apply(this,[f]);d.left=this._leftHandle("position",d.left);e=this._rightHandle("position",d.left+this.cache.width.outer-this.cache.rightHandle.width);d.width=e-d.left+this.cache.rightHandle.width;return d},_applyPosition:function(d){b.ui.rangeSliderDraggable.prototype._applyPosition.apply(this,[d.left]);this.element.width(d.width)},_mouseWheelZoom:function(i,j,e,d){if(!this.enabled){return false}var f=this._values.min+(this._values.max-this._values.min)/2,g={},h={};if(this.options.range===false||this.options.range.min===false){g.max=f;h.min=f}else{g.max=f-this.options.range.min/2;h.min=f+this.options.range.min/2}if(this.options.range!==false&&this.options.range.max!==false){g.min=f-this.options.range.max/2;h.max=f+this.options.range.max/2}this._leftHandle("option","range",g);this._rightHandle("option","range",h);clearTimeout(this._wheelTimeout);this._wheelTimeout=setTimeout(b.proxy(this._wheelStop,this),200);this.zoomOut(d*this.options.wheelSpeed);return false},_mouseWheelScroll:function(f,g,e,d){if(!this.enabled){return false}if(this._wheelTimeout===false){this.startScroll()}else{clearTimeout(this._wheelTimeout)}this._wheelTimeout=setTimeout(b.proxy(this._wheelStop,this),200);this.scrollLeft(d*this.options.wheelSpeed);return false},_wheelStop:function(){this.stopScroll();this._wheelTimeout=false},min:function(d){return this._leftHandle("value",d)},max:function(d){return this._rightHandle("value",d)},startScroll:function(){this._deactivateRange()},stopScroll:function(){this._reactivateRange();this._triggerMouseEvent("stop");this._leftHandle().trigger("stop");this._rightHandle().trigger("stop")},scrollLeft:function(d){d=d||1;if(d<0){return this.scrollRight(-d)}d=this._leftHandle("moveLeft",d);this._rightHandle("moveLeft",d);this.update();this._triggerMouseEvent("scroll")},scrollRight:function(d){d=d||1;if(d<0){return this.scrollLeft(-d)}d=this._rightHandle("moveRight",d);this._leftHandle("moveRight",d);this.update();this._triggerMouseEvent("scroll")},zoomIn:function(e){e=e||1;if(e<0){return this.zoomOut(-e)}var d=this._rightHandle("moveLeft",e);if(e>d){d=d/2;this._rightHandle("moveRight",d)}this._leftHandle("moveRight",d);this.update();this._triggerMouseEvent("zoom")},zoomOut:function(e){e=e||1;if(e<0){return this.zoomIn(-e)}var d=this._rightHandle("moveRight",e);if(e>d){d=d/2;this._rightHandle("moveLeft",d)}this._leftHandle("moveLeft",d);this.update();this._triggerMouseEvent("zoom")},values:function(e,d){if(typeof e!=="undefined"&&typeof d!=="undefined"){var f=Math.min(e,d),g=Math.max(e,d);this._deactivateRange();this.options.leftHandle.unbind(".bar");this.options.rightHandle.unbind(".bar");this._values.min=this._leftHandle("value",f);this._values.max=this._rightHandle("value",g);this._bindHandles();this._reactivateRange();this.update()}return{min:this._values.min,max:this._values.max}},update:function(){this._values.min=this.min();this._values.max=this.max();this._cache();this._positionBar()}});function a(e,d){if(typeof e==="undefined"){return d||false}return e}}(jQuery));