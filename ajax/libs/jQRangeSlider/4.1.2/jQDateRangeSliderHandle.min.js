(function(a,b){a.widget("ui.dateRangeSliderHandle",a.ui.rangeSliderHandle,{_steps:false,_boundsValues:{},_create:function(){a.ui.rangeSliderHandle.prototype._create.apply(this);this._createBoundsValues()},_getValueForPosition:function(d){var f=this.options.bounds.min.valueOf(),c=this.options.bounds.max.valueOf();if(!this.options.isLeft){d+=this.cache.width.outer}var g=(d-this.cache.parent.offset.left)/this.cache.parent.width,e=g*(c-f)+f;return this._constraintValue(new Date(e))},_setOption:function(c,d){if(c==="step"){this.options.step=d;this._createSteps();this.update();return}a.ui.rangeSliderHandle.prototype._setOption.apply(this,[c,d]);if(c==="bounds"){this._createBoundsValues()}},_createBoundsValues:function(){this._boundsValues={min:this.options.bounds.min.valueOf(),max:this.options.bounds.max.valueOf()}},_bounds:function(){return this._boundsValues},_createSteps:function(){if(this.options.step===false||!this._isValidStep()){this._steps=false;return}var d=new Date(this.options.bounds.min),e=new Date(this.options.bounds.max),f=d,c=0;this._steps=[];while(f<=e){this._steps.push(f.valueOf());f=this._addStep(d,c,this.options.step);c++}},_isValidStep:function(){return typeof this.options.step==="object"},_addStep:function(d,e,f){var c=new Date(d.valueOf());c=this._addThing(c,"FullYear",e,f.years);c=this._addThing(c,"Month",e,f.months);c=this._addThing(c,"Date",e,f.days);c=this._addThing(c,"Hours",e,f.hours);c=this._addThing(c,"Minutes",e,f.minutes);c=this._addThing(c,"Seconds",e,f.seconds);return c},_addThing:function(d,c,e,f){if(e===0||(f||0)===0){return d}d["set"+c](d["get"+c]()+e*(f||0));return d},_round:function(h){if(this._steps===false){return h}var c=this.options.bounds.max.valueOf(),e=this.options.bounds.min.valueOf(),f=(h-e)/(c-e),d=Math.floor(this._steps.length*f),g,i;while(this._steps[d]>h){d--}while(d+1<this._steps.length&&this._steps[d+1]<=h){d++}if(d>=this._steps.length-1){return this._steps[this._steps.length-1]}else{if(d==0){return this._steps[0]}}g=this._steps[d];i=this._steps[d+1];if(h-g<i-h){return g}return i},update:function(){this._createBoundsValues();this._createSteps();a.ui.rangeSliderHandle.prototype.update.apply(this)},add:function(c,d){return this._addStep(new Date(c),1,d).valueOf()},substract:function(c,d){return this._addStep(new Date(c),-1,d).valueOf()},stepsBetween:function(i,g){if(this.options.step===false){return val2-val1}var f=Math.min(i,g),c=Math.max(i,g),d=0,e=false,h=i>g;if(this.add(f,this.options.step)-f<0){e=true}while(f<c){if(e){c=this.add(c,this.options.step)}else{f=this.add(f,this.options.step)}d++}return h?-d:d},multiplyStep:function(f,e){var c={};for(var d in f){c[d]=f[d]*e}return c},stepRatio:function(){if(this.options.step==false){return 1}else{var c=this._steps.length;return this.cache.parent.width/c}}})})(jQuery);