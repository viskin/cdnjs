(function(a,b){a.widget("ui.rangeSlider",{options:{bounds:{min:0,max:100},defaultValues:{min:20,max:50},wheelMode:null,wheelSpeed:4,arrows:true},_values:{min:20,max:50},bar:null,leftHandle:null,rightHandle:null,innerBar:null,container:null,leftArrow:null,rightArrow:null,lastWheel:0,lastScroll:0,scrollCount:0,_create:function(){this.leftHandle=a("<div class='ui-rangeSlider-handle  ui-rangeSlider-leftHandle' />").draggable({axis:"x",containment:"parent",drag:a.proxy(this._handleMoved,this),stop:a.proxy(this._handleStop,this),containment:"parent"}).css("position","absolute");this.rightHandle=a("<div class='ui-rangeSlider-handle ui-rangeSlider-rightHandle' />").draggable({axis:"x",containment:"parent",drag:a.proxy(this._handleMoved,this),stop:a.proxy(this._handleStop,this),containment:"parent"}).css("position","absolute");this.innerBar=a("<div class='ui-rangeSlider-innerBar' />").css("position","absolute").css("top",0).css("left",0);this.container=a("<div class='ui-rangeSlider-container' />").css("position","absolute");this.bar=a("<div class='ui-rangeSlider-Bar' />").draggable({axis:"x",containment:"parent",drag:a.proxy(this._barMoved,this),stop:a.proxy(this._barStop,this),containment:this.container}).css("position","absolute").bind("mousewheel",a.proxy(this._wheelOnBar,this));this.leftArrow=a("<div class='ui-rangeSlider-arrow ui-rangeSlider-leftArrow' />").css("position","absolute").css("left",0).bind("mousedown",a.proxy(this._startScrollLeft,this)).bind("mouseup",a.proxy(this._stopScroll,this));this.rightArrow=a("<div class='ui-rangeSlider-arrow ui-rangeSlider-rightArrow' />").css("position","absolute").css("right",0).bind("mousedown",a.proxy(this._startScrollRight,this)).bind("mouseup",a.proxy(this._stopScroll,this));this.container.append(this.leftHandle).append(this.rightHandle).append(this.innerBar).append(this.bar);this.element.append(this.container).append(this.leftArrow).append(this.rightArrow).addClass("ui-rangeSlider").bind("mousewheel",a.proxy(this._wheelOnContainer,this));if(this.element.css("position")!="absolute"){this.element.css("position","relative")}if(!this.options.arrows){this.leftArrow.css("display","none");this.rightArrow.css("display","none");this.element.addClass("ui-rangeSlider-noArrow")}else{this.element.addClass("ui-rangeSlider-arrow")}setTimeout(a.proxy(this._initWidth,this),1);setTimeout(a.proxy(this._initValues,this),1)},_initWidth:function(){this.container.css("width",this.element.width()-this.container.outerWidth(true)+this.container.width());this.innerBar.css("width",this.container.width()-this.innerBar.outerWidth(true)+this.innerBar.width())},_initValues:function(){this.values(this.options.defaultValues.min,this.options.defaultValues.max)},_setOption:function(c,d){if(c=="defaultValues"){if((typeof d.min!="undefined")&&(typeof d.max!="undefined")&&parseFloat(d.min)===d.min&&parseFloat(d.max)===d.max){this.values(d.min,d.max)}}else{if(c=="wheelMode"&&(d=="zoom"||d=="scroll"||d===null)){this.options.wheelMode=d}else{if(c=="wheelSpeed"&&parseFloat(d)!==NaN&&Math.abs(parseFloat(d))<=100){this.options.wheelSpeed=parseFloat(d)}else{if(c=="arrows"&&(d===true||d===false)&&d!=this.options.arrows){if(d){this.element.removeClass("ui-rangeSlider-noArrow").addClass("ui-rangeSlider-arrow");this.leftArrow.css("display","block");this.rightArrow.css("display","block")}else{this.element.addClass("ui-rangeSlider-noArrow").removeClass("ui-rangeSlider-arrow");this.leftArrow.css("display","none");this.rightArrow.css("display","none")}this.options.arrows=d;this._initWidth();this._position()}}}}},_getPosition:function(c){return(c-this.options.bounds.min)*(this.container.innerWidth()-1)/(this.options.bounds.max-this.options.bounds.min)},_getValue:function(c){return c*(this.options.bounds.max-this.options.bounds.min)/(this.container.innerWidth()-1)+this.options.bounds.min},_trigger:function(c){this.element.trigger(c,{helper:this.element,values:this.values()})},_position:function(){var c=this._getPosition(this._values.min);var d=this._getPosition(this._values.max);this._positionHandles();this.bar.css("left",c).css("width",d-c+this.bar.width()-this.bar.outerWidth(true)+1)},_positionHandles:function(){this.leftHandle.css("left",this._getPosition(this._values.min));this.rightHandle.css("left",this._getPosition(this._values.max)-this.rightHandle.outerWidth(true)+1)},_barMoved:function(d,e){var f=e.position.left;var c=f+this.bar.outerWidth(true)-1;this._setValues(this._getValue(f),this._getValue(c));this._positionHandles()},_barStop:function(c,d){this._position();this._trigger("valuesChanged")},_switchHandles:function(){var c=this.leftHandle;this.leftHandle=this.rightHandle;this.rightHandle=c;this.leftHandle.removeClass("ui-rangeSlider-rightHandle").addClass("ui-rangeSlider-leftHandle");this.rightHandle.addClass("ui-rangeSlider-rightHandle").removeClass("ui-rangeSlider-leftHandle")},_handleMoved:function(f,g){var e=this._values.min;var c=this._values.max;if(g.helper[0]==this.leftHandle[0]){e=this._getValue(g.position.left)}else{if(g.helper[0]==this.rightHandle[0]){c=this._getValue(g.position.left-1+g.helper.outerWidth(true))}else{return}}if(e>c){this._switchHandles();var d=e;e=c;c=d}this.values(e,c)},_handleStop:function(c,d){this._position()},_prepareFiringChanged:function(){this.lastWheel=Math.random();var c=this.lastWheel;setTimeout(a.proxy(function(){this._fireChanged(c)},this),200)},_fireChanged:function(c){if(this.lastWheel==c){this._trigger("valuesChanged")}},_wheelOnBar:function(e,f,d,c){if(this.options.wheelMode=="zoom"){this.zoomIn(-c);return false}},_wheelOnContainer:function(e,f,d,c){if(this.options.wheelMode=="scroll"){this.scrollRight(-c);return false}},_setValuesHandles:function(d,c){this._setValues(d,c);this._positionHandles()},_setValues:function(d,c){var e=Math.abs(c-d);if(e>=this.options.bounds.max-this.options.bounds.min){this._values.min=this.options.bounds.min;this._values.max=this.options.bounds.max}else{values={min:Math.min(c,d),max:Math.max(d,c)};if(values.min<this.options.bounds.min){values.min=this.options.bounds.min;values.max=values.min+e}else{if(values.max>this.options.bounds.max){values.max=this.options.bounds.max;values.min=values.max-e}}this._values=values}this._trigger("valuesChanging");this._prepareFiringChanged()},_startScrollLeft:function(c,d){this.lastScroll=Math.random();this.scrollCount=0;this._continueScrollingRight(-1,this.lastScroll)},_startScrollRight:function(c,d){this.lastScroll=Math.random();this.scrollCount=0;this._continueScrollingRight(1,this.lastScroll)},_continueScrollingRight:function(e,d){if(d==this.lastScroll){var c=Math.min(Math.floor(this.scrollCount/5)+1,4)/4;this.scrollRight(e*c);this.scrollCount++;setTimeout(a.proxy(function(){this._continueScrollingRight(e,d)},this),50)}},_stopScroll:function(c,d){this.lastScroll=Math.random()},values:function(d,c){if(typeof d!="undefined"&&typeof c!="undefined"){this._setValues(d,c);this._position()}return this._values},zoomIn:function(d){var c=this._values.max-this._values.min;min=this._values.min+d*this.options.wheelSpeed*c/200;max=this._values.max-d*this.options.wheelSpeed*c/200;this.values(min,max)},zoomOut:function(c){this.zoom(-c)},scrollLeft:function(c){if(typeof c=="undefined"){c=1}this.scrollRight(-c)},scrollRight:function(d){if(typeof d=="undefined"){d=1}var c=this._values.max-this._values.min;min=this._values.min+d*this.options.wheelSpeed*c/100;max=this._values.max+d*this.options.wheelSpeed*c/100;this.values(min,max)},destroy:function(){this.bar.detach();this.leftHandle.detach();this.rightHandle.detach();this.innerBar.detach();this.container.detach();this.leftArrow.detach();this.rightArrow.detach();this.element.removeClass("ui-rangeSlider")}})})(jQuery);