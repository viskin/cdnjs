//! Speech KITT
//! version : 0.2.0
//! author  : Tal Ater @TalAter
//! license : MIT
//! https://github.com/TalAter/SpeechKITT
(function(a){"use strict";var b,c,d,e,f,g,h=this,i=!1,j="Activate Voice Control",k="What can I help you with?",l=[],m=function(){g=document.createElement("div"),g.id="skitt-ui",g.innerHTML='<a id="skitt-toggle-button">&nbsp;</a><label for="skitt-toggle-button" id="skitt-toggle-button__label">'+j+'</label><div id="skitt-listening-box"><div id="skitt-listening-text"><span id="skitt-listening-text__instructions">'+k+"</span></div></div>",g.style.display="none",document.body.appendChild(g),o(),n(),document.getElementById("skitt-toggle-button").addEventListener("click",function(){h.SpeechKITT.toggleRecognition()})},n=function(){e&&g&&(f?f.href=e:(f=document.createElement("link"),f.rel="stylesheet",f.href=e,f.id="skitt-style-sheet",document.body.appendChild(f)))},o=function(){if(l.length&&g){var a=document.getElementById("skitt-listening-text__samples");if(!a){var b=document.getElementById("skitt-listening-text__instructions");a=document.createElement("span"),a.id="skitt-listening-text__samples",b.parentNode.insertBefore(a,b.nextSibling)}a.innerText=l.join(". ")+"."}},p=function(){g!==a&&(g.classList.remove("skitt-ui--not-listening"),g.classList.add("skitt-ui--listening"))},q=function(){g!==a&&(g.classList.add("skitt-ui--not-listening"),g.classList.remove("skitt-ui--listening"))},r=function(){i||(i=!0,p())},s=function(){i&&(i=!1,q())},t=function(a,b){g&&(document.getElementById(b).innerText=a)};h.SpeechKITT={setStartCommand:function(a,b){if(a=h[a]||a,"function"!=typeof a)throw new TypeError("invalid callback function");b=b||this,c={callback:a,context:b}},setAbortCommand:function(a,b){if(a=h[a]||a,"function"!=typeof a)throw new TypeError("invalid callback function");b=b||this,d={callback:a,context:b}},startRecognition:function(){if(!c)throw new TypeError("cannot start recognition. Start command not defined");c.callback.apply(c.context),r()},abortRecognition:function(){if(!d)throw new TypeError("cannot abort recognition. Abort command not defined");d.callback.apply(d.context),s()},toggleRecognition:function(){i?this.abortRecognition():this.startRecognition()},onStart:function(){h.clearTimeout(b),r()},onEnd:function(){b=setTimeout(s,100)},setStylesheet:function(a){e=a,n()},render:function(){g===a&&m(),this.isListening()?p():q()},vroom:function(){this.render()},hide:function(){if(g===a)throw new TypeError("cannot hide interface. Must be rendered first");g.classList.add("skitt-ui--hidden")},show:function(){if(g===a)throw new TypeError("cannot show interface. Must be rendered first");g.classList.remove("skitt-ui--hidden")},isListening:function(){return i},setToggleLabelText:function(a){j=a,t(a,"skitt-toggle-button__label")},setInstructionsText:function(a){k=a,t(a,"skitt-listening-text__instructions")},setSampleCommands:function(a){l=a,o()},annyang:function(){this.setStartCommand(annyang.start),this.setAbortCommand(annyang.abort),annyang.addCallback("start",this.onStart),annyang.addCallback("end",this.onEnd)}}}).call(this);