/*!
  hey, [be]Lazy.js - v1.3.0 - 2015.01.23
  A lazy loading and multi-serving image script
  (c) Bjoern Klinggaard - @bklinggaard - http://dinbror.dk/blazy
*/
  (function(e){"function"===typeof define&&define.amd?define(e):window.Blazy=e()})(function(){function e(b){if(!document.querySelectorAll){var g=document.createStyleSheet();document.querySelectorAll=function(b,a,e,d,f){f=document.all;a=[];b=b.replace(/\[for\b/gi,"[htmlFor").split(",");for(e=b.length;e--;){g.addRule(b[e],"k:v");for(d=f.length;d--;)f[d].currentStyle.k&&a.push(f[d]);g.removeRule(0)}return a}}l=!0;h=[];d={};a=b||{};a.error=a.error||!1;a.offset=a.offset||100;a.success=a.success||!1;a.selector=a.selector||".b-lazy";a.separator=a.separator||"|";a.container=a.container?document.querySelectorAll(a.container):!1;a.errorClass=a.errorClass||"b-error";a.breakpoints=a.breakpoints||!1;a.successClass=a.successClass||"b-loaded";a.src=q=a.src||"data-src";t=1<window.devicePixelRatio;d.top=0-a.offset;d.left=0-a.offset;f=u(v,25);r=u(w,50);w();m(a.breakpoints,function(b){if(b.width>=window.screen.width)return q=b.src,!1});x()}function x(){y(a.selector);l&&(l=!1,a.container&&m(a.container,function(b){n(b,"scroll",f)}),n(window,"resize",r),n(window,"resize",f),n(window,"scroll",f));v()}function v(){for(var b=0;b<k;b++){var g=h[b],c=g.getBoundingClientRect();if(c.right>=d.left&&c.bottom>=d.top&&c.left<=d.right&&c.top<=d.bottom||-1!==(" "+g.className+" ").indexOf(" "+a.successClass+" "))e.prototype.load(g),h.splice(b,1),k--,b--}0===k&&e.prototype.destroy()}function z(b,g){if(g||0<b.offsetWidth&&0<b.offsetHeight){var c=b.getAttribute(q)||b.getAttribute(a.src);if(c){var c=c.split(a.separator),d=c[t&&1<c.length?1:0],c=new Image;m(a.breakpoints,function(a){b.removeAttribute(a.src)});b.removeAttribute(a.src);c.onerror=function(){a.error&&a.error(b,"invalid");b.className=b.className+" "+a.errorClass};c.onload=function(){"img"===b.nodeName.toLowerCase()?b.src=d:b.style.backgroundImage='url("'+d+'")';b.className=b.className+" "+a.successClass;a.success&&a.success(b)};c.src=d}else a.error&&a.error(b,"missing"),b.className=b.className+" "+a.errorClass}}function y(b){b=document.querySelectorAll(b);for(var a=k=b.length;a--;h.unshift(b[a]));}function w(){d.bottom=(window.innerHeight||document.documentElement.clientHeight)+a.offset;d.right=(window.innerWidth||document.documentElement.clientWidth)+a.offset}function n(b,a,c){b.attachEvent?b.attachEvent&&b.attachEvent("on"+a,c):b.addEventListener(a,c,!1)}function p(b,a,c){b.detachEvent?b.detachEvent&&b.detachEvent("on"+a,c):b.removeEventListener(a,c,!1)}function m(a,d){if(a&&d)for(var c=a.length,e=0;e<c&&!1!==d(a[e],e);e++);}function u(a,d){var c=0;return function(){var e=+new Date;e-c<d||(c=e,a.apply(h,arguments))}}var q,a,d,h,k,t,l,f,r;e.prototype.revalidate=function(){x()};e.prototype.load=function(b,d){-1===(" "+b.className+" ").indexOf(" "+a.successClass+" ")&&z(b,d)};e.prototype.destroy=function(){a.container&&m(a.container,function(a){p(a,"scroll",f)});p(window,"scroll",f);p(window,"resize",f);p(window,"resize",r);k=0;h.length=0;l=!0};return e});