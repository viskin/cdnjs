(function(a){if(typeof define==="function"&&define.amd){define(["load-image","load-image-meta"],a)}else{a(window.loadImage)}}(function(a){a.ExifMap=function(){return this};a.ExifMap.prototype.map={Orientation:274};a.ExifMap.prototype.get=function(b){return this[b]||this[this.map[b]]};a.getExifThumbnail=function(h,g,f){var e,d,c;if(!f||g+f>h.byteLength){console.log("Invalid Exif data: Invalid thumbnail data.");return}e=[];for(d=0;d<f;d+=1){c=h.getUint8(g+d);e.push((c<16?"0":"")+c.toString(16))}return"data:image/jpeg,%"+e.join("%")};a.exifTagTypes={1:{getValue:function(c,b){return c.getUint8(b)},size:1},2:{getValue:function(c,b){return String.fromCharCode(c.getUint8(b))},size:1,ascii:true},3:{getValue:function(d,b,c){return d.getUint16(b,c)},size:2},4:{getValue:function(d,b,c){return d.getUint32(b,c)},size:4},5:{getValue:function(d,b,c){return d.getUint32(b,c)/d.getUint32(b+4,c)},size:8},9:{getValue:function(d,b,c){return d.getInt32(b,c)},size:4},10:{getValue:function(d,b,c){return d.getInt32(b,c)/d.getInt32(b+4,c)},size:8}};a.exifTagTypes[7]=a.exifTagTypes[1];a.getExifValue=function(n,m,g,l,e,b){var o=a.exifTagTypes[l],d,f,p,h,k,j;if(!o){console.log("Invalid Exif data: Invalid tag type.");return}d=o.size*e;f=d>4?m+n.getUint32(g+8,b):(g+8);if(f+d>n.byteLength){console.log("Invalid Exif data: Invalid data offset.");return}if(e===1){return o.getValue(n,f,b)}p=[];for(h=0;h<e;h+=1){p[h]=o.getValue(n,f+h*o.size,b)}if(o.ascii){k="";for(h=0;h<p.length;h+=1){j=p[h];if(j==="\u0000"){break}k+=j}return k}return p};a.parseExifTag=function(g,c,f,e,d){var b=g.getUint16(f,e);d.exif[b]=a.getExifValue(g,c,f,g.getUint16(f+2,e),g.getUint32(f+4,e),e)};a.parseExifTags=function(h,e,c,g,f){var j,b,d;if(c+6>h.byteLength){console.log("Invalid Exif data: Invalid directory offset.");return}j=h.getUint16(c,g);b=c+2+12*j;if(b+4>h.byteLength){console.log("Invalid Exif data: Invalid directory size.");return}for(d=0;d<j;d+=1){this.parseExifTag(h,e,c+2+12*d,g,f)}return h.getUint32(b,g)};a.parseExifData=function(h,e,c,f,j){if(j.disableExif){return}var g=e+10,b,i,d;if(h.getUint32(e+4)!==1165519206){return}if(g+8>h.byteLength){console.log("Invalid Exif data: Invalid segment size.");return}if(h.getUint16(e+8)!==0){console.log("Invalid Exif data: Missing byte alignment offset.");return}switch(h.getUint16(g)){case 18761:b=true;break;case 19789:b=false;break;default:console.log("Invalid Exif data: Invalid byte alignment marker.");return}if(h.getUint16(g+2,b)!==42){console.log("Invalid Exif data: Missing TIFF marker.");return}i=h.getUint32(g+4,b);f.exif=new a.ExifMap();i=a.parseExifTags(h,g,g+i,b,f);if(i&&!j.disableExifThumbnail){d={exif:{}};i=a.parseExifTags(h,g,g+i,b,d);if(d.exif[513]){f.exif.Thumbnail=a.getExifThumbnail(h,g+d.exif[513],d.exif[514])}}if(f.exif[34665]&&!j.disableExifSub){a.parseExifTags(h,g,g+f.exif[34665],b,f)}if(f.exif[34853]&&!j.disableExifGps){a.parseExifTags(h,g,g+f.exif[34853],b,f)}};a.metaDataParsers.jpeg[65505].push(a.parseExifData)}));