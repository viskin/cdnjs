(function(root,$){if(typeof $==="undefined"){throw new Error("jQuery is not loaded.")}var Utils={};Utils.flattenObject=function(obj){var result={};for(var key in obj){if(!obj.hasOwnProperty(key))continue;if(typeof obj[key]==="object"&&obj[key].constructor===Object){var flat=Utils.flattenObject(obj[key]);for(var x in flat){if(!flat.hasOwnProperty(x)){continue}result[key+"."+x]=flat[x]}}else{result[key]=obj[key]}}return result};Utils.unflattenObject=function(flat){var result={};var parentObj=result;var keys=Object.keys(flat);for(var i=0;i<keys.length;++i){var key=keys[i];var subkeys=key.split(".");var last=subkeys.pop();for(var ii=0;ii<subkeys.length;++ii){var subkey=subkeys[ii];parentObj[subkey]=typeof parentObj[subkey]==="undefined"?{}:parentObj[subkey];parentObj=parentObj[subkey]}parentObj[last]=flat[key];parentObj=result}return result};var Converters={string:function(value){return String(value)},number:function(value){return Number(value)},"boolean":function(value){return value===true||value==="true"||value==="on"||typeof value=="number"&&value>0||value==="1"},json:function(value){if(!value){return null}return JSON.parse(value)}};$.fn.serializer=function(){var $self=this;if($self.length>1){$self.each(function(){$(this).serializer()});return $self}var handlers={serialize:function(e){var $form=$(this);var serializedForm={};$form.find("[data-field]").each(function(){var $element=$(this);var how=$element.attr("data-value")||"val";var params=$element.attr("data-params");var field=$element.attr("data-field");var convertTo=$element.attr("data-convert-to");var deleteIfValue=$element.attr("data-delete-if");var howArguments=params?[params]:[];var value=$element[how].apply($element,howArguments);if(convertTo&&Converters[convertTo]){value=Converters[convertTo](value);deleteIfValue=Converters[convertTo](deleteIfValue)}if(value===deleteIfValue){return}serializedForm[field]=value});serializedForm=Utils.unflattenObject(serializedForm);$(this).trigger("serializer:data",[serializedForm])},fill:function(e,data){var flattenForm=Utils.flattenObject(data);var fields=Object.keys(flattenForm);fields.forEach(function(c){var $field=$("[data-field='"+c+"']",e.target);var dataParams=$field.attr("data-params");var dataValue=$field.attr("data-value");var args=dataParams?[dataParams]:[];args.push(flattenForm[c]);dataValue=dataValue||"val";$field[dataValue].apply($field,args)});return}};$self.on("serializer:submit",function(e){handlers.serialize.apply(e.target,arguments)});$self.on("serializer:fill",function(e){handlers.fill.apply(e.target,arguments)});function submit(e){$(this).trigger("serializer:submit",[e]);e.preventDefault();return false}$self.on("submit","form",submit);$self.on("submit",submit);return $self};$.fn.serializer.version="1.1.0"})(this,this.$||this.jQuery);