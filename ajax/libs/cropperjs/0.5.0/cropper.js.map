{"version":3,"sources":["intro.js","variables.js","utilities.js","cropper.js","load.js","build.js","render.js","preview.js","bind.js","handlers.js","change.js","methods.js","prototype.js","defaults.js","template.js","statics.js","outro.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACniBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzgBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC7CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtwBA;AACA;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"cropper.js","sourcesContent":["/*!\r\n * Cropper v@VERSION\r\n * https://github.com/fengyuanchen/cropperjs\r\n *\r\n * Copyright (c) @YEAR Fengyuan Chen\r\n * Released under the MIT license\r\n *\r\n * Date: @DATE\r\n */\r\n\r\n(function (global, factory) {\r\n  if (typeof module === 'object' && typeof module.exports === 'object') {\r\n    module.exports = global.document ? factory(global, true) : function (w) {\r\n      if (!w.document) {\r\n        throw new Error('Cropper requires a window with a document');\r\n      }\r\n\r\n      return factory(w);\r\n    };\r\n  } else {\r\n    factory(global);\r\n  }\r\n})(typeof window !== 'undefined' ? window : this, function (window, noGlobal) {\r\n\r\n  'use strict';\r\n","  // Globals\r\n  var document = window.document;\r\n  var location = window.location;\r\n  var ArrayBuffer = window.ArrayBuffer;\r\n  var Uint8Array = window.Uint8Array;\r\n  var DataView = window.DataView;\r\n  var btoa = window.btoa;\r\n\r\n  // Constants\r\n  var NAMESPACE = 'cropper';\r\n\r\n  // Classes\r\n  var CLASS_MODAL = 'cropper-modal';\r\n  var CLASS_HIDE = 'cropper-hide';\r\n  var CLASS_HIDDEN = 'cropper-hidden';\r\n  var CLASS_INVISIBLE = 'cropper-invisible';\r\n  var CLASS_MOVE = 'cropper-move';\r\n  var CLASS_CROP = 'cropper-crop';\r\n  var CLASS_DISABLED = 'cropper-disabled';\r\n  var CLASS_BG = 'cropper-bg';\r\n\r\n  // Events\r\n  var EVENT_MOUSE_DOWN = 'mousedown touchstart pointerdown MSPointerDown';\r\n  var EVENT_MOUSE_MOVE = 'mousemove touchmove pointermove MSPointerMove';\r\n  var EVENT_MOUSE_UP = 'mouseup touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel';\r\n  var EVENT_WHEEL = 'wheel mousewheel DOMMouseScroll';\r\n  var EVENT_DBLCLICK = 'dblclick';\r\n  var EVENT_RESIZE = 'resize';\r\n  var EVENT_ERROR = 'error';\r\n  var EVENT_LOAD = 'load';\r\n\r\n  // RegExps\r\n  var REGEXP_ACTIONS = /^(e|w|s|n|se|sw|ne|nw|all|crop|move|zoom)$/;\r\n  var REGEXP_SPACES = /\\s+/;\r\n  var REGEXP_TRIM = /^\\s+(.*)\\s+^/;\r\n\r\n  // Data\r\n  var DATA_PREVIEW = 'preview';\r\n  var DATA_ACTION = 'action';\r\n\r\n  // Actions\r\n  var ACTION_EAST = 'e';\r\n  var ACTION_WEST = 'w';\r\n  var ACTION_SOUTH = 's';\r\n  var ACTION_NORTH = 'n';\r\n  var ACTION_SOUTH_EAST = 'se';\r\n  var ACTION_SOUTH_WEST = 'sw';\r\n  var ACTION_NORTH_EAST = 'ne';\r\n  var ACTION_NORTH_WEST = 'nw';\r\n  var ACTION_ALL = 'all';\r\n  var ACTION_CROP = 'crop';\r\n  var ACTION_MOVE = 'move';\r\n  var ACTION_ZOOM = 'zoom';\r\n  var ACTION_NONE = 'none';\r\n\r\n  // Supports\r\n  var SUPPORT_CANVAS = !!document.createElement('canvas').getContext;\r\n\r\n  // Maths\r\n  var num = Number;\r\n  var min = Math.min;\r\n  var max = Math.max;\r\n  var abs = Math.abs;\r\n  var sin = Math.sin;\r\n  var cos = Math.cos;\r\n  var sqrt = Math.sqrt;\r\n  var round = Math.round;\r\n  var floor = Math.floor;\r\n\r\n  // Prototype\r\n  var prototype = {\r\n    version: '@VERSION'\r\n  };\r\n\r\n  // Utilities\r\n  var EMPTY_OBJECT = {};\r\n  var toString = EMPTY_OBJECT.toString;\r\n  var hasOwnProperty = EMPTY_OBJECT.hasOwnProperty;\r\n  var fromCharCode = String.fromCharCode;\r\n","  function typeOf(obj) {\r\n    return toString.call(obj).slice(8, -1).toLowerCase();\r\n  }\r\n\r\n  function isString(str) {\r\n    return typeof str === 'string';\r\n  }\r\n\r\n  function isNumber(num) {\r\n    return typeof num === 'number' && !isNaN(num);\r\n  }\r\n\r\n  function isUndefined(obj) {\r\n    return typeof obj === 'undefined';\r\n  }\r\n\r\n  function isObject(obj) {\r\n    return typeof obj === 'object' && obj !== null;\r\n  }\r\n\r\n  function isPlainObject(obj) {\r\n    var constructor;\r\n    var prototype;\r\n\r\n    if (!isObject(obj)) {\r\n      return false;\r\n    }\r\n\r\n    try {\r\n      constructor = obj.constructor;\r\n      prototype = constructor.prototype;\r\n\r\n      return constructor && prototype && hasOwnProperty.call(prototype, 'isPrototypeOf');\r\n    } catch (e) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  function isFunction(fn) {\r\n    return typeOf(fn) === 'function';\r\n  }\r\n\r\n  function isArray(arr) {\r\n    return Array.isArray ? Array.isArray(arr) : typeOf(arr) === 'array';\r\n  }\r\n\r\n  function toArray(obj, offset) {\r\n    var args = [];\r\n\r\n    // This is necessary for IE8\r\n    if (isNumber(offset)) {\r\n      args.push(offset);\r\n    }\r\n\r\n    return args.slice.apply(obj, args);\r\n  }\r\n\r\n  function inArray(value, arr) {\r\n    var index = -1;\r\n\r\n    each(arr, function (n, i) {\r\n      if (n === value) {\r\n        index = i;\r\n        return false;\r\n      }\r\n    });\r\n\r\n    return index;\r\n  }\r\n\r\n  function trim(str) {\r\n    if (!isString(str)) {\r\n      str = String(str);\r\n    }\r\n\r\n    if (str.trim) {\r\n      str = str.trim();\r\n    } else {\r\n      str = str.replace(REGEXP_TRIM, '$1');\r\n    }\r\n\r\n    return str;\r\n  }\r\n\r\n  function each(obj, callback) {\r\n    var length;\r\n    var i;\r\n\r\n    if (obj && isFunction(callback)) {\r\n      if (isArray(obj) || isNumber(obj.length)/* array-like */) {\r\n        for (i = 0, length = obj.length; i < length; i++) {\r\n          if (callback.call(obj, obj[i], i, obj) === false) {\r\n            break;\r\n          }\r\n        }\r\n      } else if (isObject(obj)) {\r\n        for (i in obj) {\r\n          if (hasOwnProperty.call(obj, i)) {\r\n            if (callback.call(obj, obj[i], i, obj) === false) {\r\n              break;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    return obj;\r\n  }\r\n\r\n  function extend(obj) {\r\n    var args = toArray(arguments);\r\n\r\n    if (args.length > 1) {\r\n      args.shift();\r\n    }\r\n\r\n    each(args, function (arg) {\r\n      each(arg, function (prop, i) {\r\n        obj[i] = prop;\r\n      });\r\n    });\r\n\r\n    return obj;\r\n  }\r\n\r\n  function proxy(fn, context) {\r\n    var args = toArray(arguments, 2);\r\n\r\n    return function () {\r\n      return fn.apply(context, args.concat(toArray(arguments)));\r\n    };\r\n  }\r\n\r\n  function parseClass(className) {\r\n    return trim(className).split(REGEXP_SPACES);\r\n  }\r\n\r\n  function hasClass(element, value) {\r\n    return element.className.indexOf(value) > -1;\r\n  }\r\n\r\n  function addClass(element, value) {\r\n    var classes;\r\n\r\n    if (isNumber(element.length)) {\r\n      return each(element, function (elem) {\r\n        addClass(elem, value);\r\n      });\r\n    }\r\n\r\n    classes = parseClass(element.className);\r\n\r\n    each(parseClass(value), function (n) {\r\n      if (inArray(n, classes) < 0) {\r\n        classes.push(n);\r\n      }\r\n    });\r\n\r\n    element.className = classes.join(' ');\r\n  }\r\n\r\n  function removeClass(element, value) {\r\n    var classes;\r\n\r\n    if (isNumber(element.length)) {\r\n      return each(element, function (elem) {\r\n        removeClass(elem, value);\r\n      });\r\n    }\r\n\r\n    classes = parseClass(element.className);\r\n\r\n    each(parseClass(value), function (n, i) {\r\n      if ((i = inArray(n, classes)) > -1) {\r\n        classes.splice(i, 1);\r\n      }\r\n    });\r\n\r\n    element.className = classes.join(' ');\r\n  }\r\n\r\n  function toggleClass(element, value, added) {\r\n    return added ? addClass(element, value) : removeClass(element, value);\r\n  }\r\n\r\n  function getData(element, name) {\r\n    if (isObject(element[name])) {\r\n      return element[name];\r\n    } else if (element.dataset) {\r\n      return element.dataset[name];\r\n    } else {\r\n      return element.getAttribute('data-' + name);\r\n    }\r\n  }\r\n\r\n  function setData(element, name, data) {\r\n    if (isObject(data) && isUndefined(element[name])) {\r\n      element[name] = data;\r\n    } else if (element.dataset) {\r\n      element.dataset[name] = data;\r\n    } else {\r\n      element.setAttribute('data-' + name, data);\r\n    }\r\n  }\r\n\r\n  function removeData(element, name) {\r\n    if (isObject(element[name])) {\r\n      delete element[name];\r\n    } else if (element.dataset) {\r\n      delete element.dataset[name];\r\n    } else {\r\n      element.removeAttribute('data-' + name);\r\n    }\r\n  }\r\n\r\n  function addListener(element, type, handler) {\r\n    var types;\r\n\r\n    if (!isFunction(handler)) {\r\n      return;\r\n    }\r\n\r\n    types = trim(type).split(REGEXP_SPACES);\r\n\r\n    if (types.length > 1) {\r\n      return each(types, function (type) {\r\n        addListener(element, type, handler);\r\n      });\r\n    }\r\n\r\n    if (element.addEventListener) {\r\n      element.addEventListener(type, handler, false);\r\n    } else if (element.attachEvent) {\r\n      element.attachEvent('on' + type, handler);\r\n    }\r\n  }\r\n\r\n  function removeListener(element, type, handler) {\r\n    var types;\r\n\r\n    if (!isFunction(handler)) {\r\n      return;\r\n    }\r\n\r\n    types = trim(type).split(REGEXP_SPACES);\r\n\r\n    if (types.length > 1) {\r\n      return each(types, function (type) {\r\n        removeListener(element, type, handler);\r\n      });\r\n    }\r\n\r\n    if (element.removeEventListener) {\r\n      element.removeEventListener(type, handler, false);\r\n    } else if (element.detachEvent) {\r\n      element.detachEvent('on' + type, handler);\r\n    }\r\n  }\r\n\r\n  function preventDefault(e) {\r\n    if (e) {\r\n      if (e.preventDefault) {\r\n        e.preventDefault();\r\n      } else {\r\n        e.returnValue = false;\r\n      }\r\n    }\r\n  }\r\n\r\n  function getEvent(event) {\r\n    var e = event || window.event;\r\n    var doc;\r\n\r\n    // Fix target property (IE8)\r\n    if (!e.target) {\r\n      e.target = e.srcElement || document;\r\n    }\r\n\r\n    if (!isNumber(e.pageX)) {\r\n      doc = document.documentElement;\r\n      e.pageX = e.clientX + (window.scrollX || doc && doc.scrollLeft || 0) - (doc && doc.clientLeft || 0);\r\n      e.pageY = e.clientY + (window.scrollY || doc && doc.scrollTop || 0) - (doc && doc.clientTop || 0);\r\n    }\r\n\r\n    return e;\r\n  }\r\n\r\n  function getOffset(element) {\r\n    var doc = document.documentElement;\r\n    var box = element.getBoundingClientRect();\r\n\r\n    return {\r\n      left: box.left + (window.scrollX || doc && doc.scrollLeft || 0) - (doc && doc.clientLeft || 0),\r\n      top: box.top  + (window.scrollY || doc && doc.scrollTop || 0)  - (doc && doc.clientTop  || 0)\r\n    };\r\n  }\r\n\r\n  function querySelector(element, selector) {\r\n    return element.querySelector(selector);\r\n  }\r\n\r\n  function querySelectorAll(element, selector) {\r\n    return element.querySelectorAll(selector);\r\n  }\r\n\r\n  function insertBefore(element, elem) {\r\n    element.parentNode.insertBefore(elem, element);\r\n  }\r\n\r\n  function appendChild(element, elem) {\r\n    element.appendChild(elem);\r\n  }\r\n\r\n  function removeChild(element) {\r\n    element.parentNode.removeChild(element);\r\n  }\r\n\r\n  function empty(element) {\r\n    while (element.firstChild) {\r\n      element.removeChild(element.firstChild);\r\n    }\r\n  }\r\n\r\n  function isCrossOriginURL(url) {\r\n    var parts = url.match(/^(https?:)\\/\\/([^\\:\\/\\?#]+):?(\\d*)/i);\r\n\r\n    return parts && (\r\n      parts[1] !== location.protocol ||\r\n      parts[2] !== location.hostname ||\r\n      parts[3] !== location.port\r\n    );\r\n  }\r\n\r\n  function addTimestamp(url) {\r\n    var timestamp = 'timestamp=' + (new Date()).getTime();\r\n\r\n    return (url + (url.indexOf('?') === -1 ? '?' : '&') + timestamp);\r\n  }\r\n\r\n  function getImageSize(image, callback) {\r\n    var newImage;\r\n\r\n    // Modern browsers\r\n    if (image.naturalWidth) {\r\n      return callback(image.naturalWidth, image.naturalHeight);\r\n    }\r\n\r\n    // IE8: Don't use `new Image()` here\r\n    newImage = document.createElement('img');\r\n\r\n    newImage.onload = function () {\r\n      callback(this.width, this.height);\r\n    };\r\n\r\n    newImage.src = image.src;\r\n  }\r\n\r\n  function getTransform(options) {\r\n    var transforms = [];\r\n    var rotate = options.rotate;\r\n    var scaleX = options.scaleX;\r\n    var scaleY = options.scaleY;\r\n\r\n    if (isNumber(rotate)) {\r\n      transforms.push('rotate(' + rotate + 'deg)');\r\n    }\r\n\r\n    if (isNumber(scaleX) && isNumber(scaleY)) {\r\n      transforms.push('scale(' + scaleX + ',' + scaleY + ')');\r\n    }\r\n\r\n    return transforms.length ? transforms.join(' ') : 'none';\r\n  }\r\n\r\n  function getRotatedSizes(data, isReversed) {\r\n    var deg = abs(data.degree) % 180;\r\n    var arc = (deg > 90 ? (180 - deg) : deg) * Math.PI / 180;\r\n    var sinArc = sin(arc);\r\n    var cosArc = cos(arc);\r\n    var width = data.width;\r\n    var height = data.height;\r\n    var aspectRatio = data.aspectRatio;\r\n    var newWidth;\r\n    var newHeight;\r\n\r\n    if (!isReversed) {\r\n      newWidth = width * cosArc + height * sinArc;\r\n      newHeight = width * sinArc + height * cosArc;\r\n    } else {\r\n      newWidth = width / (cosArc + sinArc / aspectRatio);\r\n      newHeight = newWidth / aspectRatio;\r\n    }\r\n\r\n    return {\r\n      width: newWidth,\r\n      height: newHeight\r\n    };\r\n  }\r\n\r\n  function getSourceCanvas(image, data) {\r\n    var canvas = document.createElement('canvas');\r\n    var context = canvas.getContext('2d');\r\n    var x = 0;\r\n    var y = 0;\r\n    var width = data.naturalWidth;\r\n    var height = data.naturalHeight;\r\n    var rotate = data.rotate;\r\n    var scaleX = data.scaleX;\r\n    var scaleY = data.scaleY;\r\n    var scalable = isNumber(scaleX) && isNumber(scaleY) && (scaleX !== 1 || scaleY !== 1);\r\n    var rotatable = isNumber(rotate) && rotate !== 0;\r\n    var advanced = rotatable || scalable;\r\n    var canvasWidth = width;\r\n    var canvasHeight = height;\r\n    var translateX;\r\n    var translateY;\r\n    var rotated;\r\n\r\n    if (scalable) {\r\n      translateX = width / 2;\r\n      translateY = height / 2;\r\n    }\r\n\r\n    if (rotatable) {\r\n      rotated = getRotatedSizes({\r\n        width: width,\r\n        height: height,\r\n        degree: rotate\r\n      });\r\n\r\n      canvasWidth = rotated.width;\r\n      canvasHeight = rotated.height;\r\n      translateX = rotated.width / 2;\r\n      translateY = rotated.height / 2;\r\n    }\r\n\r\n    canvas.width = canvasWidth;\r\n    canvas.height = canvasHeight;\r\n\r\n    if (advanced) {\r\n      x = -width / 2;\r\n      y = -height / 2;\r\n\r\n      context.save();\r\n      context.translate(translateX, translateY);\r\n    }\r\n\r\n    if (rotatable) {\r\n      context.rotate(rotate * Math.PI / 180);\r\n    }\r\n\r\n    // Should call `scale` after rotated\r\n    if (scalable) {\r\n      context.scale(scaleX, scaleY);\r\n    }\r\n\r\n    context.drawImage(image, floor(x), floor(y), floor(width), floor(height));\r\n\r\n    if (advanced) {\r\n      context.restore();\r\n    }\r\n\r\n    return canvas;\r\n  }\r\n\r\n  function getStringFromCharCode(dataView, start, length) {\r\n    var str = '';\r\n    var i;\r\n\r\n    for (i = start, length += start; i < length; i++) {\r\n      str += fromCharCode(dataView.getUint8(i));\r\n    }\r\n\r\n    return str;\r\n  }\r\n\r\n  function getOrientation(arrayBuffer) {\r\n    var dataView = new DataView(arrayBuffer);\r\n    var length = dataView.byteLength;\r\n    var orientation;\r\n    var exifIDCode;\r\n    var tiffOffset;\r\n    var firstIFDOffset;\r\n    var littleEndian;\r\n    var endianness;\r\n    var app1Start;\r\n    var ifdStart;\r\n    var offset;\r\n    var i;\r\n\r\n    // Only handle JPEG image (start by 0xFFD8)\r\n    if (dataView.getUint8(0) === 0xFF && dataView.getUint8(1) === 0xD8) {\r\n      offset = 2;\r\n\r\n      while (offset < length) {\r\n        if (dataView.getUint8(offset) === 0xFF && dataView.getUint8(offset + 1) === 0xE1) {\r\n          app1Start = offset;\r\n          break;\r\n        }\r\n\r\n        offset++;\r\n      }\r\n    }\r\n\r\n    if (app1Start) {\r\n      exifIDCode = app1Start + 4;\r\n      tiffOffset = app1Start + 10;\r\n\r\n      if (getStringFromCharCode(dataView, exifIDCode, 4) === 'Exif') {\r\n        endianness = dataView.getUint16(tiffOffset);\r\n        littleEndian = endianness === 0x4949;\r\n\r\n        if (littleEndian || endianness === 0x4D4D /* bigEndian */) {\r\n          if (dataView.getUint16(tiffOffset + 2, littleEndian) === 0x002A) {\r\n            firstIFDOffset = dataView.getUint32(tiffOffset + 4, littleEndian);\r\n\r\n            if (firstIFDOffset >= 0x00000008) {\r\n              ifdStart = tiffOffset + firstIFDOffset;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    if (ifdStart) {\r\n      length = dataView.getUint16(ifdStart, littleEndian);\r\n\r\n      for (i = 0; i < length; i++) {\r\n        offset = ifdStart + i * 12 + 2;\r\n\r\n        if (dataView.getUint16(offset, littleEndian) === 0x0112 /* Orientation */) {\r\n\r\n          // 8 is the offset of the current tag's value\r\n          offset += 8;\r\n\r\n          // Get the original orientation value\r\n          orientation = dataView.getUint16(offset, littleEndian);\r\n\r\n          // Override the orientation with the default value: 1\r\n          dataView.setUint16(offset, 1, littleEndian);\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    return orientation;\r\n  }\r\n","  function Cropper(element, options) {\r\n    this.element = element;\r\n    this.options = extend({}, Cropper.DEFAULTS, isPlainObject(options) && options);\r\n    this.isLoaded = false;\r\n    this.isBuilt = false;\r\n    this.isCompleted = false;\r\n    this.isRotated = false;\r\n    this.isCropped = false;\r\n    this.isDisabled = false;\r\n    this.isReplaced = false;\r\n    this.isLimited = false;\r\n    this.isImg = false;\r\n    this.originalUrl = '';\r\n    this.canvasData = null;\r\n    this.cropBoxData = null;\r\n    this.previews = null;\r\n    this.init();\r\n  }\r\n","  extend(prototype, {\r\n    init: function () {\r\n      var element = this.element;\r\n      var tagName = element.tagName.toLowerCase();\r\n      var url;\r\n\r\n      if (getData(element, NAMESPACE)) {\r\n        return;\r\n      }\r\n\r\n      setData(element, NAMESPACE, this);\r\n\r\n      if (tagName === 'img') {\r\n        this.isImg = true;\r\n\r\n        // e.g.: \"img/picture.jpg\"\r\n        this.originalUrl = url = element.getAttribute('src');\r\n\r\n        // Stop when it's a blank image\r\n        if (!url) {\r\n          return;\r\n        }\r\n\r\n        // e.g.: \"http://example.com/img/picture.jpg\"\r\n        url = element.src;\r\n      } else if (tagName === 'canvas' && SUPPORT_CANVAS) {\r\n        url = element.toDataURL();\r\n      }\r\n\r\n      this.load(url);\r\n    },\r\n\r\n    load: function (url) {\r\n      var read;\r\n      var xhr;\r\n\r\n      if (!url) {\r\n        return;\r\n      }\r\n\r\n      this.url = url;\r\n      this.imageData = {};\r\n\r\n      if (!this.options.checkOrientation || !ArrayBuffer) {\r\n        return this.clone();\r\n      }\r\n\r\n      read = proxy(this.read, this);\r\n      xhr = new XMLHttpRequest();\r\n\r\n      xhr.onload = function () {\r\n        read(this.response);\r\n      };\r\n\r\n      xhr.open('get', url);\r\n      xhr.responseType = 'arraybuffer';\r\n      xhr.send();\r\n    },\r\n\r\n    read: function (arrayBuffer) {\r\n      var options = this.options;\r\n      var orientation = getOrientation(arrayBuffer);\r\n      var imageData = {};\r\n      var base64 = '';\r\n      var rotate;\r\n      var scaleX;\r\n      var scaleY;\r\n\r\n      if (orientation) {\r\n        each(new Uint8Array(arrayBuffer), function (code) {\r\n          base64 += fromCharCode(code);\r\n        });\r\n\r\n        this.url = 'data:image/jpeg;base64,' + btoa(base64);\r\n\r\n        switch (orientation) {\r\n\r\n          // flip horizontal\r\n          case 2:\r\n            scaleX = -1;\r\n            break;\r\n\r\n          // rotate left 180°\r\n          case 3:\r\n            rotate = -180;\r\n            break;\r\n\r\n          // flip vertical\r\n          case 4:\r\n            scaleY = -1;\r\n            break;\r\n\r\n          // flip vertical + rotate right 90°\r\n          case 5:\r\n            rotate = 90;\r\n            scaleY = -1;\r\n            break;\r\n\r\n          // rotate right 90°\r\n          case 6:\r\n            rotate = 90;\r\n            break;\r\n\r\n          // flip horizontal + rotate right 90°\r\n          case 7:\r\n            rotate = 90;\r\n            scaleX = -1;\r\n            break;\r\n\r\n          // rotate left 90°\r\n          case 8:\r\n            rotate = -90;\r\n            break;\r\n        }\r\n      }\r\n\r\n      if (options.rotatable) {\r\n        imageData.rotate = rotate;\r\n      }\r\n\r\n      if (options.scalable) {\r\n        imageData.scaleX = scaleX;\r\n        imageData.scaleY = scaleY;\r\n      }\r\n\r\n      this.imageData = imageData;\r\n      this.clone();\r\n    },\r\n\r\n    clone: function () {\r\n      var options = this.options;\r\n      var element = this.element;\r\n      var url = this.url;\r\n      var crossOrigin;\r\n      var crossOriginUrl;\r\n      var image;\r\n      var start;\r\n      var stop;\r\n\r\n      if (isFunction(options.build) && options.build.call(element) === false) {\r\n        return;\r\n      }\r\n\r\n      if (options.checkCrossOrigin && isCrossOriginURL(url)) {\r\n        crossOrigin = element.crossOrigin;\r\n\r\n        if (!crossOrigin) {\r\n          crossOrigin = 'anonymous';\r\n\r\n          // Add a timestamp to url for busting browser cache\r\n          crossOriginUrl = addTimestamp(url);\r\n        }\r\n      }\r\n\r\n      this.crossOrigin = crossOrigin;\r\n      this.crossOriginUrl = crossOriginUrl;\r\n      image = document.createElement('img');\r\n\r\n      if (crossOrigin) {\r\n        image.crossOrigin = crossOrigin;\r\n      }\r\n\r\n      image.src = crossOriginUrl || url;\r\n      this.image = image;\r\n      this._start = start = proxy(this.start, this);\r\n      this._stop = stop = proxy(this.stop, this);\r\n\r\n      if (this.isImg) {\r\n        if (element.complete) {\r\n          this.start();\r\n        } else {\r\n          addListener(element, EVENT_LOAD, start);\r\n        }\r\n      } else {\r\n        addListener(image, EVENT_LOAD, start);\r\n        addListener(image, EVENT_ERROR, stop);\r\n        addClass(image, CLASS_HIDE);\r\n        insertBefore(element, image);\r\n      }\r\n    },\r\n\r\n    start: function (event) {\r\n      var image = this.isImg ? this.element : this.image;\r\n\r\n      if (event) {\r\n        removeListener(image, EVENT_LOAD, this._start);\r\n        removeListener(image, EVENT_ERROR, this._stop);\r\n      }\r\n\r\n      getImageSize(image, proxy(function (naturalWidth, naturalHeight) {\r\n        extend(this.imageData, {\r\n          naturalWidth: naturalWidth,\r\n          naturalHeight: naturalHeight,\r\n          aspectRatio: naturalWidth / naturalHeight\r\n        });\r\n\r\n        this.isLoaded = true;\r\n        this.build();\r\n      }, this));\r\n    },\r\n\r\n    stop: function () {\r\n      var image = this.image;\r\n\r\n      removeListener(image, EVENT_LOAD, this._start);\r\n      removeListener(image, EVENT_ERROR, this._stop);\r\n\r\n      removeChild(image);\r\n      this.image = null;\r\n    }\r\n  });\r\n","  extend(prototype, {\r\n    build: function () {\r\n      var options = this.options;\r\n      var element = this.element;\r\n      var image = this.image;\r\n      var template;\r\n      var cropper;\r\n      var canvas;\r\n      var dragBox;\r\n      var cropBox;\r\n      var face;\r\n\r\n      if (!this.isLoaded) {\r\n        return;\r\n      }\r\n\r\n      // Unbuild first when replace\r\n      if (this.isBuilt) {\r\n        this.unbuild();\r\n      }\r\n\r\n      template = document.createElement('div');\r\n      template.innerHTML = Cropper.TEMPLATE;\r\n\r\n      // Create cropper elements\r\n      this.container = element.parentNode;\r\n      this.cropper = cropper = querySelector(template, '.cropper-container');\r\n      this.canvas = canvas = querySelector(cropper, '.cropper-canvas');\r\n      this.dragBox = dragBox = querySelector(cropper, '.cropper-drag-box');\r\n      this.cropBox = cropBox = querySelector(cropper, '.cropper-crop-box');\r\n      this.viewBox = querySelector(cropper, '.cropper-view-box');\r\n      this.face = face = querySelector(cropBox, '.cropper-face');\r\n\r\n      appendChild(canvas, image);\r\n\r\n      // Hide the original image\r\n      addClass(element, CLASS_HIDDEN);\r\n      insertBefore(element, cropper);\r\n\r\n      // Show the image if is hidden\r\n      if (!this.isImg) {\r\n        removeClass(image, CLASS_HIDE);\r\n      }\r\n\r\n      this.initPreview();\r\n      this.bind();\r\n\r\n      options.aspectRatio = max(0, options.aspectRatio) || NaN;\r\n      options.viewMode = max(0, min(3, round(options.viewMode))) || 0;\r\n\r\n      if (options.autoCrop) {\r\n        this.isCropped = true;\r\n\r\n        if (options.modal) {\r\n          addClass(dragBox, CLASS_MODAL);\r\n        }\r\n      } else {\r\n        addClass(cropBox, CLASS_HIDDEN);\r\n      }\r\n\r\n      if (!options.guides) {\r\n        addClass(querySelectorAll(cropBox, '.cropper-dashed'), CLASS_HIDDEN);\r\n      }\r\n\r\n      if (!options.center) {\r\n        addClass(querySelector(cropBox, '.cropper-center'), CLASS_HIDDEN);\r\n      }\r\n\r\n      if (options.background) {\r\n        addClass(cropper, CLASS_BG);\r\n      }\r\n\r\n      if (!options.highlight) {\r\n        addClass(face, CLASS_INVISIBLE);\r\n      }\r\n\r\n      if (options.cropBoxMovable) {\r\n        addClass(face, CLASS_MOVE);\r\n        setData(face, DATA_ACTION, ACTION_ALL);\r\n      }\r\n\r\n      if (!options.cropBoxResizable) {\r\n        addClass(querySelectorAll(cropBox, '.cropper-line'), CLASS_HIDDEN);\r\n        addClass(querySelectorAll(cropBox, '.cropper-point'), CLASS_HIDDEN);\r\n      }\r\n\r\n      this.setDragMode(options.dragMode);\r\n      this.render();\r\n      this.isBuilt = true;\r\n      this.setData(options.data);\r\n\r\n      // Call the built asynchronously to keep \"image.cropper\" is defined\r\n      setTimeout(proxy(function () {\r\n        if (isFunction(options.built)) {\r\n          options.built.call(element);\r\n        }\r\n\r\n        if (isFunction(options.crop)) {\r\n          options.crop.call(element, this.getData());\r\n        }\r\n\r\n        this.isCompleted = true;\r\n      }, this), 0);\r\n    },\r\n\r\n    unbuild: function () {\r\n      if (!this.isBuilt) {\r\n        return;\r\n      }\r\n\r\n      this.isBuilt = false;\r\n      this.initialImageData = null;\r\n\r\n      // Clear `initialCanvasData` is necessary when replace\r\n      this.initialCanvasData = null;\r\n      this.initialCropBoxData = null;\r\n      this.containerData = null;\r\n      this.canvasData = null;\r\n\r\n      // Clear `cropBoxData` is necessary when replace\r\n      this.cropBoxData = null;\r\n      this.unbind();\r\n\r\n      this.resetPreview();\r\n      this.previews = null;\r\n\r\n      this.viewBox = null;\r\n      this.cropBox = null;\r\n      this.dragBox = null;\r\n      this.canvas = null;\r\n      this.container = null;\r\n\r\n      removeChild(this.cropper);\r\n      this.cropper = null;\r\n    }\r\n  });\r\n","  extend(prototype, {\r\n    render: function () {\r\n      this.initContainer();\r\n      this.initCanvas();\r\n      this.initCropBox();\r\n\r\n      this.renderCanvas();\r\n\r\n      if (this.isCropped) {\r\n        this.renderCropBox();\r\n      }\r\n    },\r\n\r\n    initContainer: function () {\r\n      var options = this.options;\r\n      var element = this.element;\r\n      var container = this.container;\r\n      var cropper = this.cropper;\r\n      var containerData;\r\n\r\n      addClass(cropper, CLASS_HIDDEN);\r\n      removeClass(element, CLASS_HIDDEN);\r\n\r\n      this.containerData = containerData = {\r\n        width: max(container.offsetWidth, num(options.minContainerWidth) || 200),\r\n        height: max(container.offsetHeight, num(options.minContainerHeight) || 100)\r\n      };\r\n\r\n      cropper.style.cssText = (\r\n        'width:' + containerData.width + 'px;' +\r\n        'height:' + containerData.height + 'px;'\r\n      );\r\n\r\n      addClass(element, CLASS_HIDDEN);\r\n      removeClass(cropper, CLASS_HIDDEN);\r\n    },\r\n\r\n    // Canvas (image wrapper)\r\n    initCanvas: function () {\r\n      var viewMode = this.options.viewMode;\r\n      var containerData = this.containerData;\r\n      var containerWidth = containerData.width;\r\n      var containerHeight = containerData.height;\r\n      var imageData = this.imageData;\r\n      var naturalWidth = imageData.naturalWidth;\r\n      var naturalHeight = imageData.naturalHeight;\r\n      var aspectRatio = imageData.aspectRatio;\r\n      var canvasWidth = containerWidth;\r\n      var canvasHeight = containerHeight;\r\n      var canvasData;\r\n      var rotatedData;\r\n\r\n      if (imageData.rotate) {\r\n        rotatedData = getRotatedSizes({\r\n          width: naturalWidth,\r\n          height: naturalHeight,\r\n          degree: imageData.rotate\r\n        });\r\n\r\n        naturalWidth = rotatedData.width;\r\n        naturalHeight = rotatedData.height;\r\n        aspectRatio = rotatedData.width / rotatedData.height;\r\n      }\r\n\r\n      if (containerHeight * aspectRatio > containerWidth) {\r\n        if (viewMode === 3) {\r\n          canvasWidth = containerHeight * aspectRatio;\r\n        } else {\r\n          canvasHeight = containerWidth / aspectRatio;\r\n        }\r\n      } else {\r\n        if (viewMode === 3) {\r\n          canvasHeight = containerWidth / aspectRatio;\r\n        } else {\r\n          canvasWidth = containerHeight * aspectRatio;\r\n        }\r\n      }\r\n\r\n      canvasData = {\r\n        naturalWidth: naturalWidth,\r\n        naturalHeight: naturalHeight,\r\n        aspectRatio: aspectRatio,\r\n        width: canvasWidth,\r\n        height: canvasHeight\r\n      };\r\n\r\n      canvasData.oldLeft = canvasData.left = (containerWidth - canvasWidth) / 2;\r\n      canvasData.oldTop = canvasData.top = (containerHeight - canvasHeight) / 2;\r\n\r\n      this.canvasData = canvasData;\r\n      this.isLimited = (viewMode === 1 || viewMode === 2);\r\n      this.limitCanvas(true, true);\r\n      this.initialImageData = extend({}, imageData);\r\n      this.initialCanvasData = extend({}, canvasData);\r\n    },\r\n\r\n    limitCanvas: function (isSizeLimited, isPositionLimited) {\r\n      var options = this.options;\r\n      var viewMode = options.viewMode;\r\n      var containerData = this.containerData;\r\n      var containerWidth = containerData.width;\r\n      var containerHeight = containerData.height;\r\n      var canvasData = this.canvasData;\r\n      var aspectRatio = canvasData.aspectRatio;\r\n      var cropBoxData = this.cropBoxData;\r\n      var isCropped = this.isCropped && cropBoxData;\r\n      var minCanvasWidth;\r\n      var minCanvasHeight;\r\n      var newCanvasLeft;\r\n      var newCanvasTop;\r\n\r\n      if (isSizeLimited) {\r\n        minCanvasWidth = num(options.minCanvasWidth) || 0;\r\n        minCanvasHeight = num(options.minCanvasHeight) || 0;\r\n\r\n        if (viewMode) {\r\n          if (viewMode > 1) {\r\n            minCanvasWidth = max(minCanvasWidth, containerWidth);\r\n            minCanvasHeight = max(minCanvasHeight, containerHeight);\r\n\r\n            if (viewMode === 3) {\r\n              if (minCanvasHeight * aspectRatio > minCanvasWidth) {\r\n                minCanvasWidth = minCanvasHeight * aspectRatio;\r\n              } else {\r\n                minCanvasHeight = minCanvasWidth / aspectRatio;\r\n              }\r\n            }\r\n          } else {\r\n            if (minCanvasWidth) {\r\n              minCanvasWidth = max(minCanvasWidth, isCropped ? cropBoxData.width : 0);\r\n            } else if (minCanvasHeight) {\r\n              minCanvasHeight = max(minCanvasHeight, isCropped ? cropBoxData.height : 0);\r\n            } else if (isCropped) {\r\n              minCanvasWidth = cropBoxData.width;\r\n              minCanvasHeight = cropBoxData.height;\r\n\r\n              if (minCanvasHeight * aspectRatio > minCanvasWidth) {\r\n                minCanvasWidth = minCanvasHeight * aspectRatio;\r\n              } else {\r\n                minCanvasHeight = minCanvasWidth / aspectRatio;\r\n              }\r\n            }\r\n          }\r\n        }\r\n\r\n        if (minCanvasWidth && minCanvasHeight) {\r\n          if (minCanvasHeight * aspectRatio > minCanvasWidth) {\r\n            minCanvasHeight = minCanvasWidth / aspectRatio;\r\n          } else {\r\n            minCanvasWidth = minCanvasHeight * aspectRatio;\r\n          }\r\n        } else if (minCanvasWidth) {\r\n          minCanvasHeight = minCanvasWidth / aspectRatio;\r\n        } else if (minCanvasHeight) {\r\n          minCanvasWidth = minCanvasHeight * aspectRatio;\r\n        }\r\n\r\n        canvasData.minWidth = minCanvasWidth;\r\n        canvasData.minHeight = minCanvasHeight;\r\n        canvasData.maxWidth = Infinity;\r\n        canvasData.maxHeight = Infinity;\r\n      }\r\n\r\n      if (isPositionLimited) {\r\n        if (viewMode) {\r\n          newCanvasLeft = containerWidth - canvasData.width;\r\n          newCanvasTop = containerHeight - canvasData.height;\r\n\r\n          canvasData.minLeft = min(0, newCanvasLeft);\r\n          canvasData.minTop = min(0, newCanvasTop);\r\n          canvasData.maxLeft = max(0, newCanvasLeft);\r\n          canvasData.maxTop = max(0, newCanvasTop);\r\n\r\n          if (isCropped && this.isLimited) {\r\n            canvasData.minLeft = min(\r\n              cropBoxData.left,\r\n              cropBoxData.left + cropBoxData.width - canvasData.width\r\n            );\r\n            canvasData.minTop = min(\r\n              cropBoxData.top,\r\n              cropBoxData.top + cropBoxData.height - canvasData.height\r\n            );\r\n            canvasData.maxLeft = cropBoxData.left;\r\n            canvasData.maxTop = cropBoxData.top;\r\n\r\n            if (viewMode === 2) {\r\n              if (canvasData.width >= containerWidth) {\r\n                canvasData.minLeft = min(0, newCanvasLeft);\r\n                canvasData.maxLeft = max(0, newCanvasLeft);\r\n              }\r\n\r\n              if (canvasData.height >= containerHeight) {\r\n                canvasData.minTop = min(0, newCanvasTop);\r\n                canvasData.maxTop = max(0, newCanvasTop);\r\n              }\r\n            }\r\n          }\r\n        } else {\r\n          canvasData.minLeft = -canvasData.width;\r\n          canvasData.minTop = -canvasData.height;\r\n          canvasData.maxLeft = containerWidth;\r\n          canvasData.maxTop = containerHeight;\r\n        }\r\n      }\r\n    },\r\n\r\n    renderCanvas: function (isChanged) {\r\n      var canvasData = this.canvasData;\r\n      var imageData = this.imageData;\r\n      var rotate = imageData.rotate;\r\n      var naturalWidth = imageData.naturalWidth;\r\n      var naturalHeight = imageData.naturalHeight;\r\n      var aspectRatio;\r\n      var rotatedData;\r\n\r\n      if (this.isRotated) {\r\n        this.isRotated = false;\r\n\r\n        // Computes rotated sizes with image sizes\r\n        rotatedData = getRotatedSizes({\r\n          width: imageData.width,\r\n          height: imageData.height,\r\n          degree: rotate\r\n        });\r\n\r\n        aspectRatio = rotatedData.width / rotatedData.height;\r\n\r\n        if (aspectRatio !== canvasData.aspectRatio) {\r\n          canvasData.left -= (rotatedData.width - canvasData.width) / 2;\r\n          canvasData.top -= (rotatedData.height - canvasData.height) / 2;\r\n          canvasData.width = rotatedData.width;\r\n          canvasData.height = rotatedData.height;\r\n          canvasData.aspectRatio = aspectRatio;\r\n          canvasData.naturalWidth = naturalWidth;\r\n          canvasData.naturalHeight = naturalHeight;\r\n\r\n          // Computes rotated sizes with natural image sizes\r\n          if (rotate % 180) {\r\n            rotatedData = getRotatedSizes({\r\n              width: naturalWidth,\r\n              height: naturalHeight,\r\n              degree: rotate\r\n            });\r\n\r\n            canvasData.naturalWidth = rotatedData.width;\r\n            canvasData.naturalHeight = rotatedData.height;\r\n          }\r\n\r\n          this.limitCanvas(true, false);\r\n        }\r\n      }\r\n\r\n      if (canvasData.width > canvasData.maxWidth || canvasData.width < canvasData.minWidth) {\r\n        canvasData.left = canvasData.oldLeft;\r\n      }\r\n\r\n      if (canvasData.height > canvasData.maxHeight || canvasData.height < canvasData.minHeight) {\r\n        canvasData.top = canvasData.oldTop;\r\n      }\r\n\r\n      canvasData.width = min(\r\n        max(canvasData.width, canvasData.minWidth),\r\n        canvasData.maxWidth\r\n      );\r\n      canvasData.height = min(\r\n        max(canvasData.height, canvasData.minHeight),\r\n        canvasData.maxHeight\r\n      );\r\n\r\n      this.limitCanvas(false, true);\r\n\r\n      canvasData.oldLeft = canvasData.left = min(\r\n        max(canvasData.left, canvasData.minLeft),\r\n        canvasData.maxLeft\r\n      );\r\n      canvasData.oldTop = canvasData.top = min(\r\n        max(canvasData.top, canvasData.minTop),\r\n        canvasData.maxTop\r\n      );\r\n\r\n      this.canvas.style.cssText = (\r\n        'width:' + canvasData.width + 'px;' +\r\n        'height:' + canvasData.height + 'px;' +\r\n        'left:' + canvasData.left + 'px;' +\r\n        'top:' + canvasData.top + 'px;'\r\n      );\r\n\r\n      this.renderImage();\r\n\r\n      if (this.isCropped && this.isLimited) {\r\n        this.limitCropBox(true, true);\r\n      }\r\n\r\n      if (isChanged) {\r\n        this.output();\r\n      }\r\n    },\r\n\r\n    renderImage: function (isChanged) {\r\n      var canvasData = this.canvasData;\r\n      var imageData = this.imageData;\r\n      var reversedData;\r\n      var transform;\r\n\r\n      if (imageData.rotate) {\r\n        reversedData = getRotatedSizes({\r\n          width: canvasData.width,\r\n          height: canvasData.height,\r\n          degree: imageData.rotate,\r\n          aspectRatio: imageData.aspectRatio\r\n        }, true);\r\n      }\r\n\r\n      extend(imageData, reversedData ? {\r\n        width: reversedData.width,\r\n        height: reversedData.height,\r\n        left: (canvasData.width - reversedData.width) / 2,\r\n        top: (canvasData.height - reversedData.height) / 2\r\n      } : {\r\n        width: canvasData.width,\r\n        height: canvasData.height,\r\n        left: 0,\r\n        top: 0\r\n      });\r\n\r\n      transform = getTransform(imageData);\r\n\r\n      this.image.style.cssText = (\r\n        'width:' + imageData.width + 'px;' +\r\n        'height:' + imageData.height + 'px;' +\r\n        'margin-left:' + imageData.left + 'px;' +\r\n        'margin-top:' + imageData.top + 'px;' +\r\n        '-webkit-transform:' + transform + ';' +\r\n        '-ms-transform:' + transform + ';' +\r\n        'transform:' + transform + ';'\r\n      );\r\n\r\n      if (isChanged) {\r\n        this.output();\r\n      }\r\n    },\r\n\r\n    initCropBox: function () {\r\n      var options = this.options;\r\n      var aspectRatio = options.aspectRatio;\r\n      var autoCropArea = num(options.autoCropArea) || 0.8;\r\n      var canvasData = this.canvasData;\r\n      var cropBoxData = {\r\n            width: canvasData.width,\r\n            height: canvasData.height\r\n          };\r\n\r\n      if (aspectRatio) {\r\n        if (canvasData.height * aspectRatio > canvasData.width) {\r\n          cropBoxData.height = cropBoxData.width / aspectRatio;\r\n        } else {\r\n          cropBoxData.width = cropBoxData.height * aspectRatio;\r\n        }\r\n      }\r\n\r\n      this.cropBoxData = cropBoxData;\r\n      this.limitCropBox(true, true);\r\n\r\n      // Initialize auto crop area\r\n      cropBoxData.width = min(\r\n        max(cropBoxData.width, cropBoxData.minWidth),\r\n        cropBoxData.maxWidth\r\n      );\r\n      cropBoxData.height = min(\r\n        max(cropBoxData.height, cropBoxData.minHeight),\r\n        cropBoxData.maxHeight\r\n      );\r\n\r\n      // The width/height of auto crop area must large than \"minWidth/Height\"\r\n      cropBoxData.width = max(\r\n        cropBoxData.minWidth,\r\n        cropBoxData.width * autoCropArea\r\n      );\r\n      cropBoxData.height = max(\r\n        cropBoxData.minHeight,\r\n        cropBoxData.height * autoCropArea\r\n      );\r\n      cropBoxData.oldLeft = cropBoxData.left = canvasData.left + (canvasData.width - cropBoxData.width) / 2;\r\n      cropBoxData.oldTop = cropBoxData.top = canvasData.top + (canvasData.height - cropBoxData.height) / 2;\r\n\r\n      this.initialCropBoxData = extend({}, cropBoxData);\r\n    },\r\n\r\n    limitCropBox: function (isSizeLimited, isPositionLimited) {\r\n      var options = this.options;\r\n      var aspectRatio = options.aspectRatio;\r\n      var containerData = this.containerData;\r\n      var containerWidth = containerData.width;\r\n      var containerHeight = containerData.height;\r\n      var canvasData = this.canvasData;\r\n      var cropBoxData = this.cropBoxData;\r\n      var isLimited = this.isLimited;\r\n      var minCropBoxWidth;\r\n      var minCropBoxHeight;\r\n      var maxCropBoxWidth;\r\n      var maxCropBoxHeight;\r\n\r\n      if (isSizeLimited) {\r\n        minCropBoxWidth = num(options.minCropBoxWidth) || 0;\r\n        minCropBoxHeight = num(options.minCropBoxHeight) || 0;\r\n\r\n        // The min/maxCropBoxWidth/Height must be less than containerWidth/Height\r\n        minCropBoxWidth = min(minCropBoxWidth, containerWidth);\r\n        minCropBoxHeight = min(minCropBoxHeight, containerHeight);\r\n        maxCropBoxWidth = min(containerWidth, isLimited ? canvasData.width : containerWidth);\r\n        maxCropBoxHeight = min(containerHeight, isLimited ? canvasData.height : containerHeight);\r\n\r\n        if (aspectRatio) {\r\n          if (minCropBoxWidth && minCropBoxHeight) {\r\n            if (minCropBoxHeight * aspectRatio > minCropBoxWidth) {\r\n              minCropBoxHeight = minCropBoxWidth / aspectRatio;\r\n            } else {\r\n              minCropBoxWidth = minCropBoxHeight * aspectRatio;\r\n            }\r\n          } else if (minCropBoxWidth) {\r\n            minCropBoxHeight = minCropBoxWidth / aspectRatio;\r\n          } else if (minCropBoxHeight) {\r\n            minCropBoxWidth = minCropBoxHeight * aspectRatio;\r\n          }\r\n\r\n          if (maxCropBoxHeight * aspectRatio > maxCropBoxWidth) {\r\n            maxCropBoxHeight = maxCropBoxWidth / aspectRatio;\r\n          } else {\r\n            maxCropBoxWidth = maxCropBoxHeight * aspectRatio;\r\n          }\r\n        }\r\n\r\n        // The minWidth/Height must be less than maxWidth/Height\r\n        cropBoxData.minWidth = min(minCropBoxWidth, maxCropBoxWidth);\r\n        cropBoxData.minHeight = min(minCropBoxHeight, maxCropBoxHeight);\r\n        cropBoxData.maxWidth = maxCropBoxWidth;\r\n        cropBoxData.maxHeight = maxCropBoxHeight;\r\n      }\r\n\r\n      if (isPositionLimited) {\r\n        if (isLimited) {\r\n          cropBoxData.minLeft = max(0, canvasData.left);\r\n          cropBoxData.minTop = max(0, canvasData.top);\r\n          cropBoxData.maxLeft = min(containerWidth, canvasData.left + canvasData.width) - cropBoxData.width;\r\n          cropBoxData.maxTop = min(containerHeight, canvasData.top + canvasData.height) - cropBoxData.height;\r\n        } else {\r\n          cropBoxData.minLeft = 0;\r\n          cropBoxData.minTop = 0;\r\n          cropBoxData.maxLeft = containerWidth - cropBoxData.width;\r\n          cropBoxData.maxTop = containerHeight - cropBoxData.height;\r\n        }\r\n      }\r\n    },\r\n\r\n    renderCropBox: function () {\r\n      var options = this.options;\r\n      var containerData = this.containerData;\r\n      var containerWidth = containerData.width;\r\n      var containerHeight = containerData.height;\r\n      var cropBoxData = this.cropBoxData;\r\n\r\n      if (cropBoxData.width > cropBoxData.maxWidth || cropBoxData.width < cropBoxData.minWidth) {\r\n        cropBoxData.left = cropBoxData.oldLeft;\r\n      }\r\n\r\n      if (cropBoxData.height > cropBoxData.maxHeight || cropBoxData.height < cropBoxData.minHeight) {\r\n        cropBoxData.top = cropBoxData.oldTop;\r\n      }\r\n\r\n      cropBoxData.width = min(\r\n        max(cropBoxData.width, cropBoxData.minWidth),\r\n        cropBoxData.maxWidth\r\n      );\r\n      cropBoxData.height = min(\r\n        max(cropBoxData.height, cropBoxData.minHeight),\r\n        cropBoxData.maxHeight\r\n      );\r\n\r\n      this.limitCropBox(false, true);\r\n\r\n      cropBoxData.oldLeft = cropBoxData.left = min(\r\n        max(cropBoxData.left, cropBoxData.minLeft),\r\n        cropBoxData.maxLeft\r\n      );\r\n      cropBoxData.oldTop = cropBoxData.top = min(\r\n        max(cropBoxData.top, cropBoxData.minTop),\r\n        cropBoxData.maxTop\r\n      );\r\n\r\n      if (options.movable && options.cropBoxDataMovable) {\r\n\r\n        // Turn to move the canvas when the crop box is equal to the container\r\n        setData(this.face, DATA_ACTION, (cropBoxData.width === containerWidth && cropBoxData.height === containerHeight) ? ACTION_MOVE : ACTION_ALL);\r\n      }\r\n\r\n      this.cropBox.style.cssText = (\r\n        'width:' + cropBoxData.width + 'px;' +\r\n        'height:' + cropBoxData.height + 'px;' +\r\n        'left:' + cropBoxData.left + 'px;' +\r\n        'top:' + cropBoxData.top + 'px;'\r\n      );\r\n\r\n      if (this.isCropped && this.isLimited) {\r\n        this.limitCanvas(true, true);\r\n      }\r\n\r\n      if (!this.isDisabled) {\r\n        this.output();\r\n      }\r\n    },\r\n\r\n    output: function () {\r\n      var options = this.options;\r\n\r\n      this.preview();\r\n\r\n      if (this.isCompleted && isFunction(options.crop)) {\r\n        options.crop.call(this.element, this.getData());\r\n      }\r\n    }\r\n  });\r\n","  extend(prototype, {\r\n    initPreview: function () {\r\n      var preview = this.options.preview;\r\n      var image = document.createElement('img');\r\n      var crossOrigin = this.crossOrigin;\r\n      var url = crossOrigin ? this.crossOriginUrl : this.url;\r\n      var previews;\r\n\r\n      if (crossOrigin) {\r\n        image.crossOrigin = crossOrigin;\r\n      }\r\n\r\n      image.src = url;\r\n      appendChild(this.viewBox, image);\r\n\r\n      if (!preview) {\r\n        return;\r\n      }\r\n\r\n      this.previews = previews = querySelectorAll(document, preview);\r\n      each(previews, function (element) {\r\n        var image = document.createElement('img');\r\n\r\n        // Save the original size for recover\r\n        setData(element, DATA_PREVIEW, {\r\n          width: element.offsetWidth,\r\n          height: element.offsetHeight,\r\n          html: element.innerHTML\r\n        });\r\n\r\n        if (crossOrigin) {\r\n          image.crossOrigin = crossOrigin;\r\n        }\r\n\r\n        image.src = url;\r\n\r\n        /**\r\n         * Override img element styles\r\n         * Add `display:block` to avoid margin top issue\r\n         * Add `height:auto` to override `height` attribute on IE8\r\n         * (Occur only when margin-top <= -height)\r\n         */\r\n        image.style.cssText = (\r\n          'display:block;width:100%;height:auto;' +\r\n          'min-width:0!important;min-height:0!important;' +\r\n          'max-width:none!important;max-height:none!important;' +\r\n          'image-orientation:0deg!important;\"'\r\n        );\r\n\r\n        empty(element);\r\n        appendChild(element, image);\r\n      });\r\n    },\r\n\r\n    resetPreview: function () {\r\n      each(this.previews, function (element) {\r\n        var data = getData(element, DATA_PREVIEW);\r\n\r\n        element.style.width = data.width + 'px';\r\n        element.style.height = data.height + 'px';\r\n        element.innerHTML = data.html;\r\n        removeData(element, DATA_PREVIEW);\r\n      });\r\n    },\r\n\r\n    preview: function () {\r\n      var imageData = this.imageData;\r\n      var canvasData = this.canvasData;\r\n      var cropBoxData = this.cropBoxData;\r\n      var cropBoxWidth = cropBoxData.width;\r\n      var cropBoxHeight = cropBoxData.height;\r\n      var width = imageData.width;\r\n      var height = imageData.height;\r\n      var left = cropBoxData.left - canvasData.left - imageData.left;\r\n      var top = cropBoxData.top - canvasData.top - imageData.top;\r\n      var transform = getTransform(imageData);\r\n\r\n      if (!this.isCropped || this.isDisabled) {\r\n        return;\r\n      }\r\n\r\n      querySelector(this.viewBox, 'img').style.cssText = (\r\n        'width:' + width + 'px;' +\r\n        'height:' + height + 'px;' +\r\n        'margin-left:' + -left + 'px;' +\r\n        'margin-top:' + -top + 'px;' +\r\n        '-webkit-transform:' + transform + ';' +\r\n        '-ms-transform:' + transform + ';' +\r\n        'transform:' + transform + ';'\r\n      );\r\n\r\n      each(this.previews, function (element) {\r\n        var imageStyle = querySelector(element, 'img').style;\r\n        var data = getData(element, DATA_PREVIEW);\r\n        var originalWidth = data.width;\r\n        var originalHeight = data.height;\r\n        var newWidth = originalWidth;\r\n        var newHeight = originalHeight;\r\n        var ratio = 1;\r\n\r\n        if (cropBoxWidth) {\r\n          ratio = originalWidth / cropBoxWidth;\r\n          newHeight = cropBoxHeight * ratio;\r\n        }\r\n\r\n        if (cropBoxHeight && newHeight > originalHeight) {\r\n          ratio = originalHeight / cropBoxHeight;\r\n          newWidth = cropBoxWidth * ratio;\r\n          newHeight = originalHeight;\r\n        }\r\n\r\n        element.style.width = newWidth + 'px';\r\n        element.style.height = newHeight + 'px';\r\n        imageStyle.width = width * ratio + 'px';\r\n        imageStyle.height = height * ratio + 'px';\r\n        imageStyle.marginLeft = -left * ratio + 'px';\r\n        imageStyle.marginTop = -top * ratio + 'px';\r\n        imageStyle.WebkitTransform = transform;\r\n        imageStyle.msTransform = transform;\r\n        imageStyle.transform = transform;\r\n      });\r\n    }\r\n  });\r\n","  extend(prototype, {\r\n    bind: function () {\r\n      var options = this.options;\r\n      var cropper = this.cropper;\r\n\r\n      addListener(cropper, EVENT_MOUSE_DOWN, proxy(this.cropStart, this));\r\n\r\n      if (options.zoomable && options.zoomOnWheel) {\r\n        addListener(cropper, EVENT_WHEEL, proxy(this.wheel, this));\r\n      }\r\n\r\n      if (options.toggleDragModeOnDblclick) {\r\n        addListener(cropper, EVENT_DBLCLICK, proxy(this.dblclick, this));\r\n      }\r\n\r\n      addListener(document, EVENT_MOUSE_MOVE, (this._cropMove = proxy(this.cropMove, this)));\r\n      addListener(document, EVENT_MOUSE_UP, (this._cropEnd = proxy(this.cropEnd, this)));\r\n\r\n      if (options.responsive) {\r\n        addListener(window, EVENT_RESIZE, (this._resize = proxy(this.resize, this)));\r\n      }\r\n    },\r\n\r\n    unbind: function () {\r\n      var options = this.options;\r\n      var cropper = this.cropper;\r\n\r\n      removeListener(cropper, EVENT_MOUSE_DOWN, this.cropStart);\r\n\r\n      if (options.zoomable && options.zoomOnWheel) {\r\n        removeListener(cropper, EVENT_WHEEL, this.wheel);\r\n      }\r\n\r\n      if (options.toggleDragModeOnDblclick) {\r\n        removeListener(cropper, EVENT_DBLCLICK, this.dblclick);\r\n      }\r\n\r\n      removeListener(document, EVENT_MOUSE_MOVE, this._cropMove);\r\n      removeListener(document, EVENT_MOUSE_UP, this._cropEnd);\r\n\r\n      if (options.responsive) {\r\n        removeListener(window, EVENT_RESIZE, this._resize);\r\n      }\r\n    }\r\n  });\r\n","  extend(prototype, {\r\n    resize: function () {\r\n      var restore = this.options.restore;\r\n      var container = this.container;\r\n      var containerData = this.containerData;\r\n      var canvasData;\r\n      var cropBoxData;\r\n      var ratio;\r\n\r\n      // Check `container` is necessary for IE8\r\n      if (this.isDisabled || !containerData) {\r\n        return;\r\n      }\r\n\r\n      ratio = container.offsetWidth / containerData.width;\r\n\r\n      // Resize when width changed or height changed\r\n      if (ratio !== 1 || container.offsetHeight !== containerData.height) {\r\n        if (restore) {\r\n          canvasData = this.getCanvasData();\r\n          cropBoxData = this.getCropBoxData();\r\n        }\r\n\r\n        this.render();\r\n\r\n        if (restore) {\r\n          this.setCanvasData(each(canvasData, function (n, i) {\r\n            canvasData[i] = n * ratio;\r\n          }));\r\n          this.setCropBoxData(each(cropBoxData, function (n, i) {\r\n            cropBoxData[i] = n * ratio;\r\n          }));\r\n        }\r\n      }\r\n    },\r\n\r\n    dblclick: function () {\r\n      if (this.isDisabled) {\r\n        return;\r\n      }\r\n\r\n      this.setDragMode(hasClass(this.dragBox, CLASS_CROP) ? ACTION_MOVE : ACTION_CROP);\r\n    },\r\n\r\n    wheel: function (event) {\r\n      var e = getEvent(event);\r\n      var ratio = num(this.options.wheelZoomRatio) || 0.1;\r\n      var delta = 1;\r\n\r\n      if (this.isDisabled) {\r\n        return;\r\n      }\r\n\r\n      preventDefault(e);\r\n\r\n      if (e.deltaY) {\r\n        delta = e.deltaY > 0 ? 1 : -1;\r\n      } else if (e.wheelDelta) {\r\n        delta = -e.wheelDelta / 120;\r\n      } else if (e.detail) {\r\n        delta = e.detail > 0 ? 1 : -1;\r\n      }\r\n\r\n      this.zoom(-delta * ratio, e);\r\n    },\r\n\r\n    cropStart: function (event) {\r\n      var options = this.options;\r\n      var e = getEvent(event);\r\n      var touches = e.touches;\r\n      var touchesLength;\r\n      var touch;\r\n      var action;\r\n\r\n      if (this.isDisabled) {\r\n        return;\r\n      }\r\n\r\n      if (touches) {\r\n        touchesLength = touches.length;\r\n\r\n        if (touchesLength > 1) {\r\n          if (options.zoomable && options.zoomOnTouch && touchesLength === 2) {\r\n            touch = touches[1];\r\n            this.startX2 = touch.pageX;\r\n            this.startY2 = touch.pageY;\r\n            action = ACTION_ZOOM;\r\n          } else {\r\n            return;\r\n          }\r\n        }\r\n\r\n        touch = touches[0];\r\n      }\r\n\r\n      action = action || getData(e.target, DATA_ACTION);\r\n\r\n      if (REGEXP_ACTIONS.test(action)) {\r\n        if (isFunction(options.cropstart) && options.cropstart.call(this.element, {\r\n          originalEvent: e,\r\n          action: action\r\n        }) === false) {\r\n          return;\r\n        }\r\n\r\n        preventDefault(e);\r\n\r\n        this.action = action;\r\n        this.cropping = false;\r\n\r\n        this.startX = touch ? touch.pageX : e.pageX;\r\n        this.startY = touch ? touch.pageY : e.pageY;\r\n\r\n        if (action === ACTION_CROP) {\r\n          this.cropping = true;\r\n          addClass(this.dragBox, CLASS_MODAL);\r\n        }\r\n      }\r\n    },\r\n\r\n    cropMove: function (event) {\r\n      var options = this.options;\r\n      var e = getEvent(event);\r\n      var touches = e.touches;\r\n      var action = this.action;\r\n      var touchesLength;\r\n      var touch;\r\n\r\n      if (this.isDisabled) {\r\n        return;\r\n      }\r\n\r\n      if (touches) {\r\n        touchesLength = touches.length;\r\n\r\n        if (touchesLength > 1) {\r\n          if (options.zoomable && options.zoomOnTouch && touchesLength === 2) {\r\n            touch = touches[1];\r\n            this.endX2 = touch.pageX;\r\n            this.endY2 = touch.pageY;\r\n          } else {\r\n            return;\r\n          }\r\n        }\r\n\r\n        touch = touches[0];\r\n      }\r\n\r\n      if (action) {\r\n        if (isFunction(options.cropmove) && options.cropmove.call(this.element, {\r\n          originalEvent: e,\r\n          action: action\r\n        }) === false) {\r\n          return;\r\n        }\r\n\r\n        preventDefault(e);\r\n\r\n        this.endX = touch ? touch.pageX : e.pageX;\r\n        this.endY = touch ? touch.pageY : e.pageY;\r\n\r\n        this.change(e.shiftKey, action === ACTION_ZOOM ? e : null);\r\n      }\r\n    },\r\n\r\n    cropEnd: function (event) {\r\n      var options = this.options;\r\n      var e = getEvent(event);\r\n      var action = this.action;\r\n\r\n      if (this.isDisabled) {\r\n        return;\r\n      }\r\n\r\n      if (action) {\r\n        preventDefault(e);\r\n\r\n        if (this.cropping) {\r\n          this.cropping = false;\r\n          toggleClass(this.dragBox, CLASS_MODAL, this.isCropped && options.modal);\r\n        }\r\n\r\n        this.action = '';\r\n\r\n        if (isFunction(options.cropend)) {\r\n          options.cropend.call(this.element, {\r\n            originalEvent: e,\r\n            action: action\r\n          });\r\n        }\r\n      }\r\n    }\r\n  });\r\n","  extend(prototype, {\r\n    change: function (shiftKey, originalEvent) {\r\n      var options = this.options;\r\n      var aspectRatio = options.aspectRatio;\r\n      var action = this.action;\r\n      var containerData = this.containerData;\r\n      var canvasData = this.canvasData;\r\n      var cropBoxData = this.cropBoxData;\r\n      var width = cropBoxData.width;\r\n      var height = cropBoxData.height;\r\n      var left = cropBoxData.left;\r\n      var top = cropBoxData.top;\r\n      var right = left + width;\r\n      var bottom = top + height;\r\n      var minLeft = 0;\r\n      var minTop = 0;\r\n      var maxWidth = containerData.width;\r\n      var maxHeight = containerData.height;\r\n      var renderable = true;\r\n      var offset;\r\n      var range;\r\n\r\n      // Locking aspect ratio in \"free mode\" by holding shift key\r\n      if (!aspectRatio && shiftKey) {\r\n        aspectRatio = width && height ? width / height : 1;\r\n      }\r\n\r\n      if (this.isLimited) {\r\n        minLeft = cropBoxData.minLeft;\r\n        minTop = cropBoxData.minTop;\r\n        maxWidth = minLeft + min(containerData.width, canvasData.width);\r\n        maxHeight = minTop + min(containerData.height, canvasData.height);\r\n      }\r\n\r\n      range = {\r\n        x: this.endX - this.startX,\r\n        y: this.endY - this.startY\r\n      };\r\n\r\n      if (aspectRatio) {\r\n        range.X = range.y * aspectRatio;\r\n        range.Y = range.x / aspectRatio;\r\n      }\r\n\r\n      switch (action) {\r\n        // Move crop box\r\n        case ACTION_ALL:\r\n          left += range.x;\r\n          top += range.y;\r\n          break;\r\n\r\n        // Resize crop box\r\n        case ACTION_EAST:\r\n          if (range.x >= 0 && (right >= maxWidth || aspectRatio &&\r\n            (top <= minTop || bottom >= maxHeight))) {\r\n\r\n            renderable = false;\r\n            break;\r\n          }\r\n\r\n          width += range.x;\r\n\r\n          if (aspectRatio) {\r\n            height = width / aspectRatio;\r\n            top -= range.Y / 2;\r\n          }\r\n\r\n          if (width < 0) {\r\n            action = ACTION_WEST;\r\n            width = 0;\r\n          }\r\n\r\n          break;\r\n\r\n        case ACTION_NORTH:\r\n          if (range.y <= 0 && (top <= minTop || aspectRatio &&\r\n            (left <= minLeft || right >= maxWidth))) {\r\n\r\n            renderable = false;\r\n            break;\r\n          }\r\n\r\n          height -= range.y;\r\n          top += range.y;\r\n\r\n          if (aspectRatio) {\r\n            width = height * aspectRatio;\r\n            left += range.X / 2;\r\n          }\r\n\r\n          if (height < 0) {\r\n            action = ACTION_SOUTH;\r\n            height = 0;\r\n          }\r\n\r\n          break;\r\n\r\n        case ACTION_WEST:\r\n          if (range.x <= 0 && (left <= minLeft || aspectRatio &&\r\n            (top <= minTop || bottom >= maxHeight))) {\r\n\r\n            renderable = false;\r\n            break;\r\n          }\r\n\r\n          width -= range.x;\r\n          left += range.x;\r\n\r\n          if (aspectRatio) {\r\n            height = width / aspectRatio;\r\n            top += range.Y / 2;\r\n          }\r\n\r\n          if (width < 0) {\r\n            action = ACTION_EAST;\r\n            width = 0;\r\n          }\r\n\r\n          break;\r\n\r\n        case ACTION_SOUTH:\r\n          if (range.y >= 0 && (bottom >= maxHeight || aspectRatio &&\r\n            (left <= minLeft || right >= maxWidth))) {\r\n\r\n            renderable = false;\r\n            break;\r\n          }\r\n\r\n          height += range.y;\r\n\r\n          if (aspectRatio) {\r\n            width = height * aspectRatio;\r\n            left -= range.X / 2;\r\n          }\r\n\r\n          if (height < 0) {\r\n            action = ACTION_NORTH;\r\n            height = 0;\r\n          }\r\n\r\n          break;\r\n\r\n        case ACTION_NORTH_EAST:\r\n          if (aspectRatio) {\r\n            if (range.y <= 0 && (top <= minTop || right >= maxWidth)) {\r\n              renderable = false;\r\n              break;\r\n            }\r\n\r\n            height -= range.y;\r\n            top += range.y;\r\n            width = height * aspectRatio;\r\n          } else {\r\n            if (range.x >= 0) {\r\n              if (right < maxWidth) {\r\n                width += range.x;\r\n              } else if (range.y <= 0 && top <= minTop) {\r\n                renderable = false;\r\n              }\r\n            } else {\r\n              width += range.x;\r\n            }\r\n\r\n            if (range.y <= 0) {\r\n              if (top > minTop) {\r\n                height -= range.y;\r\n                top += range.y;\r\n              }\r\n            } else {\r\n              height -= range.y;\r\n              top += range.y;\r\n            }\r\n          }\r\n\r\n          if (width < 0 && height < 0) {\r\n            action = ACTION_SOUTH_WEST;\r\n            height = 0;\r\n            width = 0;\r\n          } else if (width < 0) {\r\n            action = ACTION_NORTH_WEST;\r\n            width = 0;\r\n          } else if (height < 0) {\r\n            action = ACTION_SOUTH_EAST;\r\n            height = 0;\r\n          }\r\n\r\n          break;\r\n\r\n        case ACTION_NORTH_WEST:\r\n          if (aspectRatio) {\r\n            if (range.y <= 0 && (top <= minTop || left <= minLeft)) {\r\n              renderable = false;\r\n              break;\r\n            }\r\n\r\n            height -= range.y;\r\n            top += range.y;\r\n            width = height * aspectRatio;\r\n            left += range.X;\r\n          } else {\r\n            if (range.x <= 0) {\r\n              if (left > minLeft) {\r\n                width -= range.x;\r\n                left += range.x;\r\n              } else if (range.y <= 0 && top <= minTop) {\r\n                renderable = false;\r\n              }\r\n            } else {\r\n              width -= range.x;\r\n              left += range.x;\r\n            }\r\n\r\n            if (range.y <= 0) {\r\n              if (top > minTop) {\r\n                height -= range.y;\r\n                top += range.y;\r\n              }\r\n            } else {\r\n              height -= range.y;\r\n              top += range.y;\r\n            }\r\n          }\r\n\r\n          if (width < 0 && height < 0) {\r\n            action = ACTION_SOUTH_EAST;\r\n            height = 0;\r\n            width = 0;\r\n          } else if (width < 0) {\r\n            action = ACTION_NORTH_EAST;\r\n            width = 0;\r\n          } else if (height < 0) {\r\n            action = ACTION_SOUTH_WEST;\r\n            height = 0;\r\n          }\r\n\r\n          break;\r\n\r\n        case ACTION_SOUTH_WEST:\r\n          if (aspectRatio) {\r\n            if (range.x <= 0 && (left <= minLeft || bottom >= maxHeight)) {\r\n              renderable = false;\r\n              break;\r\n            }\r\n\r\n            width -= range.x;\r\n            left += range.x;\r\n            height = width / aspectRatio;\r\n          } else {\r\n            if (range.x <= 0) {\r\n              if (left > minLeft) {\r\n                width -= range.x;\r\n                left += range.x;\r\n              } else if (range.y >= 0 && bottom >= maxHeight) {\r\n                renderable = false;\r\n              }\r\n            } else {\r\n              width -= range.x;\r\n              left += range.x;\r\n            }\r\n\r\n            if (range.y >= 0) {\r\n              if (bottom < maxHeight) {\r\n                height += range.y;\r\n              }\r\n            } else {\r\n              height += range.y;\r\n            }\r\n          }\r\n\r\n          if (width < 0 && height < 0) {\r\n            action = ACTION_NORTH_EAST;\r\n            height = 0;\r\n            width = 0;\r\n          } else if (width < 0) {\r\n            action = ACTION_SOUTH_EAST;\r\n            width = 0;\r\n          } else if (height < 0) {\r\n            action = ACTION_NORTH_WEST;\r\n            height = 0;\r\n          }\r\n\r\n          break;\r\n\r\n        case ACTION_SOUTH_EAST:\r\n          if (aspectRatio) {\r\n            if (range.x >= 0 && (right >= maxWidth || bottom >= maxHeight)) {\r\n              renderable = false;\r\n              break;\r\n            }\r\n\r\n            width += range.x;\r\n            height = width / aspectRatio;\r\n          } else {\r\n            if (range.x >= 0) {\r\n              if (right < maxWidth) {\r\n                width += range.x;\r\n              } else if (range.y >= 0 && bottom >= maxHeight) {\r\n                renderable = false;\r\n              }\r\n            } else {\r\n              width += range.x;\r\n            }\r\n\r\n            if (range.y >= 0) {\r\n              if (bottom < maxHeight) {\r\n                height += range.y;\r\n              }\r\n            } else {\r\n              height += range.y;\r\n            }\r\n          }\r\n\r\n          if (width < 0 && height < 0) {\r\n            action = ACTION_NORTH_WEST;\r\n            height = 0;\r\n            width = 0;\r\n          } else if (width < 0) {\r\n            action = ACTION_SOUTH_WEST;\r\n            width = 0;\r\n          } else if (height < 0) {\r\n            action = ACTION_NORTH_EAST;\r\n            height = 0;\r\n          }\r\n\r\n          break;\r\n\r\n        // Move canvas\r\n        case ACTION_MOVE:\r\n          this.move(range.x, range.y);\r\n          renderable = false;\r\n          break;\r\n\r\n        // Zoom canvas\r\n        case ACTION_ZOOM:\r\n          this.zoom((function (x1, y1, x2, y2) {\r\n            var z1 = sqrt(x1 * x1 + y1 * y1);\r\n            var z2 = sqrt(x2 * x2 + y2 * y2);\r\n\r\n            return (z2 - z1) / z1;\r\n          })(\r\n            abs(this.startX - this.startX2),\r\n            abs(this.startY - this.startY2),\r\n            abs(this.endX - this.endX2),\r\n            abs(this.endY - this.endY2)\r\n          ), originalEvent);\r\n          this.startX2 = this.endX2;\r\n          this.startY2 = this.endY2;\r\n          renderable = false;\r\n          break;\r\n\r\n        // Create crop box\r\n        case ACTION_CROP:\r\n          if (!range.x || !range.y) {\r\n            renderable = false;\r\n            break;\r\n          }\r\n\r\n          offset = getOffset(this.cropper);\r\n          left = this.startX - offset.left;\r\n          top = this.startY - offset.top;\r\n          width = cropBoxData.minWidth;\r\n          height = cropBoxData.minHeight;\r\n\r\n          if (range.x > 0) {\r\n            action = range.y > 0 ? ACTION_SOUTH_EAST : ACTION_NORTH_EAST;\r\n          } else if (range.x < 0) {\r\n            left -= width;\r\n            action = range.y > 0 ? ACTION_SOUTH_WEST : ACTION_NORTH_WEST;\r\n          }\r\n\r\n          if (range.y < 0) {\r\n            top -= height;\r\n          }\r\n\r\n          // Show the crop box if is hidden\r\n          if (!this.isCropped) {\r\n            removeClass(this.cropBox, CLASS_HIDDEN);\r\n            this.isCropped = true;\r\n\r\n            if (this.isLimited) {\r\n              this.limitCropBox(true, true);\r\n            }\r\n          }\r\n\r\n          break;\r\n\r\n        // No default\r\n      }\r\n\r\n      if (renderable) {\r\n        cropBoxData.width = width;\r\n        cropBoxData.height = height;\r\n        cropBoxData.left = left;\r\n        cropBoxData.top = top;\r\n        this.action = action;\r\n\r\n        this.renderCropBox();\r\n      }\r\n\r\n      // Override\r\n      this.startX = this.endX;\r\n      this.startY = this.endY;\r\n    }\r\n  });\r\n","  extend(prototype, {\r\n\r\n    // Show the crop box manually\r\n    crop: function () {\r\n      if (this.isBuilt && !this.isDisabled) {\r\n        if (!this.isCropped) {\r\n          this.isCropped = true;\r\n          this.limitCropBox(true, true);\r\n\r\n          if (this.options.modal) {\r\n            addClass(this.dragBox, CLASS_MODAL);\r\n          }\r\n\r\n          removeClass(this.cropBox, CLASS_HIDDEN);\r\n        }\r\n\r\n        this.setCropBoxData(this.initialCropBoxData);\r\n      }\r\n\r\n      return this;\r\n    },\r\n\r\n    // Reset the image and crop box to their initial states\r\n    reset: function () {\r\n      if (this.isBuilt && !this.isDisabled) {\r\n        this.imageData = extend({}, this.initialImageData);\r\n        this.canvasData = extend({}, this.initialCanvasData);\r\n        this.cropBoxData = extend({}, this.initialCropBoxData);\r\n\r\n        this.renderCanvas();\r\n\r\n        if (this.isCropped) {\r\n          this.renderCropBox();\r\n        }\r\n      }\r\n\r\n      return this;\r\n    },\r\n\r\n    // Clear the crop box\r\n    clear: function () {\r\n      if (this.isCropped && !this.isDisabled) {\r\n        extend(this.cropBoxData, {\r\n          left: 0,\r\n          top: 0,\r\n          width: 0,\r\n          height: 0\r\n        });\r\n\r\n        this.isCropped = false;\r\n        this.renderCropBox();\r\n\r\n        this.limitCanvas();\r\n\r\n        // Render canvas after crop box rendered\r\n        this.renderCanvas();\r\n\r\n        removeClass(this.dragBox, CLASS_MODAL);\r\n        addClass(this.cropBox, CLASS_HIDDEN);\r\n      }\r\n\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Replace the image's src and rebuild the cropper\r\n     *\r\n     * @param {String} url\r\n     */\r\n    replace: function (url) {\r\n      if (!this.isDisabled && url) {\r\n        if (this.isImg) {\r\n          this.isReplaced = true;\r\n          this.element.src = url;\r\n        }\r\n\r\n        // Clear previous data\r\n        this.options.data = null;\r\n        this.load(url);\r\n      }\r\n\r\n      return this;\r\n    },\r\n\r\n    // Enable (unfreeze) the cropper\r\n    enable: function () {\r\n      if (this.isBuilt) {\r\n        this.isDisabled = false;\r\n        removeClass(this.cropper, CLASS_DISABLED);\r\n      }\r\n\r\n      return this;\r\n    },\r\n\r\n    // Disable (freeze) the cropper\r\n    disable: function () {\r\n      if (this.isBuilt) {\r\n        this.isDisabled = true;\r\n        addClass(this.cropper, CLASS_DISABLED);\r\n      }\r\n\r\n      return this;\r\n    },\r\n\r\n    // Destroy the cropper and remove the instance from the image\r\n    destroy: function () {\r\n      var element = this.element;\r\n      var image = this.image;\r\n\r\n      if (this.isLoaded) {\r\n        if (this.isImg && this.isReplaced) {\r\n          element.src = this.originalUrl;\r\n        }\r\n\r\n        this.unbuild();\r\n        removeClass(element, CLASS_HIDDEN);\r\n      } else {\r\n        if (this.isImg) {\r\n          element.off(EVENT_LOAD, this.start);\r\n        } else if (image) {\r\n          removeChild(image);\r\n        }\r\n      }\r\n\r\n      removeData(element, NAMESPACE);\r\n\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Move the canvas with relative offsets\r\n     *\r\n     * @param {Number} offsetX\r\n     * @param {Number} offsetY (optional)\r\n     */\r\n    move: function (offsetX, offsetY) {\r\n      var canvasData = this.canvasData;\r\n\r\n      return this.moveTo(\r\n        isUndefined(offsetX) ? offsetX : canvasData.left + num(offsetX),\r\n        isUndefined(offsetY) ? offsetY : canvasData.top + num(offsetY)\r\n      );\r\n    },\r\n\r\n    /**\r\n     * Move the canvas to an absolute point\r\n     *\r\n     * @param {Number} x\r\n     * @param {Number} y (optional)\r\n     */\r\n    moveTo: function (x, y) {\r\n      var canvasData = this.canvasData;\r\n      var isChanged = false;\r\n\r\n      // If \"y\" is not present, its default value is \"x\"\r\n      if (isUndefined(y)) {\r\n        y = x;\r\n      }\r\n\r\n      x = num(x);\r\n      y = num(y);\r\n\r\n      if (this.isBuilt && !this.isDisabled && this.options.movable) {\r\n        if (isNumber(x)) {\r\n          canvasData.left = x;\r\n          isChanged = true;\r\n        }\r\n\r\n        if (isNumber(y)) {\r\n          canvasData.top = y;\r\n          isChanged = true;\r\n        }\r\n\r\n        if (isChanged) {\r\n          this.renderCanvas(true);\r\n        }\r\n      }\r\n\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Zoom the canvas with a relative ratio\r\n     *\r\n     * @param {Number} ratio\r\n     * @param {Event} _originalEvent (private)\r\n     */\r\n    zoom: function (ratio, _originalEvent) {\r\n      var canvasData = this.canvasData;\r\n\r\n      ratio = num(ratio);\r\n\r\n      if (ratio < 0) {\r\n        ratio =  1 / (1 - ratio);\r\n      } else {\r\n        ratio = 1 + ratio;\r\n      }\r\n\r\n      return this.zoomTo(canvasData.width * ratio / canvasData.naturalWidth, _originalEvent);\r\n    },\r\n\r\n    /**\r\n     * Zoom the canvas to an absolute ratio\r\n     *\r\n     * @param {Number} ratio\r\n     * @param {Event} _originalEvent (private)\r\n     */\r\n    zoomTo: function (ratio, _originalEvent) {\r\n      var options = this.options;\r\n      var canvasData = this.canvasData;\r\n      var width = canvasData.width;\r\n      var height = canvasData.height;\r\n      var naturalWidth = canvasData.naturalWidth;\r\n      var naturalHeight = canvasData.naturalHeight;\r\n      var newWidth;\r\n      var newHeight;\r\n\r\n      ratio = num(ratio);\r\n\r\n      if (ratio >= 0 && this.isBuilt && !this.isDisabled && options.zoomable) {\r\n        newWidth = naturalWidth * ratio;\r\n        newHeight = naturalHeight * ratio;\r\n\r\n        if (isFunction(options.zoom) && options.zoom.call(this.element, {\r\n          originalEvent: _originalEvent,\r\n          oldRatio: width / naturalWidth,\r\n          ratio: newWidth / naturalWidth\r\n        }) === false) {\r\n          return this;\r\n        }\r\n\r\n        canvasData.left -= (newWidth - width) / 2;\r\n        canvasData.top -= (newHeight - height) / 2;\r\n        canvasData.width = newWidth;\r\n        canvasData.height = newHeight;\r\n        this.renderCanvas(true);\r\n      }\r\n\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Rotate the canvas with a relative degree\r\n     *\r\n     * @param {Number} degree\r\n     */\r\n    rotate: function (degree) {\r\n      return this.rotateTo((this.imageData.rotate || 0) + num(degree));\r\n    },\r\n\r\n    /**\r\n     * Rotate the canvas to an absolute degree\r\n     * https://developer.mozilla.org/en-US/docs/Web/CSS/transform-function#rotate()\r\n     *\r\n     * @param {Number} degree\r\n     */\r\n    rotateTo: function (degree) {\r\n      degree = num(degree);\r\n\r\n      if (isNumber(degree) && this.isBuilt && !this.isDisabled && this.options.rotatable) {\r\n        this.imageData.rotate = degree % 360;\r\n        this.isRotated = true;\r\n        this.renderCanvas(true);\r\n      }\r\n\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Scale the image\r\n     * https://developer.mozilla.org/en-US/docs/Web/CSS/transform-function#scale()\r\n     *\r\n     * @param {Number} scaleX\r\n     * @param {Number} scaleY (optional)\r\n     */\r\n    scale: function (scaleX, scaleY) {\r\n      var imageData = this.imageData;\r\n      var isChanged = false;\r\n\r\n      // If \"scaleY\" is not present, its default value is \"scaleX\"\r\n      if (isUndefined(scaleY)) {\r\n        scaleY = scaleX;\r\n      }\r\n\r\n      scaleX = num(scaleX);\r\n      scaleY = num(scaleY);\r\n\r\n      if (this.isBuilt && !this.isDisabled && this.options.scalable) {\r\n        if (isNumber(scaleX)) {\r\n          imageData.scaleX = scaleX;\r\n          isChanged = true;\r\n        }\r\n\r\n        if (isNumber(scaleY)) {\r\n          imageData.scaleY = scaleY;\r\n          isChanged = true;\r\n        }\r\n\r\n        if (isChanged) {\r\n          this.renderImage(true);\r\n        }\r\n      }\r\n\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Scale the abscissa of the image\r\n     *\r\n     * @param {Number} scaleX\r\n     */\r\n    scaleX: function (scaleX) {\r\n      var scaleY = this.imageData.scaleY;\r\n\r\n      return this.scale(scaleX, isNumber(scaleY) ? scaleY : 1);\r\n    },\r\n\r\n    /**\r\n     * Scale the ordinate of the image\r\n     *\r\n     * @param {Number} scaleY\r\n     */\r\n    scaleY: function (scaleY) {\r\n      var scaleX = this.imageData.scaleX;\r\n\r\n      return this.scale(isNumber(scaleX) ? scaleX : 1, scaleY);\r\n    },\r\n\r\n    /**\r\n     * Get the cropped area position and size data (base on the original image)\r\n     *\r\n     * @param {Boolean} isRounded (optional)\r\n     * @return {Object} data\r\n     */\r\n    getData: function (isRounded) {\r\n      var options = this.options;\r\n      var imageData = this.imageData;\r\n      var canvasData = this.canvasData;\r\n      var cropBoxData = this.cropBoxData;\r\n      var ratio;\r\n      var data;\r\n\r\n      if (this.isBuilt && this.isCropped) {\r\n        data = {\r\n          x: cropBoxData.left - canvasData.left,\r\n          y: cropBoxData.top - canvasData.top,\r\n          width: cropBoxData.width,\r\n          height: cropBoxData.height\r\n        };\r\n\r\n        ratio = imageData.width / imageData.naturalWidth;\r\n\r\n        each(data, function (n, i) {\r\n          n = n / ratio;\r\n          data[i] = isRounded ? round(n) : n;\r\n        });\r\n\r\n      } else {\r\n        data = {\r\n          x: 0,\r\n          y: 0,\r\n          width: 0,\r\n          height: 0\r\n        };\r\n      }\r\n\r\n      if (options.rotatable) {\r\n        data.rotate = imageData.rotate || 0;\r\n      }\r\n\r\n      if (options.scalable) {\r\n        data.scaleX = imageData.scaleX || 1;\r\n        data.scaleY = imageData.scaleY || 1;\r\n      }\r\n\r\n      return data;\r\n    },\r\n\r\n    /**\r\n     * Set the cropped area position and size with new data\r\n     *\r\n     * @param {Object} data\r\n     */\r\n    setData: function (data) {\r\n      var options = this.options;\r\n      var imageData = this.imageData;\r\n      var canvasData = this.canvasData;\r\n      var cropBoxData = {};\r\n      var isRotated;\r\n      var isScaled;\r\n      var ratio;\r\n\r\n      if (isFunction(data)) {\r\n        data = data.call(this.element);\r\n      }\r\n\r\n      if (this.isBuilt && !this.isDisabled && isPlainObject(data)) {\r\n        if (options.rotatable) {\r\n          if (isNumber(data.rotate) && data.rotate !== imageData.rotate) {\r\n            imageData.rotate = data.rotate;\r\n            this.isRotated = isRotated = true;\r\n          }\r\n        }\r\n\r\n        if (options.scalable) {\r\n          if (isNumber(data.scaleX) && data.scaleX !== imageData.scaleX) {\r\n            imageData.scaleX = data.scaleX;\r\n            isScaled = true;\r\n          }\r\n\r\n          if (isNumber(data.scaleY) && data.scaleY !== imageData.scaleY) {\r\n            imageData.scaleY = data.scaleY;\r\n            isScaled = true;\r\n          }\r\n        }\r\n\r\n        if (isRotated) {\r\n          this.renderCanvas();\r\n        } else if (isScaled) {\r\n          this.renderImage();\r\n        }\r\n\r\n        ratio = imageData.width / imageData.naturalWidth;\r\n\r\n        if (isNumber(data.x)) {\r\n          cropBoxData.left = data.x * ratio + canvasData.left;\r\n        }\r\n\r\n        if (isNumber(data.y)) {\r\n          cropBoxData.top = data.y * ratio + canvasData.top;\r\n        }\r\n\r\n        if (isNumber(data.width)) {\r\n          cropBoxData.width = data.width * ratio;\r\n        }\r\n\r\n        if (isNumber(data.height)) {\r\n          cropBoxData.height = data.height * ratio;\r\n        }\r\n\r\n        this.setCropBoxData(cropBoxData);\r\n      }\r\n\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Get the container size data\r\n     *\r\n     * @return {Object} data\r\n     */\r\n    getContainerData: function () {\r\n      return this.isBuilt ? this.containerData : {};\r\n    },\r\n\r\n    /**\r\n     * Get the image position and size data\r\n     *\r\n     * @return {Object} data\r\n     */\r\n    getImageData: function () {\r\n      return this.isLoaded ? this.imageData : {};\r\n    },\r\n\r\n    /**\r\n     * Get the canvas position and size data\r\n     *\r\n     * @return {Object} data\r\n     */\r\n    getCanvasData: function () {\r\n      var canvasData = this.canvasData;\r\n      var data = {};\r\n\r\n      if (this.isBuilt) {\r\n        each([\r\n          'left',\r\n          'top',\r\n          'width',\r\n          'height',\r\n          'naturalWidth',\r\n          'naturalHeight'\r\n        ], function (n) {\r\n          data[n] = canvasData[n];\r\n        });\r\n      }\r\n\r\n      return data;\r\n    },\r\n\r\n    /**\r\n     * Set the canvas position and size with new data\r\n     *\r\n     * @param {Object} data\r\n     */\r\n    setCanvasData: function (data) {\r\n      var canvasData = this.canvasData;\r\n      var aspectRatio = canvasData.aspectRatio;\r\n\r\n      if (isFunction(data)) {\r\n        data = data.call(this.element);\r\n      }\r\n\r\n      if (this.isBuilt && !this.isDisabled && isPlainObject(data)) {\r\n        if (isNumber(data.left)) {\r\n          canvasData.left = data.left;\r\n        }\r\n\r\n        if (isNumber(data.top)) {\r\n          canvasData.top = data.top;\r\n        }\r\n\r\n        if (isNumber(data.width)) {\r\n          canvasData.width = data.width;\r\n          canvasData.height = data.width / aspectRatio;\r\n        } else if (isNumber(data.height)) {\r\n          canvasData.height = data.height;\r\n          canvasData.width = data.height * aspectRatio;\r\n        }\r\n\r\n        this.renderCanvas(true);\r\n      }\r\n\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Get the crop box position and size data\r\n     *\r\n     * @return {Object} data\r\n     */\r\n    getCropBoxData: function () {\r\n      var cropBoxData = this.cropBoxData;\r\n      var data;\r\n\r\n      if (this.isBuilt && this.isCropped) {\r\n        data = {\r\n          left: cropBoxData.left,\r\n          top: cropBoxData.top,\r\n          width: cropBoxData.width,\r\n          height: cropBoxData.height\r\n        };\r\n      }\r\n\r\n      return data || {};\r\n    },\r\n\r\n    /**\r\n     * Set the crop box position and size with new data\r\n     *\r\n     * @param {Object} data\r\n     */\r\n    setCropBoxData: function (data) {\r\n      var cropBoxData = this.cropBoxData;\r\n      var aspectRatio = this.options.aspectRatio;\r\n      var isWidthChanged;\r\n      var isHeightChanged;\r\n\r\n      if (isFunction(data)) {\r\n        data = data.call(this.element);\r\n      }\r\n\r\n      if (this.isBuilt && this.isCropped && !this.isDisabled && isPlainObject(data)) {\r\n\r\n        if (isNumber(data.left)) {\r\n          cropBoxData.left = data.left;\r\n        }\r\n\r\n        if (isNumber(data.top)) {\r\n          cropBoxData.top = data.top;\r\n        }\r\n\r\n        if (isNumber(data.width) && data.width !== cropBoxData.width) {\r\n          isWidthChanged = true;\r\n          cropBoxData.width = data.width;\r\n        }\r\n\r\n        if (isNumber(data.height) && data.height !== cropBoxData.height) {\r\n          isHeightChanged = true;\r\n          cropBoxData.height = data.height;\r\n        }\r\n\r\n        if (aspectRatio) {\r\n          if (isWidthChanged) {\r\n            cropBoxData.height = cropBoxData.width / aspectRatio;\r\n          } else if (isHeightChanged) {\r\n            cropBoxData.width = cropBoxData.height * aspectRatio;\r\n          }\r\n        }\r\n\r\n        this.renderCropBox();\r\n      }\r\n\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Get a canvas drawn the cropped image\r\n     *\r\n     * @param {Object} options (optional)\r\n     * @return {HTMLCanvasElement} canvas\r\n     */\r\n    getCroppedCanvas: function (options) {\r\n      var originalWidth;\r\n      var originalHeight;\r\n      var canvasWidth;\r\n      var canvasHeight;\r\n      var scaledWidth;\r\n      var scaledHeight;\r\n      var scaledRatio;\r\n      var aspectRatio;\r\n      var canvas;\r\n      var context;\r\n      var data;\r\n\r\n      if (!this.isBuilt || !this.isCropped || !SUPPORT_CANVAS) {\r\n        return;\r\n      }\r\n\r\n      if (!isPlainObject(options)) {\r\n        options = {};\r\n      }\r\n\r\n      data = this.getData();\r\n      originalWidth = data.width;\r\n      originalHeight = data.height;\r\n      aspectRatio = originalWidth / originalHeight;\r\n\r\n      if (isPlainObject(options)) {\r\n        scaledWidth = options.width;\r\n        scaledHeight = options.height;\r\n\r\n        if (scaledWidth) {\r\n          scaledHeight = scaledWidth / aspectRatio;\r\n          scaledRatio = scaledWidth / originalWidth;\r\n        } else if (scaledHeight) {\r\n          scaledWidth = scaledHeight * aspectRatio;\r\n          scaledRatio = scaledHeight / originalHeight;\r\n        }\r\n      }\r\n\r\n      // The canvas element will use `Math.floor` on a float number, so round first\r\n      canvasWidth = round(scaledWidth || originalWidth);\r\n      canvasHeight = round(scaledHeight || originalHeight);\r\n\r\n      canvas = document.createElement('canvas');\r\n      canvas.width = canvasWidth;\r\n      canvas.height = canvasHeight;\r\n      context = canvas.getContext('2d');\r\n\r\n      if (options.fillColor) {\r\n        context.fillStyle = options.fillColor;\r\n        context.fillRect(0, 0, canvasWidth, canvasHeight);\r\n      }\r\n\r\n      // https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D.drawImage\r\n      context.drawImage.apply(context, (function () {\r\n        var source = getSourceCanvas(this.image, this.imageData);\r\n        var sourceWidth = source.width;\r\n        var sourceHeight = source.height;\r\n        var args = [source];\r\n\r\n        // Source canvas\r\n        var srcX = data.x;\r\n        var srcY = data.y;\r\n        var srcWidth;\r\n        var srcHeight;\r\n\r\n        // Destination canvas\r\n        var dstX;\r\n        var dstY;\r\n        var dstWidth;\r\n        var dstHeight;\r\n\r\n        if (srcX <= -originalWidth || srcX > sourceWidth) {\r\n          srcX = srcWidth = dstX = dstWidth = 0;\r\n        } else if (srcX <= 0) {\r\n          dstX = -srcX;\r\n          srcX = 0;\r\n          srcWidth = dstWidth = min(sourceWidth, originalWidth + srcX);\r\n        } else if (srcX <= sourceWidth) {\r\n          dstX = 0;\r\n          srcWidth = dstWidth = min(originalWidth, sourceWidth - srcX);\r\n        }\r\n\r\n        if (srcWidth <= 0 || srcY <= -originalHeight || srcY > sourceHeight) {\r\n          srcY = srcHeight = dstY = dstHeight = 0;\r\n        } else if (srcY <= 0) {\r\n          dstY = -srcY;\r\n          srcY = 0;\r\n          srcHeight = dstHeight = min(sourceHeight, originalHeight + srcY);\r\n        } else if (srcY <= sourceHeight) {\r\n          dstY = 0;\r\n          srcHeight = dstHeight = min(originalHeight, sourceHeight - srcY);\r\n        }\r\n\r\n        args.push(floor(srcX), floor(srcY), floor(srcWidth), floor(srcHeight));\r\n\r\n        // Scale destination sizes\r\n        if (scaledRatio) {\r\n          dstX *= scaledRatio;\r\n          dstY *= scaledRatio;\r\n          dstWidth *= scaledRatio;\r\n          dstHeight *= scaledRatio;\r\n        }\r\n\r\n        // Avoid \"IndexSizeError\" in IE and Firefox\r\n        if (dstWidth > 0 && dstHeight > 0) {\r\n          args.push(floor(dstX), floor(dstY), floor(dstWidth), floor(dstHeight));\r\n        }\r\n\r\n        return args;\r\n      }).call(this));\r\n\r\n      return canvas;\r\n    },\r\n\r\n    /**\r\n     * Change the aspect ratio of the crop box\r\n     *\r\n     * @param {Number} aspectRatio\r\n     */\r\n    setAspectRatio: function (aspectRatio) {\r\n      var options = this.options;\r\n\r\n      if (!this.isDisabled && !isUndefined(aspectRatio)) {\r\n\r\n        // 0 -> NaN\r\n        options.aspectRatio = max(0, aspectRatio) || NaN;\r\n\r\n        if (this.isBuilt) {\r\n          this.initCropBox();\r\n\r\n          if (this.isCropped) {\r\n            this.renderCropBox();\r\n          }\r\n        }\r\n      }\r\n\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Change the drag mode\r\n     *\r\n     * @param {String} mode (optional)\r\n     */\r\n    setDragMode: function (mode) {\r\n      var options = this.options;\r\n      var dragBox = this.dragBox;\r\n      var face = this.face;\r\n      var croppable;\r\n      var movable;\r\n\r\n      if (this.isLoaded && !this.isDisabled) {\r\n        croppable = mode === ACTION_CROP;\r\n        movable = options.movable && mode === ACTION_MOVE;\r\n        mode = (croppable || movable) ? mode : ACTION_NONE;\r\n\r\n        setData(dragBox, DATA_ACTION, mode);\r\n        toggleClass(dragBox, CLASS_CROP, croppable);\r\n        toggleClass(dragBox, CLASS_MOVE, movable);\r\n\r\n        if (!options.cropBoxMovable) {\r\n\r\n          // Sync drag mode to crop box when it is not movable\r\n          setData(face, DATA_ACTION, mode);\r\n          toggleClass(face, CLASS_CROP, croppable);\r\n          toggleClass(face, CLASS_MOVE, movable);\r\n        }\r\n      }\r\n\r\n      return this;\r\n    }\r\n  });\r\n","  extend(Cropper.prototype, prototype);\r\n","  Cropper.DEFAULTS = {\r\n\r\n    // Define the view mode of the cropper\r\n    viewMode: 0, // 0, 1, 2, 3\r\n\r\n    // Define the dragging mode of the cropper\r\n    dragMode: 'crop', // 'crop', 'move' or 'none'\r\n\r\n    // Define the aspect ratio of the crop box\r\n    aspectRatio: NaN,\r\n\r\n    // An object with the previous cropping result data\r\n    data: null,\r\n\r\n    // A selector for adding extra containers to preview\r\n    preview: '',\r\n\r\n    // Re-render the cropper when resize the window\r\n    responsive: true,\r\n\r\n    // Restore the cropped area after resize the window\r\n    restore: true,\r\n\r\n    // Check if the current image is a cross-origin image\r\n    checkCrossOrigin: true,\r\n\r\n    // Check the current image's Exif Orientation information\r\n    checkOrientation: true,\r\n\r\n    // Show the black modal\r\n    modal: true,\r\n\r\n    // Show the dashed lines for guiding\r\n    guides: true,\r\n\r\n    // Show the center indicator for guiding\r\n    center: true,\r\n\r\n    // Show the white modal to highlight the crop box\r\n    highlight: true,\r\n\r\n    // Show the grid background\r\n    background: true,\r\n\r\n    // Enable to crop the image automatically when initialize\r\n    autoCrop: true,\r\n\r\n    // Define the percentage of automatic cropping area when initializes\r\n    autoCropArea: 0.8,\r\n\r\n    // Enable to move the image\r\n    movable: true,\r\n\r\n    // Enable to rotate the image\r\n    rotatable: true,\r\n\r\n    // Enable to scale the image\r\n    scalable: true,\r\n\r\n    // Enable to zoom the image\r\n    zoomable: true,\r\n\r\n    // Enable to zoom the image by dragging touch\r\n    zoomOnTouch: true,\r\n\r\n    // Enable to zoom the image by wheeling mouse\r\n    zoomOnWheel: true,\r\n\r\n    // Define zoom ratio when zoom the image by wheeling mouse\r\n    wheelZoomRatio: 0.1,\r\n\r\n    // Enable to move the crop box\r\n    cropBoxMovable: true,\r\n\r\n    // Enable to resize the crop box\r\n    cropBoxResizable: true,\r\n\r\n    // Toggle drag mode between \"crop\" and \"move\" when click twice on the cropper\r\n    toggleDragModeOnDblclick: true,\r\n\r\n    // Size limitation\r\n    minCanvasWidth: 0,\r\n    minCanvasHeight: 0,\r\n    minCropBoxWidth: 0,\r\n    minCropBoxHeight: 0,\r\n    minContainerWidth: 200,\r\n    minContainerHeight: 100,\r\n\r\n    // Shortcuts of events\r\n    build: null,\r\n    built: null,\r\n    cropstart: null,\r\n    cropmove: null,\r\n    cropend: null,\r\n    crop: null,\r\n    zoom: null\r\n  };\r\n","  Cropper.TEMPLATE = (\r\n    '<div class=\"cropper-container\">' +\r\n      '<div class=\"cropper-wrap-box\">' +\r\n        '<div class=\"cropper-canvas\"></div>' +\r\n      '</div>' +\r\n      '<div class=\"cropper-drag-box\"></div>' +\r\n      '<div class=\"cropper-crop-box\">' +\r\n        '<span class=\"cropper-view-box\"></span>' +\r\n        '<span class=\"cropper-dashed dashed-h\"></span>' +\r\n        '<span class=\"cropper-dashed dashed-v\"></span>' +\r\n        '<span class=\"cropper-center\"></span>' +\r\n        '<span class=\"cropper-face\"></span>' +\r\n        '<span class=\"cropper-line line-e\" data-action=\"e\"></span>' +\r\n        '<span class=\"cropper-line line-n\" data-action=\"n\"></span>' +\r\n        '<span class=\"cropper-line line-w\" data-action=\"w\"></span>' +\r\n        '<span class=\"cropper-line line-s\" data-action=\"s\"></span>' +\r\n        '<span class=\"cropper-point point-e\" data-action=\"e\"></span>' +\r\n        '<span class=\"cropper-point point-n\" data-action=\"n\"></span>' +\r\n        '<span class=\"cropper-point point-w\" data-action=\"w\"></span>' +\r\n        '<span class=\"cropper-point point-s\" data-action=\"s\"></span>' +\r\n        '<span class=\"cropper-point point-ne\" data-action=\"ne\"></span>' +\r\n        '<span class=\"cropper-point point-nw\" data-action=\"nw\"></span>' +\r\n        '<span class=\"cropper-point point-sw\" data-action=\"sw\"></span>' +\r\n        '<span class=\"cropper-point point-se\" data-action=\"se\"></span>' +\r\n      '</div>' +\r\n    '</div>'\r\n  );\r\n","  var _Cropper = window.Cropper;\r\n\r\n  Cropper.noConflict = function () {\r\n    window.Cropper = _Cropper;\r\n    return Cropper;\r\n  };\r\n\r\n  Cropper.setDefaults = function (options) {\r\n    extend(Cropper.DEFAULTS, options);\r\n  };\r\n","  if (typeof define === 'function' && define.amd) {\r\n    define('cropper', [], function () {\r\n      return Cropper;\r\n    });\r\n  }\r\n\r\n  if (typeof noGlobal === 'undefined') {\r\n    window.Cropper = Cropper;\r\n  }\r\n\r\n  return Cropper;\r\n\r\n});\r\n"],"sourceRoot":"/source/"}