fdb-core.js:1: WARNING - Suspicious code. The result of the 'not' operator is not being used.
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n;"undefined"!=typeof window?n=window:"undefined"!=typeof global?n=global:"undefined"!=typeof self&&(n=self),n.ForerunnerDB=e()}}(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
^

0 error(s), 1 warning(s)
function n(F){throw F;}var q=void 0,r=!0,y=!1;
function C(){return function p(s,a,l){function e(f,g){if(!a[f]){if(!s[f]){var c="function"==typeof require&&require;if(!g&&c)return c(f,r);if(b)return b(f,r);c=Error("Cannot find module '"+f+"'");n((c.code="MODULE_NOT_FOUND",c))}c=a[f]={d:{}};s[f][0].call(c.d,function(c){var b=s[f][1][c];return e(b?b:c)},c,c.d,p,s,a,l)}return a[f].d}for(var b="function"==typeof require&&require,f=0;f<l.length;f++)e(l[f]);return e}({1:[function(p,s){var a=p("../lib/Core");s.d=a},{"../lib/Core":3}],2:[function(p,s){function a(c){this.f.apply(this,
arguments)}var l,e,b,f,h,g;l=p("./Shared");a.prototype.f=function(c){this.b="_id";this.k=new h("primary");this.Y=new h("primaryCrc");this.V=new h("crcLookup");this.t=c;this.a=[];this.Eb=[];this.X=new f;this.p=0;this.c={};this.B={e:[],update:[],remove:[],w:[]};this.W={e:100,update:100,remove:100,w:100};this.Oa={e:1,update:1,remove:1,w:1};this.wa(this)};l.s.ub=a;b=p("./Overload");f=p("./Metrics");h=p("./KeyValueStore");g=p("./Path");p("./Index");p("./Crc");e=l.s.La;a.prototype.debug=new b([function(){return this.c.all},
function(c){if(c!==q){if("boolean"===typeof c){this.c.all=c;for(var d=0;d<this.z.length;d++)this.z[d].debug(c);return this}return this.c[c]||this.g&&this.g.c&&this.g.c[c]||this.c.all}return this.c.all},function(c,d){if(c!==q){if(d!==q){this.c[c]=d;for(var b=0;b<this.z.length;b++)this.z[b].debug(c,d);return this}return this.c[c]||this.g&&this.g.c&&this.g.c[c]}return this.c.all}]);a.prototype.name=function(c){return c!==q?(this.t=c,this):this.t};a.prototype.u=function(c,d){this.q=this.q||{};if(c in
this.q){if(this.q[c]["*"]){var b=this.q[c]["*"],t=b.length,x;for(x=0;x<t;x++)b[x].apply(this,Array.prototype.slice.call(arguments,1))}if(d instanceof Array&&d[0]&&d[0][this.b]){var b=this.q[c],a,e,t=d.length;for(x=0;x<t;x++)if(b[d[x][this.b]]){a=b[d[x][this.b]].length;for(e=0;e<a;e++)b[d[x][this.b]][e].apply(this,Array.prototype.slice.call(arguments,1))}}}return this};a.prototype.primaryKey=function(c){return c!==q?(this.b=c,this.k.primaryKey(c),this.ua(),this):this.b};a.prototype.Ua=function(c,d){this.u("insert",
c,d)};a.prototype.Wa=function(c){this.u("update",c)};a.prototype.Va=function(c){this.u("remove",c)};a.prototype.db=function(c){return c!==q?(this.g=c,this):this.g};a.prototype.setData=function(c,d,b){if(c){var t=this.X.create("setData");t.start();c instanceof Array||(c=[c]);t.time("transformIn");c=this.ga(c);t.time("transformIn");var x=this.a;this.a=[];c.length&&(this.a=this.a.concat(c));t.time("_rebuildPrimaryKeyIndex");this.ua(d);t.time("_rebuildPrimaryKeyIndex");t.stop();this.u("setData",this.a,
x)}b&&b(y);return this};a.prototype.ua=function(c){var d=c&&c.gb!==q?c.gb:r;c=c&&c.sb!==q?c.sb:r;var b,t,x,a=this.k,e=this.Y,f=this.V,h=this.b,g;a.truncate();e.truncate();f.truncate();b=this.a;for(t=b.length;t--;)x=b[t],d&&this.na(x),c?a.J(x[h],x)||n("Call to setData failed because your data violates the primary key unique constraint. One or more documents are using the same primary key: "+x[this.b]):(g=JSON.stringify(x),a.set(x[h],x),e.set(x[h],g),f.set(g,x))};a.prototype.na=function(c){c[this.b]===
q&&(c[this.b]=this.Ga())};a.prototype.truncate=function(){this.u("truncate",this.a);this.a.length=0;this.P("change");return this};a.prototype.w=function(c,d){if(c){var b=this.B.w,t=this.W.w,a={},e;if(c instanceof Array){if(c.length>t){this.B.w=b.concat(c);this.ea("upsert",d);return}a=[];for(b=0;b<c.length;b++)a.push(this.w(c[b]));d&&d();return a}c[this.b]?(e={},e[this.b]=c[this.b],this.count(e)?a.da="update":a.da="insert"):a.da="insert";switch(a.da){case "insert":a.result=this.e(c);break;case "update":a.result=
this.update(e,c)}return a}d&&d()};a.prototype.update=function(c,d,b){function t(t){if(d&&d[f]!==q&&d[f]!=t[f]){a.k.T(t[f]);var e=a.F(t,d,c,b,"");if(a.k.J(t[f],t))return e;n("Primary key violation in update! Key violated: "+t[f])}return a.F(t,d,c,b,"")}d=this.l(d);d=this.ga(d);this.debug()&&console.log('Updating some collection data for collection "'+this.name()+'"');var a=this,e=this.X.create("update"),f=this.b,h,g,u=this.z;e.start();e.time("Retrieve documents to update");h=this.find(c,{l:y});e.time("Retrieve documents to update");
if(h.length&&(e.time("Update documents"),g=h.filter(t),e.time("Update documents"),g.length)){if(u&&u.length){this.debug("views")&&console.log("Updating views from collection: "+this.name());e.time("Inform views of update");for(h=0;h<u.length;h++)u[h].update(c,d);e.time("Inform views of update")}this.Wa(g);this.P("change",{type:"update",data:g})}e.stop();return g||[]};a.prototype.F=function(c,d,b,t,a){d=this.l(d);a=a||"";"."===a.substr(0,1)&&(a=a.substr(1,a.length-1));var e=y,f=y,h,v,u,k,m;for(k in d)if(d.hasOwnProperty(k)){h=
y;if("$"===k.substr(0,1))switch(k){case "$inc":h=r;for(m in d[k])d[k].hasOwnProperty(m)&&"$"!==m.substr(0,1)&&("number"===typeof c[m]?(this.Za(c,m,d[k][m]),e=r):n("Cannot increment field that is not a number! ("+m+")!"));break;case "$push":h=r;for(m in d[k])d[k].hasOwnProperty(m)&&"$"!==m.substr(0,1)&&(c[m]instanceof Array?(this.ya(c[m],d[k][m]),e=r):n("Cannot push to a key that is not an array! ("+m+")!"));break;case "$addToSet":h=r;for(m in d[k])if(d[k].hasOwnProperty(m)&&"$"!==m.substr(0,1))if(c[m]instanceof
Array){v=c[m];var l;u=v.length;var p,f=r;l=t&&t.tb;var s,z;l&&l.key?(s=y,z=new g(l.key),p=z.value(d[k][m])[0]):(p=JSON.stringify(d[k][m]),s=r);for(l=0;l<u;l++)if(s){if(JSON.stringify(v[l])===p){f=y;break}}else if(p===z.value(v[l])[0]){f=y;break}f&&(this.ya(c[m],d[k][m]),e=r)}else n("Cannot push to a key that is not an array! ("+m+")!");break;case "$splicePush":h=r;for(m in d[k])d[k].hasOwnProperty(m)&&"$"!==m.substr(0,1)&&(c[m]instanceof Array?(v=d[k].ia,v!==q?(delete d[k][m].ia,this.bb(c[m],v,d[k][m]),
e=r):n("Cannot splicePush without a $index integer value!")):n("Cannot splicePush with a key that is not an array! ("+m+")!"));break;case "$move":h=r;for(m in d[k])if(d[k].hasOwnProperty(m)&&"$"!==m.substr(0,1))if(c[m]instanceof Array)for(u=0;u<c[m].length;u++){if(this.h(c[m][u],d[k][m])){v=d[k].ia;v!==q?(this.ab(c[m],u,v),e=r):n("Cannot move without a $index integer value!");break}}else n("Cannot pull from a key that is not an array! ("+m+")!");break;case "$pull":for(m in h=r,d[k])if(d[k].hasOwnProperty(m)&&
"$"!==m.substr(0,1))if(c[m]instanceof Array){v=[];for(u=0;u<c[m].length;u++)this.h(c[m][u],d[k][m])&&v.push(u);for(u=v.length;u--;)this.$a(c[m],v[u]),e=r}else n("Cannot pull from a key that is not an array! ("+m+")!")}if(".$"===k.substr(k.length-2,2)&&(h=r,k=k.substr(0,k.length-2),f=new g(a+"."+k),c[k]&&c[k]instanceof Array&&c[k].length)){v=[];for(u=0;u<c[k].length;u++)this.h(c[k][u],f.value(b)[0])&&v.push(u);for(u=0;u<v.length;u++)(f=this.F(c[k][v[u]],d[k+".$"],b,t,a+"."+k))&&(e=r)}if(!h)if("object"===
typeof d[k])if(null!==c[k]&&"object"===typeof c[k])if(h=c[k]instanceof Array,v=d[k]instanceof Array,h||v)if(!v&&h)for(u=0;u<c[k].length;u++)(f=this.F(c[k][u],d[k],b,t,a+"."+k))&&(e=r);else this.aa(c,k,d[k]),e=r;else(f=this.F(c[k],d[k],b,t,a+"."+k))&&(e=r);else this.aa(c,k,d[k]),e=r;else c[k]!==d[k]&&(this.aa(c,k,d[k]),e=r)}return e};a.prototype.aa=function(c,d,b){this.p?($.v(c).setProperty(d,b),this.debug()&&console.log('ForerunnerDB.Collection: Setting data-bound document property "'+d+'" for collection "'+
this.name()+'"')):(c[d]=b,this.debug()&&console.log('ForerunnerDB.Collection: Setting non-data-bound document property "'+d+'" for collection "'+this.name()+'"'))};a.prototype.ab=function(c,d,b){this.p?($.v(c).move(d,b),this.debug()&&console.log('ForerunnerDB.Collection: Moving data-bound document array index from "'+d+'" to "'+b+'" for collection "'+this.name()+'"')):(c.splice(b,0,c.splice(d,1)[0]),this.debug()&&console.log('ForerunnerDB.Collection: Moving non-data-bound document array index from "'+
d+'" to "'+b+'" for collection "'+this.name()+'"'))};a.prototype.bb=function(c,d,b){c.length>d?this.p?$.v(c).e(d,b):c.splice(d,0,b):this.p?$.v(c).e(b):c.push(b)};a.prototype.ya=function(c,d){this.p?$.v(c).e(d):c.push(d)};a.prototype.$a=function(c,d){this.p?$.v(c).remove(d):c.splice(d,1)};a.prototype.Za=function(c,d,b){this.p?$.v(c).setProperty(d,c[d]+b):c[d]+=b};a.prototype.remove=function(c){var d,b,t=this.z,a;if(c instanceof Array){t=[];for(d=0;d<c.length;d++)t.push(this.remove(c[d]));return t}d=
this.find(c,{l:y});if(d.length){for(a=0;a<d.length;a++)b=d[a],this.Xa(b),b=this.a.indexOf(b),this.p?$.v(this.a).remove(b):this.a.splice(b,1);if(t&&t.length)for(a=0;a<t.length;a++)t[a].remove(c);this.Va(d);this.P("change",{type:"remove",data:d})}return d};a.prototype.P=function(){var c=this,d;!this.Ta&&(!this.g||this.g&&!this.g.Ta)?(d=arguments,this.la&&clearTimeout(this.la),this.la=setTimeout(function(){c.debug()&&console.log("ForerunnerDB.Collection: Emitting "+d[0]);c.u.apply(c,d)},100)):this.u.apply(this,
arguments)};a.prototype.ea=function(c,d){var b=this.B[c],a=this.W[c],e=this.Oa[c];if(b.length){var f=this;b.length&&(b=b.length>a?b.splice(0,a):b.splice(0,b.length),this[c](b));setTimeout(function(){f.ea(c,d)},e)}else d&&d()};a.prototype.e=function(c,d,b){"function"===typeof d?(b=d,d=this.a.length):d===q&&(d=this.a.length);c=this.ga(c);return this.Qa(c,d,b)};a.prototype.Qa=function(c,d,b){var a=this.B.e,e=this.W.e,f=[],h=[],g=this.z;if(c instanceof Array){if(c.length>e){this.B.e=a.concat(c);this.ea("insert",
b);return}for(e=0;e<c.length;e++)a=this.pa(c[e],d+e),a===r?f.push(c[e]):h.push({fb:c[e],reason:a})}else a=this.pa(c,d),a===r?f.push(c):h.push({fb:c,reason:a});if(g&&g.length)for(a=0;a<g.length;a++)g[a].e(c,d);this.Ua(f,h);b&&b();this.P("change",{type:"insert",data:f});return{Kb:f,Jb:h}};a.prototype.pa=function(c,d){if(c){var b;this.na(c);if(b=this.hb(c))return"Index violation in index: "+b;this.Ra(c);this.p?$.v(this.a).e(d,c):this.a.splice(d,0,c);return r}return"No document passed to insert"};a.prototype.Ra=
function(c){var d=this.L,b,a=JSON.stringify(c);this.k.J(c[this.b],c);this.Y.J(c[this.b],a);this.V.J(a,c);for(b in d)d.hasOwnProperty(b)&&d[b].e(c)};a.prototype.Xa=function(c){var d=this.L,b,a=JSON.stringify(c);this.k.T(c[this.b]);this.Y.T(c[this.b]);this.V.T(a);for(b in d)d.hasOwnProperty(b)&&d[b].remove(c)};a.prototype.pb=function(c){c=this.find(c,q);(new a).wa(this).primaryKey(this.b).setData(c)};a.prototype.wa=function(c){this.Db=c;return this};a.prototype.l=function(c){return JSON.parse(JSON.stringify(c))};
a.prototype.find=function(c,d){function b(d){return e.h(d,c,"and")}c=c||{};d=d||{};d.l=d.l!==q?d.l:r;var a=this.X.create("find"),e=this,f,h=r,w,v,l,k,m,p,s,E,z,B=[];a.start();if(c){a.time("analyseQuery");f=this.Na(c,d,a);a.time("analyseQuery");a.data("analysis",f);if(f.Da&&f.Ia){a.time("joinReferences");for(v=0;v<f.ba.length;v++)k=f.ba[v],l=new g(f.Ea[k]),l=l.value(c)[0],this.g.O(f.ba[v]).pb(l);a.time("joinReferences")}f.m.length&&(!d||d&&!d.Pb)?(a.data("index.potential",f.m),a.data("index.used",
f.m[0].index),a.time("indexLookup"),w=f.m[0].r,a.time("indexLookup"),f.m[0].i.A===f.m[0].i.j&&(h=y)):a.H("usedIndex",y);h&&(w&&w.length?(f=w.length,a.time("tableScan: "+f),w=w.filter(b)):(f=this.a.length,a.time("tableScan: "+f),w=this.a.filter(b)),d.sort&&(a.time("sort"),w=this.sort(d.sort,w),a.time("sort")),a.time("tableScan: "+f));d.ca&&(w&&w.length>d.ca)&&(w.length=d.ca,a.data("limit",d.ca));d.l&&(a.time("decouple"),w=this.l(w),a.time("decouple"),a.data("flag.decouple",r));if(d.join){for(f=0;f<
d.join.length;f++)for(k in d.join[f])if(d.join[f].hasOwnProperty(k)){E=k;h=this.g.O(k);v=d.join[f][k];for(z=0;z<w.length;z++){p={};s=l=y;for(m in v)if(v.hasOwnProperty(m))if("$"===m.substr(0,1))switch(m){case "$as":E=v[m];break;case "$multi":l=v[m];break;case "$require":s=v[m]}else p[m]=(new g(v[m])).value(w[z])[0];p=h.find(p);!s||s&&p[0]?w[z][E]=l===y?p[0]:p:B.push(w[z])}}a.data("flag.join",r)}if(B.length){a.time("removalQueue");for(m=0;m<B.length;m++)k=w.indexOf(B[m]),-1<k&&w.splice(k,1);a.time("removalQueue")}if(d.transform){a.time("transform");
for(m=0;m<w.length;m++)w.splice(m,1,d.transform(w[m]));a.time("transform");a.data("flag.transform",r)}this.C&&this.D&&(a.time("transformOut"),w=this.qb(w),a.time("transformOut"));a.data("results",w.length);a.stop()}else a.stop(),w=[];w.Cb=a;return w};a.prototype.transform=function(c){return c!==q?("object"===typeof c?(c.enabled!==q&&(this.C=c.enabled),c.Ba!==q&&(this.N=c.Ba),c.Ca!==q&&(this.D=c.Ca)):this.C=c===y?y:r,this):{enabled:this.C,Ba:this.N,Ca:this.D}};a.prototype.ga=function(c){if(this.C&&
this.N){if(c instanceof Array){var d=[],b;for(b=0;b<c.length;b++)d[b]=this.N(c[b]);return d}return this.N(c)}return c};a.prototype.qb=function(c){if(this.C&&this.D){if(c instanceof Array){var d=[],b;for(b=0;b<c.length;b++)d[b]=this.D(c[b]);return d}return this.D(c)}return c};a.prototype.sort=function(c,d){d=d||[];var b=[],a,e;for(a in c)c.hasOwnProperty(a)&&(e={},e[a]=c[a],e.Ma=a,b.push(e));return 2>b.length?this.Z(c,d):this.ka(b,d)};a.prototype.ka=function(c,d){var b=c.shift(),a,e,f=[];if(0<c.length){d=
this.Z(b,d);a=this.cb(b.Ma,d);for(e in a)a.hasOwnProperty(e)&&(b=[].concat(c),f=f.concat(this.ka(b,a[e])));return f}return this.Z(b,d)};a.prototype.Z=function(c,b){var a=new g,e=a.parse(c,r)[0];a.path(e.path);return b.sort(1===e.value?function(c,b){var d=a.value(c)[0],e=a.value(b)[0];return"string"===typeof d&&"string"===typeof e?d.localeCompare(e):d>e?1:d<e?-1:0}:function(c,b){var d=a.value(c)[0],e=a.value(b)[0];return"string"===typeof d&&"string"===typeof e?1===d.localeCompare(e)?-1:1:d>e?-1:d<
e?1:0})};a.prototype.cb=function(c,b){var a,e={};for(a=0;a<b.length;a++)e[b[a][c]]=e[b[a][c]]||[],e[b[a][c]].push(b[a]);return e};a.prototype.Na=function(c,b,a){var e={Ja:[this.t],m:[],Da:y,Ia:y,Ea:{},Ob:c,options:b},f,h=[],A=[],l,p,u,k,m;a.time("checkIndexes");c[this.b]!==q&&(a.time("checkIndexMatch: Primary Key"),l=new g,e.m.push({r:this.k.r(c,b),i:{Fa:[this.b],j:1,A:l.za(c)},index:this.k}),a.time("checkIndexMatch: Primary Key"));for(m in this.oa)if(this.oa.hasOwnProperty(m)&&(p=this.oa[m],u=p.name(),
a.time("checkIndexMatch: "+u),l=p.match(c,b),k=p.r(c,b),0<l.j&&e.m.push({r:k,i:l,index:p}),a.time("checkIndexMatch: "+u),l.A===l.j))break;a.time("checkIndexes");1<e.m.length&&(a.time("findOptimalIndex"),e.m.sort(function(c,b){return c.i.A===c.i.j?-1:b.i.A===b.i.j?1:c.i.j===b.i.j?c.r.length-b.r.length:b.i.j-c.i.j}),a.time("findOptimalIndex"));if(b.join){e.Da=r;for(a=0;a<b.join.length;a++)for(f in b.join[a])b.join[a].hasOwnProperty(f)&&(h.push(f),"$as"in b.join[a][f]?A.push(b.join[a][f].$as):A.push(f));
for(f=0;f<A.length;f++)if(b=this.ta(c,A[f],""))e.Ea[h[f]]=b,e.Ia=r;e.ba=h;e.Ja=e.Ja.concat(h)}return e};a.prototype.ta=function(c,b,a){for(var e in c)if(c.hasOwnProperty(e)){if(e===b)return a&&(a+="."),a+e;if("object"===typeof c[e])return a&&(a+="."),a+=e,this.ta(c[e],b,a)}return y};a.prototype.h=function(c,b,a){var e,f;e=typeof c;f=typeof b;var h=r,g;if(("string"===e||"number"===e)&&("string"===f||"number"===f))c!==b&&(h=y);else for(g in b)if(b.hasOwnProperty(g)){e=y;if("$"===g.substr(0,1))switch(g){case "$gt":if(c>
b[g]){if("or"===a)return r}else h=y;e=r;break;case "$gte":if(c>=b[g]){if("or"===a)return r}else h=y;e=r;break;case "$lt":if(c<b[g]){if("or"===a)return r}else h=y;e=r;break;case "$lte":if(c<=b[g]){if("or"===a)return r}else h=y;e=r;break;case "$exists":if(c===q!==b[g]){if("or"===a)return r}else h=y;e=r;break;case "$or":e=r;for(f=0;f<b[g].length;f++){if(this.h(c,b[g][f],"and"))return r;h=y}break;case "$and":e=r;for(f=0;f<b[g].length;f++)if(!this.h(c,b[g][f],"and"))return y;break;case "$in":if(b[g]instanceof
Array){e=b[g];f=e.length;var l,p=y;for(l=0;l<f;l++)if(e[l]===c){p=r;break}if(p){if("or"===a)return r}else h=y}else n("Cannot use a $nin operator on a non-array key: "+g);e=r;break;case "$nin":if(b[g]instanceof Array){e=b[g];f=e.length;p=r;for(l=0;l<f;l++)if(e[l]===c){p=y;break}if(p){if("or"===a)return r}else h=y}else n("Cannot use a $nin operator on a non-array key: "+g);e=r;break;case "$ne":if(c!=b[g]){if("or"===a)return r}else h=y;e=r}if(!e&&b[g]instanceof RegExp)if(e=r,"object"===typeof c&&c[g]!==
q&&b[g].test(c[g])){if("or"===a)return r}else h=y;if(!e)if("object"===typeof b[g])if(c[g]!==q){if(c[g]instanceof Array&&!(b[g]instanceof Array)){e=y;for(f=0;f<c[g].length&&!(e=this.h(c[g][f],b[g],q));f++);}else if(!(c[g]instanceof Array)&&b[g]instanceof Array){e=y;for(f=0;f<b[g].length&&!(e=this.h(c[g],b[g][f],q));f++);}else e="object"===typeof c?this.h(c[g],b[g],q):this.h(q,b[g],q);if(e){if("or"===a)return r}else h=y}else if(b[g]&&b[g].$exists!==q)if(e=this.h(q,b[g],q)){if("or"===a)return r}else h=
y;else h=y;else if(c&&c[g]===b[g]){if("or"===a)return r}else if(c&&c[g]&&c[g]instanceof Array&&b[g]&&"object"!==typeof b[g]){e=y;for(f=0;f<c[g].length&&!(e=this.h(c[g][f],b[g],q));f++);if(e){if("or"===a)return r}else h=y}else h=y;if("and"===a&&!h)return y}return h};a.prototype.count=function(b,a){return b?this.find(b,a).length:this.a.length};a.prototype.hb=function(b){var a,e=this.L,f,h;if(this.k.get(b[this.b]))a=this.k;else for(f in e)if(e.hasOwnProperty(f)&&(h=e[f],h.unique()&&h.rb(b))){a=h;break}return a?
a.name():y};a.prototype.index=function(b){if(this.L)return this.L[b]};a.prototype.Ga=function(b){var a=Math.pow(10,17);if(b){var e=0,f=b.length,h;for(h=0;h<f;h++)e+=b.charCodeAt(h)*a;b=e.toString(16)}else l.Q++,b=(l.Q+(Math.random()*a+Math.random()*a+Math.random()*a+Math.random()*a)).toString(16);return b};e.prototype.O=function(b,e){if(b)return this.n[b]||this.debug()&&console.log("Creating collection "+b),this.n[b]=this.n[b]||(new a(b)).db(this),e!==q&&this.n[b].primaryKey(e),this.n[b];n("Cannot get collection with undefined name!")};
s.d=a},{"./Crc":4,"./Index":5,"./KeyValueStore":6,"./Metrics":7,"./Overload":9,"./Path":10,"./Shared":11}],3:[function(p,s){function a(){this.f.apply(this,arguments)}var l,e;l=p("./Shared.js");a.prototype.f=function(){this.n={};this.c={}};l.s.La=a;e=p("./Overload.js");p("./Collection.js");p("./Metrics.js");p("./Crc.js");a.prototype.l=function(b){return JSON.parse(JSON.stringify(b))};a.prototype.debug=new e([function(){return this.c.all},function(b){return b!==q&&"boolean"===typeof b?(this.c.all=b,
this):this.c.all},function(b,a){return b!==q?a!==q?(this.c[b]=a,this):this.c[b]:this.c.all}]);a.prototype.u=function(b,a){this.q=this.q||{};if(b in this.q){var e=this.q[b],g=e.length,c;for(c=0;c<g;c++)e[c].apply(this,Array.prototype.slice.call(arguments,1))}return this};a.prototype.Ga=function(b){var a,e,g=Math.pow(10,17),c;if(b){a=0;e=b.length;for(c=0;c<e;c++)a+=b.charCodeAt(c)*g;b=a.toString(16)}else l.Q++,b=(l.Q+(Math.random()*g+Math.random()*g+Math.random()*g+Math.random()*g)).toString(16);return b};
s.d=a},{"./Collection.js":2,"./Crc.js":4,"./Metrics.js":7,"./Overload.js":9,"./Shared.js":11}],4:[function(p,s){var a=function(){var a=[],e,b,f;for(b=0;256>b;b++){e=b;for(f=0;8>f;f++)e=e&1?3988292384^e>>>1:e>>>1;a[b]=e}return a}();s.d=function(l){var e=-1,b;for(b=0;b<l.length;b++)e=e>>>8^a[(e^l.charCodeAt(b))&255];return(e^-1)>>>0}},{}],5:[function(p,s){function a(){this.f.apply(this,arguments)}var l=p("./Shared"),e=p("./Path");a.prototype.f=function(b,a,e){this.K={};this.va=0;this.Pa=this.Sa(b,b);
this.data({});this.unique(a&&a.unique?a.unique:y);b!==q&&this.keys(b);e!==q&&this.O(e);this.name(a&&a.name?a.name:this.Pa)};l.s.wb=a;a.prototype.data=function(b){return b!==q?(this.a=b,this):this.a};a.prototype.name=function(b){return b!==q?(this.t=b,this):this.t};a.prototype.O=function(b){return b!==q?(this.n=b,this):this.n};a.prototype.keys=function(b){return b!==q?(this.o=b,this.Fb=(new e).parse(this.o).length,this):this.o};a.prototype.type=function(b){return b!==q?(this.Ya=b,this):this.Ya};a.prototype.unique=
function(b){return b!==q?(this.$=b,this):this.$};a.prototype.e=function(b){var a,e;this.$&&(a=this.M(b,this.o),this.xa[a]=b);a=this.qa(b,this.o);for(e=0;e<a.length;e++)this.nb(a[e],b)};a.prototype.remove=function(b){var a,e;this.$&&(a=this.M(b,this.o),delete this.xa[a]);a=this.qa(b,this.o);for(e=0;e<a.length;e++)this.lb(a[e],b)};a.prototype.rb=function(b){b=this.M(b,this.o);return Boolean(this.xa[b])};a.prototype.nb=function(b,a){var e=this.a[b]=this.a[b]||[];-1===e.indexOf(a)&&(e.push(a),this.va++,
this.mb(a,e))};a.prototype.lb=function(b,a){var e=this.a[b],g;g=e.indexOf(a);-1<g&&(e.splice(g,1),this.va--,this.kb(a));e.length||delete this.a[b]};a.prototype.mb=function(b,a){var e=b[this.n.primaryKey()];this.K[e]=this.K[e]||[];e=this.K[e];-1===e.indexOf(a)&&e.push(a)};a.prototype.kb=function(b){b=b[this.n.primaryKey()];delete this.K[b]};a.prototype.r=function(b){return this.a[this.M(b,this.o)]||[]};a.prototype.match=function(b){return(new e).Aa(this.o,b)};a.prototype.M=function(b,a){var h=new e,
g,c="",d;g=h.parse(a);for(d=0;d<g.length;d++)c&&(c+="_"),c+=h.value(b,g[d].path).join(":");return c};a.prototype.Sa=function(b,a){var h=new e,g,c="",d;g=h.parse(a);for(d=0;d<g.length;d++)c&&(c+="_"),c+=h.ib(b,g[d].path);return c};a.prototype.qa=function(b,a){var h=new e,g,c=[],d,l,p,s;g=h.parse(a);for(p=0;p<g.length;p++){d=h.value(b,g[p].path);for(l=0;l<d.length;l++)if(0===p)c.push(d[l]);else for(s=0;s<c.length;s++)c[s]=c[s]+"_"+d[l]}return c};s.d=a},{"./Path":10,"./Shared":11}],6:[function(p,s){function a(a){this.f.apply(this,
arguments)}var l=p("./Shared");a.prototype.f=function(a){this.t=a;this.a={};this.b="_id"};l.s.xb=a;a.prototype.name=function(a){return a!==q?(this.t=a,this):this.t};a.prototype.primaryKey=function(a){return a!==q?(this.b=a,this):this.b};a.prototype.truncate=function(){this.a={};return this};a.prototype.set=function(a,b){this.a[a]=b?b:r;return this};a.prototype.get=function(a){return this.a[a]};a.prototype.r=function(a){a=a[this.b];var b,f,h,g;if(a instanceof Array){f=a.length;g=[];for(b=0;b<f;b++)(h=
this.a[a[b]])&&g.push(h);return g}if(a instanceof RegExp){g=[];for(b in this.a)this.a.hasOwnProperty(b)&&a.test(b)&&g.push(this.a[b]);return g}if("object"===typeof a){if(a.Ka){g=[];for(b in this.a)this.a.hasOwnProperty(b)&&b!==a.Ka&&g.push(this.a[b]);return g}if(a.ha&&a.ha instanceof Array){g=[];for(b in this.a)this.a.hasOwnProperty(b)&&-1<a.ha.indexOf(b)&&g.push(this.a[b]);return g}if(a.ja&&a.ja instanceof Array){g=[];for(b in this.a)this.a.hasOwnProperty(b)&&-1===a.ja.indexOf(b)&&g.push(this.a[b]);
return g}if(a.U&&a.U instanceof Array){g=[];for(b=0;b<a.U.length;b++)g=g.concat(this.r(a.U[b]));return g}}else return h=this.a[a],h!==q?[h]:[]};a.prototype.T=function(a){delete this.a[a]};a.prototype.J=function(a,b){return this.a[a]===q?(this.a[a]=b,r):y};s.d=a},{"./Shared":11}],7:[function(p,s){function a(){this.f.apply(this,arguments)}var l=p("./Shared"),e=p("./Operation");a.prototype.f=function(){this.a=[]};l.s.yb=a;a.prototype.create=function(a){a=new e(a);this.ma&&this.a.push(a);return a};a.prototype.start=
function(){this.ma=r;return this};a.prototype.stop=function(){this.ma=y;return this};s.d=a},{"./Operation":8,"./Shared":11}],8:[function(p,s){function a(a){this.Ha=new e;this.Ib=0;this.f.apply(this,arguments)}var l=p("./Shared"),e=p("./Path");a.prototype.f=function(a){this.a={Lb:a,index:{Mb:[],Qb:y},ob:[],time:{I:0,R:0,S:0,jb:{}},H:{},log:[]}};l.s.zb=a;a.prototype.start=function(){this.a.time.I=(new Date).getTime()};a.prototype.log=function(a){if(a){var e=0<this.Gb.length?this.a.log[this.a.log.length-
1].time:0;a={event:a,time:(new Date).getTime(),eb:0};this.a.log.push(a);e&&(a.eb=a.time-e);return this}return this.a.log};a.prototype.time=function(a){if(a!==q){var e=this.a.time.jb,e=e[a]=e[a]||{};e.I?(e.R=(new Date).getTime(),e.S=e.R-e.I,e.fa.S=e.S,delete e.fa):(e.I=(new Date).getTime(),e.fa={name:a},this.a.ob.push(e.fa));return this}return this.a.time};a.prototype.H=function(a,e){if(a!==q&&e!==q)this.a.H[a]=e;else return a!==q?this.a.H[a]:this.a.H};a.prototype.data=function(a,e){return e!==q?(this.Ha.set(this.a,
a,e),this):this.Ha.get(this.a,a)};a.prototype.stop=function(){this.a.time.R=(new Date).getTime();this.a.time.S=this.a.time.R-this.a.time.I};s.d=a},{"./Path":10,"./Shared":11}],9:[function(p,s){function a(a){if(a){var e,b=a.length;return function(){for(e=0;e<b;e++)if(a[e].length===arguments.length)return a[e].apply(this,arguments);return null}}return function(){}}p("./Shared").s.Ab=a;s.d=a},{"./Shared":11}],10:[function(p,s){function a(a){this.f.apply(this,arguments)}var l=p("./Shared");a.prototype.f=
function(a){a&&this.path(a)};l.s.Bb=a;a.prototype.path=function(a){return a!==q?(this.ra=this.G(a),this.sa=this.ra.split("."),this):this.ra};a.prototype.za=function(a){var b=0,f;for(f in a)a.hasOwnProperty(f)&&a[f]!==q&&("object"!==typeof a[f]?b++:b+=this.za(a[f]));return b};a.prototype.Aa=function(a,b){var f,h={},g=0,c=0,d;for(d in b)b.hasOwnProperty(d)&&("object"===typeof b[d]?(f=this.Aa(a[d],b[d]),h[d]=f.Fa,c+=f.A,g+=f.j):(c++,a&&a[d]&&"object"!==typeof a[d]?(h[d]=r,g++):h[d]=y));return{Fa:h,j:g,
A:c}};a.prototype.parse=function(a,b){var f=[],h="",g,c,d;for(c in a)if(a.hasOwnProperty(c))if(h=c,"object"===typeof a[c])if(b){g=this.parse(a[c],b);for(d=0;d<g.length;d++)f.push({path:h+"."+g[d].path,value:g[d].value})}else{g=this.parse(a[c]);for(d=0;d<g.length;d++)f.push({path:h+"."+g[d].path})}else b?f.push({path:h,value:a[c]}):f.push({path:h});return f};a.prototype.value=function(a,b){if(a!==q&&"object"===typeof a){var f,h,g,c,d=[],l;b!==q&&(b=this.G(b),f=b.split("."));f=f||this.sa;h=f.length;
g=a;for(l=0;l<h;l++){g=g[f[l]];if(c instanceof Array){for(h=0;h<c.length;h++)d=d.concat(this.value(c,h+"."+f[l]));return d}if(!g||"object"!==typeof g)break;c=g}return[g]}return[]};a.prototype.set=function(a,b,f){if(a!==q&&b!==q){var h;b=this.G(b);b=b.split(".");h=b.shift();b.length?(a[h]=a[h]||{},this.set(a[h],b.join("."),f)):a[h]=f}return a};a.prototype.get=function(a,b){return this.value(a,b)[0]};a.prototype.push=function(a,b,f){if(a!==q&&b!==q){var h;b=this.G(b);b=b.split(".");h=b.shift();b.length?
(a[h]=a[h]||{},this.set(a[h],b.join("."),f)):(a[h]=a[h]||[],a[h]instanceof Array?a[h].push(f):n("Cannot push to a path whose endpoint is not an array!"))}return a};a.prototype.ib=function(a,b){var f,h,g,c,d;b!==q&&(b=this.G(b),f=b.split("."));f=f||this.sa;h=f.length;g=a;for(d=0;d<h;d++)if(g=g[f[d]],!g||"object"!==typeof g){c=f[d]+":"+g;break}return c};a.prototype.G=function(a){"."===a.substr(0,1)&&(a=a.substr(1,a.length-1));return a};s.d=a},{"./Shared":11}],11:[function(p,s){s.d={Q:0,s:{},Nb:{}}},
{}]},{},[1])(1)}if("object"==typeof exports&&"undefined"!=typeof module)module.d=C();else if("function"==typeof define&&define.Hb)define([],C);else{var D;"undefined"!=typeof window?D=window:"undefined"!=typeof global?D=global:"undefined"!=typeof self&&(D=self);D.vb=C()}r;
