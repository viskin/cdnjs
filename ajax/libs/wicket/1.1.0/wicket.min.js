!function(t){var e,s,i,o;return i=this,o=function(t){return t instanceof o?t:this instanceof o?void(this._wrapped=t):new o(t)},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=o),exports.Wkt=o):i.Wkt=o,e=function(t,e){return t.substring(0,e.length)===e},s=function(t,e){return t.substring(t.length-e.length)===e},o.delimiter=" ",o.isArray=function(t){return!(!t||t.constructor!==Array)},o.trim=function(t,i){for(i=i||" ";e(t,i);)t=t.substring(1);for(;s(t,i);)t=t.substring(0,t.length-1);return t},o.Wkt=function(t){this.delimiter=o.delimiter||" ",this.wrapVertices=!0,this.regExes={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,spaces:/\s+|\+/,numeric:/-*\d+(\.*\d+)?/,comma:/\s*,\s*/,parenComma:/\)\s*,\s*\(/,coord:/-*\d+\.*\d+ -*\d+\.*\d+/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/,ogcTypes:/^(multi)?(point|line|polygon|box)?(string)?$/i,crudeJson:/^{.*"(type|coordinates|geometries|features)":.*}$/},this.components=void 0,t&&"string"==typeof t?this.read(t):t&&void 0!==typeof t&&this.fromObject(t)},t.Wkt=o,this}(this),this.Wkt.Wkt.prototype.isCollection=function(){switch(this.type.slice(0,5)){case"multi":return!0;case"polyg":return!0;default:return!1}},this.Wkt.Wkt.prototype.sameCoords=function(t,e){return t.x===e.x&&t.y===e.y},this.Wkt.Wkt.prototype.fromObject=function(t){var e;return e=t.hasOwnProperty("type")&&t.hasOwnProperty("coordinates")?this.fromJson(t):this.deconstruct.call(this,t),this.components=e.components,this.isRectangle=e.isRectangle||!1,this.type=e.type,this},this.Wkt.Wkt.prototype.toObject=function(t){var e=this.construct[this.type].call(this,t);return"object"!=typeof e||Wkt.isArray(e)||(e.properties=this.properties),e},this.Wkt.Wkt.prototype.toString=function(t){return this.write()},this.Wkt.Wkt.prototype.fromJson=function(t){var e,s,i,o,r,n;if(this.type=t.type.toLowerCase(),this.components=[],t.hasOwnProperty("geometry"))return this.fromJson(t.geometry),this.properties=t.properties,this;if(o=t.coordinates,Wkt.isArray(o[0])){for(e in o)if(o.hasOwnProperty(e))if(Wkt.isArray(o[e][0])){n=[];for(s in o[e])if(o[e].hasOwnProperty(s))if(Wkt.isArray(o[e][s][0])){r=[];for(i in o[e][s])o[e][s].hasOwnProperty(i)&&r.push({x:o[e][s][i][0],y:o[e][s][i][1]});n.push(r)}else n.push({x:o[e][s][0],y:o[e][s][1]});this.components.push(n)}else"multipoint"===this.type?this.components.push([{x:o[e][0],y:o[e][1]}]):this.components.push({x:o[e][0],y:o[e][1]})}else this.components.push({x:o[0],y:o[1]});return this},Wkt.Wkt.prototype.toJson=function(){var t,e,s,i,o,r,n;if(t=this.components,e={coordinates:[],type:function(){var t,e,s;e=this.regExes.ogcTypes.exec(this.type).slice(1),s=[];for(t in e)e.hasOwnProperty(t)&&void 0!==e[t]&&s.push(e[t].toLowerCase().slice(0,1).toUpperCase()+e[t].toLowerCase().slice(1));return s}.call(this).join("")},"box"===this.type.toLowerCase()){e.type="Polygon",e.bbox=[];for(s in t)t.hasOwnProperty(s)&&(e.bbox=e.bbox.concat([t[s].x,t[s].y]));return e.coordinates=[[[t[0].x,t[0].y],[t[0].x,t[1].y],[t[1].x,t[1].y],[t[1].x,t[0].y],[t[0].x,t[0].y]]],e}for(s in t)if(t.hasOwnProperty(s))if(Wkt.isArray(t[s])){n=[];for(i in t[s])if(t[s].hasOwnProperty(i))if(Wkt.isArray(t[s][i])){r=[];for(o in t[s][i])t[s][i].hasOwnProperty(o)&&r.push([t[s][i][o].x,t[s][i][o].y]);n.push(r)}else t[s].length>1?n.push([t[s][i].x,t[s][i].y]):n=n.concat([t[s][i].x,t[s][i].y]);e.coordinates.push(n)}else t.length>1?e.coordinates.push([t[s].x,t[s].y]):e.coordinates=e.coordinates.concat([t[s].x,t[s].y]);return e},Wkt.Wkt.prototype.merge=function(t){var e=this.type.slice(0,5);if(this.type!==t.type&&this.type.slice(5,this.type.length)!==t.type)throw TypeError("The input geometry types must agree or the calling this.Wkt.Wkt instance must be a multigeometry of the other");switch(e){case"point":this.components=[this.components.concat(t.components)];break;case"multi":this.components=this.components.concat("multi"===t.type.slice(0,5)?t.components:[t.components]);break;default:this.components=[this.components,t.components]}return"multi"!==e&&(this.type="multi"+this.type),this},Wkt.Wkt.prototype.read=function(t){var e;if(e=this.regExes.typeStr.exec(t))this.type=e[1].toLowerCase(),this.base=e[2],this.ingest[this.type]&&(this.components=this.ingest[this.type].apply(this,[this.base]));else{if(!this.regExes.crudeJson.test(t))throw console.log("Invalid WKT string provided to read()"),{name:"WKTError",message:"Invalid WKT string provided to read()"};if("object"!=typeof JSON||"function"!=typeof JSON.parse)throw console.log("JSON.parse() is not available; cannot parse GeoJSON strings"),{name:"JSONError",message:"JSON.parse() is not available; cannot parse GeoJSON strings"};this.fromJson(JSON.parse(t))}return this},Wkt.Wkt.prototype.write=function(t){var e,s,i;for(t=t||this.components,s=[],s.push(this.type.toUpperCase()+"("),e=0;e<t.length;e+=1){if(this.isCollection()&&e>0&&s.push(","),!this.extract[this.type])return null;i=this.extract[this.type].apply(this,[t[e]]),this.isCollection()&&"multipoint"!==this.type?s.push("("+i+")"):(s.push(i),e!==t.length-1&&"multipoint"!==this.type&&s.push(","))}return s.push(")"),s.join("")},Wkt.Wkt.prototype.extract={point:function(t){return String(t.x)+this.delimiter+String(t.y)},multipoint:function(t){var e,s,i=[];for(e=0;e<t.length;e+=1)s=this.extract.point.apply(this,[t[e]]),this.wrapVertices&&(s="("+s+")"),i.push(s);return i.join(",")},linestring:function(t){return this.extract.point.apply(this,[t])},multilinestring:function(t){var e,s=[];for(e=0;e<t.length;e+=1)s.push(this.extract.linestring.apply(this,[t[e]]));return s.join(",")},polygon:function(t){return this.extract.multilinestring.apply(this,[t])},multipolygon:function(t){var e,s=[];for(e=0;e<t.length;e+=1)s.push("("+this.extract.polygon.apply(this,[t[e]])+")");return s.join(",")},box:function(t){return this.extract.linestring.apply(this,[t])},geometrycollection:function(t){console.log("The geometrycollection WKT type is not yet supported.")}},Wkt.Wkt.prototype.ingest={point:function(t){var e=Wkt.trim(t).split(this.regExes.spaces);return[{x:parseFloat(this.regExes.numeric.exec(e[0])[0]),y:parseFloat(this.regExes.numeric.exec(e[1])[0])}]},multipoint:function(t){var e,s,i;for(s=[],i=Wkt.trim(t).split(this.regExes.comma),e=0;e<i.length;e+=1)s.push(this.ingest.point.apply(this,[i[e]]));return s},linestring:function(t){var e,s,i;for(s=this.ingest.multipoint.apply(this,[t]),i=[],e=0;e<s.length;e+=1)i=i.concat(s[e]);return i},multilinestring:function(t){var e,s,i,o;for(s=[],o=Wkt.trim(t).split(this.regExes.doubleParenComma),1===o.length&&(o=Wkt.trim(t).split(this.regExes.parenComma)),e=0;e<o.length;e+=1)i=o[e].replace(this.regExes.trimParens,"$1"),s.push(this.ingest.linestring.apply(this,[i]));return s},polygon:function(t){var e,s,i,o,r,n;for(n=Wkt.trim(t).split(this.regExes.parenComma),i=[],e=0;e<n.length;e+=1){for(r=n[e].replace(this.regExes.trimParens,"$1").split(this.regExes.comma),o=[],s=0;s<r.length;s+=1)o.push({x:parseFloat(r[s].split(this.regExes.spaces)[0]),y:parseFloat(r[s].split(this.regExes.spaces)[1])});i.push(o)}return i},box:function(t){var e,s,i;for(s=this.ingest.multipoint.apply(this,[t]),i=[],e=0;e<s.length;e+=1)i=i.concat(s[e]);return i},multipolygon:function(t){var e,s,i,o;for(s=[],o=Wkt.trim(t).split(this.regExes.doubleParenComma),e=0;e<o.length;e+=1)i=o[e].replace(this.regExes.trimParens,"$1"),s.push(this.ingest.polygon.apply(this,[i]));return s},geometrycollection:function(t){console.log("The geometrycollection WKT type is not yet supported.")}};
//# sourceMappingURL=wicket.min.js.map