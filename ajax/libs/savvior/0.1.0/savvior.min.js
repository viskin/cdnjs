/*!
 * Savvior v0.1.0 - A Salvattore or Masonry alternative for multiple column layouts.
 * http://savvior.org
 * https://github.com/attila/savvior
 */
!function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}(),"function"!=typeof window.CustomEvent&&!function(){function a(a,b){b=b||{bubbles:!1,cancelable:!1,detail:void 0};var c=document.createEvent("CustomEvent");return c.initCustomEvent(a,b.bubbles,b.cancelable,b.detail),c}a.prototype=window.CustomEvent.prototype,window.CustomEvent=a}();var savvior=function(a,b){"use strict";var c={},d=function(a,b,c){a.dataset?a.dataset[b]=c:a.setAttribute("data-"+b,c)};return c.settings=c.settings||{},c.ready=c.ready||!1,c.registered=c.registered||{},c.currentMQ=c.currentMQ||null,c.addColumns=function(a,e,f){for(var g,h=c.settings[f][c.currentMQ].columns,i=["column","size-1of"+h],j=new Array(+h),k=b.createDocumentFragment(),l=h;0!==l--;)g="[data-columns] > *:nth-child("+h+"n-"+l+")",j.push(e.querySelectorAll(g));j.forEach(function(a){var c=b.createElement("div"),d=b.createDocumentFragment();c.className=i.join(" "),Array.prototype.forEach.call(a,function(a){d.appendChild(a)}),c.appendChild(d),k.appendChild(c)}),a.appendChild(k),d(a,"columns",h)},c.removeColumns=function(c){var e=b.createRange();e.selectNodeContents(c);var f=Array.prototype.filter.call(e.extractContents().childNodes,function(b){return b instanceof a.HTMLElement}),g=f.length,h=f[0].childNodes.length,i=new Array(h*g);Array.prototype.forEach.call(f,function(a,b){Array.prototype.forEach.call(a.children,function(a,c){i[c*g+b]=a})});var j=b.createElement("div");return d(j,"columns",0),i.filter(function(a){return!!a}).forEach(function(a){j.appendChild(a)}),j},c.recreateColumns=function(b,d){a.requestAnimationFrame(function(){var e=c.settings[d][c.currentMQ].columns,f=parseInt(b.getAttribute("data-columns"));if(e!==f){var g=new CustomEvent("savviorMatch",{detail:b});c.addColumns(b,c.removeColumns(b),d),a.dispatchEvent(g)}})},c.registerGrid=function(e,f){if("none"!==a.getComputedStyle(e).display&&"undefined"==typeof c.registered[f]){var g=b.createRange(),h=b.createElement("div");g.selectNodeContents(e),h.appendChild(g.extractContents()),d(h,"columns",0),c.addColumns(e,h,f),c.registered[f]=!0}},c.register=function(a,b,d){enquire.register(d,{deferSetup:!0,setup:function(){c.currentMQ=d,c.registerGrid(a,b)},match:function(){c.currentMQ!==d&&(c.currentMQ=d),c.registered[b]===!0&&c.recreateColumns(a,b)}})},c.init=function(d){if("undefined"==typeof d)return!1;var e=new CustomEvent("savviorInit"),f=[];c.settings=d;for(var g in c.settings)c.settings.hasOwnProperty(g)&&(f=b.querySelectorAll(g),Array.prototype.forEach.call(f,function(a){for(var b in c.settings[g])c.settings[g].hasOwnProperty(b)&&c.register(a,g,b)}));c.ready=!0,a.dispatchEvent(e)},{init:c.init,ready:function(){return c.ready}}}(window,window.document);