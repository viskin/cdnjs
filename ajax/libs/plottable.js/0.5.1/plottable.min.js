/*!
Plottable v0.5.0 (https://github.com/palantir/plottable)
Copyright 2014 Palantir Technologies
Licensed under MIT (https://github.com/palantir/plottable/blob/master/LICENSE)
*/
;var Plottable;(function(a){(function(e){function g(i,j,h){return(Math.min(j,h)<=i&&i<=Math.max(j,h))}e.inRange=g;function f(h){return h.node().getBBox()}e.getBBox=f;function d(q,h,m){var l=m.text();m.text(q);var r=e.getBBox(m);var s=r.width;if(s<h){m.text(l);return q}m.text(q+"...");var j=m.node();var n=j.getSubStringLength(j.textContent.length-3,3);if(n>h){m.text(l);return""}var o=q.length;for(var k=1;k<o;k++){var p=j.getSubStringLength(0,k);if(p+n>h){m.text(l);return q.substr(0,k-1).trim()+"..."}}}e.truncateTextToLength=d;function c(i){var j=i.text();i.text("bqpdl");var h=e.getBBox(i).height;i.text(j);return h}e.getTextHeight=c})(a.Utils||(a.Utils={}));var b=a.Utils})(Plottable||(Plottable={}));var Plottable;(function(a){(function(c){function d(k,h,g){var f=0;var j=h.length;while(f<j){var i=(f+j)>>>1;var e=g==null?h[i]:g(h[i]);if(e<k){f=i+1}else{j=i}}return f}c.sortedIndex=d})(a.OSUtils||(a.OSUtils={}));var b=a.OSUtils})(Plottable||(Plottable={}));var Plottable;(function(a){var b=(function(){function c(){this.interactionsToRegister=[];this.boxes=[];this.clipPathEnabled=false;this._fixedWidth=true;this._fixedHeight=true;this._rowMinimum=0;this._colMinimum=0;this.isTopLevelComponent=false;this._xOffset=0;this._yOffset=0;this._xAlignProportion=0;this._yAlignProportion=0;this.cssClasses=["component"]}c.prototype._anchor=function(d){var e=this;if(d.node().childNodes.length>0){throw new Error("Can't anchor to a non-empty element")}if(d.node().nodeName==="svg"){this.rootSVG=d;this.rootSVG.classed("plottable",true);this.element=d.append("g");this.isTopLevelComponent=true}else{this.element=d}this.cssClasses.forEach(function(f){e.element.classed(f,true)});this.cssClasses=null;this.backgroundContainer=this.element.append("g").classed("background-container",true);this.content=this.element.append("g").classed("content",true);this.foregroundContainer=this.element.append("g").classed("foreground-container",true);this.boxContainer=this.element.append("g").classed("box-container",true);if(this.clipPathEnabled){this.generateClipPath()}this.addBox("bounding-box");this.interactionsToRegister.forEach(function(f){return e.registerInteraction(f)});this.interactionsToRegister=null;return this};c.prototype._computeLayout=function(i,d,f,h){var j=this;if(i==null||d==null||f==null||h==null){if(this.element==null){throw new Error("anchor must be called before computeLayout")}else{if(this.isTopLevelComponent){i=0;d=0;f=parseFloat(this.rootSVG.attr("width"));h=parseFloat(this.rootSVG.attr("height"))}else{throw new Error("null arguments cannot be passed to _computeLayout() on a non-root node")}}}this.xOrigin=i;this.yOrigin=d;var g=this.xOrigin;var e=this.yOrigin;if(this.colMinimum()!==0&&this.isFixedWidth()){g+=(f-this.colMinimum())*this._xAlignProportion;g+=this._xOffset;f=f>this.colMinimum()?this.colMinimum():f}if(this.rowMinimum()!==0&&this.isFixedHeight()){e+=(h-this.rowMinimum())*this._yAlignProportion;e+=this._yOffset;h=h>this.rowMinimum()?this.rowMinimum():h}this.availableWidth=f;this.availableHeight=h;this.element.attr("transform","translate("+g+","+e+")");this.boxes.forEach(function(k){return k.attr("width",j.availableWidth).attr("height",j.availableHeight)});return this};c.prototype._render=function(){return this};c.prototype.renderTo=function(d){if(this.element==null){this._anchor(d)}this._computeLayout()._render();return this};c.prototype.xAlign=function(d){if(d==="LEFT"){this._xAlignProportion=0}else{if(d==="CENTER"){this._xAlignProportion=0.5}else{if(d==="RIGHT"){this._xAlignProportion=1}else{throw new Error("Unsupported alignment")}}}return this};c.prototype.yAlign=function(d){if(d==="TOP"){this._yAlignProportion=0}else{if(d==="CENTER"){this._yAlignProportion=0.5}else{if(d==="BOTTOM"){this._yAlignProportion=1}else{throw new Error("Unsupported alignment")}}}return this};c.prototype.xOffset=function(d){this._xOffset=d;return this};c.prototype.yOffset=function(d){this._yOffset=d;return this};c.prototype.addBox=function(e,d){if(this.element==null){throw new Error("Adding boxes before anchoring is currently disallowed")}var d=d==null?this.boxContainer:d;var f=d.append("rect");if(e!=null){f.classed(e,true)}this.boxes.push(f);if(this.availableWidth!=null&&this.availableHeight!=null){f.attr("width",this.availableWidth).attr("height",this.availableHeight)}return f};c.prototype.generateClipPath=function(){var d=c.clipPathId++;this.element.attr("clip-path","url(#clipPath"+d+")");var e=this.boxContainer.append("clipPath").attr("id","clipPath"+d);this.addBox("clip-rect",e)};c.prototype.registerInteraction=function(d){if(this.element!=null){if(this.hitBox==null){this.hitBox=this.addBox("hit-box");this.hitBox.style("fill","#ffffff").style("opacity",0)}d._anchor(this.hitBox)}else{this.interactionsToRegister.push(d)}return this};c.prototype.classed=function(d,f){if(f==null){if(d==null){return false}else{if(this.element==null){return(this.cssClasses.indexOf(d)!==-1)}else{return this.element.classed(d)}}}else{if(d==null){return this}if(this.element==null){var e=this.cssClasses.indexOf(d);if(f&&e===-1){this.cssClasses.push(d)}else{if(!f&&e!==-1){this.cssClasses.splice(e,1)}}}else{this.element.classed(d,f)}return this}};c.prototype.rowMinimum=function(d){if(d!=null){this._rowMinimum=d;return this}else{return this._rowMinimum}};c.prototype.colMinimum=function(d){if(d!=null){this._colMinimum=d;return this}else{return this._colMinimum}};c.prototype.isFixedWidth=function(){return this._fixedWidth};c.prototype.isFixedHeight=function(){return this._fixedHeight};c.prototype.merge=function(e){var d;if(a.ComponentGroup.prototype.isPrototypeOf(e)){d=e;d._addComponentToGroup(this,true);return d}else{d=new a.ComponentGroup([this,e]);return d}};c.clipPathId=0;return c})();a.Component=b})(Plottable||(Plottable={}));var __extends=this.__extends||function(f,a){for(var e in a){if(a.hasOwnProperty(e)){f[e]=a[e]}}function c(){this.constructor=f}c.prototype=a.prototype;f.prototype=new c()};var Plottable;(function(a){var c=(function(){function f(g){this.broadcasterCallbacks=[];this._d3Scale=g}f.prototype.scale=function(g){return this._d3Scale(g)};f.prototype.domain=function(g){var h=this;if(g==null){return this._d3Scale.domain()}else{this._d3Scale.domain(g);this.broadcasterCallbacks.forEach(function(i){return i(h)});return this}};f.prototype.range=function(g){if(g==null){return this._d3Scale.range()}else{this._d3Scale.range(g);return this}};f.prototype.copy=function(){return new f(this._d3Scale.copy())};f.prototype.registerListener=function(g){this.broadcasterCallbacks.push(g);return this};return f})();a.Scale=c;var e=(function(f){__extends(g,f);function g(h){f.call(this,h);this.lastRequestedTickCount=10}g.prototype.invert=function(h){return this._d3Scale.invert(h)};g.prototype.copy=function(){return new g(this._d3Scale.copy())};g.prototype.widenDomain=function(j){var i=this.domain();var h=[Math.min(j[0],i[0]),Math.max(j[1],i[1])];this.domain(h);return this};g.prototype.interpolate=function(h){if(h==null){return this._d3Scale.interpolate()}this._d3Scale.interpolate(h);return this};g.prototype.rangeRound=function(h){this._d3Scale.rangeRound(h);return this};g.prototype.clamp=function(h){if(h==null){return this._d3Scale.clamp()}this._d3Scale.clamp(h);return this};g.prototype.nice=function(h){this._d3Scale.nice(h);this.domain(this._d3Scale.domain());return this};g.prototype.ticks=function(h){if(h!=null){this.lastRequestedTickCount=h}return this._d3Scale.ticks(this.lastRequestedTickCount)};g.prototype.tickFormat=function(h,i){return this._d3Scale.tickFormat(h,i)};return g})(c);a.QuantitiveScale=e;var d=(function(g){__extends(f,g);function f(h){g.call(this,h==null?d3.scale.linear():h);this.domain([Infinity,-Infinity])}f.prototype.copy=function(){return new f(this._d3Scale.copy())};return f})(e);a.LinearScale=d;var b=(function(g){__extends(f,g);function f(h){var i;switch(h){case"Category10":case"category10":case"10":i=d3.scale.category10();break;case"Category20":case"category20":case"20":i=d3.scale.category20();break;case"Category20b":case"category20b":case"20b":i=d3.scale.category20b();break;case"Category20c":case"category20c":case"20c":i=d3.scale.category20c();break;case null:case undefined:i=d3.scale.ordinal();default:throw new Error("Unsupported ColorScale type")}g.call(this,i)}return f})(c);a.ColorScale=b})(Plottable||(Plottable={}));var Plottable;(function(a){var d=(function(){function h(i){this.componentToListenTo=i}h.prototype._anchor=function(i){this.hitBox=i};h.prototype.registerWithComponent=function(){this.componentToListenTo.registerInteraction(this);return this};return h})();a.Interaction=d;var g=(function(h){__extends(i,h);function i(l,k,j){var m=this;h.call(this,l);this.xScale=k;this.yScale=j;this.zoom=d3.behavior.zoom();this.zoom.x(this.xScale._d3Scale);this.zoom.y(this.yScale._d3Scale);this.zoom.on("zoom",function(){return m.rerenderZoomed()})}i.prototype._anchor=function(j){h.prototype._anchor.call(this,j);this.zoom(j)};i.prototype.rerenderZoomed=function(){var j=this.xScale._d3Scale.domain();var k=this.yScale._d3Scale.domain();this.xScale.domain(j);this.yScale.domain(k)};return i})(d);a.PanZoomInteraction=g;var c=(function(i){__extends(h,i);function h(j){var k=this;i.call(this,j);this.dragInitialized=false;this.origin=[0,0];this.location=[0,0];this.dragBehavior=d3.behavior.drag();this.dragBehavior.on("dragstart",function(){return k.dragstart()});this.dragBehavior.on("drag",function(){return k.drag()});this.dragBehavior.on("dragend",function(){return k.dragend()})}h.prototype.callback=function(j){this.callbackToCall=j;return this};h.prototype.dragstart=function(){this.clearBox();var j=parseFloat(this.hitBox.attr("width"));var l=parseFloat(this.hitBox.attr("height"));var k=function(n,m){return function(o){return Math.min(Math.max(o,n),m)}};this.constrainX=k(0,j);this.constrainY=k(0,l)};h.prototype.drag=function(){if(!this.dragInitialized){this.origin=[d3.event.x,d3.event.y];this.dragInitialized=true}this.location=[this.constrainX(d3.event.x),this.constrainY(d3.event.y)];var l=Math.abs(this.origin[0]-this.location[0]);var k=Math.abs(this.origin[1]-this.location[1]);var j=Math.min(this.origin[0],this.location[0]);var m=Math.min(this.origin[1],this.location[1]);this.dragBox.attr("x",j).attr("y",m).attr("height",k).attr("width",l)};h.prototype.dragend=function(){if(!this.dragInitialized){return}this.dragInitialized=false;if(this.callbackToCall==null){return}var k=Math.min(this.origin[0],this.location[0]);var n=Math.max(this.origin[0],this.location[0]);var j=Math.min(this.origin[1],this.location[1]);var m=Math.max(this.origin[1],this.location[1]);var l={xMin:k,xMax:n,yMin:j,yMax:m};this.callbackToCall(l)};h.prototype.clearBox=function(){this.dragBox.attr("height",0).attr("width",0);return this};h.prototype._anchor=function(l){i.prototype._anchor.call(this,l);var j=h.CLASS_DRAG_BOX;var k=this.componentToListenTo.backgroundContainer;this.dragBox=k.append("rect").classed(j,true).attr("x",0).attr("y",0);l.call(this.dragBehavior);return this};h.CLASS_DRAG_BOX="drag-box";return h})(d);a.AreaInteraction=c;var f=(function(){function h(){this.xScaleMappings=[];this.yScaleMappings=[]}h.prototype.addXScale=function(j,i){if(i==null){i=j}this.xScaleMappings.push([j,i]);return this};h.prototype.addYScale=function(j,i){if(i==null){i=j}this.yScaleMappings.push([j,i]);return this};h.prototype.updateScale=function(o,m,i,k){var j=o.domain();var l=[o.invert(i),o.invert(k)];var n=(l[0]<l[1])===(j[0]<j[1]);if(!n){l.reverse()}m.domain(l)};h.prototype.getCallback=function(){var i=this;return function(j){i.xScaleMappings.forEach(function(k){i.updateScale(k[0],k[1],j.xMin,j.xMax)});i.yScaleMappings.forEach(function(k){i.updateScale(k[0],k[1],j.yMin,j.yMax)})}};return h})();a.ZoomCallbackGenerator=f;var b=(function(i){__extends(h,i);function h(j){i.call(this,j)}h.prototype._anchor=function(j){var k=this;i.prototype._anchor.call(this,j);j.on("mousemove",function(){var m=d3.mouse(j.node());var l=m[0];var n=m[1];k.mousemove(l,n)})};h.prototype.mousemove=function(j,k){return};return h})(d);a.MousemoveInteraction=b;var e=(function(h){__extends(i,h);function i(j){h.call(this,j);this.renderer=j}i.prototype._anchor=function(k){h.prototype._anchor.call(this,k);var j=this.renderer.foregroundContainer.append("g").classed("crosshairs",true);this.circle=j.append("circle").classed("centerpoint",true);this.xLine=j.append("path").classed("x-line",true);this.yLine=j.append("path").classed("y-line",true);this.circle.attr("r",5)};i.prototype.mousemove=function(t,r){var l=this.renderer.xScale.invert(t);var n=this.renderer._data;var s=a.OSUtils.sortedIndex(l,n,this.renderer.xAccessor);s=s>0?s-1:0;var j=n[s];var q=this.renderer.xAccessor(j);var p=this.renderer.yAccessor(j);var o=this.renderer.xScale.scale(q);var m=this.renderer.yScale.scale(p);this.circle.attr("cx",o).attr("cy",m);var k=this.renderer.availableWidth;var u=this.renderer.availableHeight;this.xLine.attr("d","M 0 "+m+" L "+k+" "+m);this.yLine.attr("d","M "+o+" 0 L "+o+" "+u)};return i})(b);a.CrosshairsInteraction=e})(Plottable||(Plottable={}));var Plottable;(function(a){var d=(function(e){__extends(f,e);function f(h,g){if(typeof h==="undefined"){h=""}if(typeof g==="undefined"){g="horizontal"}e.call(this);this.classed("label",true);this.setText(h);if(g==="horizontal"||g==="vertical-left"||g==="vertical-right"){this.orientation=g;if(g==="horizontal"){this._fixedWidth=false}else{this._fixedHeight=false}}else{throw new Error(g+" is not a valid orientation for LabelComponent")}this.xAlign("CENTER").yAlign("CENTER")}f.prototype._anchor=function(g){e.prototype._anchor.call(this,g);this.textElement=this.content.append("text");this.setText(this.text);return this};f.prototype.setText=function(g){this.text=g;if(this.element!=null){this.textElement.text(g);this.measureAndSetTextSize()}return this};f.prototype.measureAndSetTextSize=function(){var g=a.Utils.getBBox(this.textElement);this.textHeight=g.height;this.textLength=g.width;if(this.orientation==="horizontal"){this.rowMinimum(this.textHeight)}else{this.colMinimum(this.textHeight)}};f.prototype.truncateTextAndRemeasure=function(g){var h=a.Utils.truncateTextToLength(this.text,g,this.textElement);this.textElement.text(h);this.measureAndSetTextSize()};f.prototype._computeLayout=function(g,l,h,k){e.prototype._computeLayout.call(this,g,l,h,k);this.textElement.attr("dy",0);var j=a.Utils.getBBox(this.textElement);this.textElement.attr("dy",-j.y);var m=0;var i=0;if(this.orientation==="horizontal"){this.truncateTextAndRemeasure(this.availableWidth);m=(this.availableWidth-this.textLength)*this._xAlignProportion}else{this.truncateTextAndRemeasure(this.availableHeight);m=(this.availableHeight-this.textLength)*this._yAlignProportion;if(this.orientation==="vertical-right"){this.textElement.attr("transform","rotate(90)");i=-this.textHeight}else{this.textElement.attr("transform","rotate(-90)");m=-m-this.textLength}}this.textElement.attr("x",m);this.textElement.attr("y",i);return this};return f})(a.Component);a.Label=d;var c=(function(f){__extends(e,f);function e(h,g){f.call(this,h,g);this.classed("title-label",true)}return e})(d);a.TitleLabel=c;var b=(function(f){__extends(e,f);function e(h,g){f.call(this,h,g);this.classed("axis-label",true)}return e})(d);a.AxisLabel=b})(Plottable||(Plottable={}));var Plottable;(function(a){var d=(function(g){__extends(h,g);function h(i){g.call(this);this._rerenderUpdateSelection=false;this._requireRerender=false;this.clipPathEnabled=true;this._fixedWidth=false;this._fixedHeight=false;this.classed("renderer",true);if(i!=null){this.dataset(i)}this.colorAccessor(h.defaultColorAccessor)}h.prototype.dataset=function(i){this.data(i.data);this.metadata(i.metadata);return this};h.prototype.metadata=function(j){var i=this._metadata!=null?this._metadata.cssClass:null;this.classed(i,false);this._metadata=j;this.classed(this._metadata.cssClass,true);this._rerenderUpdateSelection=true;this._requireRerender=true;return this};h.prototype.data=function(i){this._data=i;this._requireRerender=true;return this};h.prototype._render=function(){this._paint();this._requireRerender=false;this._rerenderUpdateSelection=false;return this};h.prototype.colorAccessor=function(i){this._colorAccessor=i;this._requireRerender=true;this._rerenderUpdateSelection=true;return this};h.prototype._paint=function(){};h.prototype._anchor=function(i){g.prototype._anchor.call(this,i);this.renderArea=this.content.append("g").classed("render-area",true);return this};h.defaultColorAccessor=function(i){return"steelblue"};return h})(a.Component);a.Renderer=d;var c=(function(g){__extends(h,g);function h(m,s,l,k,p){var q=this;g.call(this,m);this.classed("xy-renderer");this.xAccessor=(k!=null)?k:h.defaultXAccessor;this.yAccessor=(p!=null)?p:h.defaultYAccessor;this.xScale=s;this.yScale=l;var o=m.data;var j=function(t){return q.xAccessor(t,null,q._metadata)};var r=d3.extent(o,j);this.xScale.widenDomain(r);var n=function(t){return q.yAccessor(t,null,q._metadata)};var i=d3.extent(o,n);this.yScale.widenDomain(i);this.xScale.registerListener(function(){return q.rescale()});this.yScale.registerListener(function(){return q.rescale()})}h.prototype._computeLayout=function(i,l,j,k){g.prototype._computeLayout.call(this,i,l,j,k);this.xScale.range([0,this.availableWidth]);this.yScale.range([this.availableHeight,0]);return this};h.prototype.invertXYSelectionArea=function(l){var k=this.xScale.invert(l.xMin);var n=this.xScale.invert(l.xMax);var i=this.yScale.invert(l.yMin);var m=this.yScale.invert(l.yMax);var j={xMin:k,xMax:n,yMin:i,yMax:m};return j};h.prototype.getDataFilterFunction=function(i){var k=this;var j=function(n,m){var l=k.xAccessor(n,m,k._metadata);var o=k.yAccessor(n,m,k._metadata);return a.Utils.inRange(l,i.xMin,i.xMax)&&a.Utils.inRange(o,i.yMin,i.yMax)};return j};h.prototype.getSelectionFromArea=function(i){var j=this.getDataFilterFunction(i);return this.dataSelection.filter(j)};h.prototype.getDataIndicesFromArea=function(i){var k=this.getDataFilterFunction(i);var j=[];this._data.forEach(function(m,l){if(k(m,l)){j.push(l)}});return j};h.prototype.rescale=function(){if(this.element!=null){this._render()}};h.defaultXAccessor=function(i){return i.x};h.defaultYAccessor=function(i){return i.y};return h})(d);a.XYRenderer=c;var f=(function(g){__extends(h,g);function h(m,l,j,k,i){g.call(this,m,l,j,k,i);this.classed("line-renderer",true)}h.prototype._anchor=function(i){g.prototype._anchor.call(this,i);this.path=this.renderArea.append("path");return this};h.prototype._paint=function(){var i=this;g.prototype._paint.call(this);this.line=d3.svg.line().x(function(k,j){return i.xScale.scale(i.xAccessor(k,j,i._metadata))}).y(function(k,j){return i.yScale.scale(i.yAccessor(k,j,i._metadata))});this.dataSelection=this.path.classed("line",true).datum(this._data);this.path.attr("d",this.line);this.path.attr("stroke",this._colorAccessor(this._data[0],0,this._metadata))};return h})(c);a.LineRenderer=f;var b=(function(h){__extends(g,h);function g(n,m,k,l,j,i){if(typeof i==="undefined"){i=3}h.call(this,n,m,k,l,j);this.classed("circle-renderer",true);this.size=i}g.prototype._paint=function(){var i=this;h.prototype._paint.call(this);this.dataSelection=this.renderArea.selectAll("circle").data(this._data);this.dataSelection.enter().append("circle");this.dataSelection.attr("cx",function(k,j){return i.xScale.scale(i.xAccessor(k,j,i._metadata))}).attr("cy",function(k,j){return i.yScale.scale(i.yAccessor(k,j,i._metadata))}).attr("r",this.size).attr("fill",function(k,j){return i._colorAccessor(k,j,i._metadata)});this.dataSelection.exit().remove()};return g})(c);a.CircleRenderer=b;var e=(function(g){__extends(h,g);function h(m,s,k,j,t,n){var o=this;g.call(this,m,s,k,j,n);this.barPaddingPx=1;this.classed("bar-renderer",true);var i=this.yScale.domain();if(!a.Utils.inRange(0,i[0],i[1])){var l=0;var p=i[1];this.yScale.widenDomain([l,p])}this.dxAccessor=(t!=null)?t:h.defaultDxAccessor;var r=function(u){return o.xAccessor(u,null,o._metadata)+o.dxAccessor(u,null,o._metadata)};var q=d3.extent(m.data,r);this.xScale.widenDomain(q)}h.prototype._paint=function(){var p=this;g.prototype._paint.call(this);var l=this.yScale.range();var k=Math.max(l[0],l[1]);this.dataSelection=this.renderArea.selectAll("rect").data(this._data);var m=this.xScale.domain()[1]-this.xScale.domain()[0];var n=this.xScale.range()[1]-this.xScale.range()[0];this.dataSelection.enter().append("rect");var i=function(v,t){var s=p.xAccessor(v,t,p._metadata);var u=p.xScale.scale(s);return u+p.barPaddingPx};var o=function(u,t){var v=p.yAccessor(u,t,p._metadata);var s=p.yScale.scale(v);return s};var j=function(w,v){var t=p.dxAccessor(w,v,p._metadata);var s=p.xScale.scale(t);var u=p.xScale.scale(0);return s-u-2*p.barPaddingPx};var q=function(u,t){var v=p.yAccessor(u,t,p._metadata);var s=p.yScale.scale(v);return k-s};var r=function(t,s){return p._colorAccessor(t,s,p._metadata)};this.dataSelection.attr("x",i).attr("y",o).attr("width",j).attr("height",q).attr("fill",r);this.dataSelection.exit().remove()};h.defaultDxAccessor=function(i){return i.dx};return h})(c);a.BarRenderer=e})(Plottable||(Plottable={}));var Plottable;(function(a){var b=(function(d){__extends(c,d);function c(f){if(typeof f==="undefined"){f=[]}d.call(this);this.rowPadding=0;this.colPadding=0;this.classed("table",true);var e=function(g){return g==null?new a.Component():g};f=f.map(function(g){return g.map(e)});this.rows=f;this.nRows=f.length;this.nCols=f.length>0?d3.max(f,function(g){return g.length}):0;this.rowWeights=this.rows.map(function(){return null});this.colWeights=d3.transpose(this.rows).map(function(){return null})}c.prototype.addComponent=function(h,g,f){if(this.element!=null){throw new Error("addComponent cannot be called after anchoring (for the moment)")}this.nRows=Math.max(h,this.nRows);this.nCols=Math.max(g,this.nCols);this.padTableToSize(this.nRows+1,this.nCols+1);var e=this.rows[h][g];if(e.constructor.name!=="Component"){throw new Error("addComponent cannot be called on a cell where a component already exists (for the moment)")}this.rows[h][g]=f;return this};c.prototype._anchor=function(e){var f=this;d.prototype._anchor.call(this,e);this.rows.forEach(function(g,h){g.forEach(function(j,i){j._anchor(f.content.append("g"))})});return this};c.prototype._computeLayout=function(k,i,p,g){var j=this;d.prototype._computeLayout.call(this,k,i,p,g);var h=this.availableWidth-this.colMinimum();var s=this.availableHeight-this.rowMinimum();if(h<0||s<0){throw new Error("Insufficient Space")}var o=d3.transpose(this.rows);var e=c.calcComponentWeights(this.rowWeights,this.rows,function(u){return u.isFixedHeight()});var n=c.calcComponentWeights(this.colWeights,o,function(u){return u.isFixedWidth()});var t=c.calcProportionalSpace(e,s);var r=c.calcProportionalSpace(n,h);var l=function(u){return u[0]+u[1]};var m=d3.zip(t,this.rowMinimums).map(l);var q=d3.zip(r,this.colMinimums).map(l);var f=0;this.rows.forEach(function(v,w){var u=0;v.forEach(function(y,x){y._computeLayout(u,f,q[x],m[w]);u+=q[x]+j.colPadding});f+=m[w]+j.rowPadding});return this};c.prototype._render=function(){this.rows.forEach(function(e,f){e.forEach(function(h,g){h._render()})});return this};c.prototype.padding=function(e,f){this.rowPadding=e;this.colPadding=f;return this};c.prototype.rowWeight=function(e,f){this.rowWeights[e]=f;return this};c.prototype.colWeight=function(e,f){this.colWeights[e]=f;return this};c.prototype.rowMinimum=function(e){if(e!=null){throw new Error("Row minimum cannot be directly set on Table")}else{this.rowMinimums=this.rows.map(function(f){return d3.max(f,function(g){return g.rowMinimum()})});return d3.sum(this.rowMinimums)+this.rowPadding*(this.rows.length-1)}};c.prototype.colMinimum=function(e){if(e!=null){throw new Error("Col minimum cannot be directly set on Table")}else{var f=d3.transpose(this.rows);this.colMinimums=f.map(function(g){return d3.max(g,function(h){return h.colMinimum()})});return d3.sum(this.colMinimums)+this.colPadding*(f.length-1)}};c.prototype.isFixedWidth=function(){var e=d3.transpose(this.rows);return c.fixedSpace(e,function(f){return f.isFixedWidth()})};c.prototype.isFixedHeight=function(){return c.fixedSpace(this.rows,function(e){return e.isFixedHeight()})};c.prototype.padTableToSize=function(g,h){for(var f=0;f<g;f++){if(this.rows[f]===undefined){this.rows[f]=[];this.rowWeights[f]=null}for(var e=0;e<h;e++){if(this.rows[f][e]===undefined){this.rows[f][e]=new a.Component()}}}for(e=0;e<h;e++){if(this.colWeights[e]===undefined){this.colWeights[e]=null}}};c.calcComponentWeights=function(e,g,f){return e.map(function(j,k){if(j!=null){return j}var h=g[k].map(f);var l=h.reduce(function(m,i){return m&&i});return l?0:1})};c.calcProportionalSpace=function(g,h){var f=d3.sum(g);if(f===0){var e=g.length;return g.map(function(i){return h/e})}else{return g.map(function(i){return h*i/f})}};c.fixedSpace=function(f,g){var e=function(i){return i.reduce(function(k,j){return k&&j})};var h=function(i){return e(i.map(g))};return e(f.map(h))};return c})(a.Component);a.Table=b})(Plottable||(Plottable={}));var Plottable;(function(a){var b=(function(){function c(d){var e=this;this.rescaleInProgress=false;this.scales=d;this.scales.forEach(function(f){return f.registerListener(function(g){return e.rescale(g)})})}c.prototype.rescale=function(e){if(this.rescaleInProgress){return}this.rescaleInProgress=true;var d=e.domain();this.scales.forEach(function(f){return f.domain(d)});this.rescaleInProgress=false};return c})();a.ScaleDomainCoordinator=b})(Plottable||(Plottable={}));var Plottable;(function(a){var b=(function(d){__extends(c,d);function c(e){d.call(this);this.classed("legend",true);this.colMinimum(120);this.colorScale=e;this.xAlign("RIGHT").yAlign("TOP");this.xOffset(5).yOffset(5)}c.prototype.scale=function(e){this.colorScale=e;return this};c.prototype.rowMinimum=function(e){if(e!=null){throw new Error("Row minimum cannot be directly set on Legend")}else{var f=this.measureTextHeight();return this.colorScale.domain().length*f}};c.prototype.measureTextHeight=function(){var f=this.content.append("g").classed(c.SUBELEMENT_CLASS,true);var e=a.Utils.getTextHeight(f.append("text"));f.remove();return e};c.prototype._render=function(){d.prototype._render.call(this);var h=this.colorScale.domain();var i=this.measureTextHeight();var g=this.colMinimum()-i-c.MARGIN;this.content.selectAll("."+c.SUBELEMENT_CLASS).remove();var f=this.content.selectAll("."+c.SUBELEMENT_CLASS).data(h);var e=f.enter().append("g").classed(c.SUBELEMENT_CLASS,true).attr("transform",function(k,j){return"translate(0,"+j*i+")"});e.append("rect").attr("x",c.MARGIN).attr("y",c.MARGIN).attr("width",i-c.MARGIN*2).attr("height",i-c.MARGIN*2);e.append("text").attr("x",i).attr("y",c.MARGIN+i/2);f.selectAll("rect").attr("fill",this.colorScale._d3Scale);f.selectAll("text").text(function(k,j){return a.Utils.truncateTextToLength(k,g,d3.select(this))});return this};c.SUBELEMENT_CLASS="legend-row";c.MARGIN=5;return c})(a.Component);a.Legend=b})(Plottable||(Plottable={}));var Plottable;(function(a){var c=(function(f){__extends(e,f);function e(j,g,h){var i=this;f.call(this);this.tickPositioning="center";this.axisScale=j;g=g.toLowerCase();this.d3Axis=d3.svg.axis().scale(j._d3Scale).orient(g);this.classed("axis",true);this.clipPathEnabled=true;if(h==null){h=d3.format(".3s")}this.d3Axis.tickFormat(h);this.axisScale.registerListener(function(){return i.rescale()})}e.prototype._anchor=function(g){f.prototype._anchor.call(this,g);this.axisElement=this.content.append("g").classed("axis",true);return this};e.prototype._render=function(){if(this.orient()==="left"){this.axisElement.attr("transform","translate("+e.yWidth+", 0)")}if(this.orient()==="top"){this.axisElement.attr("transform","translate(0,"+e.xHeight+")")}var k=this.d3Axis.scale().domain();var r=Math.abs(k[1]-k[0]);var l=+d3.min(k);var n=+d3.max(k);var m;var q=k[0]<k[1];if(typeof(k[0])==="number"){m=q?[l-r,n+r]:[n+r,l-r]}else{m=q?[new Date(l-r),new Date(n+r)]:[new Date(n+r),new Date(l-r)]}if(this.axisScale.ticks!=null){var i=this.axisScale;var j=10;var o=i.ticks(j);var p=i.domain();var g=p[1]-p[0];var h=function(s){return Math.abs(s/g/j)<0.0001?0:s};o=o.map(h);this.d3Axis.tickValues(o)}this.axisElement.call(this.d3Axis);this.axisElement.selectAll(".tick").select("text").style("visibility","visible");return this};e.prototype._hideCutOffTickLabels=function(){var i=this.availableWidth;var j=this.availableHeight;var k=this.axisElement.selectAll(".tick").select("text");var h=this.element.select(".bounding-box")[0][0].getBoundingClientRect();function g(l,m){return(m.left<=l.left&&l.right<=m.right&&m.top<=l.top&&l.bottom<=m.bottom)}k.each(function(l){if(!g(this.getBoundingClientRect(),h)){d3.select(this).style("visibility","hidden")}});return this};e.prototype.rescale=function(){return(this.element!=null)?this._render():null};e.prototype.scale=function(g){if(g==null){return this.axisScale}else{this.axisScale=g;this.d3Axis.scale(g._d3Scale);return this}};e.prototype.tickLabelPosition=function(g){if(g==null){return this.tickPositioning}else{this.tickPositioning=g;return this}};e.prototype.orient=function(g){if(g==null){return this.d3Axis.orient()}else{this.d3Axis.orient(g);return this}};e.prototype.ticks=function(){var g=[];for(var h=0;h<(arguments.length-0);h++){g[h]=arguments[h+0]}if(g==null||g.length===0){return this.d3Axis.ticks()}else{this.d3Axis.ticks(g);return this}};e.prototype.tickValues=function(){var g=[];for(var h=0;h<(arguments.length-0);h++){g[h]=arguments[h+0]}if(g==null){return this.d3Axis.tickValues()}else{this.d3Axis.tickValues(g);return this}};e.prototype.tickSize=function(g,h){if(g!=null&&h!=null){this.d3Axis.tickSize(g,h);return this}else{if(g!=null){this.d3Axis.tickSize(g);return this}else{return this.d3Axis.tickSize()}}};e.prototype.innerTickSize=function(g){if(g==null){return this.d3Axis.innerTickSize()}else{this.d3Axis.innerTickSize(g);return this}};e.prototype.outerTickSize=function(g){if(g==null){return this.d3Axis.outerTickSize()}else{this.d3Axis.outerTickSize(g);return this}};e.prototype.tickPadding=function(g){if(g==null){return this.d3Axis.tickPadding()}else{this.d3Axis.tickPadding(g);return this}};e.prototype.tickFormat=function(g){if(g==null){return this.d3Axis.tickFormat()}else{this.d3Axis.tickFormat(g);return this}};e.yWidth=50;e.xHeight=30;return e})(a.Component);a.Axis=c;var b=(function(f){__extends(e,f);function e(j,h,i){if(typeof i==="undefined"){i=null}var g=h.toLowerCase();if(g!=="top"&&g!=="bottom"){throw new Error(h+" is not a valid orientation for XAxis")}f.call(this,j,h,i);f.prototype.rowMinimum.call(this,c.xHeight);this._fixedWidth=false;this.tickLabelPosition("center")}e.prototype._anchor=function(g){f.prototype._anchor.call(this,g);this.axisElement.classed("x-axis",true);return this};e.prototype.tickLabelPosition=function(g){if(g==null){return f.prototype.tickLabelPosition.call(this)}else{var h=g.toLowerCase();if(h==="left"||h==="center"||h==="right"){if(h!=="center"){this.tickSize(12)}return f.prototype.tickLabelPosition.call(this,h)}else{throw new Error(g+" is not a valid tick label position for XAxis")}}};e.prototype._render=function(){f.prototype._render.call(this);if(this.tickLabelPosition()!=="center"){var g=this.axisElement.selectAll("text");g.attr("y","0px");if(this.orient()==="bottom"){g.attr("dy","1em")}else{g.attr("dy","-0.25em")}if(this.tickLabelPosition()==="right"){g.attr("dx","0.2em").style("text-anchor","start")}else{if(this.tickLabelPosition()==="left"){g.attr("dx","-0.2em").style("text-anchor","end")}}}this._hideCutOffTickLabels();return this};return e})(c);a.XAxis=b;var d=(function(e){__extends(f,e);function f(j,h,i){if(typeof i==="undefined"){i=null}var g=h.toLowerCase();if(g!=="left"&&g!=="right"){throw new Error(h+" is not a valid orientation for YAxis")}e.call(this,j,h,i);e.prototype.colMinimum.call(this,c.yWidth);this._fixedHeight=false;this.tickLabelPosition("MIDDLE")}f.prototype._anchor=function(g){e.prototype._anchor.call(this,g);this.axisElement.classed("y-axis",true);return this};f.prototype.tickLabelPosition=function(g){if(g==null){return e.prototype.tickLabelPosition.call(this)}else{var h=g.toLowerCase();if(h==="top"||h==="middle"||h==="bottom"){if(h!=="middle"){this.tickSize(30)}return e.prototype.tickLabelPosition.call(this,h)}else{throw new Error(g+" is not a valid tick label position for YAxis")}}};f.prototype._render=function(){e.prototype._render.call(this);if(this.tickLabelPosition()!=="middle"){var g=this.axisElement.selectAll("text");g.attr("x","0px");if(this.orient()==="left"){g.attr("dx","-0.25em")}else{g.attr("dx","0.25em")}if(this.tickLabelPosition()==="top"){g.attr("dy","-0.3em")}else{if(this.tickLabelPosition()==="bottom"){g.attr("dy","1em")}}}this._hideCutOffTickLabels();return this};return f})(c);a.YAxis=d})(Plottable||(Plottable={}));var Plottable;(function(a){var b=(function(c){__extends(d,c);function d(e){if(typeof e==="undefined"){e=[]}c.call(this);this.classed("component-group",true);this.components=e}d.prototype._addComponentToGroup=function(f,e){if(typeof e==="undefined"){e=false}if(e){this.components.unshift(f)}else{this.components.push(f)}if(this.element!=null){f._anchor(this.content.append("g"))}return this};d.prototype.merge=function(f){if(d.prototype.isPrototypeOf(f)){var e=new d([this,f]);return e}else{this._addComponentToGroup(f);return this}};d.prototype._anchor=function(e){var f=this;c.prototype._anchor.call(this,e);this.components.forEach(function(g){return g._anchor(f.content.append("g"))});return this};d.prototype._computeLayout=function(h,e,f,g){var i=this;c.prototype._computeLayout.call(this,h,e,f,g);this.components.forEach(function(j){j._computeLayout(0,0,i.availableWidth,i.availableHeight)});return this};d.prototype._render=function(){c.prototype._render.call(this);this.components.forEach(function(e){return e._render()});return this};d.prototype.isFixedWidth=function(){return this.components.every(function(e){return e.isFixedWidth()})};d.prototype.isFixedHeight=function(){return this.components.every(function(e){return e.isFixedHeight()})};return d})(a.Component);a.ComponentGroup=b})(Plottable||(Plottable={}));var Plottable;(function(a){var b=(function(c){__extends(d,c);function d(f,e){var g=this;c.call(this);this.classed("gridlines",true);this.xScale=f;this.yScale=e;if(this.xScale!=null){this.xScale.registerListener(function(){return g.redrawXLines()})}if(this.yScale!=null){this.yScale.registerListener(function(){return g.redrawYLines()})}}d.prototype._anchor=function(e){c.prototype._anchor.call(this,e);this.xLinesContainer=this.content.append("g").classed("x-gridlines",true);this.yLinesContainer=this.content.append("g").classed("y-gridlines",true);return this};d.prototype._render=function(){c.prototype._render.call(this);this.redrawXLines();this.redrawYLines();return this};d.prototype.redrawXLines=function(){var h=this;if(this.xScale!=null){var f=this.xScale.ticks();var e=function(i){return h.xScale.scale(i)};var g=this.xLinesContainer.selectAll("line").data(f);g.enter().append("line");g.attr("x1",e).attr("y1",0).attr("x2",e).attr("y2",this.availableHeight);g.exit().remove()}};d.prototype.redrawYLines=function(){var h=this;if(this.yScale!=null){var e=this.yScale.ticks();var g=function(i){return h.yScale.scale(i)};var f=this.yLinesContainer.selectAll("line").data(e);f.enter().append("line");f.attr("x1",0).attr("y1",g).attr("x2",this.availableWidth).attr("y2",g);f.exit().remove()}};return d})(a.Component);a.Gridlines=b})(Plottable||(Plottable={}));var Plottable;(function(a){})(Plottable||(Plottable={}));