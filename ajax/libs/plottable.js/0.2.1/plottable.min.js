/*!
Plottable v0.2.1 (https://github.com/palantir/plottable)
Copyright 2014 Palantir Technologies
Licensed under MIT (https://github.com/palantir/plottable/blob/master/LICENSE)
*/
;var Utils;(function(c){function e(g,h,f){return(Math.min(h,f)<=g&&g<=Math.max(h,f))}c.inRange=e;function d(f){return f.node().getBBox()}c.getBBox=d;function b(o,f,k){var j=k.text();k.text(o);var p=c.getBBox(k);var q=p.width;if(q<f){k.text(j);return o}k.text(o+"...");var g=k.node();var l=g.getSubStringLength(g.textContent.length-3,3);if(l>f){k.text(j);return""}var m=o.length;for(var h=1;h<m;h++){var n=g.getSubStringLength(0,h);if(n+l>f){k.text(j);return o.substr(0,h-1).trim()+"..."}}}c.truncateTextToLength=b;function a(g){var h=g.text();g.text("bqpdl");var f=c.getBBox(g).height;g.text(h);return f}c.getTextHeight=a})(Utils||(Utils={}));var Component=(function(){function a(){this.registeredInteractions=[];this.boxes=[];this.clipPathEnabled=false;this.fixedWidthVal=true;this.fixedHeightVal=true;this.rowMinimumVal=0;this.colMinimumVal=0;this.xOffsetVal=0;this.yOffsetVal=0;this.xAlignProportion=0;this.yAlignProportion=0;this.cssClasses=["component"]}a.prototype.anchor=function(b){var c=this;if(b.node().childNodes.length>0){throw new Error("Can't anchor to a non-empty element")}this.element=b;if(this.clipPathEnabled){this.generateClipPath()}this.cssClasses.forEach(function(d){c.element.classed(d,true)});this.cssClasses=null;this.hitBox=this.addBox("hit-box");this.addBox("bounding-box");this.hitBox.style("fill","#ffffff").style("opacity",0);this.registeredInteractions.forEach(function(d){return d.anchor(c.hitBox)});return this};a.prototype.computeLayout=function(g,b,d,f){var h=this;if(g==null||b==null||d==null||f==null){if(this.element==null){throw new Error("anchor must be called before computeLayout")}else{if(this.element.node().nodeName==="svg"){g=0;b=0;d=parseFloat(this.element.attr("width"));f=parseFloat(this.element.attr("height"))}else{throw new Error("null arguments cannot be passed to computeLayout() on a non-root (non-<svg>) node")}}}this.xOrigin=g;this.yOrigin=b;var e=this.xOrigin;var c=this.yOrigin;if(this.colMinimum()!==0&&this.isFixedWidth()){e+=(d-this.colMinimum())*this.xAlignProportion;e+=this.xOffsetVal;d=d>this.colMinimum()?this.colMinimum():d}if(this.rowMinimum()!==0&&this.isFixedHeight()){c+=(f-this.rowMinimum())*this.yAlignProportion;c+=this.yOffsetVal;f=f>this.rowMinimum()?this.rowMinimum():f}this.availableWidth=d;this.availableHeight=f;this.element.attr("transform","translate("+e+","+c+")");this.boxes.forEach(function(i){return i.attr("width",h.availableWidth).attr("height",h.availableHeight)});return this};a.prototype.render=function(){return this};a.prototype.renderTo=function(b){if(this.element==null){this.anchor(b)}if(this.element!==b){throw new Error("Can't renderTo a different element than was anchored to")}this.computeLayout().render();return this};a.prototype.xAlign=function(b){if(b==="LEFT"){this.xAlignProportion=0}else{if(b==="CENTER"){this.xAlignProportion=0.5}else{if(b==="RIGHT"){this.xAlignProportion=1}else{throw new Error("Unsupported alignment")}}}return this};a.prototype.yAlign=function(b){if(b==="TOP"){this.yAlignProportion=0}else{if(b==="CENTER"){this.yAlignProportion=0.5}else{if(b==="BOTTOM"){this.yAlignProportion=1}else{throw new Error("Unsupported alignment")}}}return this};a.prototype.xOffset=function(b){this.xOffsetVal=b;return this};a.prototype.yOffset=function(b){this.yOffsetVal=b;return this};a.prototype.addBox=function(c,b){if(this.element==null){throw new Error("Adding boxes before anchoring is currently disallowed")}var b=b==null?this.element:b;var d=b.append("rect");if(c!=null){d.classed(c,true)}this.boxes.push(d);if(this.availableWidth!=null&&this.availableHeight!=null){d.attr("width",this.availableWidth).attr("height",this.availableHeight)}return d};a.prototype.generateClipPath=function(){var b=a.clipPathId++;this.element.attr("clip-path","url(#clipPath"+b+")");var c=this.element.append("clipPath").attr("id","clipPath"+b);this.addBox("clip-rect",c)};a.prototype.registerInteraction=function(b){this.registeredInteractions.push(b);if(this.element!=null){b.anchor(this.hitBox)}return this};a.prototype.classed=function(b,d){if(d==null){if(this.element==null){return(this.cssClasses.indexOf(b)!==-1)}else{return this.element.classed(b)}}else{if(this.element==null){var c=this.cssClasses.indexOf(b);if(d&&c===-1){this.cssClasses.push(b)}else{if(!d&&c!==-1){this.cssClasses.splice(c,1)}}}else{this.element.classed(b,d)}return this}};a.prototype.rowMinimum=function(b){if(b!=null){this.rowMinimumVal=b;return this}else{return this.rowMinimumVal}};a.prototype.colMinimum=function(b){if(b!=null){this.colMinimumVal=b;return this}else{return this.colMinimumVal}};a.prototype.isFixedWidth=function(){return this.fixedWidthVal};a.prototype.isFixedHeight=function(){return this.fixedHeightVal};a.clipPathId=0;return a})();var __extends=this.__extends||function(f,a){for(var e in a){if(a.hasOwnProperty(e)){f[e]=a[e]}}function c(){this.constructor=f}c.prototype=a.prototype;f.prototype=new c()};var Scale=(function(){function a(b){this.broadcasterCallbacks=[];this.scale=b}a.prototype.domain=function(b){var c=this;if(b==null){return this.scale.domain()}else{this.scale.domain(b);this.broadcasterCallbacks.forEach(function(d){return d(c)});return this}};a.prototype.range=function(b){if(b==null){return this.scale.range()}else{this.scale.range(b);return this}};a.prototype.copy=function(){return new a(this.scale.copy())};a.prototype.registerListener=function(b){this.broadcasterCallbacks.push(b);return this};return a})();var QuantitiveScale=(function(a){__extends(b,a);function b(c){a.call(this,c)}b.prototype.invert=function(c){return this.scale.invert(c)};b.prototype.ticks=function(c){return this.scale.ticks(c)};b.prototype.copy=function(){return new b(this.scale.copy())};b.prototype.widenDomain=function(e){var d=this.domain();var c=[Math.min(e[0],d[0]),Math.max(e[1],d[1])];this.domain(c);return this};return b})(Scale);var LinearScale=(function(b){__extends(a,b);function a(c){b.call(this,c==null?d3.scale.linear():c);this.domain([Infinity,-Infinity])}a.prototype.copy=function(){return new a(this.scale.copy())};return a})(QuantitiveScale);var ColorScale=(function(b){__extends(a,b);function a(c){var d;switch(c){case"Category10":case"category10":case"10":d=d3.scale.category10();break;case"Category20":case"category20":case"20":d=d3.scale.category20();break;case"Category20b":case"category20b":case"20b":d=d3.scale.category20b();break;case"Category20c":case"category20c":case"20c":d=d3.scale.category20c();break;case null:case undefined:d=d3.scale.ordinal();default:throw new Error("Unsupported ColorScale type")}b.call(this,d)}return a})(Scale);var Interaction=(function(){function a(b){this.componentToListenTo=b}a.prototype.anchor=function(b){this.hitBox=b};a.prototype.registerWithComponent=function(){this.componentToListenTo.registerInteraction(this)};return a})();var PanZoomInteraction=(function(a){__extends(b,a);function b(f,c,e,d){var g=this;a.call(this,f);this.xScale=e;this.yScale=d;this.zoom=d3.behavior.zoom();this.zoom.x(this.xScale.scale);this.zoom.y(this.yScale.scale);this.zoom.on("zoom",function(){return g.rerenderZoomed()});this.registerWithComponent()}b.prototype.anchor=function(c){a.prototype.anchor.call(this,c);this.zoom(c)};b.prototype.rerenderZoomed=function(){var c=this.xScale.scale.domain();var d=this.yScale.scale.domain();this.xScale.domain(c);this.yScale.domain(d)};return b})(Interaction);var AreaInteraction=(function(b){__extends(a,b);function a(c){var d=this;b.call(this,c);this.dragInitialized=false;this.origin=[0,0];this.location=[0,0];this.dragBehavior=d3.behavior.drag();this.dragBehavior.on("dragstart",function(){return d.dragstart()});this.dragBehavior.on("drag",function(){return d.drag()});this.dragBehavior.on("dragend",function(){return d.dragend()});this.registerWithComponent()}a.prototype.callback=function(c){this.callbackToCall=c;return this};a.prototype.dragstart=function(){this.clearBox();var c=parseFloat(this.hitBox.attr("width"));var e=parseFloat(this.hitBox.attr("height"));var d=function(g,f){return function(h){return Math.min(Math.max(h,g),f)}};this.constrainX=d(0,c);this.constrainY=d(0,e)};a.prototype.drag=function(){if(!this.dragInitialized){this.origin=[d3.event.x,d3.event.y];this.dragInitialized=true}this.location=[this.constrainX(d3.event.x),this.constrainY(d3.event.y)];var e=Math.abs(this.origin[0]-this.location[0]);var d=Math.abs(this.origin[1]-this.location[1]);var c=Math.min(this.origin[0],this.location[0]);var f=Math.min(this.origin[1],this.location[1]);this.dragBox.attr("x",c).attr("y",f).attr("height",d).attr("width",e)};a.prototype.dragend=function(){if(!this.dragInitialized){return}this.dragInitialized=false;if(this.callbackToCall==null){return}var d=Math.min(this.origin[0],this.location[0]);var g=Math.max(this.origin[0],this.location[0]);var c=Math.min(this.origin[1],this.location[1]);var f=Math.max(this.origin[1],this.location[1]);var e={xMin:d,xMax:g,yMin:c,yMax:f};this.callbackToCall(e)};a.prototype.clearBox=function(){this.dragBox.attr("height",0).attr("width",0);return this};a.prototype.anchor=function(e){b.prototype.anchor.call(this,e);var c=a.CLASS_DRAG_BOX;var d=this.componentToListenTo.element;this.dragBox=d.append("rect").classed(c,true).attr("x",0).attr("y",0);e.call(this.dragBehavior);return this};a.CLASS_DRAG_BOX="drag-box";return a})(Interaction);var ZoomCallbackGenerator=(function(){function a(){this.xScaleMappings=[];this.yScaleMappings=[]}a.prototype.addXScale=function(c,b){if(b==null){b=c}this.xScaleMappings.push([c,b]);return this};a.prototype.addYScale=function(c,b){if(b==null){b=c}this.yScaleMappings.push([c,b]);return this};a.prototype.updateScale=function(h,f,b,d){var c=h.domain();var e=[h.invert(b),h.invert(d)];var g=(e[0]<e[1])===(c[0]<c[1]);if(!g){e.reverse()}f.domain(e)};a.prototype.getCallback=function(){var b=this;return function(c){b.xScaleMappings.forEach(function(d){b.updateScale(d[0],d[1],c.xMin,c.xMax)});b.yScaleMappings.forEach(function(d){b.updateScale(d[0],d[1],c.yMin,c.yMax)})}};return a})();var Label=(function(a){__extends(b,a);function b(d,c){if(typeof d==="undefined"){d=""}if(typeof c==="undefined"){c="horizontal"}a.call(this);this.classed(b.CSS_CLASS,true);this.setText(d);if(c==="horizontal"||c==="vertical-left"||c==="vertical-right"){this.orientation=c;if(c==="horizontal"){this.fixedWidthVal=false}else{this.fixedHeightVal=false}}else{throw new Error(c+" is not a valid orientation for LabelComponent")}this.xAlign("CENTER").yAlign("CENTER")}b.prototype.anchor=function(c){a.prototype.anchor.call(this,c);this.textElement=this.element.append("text");this.setText(this.text);return this};b.prototype.setText=function(c){this.text=c;if(this.element!=null){this.textElement.text(c);this.measureAndSetTextSize()}return this};b.prototype.measureAndSetTextSize=function(){var c=Utils.getBBox(this.textElement);this.textHeight=c.height;this.textLength=c.width;if(this.orientation==="horizontal"){this.rowMinimum(this.textHeight)}else{this.colMinimum(this.textHeight)}};b.prototype.truncateTextAndRemeasure=function(c){var d=Utils.truncateTextToLength(this.text,c,this.textElement);this.textElement.text(d);this.measureAndSetTextSize()};b.prototype.computeLayout=function(c,h,d,g){a.prototype.computeLayout.call(this,c,h,d,g);this.textElement.attr("dy",0);var f=Utils.getBBox(this.textElement);this.textElement.attr("dy",-f.y);var i=0;var e=0;if(this.orientation==="horizontal"){this.truncateTextAndRemeasure(this.availableWidth);i=(this.availableWidth-this.textLength)*this.xAlignProportion}else{this.truncateTextAndRemeasure(this.availableHeight);i=(this.availableHeight-this.textLength)*this.yAlignProportion;if(this.orientation==="vertical-right"){this.textElement.attr("transform","rotate(90)");e=-this.textHeight}else{this.textElement.attr("transform","rotate(-90)");i=-i-this.textLength}}this.textElement.attr("x",i);this.textElement.attr("y",e);return this};b.CSS_CLASS="label";return b})(Component);var TitleLabel=(function(b){__extends(a,b);function a(d,c){b.call(this,d,c);this.classed(a.CSS_CLASS,true)}a.CSS_CLASS="title-label";return a})(Label);var AxisLabel=(function(b){__extends(a,b);function a(d,c){b.call(this,d,c);this.classed(a.CSS_CLASS,true)}a.CSS_CLASS="axis-label";return a})(Label);var Renderer=(function(a){__extends(b,a);function b(c){if(typeof c==="undefined"){c={seriesName:"",data:[]}}a.call(this);this.clipPathEnabled=true;this.fixedWidthVal=false;this.fixedHeightVal=false;this.dataset=c;this.classed(b.CSS_CLASS,true)}b.prototype.data=function(c){this.renderArea.classed(this.dataset.seriesName,false);this.dataset=c;this.renderArea.classed(c.seriesName,true);return this};b.prototype.anchor=function(c){a.prototype.anchor.call(this,c);this.renderArea=c.append("g").classed("render-area",true).classed(this.dataset.seriesName,true);return this};b.CSS_CLASS="renderer";return b})(Component);var XYRenderer=(function(a){__extends(b,a);function b(f,k,e,d,h){var i=this;a.call(this,f);this.classed(b.CSS_CLASS);this.xAccessor=(d!=null)?d:b.defaultXAccessor;this.yAccessor=(h!=null)?h:b.defaultYAccessor;this.xScale=k;this.yScale=e;var g=f.data;var j=d3.extent(g,this.xAccessor);this.xScale.widenDomain(j);var c=d3.extent(g,this.yAccessor);this.yScale.widenDomain(c);this.xScale.registerListener(function(){return i.rescale()});this.yScale.registerListener(function(){return i.rescale()})}b.prototype.computeLayout=function(c,f,d,e){a.prototype.computeLayout.call(this,c,f,d,e);this.xScale.range([0,this.availableWidth]);this.yScale.range([this.availableHeight,0]);return this};b.prototype.invertXYSelectionArea=function(f){var e=this.xScale.invert(f.xMin);var h=this.xScale.invert(f.xMax);var c=this.yScale.invert(f.yMin);var g=this.yScale.invert(f.yMax);var d={xMin:e,xMax:h,yMin:c,yMax:g};return d};b.prototype.getSelectionFromArea=function(c){var e=this;var d=function(g){var f=e.xAccessor(g);var h=e.yAccessor(g);return Utils.inRange(f,c.xMin,c.xMax)&&Utils.inRange(h,c.yMin,c.yMax)};return this.dataSelection.filter(d)};b.prototype.getDataIndicesFromArea=function(c){var f=this;var e=function(h){var g=f.xAccessor(h);var i=f.yAccessor(h);return Utils.inRange(g,c.xMin,c.xMax)&&Utils.inRange(i,c.yMin,c.yMax)};var d=[];this.dataset.data.forEach(function(h,g){if(e(h)){d.push(g)}});return d};b.prototype.rescale=function(){if(this.element!=null){this.render()}};b.CSS_CLASS="xy-renderer";b.defaultXAccessor=function(c){return c.x};b.defaultYAccessor=function(c){return c.y};return b})(Renderer);var LineRenderer=(function(a){__extends(b,a);function b(g,f,d,e,c){a.call(this,g,f,d,e,c);this.classed(b.CSS_CLASS,true)}b.prototype.anchor=function(c){a.prototype.anchor.call(this,c);this.path=this.renderArea.append("path");return this};b.prototype.render=function(){var c=this;a.prototype.render.call(this);this.line=d3.svg.line().x(function(d){return c.xScale.scale(c.xAccessor(d))}).y(function(d){return c.yScale.scale(c.yAccessor(d))});this.dataSelection=this.path.classed("line",true).classed(this.dataset.seriesName,true).datum(this.dataset.data);this.path.attr("d",this.line);return this};b.CSS_CLASS="line-renderer";return b})(XYRenderer);var CircleRenderer=(function(b){__extends(a,b);function a(h,g,e,f,d,c){if(typeof c==="undefined"){c=3}b.call(this,h,g,e,f,d);this.classed(a.CSS_CLASS,true);this.size=c}a.prototype.render=function(){var c=this;b.prototype.render.call(this);this.dataSelection=this.renderArea.selectAll("circle").data(this.dataset.data);this.dataSelection.enter().append("circle");this.dataSelection.attr("cx",function(d){return c.xScale.scale(c.xAccessor(d))}).attr("cy",function(d){return c.yScale.scale(c.yAccessor(d))}).attr("r",this.size);this.dataSelection.exit().remove();return this};a.CSS_CLASS="circle-renderer";return a})(XYRenderer);var BarRenderer=(function(a){__extends(b,a);function b(g,l,e,d,k,h){a.call(this,g,l,e,d,h);this.barPaddingPx=1;this.classed(b.CSS_CLASS,true);var c=this.yScale.domain();if(!Utils.inRange(0,c[0],c[1])){var f=0;var i=c[1];this.yScale.widenDomain([f,i])}this.x2Accessor=(k!=null)?k:b.defaultX2Accessor;var j=d3.extent(g.data,this.x2Accessor);this.xScale.widenDomain(j)}b.prototype.render=function(){var e=this;a.prototype.render.call(this);var d=this.yScale.range();var c=Math.max(d[0],d[1]);this.dataSelection=this.renderArea.selectAll("rect").data(this.dataset.data);this.dataSelection.enter().append("rect");this.dataSelection.attr("x",function(f){return e.xScale.scale(e.xAccessor(f))+e.barPaddingPx}).attr("y",function(f){return e.yScale.scale(e.yAccessor(f))}).attr("width",function(f){return(e.xScale.scale(e.x2Accessor(f))-e.xScale.scale(e.xAccessor(f))-2*e.barPaddingPx)}).attr("height",function(f){return c-e.yScale.scale(e.yAccessor(f))});this.dataSelection.exit().remove();return this};b.CSS_CLASS="bar-renderer";b.defaultX2Accessor=function(c){return c.x2};return b})(XYRenderer);var Table=(function(b){__extends(a,b);function a(d){if(typeof d==="undefined"){d=[]}b.call(this);this.rowPadding=0;this.colPadding=0;this.classed(a.CSS_CLASS,true);var c=function(e){return e==null?new Component():e};d=d.map(function(e){return e.map(c)});this.rows=d;this.rowWeights=this.rows.map(function(){return null});this.colWeights=d3.transpose(this.rows).map(function(){return null})}a.prototype.addComponent=function(f,e,d){if(this.element!=null){throw new Error("addComponent cannot be called after anchoring (for the moment)")}this.padTableToSize(f+1,e+1);var c=this.rows[f][e];if(c.constructor.name!=="Component"){throw new Error("addComponent cannot be called on a cell where a component already exists (for the moment)")}this.rows[f][e]=d;return this};a.prototype.padTableToSize=function(e,f){for(var d=0;d<e;d++){if(this.rows[d]===undefined){this.rows[d]=[];this.rowWeights[d]=null}for(var c=0;c<f;c++){if(this.rows[d][c]===undefined){this.rows[d][c]=new Component()}}}for(c=0;c<f;c++){if(this.colWeights[c]===undefined){this.colWeights[c]=null}}};a.prototype.anchor=function(c){var d=this;b.prototype.anchor.call(this,c);this.rows.forEach(function(e,f){e.forEach(function(h,g){h.anchor(d.element.append("g"))})});return this};a.prototype.computeLayout=function(i,g,n,e){var h=this;b.prototype.computeLayout.call(this,i,g,n,e);var f=this.availableWidth-this.colMinimum();var q=this.availableHeight-this.rowMinimum();if(f<0||q<0){throw new Error("Insufficient Space")}var m=d3.transpose(this.rows);var c=a.calcComponentWeights(this.rowWeights,this.rows,function(s){return s.isFixedHeight()});var l=a.calcComponentWeights(this.colWeights,m,function(s){return s.isFixedWidth()});var r=a.calcProportionalSpace(c,q);var p=a.calcProportionalSpace(l,f);var j=function(s){return s[0]+s[1]};var k=d3.zip(r,this.rowMinimums).map(j);var o=d3.zip(p,this.colMinimums).map(j);var d=0;this.rows.forEach(function(t,u){var s=0;t.forEach(function(w,v){w.computeLayout(s,d,o[v],k[u]);s+=o[v]+h.colPadding});d+=k[u]+h.rowPadding});return this};a.calcComponentWeights=function(c,e,d){return c.map(function(g,h){if(g!=null){return g}var f=e[h].map(d);var j=f.reduce(function(k,i){return k&&i});return j?0:1})};a.calcProportionalSpace=function(e,f){var d=d3.sum(e);if(d===0){var c=e.length;return e.map(function(g){return f/c})}else{return e.map(function(g){return f*g/d})}};a.prototype.render=function(){this.rows.forEach(function(c,d){c.forEach(function(f,e){f.render()})});return this};a.prototype.padding=function(c,d){this.rowPadding=c;this.colPadding=d;return this};a.prototype.rowWeight=function(c,d){this.rowWeights[c]=d;return this};a.prototype.colWeight=function(c,d){this.colWeights[c]=d;return this};a.prototype.rowMinimum=function(c){if(c!=null){throw new Error("Row minimum cannot be directly set on Table")}else{this.rowMinimums=this.rows.map(function(d){return d3.max(d,function(e){return e.rowMinimum()})});return d3.sum(this.rowMinimums)+this.rowPadding*(this.rows.length-1)}};a.prototype.colMinimum=function(c){if(c!=null){throw new Error("Col minimum cannot be directly set on Table")}else{var d=d3.transpose(this.rows);this.colMinimums=d.map(function(e){return d3.max(e,function(f){return f.colMinimum()})});return d3.sum(this.colMinimums)+this.colPadding*(d.length-1)}};a.fixedSpace=function(d,e){var c=function(g){return g.reduce(function(i,h){return i&&h})};var f=function(g){return c(g.map(e))};return c(d.map(f))};a.prototype.isFixedWidth=function(){var c=d3.transpose(this.rows);return a.fixedSpace(c,function(d){return d.isFixedWidth()})};a.prototype.isFixedHeight=function(){return a.fixedSpace(this.rows,function(d){return d.isFixedHeight()})};a.CSS_CLASS="table";return a})(Component);var ScaleDomainCoordinator=(function(){function a(b){var c=this;this.scales=b;this.rescaleInProgress=false;this.scales.forEach(function(d){return d.registerListener(function(e){return c.rescale(e)})})}a.prototype.rescale=function(c){if(this.rescaleInProgress){return}this.rescaleInProgress=true;var b=c.domain();this.scales.forEach(function(d){return d.domain(b)});this.rescaleInProgress=false};return a})();var Legend=(function(b){__extends(a,b);function a(c){b.call(this);this.classed(a.CSS_CLASS,true);this.colMinimum(120);this.colorScale=c;this.xAlign("RIGHT").yAlign("TOP");this.xOffset(5).yOffset(5)}a.prototype.scale=function(c){this.colorScale=c;return this};a.prototype.rowMinimum=function(c){if(c!=null){throw new Error("Row minimum cannot be directly set on Legend")}else{var d=this.measureTextHeight();return this.colorScale.domain().length*d}};a.prototype.measureTextHeight=function(){var d=this.element.append("g").classed(a.SUBELEMENT_CLASS,true);var c=Utils.getTextHeight(d.append("text"));d.remove();return c};a.prototype.render=function(){b.prototype.render.call(this);var f=this.colorScale.domain();var g=this.measureTextHeight();var e=this.colMinimum()-g-a.MARGIN;this.element.selectAll("."+a.SUBELEMENT_CLASS).remove();var d=this.element.selectAll("."+a.SUBELEMENT_CLASS).data(f);var c=d.enter().append("g").classed(a.SUBELEMENT_CLASS,true).attr("transform",function(j,h){return"translate(0,"+h*g+")"});c.append("rect").attr("x",a.MARGIN).attr("y",a.MARGIN).attr("width",g-a.MARGIN*2).attr("height",g-a.MARGIN*2);c.append("text").attr("x",g).attr("y",a.MARGIN+g/2);d.selectAll("rect").attr("fill",this.colorScale.scale);d.selectAll("text").text(function(j,h){return Utils.truncateTextToLength(j,e,d3.select(this))});return this};a.CSS_CLASS="legend";a.SUBELEMENT_CLASS="legend-row";a.MARGIN=5;return a})(Component);var Axis=(function(b){__extends(a,b);function a(e,c,d){var f=this;b.call(this);this.scale=e;this.classed(a.CSS_CLASS,true);this.clipPathEnabled=true;this.orientation=c;this.isXAligned=this.orientation==="bottom"||this.orientation==="top";this.d3axis=d3.svg.axis().scale(this.scale.scale).orient(this.orientation);if(d==null){this.formatter=d3.format(".3s")}else{this.formatter=d}this.d3axis.tickFormat(this.formatter);this.cachedScale=1;this.cachedTranslate=0;this.scale.registerListener(function(){return f.rescale()})}a.axisXTransform=function(d,c){d.attr("transform",function(e){return"translate("+c(e)+",0)"})};a.axisYTransform=function(c,d){c.attr("transform",function(e){return"translate(0,"+d(e)+")"})};a.prototype.anchor=function(c){b.prototype.anchor.call(this,c);this.axisElement=this.element.append("g").classed("axis",true);return this};a.prototype.transformString=function(e,d){var c=this.isXAligned?""+e:"0,"+e;return"translate("+c+")"};a.prototype.render=function(){if(this.orientation==="left"){this.axisElement.attr("transform","translate("+a.yWidth+", 0)")}if(this.orientation==="top"){this.axisElement.attr("transform","translate(0,"+a.xHeight+")")}var g=this.scale.domain();var o=Math.abs(g[1]-g[0]);var h=+d3.min(g);var j=+d3.max(g);var i;var n=g[0]<g[1];if(typeof(g[0])==="number"){i=n?[h-o,j+o]:[j+o,h-o]}else{i=n?[new Date(h-o),new Date(j+o)]:[new Date(j+o),new Date(h-o)]}if(this.scale.ticks!=null){var e=this.scale;var f=10;var k=e.ticks(f);var l=e.domain();var c=l[1]-l[0];var d=function(p){return Math.abs(p/c/f)<0.0001?0:p};k=k.map(d);this.d3axis.tickValues(k)}this.axisElement.call(this.d3axis);var m=this.axisElement.node().getBBox();if(m.height>this.availableHeight||m.width>this.availableWidth){this.axisElement.classed("error",true)}return this};a.prototype.rescale=function(){return(this.element!=null)?this.render():null};a.CSS_CLASS="axis";a.yWidth=50;a.xHeight=30;return a})(Component);var XAxis=(function(b){__extends(a,b);function a(e,c,d){if(typeof d==="undefined"){d=null}b.call(this,e,c,d);b.prototype.rowMinimum.call(this,Axis.xHeight);this.fixedWidthVal=false}return a})(Axis);var YAxis=(function(a){__extends(b,a);function b(e,c,d){if(typeof d==="undefined"){d=null}a.call(this,e,c,d);a.prototype.colMinimum.call(this,Axis.yWidth);this.fixedHeightVal=false}return b})(Axis);var ComponentGroup=(function(a){__extends(b,a);function b(c){if(typeof c==="undefined"){c=[]}a.call(this);this.components=c}b.prototype.addComponent=function(d){this.components.push(d);if(this.element!=null){d.anchor(this.element.append("g"))}return this};b.prototype.anchor=function(c){var d=this;a.prototype.anchor.call(this,c);this.components.forEach(function(e){return e.anchor(d.element.append("g"))});return this};b.prototype.computeLayout=function(f,c,d,e){var g=this;a.prototype.computeLayout.call(this,f,c,d,e);this.components.forEach(function(h){h.computeLayout(g.xOrigin,g.yOrigin,g.availableWidth,g.availableHeight)});return this};b.prototype.render=function(){a.prototype.render.call(this);this.components.forEach(function(d){return d.render()});return this};b.prototype.isFixedWidth=function(){var c=this.components.map(function(d){return d.isFixedWidth()});return c.reduce(function(e,d){return e&&d})};b.prototype.isFixedHeight=function(){var c=this.components.map(function(d){return d.isFixedHeight()});return c.reduce(function(e,d){return e&&d})};return b})(Component);