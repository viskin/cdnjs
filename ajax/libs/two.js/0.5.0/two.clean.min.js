(function(D,L,x,l){var r=this;var i=Math.sin,e=Math.cos,o=Math.atan2,y=Math.sqrt,F=Math.round,t=Math.abs,f=Math.PI,d=f*2,B=f/2,s=Math.pow,J=Math.min,p=Math.max;var C=0;var a={temp:document.createElement("div"),hasEventListeners:L.isFunction(r.addEventListener),bind:function(P,O,N,M){if(this.hasEventListeners){P.addEventListener(O,N,!!M)}else{P.attachEvent("on"+O,N)}return this},unbind:function(P,O,N,M){if(this.hasEventListeners){P.removeEventListeners(O,N,!!M)}else{P.detachEvent("on"+O,N)}return this}};var j=r.Two=function(M){var O=L.defaults(M||{},{fullscreen:false,width:640,height:480,type:j.Types.svg,autostart:false});L.each(O,function(Q,P){if(P==="fullscreen"||P==="width"||P==="height"||P==="autostart"){return}this[P]=Q},this);if(L.isElement(O.domElement)){this.type=j.Types[O.domElement.tagName.toLowerCase()]}this.renderer=new j[this.type](this);j.Utils.setPlaying.call(this,O.autostart);this.frameCount=0;if(O.fullscreen){var N=L.bind(G,this);L.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"});L.extend(this.renderer.domElement.style,{display:"block",top:0,left:0,right:0,bottom:0,position:"fixed"});a.bind(r,"resize",N);N()}else{if(!L.isElement(O.domElement)){this.renderer.setSize(O.width,O.height,this.ratio);this.width=O.width;this.height=O.height}}this.scene=this.renderer.scene;j.Instances.push(this)};L.extend(j,{Array:r.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Version:"v0.5.0",Identifier:"two_",Properties:{hierarchy:"hierarchy",demotion:"demotion"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change",remove:"remove",insert:"insert",order:"order"},Commands:{move:"M",line:"L",curve:"C",close:"Z"},Resolution:8,Instances:[],noConflict:function(){r.Two=D;return this},uniqueId:function(){var M=C;C++;return M},Utils:{defineProperty:function(P){var O=this;var N="_"+P;var M="_flag"+P.charAt(0).toUpperCase()+P.slice(1);Object.defineProperty(O,P,{get:function(){return this[N]},set:function(Q){this[N]=Q;this[M]=true}})},release:function(M){if(!L.isObject(M)){return}if(L.isFunction(M.unbind)){M.unbind()}if(M.vertices){if(L.isFunction(M.vertices.unbind)){M.vertices.unbind()}L.each(M.vertices,function(N){if(L.isFunction(N.unbind)){N.unbind()}})}if(M.children){L.each(M.children,function(N){j.Utils.release(N)})}},xhr:function(M,O){var N=new XMLHttpRequest();N.open("GET",M);N.onreadystatechange=function(){if(N.readyState===4&&N.status===200){O(N.responseText)}};N.send();return N},Curve:{CollinearityEpsilon:s(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:0.25,angle:0,epsilon:0.01},abscissas:[[0.5773502691896257],[0,0.7745966692414834],[0.33998104358485626,0.8611363115940526],[0,0.5384693101056831,0.906179845938664],[0.2386191860831969,0.6612093864662645,0.932469514203152],[0,0.4058451513773972,0.7415311855993945,0.9491079123427585],[0.1834346424956498,0.525532409916329,0.7966664774136267,0.9602898564975363],[0,0.3242534234038089,0.6133714327005904,0.8360311073266358,0.9681602395076261],[0.14887433898163122,0.4333953941292472,0.6794095682990244,0.8650633666889845,0.9739065285171717],[0,0.26954315595234496,0.5190961292068118,0.7301520055740494,0.8870625997680953,0.978228658146057],[0.1252334085114689,0.3678314989981802,0.5873179542866175,0.7699026741943047,0.9041172563704749,0.9815606342467192],[0,0.2304583159551348,0.44849275103644687,0.6423493394403402,0.8015780907333099,0.9175983992229779,0.9841830547185881],[0.10805494870734367,0.31911236892788974,0.5152486363581541,0.6872929048116855,0.827201315069765,0.9284348836635735,0.9862838086968123],[0,0.20119409399743451,0.3941513470775634,0.5709721726085388,0.7244177313601701,0.8482065834104272,0.937273392400706,0.9879925180204854],[0.09501250983763744,0.2816035507792589,0.45801677765722737,0.6178762444026438,0.755404408355003,0.8656312023878318,0.9445750230732326,0.9894009349916499]],weights:[[1],[0.8888888888888888,0.5555555555555556],[0.6521451548625461,0.34785484513745385],[0.5688888888888889,0.47862867049936647,0.23692688505618908],[0.46791393457269104,0.3607615730481386,0.17132449237917036],[0.4179591836734694,0.3818300505051189,0.27970539148927664,0.1294849661688697],[0.362683783378362,0.31370664587788727,0.22238103445337448,0.10122853629037626],[0.3302393550012598,0.31234707704000286,0.26061069640293544,0.1806481606948574,0.08127438836157441],[0.29552422471475287,0.26926671930999635,0.21908636251598204,0.1494513491505806,0.06667134430868814],[0.2729250867779006,0.26280454451024665,0.23319376459199048,0.18629021092773426,0.1255803694649046,0.05566856711617366],[0.24914704581340277,0.2334925365383548,0.20316742672306592,0.16007832854334622,0.10693932599531843,0.04717533638651183],[0.2325515532308739,0.22628318026289723,0.2078160475368885,0.17814598076194574,0.13887351021978725,0.09212149983772845,0.04048400476531588],[0.2152638534631578,0.2051984637212956,0.18553839747793782,0.15720316715819355,0.12151857068790319,0.08015808715976021,0.03511946033175186],[0.2025782419255613,0.19843148532711158,0.1861610000155622,0.16626920581699392,0.13957067792615432,0.10715922046717194,0.07036604748810812,0.03075324199611727],[0.1894506104550685,0.18260341504492358,0.16915651939500254,0.14959598881657674,0.12462897125553388,0.09515851168249279,0.062253523938647894,0.027152459411754096]]},devicePixelRatio:r.devicePixelRatio||1,getBackingStoreRatio:function(M){return M.webkitBackingStorePixelRatio||M.mozBackingStorePixelRatio||M.msBackingStorePixelRatio||M.oBackingStorePixelRatio||M.backingStorePixelRatio||1},getRatio:function(M){return j.Utils.devicePixelRatio/u(M)},setPlaying:function(M){this.playing=!!M;return this},getComputedMatrix:function(O,M){M=(M&&M.identity())||new j.Matrix();var P=O,N=[];while(P&&P._matrix){N.push(P._matrix);P=P.parent}N.reverse();L.each(N,function(Q){var R=Q.elements;M.multiply(R[0],R[1],R[2],R[3],R[4],R[5],R[6],R[7],R[8],R[9])});return M},deltaTransformPoint:function(P,M,Q){var O=M*P.a+Q*P.c+0;var N=M*P.b+Q*P.d+0;return new j.Vector(O,N)},decomposeMatrix:function(M){var Q=j.Utils.deltaTransformPoint(M,0,1);var O=j.Utils.deltaTransformPoint(M,1,0);var P=((180/Math.PI)*Math.atan2(Q.y,Q.x)-90);var N=((180/Math.PI)*Math.atan2(O.y,O.x));return{translateX:M.e,translateY:M.f,scaleX:Math.sqrt(M.a*M.a+M.b*M.b),scaleY:Math.sqrt(M.c*M.c+M.d*M.d),skewX:P,skewY:N,rotation:P}},applySvgAttributes:function(O,P){var Q={},W={},R,V,U,S;if(getComputedStyle){var M=getComputedStyle(O);R=M.length;while(R--){V=M[R];U=M[V];if(U!==undefined){W[V]=U}}}R=O.attributes.length;while(R--){S=O.attributes[R];Q[S.nodeName]=S.value}if(!L.isUndefined(W.opacity)){W["stroke-opacity"]=W.opacity;W["fill-opacity"]=W.opacity}L.extend(W,Q);W.visible=!(L.isUndefined(W.display)&&W.display==="none")||(L.isUndefined(W.visibility)&&W.visibility==="hidden");for(V in W){U=W[V];switch(V){case"transform":if(U==="none"){break}var N=O.getCTM();if(N===null){break}var T=j.Utils.decomposeMatrix(O.getCTM());P.translation.set(T.translateX,T.translateY);P.rotation=T.rotation;P.scale=T.scaleX;if(W.x){P.translation.x=W.x}if(W.y){P.translation.y=W.y}break;case"visible":P.visible=U;break;case"stroke-linecap":P.cap=U;break;case"stroke-linejoin":P.join=U;break;case"stroke-miterlimit":P.miter=U;break;case"stroke-width":P.linewidth=parseFloat(U);break;case"stroke-opacity":case"fill-opacity":case"opacity":P.opacity=parseFloat(U);break;case"fill":case"stroke":if(/url\(\#.*\)/i.test(U)){P[V]=this.getById(U.replace(/url\(\#(.*)\)/i,"$1"))}else{P[V]=(U==="none")?"transparent":U}break;case"id":P.id=U;break;case"class":P.classList=U.split(" ");break}}return P},read:{svg:function(){return j.Utils.read.g.apply(this,arguments)},g:function(Q){var R=new j.Group();j.Utils.applySvgAttributes.call(this,Q,R);for(var P=0,N=Q.childNodes.length;P<N;P++){var T=Q.childNodes[P];var M=T.nodeName;if(!M){return}var O=M.replace(/svg\:/ig,"").toLowerCase();if(O in j.Utils.read){var S=j.Utils.read[O].call(R,T);R.add(S)}}return R},polygon:function(O,M){var N=O.getAttribute("points");var Q=[];N.replace(/(-?[\d\.?]+),(-?[\d\.?]+)/g,function(R,T,S){Q.push(new j.Anchor(parseFloat(T),parseFloat(S)))});var P=new j.Path(Q,!M).noStroke();P.fill="black";return j.Utils.applySvgAttributes.call(this,O,P)},polyline:function(M){return j.Utils.read.polygon.call(this,M,true)},path:function(P){var W=P.getAttribute("d");var R=new j.Anchor();var Q,T;var S=false,N=false;var O=W.match(/[a-df-z][^a-df-z]*/ig);var V=O.length-1;L.each(O.slice(0),function(aa,ac){var ag=aa[0];var ad=ag.toLowerCase();var af=aa.slice(1).trim().split(/[\s,]+|(?=\s?[+\-])/);var Z,ah,aj=[],ai;if(ac<=0){O=[]}switch(ad){case"h":case"v":if(af.length>1){ai=1}break;case"m":case"l":case"t":if(af.length>2){ai=2}break;case"s":case"q":if(af.length>4){ai=4}break;case"c":if(af.length>6){ai=6}break;case"a":break}if(ai){for(var ab=0,Y=af.length,X=0;ab<Y;ab+=ai){var ae=ag;if(X>0){switch(ag){case"m":ae="l";break;case"M":ae="L";break}}aj.push([ae].concat(af.slice(ab,ab+ai)).join(" "));X++}O=Array.prototype.concat.apply(O,aj)}else{O.push(aa)}});var U=L.flatten(L.map(O,function(ae,aH){var al,aA,ay;var aP=ae[0];var Y=aP.toLowerCase();T=ae.slice(1).trim();T=T.replace(/(-?\d+(?:\.\d*)?)[eE]([+\-]?\d+)/g,function(aR,aT,aS){return parseFloat(aT)*s(10,aS)});T=T.split(/[\s,]+|(?=\s?[+\-])/);N=aP===Y;var aj,aQ,ah,aO,ag,aM,af,aK,Z;switch(Y){case"z":if(aH>=V){S=true}else{aA=R.x;ay=R.y;al=new j.Anchor(aA,ay,undefined,undefined,undefined,undefined,j.Commands.close)}break;case"m":case"l":aA=parseFloat(T[0]);ay=parseFloat(T[1]);al=new j.Anchor(aA,ay,undefined,undefined,undefined,undefined,Y==="m"?j.Commands.move:j.Commands.line);if(N){al.addSelf(R)}R=al;break;case"h":case"v":var aL=Y==="h"?"x":"y";var aJ=aL==="x"?"y":"x";al=new j.Anchor(undefined,undefined,undefined,undefined,undefined,undefined,j.Commands.line);al[aL]=parseFloat(T[0]);al[aJ]=R[aJ];if(N){al[aL]+=R[aL]}R=al;break;case"c":case"s":aj=R.x;aQ=R.y;if(!Q){Q=new j.Vector()}if(Y==="c"){ah=parseFloat(T[0]);aO=parseFloat(T[1]);ag=parseFloat(T[2]);aM=parseFloat(T[3]);af=parseFloat(T[4]);aK=parseFloat(T[5])}else{Z=z(R,Q,N);ah=Z.x;aO=Z.y;ag=parseFloat(T[0]);aM=parseFloat(T[1]);af=parseFloat(T[2]);aK=parseFloat(T[3])}if(N){ah+=aj;aO+=aQ;ag+=aj;aM+=aQ;af+=aj;aK+=aQ}if(!L.isObject(R.controls)){j.Anchor.AppendCurveProperties(R)}R.controls.right.set(ah-R.x,aO-R.y);al=new j.Anchor(af,aK,ag-af,aM-aK,undefined,undefined,j.Commands.curve);R=al;Q=al.controls.left;break;case"t":case"q":aj=R.x;aQ=R.y;if(!Q){Q=new j.Vector()}if(Q.isZero()){ah=aj;aO=aQ}else{ah=Q.x;aQ=Q.y}if(Y==="q"){ag=parseFloat(T[0]);aM=parseFloat(T[1]);af=parseFloat(T[1]);aK=parseFloat(T[2])}else{Z=z(R,Q,N);ag=Z.x;aM=Z.y;af=parseFloat(T[0]);aK=parseFloat(T[1])}if(N){ah+=aj;aO+=aQ;ag+=aj;aM+=aQ;af+=aj;aK+=aQ}if(!L.isObject(R.controls)){j.Anchor.AppendCurveProperties(R)}R.controls.right.set(ah-R.x,aO-R.y);al=new j.Anchor(af,aK,ag-af,aM-aK,undefined,undefined,j.Commands.curve);R=al;Q=al.controls.left;break;case"a":aj=R.x;aQ=R.y;var av=parseFloat(T[0]);var au=parseFloat(T[1]);var ar=parseFloat(T[2])*Math.PI/180;var am=parseFloat(T[3]);var at=parseFloat(T[4]);af=parseFloat(T[5]);aK=parseFloat(T[6]);if(N){af+=aj;aK+=aQ}var ad=(af-aj)/2;var ac=(aK-aQ)/2;var az=ad*Math.cos(ar)+ac*Math.sin(ar);var ax=-ad*Math.sin(ar)+ac*Math.cos(ar);var aa=av*av;var aD=au*au;var ai=az*az;var aN=ax*ax;var aG=ai/aa+aN/aD;if(aG>1){av*=Math.sqrt(aG);au*=Math.sqrt(aG)}var X=Math.sqrt((aa*aD-aa*aN-aD*ai)/(aa*aN+aD*ai));if(L.isNaN(X)){X=0}else{if(am!=at&&X>0){X*=-1}}var aq=X*av*ax/au;var ao=-X*au*az/av;var ap=aq*Math.cos(ar)-ao*Math.sin(ar)+(aj+af)/2;var an=aq*Math.sin(ar)+ao*Math.cos(ar)+(aQ+aK)/2;var aF=function(aR){return Math.sqrt(Math.pow(aR[0],2)+Math.pow(aR[1],2))};var aE=function(aS,aR){return(aS[0]*aR[0]+aS[1]*aR[1])/(aF(aS)*aF(aR))};var aL=function(aS,aR){return(aS[0]*aR[1]<aS[1]*aR[0]?-1:1)*Math.acos(aE(aS,aR))};var aw=aL([1,0],[(az-aq)/av,(ax-ao)/au]);var aC=[(az-aq)/av,(ax-ao)/au];var aB=[(-az-aq)/av,(-ax-ao)/au];var ab=aL(aC,aB);if(aE(aC,aB)<=-1){ab=Math.PI}if(aE(aC,aB)>=1){ab=0}if(am){ab=c(ab,Math.PI*2)}if(at&&ab>0){ab-=Math.PI*2}var ak=j.Resolution;var aI=new j.Matrix().translate(ap,an).rotate(ar);al=L.map(L.range(ak),function(aU){var aV=1-(aU/(ak-1));var aT=aV*ab+aw;var aR=av*Math.cos(aT);var aW=au*Math.sin(aT);var aS=aI.multiply(aR,aW,1);return new j.Anchor(aS.x,aS.y,false,false,false,false,j.Commands.line)});al.push(new j.Anchor(af,aK,false,false,false,false,j.Commands.line));R=al[al.length-1];Q=R.controls.left;break}return al}));if(U.length<=1){return}U=L.compact(U);var M=new j.Path(U,S,undefined,true).noStroke();M.fill="black";return j.Utils.applySvgAttributes.call(this,P,M)},circle:function(Q){var M=parseFloat(Q.getAttribute("cx"));var S=parseFloat(Q.getAttribute("cy"));var P=parseFloat(Q.getAttribute("r"));var N=j.Resolution;var O=L.map(L.range(N),function(V){var W=V/N;var U=W*d;var T=P*e(U);var X=P*i(U);return new j.Anchor(T,X)});var R=new j.Path(O,true,true).noStroke();R.translation.set(M,S);R.fill="black";return j.Utils.applySvgAttributes.call(this,Q,R)},ellipse:function(S){var N=parseFloat(S.getAttribute("cx"));var T=parseFloat(S.getAttribute("cy"));var Q=parseFloat(S.getAttribute("rx"));var M=parseFloat(S.getAttribute("ry"));var O=j.Resolution;var P=L.map(L.range(O),function(W){var X=W/O;var V=X*d;var U=Q*e(V);var Y=M*i(V);return new j.Anchor(U,Y)});var R=new j.Path(P,true,true).noStroke();R.translation.set(N,T);R.fill="black";return j.Utils.applySvgAttributes.call(this,S,R)},rect:function(N){var S=parseFloat(N.getAttribute("x"))||0;var R=parseFloat(N.getAttribute("y"))||0;var M=parseFloat(N.getAttribute("width"));var U=parseFloat(N.getAttribute("height"));var O=M/2;var P=U/2;var T=[new j.Anchor(O,P),new j.Anchor(-O,P),new j.Anchor(-O,-P),new j.Anchor(O,-P)];var Q=new j.Path(T,true).noStroke();Q.translation.set(S+O,R+P);Q.fill="black";return j.Utils.applySvgAttributes.call(this,N,Q)},line:function(P){var O=parseFloat(P.getAttribute("x1"));var T=parseFloat(P.getAttribute("y1"));var M=parseFloat(P.getAttribute("x2"));var S=parseFloat(P.getAttribute("y2"));var N=M-O;var V=S-T;var Q=N/2;var R=V/2;var U=[new j.Anchor(-Q,-R),new j.Anchor(Q,R)];var W=new j.Path(U).noFill();W.translation.set(O+Q,T+R);return j.Utils.applySvgAttributes.call(this,P,W)},lineargradient:function(S){var O=parseFloat(S.getAttribute("x1"));var aa=parseFloat(S.getAttribute("y1"));var N=parseFloat(S.getAttribute("x2"));var Y=parseFloat(S.getAttribute("y2"));var R=(N+O)/2;var P=(Y+aa)/2;var ab=[];for(var V=0;V<S.children.length;V++){var Q=S.children[V];var U=parseFloat(Q.getAttribute("offset"));var T=Q.getAttribute("stop-color");var X=Q.getAttribute("stop-opacity");var M=Q.getAttribute("style");if(L.isNull(T)){var W=M.match(/stop\-color\:\s?([\#a-fA-F0-9]*)/);T=W&&W.length>1?W[1]:undefined}if(L.isNull(X)){var W=M.match(/stop\-opacity\:\s?([0-1\.\-]*)/);X=W&&W.length>1?parseFloat(W[1]):1}ab.push(new j.Gradient.Stop(U,T,X))}var Z=new j.LinearGradient(O-R,aa-P,N-R,Y-P,ab);return j.Utils.applySvgAttributes.call(this,S,Z)},radialgradient:function(R){var W=parseFloat(R.getAttribute("cx"))||0;var T=parseFloat(R.getAttribute("cy"))||0;var M=parseFloat(R.getAttribute("r"));var U=parseFloat(R.getAttribute("fx"));var S=parseFloat(R.getAttribute("fy"));if(L.isNaN(U)){U=W}if(L.isNaN(S)){S=T}var Q=Math.abs(W+U)/2;var O=Math.abs(T+S)/2;var ac=[];for(var Y=0;Y<R.children.length;Y++){var P=R.children[Y];var X=parseFloat(P.getAttribute("offset"));var V=P.getAttribute("stop-color");var aa=P.getAttribute("stop-opacity");var N=P.getAttribute("style");if(L.isNull(V)){var Z=N.match(/stop\-color\:\s?([\#a-fA-F0-9]*)/);V=Z&&Z.length>1?Z[1]:undefined}if(L.isNull(aa)){var Z=N.match(/stop\-opacity\:\s?([0-1\.\-]*)/);aa=Z&&Z.length>1?parseFloat(Z[1]):1}ac.push(new j.Gradient.Stop(X,V,aa))}var ab=new j.RadialGradient(W-Q,T-O,M,ac,U-Q,S-O);return j.Utils.applySvgAttributes.call(this,R,ab)}},subdivide:function(O,U,N,T,M,S,V,R,P){P=P||j.Utils.Curve.RecursionLimit;var Q=P+1;if(O===V&&U===R){return[new j.Anchor(V,R)]}return L.map(L.range(0,Q),function(Y){var X=Y/Q;var W=k(X,O,N,M,V);var Z=k(X,U,T,S,R);return new j.Anchor(W,Z)})},getPointOnCubicBezier:function(P,N,M,R,Q){var O=1-P;return(O*O*O*N)+(3*O*O*P*M)+(3*O*P*P*R)+(P*P*P*Q)},getCurveLength:function(ac,Q,aa,O,X,N,W,M,ad){if(ac===aa&&Q===O&&X===W&&N===M){var V=W-ac;var T=M-Q;return y(V*V+T*T)}var U=9*(aa-X)+3*(W-ac),ab=6*(ac+X)-12*aa,R=3*(aa-ac),S=9*(O-N)+3*(M-Q),Z=6*(Q+N)-12*O,P=3*(O-Q);var Y=function(ag){var af=(U*ag+ab)*ag+R,ae=(S*ag+Z)*ag+P;return y(af*af+ae*ae)};return h(Y,0,1,ad||j.Utils.Curve.RecursionLimit)},integrate:function(T,V,U,P){var W=j.Utils.Curve.abscissas[P-2],X=j.Utils.Curve.weights[P-2],O=0.5*(U-V),M=O+V,R=0,Q=(P+1)>>1,S=P&1?X[R++]*T(M):0;while(R<Q){var N=O*W[R];S+=X[R++]*(T(M+N)+T(M-N))}return O*S},getCurveFromPoints:function(W,Q){var N=W.length,V=N-1;for(var O=0;O<N;O++){var U=W[O];if(!L.isObject(U.controls)){j.Anchor.AppendCurveProperties(U)}var M=Q?c(O-1,N):p(O-1,0);var P=Q?c(O+1,N):J(O+1,V);var T=W[M];var S=U;var R=W[P];K(T,S,R);S._command=O===0?j.Commands.move:j.Commands.curve;S.controls.left.x=L.isNumber(S.controls.left.x)?S.controls.left.x:S.x;S.controls.left.y=L.isNumber(S.controls.left.y)?S.controls.left.y:S.y;S.controls.right.x=L.isNumber(S.controls.right.x)?S.controls.right.x:S.x;S.controls.right.y=L.isNumber(S.controls.right.y)?S.controls.right.y:S.y}},getControlPoints:function(P,N,T){var O=g(P,N);var M=g(T,N);var S=A(P,N);var R=A(T,N);var Q=(O+M)/2;N.u=L.isObject(N.controls.left)?N.controls.left:new j.Vector(0,0);N.v=L.isObject(N.controls.right)?N.controls.right:new j.Vector(0,0);if(S<0.0001||R<0.0001){if(!N._relative){N.controls.left.copy(N);N.controls.right.copy(N)}return N}S*=0.33;R*=0.33;if(M<O){Q+=B}else{Q-=B}N.controls.left.x=e(Q)*S;N.controls.left.y=i(Q)*S;Q-=f;N.controls.right.x=e(Q)*R;N.controls.right.y=i(Q)*R;if(!N._relative){N.controls.left.x+=N.x;N.controls.left.y+=N.y;N.controls.right.x+=N.x;N.controls.right.y+=N.y}return N},getReflection:function(N,M,O){return new j.Vector(2*N.x-(M.x+N.x)-(O?N.x:0),2*N.y-(M.y+N.y)-(O?N.y:0))},getAnchorsFromArcData:function(M,T,O,N,R,Q,U){var S=new j.Matrix().translate(M.x,M.y).rotate(T);var P=j.Resolution;return L.map(L.range(P),function(Y){var Z=(Y+1)/P;if(!!U){Z=1-Z}var X=Z*Q+R;var V=O*Math.cos(X);var aa=N*Math.sin(X);var W=new j.Anchor(V,aa);j.Anchor.AppendCurveProperties(W);W.command=j.Commands.line;return W})},ratioBetween:function(M,N){return(M.x*N.x+M.y*N.y)/(M.length()*N.length())},angleBetween:function(M,P){var O,N;if(arguments.length>=4){O=arguments[0]-arguments[2];N=arguments[1]-arguments[3];return o(N,O)}O=M.x-P.x;N=M.y-P.y;return o(N,O)},distanceBetweenSquared:function(P,O){var N=P.x-O.x;var M=P.y-O.y;return N*N+M*M},distanceBetween:function(N,M){return y(w(N,M))},toFixed:function(M){return Math.floor(M*1000)/1000},mod:function(N,M){while(N<0){N+=M}return N%M},Collection:function(){Array.call(this);if(arguments.length>1){Array.prototype.push.apply(this,arguments)}else{if(arguments[0]&&Array.isArray(arguments[0])){Array.prototype.push.apply(this,arguments[0])}}},Error:function(M){this.name="two.js";this.message=M}}});j.Utils.Error.prototype=new Error();j.Utils.Error.prototype.constructor=j.Utils.Error;j.Utils.Collection.prototype=new Array();j.Utils.Collection.constructor=j.Utils.Collection;L.extend(j.Utils.Collection.prototype,x.Events,{pop:function(){var M=Array.prototype.pop.apply(this,arguments);this.trigger(j.Events.remove,[M]);return M},shift:function(){var M=Array.prototype.shift.apply(this,arguments);this.trigger(j.Events.remove,[M]);return M},push:function(){var M=Array.prototype.push.apply(this,arguments);this.trigger(j.Events.insert,arguments);return M},unshift:function(){var M=Array.prototype.unshift.apply(this,arguments);this.trigger(j.Events.insert,arguments);return M},splice:function(){var M=Array.prototype.splice.apply(this,arguments);var N;this.trigger(j.Events.remove,M);if(arguments.length>2){N=this.slice(arguments[0],arguments.length-2);this.trigger(j.Events.insert,N);this.trigger(j.Events.order)}return M},sort:function(){Array.prototype.sort.apply(this,arguments);this.trigger(j.Events.order);return this},reverse:function(){Array.prototype.reverse.apply(this,arguments);this.trigger(j.Events.order);return this}});var A=j.Utils.distanceBetween,I=j.Utils.getAnchorsFromArcData,w=j.Utils.distanceBetweenSquared,E=j.Utils.ratioBetween,g=j.Utils.angleBetween,K=j.Utils.getControlPoints,n=j.Utils.getCurveFromPoints,q=j.Utils.solveSegmentIntersection,m=j.Utils.decoupleShapes,c=j.Utils.mod,u=j.Utils.getBackingStoreRatio,k=j.Utils.getPointOnCubicBezier,H=j.Utils.getCurveLength,h=j.Utils.integrate,z=j.Utils.getReflection;L.extend(j.prototype,x.Events,{appendTo:function(M){M.appendChild(this.renderer.domElement);return this},play:function(){j.Utils.setPlaying.call(this,true);return this.trigger(j.Events.play)},pause:function(){this.playing=false;return this.trigger(j.Events.pause)},update:function(){var P=!!this._lastFrame;var N=v();this.frameCount++;if(P){this.timeDelta=parseFloat((N-this._lastFrame).toFixed(3))}this._lastFrame=N;var O=this.width;var M=this.height;var Q=this.renderer;if(O!==Q.width||M!==Q.height){Q.setSize(O,M,this.ratio)}this.trigger(j.Events.update,this.frameCount,this.timeDelta);return this.render()},render:function(){this.renderer.render();return this.trigger(j.Events.render,this.frameCount)},add:function(N){var M=N;if(!(M instanceof Array)){M=L.toArray(arguments)}this.scene.add(M);return this},remove:function(N){var M=N;if(!(M instanceof Array)){M=L.toArray(arguments)}this.scene.remove(M);return this},clear:function(){this.scene.remove(L.toArray(this.scene.children));return this},makeLine:function(O,Q,N,P){var M=new j.Line(O,Q,N,P);this.scene.add(M);return M},makeRectangle:function(N,Q,O,M){var P=new j.Rectangle(N,Q,O,M);this.scene.add(P);return P},makeRoundedRectangle:function(N,R,O,M,Q){var P=new j.RoundedRectangle(N,R,O,M,Q);this.scene.add(P);return P},makeCircle:function(N,M,O){return this.makeEllipse(N,M,O,O)},makeEllipse:function(N,M,Q,P){var O=new j.Ellipse(N,M,Q,P);this.scene.add(O);return O},makeStar:function(N,M,R,Q,O){var P=new j.Star(N,M,R,Q,O);this.scene.add(P);return P},makeCurve:function(M){var O=arguments.length,U=M;if(!L.isArray(M)){U=[];for(var P=0;P<O;P+=2){var S=arguments[P];if(!L.isNumber(S)){break}var R=arguments[P+1];U.push(new j.Anchor(S,R))}}var T=arguments[O-1];var N=new j.Path(U,!(L.isBoolean(T)?T:undefined),true);var Q=N.getBoundingClientRect();N.center().translation.set(Q.left+Q.width/2,Q.top+Q.height/2);this.scene.add(N);return N},makePolygon:function(N,M,P,O){var Q=new j.Polygon(N,M,P,O);this.scene.add(Q);return Q},makeCurvedPolygon:function(N,M,R,Q,O){var P=new j.CurvedPolygon(N,M,or,ir,Q);this.scene.add(P);return P},makeArcSegment:function(P,N,S,T,M,R,Q){var O=new j.ArcSegment(P,N,S,T,M,R,Q);this.scene.add(O);return O},makePath:function(M){var N=arguments.length,T=M;if(!L.isArray(M)){T=[];for(var O=0;O<N;O+=2){var R=arguments[O];if(!L.isNumber(R)){break}var Q=arguments[O+1];T.push(new j.Anchor(R,Q))}}var S=arguments[N-1];var U=new j.Path(T,!(L.isBoolean(S)?S:undefined));var P=U.getBoundingClientRect();U.center().translation.set(P.left+P.width/2,P.top+P.height/2);this.scene.add(U);return U},makeLinearGradient:function(N,P,M,O){var Q=Array.prototype.slice.call(arguments,4);var R=new j.LinearGradient(N,P,M,O,Q);this.add(R);return R},makeRadialGradient:function(M,N,P){var O=Array.prototype.slice.call(arguments,3);var Q=new j.RadialGradient(M,N,P,O);this.add(Q);return Q},makeGroup:function(O){var M=O;if(!(M instanceof Array)){M=L.toArray(arguments)}var N=new j.Group();this.scene.add(N);N.add(M);return N},interpret:function(O,P){var M=O.tagName.toLowerCase();if(!(M in j.Utils.read)){return null}var N=j.Utils.read[M].call(this,O);if(P&&N instanceof j.Group){this.add(N.children)}else{this.add(N)}return N},load:function(P,Q){var M=[],O,N;if(/.*\.svg/ig.test(P)){j.Utils.xhr(P,L.bind(function(R){a.temp.innerHTML=R;for(N=0;N<a.temp.children.length;N++){O=a.temp.children[N];M.push(this.interpret(O))}Q(M.length<=1?M[0]:M,a.temp.children.length<=1?a.temp.children[0]:a.temp.children)},this));return this}a.temp.innerHTML=P;for(N=0;N<a.temp.children.length;N++){O=a.temp.children[N];M.push(this.interpret(O))}Q(M.length<=1?M[0]:M,a.temp.children.length<=1?a.temp.children[0]:a.temp.children);return this}});function G(){var N=document.body.getBoundingClientRect();var O=this.width=N.width;var M=this.height=N.height;this.renderer.setSize(O,M,this.ratio);this.trigger(j.Events.resize,O,M)}function v(){return((r.performance&&r.performance.now)?r.performance:Date).now()}(function(){l(arguments.callee);j.Instances.forEach(function(M){if(M.playing){M.update()}})})();if(typeof define==="function"&&define.amd){define(function(){return j})}else{if(typeof module!="undefined"&&module.exports){module.exports=j}}})(this.Two||{},typeof require==="function"?require("underscore"):_,typeof require==="function"?require("backbone"):Backbone,typeof require==="function"?require("requestAnimationFrame"):requestAnimationFrame);(function(i,d,h,g){var a=i.Vector=function(j,k){this.x=j||0;this.y=k||0};d.extend(a,{zero:new i.Vector()});d.extend(a.prototype,h.Events,{set:function(j,k){this.x=j;this.y=k;return this},copy:function(j){this.x=j.x;this.y=j.y;return this},clear:function(){this.x=0;this.y=0;return this},clone:function(){return new a(this.x,this.y)},add:function(k,j){this.x=k.x+j.x;this.y=k.y+j.y;return this},addSelf:function(j){this.x+=j.x;this.y+=j.y;return this},sub:function(k,j){this.x=k.x-j.x;this.y=k.y-j.y;return this},subSelf:function(j){this.x-=j.x;this.y-=j.y;return this},multiplySelf:function(j){this.x*=j.x;this.y*=j.y;return this},multiplyScalar:function(j){this.x*=j;this.y*=j;return this},divideScalar:function(j){if(j){this.x/=j;this.y/=j}else{this.set(0,0)}return this},negate:function(){return this.multiplyScalar(-1)},dot:function(j){return this.x*j.x+this.y*j.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(j){return Math.sqrt(this.distanceToSquared(j))},distanceToSquared:function(l){var k=this.x-l.x,j=this.y-l.y;return k*k+j*j},setLength:function(j){return this.normalize().multiplyScalar(j)},equals:function(k,j){j=(typeof j==="undefined")?0.0001:j;return(this.distanceTo(k)<j)},lerp:function(k,l){var j=(k.x-this.x)*l+this.x;var m=(k.y-this.y)*l+this.y;return this.set(j,m)},isZero:function(j){j=(typeof j==="undefined")?0.0001:j;return(this.length()<j)},toString:function(){return this.x+","+this.y},toObject:function(){return{x:this.x,y:this.y}}});var e={set:function(j,k){this._x=j;this._y=k;return this.trigger(i.Events.change)},copy:function(j){this._x=j.x;this._y=j.y;return this.trigger(i.Events.change)},clear:function(){this._x=0;this._y=0;return this.trigger(i.Events.change)},clone:function(){return new a(this._x,this._y)},add:function(k,j){this._x=k.x+j.x;this._y=k.y+j.y;return this.trigger(i.Events.change)},addSelf:function(j){this._x+=j.x;this._y+=j.y;return this.trigger(i.Events.change)},sub:function(k,j){this._x=k.x-j.x;this._y=k.y-j.y;return this.trigger(i.Events.change)},subSelf:function(j){this._x-=j.x;this._y-=j.y;return this.trigger(i.Events.change)},multiplySelf:function(j){this._x*=j.x;this._y*=j.y;return this.trigger(i.Events.change)},multiplyScalar:function(j){this._x*=j;this._y*=j;return this.trigger(i.Events.change)},divideScalar:function(j){if(j){this._x/=j;this._y/=j;return this.trigger(i.Events.change)}return this.clear()},negate:function(){return this.multiplyScalar(-1)},dot:function(j){return this._x*j.x+this._y*j.y},lengthSquared:function(){return this._x*this._x+this._y*this._y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(j){return Math.sqrt(this.distanceToSquared(j))},distanceToSquared:function(l){var k=this._x-l.x,j=this._y-l.y;return k*k+j*j},setLength:function(j){return this.normalize().multiplyScalar(j)},equals:function(k,j){j=(typeof j==="undefined")?0.0001:j;return(this.distanceTo(k)<j)},lerp:function(k,l){var j=(k.x-this._x)*l+this._x;var m=(k.y-this._y)*l+this._y;return this.set(j,m)},isZero:function(j){j=(typeof j==="undefined")?0.0001:j;return(this.length()<j)},toString:function(){return this._x+","+this._y},toObject:function(){return{x:this._x,y:this._y}}};var f={get:function(){return this._x},set:function(j){this._x=j;this.trigger(i.Events.change,"x")}};var c={get:function(){return this._y},set:function(j){this._y=j;this.trigger(i.Events.change,"y")}};i.Vector.prototype.bind=i.Vector.prototype.on=function(){if(!this._bound){this._x=this.x;this._y=this.y;Object.defineProperty(this,"x",f);Object.defineProperty(this,"y",c);d.extend(this,e);this._bound=true}h.Events.bind.apply(this,arguments);return this}})(Two,typeof require==="function"?require("underscore"):_,typeof require==="function"?require("backbone"):Backbone,typeof require==="function"?require("requestAnimationFrame"):requestAnimationFrame);(function(h,d,g,f){var c=h.Commands;var a=h.Anchor=function(i,o,k,j,m,l,n){h.Vector.call(this,i,o);this._broadcast=d.bind(function(){this.trigger(h.Events.change)},this);this._command=n||c.move;this._relative=true;if(!n){return this}a.AppendCurveProperties(this);if(d.isNumber(k)){this.controls.left.x=k}if(d.isNumber(j)){this.controls.left.y=j}if(d.isNumber(m)){this.controls.right.x=m}if(d.isNumber(l)){this.controls.right.y=l}};d.extend(a,{AppendCurveProperties:function(i){i.controls={left:new h.Vector(0,0),right:new h.Vector(0,0)}}});var e={listen:function(){if(!d.isObject(this.controls)){a.AppendCurveProperties(this)}this.controls.left.bind(h.Events.change,this._broadcast);this.controls.right.bind(h.Events.change,this._broadcast);return this},ignore:function(){this.controls.left.unbind(h.Events.change,this._broadcast);this.controls.right.unbind(h.Events.change,this._broadcast);return this},clone:function(){var i=this.controls;var j=new h.Anchor(this.x,this.y,i&&i.left.x,i&&i.left.y,i&&i.right.x,i&&i.right.y,this.command);j.relative=this._relative;return j},toObject:function(){var i={x:this.x,y:this.y};if(this._command){i.command=this._command}if(this._relative){i.relative=this._relative}if(this.controls){i.controls={left:this.controls.left.toObject(),right:this.controls.right.toObject()}}return i}};Object.defineProperty(a.prototype,"command",{get:function(){return this._command},set:function(i){this._command=i;if(this._command===c.curve&&!d.isObject(this.controls)){a.AppendCurveProperties(this)}return this.trigger(h.Events.change)}});Object.defineProperty(a.prototype,"relative",{get:function(){return this._relative},set:function(i){if(this._relative==i){return this}this._relative=!!i;return this.trigger(h.Events.change)}});d.extend(a.prototype,h.Vector.prototype,e);h.Anchor.prototype.bind=h.Anchor.prototype.on=function(){h.Vector.prototype.bind.apply(this,arguments);d.extend(this,e)};h.Anchor.prototype.unbind=h.Anchor.prototype.off=function(){h.Vector.prototype.unbind.apply(this,arguments);d.extend(this,e)}})(Two,typeof require==="function"?require("underscore"):_,typeof require==="function"?require("backbone"):Backbone,typeof require==="function"?require("requestAnimationFrame"):requestAnimationFrame);(function(i,d,h,g){var f=Math.cos,c=Math.sin,e=Math.tan;var a=i.Matrix=function(k,j,p,o,n,m){this.elements=new i.Array(9);var l=k;if(!d.isArray(l)){l=d.toArray(arguments)}this.identity().set(l)};d.extend(a,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(I,H,G){if(H.length<=3){var F,D,v,J=I;var N=H[0]||0,L=H[1]||0,K=H[2]||0;F=J[0]*N+J[1]*L+J[2]*K;D=J[3]*N+J[4]*L+J[5]*K;v=J[6]*N+J[7]*L+J[8]*K;return{x:F,y:D,z:v}}var n=I[0],m=I[1],l=I[2];var k=I[3],j=I[4],Q=I[5];var P=I[6],O=I[7],M=I[8];var E=H[0],w=H[1],u=H[2];var t=H[3],s=H[4],r=H[5];var q=H[6],p=H[7],o=H[8];G=G||new i.Array(9);G[0]=n*E+m*t+l*q;G[1]=n*w+m*s+l*p;G[2]=n*u+m*r+l*o;G[3]=k*E+j*t+Q*q;G[4]=k*w+j*s+Q*p;G[5]=k*u+j*r+Q*o;G[6]=P*E+O*t+M*q;G[7]=P*w+O*s+M*p;G[8]=P*u+O*r+M*o;return G}});d.extend(a.prototype,h.Events,{set:function(j){var k=j;if(!d.isArray(k)){k=d.toArray(arguments)}d.extend(this.elements,k);return this.trigger(i.Events.change)},identity:function(){this.set(a.Identity);return this},multiply:function(T,R,Q,P,O,N,M,L,K){var G=arguments,J=G.length;if(J<=1){d.each(this.elements,function(l,x){this.elements[x]=l*T},this);return this.trigger(i.Events.change)}if(J<=3){var F,D,w;T=T||0;R=R||0;Q=Q||0;O=this.elements;F=O[0]*T+O[1]*R+O[2]*Q;D=O[3]*T+O[4]*R+O[5]*Q;w=O[6]*T+O[7]*R+O[8]*Q;return{x:F,y:D,z:w}}var I=this.elements;var H=G;var o=I[0],n=I[1],m=I[2];var k=I[3],j=I[4],W=I[5];var V=I[6],U=I[7],S=I[8];var E=H[0],C=H[1],v=H[2];var u=H[3],t=H[4],s=H[5];var r=H[6],q=H[7],p=H[8];this.elements[0]=o*E+n*u+m*r;this.elements[1]=o*C+n*t+m*q;this.elements[2]=o*v+n*s+m*p;this.elements[3]=k*E+j*u+W*r;this.elements[4]=k*C+j*t+W*q;this.elements[5]=k*v+j*s+W*p;this.elements[6]=V*E+U*u+S*r;this.elements[7]=V*C+U*t+S*q;this.elements[8]=V*v+U*s+S*p;return this.trigger(i.Events.change)},inverse:function(n){var u=this.elements;n=n||new i.Matrix();var m=u[0],l=u[1],k=u[2];var x=u[3],w=u[4],v=u[5];var s=u[6],r=u[7],p=u[8];var o=p*w-v*r;var j=-p*x+v*s;var t=r*x-w*s;var q=m*o+l*j+k*t;if(!q){return null}q=1/q;n.elements[0]=o*q;n.elements[1]=(-p*l+k*r)*q;n.elements[2]=(v*l-k*w)*q;n.elements[3]=j*q;n.elements[4]=(p*m-k*s)*q;n.elements[5]=(-v*m+k*x)*q;n.elements[6]=t*q;n.elements[7]=(-r*m+l*s)*q;n.elements[8]=(w*m-l*x)*q;return n},scale:function(m,k){var j=arguments.length;if(j<=1){k=m}return this.multiply(m,0,0,0,k,0,0,0,1)},rotate:function(k){var l=f(k);var j=c(k);return this.multiply(l,-j,0,j,l,0,0,0,1)},translate:function(j,k){return this.multiply(1,0,j,0,1,k,0,0,1)},skewX:function(k){var j=e(k);return this.multiply(1,j,0,0,1,0,0,0,1)},skewY:function(k){var j=e(k);return this.multiply(1,0,0,j,1,0,0,0,1)},toString:function(k){var j=[];this.toArray(k,j);return j.join(" ")},toArray:function(s,k){var j=this.elements;var l=!!k;var v=parseFloat(j[0].toFixed(3));var u=parseFloat(j[1].toFixed(3));var t=parseFloat(j[2].toFixed(3));var r=parseFloat(j[3].toFixed(3));var q=parseFloat(j[4].toFixed(3));var p=parseFloat(j[5].toFixed(3));if(!!s){var o=parseFloat(j[6].toFixed(3));var n=parseFloat(j[7].toFixed(3));var m=parseFloat(j[8].toFixed(3));if(l){k[0]=v;k[1]=r;k[2]=o;k[3]=u;k[4]=q;k[5]=n;k[6]=t;k[7]=p;k[8]=m;return}return[v,r,o,u,q,n,t,p,m]}if(l){k[0]=v;k[1]=r;k[2]=u;k[3]=q;k[4]=t;k[5]=p;return}return[v,r,u,q,t,p]},clone:function(){var r,q,p,o,n,m,l,k,j;r=this.elements[0];q=this.elements[1];p=this.elements[2];o=this.elements[3];n=this.elements[4];m=this.elements[5];l=this.elements[6];k=this.elements[7];j=this.elements[8];return new i.Matrix(r,q,p,o,n,m,l,k,j)}})})(Two,typeof require==="function"?require("underscore"):_,typeof require==="function"?require("backbone"):Backbone,typeof require==="function"?require("requestAnimationFrame"):requestAnimationFrame);(function(i,d,h,g){var e=i.Utils.mod,a=i.Utils.toFixed;var c={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(l,k){var j=l;var m=document.createElementNS(this.ns,j);if(j==="svg"){k=d.defaults(k||{},{version:this.version})}if(!d.isEmpty(k)){c.setAttributes(m,k)}return m},setAttributes:function(m,j){var l=Object.keys(j);for(var k=0;k<l.length;k++){m.setAttribute(l[k],j[l[k]])}return this},removeAttributes:function(l,j){for(var k in j){l.removeAttribute(k)}return this},toString:function(B,k){var A=B.length,r=A-1,D,I="";for(var C=0;C<A;C++){var F=B[C];var m;var w=k?e(C-1,A):Math.max(C-1,0);var z=k?e(C+1,A):Math.min(C+1,r);var H=B[w];var E=B[z];var v,u,o,n,t,j,G,p;var s=a(F._x);var q=a(F._y);switch(F._command){case i.Commands.close:m=i.Commands.close;break;case i.Commands.curve:t=(H.controls&&H.controls.right)||H;j=(F.controls&&F.controls.left)||F;if(H._relative){v=a((t.x+H.x));u=a((t.y+H.y))}else{v=a(t.x);u=a(t.y)}if(F._relative){o=a((j.x+F.x));n=a((j.y+F.y))}else{o=a(j.x);n=a(j.y)}m=((C===0)?i.Commands.move:i.Commands.curve)+" "+v+" "+u+" "+o+" "+n+" "+s+" "+q;break;case i.Commands.move:D=F;m=i.Commands.move+" "+s+" "+q;break;default:m=F._command+" "+s+" "+q}if(C>=r&&k){if(F._command===i.Commands.curve){E=D;G=(F.controls&&F.controls.right)||F;p=(E.controls&&E.controls.left)||E;if(F._relative){v=a((G.x+F.x));u=a((G.y+F.y))}else{v=a(G.x);u=a(G.y)}if(E._relative){o=a((p.x+E.x));n=a((p.y+E.y))}else{o=a(p.x);n=a(p.y)}s=a(E.x);q=a(E.y);m+=" C "+v+" "+u+" "+o+" "+n+" "+s+" "+q}m+=" Z"}I+=m+" "}return I},getClip:function(k){var l=k._renderer.clip;if(!l){var j=k;while(j.parent){j=j.parent}l=k._renderer.clip=c.createElement("clipPath");j.defs.appendChild(l)}return l},group:{appendChild:function(k){var l=k._renderer.elem;if(!l){return}var j=l.nodeName;if(!j||/(radial|linear)gradient/i.test(j)||k._clip){return}this.elem.appendChild(l)},removeChild:function(k){var l=k._renderer.elem;if(!l||l.parentElement!=this.elem){return}var j=l.nodeName;if(!j){return}if(k._clip){return}this.elem.removeChild(l)},orderChild:function(j){this.elem.appendChild(j._renderer.elem)},renderChild:function(j){c[j._renderer.type].render.call(j,this)},render:function(m){this._update();if(this._opacity===0&&!this._flagOpacity){return this}if(!this._renderer.elem){this._renderer.elem=c.createElement("g",{id:this.id});m.appendChild(this._renderer.elem)}var j=this._matrix.manual||this._flagMatrix;var l={domElement:m,elem:this._renderer.elem};if(j){this._renderer.elem.setAttribute("transform","matrix("+this._matrix.toString()+")")}for(var k=0;k<this.children.length;k++){var n=this.children[k];c[n._renderer.type].render.call(n,m)}if(this._flagOpacity){this._renderer.elem.setAttribute("opacity",this._opacity)}if(this._flagAdditions){this.additions.forEach(c.group.appendChild,l)}if(this._flagSubtractions){this.subtractions.forEach(c.group.removeChild,l)}if(this._flagOrder){this.children.forEach(c.group.orderChild,l)}if(this._flagMask){if(this._mask){this._renderer.elem.setAttribute("clip-path","url(#"+this._mask.id+")")}else{this._renderer.elem.removeAttribute("clip-path")}}return this.flagReset()}},path:{render:function(o){this._update();if(this._opacity===0&&!this._flagOpacity){return this}var n={};var j=this._matrix.manual||this._flagMatrix;if(j){n.transform="matrix("+this._matrix.toString()+")"}if(this._flagVertices){var k=c.toString(this._vertices,this._closed);n.d=k}if(this._flagFill){n.fill=this._fill&&this._fill.id?"url(#"+this._fill.id+")":this._fill}if(this._flagStroke){n.stroke=this._stroke}if(this._flagLinewidth){n["stroke-width"]=this._linewidth}if(this._flagOpacity){n["stroke-opacity"]=this._opacity;n["fill-opacity"]=this._opacity}if(this._flagVisible){n.visibility=this._visible?"visible":"hidden"}if(this._flagCap){n["stroke-linecap"]=this._cap}if(this._flagJoin){n["stroke-linejoin"]=this._join}if(this._flagMiter){n["stroke-miterlimit"]=this._miter}if(!this._renderer.elem){n.id=this.id;this._renderer.elem=c.createElement("path",n);o.appendChild(this._renderer.elem)}else{c.setAttributes(this._renderer.elem,n)}if(this._flagClip){var m=c.getClip(this);var l=this._renderer.elem;if(this._clip){l.removeAttribute("id");m.setAttribute("id",this.id);m.appendChild(l)}else{m.removeAttribute("id");l.setAttribute("id",this.id);this.parent._renderer.elem.appendChild(l)}}return this.flagReset()}},"linear-gradient":{render:function(n){this._update();var m={};if(this._flagEndPoints){m.x1=this.left._x;m.y1=this.left._y;m.x2=this.right._x;m.y2=this.right._y}if(this._flagSpread){m.spreadMethod=this._spread}if(!this._renderer.elem){m.id=this.id;m.gradientUnits="userSpaceOnUse";this._renderer.elem=c.createElement("linearGradient",m);n.defs.appendChild(this._renderer.elem)}else{c.setAttributes(this._renderer.elem,m)}if(this._flagStops){this._renderer.elem.children.length=0;for(var l=0;l<this.stops.length;l++){var k=this.stops[l];var j={};if(k._flagOffset){j.offset=100*k._offset+"%"}if(k._flagColor){j["stop-color"]=k._color}if(k._flagOpacity){j["stop-opacity"]=k._opacity}if(!k._renderer.elem){k._renderer.elem=c.createElement("stop",j)}else{c.setAttributes(k._renderer.elem,j)}this._renderer.elem.appendChild(k._renderer.elem);k.flagReset()}}return this.flagReset()}},"radial-gradient":{render:function(n){this._update();var m={};if(this._flagCenter){m.cx=this.center._x;m.cy=this.center._y}if(this._flagFocal){m.fx=this.focal._x;m.fy=this.focal._y}if(this._flagRadius){m.r=this._radius}if(this._flagSpread){m.spreadMethod=this._spread}if(!this._renderer.elem){m.id=this.id;m.gradientUnits="userSpaceOnUse";this._renderer.elem=c.createElement("radialGradient",m);n.defs.appendChild(this._renderer.elem)}else{c.setAttributes(this._renderer.elem,m)}if(this._flagStops){this._renderer.elem.children.length=0;for(var l=0;l<this.stops.length;l++){var k=this.stops[l];var j={};if(k._flagOffset){j.offset=100*k._offset+"%"}if(k._flagColor){j["stop-color"]=k._color}if(k._flagOpacity){j["stop-opacity"]=k._opacity}if(!k._renderer.elem){k._renderer.elem=c.createElement("stop",j)}else{c.setAttributes(k._renderer.elem,j)}this._renderer.elem.appendChild(k._renderer.elem);k.flagReset()}}return this.flagReset()}}};var f=i[i.Types.svg]=function(j){this.domElement=j.domElement||c.createElement("svg");this.scene=new i.Group();this.scene.parent=this;this.defs=c.createElement("defs");this.domElement.appendChild(this.defs);this.domElement.defs=this.defs};d.extend(f,{Utils:c});d.extend(f.prototype,h.Events,{setSize:function(k,j){this.width=k;this.height=j;c.setAttributes(this.domElement,{width:k,height:j});return this},render:function(){c.group.render.call(this.scene,this.domElement);return this}})})(Two,typeof require==="function"?require("underscore"):_,typeof require==="function"?require("backbone"):Backbone,typeof require==="function"?require("requestAnimationFrame"):requestAnimationFrame);(function(a,l,k,i){var j=a.Utils.mod,c=a.Utils.toFixed;var f=a.Utils.getRatio;var e=function(n){return(n[0]==1&&n[3]==0&&n[1]==0&&n[4]==1&&n[2]==0&&n[5]==0)};var d={isHidden:/(none|transparent)/i,group:{renderChild:function(m){d[m._renderer.type].render.call(m,this.ctx,true,this.clip)},render:function(n){this._update();var o=this._matrix.elements;var q=this.parent;this._renderer.opacity=this._opacity*(q&&q._renderer?q._renderer.opacity:1);var s=e(o);var m=this._mask;if(!this._renderer.context){this._renderer.context={}}this._renderer.context.ctx=n;if(!s){n.save();n.transform(o[0],o[3],o[1],o[4],o[2],o[5])}if(m){d[m._renderer.type].render.call(m,n,true)}for(var p=0;p<this.children.length;p++){var r=this.children[p];d[r._renderer.type].render.call(r,n)}if(!s){n.restore()}return this.flagReset()}},path:{render:function(u,D,F){var E,B,G,r,T,v,K,q,I,N,H,t,s,m,C,X,W,V,U,A,w,p,o,n,R,O,z,M,L,P,J,Q;this._update();E=this._matrix.elements;B=this._stroke;G=this._linewidth;r=this._fill;T=this._opacity*this.parent._renderer.opacity;v=this._visible;K=this._cap;q=this._join;I=this._miter;N=this._closed;H=this._vertices;t=H.length;s=t-1;Q=e(E);J=this._clip;if(!D&&(!v||J)){return this}if(!Q){u.save();u.transform(E[0],E[3],E[1],E[4],E[2],E[5])}if(r){if(l.isString(r)){u.fillStyle=r}else{d[r._renderer.type].render.call(r,u);u.fillStyle=r._renderer.gradient}}if(B){if(l.isString(B)){u.strokeStyle=B}else{d[B._renderer.type].render.call(B,u);u.strokeStyle=B._renderer.gradient}}if(G){u.lineWidth=G}if(I){u.miterLimit=I}if(q){u.lineJoin=q}if(K){u.lineCap=K}if(l.isNumber(T)){u.globalAlpha=T}u.beginPath();for(var S=0;S<H.length;S++){W=H[S];M=c(W._x);L=c(W._y);switch(W._command){case a.Commands.close:u.closePath();break;case a.Commands.curve:C=N?j(S-1,t):Math.max(S-1,0);m=N?j(S+1,t):Math.min(S+1,s);X=H[C];V=H[m];n=(X.controls&&X.controls.right)||X;R=(W.controls&&W.controls.left)||W;if(X._relative){p=(n.x+c(X._x));o=(n.y+c(X._y))}else{p=c(n.x);o=c(n.y)}if(W._relative){A=(R.x+c(W._x));w=(R.y+c(W._y))}else{A=c(R.x);w=c(R.y)}u.bezierCurveTo(p,o,A,w,M,L);if(S>=s&&N){V=U;O=(W.controls&&W.controls.right)||W;z=(V.controls&&V.controls.left)||V;if(W._relative){p=(O.x+c(W._x));o=(O.y+c(W._y))}else{p=c(O.x);o=c(O.y)}if(V._relative){A=(z.x+c(V._x));w=(z.y+c(V._y))}else{A=c(z.x);w=c(z.y)}M=c(V._x);L=c(V._y);u.bezierCurveTo(p,o,A,w,M,L)}break;case a.Commands.line:u.lineTo(M,L);break;case a.Commands.move:U=W;u.moveTo(M,L);break}}if(N){u.closePath()}if(!J&&!F){if(!d.isHidden.test(r)){u.fill()}if(!d.isHidden.test(B)){u.stroke()}}if(!Q){u.restore()}if(J&&!F){u.clip()}return this.flagReset()}},"linear-gradient":{render:function(m){this._update();if(!this._renderer.gradient||this._flagEndPoints||this._flagStops){this._renderer.gradient=m.createLinearGradient(this.left._x,this.left._y,this.right._x,this.right._y);for(var o=0;o<this.stops.length;o++){var n=this.stops[o];this._renderer.gradient.addColorStop(n._offset,n._color)}}return this.flagReset()}},"radial-gradient":{render:function(m){this._update();if(!this._renderer.gradient||this._flagCenter||this._flagFocal||this._flagRadius||this._flagStops){this._renderer.gradient=m.createRadialGradient(this.center._x,this.center._y,0,this.focal._x,this.focal._y,this._radius);for(var o=0;o<this.stops.length;o++){var n=this.stops[o];this._renderer.gradient.addColorStop(n._offset,n._color)}}return this.flagReset()}}};var h=a[a.Types.canvas]=function(n){var m=(n.smoothing!==false);this.domElement=n.domElement||document.createElement("canvas");this.ctx=this.domElement.getContext("2d");this.overdraw=n.overdraw||false;this.ctx.imageSmoothingEnabled=m;this.ctx.mozImageSmoothingEnabled=m;this.ctx.oImageSmoothingEnabled=m;this.ctx.webkitImageSmoothingEnabled=m;this.ctx.imageSmoothingEnabled=m;this.scene=new a.Group();this.scene.parent=this};l.extend(h,{Utils:d});l.extend(h.prototype,k.Events,{setSize:function(o,m,n){this.width=o;this.height=m;this.ratio=l.isUndefined(n)?f(this.ctx):n;this.domElement.width=o*this.ratio;this.domElement.height=m*this.ratio;l.extend(this.domElement.style,{width:o+"px",height:m+"px"});return this},render:function(){var m=this.ratio===1;if(!m){this.ctx.save();this.ctx.scale(this.ratio,this.ratio)}if(!this.overdraw){this.ctx.clearRect(0,0,this.width,this.height)}d.group.render.call(this.scene,this.ctx);if(!m){this.ctx.restore()}return this}});function g(m){m.setTransform(1,0,0,1,0,0)}})(Two,typeof require==="function"?require("underscore"):_,typeof require==="function"?require("backbone"):Backbone,typeof require==="function"?require("requestAnimationFrame"):requestAnimationFrame);(function(a,n,m,h){var g=a.Matrix.Multiply,k=a.Utils.mod,i=[1,0,0,0,1,0,0,0,1],j=new a.Array(9),e=a.Utils.getRatio,l=a.Utils.getComputedMatrix,d=a.Utils.toFixed;var c={isHidden:/(none|transparent)/i,canvas:document.createElement("canvas"),matrix:new a.Matrix(),uv:new a.Array([0,0,1,0,0,1,0,1,1,0,1,1]),group:{removeChild:function(q,p){if(q.children){for(var o=0;o<q.children.length;o++){c.group.removeChild(q.children[o],p)}return}p.deleteTexture(q._renderer.texture);delete q._renderer.texture},renderChild:function(o){c[o._renderer.type].render.call(o,this.gl,this.program)},render:function(t,p){this._update();var s=this.parent;var r=(s._matrix&&s._matrix.manual)||s._flagMatrix;var o=this._matrix.manual||this._flagMatrix;if(r||o){if(!this._renderer.matrix){this._renderer.matrix=new a.Array(9)}this._matrix.toArray(true,j);g(j,s._renderer.matrix,this._renderer.matrix);this._renderer.scale=this._scale*s._renderer.scale;if(r){this._flagMatrix=true}}if(this._mask){t.enable(t.STENCIL_TEST);t.stencilFunc(t.ALWAYS,1,1);t.colorMask(false,false,false,true);t.stencilOp(t.KEEP,t.KEEP,t.INCR);c[this._mask._renderer.type].render.call(this._mask,t,p,this);t.colorMask(true,true,true,true);t.stencilFunc(t.NOTEQUAL,0,1);t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}this._flagOpacity=s._flagOpacity||this._flagOpacity;this._renderer.opacity=this._opacity*(s&&s._renderer?s._renderer.opacity:1);if(this._flagSubtractions){for(var q=0;q<this.subtractions.length;q++){c.group.removeChild(this.subtractions[q],t)}}this.children.forEach(c.group.renderChild,{gl:t,program:p});if(this._mask){t.colorMask(false,false,false,false);t.stencilOp(t.KEEP,t.KEEP,t.DECR);c[this._mask._renderer.type].render.call(this._mask,t,p,this);t.colorMask(true,true,true,true);t.stencilFunc(t.NOTEQUAL,0,1);t.stencilOp(t.KEEP,t.KEEP,t.KEEP);t.disable(t.STENCIL_TEST)}return this.flagReset()}},path:{render:function(u,p,t){if(!this._visible||!this._opacity){return this}var r=this.parent;var q=r._matrix.manual||r._flagMatrix;var o=this._matrix.manual||this._flagMatrix;var s=this._flagVertices||this._flagFill||(this._fill instanceof a.LinearGradient&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagEndPoints))||(this._fill instanceof a.RadialGradient&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagRadius||this._fill._flagCenter||this._fill._flagFocal))||(this._stroke instanceof a.LinearGradient&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagEndPoints))||(this._stroke instanceof a.RadialGradient&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagRadius||this._stroke._flagCenter||this._stroke._flagFocal))||this._flagStroke||this._flagLinewidth||this._flagOpacity||r._flagOpacity||this._flagVisible||this._flagCap||this._flagJoin||this._flagMiter||this._flagScale||!this._renderer.texture;this._update();if(q||o){if(!this._renderer.matrix){this._renderer.matrix=new a.Array(9)}this._matrix.toArray(true,j);g(j,r._renderer.matrix,this._renderer.matrix);this._renderer.scale=this._scale*r._renderer.scale}if(s){if(!this._renderer.rect){this._renderer.rect={}}if(!this._renderer.triangles){this._renderer.triangles=new a.Array(12)}this._renderer.opacity=this._opacity*r._renderer.opacity;c.getBoundingClientRect(this._vertices,this._linewidth,this._renderer.rect);c.getTriangles(this._renderer.rect,this._renderer.triangles);c.updateBuffer(u,this,p);c.updateTexture(u,this)}if(this._clip&&!t){return}u.bindBuffer(u.ARRAY_BUFFER,this._renderer.textureCoordsBuffer);u.vertexAttribPointer(p.textureCoords,2,u.FLOAT,false,0,0);u.bindTexture(u.TEXTURE_2D,this._renderer.texture);u.uniformMatrix3fv(p.matrix,false,this._renderer.matrix);u.bindBuffer(u.ARRAY_BUFFER,this._renderer.buffer);u.vertexAttribPointer(p.position,2,u.FLOAT,false,0,0);u.drawArrays(u.TRIANGLES,0,6);return this.flagReset()}},"linear-gradient":{render:function(p,t){if(!p.canvas.getContext("2d")){return}this._update();if(!this._renderer.gradient||this._flagEndPoints||this._flagStops){var q=p.canvas.width/2;var o=p.canvas.height/2;var u=t._renderer.scale;this._renderer.gradient=p.createLinearGradient(this.left._x*u+q,this.left._y*u+o,this.right._x*u+q,this.right._y*u+o);for(var s=0;s<this.stops.length;s++){var r=this.stops[s];this._renderer.gradient.addColorStop(r._offset,r._color)}}return this.flagReset()}},"radial-gradient":{render:function(p,t){if(!p.canvas.getContext("2d")){return}this._update();if(!this._renderer.gradient||this._flagCenter||this._flagFocal||this._flagRadius||this._flagStops){var q=p.canvas.width/2;var o=p.canvas.height/2;this._renderer.gradient=p.createRadialGradient(this.center._x+q,this.center._y+o,0,this.focal._x+q,this.focal._y+o,this._radius*t._renderer.scale);for(var s=0;s<this.stops.length;s++){var r=this.stops[s];this._renderer.gradient.addColorStop(r._offset,r._color)}}return this.flagReset()}},getBoundingClientRect:function(s,r,u){var q=Infinity,v=-Infinity,t=Infinity,o=-Infinity,p,w;s.forEach(function(H){var F=H.x,C=H.y,I=H.controls;var E,D,B,A,G,z;t=Math.min(C,t);q=Math.min(F,q);v=Math.max(F,v);o=Math.max(C,o);if(!H.controls){return}G=I.left;z=I.right;if(!G||!z){return}E=H._relative?G.x+F:G.x;D=H._relative?G.y+C:G.y;B=H._relative?z.x+F:z.x;A=H._relative?z.y+C:z.y;if(!E||!D||!B||!A){return}t=Math.min(D,A,t);q=Math.min(E,B,q);v=Math.max(E,B,v);o=Math.max(D,A,o)});if(n.isNumber(r)){t-=r;q-=r;v+=r;o+=r}p=v-q;w=o-t;u.top=t;u.left=q;u.right=v;u.bottom=o;u.width=p;u.height=w;if(!u.centroid){u.centroid={}}u.centroid.x=-q;u.centroid.y=-t},getTriangles:function(q,r){var t=q.top,s=q.left,p=q.right,o=q.bottom;r[0]=s;r[1]=t;r[2]=p;r[3]=t;r[4]=s;r[5]=o;r[6]=s;r[7]=o;r[8]=p;r[9]=t;r[10]=p;r[11]=o},updateCanvas:function(S){var N,M,W,U,z,w,L,J,K,p,V,D,G,F;var A=S._vertices;var u=this.canvas;var O=this.ctx;var X=S._renderer.scale;var B=S._stroke;var R=S._linewidth*X;var P=S._fill;var t=S._renderer.opacity||S._opacity;var C=S._cap;var I=S._join;var o=S._miter;var r=S._closed;var v=A.length;var E=v-1;u.width=Math.max(Math.ceil(S._renderer.rect.width*X),1);u.height=Math.max(Math.ceil(S._renderer.rect.height*X),1);var H=S._renderer.rect.centroid;var s=H.x*X;var q=H.y*X;O.clearRect(0,0,u.width,u.height);if(P){if(n.isString(P)){O.fillStyle=P}else{c[P._renderer.type].render.call(P,O,S);O.fillStyle=P._renderer.gradient}}if(B){if(n.isString(B)){O.strokeStyle=B}else{c[B._renderer.type].render.call(B,O,S);O.strokeStyle=B._renderer.gradient}}if(R){O.lineWidth=R}if(o){O.miterLimit=o}if(I){O.lineJoin=I}if(C){O.lineCap=C}if(n.isNumber(t)){O.globalAlpha=t}var T;O.beginPath();for(var Q=0;Q<A.length;Q++){b=A[Q];G=d(b._x*X+s);F=d(b._y*X+q);switch(b._command){case a.Commands.close:O.closePath();break;case a.Commands.curve:M=r?k(Q-1,v):Math.max(Q-1,0);N=r?k(Q+1,v):Math.min(Q+1,E);W=A[M];U=A[N];K=(W.controls&&W.controls.right)||W;p=(b.controls&&b.controls.left)||b;if(W._relative){L=d((K.x+W._x)*X+s);J=d((K.y+W._y)*X+q)}else{L=d(K.x*X+s);J=d(K.y*X+q)}if(b._relative){z=d((p.x+b._x)*X+s);w=d((p.y+b._y)*X+q)}else{z=d(p.x*X+s);w=d(p.y*X+q)}O.bezierCurveTo(L,J,z,w,G,F);if(Q>=E&&r){U=T;V=(b.controls&&b.controls.right)||b;D=(U.controls&&U.controls.left)||U;if(b._relative){L=d((V.x+b._x)*X+s);J=d((V.y+b._y)*X+q)}else{L=d(V.x*X+s);J=d(V.y*X+q)}if(U._relative){z=d((D.x+U._x)*X+s);w=d((D.y+U._y)*X+q)}else{z=d(D.x*X+s);w=d(D.y*X+q)}G=d(U._x*X+s);F=d(U._y*X+q);O.bezierCurveTo(L,J,z,w,G,F)}break;case a.Commands.line:O.lineTo(G,F);break;case a.Commands.move:T=b;O.moveTo(G,F);break}}if(r){O.closePath()}if(!c.isHidden.test(P)){O.fill()}if(!c.isHidden.test(B)){O.stroke()}},updateTexture:function(p,o){this.updateCanvas(o);if(o._renderer.texture){p.deleteTexture(o._renderer.texture)}p.bindBuffer(p.ARRAY_BUFFER,o._renderer.textureCoordsBuffer);o._renderer.texture=p.createTexture();p.bindTexture(p.TEXTURE_2D,o._renderer.texture);p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE);p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE);p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR);if(this.canvas.width<=0||this.canvas.height<=0){return}p.texImage2D(p.TEXTURE_2D,0,p.RGBA,p.RGBA,p.UNSIGNED_BYTE,this.canvas)},updateBuffer:function(q,p,o){if(n.isObject(p._renderer.buffer)){q.deleteBuffer(p._renderer.buffer)}p._renderer.buffer=q.createBuffer();q.bindBuffer(q.ARRAY_BUFFER,p._renderer.buffer);q.enableVertexAttribArray(o.position);q.bufferData(q.ARRAY_BUFFER,p._renderer.triangles,q.STATIC_DRAW);if(n.isObject(p._renderer.textureCoordsBuffer)){q.deleteBuffer(p._renderer.textureCoordsBuffer)}p._renderer.textureCoordsBuffer=q.createBuffer();q.bindBuffer(q.ARRAY_BUFFER,p._renderer.textureCoordsBuffer);q.enableVertexAttribArray(o.textureCoords);q.bufferData(q.ARRAY_BUFFER,this.uv,q.STATIC_DRAW)},program:{create:function(r,q){var o,s,p;o=r.createProgram();n.each(q,function(t){r.attachShader(o,t)});r.linkProgram(o);s=r.getProgramParameter(o,r.LINK_STATUS);if(!s){p=r.getProgramInfoLog(o);r.deleteProgram(o);throw new a.Utils.Error("unable to link program: "+p)}return o}},shaders:{create:function(t,r,p){var q,s,o;q=t.createShader(t[p]);t.shaderSource(q,r);t.compileShader(q);s=t.getShaderParameter(q,t.COMPILE_STATUS);if(!s){o=t.getShaderInfoLog(q);t.deleteShader(q);throw new a.Utils.Error("unable to compile shader "+q+": "+o)}return q},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},vertex:["attribute vec2 a_position;","attribute vec2 a_textureCoords;","","uniform mat3 u_matrix;","uniform vec2 u_resolution;","","varying vec2 v_textureCoords;","","void main() {","   vec2 projected = (u_matrix * vec3(a_position, 1.0)).xy;","   vec2 normal = projected / u_resolution;","   vec2 clipspace = (normal * 2.0) - 1.0;","","   gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);","   v_textureCoords = a_textureCoords;","}"].join("\n"),fragment:["precision mediump float;","","uniform sampler2D u_image;","varying vec2 v_textureCoords;","","void main() {","  gl_FragColor = texture2D(u_image, v_textureCoords);","}"].join("\n")}};c.ctx=c.canvas.getContext("2d");var f=a[a.Types.webgl]=function(p){var r,q,s,o;this.domElement=p.domElement||document.createElement("canvas");this.scene=new a.Group();this.scene.parent=this;this._renderer={matrix:new a.Array(i),scale:1,opacity:1};this._flagMatrix=true;r=n.defaults(p||{},{antialias:false,alpha:true,premultipliedAlpha:true,stencil:true,preserveDrawingBuffer:true,overdraw:false});this.overdraw=r.overdraw;q=this.ctx=this.domElement.getContext("webgl",r)||this.domElement.getContext("experimental-webgl",r);if(!this.ctx){throw new a.Utils.Error("unable to create a webgl context. Try using another renderer.")}s=c.shaders.create(q,c.shaders.vertex,c.shaders.types.vertex);o=c.shaders.create(q,c.shaders.fragment,c.shaders.types.fragment);this.program=c.program.create(q,[s,o]);q.useProgram(this.program);this.program.position=q.getAttribLocation(this.program,"a_position");this.program.matrix=q.getUniformLocation(this.program,"u_matrix");this.program.textureCoords=q.getAttribLocation(this.program,"a_textureCoords");q.disable(q.DEPTH_TEST);q.enable(q.BLEND);q.blendEquationSeparate(q.FUNC_ADD,q.FUNC_ADD);q.blendFuncSeparate(q.SRC_ALPHA,q.ONE_MINUS_SRC_ALPHA,q.ONE,q.ONE_MINUS_SRC_ALPHA)};n.extend(f.prototype,m.Events,{setSize:function(r,o,q){this.width=r;this.height=o;this.ratio=n.isUndefined(q)?e(this.ctx):q;this.domElement.width=r*this.ratio;this.domElement.height=o*this.ratio;n.extend(this.domElement.style,{width:r+"px",height:o+"px"});r*=this.ratio;o*=this.ratio;this._renderer.matrix[0]=this._renderer.matrix[4]=this._renderer.scale=this.ratio;this._flagMatrix=true;this.ctx.viewport(0,0,r,o);var p=this.ctx.getUniformLocation(this.program,"u_resolution");this.ctx.uniform2f(p,r,o);return this},render:function(){var o=this.ctx;if(!this.overdraw){o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT)}c.group.render.call(this.scene,o,this.program);this._flagMatrix=false;return this}})})(Two,typeof require==="function"?require("underscore"):_,typeof require==="function"?require("backbone"):Backbone,typeof require==="function"?require("requestAnimationFrame"):requestAnimationFrame);(function(f,a,e,d){var c=f.Shape=function(){this._renderer={};this.id=f.Identifier+f.uniqueId();this.classList=[];this._matrix=new f.Matrix();this.translation=new f.Vector();this.translation.bind(f.Events.change,a.bind(c.FlagMatrix,this));this.rotation=0;this.scale=1};a.extend(c,e.Events,{FlagMatrix:function(){this._flagMatrix=true},MakeObservable:function(g){Object.defineProperty(g,"rotation",{get:function(){return this._rotation},set:function(h){this._rotation=h;this._flagMatrix=true}});Object.defineProperty(g,"scale",{get:function(){return this._scale},set:function(h){this._scale=h;this._flagMatrix=true;this._flagScale=true}})}});a.extend(c.prototype,{_flagMatrix:true,_rotation:0,_scale:1,addTo:function(g){g.add(this);return this},clone:function(){var g=new c();g.translation.copy(this.translation);g.rotation=this.rotation;g.scale=this.scale;a.each(c.Properties,function(h){g[h]=this[h]},this);return g._update()},_update:function(g){if(!this._matrix.manual&&this._flagMatrix){this._matrix.identity().translate(this.translation.x,this.translation.y).scale(this.scale).rotate(this.rotation)}if(g){if(this.parent&&this.parent._update){this.parent._update()}}return this},flagReset:function(){this._flagMatrix=this._flagScale=false;return this}});c.MakeObservable(c.prototype)})(Two,typeof require==="function"?require("underscore"):_,typeof require==="function"?require("backbone"):Backbone,typeof require==="function"?require("requestAnimationFrame"):requestAnimationFrame);(function(a,l,k,h){var g=Math.min,i=Math.max,m=Math.round,j=a.Utils.getComputedMatrix;var c={};l.each(a.Commands,function(o,n){c[n]=new RegExp(o)});var e=a.Path=function(p,o,n,q){a.Shape.call(this);this._renderer.type="path";this._closed=!!o;this._curved=!!n;this.beginning=0;this.ending=1;this.fill="#fff";this.stroke="#000";this.linewidth=1;this.opacity=1;this.visible=true;this.cap="butt";this.join="miter";this.miter=4;this._vertices=[];this.vertices=p;this.automatic=!q};l.extend(e,{Properties:["fill","stroke","linewidth","opacity","visible","cap","join","miter","closed","curved","automatic","beginning","ending"],FlagVertices:function(){this._flagVertices=true;this._flagLength=true},MakeObservable:function(n){a.Shape.MakeObservable(n);l.each(e.Properties.slice(0,8),function(q){var p="_"+q;var o="_flag"+q.charAt(0).toUpperCase()+q.slice(1);Object.defineProperty(n,q,{get:function(){return this[p]},set:function(r){this[p]=r;this[o]=true}})});Object.defineProperty(n,"length",{get:function(){if(this._flagLength){this._updateLength()}return this._length}});Object.defineProperty(n,"closed",{get:function(){return this._closed},set:function(o){this._closed=!!o;this._flagVertices=true}});Object.defineProperty(n,"curved",{get:function(){return this._curved},set:function(o){this._curved=!!o;this._flagVertices=true}});Object.defineProperty(n,"automatic",{get:function(){return this._automatic},set:function(o){if(o===this._automatic){return}this._automatic=!!o;var p=this._automatic?"ignore":"listen";l.each(this.vertices,function(q){q[p]()})}});Object.defineProperty(n,"beginning",{get:function(){return this._beginning},set:function(o){this._beginning=g(i(o,0),this._ending);this._flagVertices=true}});Object.defineProperty(n,"ending",{get:function(){return this._ending},set:function(o){this._ending=g(i(o,this._beginning),1);this._flagVertices=true}});Object.defineProperty(n,"vertices",{get:function(){return this._collection},set:function(p){var r=l.bind(e.FlagVertices,this);var o=l.bind(function(s){var t=s.length;while(t--){s[t].bind(a.Events.change,r)}r()},this);var q=l.bind(function(s){l.each(s,function(t){t.unbind(a.Events.change,r)},this);r()},this);if(this._collection){this._collection.unbind()}this._collection=new a.Utils.Collection((p||[]).slice(0));this._collection.bind(a.Events.insert,o);this._collection.bind(a.Events.remove,q);o(this._collection)}});Object.defineProperty(n,"clip",{get:function(){return this._clip},set:function(o){this._clip=o;this._flagClip=true}})}});l.extend(e.prototype,a.Shape.prototype,{_flagVertices:true,_flagLength:true,_flagFill:true,_flagStroke:true,_flagLinewidth:true,_flagOpacity:true,_flagVisible:true,_flagCap:true,_flagJoin:true,_flagMiter:true,_flagClip:false,_length:0,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:true,_cap:"round",_join:"round",_miter:4,_closed:true,_curved:false,_automatic:true,_beginning:0,_ending:1,_clip:false,clone:function(o){o=o||this.parent;var n=l.map(this.vertices,function(q){return q.clone()});var p=new e(n,this.closed,this.curved,!this.automatic);l.each(a.Path.Properties,function(q){p[q]=this[q]},this);p.translation.copy(this.translation);p.rotation=this.rotation;p.scale=this.scale;o.add(p);return p},toObject:function(){var n={vertices:l.map(this.vertices,function(o){return o.toObject()})};l.each(a.Shape.Properties,function(o){n[o]=this[o]},this);n.translation=this.translation.toObject;n.rotation=this.rotation;n.scale=this.scale;return n},noFill:function(){this.fill="transparent";return this},noStroke:function(){this.stroke="transparent";return this},corner:function(){var n=this.getBoundingClientRect(true);n.centroid={x:n.left+n.width/2,y:n.top+n.height/2};l.each(this.vertices,function(o){o.addSelf(n.centroid)});return this},center:function(){var n=this.getBoundingClientRect(true);n.centroid={x:n.left+n.width/2,y:n.top+n.height/2};l.each(this.vertices,function(o){o.subSelf(n.centroid)});return this},remove:function(){if(!this.parent){return this}this.parent.remove(this);return this},getBoundingClientRect:function(p){var w,r,q,z,u,s,B;var o=Infinity,A=-Infinity,t=Infinity,n=-Infinity;this._update(true);w=!!p?this._matrix:j(this);r=this.linewidth/2;q=this._vertices.length;for(s=0;s<q;s++){B=this._vertices[s];z=B.x;u=B.y;B=w.multiply(z,u,1);t=g(B.y-r,t);o=g(B.x-r,o);A=i(B.x+r,A);n=i(B.y+r,n)}return{top:t,left:o,right:A,bottom:n,width:A-o,height:n-t}},getPointAt:function(B,A){var z,H,G,F,D,w,r,q,o,n,u,I;var L=this.length*Math.min(Math.max(B,0),1);var s=this.vertices.length;var v=s-1;var K=null;var J=null;for(var E=0,C=this._lengths.length,p=0;E<C;E++){if(p+this._lengths[E]>L){K=this.vertices[this.closed?a.Utils.mod(E,s):E];J=this.vertices[Math.min(Math.max(E-1,0),v)];L-=p;B=L/this._lengths[E];break}p+=this._lengths[E]}if(l.isNull(K)||l.isNull(J)){return null}I=J.controls&&J.controls.right;u=K.controls&&K.controls.left;H=J.x;r=J.y;G=(I||J).x;q=(I||J).y;F=(u||K).x;o=(u||K).y;D=K.x;n=K.y;if(I&&J._relative){G+=J.x;q+=J.y}if(u&&K._relative){F+=K.x;o+=K.y}z=a.Utils.getPointOnCubicBezier(B,H,G,F,D);w=a.Utils.getPointOnCubicBezier(B,r,q,o,n);if(l.isObject(A)){A.x=z;A.y=w;return A}return new a.Vector(z,w)},plot:function(){if(this.curved){a.Utils.getCurveFromPoints(this._vertices,this.closed);return this}for(var n=0;n<this._vertices.length;n++){this._vertices[n]._command=n===0?a.Commands.move:a.Commands.line}return this},subdivide:function(o){this._update();var r=this.vertices.length-1;var n=this.vertices[r];var p=this._closed||this.vertices[r]._command===a.Commands.close;var q=[];l.each(this.vertices,function(s,t){if(t<=0&&!p){n=s;return}if(s.command===a.Commands.move){q.push(new a.Anchor(n.x,n.y));if(t>0){q[q.length-1].command=a.Commands.line}n=s;return}var u=d(s,n,o);q=q.concat(u);l.each(u,function(w,x){if(x<=0&&n.command===a.Commands.move){w.command=a.Commands.move}else{w.command=a.Commands.line}});if(t>=r){if(this._closed&&this._automatic){n=s;u=d(s,n,o);q=q.concat(u);l.each(u,function(w,x){if(x<=0&&n.command===a.Commands.move){w.command=a.Commands.move}else{w.command=a.Commands.line}})}else{if(p){q.push(new a.Anchor(s.x,s.y))}}q[q.length-1].command=p?a.Commands.close:a.Commands.line}n=s},this);this._automatic=false;this._curved=false;this.vertices=q;return this},_updateLength:function(o){this._update();var r=this.vertices.length-1;var n=this.vertices[r];var p=this._closed||this.vertices[r]._command===a.Commands.close;var q=0;if(l.isUndefined(this._lengths)){this._lengths=[]}l.each(this.vertices,function(s,t){if((t<=0&&!p)||s.command===a.Commands.move){n=s;this._lengths[t]=0;return}this._lengths[t]=f(s,n,o);q+=this._lengths[t];if(t>=r&&p){n=s;this._lengths[t+1]=f(s,n,o);q+=this._lengths[t+1]}n=s},this);this._length=q;return this},_update:function(){if(this._flagVertices){var o=this.vertices.length;var s=o-1,q;var p=m((this._beginning)*s);var n=m((this._ending)*s);this._vertices.length=0;for(var r=p;r<n+1;r++){q=this.vertices[r];this._vertices.push(q)}if(this._automatic){this.plot()}}a.Shape.prototype._update.apply(this,arguments);return this},flagReset:function(){this._flagVertices=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagCap=this._flagJoin=this._flagMiter=this._flagClip=false;a.Shape.prototype.flagReset.call(this);return this}});e.MakeObservable(e.prototype);function f(x,v,r){var p,o,n,z,w,u,t,s;var y=v.controls&&v.controls.right;var q=x.controls&&x.controls.left;p=v.x;w=v.y;o=(y||v).x;u=(y||v).y;n=(q||x).x;t=(q||x).y;z=x.x;s=x.y;if(y&&v._relative){o+=v.x;u+=v.y}if(q&&x._relative){n+=x.x;t+=x.y}return a.Utils.getCurveLength(p,w,o,u,n,t,z,s,r)}function d(x,v,r){var p,o,n,z,w,u,t,s;var y=v.controls&&v.controls.right;var q=x.controls&&x.controls.left;p=v.x;w=v.y;o=(y||v).x;u=(y||v).y;n=(q||x).x;t=(q||x).y;z=x.x;s=x.y;if(y&&v._relative){o+=v.x;u+=v.y}if(q&&x._relative){n+=x.x;t+=x.y}return a.Utils.subdivide(p,w,o,u,n,t,z,s,r)}})(Two,typeof require==="function"?require("underscore"):_,typeof require==="function"?require("backbone"):Backbone,typeof require==="function"?require("requestAnimationFrame"):requestAnimationFrame);(function(g,a,f,e){var c=g.Path;var d=g.Line=function(l,o,j,m){var n=j-l;var i=m-o;var h=n/2;var k=i/2;c.call(this,[new g.Anchor(-h,-k),new g.Anchor(h,k)]);this.translation.set(l+h,o+k)};a.extend(d.prototype,c.prototype);c.MakeObservable(d.prototype)})(Two,typeof require==="function"?require("underscore"):_,typeof require==="function"?require("backbone"):Backbone,typeof require==="function"?require("requestAnimationFrame"):requestAnimationFrame);(function(g,a,f,e){var d=g.Path;var c=g.Rectangle=function(j,m,l,i){var h=l/2;var k=i/2;d.call(this,[new g.Anchor(-h,-k),new g.Anchor(h,-k),new g.Anchor(h,k),new g.Anchor(-h,k)],true);this.translation.set(j,m)};a.extend(c.prototype,d.prototype);d.MakeObservable(c.prototype)})(Two,typeof require==="function"?require("underscore"):_,typeof require==="function"?require("backbone"):Backbone,typeof require==="function"?require("requestAnimationFrame"):requestAnimationFrame);(function(a,i,h,e){var d=a.Path,c=Math.PI*2,j=Math.cos,f=Math.sin;var g=a.Ellipse=function(l,k,p,o){if(!i.isNumber(o)){o=p}var m=a.Resolution;var n=i.map(i.range(m),function(s){var t=s/m;var r=t*c;var q=p*j(r);var u=o*f(r);return new a.Anchor(q,u)},this);d.call(this,n,true,true);this.translation.set(l,k)};i.extend(g.prototype,d.prototype);d.MakeObservable(g.prototype)})(Two,typeof require==="function"?require("underscore"):_,typeof require==="function"?require("backbone"):Backbone,typeof require==="function"?require("requestAnimationFrame"):requestAnimationFrame);(function(a,i,h,f){var d=a.Path,c=Math.PI*2,j=Math.cos,g=Math.sin;var e=a.Polygon=function(l,k,o,n){n=Math.max(n||0,3);var m=i.map(i.range(n),function(r){var s=(r+0.5)/n;var q=c*s+Math.PI/2;var p=o*j(q);var t=o*g(q);return new a.Anchor(p,t)});d.call(this,m,true);this.translation.set(l,k)};i.extend(e.prototype,d.prototype);d.MakeObservable(e.prototype)})(Two,typeof require==="function"?require("underscore"):_,typeof require==="function"?require("backbone"):Backbone,typeof require==="function"?require("requestAnimationFrame"):requestAnimationFrame);(function(a,i,h,f){var e=a.Path,l=Math.PI,d=Math.PI*2,j=Math.cos,g=Math.sin,k=Math.abs;var c=a.CurvedPolygon=function(q,p,A,E,F){var C=[];E=Math.max(E||0,3);var D=E+1;var z=d/E;var G=l*A/E/2;F=F||0;var m=a.Commands.move;var u=l,w,v,o,n,t,s;C.push(new a.Anchor(g(u)*(A),j(u)*(A),0,0,0,0,m));for(var B=0;B<D;B++){u=(z*B)+l;m=a.Commands.curve;w=Math.sin(u)*A;v=Math.cos(u)*A;if(F>=0){o=(g(u-(Math.PI/2)))*G*F;n=(j(u-(Math.PI/2)))*G*F;t=(g(u+(Math.PI/2)))*G*F;s=(j(u+(Math.PI/2)))*G*F}else{o=(g(u-(Math.PI)))*G*k(F);n=(j(u-(Math.PI)))*G*k(F);t=(g(u+(Math.PI)))*G*k(F);s=(j(u+(Math.PI)))*G*k(F)}if(B===0){o=0;n=0}if(B===D-1){t=0;s=0}C.push(new a.Anchor(w,v,o,n,t,s,m))}e.call(this,C,true,false,true);this.translation.set(q,p)};i.extend(c.prototype,e.prototype);e.MakeObservable(c.prototype)})(Two,typeof require==="function"?require("underscore"):_,typeof require==="function"?require("backbone"):Backbone,typeof require==="function"?require("requestAnimationFrame"):requestAnimationFrame);(function(a,j,i,f){var d=a.Path,m=Math.PI,c=Math.PI*2,h=Math.PI/2,k=Math.cos,g=Math.sin,l=Math.abs;var e=a.ArcSegment=function(t,r,w,z,n,v,J){if(n>v){v+=Math.PI*2}J=J||8;var B=n;var D=v-n;var F=D/J;var o=a.Commands.move;var I=[];I.push(new a.Anchor(Math.sin(0)*z,Math.cos(0)*z,0,0,0,0,o));var A,E,C,q,p,u,s;o=a.Commands.curve;for(var H=0;H<J+1;H++){A=H*F;E=g(A)*z;C=k(A)*z;q=g(A-h)*(F/m)*z;p=k(A-h)*(F/m)*z;u=g(A+h)*(F/m)*z;s=k(A+h)*(F/m)*z;if(H===0){q=p=0}if(H===J){u=s=0}I.push(new a.Anchor(E,C,q,p,u,s,o))}for(var G=0;G<J+1;G++){A=D-(F*G);E=g(A)*w;C=k(A)*w;q=g(A-(m*1.5))*(F/m)*w;p=k(A-(m*1.5))*(F/m)*w;u=g(A+(m*1.5))*(F/m)*w;s=k(A+(m*1.5))*(F/m)*w;if(G===0){q=p=0}if(G===J){u=s=0}I.push(new a.Anchor(E,C,q,p,u,s,o))}o=a.Commands.close;I.push(new a.Anchor(Math.sin(0)*z,Math.cos(0)*z,0,0,0,0,o));d.call(this,I,true,false,true);this.rotation=n;this.translation.set(t,r)};j.extend(e.prototype,d.prototype);d.MakeObservable(e.prototype)})(Two,typeof require==="function"?require("underscore"):_,typeof require==="function"?require("backbone"):Backbone,typeof require==="function"?require("requestAnimationFrame"):requestAnimationFrame);(function(a,i,h,e){var d=a.Path,l=Math.PI,c=Math.PI*2,j=Math.cos,f=Math.sin,k=Math.abs;var g=a.SineRing=function(q,p,B,m,u,F){var C=(m*2)+1;var A=Math.PI/m;var G=l*B/m/2;F=F||1;var E=[];var v=l,z,w,o,n,t,s;E.push(new a.Anchor(f(v)*(B+(u/2)),j(v)*(B+(u/2)),0,0,0,0,a.Commands.move));for(var D=0;D<C;D++){v=(A*D)+l;if((D%2)===0){z=Math.sin(v)*(B+(u/2));w=Math.cos(v)*(B+(u/2))}else{z=Math.sin(v)*(B-(u/2));w=Math.cos(v)*(B-(u/2))}o=((Math.sin(v-(Math.PI/2)))*G)*F;n=((Math.cos(v-(Math.PI/2)))*G)*F;t=((Math.sin(v+(Math.PI/2)))*G)*F;s=((Math.cos(v+(Math.PI/2)))*G)*F;if(D===0){o=n=0}if(D===C-1){t=s=0}E.push(new a.Anchor(z,w,o,n,t,s,a.Commands.curve))}d.call(this,E,true,false,true);this.translation.set(q,p)};i.extend(g.prototype,d.prototype);d.MakeObservable(g.prototype)})(Two,typeof require==="function"?require("underscore"):_,typeof require==="function"?require("backbone"):Backbone,typeof require==="function"?require("requestAnimationFrame"):requestAnimationFrame);(function(a,i,h,e){var d=a.Path,c=Math.PI*2,j=Math.cos,f=Math.sin;var g=a.Star=function(l,k,q,p,o){if(!i.isNumber(p)){p=q/2}if(!i.isNumber(o)||o<=0){o=5}var n=o*2;var m=i.map(i.range(n),function(u){var w=(u-0.5)/n;var t=w*c;var v=(u%2?p:q);var s=v*j(t);var z=v*f(t);return new a.Anchor(s,z)});d.call(this,m,true);this.translation.set(l,k)};i.extend(g.prototype,d.prototype);d.MakeObservable(g.prototype)})(Two,typeof require==="function"?require("underscore"):_,typeof require==="function"?require("backbone"):Backbone,typeof require==="function"?require("requestAnimationFrame"):requestAnimationFrame);(function(i,a,h,g){var c=i.Path;var f=i.RoundedRectangle=function(l,k,j,s,n){var m=j/2;var o=s/2;var q,p;if(!a.isNumber(n)){n=Math.floor(Math.min(j,s)/12)}var r=[new i.Anchor(-m+n,-o),new i.Anchor(m-n,-o)];q=m;p=-o;r=e(r,q,p,n,1);r.push(new i.Anchor(m,o-n));q=m;p=o;r=e(r,q,p,n,4);r.push(new i.Anchor(-m+n,o));q=-m;p=o;r=e(r,q,p,n,3);r.push(new i.Anchor(-m,-o+n));q=-m;p=-o;r=e(r,q,p,n,2);r.pop();c.call(this,r,true);this.translation.set(l,k)};a.extend(f.prototype,c.prototype);c.MakeObservable(f.prototype);function e(u,t,r,p,n){var j=0,o=0;var k=i.Resolution;var s=u[u.length-1];var q=new i.Anchor(t,r);var m=t<0?-p:p;var v=r<0?-p:p;switch(n){case 1:j=-Math.PI/2;o=0;break;case 2:j=-Math.PI;o=-Math.PI/2;break;case 3:j=-Math.PI*1.5;o=-Math.PI;break;case 4:j=0;o=Math.PI/2;break}var l=a.map(a.range(k),function(A){var z=d(k-A,0,k,j,o);var x=p*Math.cos(z)+t-m;var w=p*Math.sin(z)+r-v;var y=new i.Anchor(x,w);return y}).reverse();return u.concat(l)}function d(j,m,k,n,l){return n+(l-n)*((j-m)/(k-m))}})(Two,typeof require==="function"?require("underscore"):_,typeof require==="function"?require("backbone"):Backbone,typeof require==="function"?require("requestAnimationFrame"):requestAnimationFrame);(function(g,c,f,e){var a=function(j,h,i){this._renderer={};this.offset=c.isNumber(j)?j:a.Index<=0?0:1;this.opacity=c.isNumber(i)?i:1;this.color=c.isString(h)?h:a.Index<=0?"#fff":"#000";a.Index=(a.Index+1)%2};c.extend(a,{Index:0,Properties:["offset","opacity","color"],MakeObservable:function(h){c.each(a.Properties,function(k){var j="_"+k;var i="_flag"+k.charAt(0).toUpperCase()+k.slice(1);Object.defineProperty(h,k,{get:function(){return this[j]},set:function(l){this[j]=l;this[i]=true;this.trigger(g.Events.change)}})})}});c.extend(a.prototype,f.Events,{clone:function(){var h=new a();c.each(a.Properties,function(i){h[i]=this[i]},this);return h},toObject:function(){var h={};c.each(a.Properties,function(i){h[i]=this[i]},this);return h},flagReset:function(){this._flagOffset=this._flagColor=this._flagOpacity=false;return this}});a.MakeObservable(a.prototype);var d=g.Gradient=function(h){g.Shape.call(this);this._renderer.type="gradient";this.spread="pad";this.stops=h};c.extend(d,{Stop:a,Properties:["spread"],MakeObservable:function(h){g.Shape.MakeObservable(h);c.each(d.Properties,g.Utils.defineProperty,h);Object.defineProperty(h,"stops",{get:function(){return this._stops},set:function(k){var i=c.bind(d.FlagStops,this);var l=c.bind(function(m){var n=m.length;while(n--){m[n].bind(g.Events.change,i)}i()},this);var j=c.bind(function(m){c.each(m,function(n){n.unbind(g.Events.change,i)},this);i()},this);if(this._stops){this._stops.unbind()}this._stops=new g.Utils.Collection((k||[]).slice(0));this._stops.bind(g.Events.insert,l);this._stops.bind(g.Events.remove,j);l(this._stops)}})},FlagStops:function(){this._flagStops=true}});c.extend(d.prototype,g.Shape.prototype,{clone:function(h){h=h||this.parent;var i=c.map(this.stops,function(k){return k.clone()});var j=new d(i);c.each(g.Gradient.Properties,function(l){j[l]=this[l]},this);j.translation.copy(this.translation);j.rotation=this.rotation;j.scale=this.scale;h.add(j);return j},toObject:function(){var h={stops:c.map(this.stops,function(i){return i.toObject()})};c.each(d.Properties,function(i){h[i]=this[i]},this);return h},flagReset:function(){this._flagSpread=this._flagStops=false;g.Shape.prototype.flagReset.call(this);return this}});d.MakeObservable(d.prototype)})(Two,typeof require==="function"?require("underscore"):_,typeof require==="function"?require("backbone"):Backbone,typeof require==="function"?require("requestAnimationFrame"):requestAnimationFrame);(function(f,a,e,d){var c=f.LinearGradient=function(h,j,g,i,k){f.Gradient.call(this,k);this._renderer.type="linear-gradient";var l=a.bind(c.FlagEndPoints,this);this.left=new f.Vector().bind(f.Events.change,l);this.right=new f.Vector().bind(f.Events.change,l);if(a.isNumber(h)){this.left.x=h}if(a.isNumber(j)){this.left.y=j}if(a.isNumber(g)){this.right.x=g}if(a.isNumber(i)){this.right.y=i}};a.extend(c,{Stop:f.Gradient.Stop,MakeObservable:function(g){f.Gradient.MakeObservable(g)},FlagEndPoints:function(){this._flagEndPoints=true}});a.extend(c.prototype,f.Gradient.prototype,{_flagEndPoints:false,clone:function(g){g=g||this.parent;var h=a.map(this.stops,function(j){return j.clone()});var i=new c(this.left._x,this.left._y,this.right._x,this.right._y,h);a.each(f.Gradient.Properties,function(j){i[j]=this[j]},this);g.add(i);return i},toObject:function(){var g=f.Gradient.prototype.toObject.call(this);g.left=this.left.toObject();g.right=this.right.toObject();return g},flagReset:function(){this._flagEndPoints=false;f.Gradient.prototype.flagReset.call(this);return this}});c.MakeObservable(c.prototype)})(Two,typeof require==="function"?require("underscore"):_,typeof require==="function"?require("backbone"):Backbone,typeof require==="function"?require("requestAnimationFrame"):requestAnimationFrame);(function(f,c,e,d){var a=f.RadialGradient=function(g,l,k,j,i,h){f.Gradient.call(this,j);this._renderer.type="radial-gradient";this.center=new f.Vector().bind(f.Events.change,c.bind(function(){this._flagCenter=true},this));this.radius=c.isNumber(k)?k:20;this.focal=new f.Vector().bind(f.Events.change,c.bind(function(){this._flagFocal=true},this));if(c.isNumber(g)){this.center.x=g}if(c.isNumber(l)){this.center.y=l}this.focal.copy(this.center);if(c.isNumber(i)){this.focal.x=i}if(c.isNumber(h)){this.focal.y=h}};c.extend(a,{Stop:f.Gradient.Stop,Properties:["radius"],MakeObservable:function(g){f.Gradient.MakeObservable(g);c.each(a.Properties,f.Utils.defineProperty,g)}});c.extend(a.prototype,f.Gradient.prototype,{_flagEndPoints:false,clone:function(g){g=g||this.parent;var h=c.map(this.stops,function(j){return j.clone()});var i=new a(this.center._x,this.center._y,this._radius,h,this.focal._x,this.focal._y);c.each(f.Gradient.Properties.concat(a.Properties),function(j){i[j]=this[j]},this);g.add(i);return i},toObject:function(){var g=f.Gradient.prototype.toObject.call(this);c.each(a.Properties,function(h){g[h]=this[h]},this);g.center=this.center.toObject();g.focal=this.focal.toObject();return g},flagReset:function(){this._flagRadius=this._flagCenter=this._flagFocal=false;f.Gradient.prototype.flagReset.call(this);return this}});a.MakeObservable(a.prototype)})(Two,typeof require==="function"?require("underscore"):_,typeof require==="function"?require("backbone"):Backbone,typeof require==="function"?require("requestAnimationFrame"):requestAnimationFrame);(function(a,h,g,d){var c=Math.min,f=Math.max;var j=function(){a.Utils.Collection.apply(this,arguments);Object.defineProperty(this,"_events",{value:{},enumerable:false});this.ids={};this.on(a.Events.insert,this.attach);this.on(a.Events.remove,this.detach);j.prototype.attach.apply(this,arguments)};j.prototype=new a.Utils.Collection();j.constructor=j;h.extend(j.prototype,{attach:function(l){for(var k=0;k<l.length;k++){this.ids[l[k].id]=l[k]}return this},detach:function(l){for(var k=0;k<l.length;k++){delete this.ids[l[k].id]}return this}});var e=a.Group=function(){a.Shape.call(this,true);this._renderer.type="group";this.additions=[];this.subtractions=[];this._children=[];this.children=arguments};h.extend(e,{Children:j,InsertChildren:function(l){for(var k=0;k<l.length;k++){i.call(this,l[k],this)}},RemoveChildren:function(l){for(var k=0;k<l.length;k++){i.call(this,l[k])}},OrderChildren:function(k){this._flagOrder=true},MakeObservable:function(k){var l=a.Path.Properties.slice(0);var m=h.indexOf(l,"opacity");if(m>=0){l.splice(m,1);Object.defineProperty(k,"opacity",{get:function(){return this._opacity},set:function(n){this._flagOpacity=(this._opacity!=n);this._opacity=n}})}a.Shape.MakeObservable(k);e.MakeGetterSetters(k,l);Object.defineProperty(k,"children",{get:function(){return this._collection},set:function(p){var n=h.bind(e.InsertChildren,this);var o=h.bind(e.RemoveChildren,this);var q=h.bind(e.OrderChildren,this);if(this._collection){this._collection.unbind()}this._collection=new j(p);this._collection.bind(a.Events.insert,n);this._collection.bind(a.Events.remove,o);this._collection.bind(a.Events.order,q)}});Object.defineProperty(k,"mask",{get:function(){return this._mask},set:function(n){this._mask=n;this._flagMask=true;if(!n.clip){n.clip=true}}})},MakeGetterSetters:function(l,k){if(!h.isArray(k)){k=[k]}h.each(k,function(m){e.MakeGetterSetter(l,m)})},MakeGetterSetter:function(n,m){var l="_"+m;Object.defineProperty(n,m,{get:function(){return this[l]},set:function(k){this[l]=k;h.each(this.children,function(o){o[m]=k})}})}});h.extend(e.prototype,a.Shape.prototype,{_flagAdditions:false,_flagSubtractions:false,_flagOrder:false,_flagOpacity:true,_flagMask:false,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:true,_cap:"round",_join:"round",_miter:4,_closed:true,_curved:false,_automatic:true,_beginning:0,_ending:1,_mask:null,clone:function(l){l=l||this.parent;var m=new e();l.add(m);var k=h.map(this.children,function(n){return n.clone(m)});m.translation.copy(this.translation);m.rotation=this.rotation;m.scale=this.scale;return m},toObject:function(){var k={children:{},translation:this.translation.toObject(),rotation:this.rotation,scale:this.scale};h.each(this.children,function(m,l){k.children[l]=m.toObject()},this);return k},corner:function(){var l=this.getBoundingClientRect(true),k={x:l.left,y:l.top};this.children.forEach(function(m){m.translation.subSelf(k)});return this},center:function(){var k=this.getBoundingClientRect(true);k.centroid={x:k.left+k.width/2,y:k.top+k.height/2};this.children.forEach(function(l){l.translation.subSelf(k.centroid)});return this},getById:function(l){var k=function(n,p){if(n.id===p){return n}else{if(n.children){var m=n.children.length;while(m--){var o=k(n.children[m],p);if(o){return o}}}}};return k(this,l)||null},getByClassName:function(k){var m=[];var l=function(o,n){if(o.classList.indexOf(n)!=-1){m.push(o)}else{if(o.children){o.children.forEach(function(p){l(p,n)})}}return m};return l(this,k)},getByType:function(l){var m=[];var k=function(o,n){for(var p in o.children){if(o.children[p] instanceof n){m.push(o.children[p])}else{if(o.children[p] instanceof a.Group){k(o.children[p],n)}}}return m};return k(this,l)},add:function(l){if(!(l instanceof Array)){l=h.toArray(arguments)}else{l=l.slice()}for(var k=0;k<l.length;k++){if(!(l[k]&&l[k].id)){continue}this.children.push(l[k])}return this},remove:function(n){var k=arguments.length,o=this.parent;if(k<=0&&o){o.remove(this);return this}if(!(n instanceof Array)){n=h.toArray(arguments)}else{n=n.slice()}for(var m=0;m<n.length;m++){if(!n[m]||!(this.children.ids[n[m].id])){continue}this.children.splice(h.indexOf(this.children,n[m]),1)}return this},getBoundingClientRect:function(n){var m;this._update(true);var p=Infinity,l=-Infinity,o=Infinity,k=-Infinity;this.children.forEach(function(q){if(/(linear-gradient|radial-gradient|gradient)/.test(q._renderer.type)){return}m=q.getBoundingClientRect(n);if(!h.isNumber(m.top)||!h.isNumber(m.left)||!h.isNumber(m.right)||!h.isNumber(m.bottom)){return}o=c(m.top,o);p=c(m.left,p);l=f(m.right,l);k=f(m.bottom,k)},this);return{top:o,left:p,right:l,bottom:k,width:l-p,height:k-o}},noFill:function(){this.children.forEach(function(k){k.noFill()});return this},noStroke:function(){this.children.forEach(function(k){k.noStroke()});return this},subdivide:function(){var k=arguments;this.children.forEach(function(l){l.subdivide.apply(l,k)});return this},flagReset:function(){if(this._flagAdditions){this.additions.length=0;this._flagAdditions=false}if(this._flagSubtractions){this.subtractions.length=0;this._flagSubtractions=false}this._flagOrder=this._flagMask=this._flagOpacity=false;a.Shape.prototype.flagReset.call(this);return this}});e.MakeObservable(e.prototype);function i(n,m){var l=n.parent;var k;if(l&&l.children.ids[n.id]){k=h.indexOf(l.children,n);l.children.splice(k,1);k=h.indexOf(l.additions,n);if(k>=0){l.additions.splice(k,1)}else{l.subtractions.push(n);l._flagSubtractions=true}}if(m){n.parent=m;this.additions.push(n);this._flagAdditions=true;return}k=h.indexOf(this.additions,n);if(k>=0){this.additions.splice(k,1)}else{this.subtractions.push(n);this._flagSubtractions=true}delete n.parent}})(Two,typeof require==="function"?require("underscore"):_,typeof require==="function"?require("backbone"):Backbone,typeof require==="function"?require("requestAnimationFrame"):requestAnimationFrame);