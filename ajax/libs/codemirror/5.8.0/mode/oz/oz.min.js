(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.defineMode("oz",function(i){function k(u){return new RegExp("^(("+u.join(")|(")+"))\\b")}var j=/[\^@!\|<>#~\.\*\-\+\\/,=]/;var b=/(<-)|(:=)|(=<)|(>=)|(<=)|(<:)|(>:)|(=:)|(\\=)|(\\=:)|(!!)|(==)|(::)/;var d=/(:::)|(\.\.\.)|(=<:)|(>=:)/;var r=["in","then","else","of","elseof","elsecase","elseif","catch","finally","with","require","prepare","import","export","define","do"];var f=["end"];var e=k(["true","false","nil","unit"]);var q=k(["andthen","at","attr","declare","feat","from","lex","mod","mode","orelse","parser","prod","prop","scanner","self","syn","token"]);var p=k(["local","proc","fun","case","class","if","cond","or","dis","choice","not","thread","try","raise","lock","for","suchthat","meth","functor"]);var m=k(r);var t=k(f);function s(x,w){if(x.eatSpace()){return null}if(x.match(/[{}]/)){return"bracket"}if(x.match(/(\[])/)){return"keyword"}if(x.match(d)||x.match(b)){return"operator"}if(x.match(e)){return"atom"}var u=x.match(p);if(u){if(!w.doInCurrentLine){w.currentIndent++}else{w.doInCurrentLine=false}if(u[0]=="proc"||u[0]=="fun"){w.tokenize=g}else{if(u[0]=="class"){w.tokenize=l}else{if(u[0]=="meth"){w.tokenize=c}}}return"keyword"}if(x.match(m)||x.match(q)){return"keyword"}if(x.match(t)){w.currentIndent--;return"keyword"}var v=x.next();if(v=='"'||v=="'"){w.tokenize=h(v);return w.tokenize(x,w)}if(/[~\d]/.test(v)){if(v=="~"){if(!/^[0-9]/.test(x.peek())){return null}else{if((x.next()=="0"&&x.match(/^[xX][0-9a-fA-F]+/))||x.match(/^[0-9]*(\.[0-9]+)?([eE][~+]?[0-9]+)?/)){return"number"}}}if((v=="0"&&x.match(/^[xX][0-9a-fA-F]+/))||x.match(/^[0-9]*(\.[0-9]+)?([eE][~+]?[0-9]+)?/)){return"number"}return null}if(v=="%"){x.skipToEnd();return"comment"}else{if(v=="/"){if(x.eat("*")){w.tokenize=o;return o(x,w)}}}if(j.test(v)){return"operator"}x.eatWhile(/\w/);return"variable"}function l(v,u){if(v.eatSpace()){return null}v.match(/([A-Z][A-Za-z0-9_]*)|(`.+`)/);u.tokenize=s;return"variable-3"}function c(v,u){if(v.eatSpace()){return null}v.match(/([a-zA-Z][A-Za-z0-9_]*)|(`.+`)/);u.tokenize=s;return"def"}function g(v,u){if(v.eatSpace()){return null}if(!u.hasPassedFirstStage&&v.eat("{")){u.hasPassedFirstStage=true;return"bracket"}else{if(u.hasPassedFirstStage){v.match(/([A-Z][A-Za-z0-9_]*)|(`.+`)|\$/);u.hasPassedFirstStage=false;u.tokenize=s;return"def"}else{u.tokenize=s;return null}}}function o(x,w){var u=false,v;while(v=x.next()){if(v=="/"&&u){w.tokenize=s;break}u=(v=="*")}return"comment"}function h(u){return function(z,x){var y=false,w,v=false;while((w=z.next())!=null){if(w==u&&!y){v=true;break}y=!y&&w=="\\"}if(v||!y){x.tokenize=s}return"string"}}function n(){var u=r.concat(f);return new RegExp("[\\[\\]]|("+u.join("|")+")$")}return{startState:function(){return{tokenize:s,currentIndent:0,doInCurrentLine:false,hasPassedFirstStage:false}},token:function(v,u){if(v.sol()){u.doInCurrentLine=0}return u.tokenize(v,u)},indent:function(w,u){var v=u.replace(/^\s+|\s+$/g,"");if(v.match(t)||v.match(m)||v.match(/(\[])/)){return i.indentUnit*(w.currentIndent-1)}if(w.currentIndent<0){return 0}return w.currentIndent*i.indentUnit},fold:"indent",electricInput:n(),lineComment:"%",blockCommentStart:"/*",blockCommentEnd:"*/"}});a.defineMIME("text/x-oz","oz")});