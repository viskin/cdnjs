(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){var b={};var e=/[^\s\u00a0]/;var c=a.Pos;function d(g){var f=g.search(e);return f==-1?0:f}a.commands.toggleComment=function(f){f.toggleComment()};a.defineExtension("toggleComment",function(h){if(!h){h=b}var f=this;var k=Infinity,g=this.listSelections(),l=null;for(var j=g.length-1;j>=0;j--){var n=g[j].from(),m=g[j].to();if(n.line>=k){continue}if(m.line>=k){m=c(k,0)}k=n.line;if(l==null){if(f.uncomment(n,m,h)){l="un"}else{f.lineComment(n,m,h);l="line"}}else{if(l=="un"){f.uncomment(n,m,h)}else{f.lineComment(n,m,h)}}}});a.defineExtension("lineComment",function(k,l,o){if(!o){o=b}var m=this,h=m.getModeAt(k);var n=o.lineComment||h.lineComment;if(!n){if(o.blockCommentStart||h.blockCommentStart){o.fullLines=true;m.blockComment(k,l,o)}return}var j=m.getLine(k.line);if(j==null){return}var g=Math.min(l.ch!=0||l.line==k.line?l.line+1:l.line,m.lastLine()+1);var f=o.padding==null?" ":o.padding;var i=o.commentBlankLines||k.line==l.line;m.operation(function(){if(o.indent){var s=null;for(var r=k.line;r<g;++r){var p=m.getLine(r);var q=p.slice(0,d(p));if(s==null||s.length>q.length){s=q}}for(var r=k.line;r<g;++r){var p=m.getLine(r),t=s.length;if(!i&&!e.test(p)){continue}if(p.slice(0,t)!=s){t=d(p)}m.replaceRange(s+n+f,c(r,0),c(r,t))}}else{for(var r=k.line;r<g;++r){if(i||e.test(m.getLine(r))){m.replaceRange(n+f,c(r,0))}}}})});a.defineExtension("blockComment",function(j,k,n){if(!n){n=b}var m=this,h=m.getModeAt(j);var i=n.blockCommentStart||h.blockCommentStart;var l=n.blockCommentEnd||h.blockCommentEnd;if(!i||!l){if((n.lineComment||h.lineComment)&&n.fullLines!=false){m.lineComment(j,k,n)}return}var g=Math.min(k.line,m.lastLine());if(g!=j.line&&k.ch==0&&e.test(m.getLine(g))){--g}var f=n.padding==null?" ":n.padding;if(j.line>g){return}m.operation(function(){if(n.fullLines!=false){var q=e.test(m.getLine(g));m.replaceRange(f+l,c(g));m.replaceRange(i+f,c(j.line,0));var o=n.blockCommentLead||h.blockCommentLead;if(o!=null){for(var p=j.line+1;p<=g;++p){if(p!=g||q){m.replaceRange(o+f,c(p,0))}}}}else{m.replaceRange(l,k);m.replaceRange(i,j)}})});a.defineExtension("uncomment",function(z,j,k){if(!k){k=b}var w=this,t=w.getModeAt(z);var l=Math.min(j.ch!=0||j.line==z.line?j.line:j.line-1,w.lastLine()),m=Math.min(z.line,l);var v=k.lineComment||t.lineComment,h=[];var C=k.padding==null?" ":k.padding,o;lineComment:{if(!v){break lineComment}for(var A=m;A<=l;++A){var p=w.getLine(A);var q=p.indexOf(v);if(q>-1&&!/comment/.test(w.getTokenTypeAt(c(A,q+1)))){q=-1}if(q==-1&&(A!=l||A==m)&&e.test(p)){break lineComment}if(q>-1&&e.test(p.slice(0,q))){break lineComment}h.push(p)}w.operation(function(){for(var G=m;G<=l;++G){var E=h[G-m];var H=E.indexOf(v),F=H+v.length;if(H<0){continue}if(E.slice(F,F+C.length)==C){F+=C.length}o=true;w.replaceRange("",c(G,H),c(G,F))}});if(o){return true}}var r=k.blockCommentStart||t.blockCommentStart;var f=k.blockCommentEnd||t.blockCommentEnd;if(!r||!f){return false}var B=k.blockCommentLead||t.blockCommentLead;var y=w.getLine(m),n=l==m?y:w.getLine(l);var s=y.indexOf(r),u=n.lastIndexOf(f);if(u==-1&&m!=l){n=w.getLine(--l);u=n.lastIndexOf(f)}if(s==-1||u==-1||!/comment/.test(w.getTokenTypeAt(c(m,s+1)))||!/comment/.test(w.getTokenTypeAt(c(l,u+1)))){return false}var x=y.lastIndexOf(r,z.ch);var D=x==-1?-1:y.slice(0,z.ch).indexOf(f,x+r.length);if(x!=-1&&D!=-1&&D+f.length!=z.ch){return false}D=n.indexOf(f,j.ch);var g=n.slice(j.ch).lastIndexOf(r,D-j.ch);x=(D==-1||g==-1)?-1:j.ch+g;if(D!=-1&&x!=-1&&x!=j.ch){return false}w.operation(function(){w.replaceRange("",c(l,u-(C&&n.slice(u-C.length,u)==C?C.length:0)),c(l,u+f.length));var H=s+r.length;if(C&&y.slice(H,H+C.length)==C){H+=C.length}w.replaceRange("",c(m,s),c(m,H));if(B){for(var G=m+1;G<=l;++G){var F=w.getLine(G),I=F.indexOf(B);if(I==-1||e.test(F.slice(0,I))){continue}var E=I+B.length;if(C&&F.slice(E,E+C.length)==C){E+=C.length}w.replaceRange("",c(G,I),c(G,E))}}});return true})});