(function(t,e){"use strict";function n(){return e.qoopido.initialize("worker",t,arguments,!0)}"function"==typeof define&&define.amd?define(["./base","./support","q"],n):n()})(function(t,e){"use strict";var n=window.Q||e[2],i=RegExp("Blob$","i"),o=t.support.supportsMethod("Worker"),r=t.support.supportsMethod("URL")?window[t.support.getMethod("URL")]:null,s=t.support.getMethod("Blob")||t.support.getMethod("BlobBuilder"),u="var self = this, regex = new RegExp(',\\s+', 'g'); self.addEventListener('message', function(pEvent) { self.postMessage({ type: 'result', result: self.process(pEvent.data.func).apply(null, pEvent.data.args)}); }, false); self.postProgress = function(pProgress) { self.postMessage({ type: 'progress', progress: pProgress}); }; self.process = function(pFunction) { var functionArguments = pFunction.substring(pFunction.indexOf('(') + 1, pFunction.indexOf(')')).replace(regex, ',').split(','); functionArguments.push(pFunction.substring(pFunction.indexOf('{') + 1, pFunction.lastIndexOf('}'))); return Function.apply(null, functionArguments); };",a=null;return o&&r&&s&&(a=i.test(s)===!0?r.createObjectURL(new window[s]([u],{type:"text/javascript"})):r.createObjectURL((new window[s]).append(u).getBlob("text/javascript"))),t.base.extend({execute:function(t,e){var i=n.defer();if(e=e||[],a){var o=new Worker(a);o.addEventListener("message",function(t){switch(t.data.type){case"progress":i.notify(t.data.progress);break;case"result":i.resolve(t.data.result)}},!1),o.addEventListener("error",function(t){i.reject(t)},!1),o.postMessage({func:""+t,args:e})}else setTimeout(function(){try{i.resolve(t.apply(null,e))}catch(n){i.reject()}},0);return i.promise}})},window);