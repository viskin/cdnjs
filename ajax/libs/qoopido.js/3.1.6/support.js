(function(t){var e=["./base","./pool/dom","q"];String.prototype.ucfirst||e.push("./polyfill/string/ucfirst"),window.qoopido.registerSingleton("support",t,e)})(function(t,e,r,n,o,i,s){"use strict";var u=t.q||o.Q,l=RegExp("-([a-z])","gi"),a=RegExp("^(Moz|WebKit|Khtml|ms|O|Icab)(?=[A-Z])"),c=function(){return arguments[1].ucfirst()},p={prefix:null,method:{},property:{},css:{},element:{},promises:{prefix:null,method:{},property:{},css:{},test:{}}};return t.base.extend({test:{},testMultiple:function(){var t,e=[],r=0;for(r;(t=arguments[r])!==s;r++)switch(typeof t){case"string":e.push(this.test[t]());break;case"boolean":var n=u.defer();t?n.resolve():n.reject(),e.push(n.promise);break;default:e.push(t)}return u.all(e)},getPrefix:function(){var t,r=p.prefix||null;if(null===r){var n=e.pool.dom.obtain("div"),o=n.style;r=!1;for(t in o)a.test(t)&&(r=t.match(a)[0]);r===!1&&"WebkitOpacity"in o&&(r="WebKit"),r===!1&&"KhtmlOpacity"in o&&(r="Khtml"),r=p.prefix=r===!1?!1:{method:r,properties:[r.toLowerCase(),r.toLowerCase().ucfirst()]},n.dispose()}return r},getMethod:function(t,e){e=e||o;var r=e.tagName,n=p.method[r]=p.method[r]||{},i=n[t]=p.method[r][t]||null;if(null===i){i=!1;var u,l,a=0,c=t.ucfirst(),f=this.getPrefix();for(u=f!==!1?(t+" "+f.method+c+" "+f.properties.join(c+" ")+c).split(" "):[t],a;(l=u[a])!==s;a++)if(e[l]!==s&&("function"==typeof e[l]||"object"==typeof e[l])){i=l;break}p.method[r][t]=i}return i},getProperty:function(t,e){e=e||o;var r=e.tagName,n=p.property[r]=p.property[r]||{},i=n[t]=p.property[r][t]||null;if(null===i){i=!1;var u,l,a=0,c=t.ucfirst(),f=this.getPrefix();for(u=f!==!1?(t+" "+f.properties.join(c+" ")+c).split(" "):[t],a;(l=u[a])!==s;a++)if(e[l]!==s){i=l;break}p.property[r][t]=i}return i},getCssProperty:function(t){t=t.replace(l,c);var r=p.css[t]||null;if(null===r){r=!1;var n,o=0,i=e.pool.dom.obtain("div"),u=t.ucfirst(),a=(this.getPrefix()||{properties:[]}).properties,f=(t+" "+a.join(u+" ")+u).split(" ");for(o;(n=f[o])!==s;o++)if(i.style[n]!==s){r=n;break}p.css[t]=r,i.dispose()}return r},supportsPrefix:function(){return!!this.getPrefix()},supportsMethod:function(t,e){return!!this.getMethod(t,e)},supportsProperty:function(t,e){return!!this.getProperty(t,e)},supportsCssProperty:function(t){return!!this.getCssProperty(t)},testPrefix:function(){var t=p.promises.prefix;if(null===t){var e=u.defer(),r=this.getPrefix();r?e.resolve(r):e.reject(),t=p.promises.prefix=e.promise}return t},testMethod:function(t,e){e=e||o;var r=e.tagName,n=p.promises.method[r]=p.promises.method[r]||{},i=n[t]=p.promises.method[r][t]||null;if(null===i){var s=u.defer(),l=this.getMethod(t,e);l?s.resolve(l):s.reject(),i=p.promises.method[r][t]=s.promise}return i},testProperty:function(t,e){e=e||o;var r=e.tagName,n=p.promises.property[r]=p.promises.property[r]||{},i=n[t]=p.promises.property[r][t]||null;if(null===i){var s=u.defer(),l=this.getProperty(t,e);l?s.resolve(l):s.reject(),i=p.promises.property[r][t]=s.promise}return i},testCssProperty:function(t){var e=p.promises.css[t]||null;if(null===e){var r=u.defer(),n=this.getCssProperty(t);n?r.resolve(n):r.reject(),e=p.promises.css[t]=r.promise}return e},addTest:function(t,e){return this.test[t]=function(){var r=p.promises.test[t]||null;if(null===r){var n=u.defer(),o=Array.prototype.slice.call(arguments);o.splice(0,0,n),e.apply(null,o),r=p.promises.test[t]=n.promise}return r}}})});