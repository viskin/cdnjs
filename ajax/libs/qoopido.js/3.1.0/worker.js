(function(t,e){"use strict";function n(){return e.qoopido.initialize("worker",t,arguments,!0)}"function"==typeof define&&define.amd?define(["./base","./support","q"],n):n()})(function(t,e){"use strict";var n=window.Q||e[2],o=RegExp("Blob$","i"),i=t.support.supportsMethod("Worker"),r=t.support.supportsMethod("URL")?window[t.support.getMethod("URL")]:null,s=t.support.getMethod("Blob")||t.support.getMethod("BlobBuilder"),u="var self = this, regex = new RegExp(',\\s+', 'g'); self.addEventListener('message', function(pEvent) { self.postMessage({ type: 'result', result: self.process(pEvent.data.func).apply(null, pEvent.data.args)}); }, false); self.postProgress = function(pProgress) { self.postMessage({ type: 'progress', progress: pProgress}); }; self.process = function(pFunction) { var functionArguments = pFunction.substring(pFunction.indexOf('(') + 1, pFunction.indexOf(')')).replace(regex, ',').split(','); functionArguments.push(pFunction.substring(pFunction.indexOf('{') + 1, pFunction.lastIndexOf('}'))); return Function.apply(null, functionArguments); };",a=null;return i&&r&&s&&(a=o.test(s)===!0?r.createObjectURL(new window[s]([u],{type:"text/javascript"})):r.createObjectURL((new window[s]).append(u).getBlob("text/javascript"))),t.base.extend({execute:function(t,e){var o=n.defer();if(e=e||[],a){var i=new Worker(a);i.addEventListener("message",function(t){switch(t.data.type){case"progress":o.notify(t.data.progress);break;case"result":o.resolve(t.data.result)}},!1),i.addEventListener("error",function(t){o.reject(t)},!1),i.postMessage({func:""+t,args:e})}else setTimeout(function(){try{o.resolve(t.apply(null,e))}catch(n){o.reject()}},0);return o.promise}})},window);