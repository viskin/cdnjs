(function(t,e){"use strict";function n(){return e.qoopido.initialize("transport/jsonp",t,arguments,!0)}"function"==typeof define&&define.amd?define(["../transport","../function/merge","../function/unique/uuid","../url","../dom/element","../pool/dom","q"],n):n()})(function(t,e,n,i,o){"use strict";function r(t,e){var n=this,o=n.dfd,r=n.script,l=n.settings;e="object"==typeof e?n.serialize(e):e,t="".concat(t,t.indexOf("?")>-1?"&":"?","".concat(l.callback,"=",n.id)),t=l.cache===!1?"".concat(t,t.indexOf("?")>-1?"&":"?","".concat("_=",""+(new Date).getTime())):t,t=e?"".concat(t,t.indexOf("?")>-1?"&":"?",e):t,i[n.id]=function(t){try{delete i[n.id]}catch(e){i[n.id]=null}c.call(n),o.resolve(t)},r.on("load readystatechange",function(t){u.call(n,t)}).one("error",function(){s.call(n)}).setAttribute("src",t),d.appendChild(r.element),n.timeout=setTimeout(function(){a.call(n)},l.timeout)}function u(t){var e=this,n=e.dfd;t.readyState&&"loaded"!==t.readyState&&"complete"!==t.readyState||e.script.off().element.dispose(),e.timeout&&clearTimeout(e.timeout),e.timeout=setTimeout(function(){a.call(e)},e.settings.timeout),n.notify(t)}function s(){var t=this;c.call(t),t.dfd.reject()}function a(){var t=this;c.call(t),t.dfd.reject(!1)}function c(){var t=this;t.timeout&&clearTimeout(t.timeout),t.script.off().element.dispose()}var l,f=i.Q||e[4],d=o.getElementsByTagName("head")[0];return l=t.transport.extend({_settings:{callback:"callback",cache:!1,timeout:5e3},load:function(e,n,o){var u={};return e=t.url.resolve(e),u.id="".concat("jsonp-",t["function/unique/string"]()),u.dfd=f.defer(),u.script=t["dom/element"].create(i.qoopido.shared.pool.dom.obtain("script")),u.settings=t["function/merge"]({},this._settings,o),u.timeout=null,u.script.setAttribute("async",!0),r.call(u,e,n),u.dfd.promise}})},window,document);