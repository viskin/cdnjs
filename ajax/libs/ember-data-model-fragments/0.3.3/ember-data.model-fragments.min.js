/*!
 * @overview  Ember Data Model Fragments
 * @copyright Copyright 2014 Lytics Inc. and contributors
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/lytics/ember-data.model-fragments/master/LICENSE
 * @version   0.3.3
 */
!function(a,b){b["true"]=a,function(){var a,b,c,d;!function(){var e={},f={};a=function(a,b,c){e[a]={deps:b,callback:c}},d=c=b=function(a){function c(b){if("."!==b.charAt(0))return b;for(var c=b.split("/"),d=a.split("/").slice(0,-1),e=0,f=c.length;f>e;e++){var g=c[e];if(".."===g)d.pop();else{if("."===g)continue;d.push(g)}}return d.join("/")}if(f[a])return f[a];if(f[a]={},!e[a])throw new Error("Could not find module "+a);for(var d,g=e[a],h=g.deps,i=g.callback,j=[],k=0,l=h.length;l>k;k++)"exports"===h[k]?j.push(d={}):j.push(b(c(h[k])));var m=i.apply(this,j);return f[a]=d||m}}(),a("core-model",["ember","./model","exports"],function(a,b,c){"use strict";var d=a["default"],e=b["default"];e.proto();var f=["_setup","_unhandledEvent","_createSnapshot","send","transitionTo","isEmpty","isLoading","isLoaded","isDirty","isSaving","isDeleted","isNew","isValid","serialize","changedAttributes","eachAttribute","fragmentDidDirty","fragmentDidReset","rollbackFragments"].reduce(function(a,b){return a[b]=e.prototype[b]||d.meta(e.prototype).descs[b],a},{}),g=["attributes","eachAttribute","transformedAttributes","eachTransformedAttribute"].reduce(function(a,b){return a[b]=e[b]||d.meta(e).descs[b],a},{}),h=d.Object.extend(f,{eachRelationship:d.K,updateRecordArraysLater:d.K});h.reopenClass(g,{eachRelationship:d.K}),c["default"]=h}),a("ember",["exports"],function(a){"use strict";a["default"]=Ember}),a("fragments/array/fragment",["ember","./stateful","../model","exports"],function(a,b,c,d){"use strict";var e=a["default"],f=b["default"],g=c.getActualFragmentType,h=e.get,i=e.EnumerableUtils.map,j=f.extend({type:null,options:null,init:function(){this._super(),this._isInitializing=!1},_processData:function(a){var b=h(this,"owner"),c=h(b,"store"),d=h(this,"type"),f=h(this,"options"),j=h(this,"name"),k=h(this,"content");this._isInitializing=!0;var l=i(e.makeArray(a),function(a,e){var h=k[e];if(!h){var i=g(d,f,a);h=c.buildFragment(i),h.setProperties({_owner:b,_name:j})}return h.setupData(a),h});return this._isInitializing=!1,l},_createSnapshot:function(){return i(this,function(a){return a._createSnapshot()})},adapterDidCommit:function(){this._super(),this.invoke("adapterDidCommit")},isDirty:function(){return this._super()||this.isAny("isDirty")}.property("@each.isDirty","_originalState"),rollback:function(){this._super(),this.invoke("rollback")},serialize:function(){return this.invoke("serialize")},replaceContent:function(a,b,c){var d=h(this,"owner"),e=h(this,"name");return c&&c.forEach(function(a){var b=h(a,"_owner");b||a.setProperties({_owner:d,_name:e})}),h(this,"content").replace(a,b,c)},addFragment:function(a){return this.addObject(a)},removeFragment:function(a){return this.removeObject(a)},createFragment:function(a){var b=h(this,"owner"),c=h(b,"store"),d=h(this,"type"),e=c.createFragment(d,a);return this.pushObject(e)}});d["default"]=j}),a("fragments/array/stateful",["ember","exports"],function(a,b){"use strict";var c=a["default"],d=c.get,e=c.set,f=(Array.prototype.splice,c.ArrayProxy.extend({owner:null,name:null,init:function(){this._super(),this._pendingData=void 0,e(this,"_originalState",[])},content:function(){return c.A()}.property(),setupData:function(a){if(this._pendingData!==a){this._pendingData=a;var b=this._processData(a);e(this,"_originalState",b),this.replaceContent(0,d(this,"content.length"),b),this._pendingData=void 0}},_processData:function(a){return c.makeArray(a)},_createSnapshot:function(){return this.toArray()},adapterDidCommit:function(){e(this,"_originalState",this.toArray())},isDirty:function(){return 0!==c.compare(this.toArray(),d(this,"_originalState"))}.property("[]","_originalState"),rollback:function(){this.setObjects(d(this,"_originalState"))},serialize:function(){return this.toArray()},arrayContentDidChange:function(){this._super.apply(this,arguments);var a=d(this,"owner"),b=d(this,"name");this.get("isDirty")?a.fragmentDidDirty(b,this):a.fragmentDidReset(b,this)},toStringExtension:function(){return"owner("+d(this,"owner.id")+")"}}));b["default"]=f}),a("fragments/attributes",["ember","../util/ember-new-computed","./array/stateful","./array/fragment","./model","exports"],function(a,b,c,d,e,f){"use strict";function g(a,b,c){return a.setProperties({_owner:b,_name:c})}function h(a,b){function c(c,d,e){var f=c.store,h=c._data[d]||l(c,b,"object"),j=c._fragments[d],k=q(a,b,h);return!j&&i(f.modelFor(k),h)?j=h:h&&h!==j?(j||(j=g(f.buildFragment(k),c,d)),c._data[d]=j,j.setupData(h)):j=h,j}b=b||{};var d={type:"fragment",isAttribute:!0,isFragment:!0,options:b};return n({set:function(a,b){var d=c(this,a,b);this.store;return d=b?g(b,this,a):null,this._data[a]!==d?this.fragmentDidDirty(a,d):this.fragmentDidReset(a,d),this._fragments[a]=d},get:function(a){var b=c(this,a);return this._fragments[a]=b}}).meta(d)}function i(a,b){return b instanceof a?!0:m.MODEL_FACTORY_INJECTIONS?b instanceof a.superclass:!1}function j(a,b){function c(c,d){var e=a?p:o;return e.create({type:a,options:b,name:d,owner:c})}function d(a,d,e){var f=a._data[d]||l(a,b,"array"),g=a._fragments[d]||null;return f instanceof o&&!g?g=f:f&&f!==g?(g||(g=c(a,d)),a._data[d]=g,g.setupData(f)):g=f,g}"string"!==m.typeOf(a)&&(b=a,a=null),b=b||{};var e={type:"fragment",isAttribute:!0,isFragment:!0,options:b,kind:"hasMany"};return n({set:function(a,b){var e=d(this,a,b);return m.isArray(b)?(e||(e=c(this,a)),e.setObjects(b)):null===b&&(e=null),this._data[a]!==e||r(e,"isDirty")?this.fragmentDidDirty(a,e):this.fragmentDidReset(a,e),this._fragments[a]=e},get:function(a){var b=d(this,a);return this._fragments[a]=b}}).meta(e)}function k(){return m.computed.alias("_owner").readOnly()}function l(a,b,c){var d;if("function"==typeof b.defaultValue)d=b.defaultValue();else{if(!b.defaultValue)return null;d=b.defaultValue}return m.copy(d,!0)}var m=a["default"],n=b["default"],o=c["default"],p=d["default"],q=e.getActualFragmentType,r=m.get;f.hasOneFragment=h,f.hasManyFragments=j,f.fragmentOwner=k}),a("fragments/ext",["../store","../model","exports"],function(a,b,c){"use strict";var d=a["default"],e=b["default"],f=Ember.get;d.reopen({buildFragment:function(a){return a=this.modelFor(a),a.create({store:this})},createFragment:function(a,b){var c=this.buildFragment(a);return b&&c.setProperties(b),c.send("loadedData"),c}}),e.reopen({_setup:function(){this._super(),this._fragments={}},_createSnapshot:function(){var a=this._super.apply(this,arguments),b=a._attributes;return Ember.keys(b).forEach(function(a){var c=b[a];c&&"function"==typeof c._createSnapshot&&(b[a]=c._createSnapshot())}),a},adapterDidCommit:function(a){this._super.apply(this,arguments);var b;for(var c in this._fragments)(b=this._fragments[c])&&b.adapterDidCommit()},changedAttributes:function(){var a=this._super();return Ember.keys(this._fragments).forEach(function(b){b in this._attributes&&(a[b]=!0)},this),a},rollback:function(){this._super(),this.rollbackFragments()},rollbackFragments:function(){for(var a in this._fragments)this._fragments[a]&&this._fragments[a].rollback()},fragmentDidDirty:function(a,b){f(this,"isDeleted")||(this._attributes[a]=b,this.send("becomeDirty"))},fragmentDidReset:function(a,b){delete this._attributes[a],f(this,"isNew")||this.send("propertyWasReset",a)}}),c.Store=d,c.Model=e}),a("fragments/model",["ember","../core-model","./states","exports"],function(a,b,c,d){"use strict";function e(a,b){g.beginPropertyChanges();for(var c=0,d=b.length;d>c;c++)a.notifyPropertyChange(b[c]);g.endPropertyChanges()}function f(a,b,c){if(!b.polymorphic||!c)return a;var d=b.typeKey||"type",e=c[d];return e||a}var g=a["default"],h=b["default"],i=c["default"],j=g.get,k=h.extend(g.Comparable,g.Copyable,{_name:null,_owner:null,currentState:i.empty,setupData:function(a){var b=j(this,"store"),c=b.modelFor(this.constructor),d=b.serializerFor(c);this._attributes={},this._data=d.normalize(c,a),this.send("pushedData"),e(this,g.keys(a))},rollback:function(){var a=g.keys(this._attributes);this._attributes={},this.rollbackFragments(),this.send("rolledBack"),e(this,a)},compare:function(a,b){return a===b?0:1},copy:function(){var a=j(this,"store"),b=a.modelFor(this.constructor),c={};return g.merge(c,this._data),g.merge(c,this._attributes),this.store.createFragment(b,c)},adapterDidCommit:function(){g.keys(this._inFlightAttributes).length&&(g.mixin(this._data,this._inFlightAttributes),this._inFlightAttributes={});var a;for(var b in this._fragments)(a=this._fragments[b])&&a.adapterDidCommit();this.transitionTo("saved")},toStringExtension:function(){return"owner("+j(this,"_owner.id")+")"},init:function(){this._super(),this._setup()}});d["default"]=k,d.getActualFragmentType=f}),a("fragments/states",["ember","../states","exports"],function(a,b,c){"use strict";function d(a,b){for(var c in b)a[c]=b[c];return a}function e(a,b,c){a=d(b?f.create(b):{},a),a.parentState=b,a.stateName=c;for(var g in a)a.hasOwnProperty(g)&&"parentState"!==g&&"stateName"!==g&&"object"==typeof a[g]&&(a[g]=e(a[g],a,c+"."+g));return a}var f=a["default"],g=b["default"],h=f.get,i=g.loaded.saved.didSetProperty,j=g.loaded.updated.uncommitted.propertyWasReset,k=function(a){var b=h(a,"_owner"),c=h(a,"_name");b&&b.fragmentDidDirty(c,a)},l={isEmpty:!1,isLoading:!1,isLoaded:!1,isDirty:!1,isSaving:!1,isDeleted:!1,isNew:!1,isValid:!0,didSetProperty:i,propertyWasReset:f.K,becomeDirty:f.K,rolledBack:f.K,empty:{isEmpty:!0,loadedData:function(a){a.transitionTo("loaded.created")},pushedData:function(a){a.transitionTo("loaded.saved")}},loaded:{pushedData:function(a){a.transitionTo("saved")},saved:{setup:function(a){var b=h(a,"_owner"),c=h(a,"_name");b._fragments[c]&&!a._isInitializing&&(h(b,c+".isDirty")||b.fragmentDidReset(c,a))},pushedData:f.K,becomeDirty:function(a){a.transitionTo("updated")}},created:{isDirty:!0,setup:k},updated:{isDirty:!0,setup:k,propertyWasReset:j,rolledBack:function(a){a.transitionTo("saved")}}}};l=e(l,null,"root"),c["default"]=l}),a("fragments/transform",["../snapshot","../transform","exports"],function(a,b,c){"use strict";function d(a){return a instanceof e?g(a,"record.store").serializerFor(a.typeKey).serialize(a):a}var e=a["default"],f=b["default"],g=Ember.get,h=Ember.isArray,i=Ember.EnumerableUtils.map,j=f.extend({deserialize:function(a){return a},serialize:function(a){return a?h(a)?i(a,d):d(a):null}});c["default"]=j}),a("initializers",["./fragments/transform","exports"],function(a,b){"use strict";var c=a["default"],d=[{name:"fragmentTransform",before:"store",initialize:function(a,b){b.register("transform:fragment",c)}}];b["default"]=d}),a("main",["ember","./fragments/ext","./fragments/model","./fragments/array/fragment","./fragments/transform","./fragments/attributes","./initializers","exports"],function(a,b,c,d,e,f,g,h){"use strict";var i=a["default"],j=(b["default"],c["default"]),k=d["default"],l=e["default"],m=f.hasOneFragment,n=f.hasManyFragments,o=f.fragmentOwner,p=g["default"];DS.ModelFragment=j,DS.FragmentArray=k,DS.FragmentTransform=l,DS.hasOneFragment=m,DS.hasManyFragments=n,DS.fragmentOwner=o,i.onLoad("Ember.Application",function(a){p.forEach(a.initializer,a)}),i.libraries&&i.libraries.register("Model Fragments","0.3.3"),h["default"]=DS}),a("model",["exports"],function(a){"use strict";a["default"]=DS.Model}),a("snapshot",["exports"],function(a){"use strict";a["default"]=DS.Snapshot}),a("states",["exports"],function(a){"use strict";a["default"]=DS.RootState}),a("store",["exports"],function(a){"use strict";a["default"]=DS.Store}),a("transform",["exports"],function(a){"use strict";a["default"]=DS.Transform}),a("util/ember-new-computed",["exports"],function(a){"use strict";var b,c=window.Ember,d=c.computed;try{c.computed({set:function(){},get:function(){}}),b=!0}catch(e){b=!1}a["default"]=function(){var a=[],c=arguments[arguments.length-1];if("function"==typeof c||b)return d.apply(this,arguments);for(var e=0,f=arguments.length-1;f>e;e++)a.push(arguments[e]);var g;return g=c.set?function(a,b){return arguments.length>1?c.set.call(this,a,b):c.get.call(this,a)}:function(a){return c.get.call(this,a)},a.push(g),d.apply(this,a)}}),b("main")["default"]}()}({},function(){return this}());