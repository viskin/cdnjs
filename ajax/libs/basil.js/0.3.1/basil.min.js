!function(){Object.extend=function(){for(var e="object"==typeof arguments[0]?arguments[0]:{},t=1;t<arguments.length;t++)if(arguments[t]&&"object"==typeof arguments[t])for(var n in arguments[t])e[n]=arguments[t][n];return e};var e=function(t){return(new e.Storage).init(t)};e.version="0.3.1",e.options=Object.extend({namespace:"b45i1",storage:null,storages:["local","cookie","session","memory"],expireDays:365},window.Basil?window.Basil.options:{}),e.Storage=function(){var t="b45i1"+(Math.random()+1).toString(36).substring(7),n={},o=function(e){return e?"[object Array]"===Object.prototype.toString.call(e)?e:[e]:null},i=function(e,t){var n="";if("string"==typeof t)n=e+":"+t;else if(t instanceof Array){n=e;for(var o=0;o<t.length;o++)t[o]&&(n+=":"+t[o])}return n},r=function(e){return JSON.stringify(e)},s=function(e){return JSON.parse(e)};return n.local={engine:window.localStorage,check:function(){try{this.engine.setItem(t,!0),this.engine.removeItem(t)}catch(e){return!1}return!0},set:function(e,t){e&&this.engine.setItem(e,t)},get:function(e){return this.engine.getItem(e)},remove:function(e){this.engine.removeItem(e)},reset:function(){for(var e,t=0;t<this.engine.length;t++)e=this.engine.key(t),0===e.indexOf(this.options.namespace)&&this.remove(e)}},n.session=Object.extend({},n.local,{engine:window.sessionStorage}),n.memory={_hash:{},check:function(){return!0},set:function(e,t){e&&(this._hash[e]=t)},get:function(e){return this._hash[e]||null},remove:function(e){delete this._hash[e]},reset:function(){for(var e in this._hash)0===e.indexOf(this.options.namespace)&&this.remove(e)}},n.cookie={check:function(){return navigator.cookieEnabled},set:function(e,t,n){if(e){n=n||{};var o=e+"="+t;if(n.expireDays){var i=new Date;i.setTime(i.getTime()+24*n.expireDays*60*60*1e3),o+="; expires="+i.toGMTString()}n.domain&&(o+="; domain="+n.domain),document.cookie=o+"; path=/"}},get:function(e){for(var t=document.cookie.split(";"),n=0;n<t.length;n++){var o=t[n].replace(/^\s*/,"");if(0===o.indexOf(e+"="))return o.substring(e.length+1,o.length)}return null},remove:function(e){if(e){this.set(e,"",{expireDays:-1});for(var t=document.domain.split("."),n=t.length-1;n>0;n--)this.set(e,"",{expireDays:-1,domain:"."+t.slice(-n).join(".")})}},reset:function(){for(var e=document.cookie.split(";"),t=0;t<e.length;t++){var n=e[t].replace(/^\s*/,""),o=n.substr(0,n.indexOf("="));0===o.indexOf(this.options.namespace)&&this.remove(o)}}},{init:function(t){this.options=Object.extend({},e.options,t),this.supportedStorages={};for(var o,i=0;i<this.options.storages.length;i++)o=this.options.storages[i],n.hasOwnProperty(o)&&(this.supportedStorages[o]=n[o]);return this.defaultStorage=this.check(this.options.storage)?this.options.storage:this.detect(),this},detect:function(){for(var e in this.supportedStorages)if(this.check(e))return e;return null},check:function(e){return e=e||this.defaultStorage,this.supportedStorages.hasOwnProperty(e)?this.supportedStorages[e].check():!1},set:function(e,t,s){if(e=i(this.options.namespace,e)){t=r(t),s=Object.extend({expireDays:this.options.expireDays},s);for(var a=o(s.storages)||[this.defaultStorage],c=0;c<a.length;c++)this.check(a[c])&&n[a[c]].set(e,t,s)}},get:function(e,t){if(!(e=i(this.options.namespace,e)))return null;t=t||{};for(var r=null,a=o(t.storages)||[this.defaultStorage],c=0;null===r&&c<a.length;c++)this.check(a[c])&&(r=s(n[a[c]].get(e)));return r},remove:function(e,t){if(!(e=i(this.options.namespace,e)))return null;t=t||{};for(var r=o(t.storages)||[this.defaultStorage],s=0;s<r.length;s++)this.check(r[s])&&n[r[s]].remove(e)},reset:function(e){e=e||{};for(var t=o(e.storages)||[this.defaultStorage],i=0;i<t.length;i++)this.check(t[i])&&n[t[i]].reset()},cookie:n.cookie,localStorage:n.local,sessionStorage:n.session}},window.Basil=e,"function"==typeof define&&define.amd?define(function(){return e}):"undefined"!=typeof module&&module.exports&&(module.exports=e)}();