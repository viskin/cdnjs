/*! vissense - v0.0.2 - 2014-07-12
* Copyright (c) 2014 tbk;*/
!function(a){"use strict";var b=-1,c={onVisible:function(a){var b=c.isSupported();if(!b||!c.hidden())return a(),b;var d=c.change(function(){c.hidden()||(c.unbind(d),a())});return d},change:function(a){if(!c.isSupported())return!1;b+=1;var d=b;return c._callbacks[d]=a,c._listen(),d},unbind:function(a){delete c._callbacks[a]},afterPrerendering:function(a){var b=c.isSupported(),d="prerender";if(!b||d!=c.state())return a(),b;var e=c.change(function(b,f){d!=f&&(c.unbind(e),a())});return e},hidden:function(){return!(!c._doc.hidden&&!c._doc.webkitHidden)},state:function(){return c._doc.visibilityState||c._doc.webkitVisibilityState||"visible"},isSupported:function(){return!(!c._doc.visibilityState&&!c._doc.webkitVisibilityState)},_doc:document||{},_callbacks:{},_change:function(a){var b=c.state();for(var d in c._callbacks)c._callbacks[d].call(c._doc,a,b)},_listen:function(){if(!c._init){var a="visibilitychange";c._doc.webkitVisibilityState&&(a="webkit"+a);var b=function(){c._change.apply(c,arguments)};c._doc.addEventListener?c._doc.addEventListener(a,b):c._doc.attachEvent(a,b),c._init=!0}}};"undefined"!=typeof module&&module.exports?module.exports=c:a.Visibility=c}(this),function(){"use strict";Object.keys||(Object.keys=function(){var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=c.length;return function(e){if("object"!=typeof e&&("function"!=typeof e||null===e))throw new TypeError("Object.keys called on non-object");var f,g,h=[];for(f in e)a.call(e,f)&&h.push(f);if(b)for(g=0;d>g;g++)a.call(e,c[g])&&h.push(c[g]);return h}}())}.call(this,this),function(a,b){"use strict";function c(a){var b=a.ownerDocument;return"defaultView"in b?b.defaultView:b.parentWindow}function d(a,c){return function(){return a()?c():b}}a.VisSenseUtils={_window:c,fireIf:d}}.call(this,this),function(a,b){"use strict";function c(a,b,c){for(var d=-1,e=Object.keys(b),f=e.length;++d<f;){var g=e[d];a[g]=c?c(a[g],b[g],g,a,b):b[g]}return a}function d(){}function e(a){return a}function f(){return(new Date).getTime()}function g(b){return a.setTimeout(function(){b()},0)}function h(a){return a===Object(a)}function i(a,b){if(!h(a))return a;for(var c in Object.keys(b))void 0===a[c]&&(a[c]=b[c]);return a}b=c(b,{noop:d,identity:e,isObject:h,defaults:i,extend:c,now:f,defer:g})}.call(this,this,this.VisSenseUtils),function(a,b,c){"use strict";function d(){return!!g}function e(){return g?!c.hidden():!0}function f(a){g&&c.change(a)}var g=!!c&&!!c.change&&!!c.isSupported&&c.isSupported();b.isPageVisibilityAPIAvailable=d,b.isPageVisible=e,b.onPageVisibilityChange=f}.call(this,this,this.VisSenseUtils,this.Visibility),function(a,b,c){"use strict";function d(a){if(!a.offsetParent){var b=f(a,"position");if("fixed"!==b)return!1}return!0}function e(a){var d=b._window(a);if("undefined"==typeof a.style)return c;if(d.getComputedStyle)return d.getComputedStyle(a,null);if(a.currentStyle)return a.currentStyle;throw new Error("cannot determine effective stylesheet in this browser")}function f(a,b){var d=e(a);if(!d)return c;var g=d[b];return"inherit"===g&&a.parentNode.style?f(a.parentNode,b):g}function g(a){var b=f(a,"display");return"none"===b?!1:a.parentNode.style?g(a.parentNode):!0}function h(a){if(a===b._window(a).document)return!0;if(!a||!a.parentNode)return!1;if(!d(a))return!1;var c=g(a);if(c!==!0)return!1;var e=f(a,"opacity");if(.01>+e)return!1;var h=f(a,"visibility");return"hidden"===h||"collapse"===h?!1:!0}b._isDisplayed=g,b._findEffectiveStyle=e,b.isVisibleByStyling=h}.call(this,this,this.VisSenseUtils),function(a,b){"use strict";function c(a){var b=a.getBoundingClientRect();return"undefined"==typeof b.height||"undefined"==typeof b.width?{top:b.top,bottom:b.bottom,left:b.left,right:b.right,height:a.clientHeight,width:a.clientWidth}:b}function d(a){var c=b._window(a);return{height:c.innerHeight||c.document.documentElement.clientHeight,width:c.innerWidth||c.document.documentElement.clientWidth}}function e(a){var b=c(a);if(b&&(b.width<=0||b.height<=0))return!1;var e=d(a);return!!b&&b.top>=0&&b.left>=0&&b.bottom<e.height&&b.right<e.width}function f(a){var b=c(a);if(b&&(b.width<=0||b.height<=0))return!1;var e=d(a);return!!b&&b.bottom>0&&b.right>0&&b.top<e.height&&b.left<e.width}b.viewport=d,b.isFullyInViewport=e,b.isInViewport=f,b._getBoundingClientRect=c}.call(this,this,this.VisSenseUtils),function(a,b,c){"use strict";function d(a){if(!c.isInViewport(a)||!c.isVisibleByStyling(a)||!c.isPageVisible())return 0;var d=c._getBoundingClientRect(a);if(!d||d.height<=0||d.width<=0)return 0;var e=0,f=0,g=c.viewport(a);d.top>=0?e=b.min(d.height,g.height-d.top):d.top<0&&d.bottom>0&&(e=b.min(g.height,d.bottom)),d.left>=0?f=b.min(d.width,g.width-d.left):d.left<0&&d.right>0&&(f=b.min(g.width,d.right));var h=e*f/(d.height*d.width);return b.max(h,0)}function e(a){return c.isPageVisible()&&c.isFullyInViewport(a)&&c.isVisibleByStyling(a)}function f(a){return c.isPageVisible()&&c.isInViewport(a)&&c.isVisibleByStyling(a)}function g(a){return!f(a)}c.percentage=d,c.isFullyVisible=e,c.isVisible=f,c.isHidden=g}.call(this,this,this.Math,this.VisSenseUtils),function(a,b,c){"use strict";var d=function(a,d){function e(){for(var a=4,b=d.createElement("div");b.innerHTML="<!--[if gt IE "+a+"]><i></i><![endif]-->",b.getElementsByTagName("i")[0];)a++;return a>4?a:c}function f(){try{return 11===d.createDocumentFragment().nodeType}catch(a){}return!1}function g(){try{return!!b._findEffectiveStyle(d.getElementsByTagName("body")[0])}catch(a){}return!1}var h={};return h.MinIEVersion=7,h.PageVisibilityAPIAvailable=b.isPageVisibilityAPIAvailable(),h.IEVersion=e(),h.DOMPresent=f(),h.CanReadStyle=g(),h.BrowserSupported=h.IEVersion>=h.MinIEVersion,h.compatible=h.DOMPresent&&h.CanReadStyle&&h.BrowserSupported,h}(a,a.document);b.support=function(){return d}}.call(this,this,this.VisSenseUtils),function(a,b,c){"use strict";function d(a,b){if(!(this instanceof d))return new d(a,b);if(!a||1!==a.nodeType)throw new Error("InvalidArgument: not an element node");this._element=a,this._config=b||{}}d.prototype.percentage=function(){return c.percentage(this._element)},d.prototype.isFullyVisible=function(){return c.isFullyVisible(this._element)},d.prototype.isVisible=function(){return c.isVisible(this._element)},d.prototype.isHidden=function(){return c.isHidden(this._element)},d.prototype.fireIfFullyVisible=function(a){var b=this;return c.fireIf(function(){return b.isFullyVisible()},a)},d.prototype.fireIfVisible=function(a){var b=this;return c.fireIf(function(){return b.isVisible()},a)},d.prototype.fireIfHidden=function(a){var b=this;return c.fireIf(function(){return b.isHidden()},a)},d.prototype.getFullyVisibleThreshold=c.noop,d.fn=d.prototype,a.VisSense=d}.call(this,this,this.Math,this.VisSenseUtils);