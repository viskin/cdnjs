Storage.prototype.setObject=function(c,e){this.setItem(c,JSON.stringify(e))};Storage.prototype.getObject=function(c){return(c=this.getItem(c))&&JSON.parse(c)};(function(c){var e=1;c.generateId=function(c){var b;do b=e++ +(c?"-"+c:"");while(document.getElementById(b));return b}})(jQuery);
(function(c){c.getScrollbarWidth=function(){var c=document.createElement("p");c.style.width="100%";c.style.height="200px";var d=document.createElement("div");d.style.position="absolute";d.style.top="0px";d.style.left="0px";d.style.visibility="hidden";d.style.width="200px";d.style.height="150px";d.style.overflow="hidden";d.appendChild(c);document.body.appendChild(d);var b=c.offsetWidth;d.style.overflow="scroll";c=c.offsetWidth;b==c&&(c=d.clientWidth);document.body.removeChild(d);return b-c}})(jQuery);
(function(c){c.getHashParam=function(c){var d=window.location.hash;if(""!==d){var b=0<d.indexOf("&"+c+"=")?d.indexOf("&"+c+"="):d.indexOf("#"+c+"=");if(0<=b)return b+=c.length+2,c=d.indexOf("&",b),c>b?d.substring(b,c):0>c?d.substring(b):""}return!1}})(jQuery);
(function(c){c.updateHashParam=function(e,d){var b=c.getHashParam(e),a=window.location.hash;if(b!==d)if("string"==typeof b){var g=0<a.indexOf("&"+e+"=")?a.indexOf("&"+e+"="):a.indexOf("#"+e+"="),b=g+e.length+2+b.length,f=0==g?"#":"&";window.location.replace(a.substring(0,g)+f+e+"="+d+a.substring(b))}else 0===a.length?window.location.replace("#"+e+"="+d):window.location.replace(a+"&"+e+"="+d)}})(jQuery);
jQuery.fn.oneFingerScroll=function(){var c,e;$(this).bind("touchstart",function(d){d=d.originalEvent;c=$(this).scrollTop()+d.touches[0].pageY;e=$(this).scrollLeft()+d.touches[0].pageX;d.preventDefault()});$(this).bind("touchmove",function(d){d=d.originalEvent;$(this).scrollTop(c-d.touches[0].pageY);$(this).scrollLeft(e-d.touches[0].pageX);d.preventDefault()});return this};
(function(c){c.fn.dragscrollable=function(e){var d=c.extend({dragSelector:">:first",acceptPropagatedEvent:!0,preventDefault:!0},e||{}),b={mouseDownHandler:function(a){if(1!=a.which||!a.data.acceptPropagatedEvent&&a.target!=this)return!1;a.data.lastCoord={left:a.clientX,top:a.clientY};c.event.add(document,"mouseup",b.mouseUpHandler,a.data);c.event.add(document,"mousemove",b.mouseMoveHandler,a.data);if(a.data.preventDefault)return a.preventDefault(),!1},mouseMoveHandler:function(a){var c=a.clientX-
a.data.lastCoord.left,b=a.clientY-a.data.lastCoord.top;a.data.scrollable.scrollLeft(a.data.scrollable.scrollLeft()-c);a.data.scrollable.scrollTop(a.data.scrollable.scrollTop()-b);a.data.lastCoord={left:a.clientX,top:a.clientY};if(a.data.preventDefault)return a.preventDefault(),!1},mouseUpHandler:function(a){c.event.remove(document,"mousemove",b.mouseMoveHandler);c.event.remove(document,"mouseup",b.mouseUpHandler);if(a.data.preventDefault)return a.preventDefault(),!1}};this.each(function(){var a={scrollable:c(this),
acceptPropagatedEvent:d.acceptPropagatedEvent,preventDefault:d.preventDefault};c(this).find(d.dragSelector).bind("mousedown",a,b.mouseDownHandler)})}})(jQuery);
(function(c,e){function d(a){return!c(a).parents().andSelf().filter(function(){return"hidden"===c.curCSS(this,"visibility")||c.expr.filters.hidden(this)}).length}function b(a,b){var f=a.nodeName.toLowerCase();if("area"===f){var f=a.parentNode,h=f.name;if(!a.href||!h||"map"!==f.nodeName.toLowerCase())return!1;f=c("img[usemap=#"+h+"]")[0];return!!f&&d(f)}return(/input|select|textarea|button|object/.test(f)?!a.disabled:"a"==f?a.href||b:b)&&d(a)}c.ui=c.ui||{};c.ui.version||(c.extend(c.ui,{version:"1.8.17",
keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),c.fn.extend({propAttr:c.fn.prop||c.fn.attr,_focus:c.fn.focus,focus:function(a,b){return"number"==typeof a?this.each(function(){var d=
this;setTimeout(function(){c(d).focus();b&&b.call(d)},a)}):this._focus.apply(this,arguments)},scrollParent:function(){var a;c.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?a=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(c.curCSS(this,"position",1))&&/(auto|scroll)/.test(c.curCSS(this,"overflow",1)+c.curCSS(this,"overflow-y",1)+c.curCSS(this,"overflow-x",1))}).eq(0):a=this.parents().filter(function(){return/(auto|scroll)/.test(c.curCSS(this,
"overflow",1)+c.curCSS(this,"overflow-y",1)+c.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!a.length?c(document):a},zIndex:function(a){if(a!==e)return this.css("zIndex",a);if(this.length){a=c(this[0]);for(var b;a.length&&a[0]!==document;){b=a.css("position");if("absolute"===b||"relative"===b||"fixed"===b)if(b=parseInt(a.css("zIndex"),10),!isNaN(b)&&0!==b)return b;a=a.parent()}}return 0},disableSelection:function(){return this.bind((c.support.selectstart?"selectstart":
"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),c.each(["Width","Height"],function(a,b){function d(a,b,g,f){c.each(h,function(){b-=parseFloat(c.curCSS(a,"padding"+this,!0))||0;g&&(b-=parseFloat(c.curCSS(a,"border"+this+"Width",!0))||0);f&&(b-=parseFloat(c.curCSS(a,"margin"+this,!0))||0)});return b}var h="Width"===b?["Left","Right"]:["Top","Bottom"],l=b.toLowerCase(),u={innerWidth:c.fn.innerWidth,innerHeight:c.fn.innerHeight,
outerWidth:c.fn.outerWidth,outerHeight:c.fn.outerHeight};c.fn["inner"+b]=function(a){return a===e?u["inner"+b].call(this):this.each(function(){c(this).css(l,d(this,a)+"px")})};c.fn["outer"+b]=function(a,h){return"number"!=typeof a?u["outer"+b].call(this,a):this.each(function(){c(this).css(l,d(this,a,!0,h)+"px")})}}),c.extend(c.expr[":"],{data:function(a,b,d){return!!c.data(a,d[3])},focusable:function(a){return b(a,!isNaN(c.attr(a,"tabindex")))},tabbable:function(a){var d=c.attr(a,"tabindex"),f=isNaN(d);
return(f||0<=d)&&b(a,!f)}}),c(function(){var a=document.body,b=a.appendChild(b=document.createElement("div"));c.extend(b.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});c.support.minHeight=100===b.offsetHeight;c.support.selectstart="onselectstart"in b;a.removeChild(b).style.display="none"}),c.extend(c.ui,{plugin:{add:function(a,b,d){a=c.ui[a].prototype;for(var h in d)a.plugins[h]=a.plugins[h]||[],a.plugins[h].push([b,d[h]])},call:function(a,c,b){if((c=a.plugins[c])&&a.element[0].parentNode)for(var d=
0;d<c.length;d++)a.options[c[d][0]]&&c[d][1].apply(a.element,b)}},contains:function(a,c){return document.compareDocumentPosition?a.compareDocumentPosition(c)&16:a!==c&&a.contains(c)},hasScroll:function(a,b){if("hidden"===c(a).css("overflow"))return!1;var d=b&&"left"===b?"scrollLeft":"scrollTop",h=!1;if(0<a[d])return!0;a[d]=1;h=0<a[d];a[d]=0;return h},isOverAxis:function(a,c,b){return a>c&&a<c+b},isOver:function(a,b,d,h,e,u){return c.ui.isOverAxis(a,d,e)&&c.ui.isOverAxis(b,h,u)}}))})(jQuery);
(function(c,e){if(c.cleanData){var d=c.cleanData;c.cleanData=function(a){for(var b=0,f;null!=(f=a[b]);b++)try{c(f).triggerHandler("remove")}catch(h){}d(a)}}else{var b=c.fn.remove;c.fn.remove=function(a,d){return this.each(function(){d||(!a||c.filter(a,[this]).length)&&c("*",this).add([this]).each(function(){try{c(this).triggerHandler("remove")}catch(a){}});return b.call(c(this),a,d)})}}c.widget=function(a,b,d){var h=a.split(".")[0],e;a=a.split(".")[1];e=h+"-"+a;d||(d=b,b=c.Widget);c.expr[":"][e]=
function(b){return!!c.data(b,a)};c[h]=c[h]||{};c[h][a]=function(a,c){arguments.length&&this._createWidget(a,c)};b=new b;b.options=c.extend(!0,{},b.options);c[h][a].prototype=c.extend(!0,b,{namespace:h,widgetName:a,widgetEventPrefix:c[h][a].prototype.widgetEventPrefix||a,widgetBaseClass:e},d);c.widget.bridge(a,c[h][a])};c.widget.bridge=function(a,b){c.fn[a]=function(d){var h="string"==typeof d,l=Array.prototype.slice.call(arguments,1),u=this;d=!h&&l.length?c.extend.apply(null,[!0,d].concat(l)):d;if(h&&
"_"===d.charAt(0))return u;h?this.each(function(){var b=c.data(this,a),g=b&&c.isFunction(b[d])?b[d].apply(b,l):b;if(g!==b&&g!==e)return u=g,!1}):this.each(function(){var k=c.data(this,a);k?k.option(d||{})._init():c.data(this,a,new b(d,this))});return u}};c.Widget=function(a,c){arguments.length&&this._createWidget(a,c)};c.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:!1},_createWidget:function(a,b){c.data(b,this.widgetName,this);this.element=c(b);this.options=c.extend(!0,
{},this.options,this._getCreateOptions(),a);var d=this;this.element.bind("remove."+this.widgetName,function(){d.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return c.metadata&&c.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+
"-disabled ui-state-disabled")},widget:function(){return this.element},option:function(a,b){var d=a;if(0===arguments.length)return c.extend({},this.options);if("string"==typeof a){if(b===e)return this.options[a];d={};d[a]=b}this._setOptions(d);return this},_setOptions:function(a){var b=this;c.each(a,function(a,c){b._setOption(a,c)});return this},_setOption:function(a,c){this.options[a]=c;"disabled"===a&&this.widget()[c?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",
c);return this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_trigger:function(a,b,d){var e,l=this.options[a];d=d||{};b=c.Event(b);b.type=(a===this.widgetEventPrefix?a:this.widgetEventPrefix+a).toLowerCase();b.target=this.element[0];if(a=b.originalEvent)for(e in a)e in b||(b[e]=a[e]);this.element.trigger(b,d);return!(c.isFunction(l)&&!1===l.call(this.element[0],b,d)||b.isDefaultPrevented())}}})(jQuery);
(function(c,e){var d=!1;c(document).mouseup(function(c){d=!1});c.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(a){if(!0===c.data(a.target,b.widgetName+".preventClickEvent"))return c.removeData(a.target,b.widgetName+".preventClickEvent"),a.stopImmediatePropagation(),!1});this.started=!1},_mouseDestroy:function(){this.element.unbind("."+
this.widgetName)},_mouseDown:function(b){if(!d){this._mouseStarted&&this._mouseUp(b);this._mouseDownEvent=b;var a=this,g=1==b.which,f="string"==typeof this.options.cancel&&b.target.nodeName?c(b.target).closest(this.options.cancel).length:!1;if(!g||f||!this._mouseCapture(b))return!0;(this.mouseDelayMet=!this.options.delay)||(this._mouseDelayTimer=setTimeout(function(){a.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=!1!==this._mouseStart(b),
!this._mouseStarted))return b.preventDefault(),!0;!0===c.data(b.target,this.widgetName+".preventClickEvent")&&c.removeData(b.target,this.widgetName+".preventClickEvent");this._mouseMoveDelegate=function(c){return a._mouseMove(c)};this._mouseUpDelegate=function(c){return a._mouseUp(c)};c(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);b.preventDefault();return d=!0}},_mouseMove:function(b){if(c.browser.msie&&!(9<=document.documentMode)&&
!b.button)return this._mouseUp(b);if(this._mouseStarted)return this._mouseDrag(b),b.preventDefault();this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,b),this._mouseStarted?this._mouseDrag(b):this._mouseUp(b));return!this._mouseStarted},_mouseUp:function(b){c(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);this._mouseStarted&&(this._mouseStarted=!1,b.target==
this._mouseDownEvent.target&&c.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b));return!1},_mouseDistanceMet:function(c){return Math.max(Math.abs(this._mouseDownEvent.pageX-c.pageX),Math.abs(this._mouseDownEvent.pageY-c.pageY))>=this.options.distance},_mouseDelayMet:function(c){return this.mouseDelayMet},_mouseStart:function(c){},_mouseDrag:function(c){},_mouseStop:function(c){},_mouseCapture:function(c){return!0}})})(jQuery);
(function(c,e){c.widget("ui.slider",c.ui.mouse,{widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var d=this,b=this.options,a=this.element.find(".handle").addClass("ui-state-default ui-corner-all"),g=b.values&&b.values.length||1,f=[];this._mouseSliding=this._keySliding=!1;this._animateOff=!0;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+
this.orientation+" ui-widget ui-widget-content ui-corner-all"+(b.disabled?" ui-slider-disabled ui-disabled":""));this.range=c([]);b.range&&(!0===b.range&&(b.values||(b.values=[this._valueMin(),this._valueMin()]),b.values.length&&2!==b.values.length&&(b.values=[b.values[0],b.values[0]])),this.range=c("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+("min"===b.range||"max"===b.range?" ui-slider-range-"+b.range:"")));for(var e=a.length;e<g;e+=1)f.push("<a class='handle ui-state-default ui-corner-all' href='#'></a>");
this.handles=a.add(c(f.join("")).appendTo(d.element));this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(a){a.preventDefault()}).hover(function(){b.disabled||c(this).addClass("hover")},function(){c(this).removeClass("hover")}).focus(function(){b.disabled?c(this).blur():(c(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),c(this).addClass("ui-state-focus"))}).blur(function(){c(this).removeClass("ui-state-focus")});this.handles.each(function(a){c(this).data("index.handle",
a)});this.handles.keydown(function(a){var b=!0,k=c(this).data("index.handle"),g,f,e;if(!d.options.disabled){switch(a.keyCode){case c.ui.keyCode.HOME:case c.ui.keyCode.END:case c.ui.keyCode.PAGE_UP:case c.ui.keyCode.PAGE_DOWN:case c.ui.keyCode.UP:case c.ui.keyCode.RIGHT:case c.ui.keyCode.DOWN:case c.ui.keyCode.LEFT:if(b=!1,!d._keySliding&&(d._keySliding=!0,c(this).addClass("active"),g=d._start(a,k),!1===g))return}g=d.options.step;d.options.values&&d.options.values.length?f=e=d.values(k):f=e=d.value();
switch(a.keyCode){case c.ui.keyCode.HOME:e=d._valueMin();break;case c.ui.keyCode.END:e=d._valueMax();break;case c.ui.keyCode.PAGE_UP:e=d._trimAlignValue(f+(d._valueMax()-d._valueMin())/5);break;case c.ui.keyCode.PAGE_DOWN:e=d._trimAlignValue(f-(d._valueMax()-d._valueMin())/5);break;case c.ui.keyCode.UP:case c.ui.keyCode.RIGHT:if(f===d._valueMax())return;e=d._trimAlignValue(f+g);break;case c.ui.keyCode.DOWN:case c.ui.keyCode.LEFT:if(f===d._valueMin())return;e=d._trimAlignValue(f-g)}d._slide(a,k,e);
return b}}).keyup(function(a){var b=c(this).data("index.handle");d._keySliding&&(d._keySliding=!1,d._stop(a,b),d._change(a,b),c(this).removeClass("active"))});this._refreshValue();this._animateOff=!1},destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider");this._mouseDestroy();return this},_mouseCapture:function(d){var b=
this.options,a,g,f,e,l;if(b.disabled)return!1;this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();a=this._normValueFromMouse({x:d.pageX,y:d.pageY});g=this._valueMax()-this._valueMin()+1;e=this;this.handles.each(function(b){var d=Math.abs(a-e.values(b));g>d&&(g=d,f=c(this),l=b)});!0===b.range&&this.values(1)===b.min&&(l+=1,f=c(this.handles[l]));if(!1===this._start(d,l))return!1;this._mouseSliding=!0;e._handleIndex=l;f.addClass("active").focus();
b=f.offset();this._clickOffset=c(d.target).parents().andSelf().is(".handle")?{left:d.pageX-b.left-f.width()/2,top:d.pageY-b.top-f.height()/2-(parseInt(f.css("borderTopWidth"),10)||0)-(parseInt(f.css("borderBottomWidth"),10)||0)+(parseInt(f.css("marginTop"),10)||0)}:{left:0,top:0};this.handles.hasClass("hover")||this._slide(d,l,a);return this._animateOff=!0},_mouseStart:function(c){return!0},_mouseDrag:function(c){var b=this._normValueFromMouse({x:c.pageX,y:c.pageY});this._slide(c,this._handleIndex,
b);return!1},_mouseStop:function(c){this.handles.removeClass("active");this._mouseSliding=!1;this._stop(c,this._handleIndex);this._change(c,this._handleIndex);this._clickOffset=this._handleIndex=null;return this._animateOff=!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(c){var b,a;"horizontal"===this.orientation?(b=this.elementSize.width,a=c.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:
0)):(b=this.elementSize.height,a=c.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0));c=a/b;1<c&&(c=1);0>c&&(c=0);"vertical"===this.orientation&&(c=1-c);b=this._valueMax()-this._valueMin();c=this._valueMin()+c*b;return this._trimAlignValue(c)},_start:function(c,b){var a={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(a.value=this.values(b),a.values=this.values());return this._trigger("start",c,a)},_slide:function(c,b,a){var g,e,h;this.options.values&&
this.options.values.length?(g=this.values(b?0:1),2===this.options.values.length&&!0===this.options.range&&(0===b&&a>g||1===b&&a<g)&&(a=g),a!==this.values(b)&&(e=this.values(),e[b]=a,h=this._trigger("slide",c,{handle:this.handles[b],value:a,values:e}),this.values(b?0:1),!1!==h&&this.values(b,a,!0))):a!==this.value()&&(h=this._trigger("slide",c,{handle:this.handles[b],value:a}),!1!==h&&this.value(a))},_stop:function(c,b){var a={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&
(a.value=this.values(b),a.values=this.values());this._trigger("stop",c,a)},_change:function(c,b){if(!this._keySliding&&!this._mouseSliding){var a={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(a.value=this.values(b),a.values=this.values());this._trigger("change",c,a)}},value:function(c){if(arguments.length)this.options.value=this._trimAlignValue(c),this._refreshValue(),this._change(null,0);else return this._value()},values:function(d,b){var a,e,f;if(1<
arguments.length)this.options.values[d]=this._trimAlignValue(b),this._refreshValue(),this._change(null,d);else{if(!arguments.length)return this._values();if(!c.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(d):this.value();a=this.options.values;e=arguments[0];for(f=0;f<a.length;f+=1)a[f]=this._trimAlignValue(e[f]),this._change(null,f);this._refreshValue()}},_setOption:function(d,b){var a,e=0;c.isArray(this.options.values)&&(e=this.options.values.length);
c.Widget.prototype._setOption.apply(this,arguments);switch(d){case "disabled":b?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("hover"),this.handles.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(this.handles.propAttr("disabled",!1),this.element.removeClass("ui-disabled"));break;case "orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();break;
case "value":this._animateOff=!0;this._refreshValue();this._change(null,0);this._animateOff=!1;break;case "values":this._animateOff=!0;this._refreshValue();for(a=0;a<e;a+=1)this._change(null,a);this._animateOff=!1}},_value:function(){var c=this.options.value;return c=this._trimAlignValue(c)},_values:function(c){var b,a;if(arguments.length)return b=this.options.values[c],b=this._trimAlignValue(b);b=this.options.values.slice();for(a=0;a<b.length;a+=1)b[a]=this._trimAlignValue(b[a]);return b},_trimAlignValue:function(c){if(c<=
this._valueMin())return this._valueMin();if(c>=this._valueMax())return this._valueMax();var b=0<this.options.step?this.options.step:1,a=(c-this._valueMin())%b;c-=a;2*Math.abs(a)>=b&&(c+=0<a?b:-b);return parseFloat(c.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var d=this.options.range,b=this.options,a=this,e=this._animateOff?!1:b.animate,f,h={},l,u,k,v;this.options.values&&this.options.values.length?this.handles.each(function(d,
k){f=100*((a.values(d)-a._valueMin())/(a._valueMax()-a._valueMin()));h["horizontal"===a.orientation?"left":"bottom"]=f+"%";c(this).stop(1,1)[e?"animate":"css"](h,b.animate);!0===a.options.range&&("horizontal"===a.orientation?(0===d&&a.range.stop(1,1)[e?"animate":"css"]({left:f+"%"},b.animate),1===d&&a.range[e?"animate":"css"]({width:f-l+"%"},{queue:!1,duration:b.animate})):(0===d&&a.range.stop(1,1)[e?"animate":"css"]({bottom:f+"%"},b.animate),1===d&&a.range[e?"animate":"css"]({height:f-l+"%"},{queue:!1,
duration:b.animate})));l=f}):(u=this.value(),k=this._valueMin(),v=this._valueMax(),f=v!==k?100*((u-k)/(v-k)):0,h["horizontal"===a.orientation?"left":"bottom"]=f+"%",this.handle.stop(1,1)[e?"animate":"css"](h,b.animate),"min"===d&&"horizontal"===this.orientation&&this.range.stop(1,1)[e?"animate":"css"]({width:f+"%"},b.animate),"max"===d&&"horizontal"===this.orientation&&this.range[e?"animate":"css"]({width:100-f+"%"},{queue:!1,duration:b.animate}),"min"===d&&"vertical"===this.orientation&&this.range.stop(1,
1)[e?"animate":"css"]({height:f+"%"},b.animate),"max"===d&&"vertical"===this.orientation&&this.range[e?"animate":"css"]({height:100-f+"%"},{queue:!1,duration:b.animate}))}});c.extend(c.ui.slider,{version:"1.8.17"})})(jQuery);
(function(c){var e={decelerate:!0,triggerHardware:!1,y:!0,x:!0,slowdown:0.9,maxvelocity:40,throttleFPS:60,movingClass:{up:"kinetic-moving-up",down:"kinetic-moving-down",left:"kinetic-moving-left",right:"kinetic-moving-right"},deceleratingClass:{up:"kinetic-decelerating-up",down:"kinetic-decelerating-down",left:"kinetic-decelerating-left",right:"kinetic-decelerating-right"}};window.requestAnimationFrame||(window.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||
window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a,c){window.setTimeout(a,1E3/60)}}());c.support=c.support||{};c.extend(c.support,{touch:"ontouchend"in document});var d=function(){return!1},b=function(a,c){var b=a;0<a?a>c&&(b=c):a<0-c&&(b=0-c);return b},a=function(a,c){this.removeClass(a.movingClass.up).removeClass(a.movingClass.down).removeClass(a.movingClass.left).removeClass(a.movingClass.right).removeClass(a.deceleratingClass.up).removeClass(a.deceleratingClass.down).removeClass(a.deceleratingClass.left).removeClass(a.deceleratingClass.right);
0<a.velocity&&this.addClass(c.right);0>a.velocity&&this.addClass(c.left);0<a.velocityY&&this.addClass(c.down);0>a.velocityY&&this.addClass(c.up)},g=function(c,b){var d=c[0];b.x&&0<d.scrollWidth?(d.scrollLeft=b.scrollLeft=d.scrollLeft+b.velocity,0<Math.abs(b.velocity)&&(b.velocity=b.decelerate?0===Math.floor(Math.abs(b.velocity))?0:b.velocity*b.slowdown:b.velocity)):b.velocity=0;b.y&&0<d.scrollHeight?(d.scrollTop=b.scrollTop=d.scrollTop+b.velocityY,0<Math.abs(b.velocityY)&&(b.velocityY=b.decelerate?
0===Math.floor(Math.abs(b.velocityY))?0:b.velocityY*b.slowdown:b.velocityY)):b.velocityY=0;a.call(c,b,b.deceleratingClass);"function"===typeof b.moved&&b.moved.call(c,b);0<Math.abs(b.velocity)||0<Math.abs(b.velocityY)?window.requestAnimationFrame(function(){g(c,b)}):"function"===typeof b.stopped&&b.stopped.call(c,b)},f=function(a,b){var d=c.kinetic.callMethods[a],e=Array.prototype.slice.call(arguments);d&&this.each(function(){var a=e.slice(1),b=c(this).data("kinetic-settings");a.unshift(b);d.apply(this,
a)})},h=function(a,b){var e=a[0];c.support.touch?(e.addEventListener("touchstart",b.events.touchStart,!1),e.addEventListener("touchend",b.events.inputEnd,!1),e.addEventListener("touchmove",b.events.touchMove,!1)):a.mousedown(b.events.inputDown).mouseup(b.events.inputEnd).mousemove(b.events.inputMove);a.click(b.events.inputClick).bind("selectstart",d);a.bind("dragstart",b.events.dragStart)},l=function(d){this.addClass("kinetic-active").each(function(){var f=c.extend({},e,d),l=this,m=c(this),q,s=!1,
n,r=!1,t=!1,F=1E3/f.throttleFPS,x,w;f.velocity=0;f.velocityY=0;var J=function(){t=n=q=!1};c(document).mouseup(J).click(J);var H=function(){f.velocity=b(s-q,f.maxvelocity);f.velocityY=b(r-n,f.maxvelocity)},p=function(b,d){if(!x||new Date>new Date(x.getTime()+F))x=new Date,t&&(q||n)&&(w&&(c(w).blur(),w=null,m.focus()),f.decelerate=!1,f.velocity=f.velocityY=0,m[0].scrollLeft=f.scrollLeft=f.x?m[0].scrollLeft-(b-q):m[0].scrollLeft,m[0].scrollTop=f.scrollTop=f.y?m[0].scrollTop-(d-n):m[0].scrollTop,s=q,
r=n,q=b,n=d,H(),a.call(m,f,f.movingClass),"function"===typeof f.moved&&f.moved.call(m,f))};f.events={touchStart:function(a){if(c.isFunction(f.filterTarget)?!1!==f.filterTarget.call(l,a.target):1){var b=a.touches[0].clientX,d=a.touches[0].clientY;t=!0;f.velocity=s=0;f.velocityY=r=0;q=b;n=d;a.stopPropagation()}},touchMove:function(a){t&&(p(a.touches[0].clientX,a.touches[0].clientY),a.preventDefault&&a.preventDefault())},inputDown:function(a){if(c.isFunction(f.filterTarget)?!1!==f.filterTarget.call(l,
a.target):1){var b=a.clientX,d=a.clientY;t=!0;f.velocity=s=0;f.velocityY=r=0;q=b;n=d;w=a.target;"IMG"===a.target.nodeName&&a.preventDefault();a.stopPropagation()}},inputEnd:function(a){q&&(s&&!1===f.decelerate)&&(f.decelerate=!0,H(),q=s=t=!1,g(m,f));w=null;a.preventDefault&&a.preventDefault()},inputMove:function(a){t&&(p(a.clientX,a.clientY),a.preventDefault&&a.preventDefault())},inputClick:function(a){if(0<Math.abs(f.velocity))return a.preventDefault(),!1},dragStart:function(a){if(w)return!1}};h(m,
f);m.data("kinetic-settings",f).css("cursor","move");f.triggerHardware&&m.css("-webkit-transform","translate3d(0,0,0)")})};c.kinetic={settingsKey:"kinetic-settings",callMethods:{start:function(a,b){var d=c(this);if(a=c.extend(a,b))a.decelerate=!1,g(d,a)},end:function(a,b){c(this);a&&(a.decelerate=!0)},stop:function(a,c){a.velocity=0;a.velocityY=0;a.decelerate=!0},detach:function(a,b){var f=c(this),e=f[0];c.support.touch?(e.removeEventListener("touchstart",a.events.touchStart,!1),e.removeEventListener("touchend",
a.events.inputEnd,!1),e.removeEventListener("touchmove",a.events.touchMove,!1)):f.unbind("mousedown",a.events.inputDown).unbind("mouseup",a.events.inputEnd).unbind("mousemove",a.events.inputMove);f.unbind("click",a.events.inputClick).unbind("selectstart",d);f.unbind("dragstart",a.events.dragStart);f.removeClass("kinetic-active").css("cursor","")},attach:function(a,b){var d=c(this);h(d,a);d.addClass("kinetic-active").css("cursor","move")}}};c.fn.kinetic=function(a){"string"===typeof a?f.apply(this,
arguments):l.call(this,a);return this}})(window.jQuery||window.Zepto);window.divaPlugins=[];
(function(c){var e=function(d,b){var a=c.extend({},{adaptivePadding:0.05,blockMobileMove:!0,contained:!1,divaserveURL:"",enableAutoHeight:!1,enableAutoTitle:!0,enableAutoWidth:!0,enableCanvas:!0,enableDownload:!0,enableFilename:!0,enableFullscreen:!0,enableGotoPage:!0,enableGridIcon:!0,enableGridSlider:!0,enableKeyScroll:!0,enableLinkIcon:!0,enableSpaceScroll:!1,enableZoomSlider:!0,fixedPadding:10,fixedHeightGrid:!0,goDirectlyTo:0,iipServerURL:"",inFullscreen:!1,inGrid:!1,imageDir:"",imageRoot:"",
maxPagesPerRow:8,maxZoomLevel:-1,minPagesPerRow:2,minZoomLevel:0,onModeToggle:null,onViewToggle:null,onJump:null,onPageLoad:null,onReady:null,onScroll:null,onScrollDown:null,onScrollUp:null,onZoom:null,onZoomIn:null,onZoomOut:null,pageLoadTimeout:200,pagesPerRow:5,rowLoadTimeout:50,throbberTimeout:100,tileFadeSpeed:0,tileHeight:256,tileWidth:256,toolbarParentSelector:null,viewerHeightPadding:15,viewerWidthPadding:30,viewportMargin:200,zoomLevel:2},b);c.extend(a,{allTilesLoaded:[],averageHeights:[],
averageWidths:[],currentPageIndex:0,dimAfterZoom:0,firstPageLoaded:-1,firstRowLoaded:-1,gridPageWidth:0,hashParamSuffix:"",heightAbovePages:[],horizontalOffset:0,horizontalPadding:0,ID:null,innerSelector:"",itemTitle:"",lastPageLoaded:-1,lastRowLoaded:-1,leftScrollSoFar:0,maxWidths:[],maxRatio:0,minHeight:0,minRatio:0,minWidth:0,mobileWebkit:!1,numPages:0,numRows:0,oldPagesPerRow:0,oldZoomLevel:-1,orientationChange:!1,originalHeight:0,originalWidth:0,outerSelector:"",pages:[],pageLeftOffsets:[],pageTimeouts:[],
pageTools:"",panelHeight:0,panelWidth:0,plugins:[],previousTopScroll:0,preZoomOffset:null,realMaxZoom:-1,resizeTimer:-1,rowHeight:0,scaleWait:!1,selector:"",singleClick:!1,scrollbarWidth:0,throbberTimeoutID:-1,toolbar:null,topScrollSoFar:0,totalHeights:[],totalHeight:0,verticalOffset:0,verticalPadding:0,viewerXOffset:0,viewerYOffset:0});var e=this,f=function(a){var c,b,d;if("function"===typeof a){c=[];b=1;for(d=arguments.length;b<d;b++)c.push(arguments[b]);a.apply(e,c);return!0}return!1},h=function(c,
b){return a.pages[c].d[a.zoomLevel][b]},l=function(c){var b;for(b=0;b<a.numPages;b++)if(a.pages[b].f===c)return b;return-1},u=function(c,b){var d=a.topScrollSoFar-a.viewportMargin,f=d+a.panelHeight+2*a.viewportMargin;return c>=d&&c<=f||c<=d&&b>=f||b>=d&&b<=f},k=function(c){return 0<=c&&c<a.numPages},v=function(c){var b=a.heightAbovePages[c];c=b+h(c,"h")+a.verticalPadding;return u(b,c)},m=function(b){if(!(0<c(a.selector+"page-"+b).length&&a.allTilesLoaded[b])){var d=a.pages[b].f,e=h(b,"w"),g=h(b,"h"),
p=a.heightAbovePages[b]+a.verticalPadding,z=a.selector+"page-"+b,y;if(!(0<c(a.selector+"page-"+b).length))for(y in c(a.innerSelector).append('<div id="'+a.ID+"page-"+b+'" style="top: '+p+"px; width: "+e+"px; height: "+g+'px;" class="diva-document-page" title="Page '+(b+1)+'" data-index="'+b+'" data-filename="'+d+'">'+a.pageTools+"</div>"),f(a.onPageLoad,b,d,z),a.plugins)f(a.plugins[y].onPageLoad,b,d,z);a.pageTimeouts.push(setTimeout(function(){if(v(b)){var f=a.imageRoot+"/"+a.imageDir+"/",p=h(b,"r"),
y=h(b,"c"),z=a.pages[b].m,M=a.iipServerURL+"?FIF="+f+d+"&amp;JTL=",f=[],B=[],C=!0,l=0,D=g-(p-1)*a.tileHeight,k=e-(y-1)*a.tileWidth,A,N,m,K,I,s,t,q;for(A=0;A<p;A++)for(N=0;N<y;N++){I=A*a.tileHeight;s=N*a.tileWidth;t=a.tileFadeSpeed?"none":"inline";q=a.zoomLevel+z-a.realMaxZoom;m=A===p-1?D:a.tileHeight;K=N===y-1?k:a.tileWidth;q=M+q+","+l;if(!(0<c(a.selector+"tile-"+b+"-"+l).length)){var n=a.heightAbovePages[b]+A*a.tileHeight+a.verticalPadding,r=a.pageLeftOffsets[b]+N*a.tileWidth,O=r+a.tileWidth;if(n=
u(n,n+a.tileHeight))var n=a.leftScrollSoFar-a.viewportMargin,w=n+a.panelWidth+2*a.viewportMargin,L=O>=n&&O<=w,O=r<=n&&O>=w,n=r>=n&&r<=w||O||L;n?(B.push('<div id="'+a.ID+"tile-"+b+"-"+l+'" style="'+t+"; position: absolute; top: "+I+"px; left: "+s+"px; background-image: url('"+q+"'); height: "+m+"px; width: "+K+'px;"></div>'),f.push(l)):C=!1}l++}a.allTilesLoaded[b]=C;if(f.length)for(c(a.selector+"page-"+b).append(B.join("")),p=0;p<f.length;p++)c(a.selector+"tile-"+b+"-"+f[p]).fadeIn(a.tileFadeSpeed)}},
a.pageLoadTimeout))}},q=function(b){c(a.selector+"page-"+b).empty().remove()},s=function(c,b){0<b?k(c)&&(v(c)?(m(c),a.lastPageLoaded=c,s(a.lastPageLoaded+1,b)):a.heightAbovePages[c]+h(c,"h")+a.verticalPadding<a.topScrollSoFar&&s(c+1,b)):k(c)&&(v(c)?(m(c),a.firstPageLoaded=c,s(a.firstPageLoaded-1,b)):a.heightAbovePages[c]>a.topScrollSoFar+a.panelHeight&&s(c-1,b))},n=function(c,b){0<b?k(c)&&a.heightAbovePages[c]+h(c,"h")+a.verticalPadding<a.topScrollSoFar&&(q(c),a.firstPageLoaded=c+1,n(a.firstPageLoaded,
b)):k(c)&&a.heightAbovePages[c]>a.topScrollSoFar+a.panelHeight&&(q(c),a.lastPageLoaded=c-1,n(a.lastPageLoaded,b))},r=function(c){return 0<=c&&c<a.numRows},t=function(c){c*=a.rowHeight;return u(c,c+a.rowHeight+a.fixedPadding)},F=function(b){if(!(0<c(a.selector+"row-"+b).length)){var d=[];d.push('<div class="diva-row" id="'+a.ID+"row-"+b+'" style="height: '+a.rowHeight+"; top: "+(a.rowHeight*b+a.fixedPadding)+'px;">');var f,e,g,p,y,z,M=a.imageRoot+"/"+a.imageDir+"/";for(f=0;f<a.pagesPerRow;f++){e=b*
a.pagesPerRow+f;if(!k(e))break;g=a.pages[e].f;p=h(e,"w");y=h(e,"h");z=a.fixedHeightGrid?(a.rowHeight-a.fixedPadding)*p/y:a.gridPageWidth;p=a.fixedHeightGrid?a.rowHeight-a.fixedPadding:z/p*y;y=parseInt(f*(a.fixedPadding+a.gridPageWidth)+a.fixedPadding,10);z=parseInt(z,10);p=parseInt(p,10);y+=a.fixedHeightGrid?(a.gridPageWidth-z)/2:0;g=a.iipServerURL+"?FIF="+M+g+"&amp;HEI="+(p+2)+"&amp;CVT=JPEG";d.push('<div id="'+a.ID+"page-"+e+'" class="diva-page" style="width: '+z+"px; height: "+p+"px; left: "+y+
'px;" title="Page '+(e+1)+'"></div>');J(b,e,g,z,p)}d.push("</div>");c(a.innerSelector).append(d.join(""))}},x=function(c,b){0<b?r(c)&&(t(c)?(F(c),a.lastRowLoaded=c,x(a.lastRowLoaded+1,b)):a.rowHeight*(c+1)<a.topScrollSoFar&&x(c+1,b)):r(c)&&(t(c)?(F(c),a.firstRowLoaded=c,x(a.firstRowLoaded-1,b)):a.rowHeight*c>a.topScrollSoFar+a.panelHeight&&x(c-1,b))},w=function(b,d){0<d?r(b)&&a.rowHeight*(b+1)<a.topScrollSoFar&&(c(a.selector+"row-"+b).empty().remove(),a.firstRowLoaded++,w(a.firstRowLoaded,d)):r(b)&&
a.rowHeight*b>a.topScrollSoFar+a.panelHeight&&(c(a.selector+"row-"+b).empty().remove(),a.lastRowLoaded--,w(a.lastRowLoaded,d))},J=function(b,d,f,e,g){a.pageTimeouts.push(setTimeout(function(){t(b)&&c(a.selector+"page-"+d).html('<img src="'+f+'" style="width: '+e+"px; height: "+g+'px;" />')},a.rowLoadTimeout))},H=function(c){var b=a.topScrollSoFar+a.panelHeight/2,d=a.currentPageIndex,f=a.currentPageIndex+c,e=!1;0>c?0<=f&&a.heightAbovePages[f]+h(f,"h")+a.verticalPadding>=b&&(e=!0):0<c&&a.heightAbovePages[d]+
h(d,"h")+a.verticalPadding<b&&(e=!0);return e?(a.currentPageIndex=f,0!==c&&(H(c)||a.toolbar.updateCurrentPage()),!0):!1},p=function(c){var b=Math.floor(a.currentPageIndex/a.pagesPerRow),d=b+parseInt(c,10),f=a.topScrollSoFar+a.panelHeight/2,e=!1;0>c?0<=d&&(a.rowHeight*b>=f||a.rowHeight*d>=a.topScrollSoFar)&&(e=!0):0<c&&a.rowHeight*(b+1)<a.topScrollSoFar&&r(d)&&(e=!0);return e?(a.currentPageIndex=d*a.pagesPerRow,0!==c&&(p(c)||a.toolbar.updateCurrentPage()),!0):!1},z=function(b,d,e){d=a.heightAbovePages[b]+
d;e=(a.maxWidths[a.zoomLevel]-a.panelWidth)/2+a.horizontalPadding+e;c(a.outerSelector).scrollTop(d);c(a.outerSelector).scrollLeft(e);a.currentPageIndex=b;a.toolbar.updateCurrentPage();f(a.onJump,b)},M=function(b){var d=Math.floor(b/a.pagesPerRow)*a.rowHeight;c(a.outerSelector).scrollTop(d);a.currentPageIndex=b;a.toolbar.updateCurrentPage()},C=function(){a.allTilesLoaded=[];c(a.outerSelector).scrollTop(0);a.topScrollSoFar=0;c(a.innerSelector).empty();a.firstPageLoaded=0;a.firstRowLoaded=-1;a.previousTopScroll=
0;for(clearTimeout(a.resizeTimer);a.pageTimeouts.length;)clearTimeout(a.pageTimeouts.pop())},D=function(){a.inGrid?I():A()},A=function(){C();a.zoomLevel=a.zoomLevel>=a.minZoomLevel&&a.zoomLevel<=a.maxZoomLevel?a.zoomLevel:a.minZoomLevel;var b=a.zoomLevel;0<a.adaptivePadding?(a.horizontalPadding=a.averageWidths[b]*a.adaptivePadding,a.verticalPadding=a.averageHeights[b]*a.adaptivePadding):(a.horizontalPadding=a.fixedPadding,a.verticalPadding=a.fixedPadding);a.pageTools.length&&(a.verticalPadding=Math.max(40,
a.horizontalPadding));a.totalHeight=a.totalHeights[b]+a.verticalPadding*(a.numPages+1);a.dimAfterZoom=a.totalHeight;var d=Math.max(a.maxWidths[b]+2*a.horizontalPadding,a.panelWidth),e=0,g;for(g=0;g<a.numPages;g++)a.heightAbovePages[g]=e,e=a.heightAbovePages[g]+h(g,"h")+a.verticalPadding,a.pageLeftOffsets[g]=(d-h(g,"w"))/2,v(g)&&(m(g),a.lastPageLoaded=g);0<=a.oldZoomLevel&&(a.oldZoomLevel<a.zoomLevel?f(a.onZoomIn,b):f(a.onZoomOut,b),f(a.onZoom,b));c(a.innerSelector).height(Math.round(a.totalHeight));
c(a.innerSelector).width(Math.round(d));a.preZoomOffset?(d=a.preZoomOffset.i,b=a.heightAbovePages[d]+a.verticalPadding,e=a.pageLeftOffsets[d],d=Math.pow(2,a.zoomLevel-a.oldZoomLevel),e=a.preZoomOffset.x*d-(a.preZoomOffset.originalX-a.viewerXOffset)+e,b=a.preZoomOffset.y*d-(a.preZoomOffset.originalY-a.viewerYOffset)+b,c(a.outerSelector).scrollTop(b).scrollLeft(e),a.preZoomOffset=void 0):(k(a.goDirectlyTo)||(a.goDirectlyTo=0),z(a.goDirectlyTo,a.verticalOffset,a.horizontalOffset),a.horizontalOffset=
0,a.verticalOffset=0);a.scaleWait&&(a.scaleWait=!1)},I=function(){C();a.pagesPerRow=a.pagesPerRow>=a.minPagesPerRow&&a.pagesPerRow<=a.maxPagesPerRow?a.pagesPerRow:a.maxPagesPerRow;var b=(a.panelWidth-a.fixedPadding*(a.pagesPerRow+1))/a.pagesPerRow;a.gridPageWidth=b;a.rowHeight=a.fixedHeightGrid?a.fixedPadding+a.minRatio*b:a.fixedPadding+a.maxRatio*b;a.numRows=Math.ceil(a.numPages/a.pagesPerRow);a.totalHeight=a.numRows*a.rowHeight+a.fixedPadding;c(a.innerSelector).height(Math.round(a.totalHeight));
c(a.innerSelector).width(Math.round(a.panelWidth));M(a.goDirectlyTo);for(var d,b=0;b<a.numPages;b+=a.pagesPerRow)d=Math.floor(b/a.pagesPerRow),t(d)&&(a.firstRowLoaded=0>a.firstRowLoaded?d:a.firstRowLoaded,F(d),a.lastRowLoaded=d)},Q=function(b){if(0<=a.oldZoomLevel&&!a.inGrid){var d=c(a.selector+"page-"+a.currentPageIndex).offset(),e=-(d.top-a.verticalPadding-a.viewerYOffset),g=(a.panelWidth-h(a.currentPageIndex,"w"))/2,d=-(d.left-a.viewerXOffset-g);a.verticalOffset=e;a.horizontalOffset=d}a.toolbar.switchMode();
c(a.selector+"fullscreen").toggleClass("diva-in-fullscreen");c(a.outerSelector).toggleClass("diva-fullscreen");c("body").toggleClass("diva-hide-scrollbar");c(a.parentSelector).toggleClass("diva-full-width");a.panelHeight=c(a.outerSelector).height();a.panelWidth=c(a.outerSelector).width()-a.scrollbarWidth;c(a.innerSelector).width(a.panelWidth);a.viewerXOffset=c(a.outerSelector).offset().left;a.viewerYOffset=c(a.outerSelector).offset().top;b?(a.inGrid=!a.inGrid,B()):D();f(a.onModeToggle,a.inFullscreen)},
B=function(){a.toolbar.switchView();D();f(a.onViewToggle,a.inGrid)},K=function(){a.goDirectlyTo=a.currentPageIndex;a.inFullscreen=!a.inFullscreen;Q(!1)},L=function(){a.goDirectlyTo=a.currentPageIndex;a.inGrid=!a.inGrid;B()},R=function(b){var d=c(this).offset();a.preZoomOffset={x:b.pageX-d.left,y:b.pageY-d.top,originalX:b.pageX,originalY:b.pageY,i:c(this).attr("data-index")};P(b.ctrlKey?a.zoomLevel-1:a.zoomLevel+1)},P=function(c){var b=c>=a.minZoomLevel&&c<=a.maxZoomLevel?c:a.minZoomLevel;if(b!==c)return!1;
a.oldZoomLevel=a.zoomLevel;a.zoomLevel=b;a.toolbar.updateZoomSlider();A();return!0},S=function(c){var b=c>=a.minPagesPerRow&&c<=a.maxPagesPerRow?c:a.maxPagesPerRow;if(b!==c)return!1;a.oldPagesPerRow=a.zoomLevel;a.pagesPerRow=b;a.toolbar.updateGridSlider();I()},T=function(){var b=a.inFullscreen,d=a.inGrid,e=a.zoomLevel,f=a.pagesPerRow,g=a.enableFilename?a.pages[a.currentPageIndex].f:!1,p=a.enableFilename?!1:a.currentPageIndex+1,y;a.inGrid?y=!1:(y=c(a.outerSelector).scrollTop(),y=parseInt(y-a.heightAbovePages[a.currentPageIndex],
10));var h;a.inGrid?h=!1:(h=(a.maxWidths[a.zoomLevel]+2*a.horizontalPadding-a.panelWidth)/2,h=parseInt(c(a.outerSelector).scrollLeft()-h,10));return{f:b,g:d,z:e,n:f,i:g,p:p,y:y,x:h,h:a.inFullscreen?!1:a.panelHeight,w:a.inFullscreen?!1:c(a.outerSelector).width()}},U=function(){var c=T(),b=[],d;for(d in c)!1!==c[d]&&b.push(d+a.hashParamSuffix+"="+c[d]);return b.join("&")},V=function(){return location.protocol+"//"+location.host+location.pathname+"#"+U()},W=function(){var b=c(a.outerSelector).offset().top;
a.panelHeight=window.innerHeight-b-a.viewerHeightPadding;a.panelWidth=window.innerWidth-a.viewerWidthPadding;c(a.parentSelector).width(a.panelWidth);a.enableAutoHeight&&c(a.outerSelector).height(a.panelHeight);a.enableAutoWidth&&c(a.outerSelector).width(a.panelWidth)},G=function(){var b=c(a.outerSelector).height(),d=c(a.parentSelector).width()-a.scrollbarWidth,e=c(a.outerSelector).offset().top,f=(window.innerWidth||document.documentElement.clientWidth)-a.viewerWidthPadding-a.scrollbarWidth-2,g=(window.innerHeight||
document.documentElement.clientHeight)-e-a.viewerHeightPadding-1;a.enableAutoHeight&&(b+e+16>window.innerHeight?b=g:b<=a.originalHeight&&(b=Math.min(g,a.originalHeight)));a.enableAutoWidth&&(d+32>window.innerWidth?d=f:d<=a.originalWidth&&(d=Math.min(f,a.originalWidth)),c(a.parentSelector).width(d+a.scrollbarWidth));return d!==a.panelWidth||b!==a.panelHeight?(c(a.outerSelector).height(b).width(d+a.scrollbarWidth),a.panelWidth=d,a.panelHeight=b,!0):!1},E=function(b,d){b>=a.minWidth&&(a.originalWidth=
b,c(a.outerSelector).width(b),a.panelWidth=b-a.scrollbarWidth,c(a.parentSelector).width(b));d>=a.minHeight&&(a.originalHeight=d,c(a.outerSelector).height(d),a.panelHeight=d)},Y=function(){a.enableFullscreen&&c(a.selector+"fullscreen").click(function(){K()});c(a.innerSelector).mouseover(function(){c(this).removeClass("diva-grabbing").addClass("diva-grab")});c(a.innerSelector).mouseout(function(){c(this).removeClass("diva-grab")});c(a.innerSelector).mousedown(function(){c(this).removeClass("diva-grab").addClass("diva-grabbing")});
c(a.innerSelector).mouseup(function(){c(this).removeClass("diva-grabbing").addClass("diva-grab")});c(a.outerSelector+", "+a.innerSelector).dragscrollable({dragSelector:".diva-dragger",acceptPropagatedEvent:!0});c(a.outerSelector).scroll(function(){a.topScrollSoFar=c(a.outerSelector).scrollTop();var b=a.topScrollSoFar-a.previousTopScroll;if(a.inGrid)0>b?(x(a.firstRowLoaded,-1),p(-1),w(a.lastRowLoaded,-1)):0<b&&(x(a.lastRowLoaded,1),p(1),w(a.firstRowLoaded,1)),f(a.onScroll,a.topScrollSoFar),0<b?f(a.onScrollDown,
a.topScrollSoFar):0>b&&f(a.onScrollUp,a.topScrollSoFar);else{var d;if(0>b)s(a.firstPageLoaded,b),H(-1),n(a.lastPageLoaded,b);else if(0<b)s(a.lastPageLoaded,b),H(1),n(a.firstPageLoaded,b);else for(d=Math.max(a.firstPageLoaded,0);d<=a.lastPageLoaded;d++)v(d)&&m(d);f(a.onScroll,a.topScrollSoFar);0<b?f(a.onScrollDown,a.topScrollSoFar):0>b&&f(a.onScrollUp,a.topScrollSoFar);a.leftScrollSoFar=c(this).scrollLeft()}a.previousTopScroll=a.topScrollSoFar});c(a.outerSelector).on("dblclick",".diva-document-page",
function(a){R.call(this,a)});c(a.outerSelector).on("contextmenu",".diva-document-page",function(c){if(c.ctrlKey)return clearTimeout(a.singleClickTimeout),a.singleClick?(R.call(this,c),a.singleClick=!1):(a.singleClick=!0,a.singleClickTimeout=setTimeout(function(){a.singleClick=!1},500)),!1});c(a.outerSelector).on("dblclick",".diva-row",function(b){var d=b.pageX-a.viewerXOffset+c(a.outerSelector).scrollLeft();b=b.pageY-a.viewerYOffset+c(a.outerSelector).scrollTop();a.goDirectlyTo=Math.floor(b/a.rowHeight)*
a.pagesPerRow+Math.floor(d/(a.panelWidth/a.pagesPerRow));a.inGrid=!1;B()});if(a.mobileWebkit){var b=[];b.push('<meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1" />');b.push('<meta name="apple-mobile-web-app-capable" content="yes" />');b.push('<meta name="apple-mobile-web-app-status-bar-style" content="black" />');c("head").append(b.join("\n"));a.blockMobileMove&&c("body").bind("touchmove",function(a){a.originalEvent.preventDefault();return!1});
c("body").bind("gestureend",function(c){c=c.originalEvent;if(!a.scaleWait)if(a.goDirectlyTo=a.currentPageIndex,a.inGrid)a.inGrid=!1,B();else a:{var b=a.zoomLevel;if(1<c.scale&&b<a.maxZoomLevel)b++;else if(1>c.scale&&b>a.minZoomLevel)b--;else break a;a.scaleWait=!0;P(b)}return!1});c(window).bind("orientationchange",function(c){a.orientationChange=!0;W();a.goDirectlyTo=a.currentPageIndex;D()});c(a.outerSelector).kinetic()}if(a.enableSpaceScroll||a.enableKeyScroll){var d=c.ui.keyCode.SPACE,e=c.ui.keyCode.PAGE_UP,
g=c.ui.keyCode.PAGE_DOWN,h=c.ui.keyCode.HOME,z=c.ui.keyCode.END;c(document).keydown(function(b){if(a.enableSpaceScroll&&b.keyCode===d||a.enableKeyScroll&&b.keyCode===g)return c(a.outerSelector).scrollTop(a.topScrollSoFar+a.panelHeight),!1;if(a.enableKeyScroll&&b.keyCode===e)return c(a.outerSelector).scrollTop(a.topScrollSoFar-a.panelHeight),!1;if(a.enableKeyScroll&&b.keyCode===h)return c(a.outerSelector).scrollTop(0),!1;if(a.enableKeyScroll&&b.keyCode===z)return c(a.outerSelector).scrollTop(a.totalHeight),
!1});a.mobileWebkit||c(window).resize(function(){var c;a.inFullscreen?(a.panelWidth=window.innerWidth-a.scrollbarWidth,a.panelHeight=window.innerHeight,c=!0):c=G();c&&(clearTimeout(a.resizeTimer),a.resizeTimer=setTimeout(function(){a.goDirectlyTo=a.currentPageIndex;D()},200))})}},Z=function(){var b=a.enableGridIcon?'<div class="diva-grid-icon'+(a.inGrid?" diva-in-grid":"")+'" id="'+a.ID+'grid-icon" title="Toggle grid view"></div>':"",d=a.enableLinkIcon?'<div class="diva-link-icon" id="'+a.ID+'link-icon" style="'+
(a.enableGridIcon?"border-left: 0px":"")+'" title="Link to this page"></div>':"",e=a.enableZoomSlider?'<div id="'+a.ID+'zoom-slider"></div>':"",f=a.enableGridSlider?'<div id="'+a.ID+'grid-slider"></div>':"",g=a.enableGotoPage?'<form id="'+a.ID+'goto-page" class="diva-goto-form"><input type="text" id="'+a.ID+'goto-page-input" / class="diva-input"> <input type="submit" value="Go" style="margin-top: 0px;" /></form>':"",p=a.enableZoomSlider?'<div id="'+a.ID+'zoom-slider-label" class="diva-slider-label">Zoom level: <span id="'+
a.ID+'zoom-level">'+a.zoomLevel+"</span></div>":"",h=a.enableGridSlider?'<div id="'+a.ID+'grid-slider-label" class="diva-slider-label">Pages per row: <span id="'+a.ID+'pages-per-row">'+a.pagesPerRow+"</span></div>":"",B='<div class="diva-page-label">Page <span id="'+a.ID+'current-page">1</span> of <span id="'+a.ID+'num-pages">'+a.numPages+"</span></div>",l="";a.contained&&("static"===c(a.parentSelector).css("position")&&c(a.parentSelector).addClass("diva-relative-position"),l=" diva-fullscreen-space",
a.enableAutoTitle&&c(a.selector+"fullscreen").addClass("diva-contained"));b='<div id="'+a.ID+'tools-left" class="diva-tools-left'+l+'">'+e+f+p+h+'</div><div id="'+a.ID+'tools-right" class="diva-tools-right">'+d+b+'<div class="diva-page-nav">'+g+B+"</div></div>";a.toolbarParentSelector?c(a.toolbarParentSelector).prepend('<div id="'+a.ID+'tools" class="diva-tools">'+b+"</div>"):c(a.parentSelector).prepend('<div id="'+a.ID+'tools" class="diva-tools">'+b+"</div>");c(a.selector+"zoom-slider").slider({value:a.zoomLevel,
min:a.minZoomLevel,max:a.maxZoomLevel,step:1,slide:function(b,d){var e=a.currentPageIndex;a.goDirectlyTo=e;var f=Math.pow(2,d.value-a.zoomLevel),g=a.maxWidths[a.zoomLevel]+2*a.horizontalPadding,p=c(a.outerSelector).scrollLeft()-(g-a.panelWidth)/2;a.horizontalOffset=g>a.panelWidth?p*f:0;a.verticalOffset=f*(c(a.outerSelector).scrollTop()-a.heightAbovePages[e]);P(d.value)},change:function(c,b){b.value!==a.zoomLevel&&P(b.value)}});c(a.selector+"grid-slider").slider({value:a.pagesPerRow,min:a.minPagesPerRow,
max:a.maxPagesPerRow,step:1,slide:function(a,c){S(c.value)},change:function(c,b){b.value!==a.pagesPerRow&&S(b.value)}});c(a.selector+"grid-icon").click(function(){L()});c(a.selector+"goto-page").submit(function(){var b=parseInt(c(a.selector+"goto-page-input").val(),10)-1;k(b)?a.inGrid?M(b):z(b,0,0):alert("Invalid page number");return!1});c(a.selector+"link-icon").click(function(){c("body").prepend('<div id="'+a.ID+'link-popup" class="diva-link-popup"><input id="'+a.ID+'link-popup-input" class="diva-input" type="text" value="'+
V()+'"/></div>');if(a.inFullscreen)c(a.selector+"link-popup").addClass("in-fullscreen");else{var b=c(a.outerSelector).offset().left+a.panelWidth,b=b+(a.scrollbarWidth-240-1),d=c(a.outerSelector).offset().top+1;c(a.selector+"link-popup").removeClass("in-fullscreen").css({top:d+"px",left:b+"px"})}c("body").mouseup(function(b){b=b.target.id;b!==a.ID+"link-popup"&&b!==a.ID+"link-popup-input"&&c(a.selector+"link-popup").remove()});c(a.outerSelector).scroll(function(){c(a.selector+"link-popup").remove()});
c(a.selector+"link-popup input").click(function(){c(this).focus().select()});return!1});var C=a.inGrid?"grid":"zoom";c(a.selector+C+"-slider").show();c(a.selector+C+"-slider-label").show();return{updateCurrentPage:function(){c(a.selector+"current-page").text(a.currentPageIndex+1)},setNumPages:function(b){c(a.selector+"num-pages").text(b)},updateZoomSlider:function(){a.zoomLevel!==c(a.selector+"zoom-slider").slider("value")&&c(a.selector+"zoom-slider").slider({value:a.zoomLevel});c(a.selector+"zoom-level").text(a.zoomLevel)},
updateGridSlider:function(){a.pagesPerRow!==c(a.selector+"grid-slider").slider("value")&&c(a.selector+"grid-slider").slider({value:a.pagesPerRow});c(a.selector+"pages-per-row").text(a.pagesPerRow)},switchView:function(){c(a.selector+C+"-slider").hide();c(a.selector+C+"-slider-label").hide();C=a.inGrid?"grid":"zoom";c(a.selector+C+"-slider").show();c(a.selector+C+"-slider-label").show();c(a.selector+"grid-icon").toggleClass("diva-in-grid")},switchMode:function(){c(a.selector+"tools").toggleClass("diva-fullscreen-tools");
a.inFullscreen?(c(a.selector+"tools-right").after(c(a.selector+"tools-left")),c(a.selector+"tools-left").addClass("in-fullscreen")):(c(a.selector+"tools-left").after(c(a.selector+"tools-right")),c(a.selector+"tools-left").removeClass("in-fullscreen"))}}},aa=function(){if(window.divaPlugins){var b=[];c.each(window.divaPlugins,function(d,e){var f=e.pluginName[0].toUpperCase()+e.pluginName.substring(1);a["enable"+f]&&e.init(a)&&(f=e.titleText||f+" plugin","function"===typeof e.handleClick&&(b.push('<div class="diva-'+
e.pluginName+'-icon" title="'+f+'"></div>'),c(a.outerSelector).delegate(".diva-"+e.pluginName+"-icon","click",function(c){e.handleClick.call(this,c,a)})),a.plugins.push(e))});b.length&&(a.pageTools='<div class="diva-page-tools">'+b.join("")+"</div>")}},X=function(){clearTimeout(a.throbberTimeoutID);c(a.selector+"throbber").hide()},ba=function(){var b='<div id="'+a.ID+'throbber" class="diva-throbber"></div>';c(a.outerSelector).append(b);a.throbberTimeoutID=setTimeout(function(){c(a.selector+"throbber").show()},
a.throbberTimeout);c.ajax({url:a.divaserveURL,data:{d:a.imageDir},cache:!0,dataType:"json",error:function(b){X();c(a.outerSelector).text("Invalid URL. Error code: "+b.status)},success:function(b){X();a.pages=b.pgs;a.maxRatio=b.dims.max_ratio;a.minRatio=b.dims.min_ratio;a.itemTitle=b.item_title;a.numPages=b.pgs.length;a.maxWidths=b.dims.max_w;a.averageWidths=b.dims.a_wid;a.averageHeights=b.dims.a_hei;a.totalHeights=b.dims.t_hei;a.realMaxZoom=b.max_zoom;a.maxZoomLevel=0<=a.maxZoomLevel&&a.maxZoomLevel<=
b.max_zoom?a.maxZoomLevel:b.max_zoom;a.minZoomLevel=0<=a.minZoomLevel&&a.minZoomLevel<=a.maxZoomLevel?a.minZoomLevel:0;a.minPagesPerRow=Math.max(2,a.minPagesPerRow);a.maxPagesPerRow=Math.max(a.minPagesPerRow,a.maxPagesPerRow);a.enableFilename?(b=c.getHashParam("i"+a.hashParamSuffix),b=l(b)):b=parseInt(c.getHashParam("p"+a.hashParamSuffix),10)-1;k(b)&&(a.goDirectlyTo=b);c.each(a.plugins,function(c,b){f(b.setupHook,a)});a.toolbar=Z();c(a.selector+"current label").text(a.numPages);a.enableAutoTitle&&
c(a.parentSelector).prepend('<div id="'+a.ID+'title" class="diva-title">'+a.itemTitle+"</div>");a.mobileWebkit?W():(a.originalWidth=c(a.parentSelector).width()-a.scrollbarWidth,a.originalHeight=c(a.outerSelector).height(),G());b=c(a.outerSelector).offset();a.viewerXOffset=b.left;a.viewerYOffset=b.top;a.inFullscreen?Q(!1):D();f(a.onReady,a)}})};(function(){a.scrollbarWidth=c.getScrollbarWidth();a.mobileWebkit=void 0!==window.orientation;a.ID=c.generateId("diva-");a.selector="#"+a.ID;var b=parseInt(a.ID,
10);1<b&&(a.hashParamSuffix=b);a.outerSelector=a.selector+"outer";a.innerSelector=a.selector+"inner";c(a.parentSelector).append('<div id="'+a.ID+'outer" class="diva-outer"></div>');c(a.outerSelector).append('<div id="'+a.ID+'inner" class="diva-inner diva-dragger"></div>');a.enableFullscreen&&c(a.parentSelector).prepend('<div id="'+a.ID+'fullscreen" class="diva-fullscreen-icon" title="Toggle fullscreen mode"></div>');b=parseInt(c.getHashParam("n"+a.hashParamSuffix),10);b>=a.minPagesPerRow&&b<=a.maxPagesPerRow&&
(a.pagesPerRow=b);b=c.getHashParam("z"+a.hashParamSuffix);""!==b&&(b=parseInt(b,10),b>=a.minZoomLevel&&(a.zoomLevel=b));b=parseInt(c.getHashParam("y"+a.hashParamSuffix),10);isNaN(b)||(a.verticalOffset=b);b=parseInt(c.getHashParam("x"+a.hashParamSuffix),10);isNaN(b)||(a.horizontalOffset=b);var b=c.getHashParam("g"+a.hashParamSuffix),d="true"===b,e=c.getHashParam("f"+a.hashParamSuffix);a.inGrid=a.inGrid&&"false"!==b||d;a.inFullscreen=a.inFullscreen&&"false"!==e||"true"===e;b=parseInt(c.getHashParam("h"+
a.hashParamSuffix),10);d=parseInt(c.getHashParam("w"+a.hashParamSuffix),10);a.minHeight=parseInt(c(a.outerSelector).css("min-height"),10);a.minWidth=parseInt(c(a.outerSelector).css("min-width"),10);(0<b||0<d)&&E(d,b);ba();aa();Y()})();this.getItemTitle=function(){return a.itemTitle};this.gotoPageByNumber=function(a){a-=1;k(a)&&z(a,0,0)};this.getCurrentPage=function(){return a.currentPageIndex};this.getZoomLevel=function(){return a.zoomLevel};this.setZoomLevel=function(b){a.inGrid&&L();return P(b)};
this.zoomIn=function(){return this.setZoomLevel(a.zoomLevel+1)};this.zoomOut=function(){return this.setZoomLevel(a.zoomLevel-1)};this.inViewport=function(b,c,d){b=a.heightAbovePages[b-1]+c;return u(b,b+d)};this.toggleMode=function(){K()};this.enterFullscreen=function(){return a.inFullscreen?!1:(K(),!0)};this.leaveFullscreen=function(){return a.inFullscreen?(K(),!0):!1};this.toggleView=function(){L()};this.enterGrid=function(){return a.inGrid?!1:(L(),!0)};this.leaveGrid=function(){return a.inGrid?
(L(),!0):!1};this.gotoPageByName=function(a){a=l(a);return k(a)?(z(a),!0):!1};this.getPageIndex=function(a){return l(a)};this.getCurrentURL=function(){return V()};this.getURLHash=function(){return U()};this.getState=function(){return T()};this.setState=function(b){var c;E(b.w,b.h);c=l(b.i);k(c)?a.goDirectlyTo=c:k(b.p)&&(a.goDirectlyTo=b.p);a.horizontalOffset=parseInt(b.x,10);a.verticalOffset=parseInt(b.y,10);b.z>=a.minZoomLevel&&b.z<=a.maxZoomLevel&&(a.zoomLevel=b.z);b.n>=a.minPagesPerRow&&b.n<=a.maxPagesPerRow&&
(a.pagesPerRow=b.n);a.inFullscreen!==b.f?(a.inFullscreen=b.f,Q(a.inGrid!==b.g)):a.inGrid!==b.g?(a.inGrid=b.g,B()):D()};this.resize=function(a,b){E(a,b);D()};this.destroy=function(){c("body").removeClass("diva-hide-scrollbar");c(a.parentSelector).empty().removeData("diva");c.each(a.plugins,function(a,b){f(b.destroy)});c(a.parentSelector).removeAttr("style").removeAttr("class")}};c.fn.diva=function(d){return this.each(function(){var b=c(this);if(!b.data("diva")){d.parentSelector=b;var a=new e(this,
d);b.data("diva",a)}})}})(jQuery);(function(c){window.divaPlugins.push(function(){var e={},d={},b={},a,g,f,h={brightnessMax:150,brightnessMin:-100,brightnessStep:1,contrastMax:3,contrastMin:-1,contrastStep:0.05,localStoragePrefix:"canvas-",mobileWebkitMaxZoom:2,onInit:null,rgbMax:50,rgbMin:-50,throbberFadeSpeed:200,throbberTimeout:100},l=function(b,c){var d=b.context,e=b.size/2,f=-(b.width/2),g=-(b.height/2);d.clearRect(0,0,b.size,b.size);d.save();d.translate(e,e);d.rotate(c*Math.PI/180);d.drawImage(a,f,g,b.width,b.height);d.restore();
b.data=d.getImageData(0,0,b.size,b.size)},u=function(){for(var a in g)if(g[a].current!==g[a].previous)return!0;return!1},k=function(){l(d,g.rotation.current);q(d)},v=function(){var a=g.rotation.current,d=g.zoom.current,f=g.zoom.previous;if(a!==g.rotation.previous||d!==f){var h=c("#diva-canvas-wrapper").scrollLeft(),D=c("#diva-canvas-wrapper").scrollTop(),A=b.viewport.width/2,k=b.viewport.height/2,h=h+A-e.centerX,m=-(D+k-e.centerY),B=(g.rotation.previous-a)*Math.PI/180,D=Math.cos(B)*h-Math.sin(B)*
m+e.centerX,h=-(Math.sin(B)*h+Math.cos(B)*m)+e.centerY,d=Math.pow(2,d-f),A=d*D-A,k=d*h-k;l(e,a);c("#diva-canvas-wrapper").scrollLeft(A);c("#diva-canvas-wrapper").scrollTop(k)}if(u()){q(e);for(var n in g)g[n].previous=g[n].current}},m=function(a){var b=g[a].current!==g[a].initial;return g[a].current!==g[a].previous||b},q=function(a){var c=a.data,d=a.context.createImageData(c),e=d.data,f,h;f=0;for(h=e.length;f<h;f++)e[f]=c.data[f];c=d.data;f=g.contrast.current;e=(1+Math.min(b.brightnessMax,Math.max(b.brightnessMin,
g.brightness.current))/b.brightnessMax)*f;f=128-128*f;h=g.red.current;var l=g.green.current,k=g.blue.current,B=m("red"),n=m("green"),q=m("blue"),s=m("brightness"),r=m("contrast"),s=s||r,t,u,w,x,v,G,E,r=0;for(u=d.width;r<u;r++)for(t=0,w=d.height;t<w;t++)x=4*(t*u+r),v=c[x],G=c[x+1],E=c[x+2],0<v+G+E&&(B&&v&&(v+=h),n&&G&&(G+=l),q&&E&&(E+=k),s&&(v&&(v=v*e+f),G&&(G=G*e+f),E&&(E=E*e+f)),c[x]=v,c[x+1]=G,c[x+2]=E);a.context.clearRect(0,0,u,w);a.context.putImageData(d,0,0)},s=function(){var a=c("#diva-canvas-wrapper").scrollLeft()*
d.scaleFactor,e=c("#diva-canvas-wrapper").scrollTop()*d.scaleFactor,f=Math.min(Math.round(b.viewport.height*d.scaleFactor),b.mapSize)-4,g=Math.min(Math.round(b.viewport.width*d.scaleFactor),b.mapSize)-4;c("#diva-map-viewbox").height(f).width(g).css({top:e,left:a})},n=function(f,g){a=new Image;a.src=f;a.onload=function(){e.size=Math.sqrt(a.width*a.width+a.height*a.height);e.canvas=document.getElementById("diva-canvas");e.canvas.width=e.size;e.canvas.height=e.size;e.cornerX=(e.size-a.width)/2;e.cornerY=
(e.size-a.height)/2;e.width=a.width;e.height=a.height;e.centerX=e.size/2;e.centerY=e.size/2;e.context=e.canvas.getContext("2d");e.context.drawImage(a,e.cornerX,e.cornerY,e.width,e.height);e.data=e.context.getImageData(0,0,e.size,e.size);if(void 0===g){var f=a;d.canvas=document.getElementById("diva-canvas-minimap");d.size=b.mapSize;d.canvas.width=d.size;d.canvas.height=d.size;d.context=d.canvas.getContext("2d");d.context.fillRect(0,0,d.size,d.size);d.scaleFactor=b.mapSize/e.size;d.cornerX=e.cornerX*
d.scaleFactor;d.cornerY=e.cornerY*d.scaleFactor;d.width=f.width*d.scaleFactor;d.height=f.height*d.scaleFactor;d.context.drawImage(f,d.cornerX,d.cornerY,d.width,d.height);d.data=d.context.getImageData(0,0,b.mapSize,b.mapSize);c("#diva-map-viewbox").show();s()}k();v(e);w();"function"===typeof g&&g.call(g)}},r=function(){var a=g[f],b=a.current,a=a.transform?a.transform(b):b;c("#diva-canvas-value").html(a)},t=function(){c("#diva-canvas-slider").slider({value:g[f].current})},F=function(a){a=b.zoomWidthRatio*
Math.pow(2,a);return b.proxyURL?b.proxyURL+"?f="+b.filename+"&w="+a:b.iipServerURL+"?FIF="+(b.imageRoot+"/"+b.imageDir+"/")+b.filename+"&WID="+a+"&CVT=JPEG"},x=function(){(2<g.zoom.current||b.mobileWebkit)&&c(b.selector+"throbber").addClass("canvas-throbber").show()},w=function(){c(b.selector+"throbber").removeClass("canvas-throbber").hide()},J=function(){var a={},c=!1,d=b.localStoragePrefix+b.filename,e;for(e in g)g[e].previous!==g[e].initial&&(a[e]=g[e].previous,c=!0);c?(b.pluginIcon.addClass("new"),
localStorage.setObject(d,a)):(b.pluginIcon.removeClass("new"),localStorage.removeItem(d))},H=function(a,c){b.zoomLevel=a;var f=F(a);n(f,function(){d.scaleFactor=d.size/e.size;s();J()})};return{init:function(a){if(!window.HTMLCanvasElement)return!1;c.extend(b,h,a.canvasPlugin);b.inCanvas=!1;b.iipServerURL=a.iipServerURL;b.imageRoot=a.imageRoot;b.imageDir=a.imageDir;b.selector=a.selector;b.mobileWebkit=a.mobileWebkit;g={contrast:{initial:1,min:b.contrastMin,max:b.contrastMax,step:b.contrastStep,transform:function(a){return a.toFixed(2)},
title:"Change the contrast"},brightness:{initial:0,min:b.brightnessMin,max:b.brightnessMax,step:b.brightnessStep,title:"Adjust the brightness"},rotation:{initial:0,min:0,max:359,step:1,transform:function(a){return a+"&deg;"},title:"Rotate the image"},zoom:{initial:0,min:0,max:0,step:1,title:"Adjust the zoom level"},red:{initial:0,min:b.rgbMin,max:b.rgbMax,step:1,title:"Adjust the red channel"},green:{initial:0,min:b.rgbMin,max:b.rgbMax,step:1,title:"Adjust the green channel"},blue:{initial:0,min:b.rgbMin,
max:b.rgbMax,step:1,title:"Adjust the blue channel"}};var l=function(){var a,b,c;for(c in g)b=g[c],a=b.initial,b.current=a,b.previous=a};l();if(c("#diva-canvas-backdrop").length)return!0;var n="contrast brightness rotation zoom red green blue".split(" "),m=[],q,A,I;for(I in n)q=n[I],A=g[q].title,q='<div class="'+q+'" title="'+A+'"></div>',m.push(q);n='<div id="diva-canvas-backdrop">'+('<div id="diva-canvas-tools"><div id="diva-canvas-toolbar"><div id="diva-canvas-close" title="Return to the document viewer"></div><div id="diva-canvas-minimise" title="Minimise the toolbar"></div><span id="diva-canvas-info">Test</span></div><div id="diva-canvas-toolwindow"><div id="diva-map-viewbox"></div><canvas id="diva-canvas-minimap"></canvas><div id="diva-canvas-buttons">'+
m.join("")+'</div><div id="diva-canvas-pane"><p id="diva-canvas-tooltip"><span id="diva-canvas-mode">contrast</span>: <span id="diva-canvas-value">0</span> <span id="diva-canvas-reset" class="link">(Reset)</span></p><div id="diva-canvas-slider"></div></div><br /><div class="action-buttons"><a href="#" id="diva-canvas-reset-all">Reset all</a><a href="#" id="diva-canvas-apply">Apply</a></div></div></div>')+'<div id="diva-canvas-wrapper"><canvas id="diva-canvas"></canvas></div></div>';c("body").append(n);
b.mapSize=c("#diva-canvas-minimap").width();c("#diva-canvas-buttons div").click(function(){c("#diva-canvas-buttons .clicked").removeClass("clicked");F(c(this).attr("class"))});var F=function(a){f=a;a=g[f];c("#diva-canvas-buttons ."+f).addClass("clicked");c("#diva-canvas-mode").text(f);var b=a.current,d=a.transform?a.transform(b):b;c("#diva-canvas-slider").slider({min:a.min,max:a.max,step:a.step}).slider("value",b);c("#diva-canvas-value").html(d)};F("contrast");c("#diva-canvas-slider").slider({slide:function(a,
b){g[f].current=b.value;r();k()}});c("#diva-canvas-reset-all").click(function(){for(var a in g)g[a].current=g[a].initial;r();t();k()});c("#diva-canvas-reset").click(function(){g[f].current=g[f].initial;r();t();k()});c("#diva-canvas-apply").click(function(){u()&&(x(),setTimeout(function(){g.zoom.current!==g.zoom.previous?H(g.zoom.current):(v(),w(),J())},b.throbberTimeout))});c("#diva-canvas-close").click(function(){c("body").removeClass("overflow-hidden");e.context.clearRect(0,0,e.size,e.size);d.context.clearRect(0,
0,d.size,d.size);c("#diva-canvas-wrapper").scrollTop(0).scrollLeft(0);c("#diva-canvas-backdrop").hide();c("#diva-map-viewbox").hide();l();r();t();c("#diva-canvas-buttons .clicked").removeClass("clicked");F("contrast")});c("#diva-canvas-minimise").click(function(){c("#diva-canvas-toolwindow").slideToggle("fast")});c(window).resize(function(){b.viewport={height:window.innerHeight-a.scrollbarWidth,width:window.innerWidth-a.scrollbarWidth};b.inCanvas&&s()});c("#diva-canvas-wrapper").scroll(function(){b.inCanvas&&
s()});c("#diva-canvas-minimap, #diva-map-viewbox").mouseup(function(a){var e=c("#diva-canvas-minimap").offset(),f=(a.pageX-e.left)/d.scaleFactor;a=(a.pageY-e.top)/d.scaleFactor;c("#diva-canvas-wrapper").scrollTop(a-b.viewport.height/2);c("#diva-canvas-wrapper").scrollLeft(f-b.viewport.width/2)});c("#diva-canvas").mousedown(function(){c(this).addClass("grabbing")}).mouseup(function(){c(this).removeClass("grabbing")});b.mobileWebkit?c("#diva-canvas-wrapper").kinetic():c("#diva-canvas-wrapper").dragscrollable({acceptPropagatedEvent:!0});
"function"===typeof b.onInit&&b.onInit.call(this,b);return!0},pluginName:"canvas",titleText:"View the image on a canvas and adjust various settings",setupHook:function(a){b.viewport={height:window.innerHeight-a.scrollbarWidth,width:window.innerWidth-a.scrollbarWidth};b.minZoomLevel=a.minZoomLevel;b.maxZoomLevel=a.maxZoomLevel;b.mobileWebkit&&(b.maxZoomLevel=Math.min(b.maxZoomLevel,b.mobileWebkitMaxZoom));g.zoom.min=b.minZoomLevel;g.zoom.max=b.maxZoomLevel},handleClick:function(a,d){var e=c(this).parent().parent(),
h=c(e).attr("data-filename"),l=c(e).width()-1,k=d.zoomLevel,m;b.zoomWidthRatio=l/Math.pow(2,k);b.pluginIcon=c(this);b.mobileWebkit&&(k=Math.min(b.maxZoomLevel,k));b.filename=h;g.zoom.initial=k;g.zoom.current=k;if(h=localStorage.getObject(b.localStoragePrefix+b.filename))for(m in h)g[m].current=h[m],m===f&&(r(),t()),"zoom"===m&&(k=h[m]);g.zoom.previous=k;c("body").addClass("overflow-hidden");c("#diva-canvas-backdrop").show();b.inCanvas=!0;k=F(k);c("#diva-canvas-info").text(c(e).attr("title"));x();
n(k)},onPageLoad:function(a,d,e){null!==localStorage.getItem(b.localStoragePrefix+d)&&c(e).find(".diva-canvas-icon").addClass("new")},destroy:function(){c("#diva-canvas-backdrop").remove()}}}())})(jQuery);(function(c){window.divaPlugins.push(function(){var e,d,b;return{init:function(a){e=a.iipServerURL;d=a.imageRoot;b=a.imageDir;return!0},pluginName:"download",titleText:"Download image at the given zoom level",handleClick:function(a){var g=c(this).parent().parent();a=c(g).attr("data-filename");g=c(g).width()-1;window.open(e+"?FIF="+(d+"/"+b+"/")+a+"&WID="+g+"&CVT=JPEG")}}}())})(jQuery);
