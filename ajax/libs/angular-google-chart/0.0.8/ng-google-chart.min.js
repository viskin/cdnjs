(function(a,b){angular.module("googlechart",[]).constant("googleChartApiConfig",{version:"1",optionalSettings:{packages:["corechart"]}}).provider("googleJsapiUrl",function(){var d="";var c="//www.google.com/jsapi";this.setProtocol=function(e){d=e};this.setUrl=function(e){c=e};this.$get=function(){return(d?d:"")+c}}).factory("googleChartApiPromise",["$rootScope","$q","googleChartApiConfig","googleJsapiUrl",function(c,g,f,j){var d=g.defer();var i=function(){var k={callback:function(){var l=f.optionalSettings.callback;c.$apply(function(){d.resolve()});if(angular.isFunction(l)){l.call(this)}}};k=angular.extend({},f.optionalSettings,k);b.google.load("visualization",f.version,k)};var h=a.getElementsByTagName("head")[0];var e=a.createElement("script");e.setAttribute("type","text/javascript");e.src=j;h.appendChild(e);e.onreadystatechange=function(){if(this.readyState=="complete"){i()}};e.onload=i;return d.promise}]).directive("googleChart",["$timeout","$window","$rootScope","googleChartApiPromise",function(d,f,c,e){return{restrict:"A",scope:{chart:"=chart",onReady:"&",select:"&"},link:function(i,h,l){i.$watch("chart",function(){j()},true);c.$on("resizeMsg",function(m){d(function(){if(i.chartWrapper){i.chartWrapper.draw()}})});function k(s,m,r){if(typeof(i.chart.formatters[s])!="undefined"){if(i.formatters[s]==null){i.formatters[s]=new Array();if(s==="color"){for(var q=0;q<i.chart.formatters[s].length;q++){var o=new m();for(var n=0;n<i.chart.formatters[s][q].formats.length;n++){var p=i.chart.formatters[s][q].formats[n];if(typeof(p.fromBgColor)!="undefined"&&typeof(p.toBgColor)!="undefined"){o.addGradientRange(p.from,p.to,p.color,p.fromBgColor,p.toBgColor)}else{o.addRange(p.from,p.to,p.color,p.bgcolor)}}i.formatters[s].push(o)}}else{for(var n=0;n<i.chart.formatters[s].length;n++){i.formatters[s].push(new m(i.chart.formatters[s][n]))}}}for(var n=0;n<i.formatters[s].length;n++){if(i.chart.formatters[s][n].columnNum<r.getNumberOfColumns()){i.formatters[s][n].format(r,i.chart.formatters[s][n].columnNum)}}if(s==="arrow"||s==="bar"||s==="color"){i.chart.options.allowHtml=true}}}function g(){if(!g.triggered&&(i.chart!=undefined)){g.triggered=true;d(function(){g.triggered=false;if(typeof(i.formatters)==="undefined"){i.formatters={}}var n;if(i.chart.data instanceof google.visualization.DataTable){n=i.chart.data}else{if(Array.isArray(i.chart.data)){n=google.visualization.arrayToDataTable(i.chart.data)}else{n=new google.visualization.DataTable(i.chart.data,0.5)}}if(typeof(i.chart.formatters)!="undefined"){k("number",google.visualization.NumberFormat,n);k("arrow",google.visualization.ArrowFormat,n);k("date",google.visualization.DateFormat,n);k("bar",google.visualization.BarFormat,n);k("color",google.visualization.ColorFormat,n)}var m={chartType:i.chart.type,dataTable:n,view:i.chart.view,options:i.chart.options,containerId:h[0]};if(i.chartWrapper==null){i.chartWrapper=new google.visualization.ChartWrapper(m);google.visualization.events.addListener(i.chartWrapper,"ready",function(){i.chart.displayed=true;i.$apply(function(o){o.onReady({chartWrapper:o.chartWrapper})})});google.visualization.events.addListener(i.chartWrapper,"error",function(o){console.log("Chart not displayed due to error: "+o.message)});google.visualization.events.addListener(i.chartWrapper,"select",function(){var o=i.chartWrapper.getChart().getSelection()[0];if(o){i.$apply(function(){i.select({selectedItem:o})})}})}else{i.chartWrapper.setChartType(i.chart.type);i.chartWrapper.setDataTable(n);i.chartWrapper.setView(i.chart.view);i.chartWrapper.setOptions(i.chart.options)}d(function(){i.chartWrapper.draw()})},0,true)}}function j(){e.then(function(){g()})}}}}]).run(["$rootScope","$window",function(c,d){angular.element(d).bind("resize",function(){c.$emit("resizeMsg")})}])})(document,window);