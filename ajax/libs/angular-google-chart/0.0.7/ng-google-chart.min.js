(function(a,b){angular.module("googlechart",[]).constant("googleChartApiConfig",{version:"1",optionalSettings:{packages:["corechart"]}}).provider("googleJsapiUrl",function(){var d="";var c="//www.google.com/jsapi";this.setProtocol=function(e){d=e};this.setUrl=function(e){c=e};this.$get=function(){return(d?d:"")+c}}).factory("googleChartApiProxy",["$rootScope","$q","googleChartApiConfig","googleJsapiUrl",function(c,g,f,j){var d=g.defer(),i=function(){var k={callback:function(){var l=f.optionalSettings.callback;c.$apply(function(){d.resolve()});if(angular.isFunction(l)){l.call(this)}}};k=angular.extend({},f.optionalSettings,k);b.google.load("visualization",f.version,k)},h=a.getElementsByTagName("head")[0],e=a.createElement("script");e.setAttribute("type","text/javascript");e.src=j;h.appendChild(e);e.onreadystatechange=function(){if(this.readyState=="complete"){i()}};e.onload=i;return function(m,l){var k=Array.prototype.slice.call(arguments,2);return function(){d.promise.then(function(){m.apply(l,k.concat(Array.prototype.slice.call(arguments)))})}}}]).directive("googleChart",["$timeout","$window","$rootScope","googleChartApiProxy",function(e,f,d,c){return{restrict:"A",scope:{chart:"=chart",onReady:"&",select:"&"},link:function(i,h,k){i.$watch("chart",function(){g()},true);d.$on("resizeMsg",function(l){e(function(){if(i.chartWrapper){i.chartWrapper.draw()}})});function j(r,l,q){if(typeof(i.chart.formatters[r])!="undefined"){if(i.formatters[r]==null){i.formatters[r]=new Array();if(r==="color"){for(var p=0;p<i.chart.formatters[r].length;p++){var n=new l();for(var m=0;m<i.chart.formatters[r][p].formats.length;m++){var o=i.chart.formatters[r][p].formats[m];if(typeof(o.fromBgColor)!="undefined"&&typeof(o.toBgColor)!="undefined"){n.addGradientRange(o.from,o.to,o.color,o.fromBgColor,o.toBgColor)}else{n.addRange(o.from,o.to,o.color,o.bgcolor)}}i.formatters[r].push(n)}}else{for(var m=0;m<i.chart.formatters[r].length;m++){i.formatters[r].push(new l(i.chart.formatters[r][m]))}}}for(var m=0;m<i.formatters[r].length;m++){if(i.chart.formatters[r][m].columnNum<q.getNumberOfColumns()){i.formatters[r][m].format(q,i.chart.formatters[r][m].columnNum)}}if(r==="arrow"||r==="bar"||r==="color"){i.chart.options.allowHtml=true}}}function g(){if(!g.triggered&&(i.chart!=undefined)){g.triggered=true;e(function(){g.triggered=false;if(typeof(i.formatters)==="undefined"){i.formatters={}}var m;if(i.chart.data instanceof google.visualization.DataTable){m=i.chart.data}else{if(Array.isArray(i.chart.data)){m=google.visualization.arrayToDataTable(i.chart.data)}else{m=new google.visualization.DataTable(i.chart.data,0.5)}}if(typeof(i.chart.formatters)!="undefined"){j("number",google.visualization.NumberFormat,m);j("arrow",google.visualization.ArrowFormat,m);j("date",google.visualization.DateFormat,m);j("bar",google.visualization.BarFormat,m);j("color",google.visualization.ColorFormat,m)}var l={chartType:i.chart.type,dataTable:m,view:i.chart.view,options:i.chart.options,containerId:h[0]};if(i.chartWrapper==null){i.chartWrapper=new google.visualization.ChartWrapper(l);google.visualization.events.addListener(i.chartWrapper,"ready",function(){i.chart.displayed=true;i.$apply(function(n){n.onReady({chartWrapper:n.chartWrapper})})});google.visualization.events.addListener(i.chartWrapper,"error",function(n){console.log("Chart not displayed due to error: "+n.message)});google.visualization.events.addListener(i.chartWrapper,"select",function(){var n=i.chartWrapper.getChart().getSelection()[0];if(n){i.$apply(function(){i.select({selectedItem:n})})}})}else{i.chartWrapper.setChartType(i.chart.type);i.chartWrapper.setDataTable(m);i.chartWrapper.setView(i.chart.view);i.chartWrapper.setOptions(i.chart.options)}e(function(){i.chartWrapper.draw()})},0,true)}}g=c(g,this)}}}]).run(["$rootScope","$window",function(c,d){angular.element(d).bind("resize",function(){c.$emit("resizeMsg")})}])})(document,window);