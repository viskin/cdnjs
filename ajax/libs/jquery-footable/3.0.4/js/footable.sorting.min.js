(function(t,e){e.Sorter=e.Class.extend({construct:function(t,e){this.column=t,this.direction=e}})})(jQuery,FooTable),function(t,e){e.Sorting=e.Component.extend({construct:function(t){this._super(t,t.o.sorting.enabled),this.o=t.o.sorting,this.column=null,this._changed=!1},preinit:function(t){var i=this;this.ft.raise("preinit.ft.sorting",[t]).then(function(){i.ft.$el.hasClass("footable-sorting")&&(i.enabled=!0),i.enabled=e.is.boolean(t.sorting)?t.sorting:i.enabled,i.enabled&&(i.column=e.arr.first(i.ft.columns.array,function(t){return t.sorted}))},function(){i.enabled=!1})},init:function(){var i=this;this.ft.raise("init.ft.sorting").then(function(){e.arr.each(i.ft.columns.array,function(e){e.sortable&&e.$el.addClass("footable-sortable").append(t("<span/>",{"class":"fooicon fooicon-sort"}))}),i.ft.$el.on("click.footable",".footable-sortable",{self:i},i._onSortClicked)},function(){i.enabled=!1})},destroy:function(){var t=this;this.ft.raise("destroy.ft.paging").then(function(){t.ft.$el.off("click.footable",".footable-sortable",t._onSortClicked),t.ft.$el.children("thead").children("tr.footable-header").children(".footable-sortable").removeClass("footable-sortable").find("span.fooicon").remove()})},predraw:function(){if(this.column){var t=this,e=t.column;t.ft.rows.array.sort(function(t,i){return"ASC"==e.direction?e.sorter(t.cells[e.index].sortValue,i.cells[e.index].sortValue):e.sorter(i.cells[e.index].sortValue,t.cells[e.index].sortValue)})}},draw:function(){if(this.column){var t=this,e=t.ft.$el.find("thead > tr > .footable-sortable"),i=t.column.$el;e.removeClass("footable-asc footable-desc").children(".fooicon").removeClass("fooicon-sort fooicon-sort-asc fooicon-sort-desc"),e.not(i).children(".fooicon").addClass("fooicon-sort"),i.addClass("ASC"==t.column.direction?"footable-asc":"footable-desc").children(".fooicon").addClass("ASC"==t.column.direction?"fooicon-sort-asc":"fooicon-sort-desc")}},sort:function(t,e){return this._sort(t,e)},_sort:function(t,i){var n=this,s=new e.Sorter(n.ft.columns.get(t),e.Sorting.dir(i));return n.ft.raise("before.ft.sorting",[s]).then(function(){return e.arr.each(n.ft.columns.array,function(t){t!=n.column&&(t.direction=null)}),n.column=n.ft.columns.get(s.column),n.column&&(n.column.direction=e.Sorting.dir(s.direction)),n.ft.draw().then(function(){n.ft.raise("after.ft.sorting",[s])})})},_onSortClicked:function(e){e.preventDefault();var i=e.data.self,n=t(this).closest("th,td"),s=n.is(".footable-asc, .footable-desc")?n.hasClass("footable-desc")?"ASC":"DESC":"ASC";i._sort(n.index(),s)}}),e.Sorting.dir=function(t){return!e.is.string(t)||"ASC"!=t&&"DESC"!=t?"ASC":t},e.components.core.register("sorting",e.Sorting,5)}(jQuery,FooTable),function(t){t.Cell.prototype.sortValue=null,t.Cell.prototype.__sorting_define__=function(t){this.sortValue=this.column.sortValue.call(this.column,t)},t.Cell.prototype.__sorting_val__=function(e){t.is.defined(e)&&(this.sortValue=this.column.sortValue.call(this.column,e))},t.Cell.extend("define",function(t){this._super(t),this.__sorting_define__(t)}),t.Cell.extend("val",function(t){var e=this._super(t);return this.__sorting_val__(t),e})}(FooTable),function(t,e){e.Column.prototype.direction=null,e.Column.prototype.sortable=!0,e.Column.prototype.sorted=!1,e.Column.prototype.sorter=function(t,e){return"string"==typeof t&&(t=t.toLowerCase()),"string"==typeof e&&(e=e.toLowerCase()),t===e?0:e>t?-1:1},e.Column.prototype.sortValue=function(i){if(e.is.element(i)||e.is.jq(i))return t(i).data("sortValue")||this.parser(i);if(e.is.hash(i)&&e.is.hash(i.options)){if(e.is.string(i.options.sortValue))return i.options.sortValue;e.is.defined(i.value)&&(i=i.value)}return e.is.defined(i)&&null!=i?i:null},e.Column.prototype.__sorting_define__=function(t){this.sorter=e.checkFnValue(this,t.sorter,this.sorter),this.direction=e.is.type(t.direction,"string")?e.Sorting.dir(t.direction):null,this.sortable=e.is.boolean(t.sortable)?t.sortable:!0,this.sorted=e.is.boolean(t.sorted)?t.sorted:!1},e.Column.extend("define",function(t){this._super(t),this.__sorting_define__(t)})}(jQuery,FooTable),function(t){t.Defaults.prototype.sorting={enabled:!1}}(FooTable),function(t,e){e.HTMLColumn.extend("__sorting_define__",function(i){this._super(i),this.sortUse=e.is.string(i.sortUse)&&-1!==t.inArray(i.sortUse,["html","text"])?i.sortUse:"html"}),e.HTMLColumn.prototype.sortValue=function(i){if(e.is.element(i)||e.is.jq(i))return t(i).data("sortValue")||t.trim(t(i)[this.sortUse]());if(e.is.hash(i)&&e.is.hash(i.options)){if(e.is.string(i.options.sortValue))return i.options.sortValue;e.is.defined(i.value)&&(i=i.value)}return e.is.defined(i)&&null!=i?i:null}}(jQuery,FooTable),function(t){t.Table.prototype.sort=function(e,i){return this.use(t.Sorting).sort(e,i)}}(FooTable);