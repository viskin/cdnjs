/*
 * jQuery.my 0.1 beta minified
 * (c) ermouth
 * See details at jquerymy.com
 */
(function(a){var b={};var c={con:function(){try{console.log(arguments)}catch(a){}},bind:function(a,b,c,d){var e=c.bind;if(Object.isFunction(e)){return e(a,b,d)}else if(Object.isString(e)){if(a[e]!=null){if(b!=null)a[e]=String(b);return a[e]}}return null},isOut:function(a,b,c,d){var e=c.check;if(e!=null){var f=c["error"]||d.data("my").root.data("my").params.errorMessage||"Error";if(Object.isFunction(e)){return e(a,b,d)}else if(Object.isRegExp(e)){return e.test(String(b))?"":f}else if(Object.isArray(e)){return e.indexOf(b)>-1?"":f}else if(Object.isString(e)){return b==e?"":f}else if(Object.isObject(e)){return e[b]?"":f}return f}else{return""}},field:function(b,c){var d=b[0].nodeName.toLowerCase();if(c!=null){if(d=="input"){var e=b.eq(0).attr("type").toLowerCase();if(/^number|text|hidden|password$/.test(e)){if(b.val()!=c){b.val(c);if(b.hasClass("ui-slider-input"))b.slider("refresh");if(b.data("tagstrip")&&b.data("tagstrip").root)b.trigger("update")}}else if(e=="radio"){var f=-1;b.each(function(b){var d=a(this).val();if(d==c)f=b});b.each(function(){a(this).attr("checked",false).checkboxradio("refresh")});if(f>-1){b.eq(f).attr("checked",true).checkboxradio("refresh")}}}else if(d=="select"){if(b.val()!=c){b.val(c);if(b.hasClass("ui-slider-switch"))b.slider("refresh");else b.selectmenu("refresh",true)}}else if(d=="textarea"){if(b.val()!=c)b.val(c)}else if(/^p|div|span|li|t[dh]|a$/.test(d)){b.html(c)}else if(d=="img"){b.attr("src",c)}return c}else{if(d=="input"){var e=b.eq(0).attr("type").toLowerCase();if(/^number|text|hidden|password|button$/.test(e)){return b.val()}else if(e=="radio"){var g="";b.each(function(){if(this.attributes["checked"])g=a(this).val()});return g}}else if(/^select|textarea$/.test(d)){return b.val()}else if(/^p|div|span|li|t[dh]|h[1-6]|a$/.test(d)){return b.html().compact()}else if(d=="img"){return b.attr("src")}}},update:function(b,d,e){var g=b,h=g.data("my"),i="Unknown error";if(h){$root=h.root,$container=h.container;var j=h.selector,k=h.data,l=h.ui;var m=$root.data("my").params,n=$root.data("my").ui;if(d!=null){var o=d}else{o=c.field($root.find(j),c.bind(k,null,l,b))}try{var i=c.isOut(k,o,l,g)}catch(p){c.con("Error "+p.name+" validating "+j)}if(i==""){$root.data("my").errors[j]="";c.bind(k,o,l,b);$container.removeClass(m.errorCss).find(m.errorTip).removeClass(m.errorCss).html("").hide()}else{$root.data("my").errors[j]=i;$container.addClass(m.errorCss).find(m.errorTip).addClass(m.errorCss).show().html(i)}if(l.css){for(var q in l.css){var r=l.css[q];if(Object.isRegExp(r)){if(r.test(o))$container.addClass(q);else $container.removeClass(q)}else if(Object.isFunction(r)){if(r(data,o))$container.addClass(q);else $container.removeClass(q)}}}if(e&&l.recalc){var s=l.recalc,t=[],u={};if(Object.isString(s))s=s.split(",");if(Object.isArray(s)){for(var v in s){if(s[v]&&Object.isString(s[v])){var w=s[v].compact();if(n[w]){if(n[w].recalc){if(t.indexOf(w)==-1)t.push(w)}else{u[w]=true}}}}for(var v=0;v<t.length;v++){u=a.extend(true,u,c.update($root.find(t[v]),null,e-1))}if(d!==null){for(v in u){if(u[v]===true&&v!=j)c.update($root.find(v),null,e-1)}return{}}}}return u||{}}}};var d={init:function(b){var d=this;if(!b){return d}var e=a.extend(true,{getContainer:function(b){if(!/^(div|span|a|li|p|h[1-6]|t[dh])$/.test(a(b)[0].tagName.toLowerCase())){var c=b.parents('*[data-role="fieldcontain"], *.tagstrip');if(c.size()==0){var d=b.parents("*");var e=false;for(var f=0;f<3;f++){if(!e&&/div|span|form|p|fieldset/.test(d[f].tagName.toLowerCase())){e=d[f]}}if(!e)return b;else return a(e)}return a(c[0])}else{return b}},commit:function(){},recalcDepth:2,checkDelay:0,errorMessage:"Incorrect input!",errorTip:".my-error-tip",errorCss:"my-error",oninit:function(){}},b.params||{});var g=a.extend(true,{},b.ui||{});var h=b.id||"auto"+Math.random(1e8,999999999);var i=b.data;d.data("my",{id:h,data:i,params:e,errors:Object.extended(),ui:Object.extended(g)});for(var j in g){var k=a(this).find(j);var l=g[j];if(k.size()>0){var m=c.bind(i,null,l,k);if(m!=null){c.field(k,m);k.each(function(){var b=a(this);var g="blur.my input.my change.my check.my"+(a.browser.msie?" keyup.my":"");if(b.is('[type="button"]'))g="click.my check.my";b.data("my",{events:g,selector:j,ui:l,initial:m,previous:m,root:d,data:i,container:e.getContainer(b)}).bind(g,function(){var a=b.data("my");c.update(b,c.field(a.root.find(a.selector)),a.ui.recalcDepth||e.recalcDepth)}.debounce(e.checkDelay))})}else{c.con("Bind function for "+j+" selector returned null. Form "+h)}}else{c.con("Not found "+j+" selector at form "+h)}}for(var j in g){this.find(j).trigger("check")}d.data("my").initial=a.extend(true,{},i);if(a.mobile)a.mobile.changePage(a.mobile.activePage)},redraw:function(a){var b=this;b.data("my").ui.each(function(d){c.update(b.find(d),a?null:undefined,b.data("my").params.reclcDepth)})},data:function(b){if(b!=null){a.extend(true,this.data("my").data,b);this.my("redraw")}return a(this).data("my").data},errors:function(){var b=a(this).data("my").errors,c={};for(var d in b){if(b[d]&&typeof b[d]=="string")c[d]=b[d]}return c},reset:function(){try{a.extend(true,this.data("my").data,this.data("my").initial);this.my("redraw")}catch(b){return false}return true},remove:function(){var a=this;a.data("my").ui.each(function(b){var c=a.find(b);c.unbind(c.data("my").events).removeData("my")});var b=a.data("my").data;a.removeData("my");return b}};a.fn.my=function(b){if(d[b]){return d[b].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof b==="object"||!b){return d.init.apply(this,arguments)}else{a.error("Method "+b+" does not exist on jQuery.my")}}})(jQuery)