var __extends=this&&this.__extends||function(t,i){function e(){this.constructor=t}for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n]);t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)},n3Charts;!function(t){var i;!function(t){"use strict";function i(){function t(t,i,e){t.attr("transform",function(t){var n=i(t.value);return"translate("+(isFinite(n)?n:e(t.value))+",0)"})}function i(t,i,e){t.attr("transform",function(t){var n=i(t.value);return"translate(0,"+(isFinite(n)?n:e(t.value))+")"})}function e(t){var i=t[0],e=t[t.length-1];return e>i?[i,e]:[e,i]}function n(t){return t.rangeExtent?t.rangeExtent():e(t.range())}var o,r=([].slice,"bottom"),s={top:1,right:1,bottom:1,left:1},a=d3.scale.linear(),c=r,u=6,p=24,h=-6,l=0,d=5,f=null,y=null,g=function(e,r,s,a,f){var y,g="major"===r,v=g?p:l,m=g?h:d,x=f.selectAll(".tick."+r).data(e,function(t){return a(t.value)}),O=x.enter().insert("g",".domain").attr("class","tick "+r).style("opacity",1e-6),S=d3.transition(x.exit()).style("opacity",1e-6).remove(),M=d3.transition(x.order()).style("opacity",1),b=Math.max(v,0)+m,A=n(a),D=f.selectAll(".domain").data([0]),F=(D.enter().append("path").attr("class","domain"),D.transition());O.append("line"),O.append("text");var E,w,C,k,T=O.select("line"),z=M.select("line"),_=x.select("text").text(function(t,i){return o?o(t,i):t.label}),I=O.select("text"),B=M.select("text"),U="top"===c||"left"===c?-1:1;"bottom"===c||"top"===c?(y=t,E="x",C="y",w="x2",k="y2",_.attr({dy:0>U?"0em":".8em",dx:"5px"}).style("text-anchor","left"),F.attr("d","M"+A[0]+","+U*u+"V0H"+A[1]+"V"+U*u)):(y=i,E="y",C="x",w="y2",k="x2",_.attr({dy:".32em",dx:0>U?-b+"px":b+"px"}).style("text-anchor",0>U?"end":"start"),F.attr("d","M"+U*u+","+A[0]+"H0V"+A[1]+"H"+U*u)),T.attr(k,U*v),I.attr(C,U*b),z.attr(w,0).attr(k,U*v),B.attr(E,0).attr(C,U*b),S.call(y,a,s),O.call(y,s,a),M.call(y,a,a)},v=function(t){t.each(function(){var t=d3.select(this),i=this.__chart__||a,e=this.__chart__=a.copy(),n=f(e.domain()),o=n.major,r=n.minor;g(o,"major",i,e,t),g(r,"minor",i,e,t)})};return v.scale=function(t){return arguments.length?(a=t,v):a},v.orient=function(t){return arguments.length?(c=t in s?t+"":r,v):c},v.ticks=function(t){return arguments.length?(f=t,v):f},v.tickValues=function(t){return arguments.length?(y=t,v):y},v.tickFormat=function(t){return arguments.length?(o=t,v):o},v.tickSize=function(t){var i=arguments.length;return i?(p=+t,u=+arguments[i-1],l=+t,v):p},v.innerTickSize=function(t){return arguments.length?(p=+t,v):p},v.outerTickSize=function(t){return arguments.length?(u=+t,v):u},v.tickPadding=function(t){return arguments.length?(h=+t,v):h},v}t.twoSpeedAxis=i}(i=t.svg||(t.svg={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var i;!function(i){"use strict";var e=function(){function e(i){void 0===i&&(i={}),this.axis="y",this.type=["line"],this.visible=!0,this.defined=function(t){return!0};var e=this.sanitizeOptions(i);this.id=e.id||t.Utils.UUID.generate(),this.axis=e.axis,this.interpolation=e.interpolation,this.dataset=e.dataset,this.key=e.key,this.color=e.color,this.visible=e.visible,this.label=e.label||e.id,e.defined&&(this.defined=e.defined),e.type.length>0&&(this.type=this.sanitizeType(e.type))}return e.prototype.sanitizeOptions=function(t){var e={};return angular.extend(e,this,t),e.axis=this.sanitizeAxis(e.axis),e.interpolation=this.sanitizeInterpolation(e.interpolation),e.id=i.Options.getString(e.id),e.type=i.Options.getArray(e.type),e.dataset=i.Options.getString(e.dataset),e.key=this.sanitizeKeys(e.key),e.color=i.Options.getString(e.color),e.label=i.Options.getString(e.label),e.visible=i.Options.getBoolean(e.visible),e.defined=i.Options.getFunction(e.defined),e},e.prototype.sanitizeInterpolation=function(t){return t?{mode:i.Options.getString(t.mode,"linear"),tension:i.Options.getNumber(t.tension,.7)}:{mode:"linear",tension:.7}},e.prototype.sanitizeKeys=function(t){return t?"string"==typeof t?{y1:i.Options.getString(t)}:{y0:i.Options.getString(t.y0),y1:i.Options.getString(t.y1)}:{y1:void 0}},e.prototype.getToggledVisibility=function(){return!this.visible},e.prototype.sanitizeType=function(t){return t.filter(function(t){return e.isValidType(t)?!0:(console.warn("Unknow series type : "+t),!1)})},e.prototype.sanitizeAxis=function(t){if(-1===["y","y2"].indexOf(t))throw TypeError(t+" is not a valid series option for axis.");return t},e.prototype.isAColumn=function(){return this.hasType(e.TYPE.COLUMN)},e.prototype.isDashed=function(){return-1!==this.type.indexOf(e.TYPE.DASHED_LINE)},e.prototype.hasType=function(t){return t===e.TYPE.LINE?-1!==this.type.indexOf(t)||-1!==this.type.indexOf(e.TYPE.DASHED_LINE):-1!==this.type.indexOf(t)},e.prototype.hasTwoKeys=function(){return void 0!==this.key.y0},e.isValidType=function(t){return-1!==d3.values(e.TYPE).indexOf(t)},e.TYPE={DOT:"dot",LINE:"line",DASHED_LINE:"dashed-line",AREA:"area",COLUMN:"column"},e}();i.SeriesOptions=e}(i=t.Options||(t.Options={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var i;!function(t){"use strict";var i=function(){function i(t){void 0===t&&(t={}),this.includeZero=!1,this.type="linear",this.key="x",this.padding={min:0,max:0},this.ticksShift={x:0,y:0},this.parse(t)}return i.prototype.parse=function(e){this.type=t.Options.getString(e.type,"linear"),this.key=e.key,this.padding=t.Options.getObject(e.padding||{},this.padding),this.includeZero=t.Options.getBoolean(e.includeZero,!1),this.tickFormat=t.Options.getFunction(e.tickFormat),this.ticks=e.ticks,e.ticksShift&&(this.ticksShift={x:t.Options.getNumber(e.ticksShift.x,0),y:t.Options.getNumber(e.ticksShift.y,0)}),this.type===i.TYPE.LINEAR?(this.min=t.Options.getNumber(e.min,void 0),this.max=t.Options.getNumber(e.max,void 0)):this.type===i.TYPE.DATE&&(this.min=t.Options.getDate(e.min,void 0),this.max=t.Options.getDate(e.max,void 0))},i.isValidSide=function(t){return-1!==d3.values(i.SIDE).indexOf(t)},i.prototype.hasDynamicTicks=function(){return this.ticks instanceof Function},i.prototype.configure=function(t){return t.tickFormat(this.tickFormat),this.ticks instanceof Array?t.tickValues(this.ticks):"number"==typeof this.ticks?t.ticks(this.ticks):this.ticks instanceof Function&&t.ticks(this.ticks),t},i.SIDE={X:"x",X2:"x2",Y:"y",Y2:"y2"},i.TYPE={LINEAR:"linear",DATE:"date",LOG:"log"},i}();t.AxisOptions=i}(i=t.Options||(t.Options={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var i;!function(t){"use strict";var i=function(){function i(){this.width=600,this.height=200,this.innerWidth=560,this.innerHeight=160,this.margin=i.getDefaultMargins()}return i.getDefaultMargins=function(){return{top:0,left:40,bottom:40,right:40}},i.prototype.updateMargins=function(i){var e=this;if(i&&i.margin){var n=function(n){return e.margin[n]=t.Options.getNumber(i.margin[n],e.margin[n])};n("top"),n("bottom"),n("left"),n("right")}},i.prototype.getDimensionByProperty=function(t,i){var e=window.getComputedStyle(t,null);return+e.getPropertyValue(i).replace(/px$/,"")},i.prototype.fromParentElement=function(t){if(t){var i=this.getDimensionByProperty(t,"padding-left")+this.getDimensionByProperty(t,"padding-right"),e=this.getDimensionByProperty(t,"padding-top")+this.getDimensionByProperty(t,"padding-bottom");this.width=t.clientWidth-i,this.height=t.clientHeight-e,this.innerHeight=this.height-this.margin.top-this.margin.bottom,this.innerWidth=this.width-this.margin.left-this.margin.right}},i}();t.Dimensions=i}(i=t.Options||(t.Options={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var i;!function(t){"use strict";var i=function(){function i(e){this.doubleClickEnabled=!0,this.series=[],this.pan={x:!1,y:!1},this.zoom={x:!1,y:!1},this.axes={x:{},y:{}},this.margin=t.Dimensions.getDefaultMargins(),this.grid={x:!1,y:!0};var n=angular.extend({},this,e);this.margin=this.sanitizeMargin(i.getObject(n.margin,this.margin)),this.series=this.sanitizeSeries(i.getArray(n.series)),this.axes=this.sanitizeAxes(i.getObject(n.axes,this.axes)),this.grid=this.sanitizeTwoAxesOptions(n.grid,this.grid),this.pan=this.sanitizeTwoAxesOptions(n.pan,this.pan),this.zoom=this.sanitizeTwoAxesOptions(n.zoom,this.zoom),this.tooltipHook=i.getFunction(n.tooltipHook),this.doubleClickEnabled=i.getBoolean(n.doubleClickEnabled,!1)}return i.prototype.sanitizeMargin=function(t){return{top:i.getNumber(t.top,0),left:i.getNumber(t.left,0),bottom:i.getNumber(t.bottom,0),right:i.getNumber(t.right,0)}},i.prototype.sanitizeSeries=function(i){return i.map(function(i){return new t.SeriesOptions(i)})},i.prototype.sanitizeTwoAxesOptions=function(t,e){var n={x:i.getBoolean(t.x,e.x),y:i.getBoolean(t.y,e.y)};return n},i.prototype.sanitizeAxes=function(i){return Object.keys(i).reduce(function(e,n){return e[n]=new t.AxisOptions(i[n]),e},{})},i.prototype.getAbsKey=function(){if(!this.axes[t.AxisOptions.SIDE.X])throw new TypeError("Cannot find abs key : "+t.AxisOptions.SIDE.X);return this.axes[t.AxisOptions.SIDE.X].key},i.prototype.getVisibleDatasets=function(){var t=[];return this.series.forEach(function(i){i.visible&&-1===t.indexOf(i.dataset)&&t.push(i.dataset)}),t},i.prototype.getSeriesAndDatasetBySide=function(i){if(!t.AxisOptions.isValidSide(i))throw new TypeError("Cannot get axis side : "+i);i!==t.AxisOptions.SIDE.Y2||this.axes[i]||(i=t.AxisOptions.SIDE.Y);var e=[],n={};return this.series.forEach(function(t){t.visible&&t.axis===i&&(e.push(t.dataset),n[t.dataset]||(n[t.dataset]=[]),n[t.dataset].push(t))}),{seriesForDataset:n,datasetsForSide:e}},i.prototype.getByAxisSide=function(i){if(!t.AxisOptions.isValidSide(i))throw new TypeError("Cannot get axis side : "+i);if(!this.axes[i]){if(i===t.AxisOptions.SIDE.Y2)return this.axes[t.AxisOptions.SIDE.Y];if(i===t.AxisOptions.SIDE.X2)return this.axes[t.AxisOptions.SIDE.X]}return this.axes[i]},i.prototype.getSeriesByType=function(i){if(!t.SeriesOptions.isValidType(i))throw new TypeError("Unknown series type: "+i);return this.series.filter(function(t){return t.hasType(i)})},i.getBoolean=function(t,i){return void 0===i&&(i=!0),"boolean"==typeof t?t:i},i.getNumber=function(t,i){var e=parseFloat(t);return isNaN(e)?i:e},i.getDate=function(t,i){return t instanceof Date?t:i},i.getFunction=function(t){return t instanceof Function?t:void 0},i.getString=function(t,i){return t?String(t):i},i.getIdentifier=function(t){var e=i.getString(t);return e.replace(/[^a-zA-Z0-9\-_]/gi,"")},i.getObject=function(t,i){if(void 0===i&&(i={}),!angular.isObject(t))throw TypeError(t+" option must be an object.");var e={};return angular.extend(e,i,t),e},i.getArray=function(t,i){return void 0===i&&(i=[]),i.concat(t)},i}();t.Options=i}(i=t.Options||(t.Options={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var i;!function(t){"use strict";var i=function(){function t(){this.strictMode=!0}return t.prototype.init=function(t){var i=this;this._dispatch=d3.dispatch.apply(this,t);var e=(new Date).getTime();return d3.select(window).on("mouseup."+e,function(){d3.event.preventDefault(),i.trigger("window-mouseup")}),d3.select(window).on("mousemove."+e,function(){d3.event.preventDefault(),i.trigger("window-mousemove")}),this},t.prototype.update=function(t,i){this.data=t,this.options=i},t.prototype.on=function(i,e){if(this.strictMode&&-1===t.EVENTS.indexOf(i.split(".")[0]))throw new Error("Unknown event: "+i);return this._dispatch.on(i,e),this},t.prototype.trigger=function(t){for(var i=[],e=1;e<arguments.length;e++)i[e-1]=arguments[e];return this._dispatch[t].apply(this,i),this},t.prototype.triggerDataAndOptions=function(t){for(var i=[],e=1;e<arguments.length;e++)i[e-1]=arguments[e];return i.push(this.data),i.push(this.options),this._dispatch[t].apply(this,i),this},t.prototype.datumEnter=function(t,i){var e=this;return function(n){return n.on("mouseenter",function(n,o){e.trigger("enter",n,o,t,i)})}},t.prototype.datumOver=function(t,i){var e=this;return function(n){return n.on("mouseover",function(n,o){e.trigger("over",n,o,t,i)})}},t.prototype.datumMove=function(t,i){var e=this;return function(n){return n.on("mousemove",function(n,o){e.trigger("over",n,o,t,i)})}},t.prototype.datumLeave=function(t,i){var e=this;return function(n){return n.on("mouseleave",function(n,o){e.trigger("leave",n,o,t,i)})}},t.prototype.listenForDblClick=function(t,i,e){var n,o,r=this,s=5,a=null,c=function(t,i){return Math.sqrt(Math.pow(t[0]-i[0],2)+Math.pow(t[1]-i[1],2))};return t.on("mousedown.dbl."+e,function(){n=d3.mouse(document.body),o=(new Date).getTime()}),t.on("mouseup.dbl."+e,function(){!n||c(n,d3.mouse(document.body))>s||(a&&r.options.doubleClickEnabled?(window.clearTimeout(a),a=null,i(d3.event)):a=window.setTimeout(function(t){return function(){a=null}}(d3.event),300))}),t},t.EVENTS=["create","update","data-update","resize","destroy","enter","over","move","leave","click","dblclick","legend-click","legend-over","legend-out","container-over","container-move","container-out","focus","toggle","outer-world-hover","outer-world-domain-change","pan","pan-end","zoom","zoom-end","zoom-pan-reset","window-mouseup","window-mousemove"],t}();t.EventManager=i}(i=t.Utils||(t.Utils={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var i;!function(t){"use strict";var i=function(){function t(){this._factoryStack=[]}return t.prototype.index=function(t){return this._factoryStack.map(function(t){return t.key}).indexOf(t)},t.prototype.getBoundFunction=function(t,i){var e=this.get(t);return e?e[i].bind(e):null},t.prototype.get=function(t){var i=this.index(t);return i>-1?this._factoryStack[i].instance:null},t.prototype.all=function(){return this._factoryStack},t.prototype.turnFactoriesOff=function(t){var i=this,e=[];return t.forEach(function(t){var n=i.get(t);n.isOn()&&(n.off(),e.push(t))}),function(){return i.turnFactoriesOn(e)}},t.prototype.turnFactoriesOn=function(t){var i=this,e=[];return t.forEach(function(t){var n=i.get(t);n.isOff()&&(n.on(),e.push(t))}),function(){return i.turnFactoriesOff(e)}},t.prototype.registerMany=function(t){var i=this;return t.forEach(function(t){i.register.apply(i,t)}),this},t.prototype.register=function(t,i){for(var e=[],n=2;n<arguments.length;n++)e[n-2]=arguments[n];var o=i.bind.apply(i,[null].concat(e)),r=new o;return this._factoryStack.push({key:t,instance:r}),r},t.prototype.unregister=function(t){var i=this.index(t);return i>-1&&delete this._factoryStack[i],this},t}();t.FactoryManager=i}(i=t.Utils||(t.Utils={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var i;!function(t){"use strict";var i=function(){function t(t,i){this.fromJS(t,i)}return t.prototype.fromJS=function(t,i){this.id=i,this.values=t},t}();t.Dataset=i}(i=t.Utils||(t.Utils={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var i;!function(t){"use strict";var i=function(){function i(t){t&&this.fromJS(t)}return i.prototype.fromJS=function(i){var e={};for(var n in i)i.hasOwnProperty(n)&&(e[n]=new t.Dataset(i[n],n));this.sets=e},i.prototype.getDatasets=function(t,i){var e=this;return t.map(function(t){return e.getDatasetValues(t,i)})},i.prototype.getDatasetValues=function(t,i){if(!this.sets||!this.sets[t.dataset].values)return[];var e,n=i.getAbsKey();return e=t.key.y0?function(i){return{x:i[n],y1:i[t.key.y1],y0:i[t.key.y0]}}:function(i){return{x:i[n],y1:i[t.key.y1],y0:0}},this.sets[t.dataset].values.map(e)},i.getMinDistance=function(t,i,e,n){return void 0===e&&(e="x"),d3.min(t.map(function(t){return t.map(function(t){return i.scale(t[e])}).filter(function(t){return n?t>=n[0]&&t<=n[1]:!0}).reduce(function(t,i,e,n){var o=e>0?i-n[e-1]:Number.MAX_VALUE;return t>o?o:t},Number.MAX_VALUE)}))},i}();t.Data=i}(i=t.Utils||(t.Utils={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var i;!function(t){"use strict";var i=function(){function t(){}return t.debounce=function(t,i){var e=this,n=null;return function(){for(var o=[],r=0;r<arguments.length;r++)o[r-0]=arguments[r];n&&window.clearTimeout(n),n=window.setTimeout(function(){return t.apply(e,o)},i)}},t}();t.FunctionUtils=i;var e=function(){function t(){}return t.generate=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=16*Math.random()|0,e="x"===t?i:3&i|8;return e.toString(16)})},t}();t.UUID=e}(i=t.Utils||(t.Utils={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var i;!function(t){"use strict";var i=function(){function t(){this.enabled=!0}return t.prototype.init=function(t,i,e){this.key=t,this.eventMgr=i,this.factoryMgr=e,this.eventMgr.on("create."+this.key,this.create.bind(this)),this.eventMgr.on("update."+this.key,this.update.bind(this)),this.eventMgr.on("destroy."+this.key,this.destroy.bind(this))},t.prototype.on=function(){this.enabled=!0},t.prototype.off=function(){this.enabled=!1},t.prototype.isOn=function(){return this.enabled===!0},t.prototype.isOff=function(){return this.enabled===!1},t.prototype.create=function(t){},t.prototype.update=function(t,i){},t.prototype.destroy=function(){},t}();t.BaseFactory=i}(i=t.Factory||(t.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var i;!function(i){"use strict";var e=function(i){function e(e){i.call(this),this.element=e,this.dim=new t.Options.Dimensions}return __extends(e,i),e.prototype.create=function(t){var i=this;this.dim.updateMargins(t),this.listenToElement(this.element,t),this.createRoot(),this.createContainer(),this.dim.fromParentElement(this.element.parentElement),this.eventMgr.on("resize",function(){i.dim.fromParentElement(i.element.parentElement),i.update()}),this.eventMgr.listenForDblClick(this.svg,function(){i.eventMgr.trigger("zoom-pan-reset",!0)},this.key),this.eventMgr.on("zoom-pan-reset."+this.key,function(t){i.eventMgr.triggerDataAndOptions("update")})},e.prototype.listenToElement=function(t,i){var e=this.eventMgr;t.addEventListener("mouseover",function(t){e.triggerDataAndOptions.apply(e,["container-over",t])}),t.addEventListener("mousemove",function(t){e.triggerDataAndOptions.apply(e,["container-move",t])}),t.addEventListener("mouseout",function(t){e.triggerDataAndOptions.apply(e,["container-out",t])})},e.prototype.getCoordinatesFromEvent=function(t){var i=this.getDimensions(),e=t.currentTarget.getBoundingClientRect(),n=e.left,o=e.top,r=this.factoryMgr.get("x-axis"),s=r.invert(t.clientX-n-i.margin.left),a=this.factoryMgr.get("y-axis"),c=a.invert(t.clientY-o-i.margin.top);return{y:c,x:s}},e.prototype.update=function(){this.updateRoot(),this.updateContainer()},e.prototype.destroy=function(){this.destroyRoot()},e.prototype.createRoot=function(){this.svg=d3.select(this.element).append("svg").attr("class","chart"),this.defs=this.svg.append("defs")},e.prototype.updateRoot=function(){this.svg.attr("width",this.dim.width).attr("height",this.dim.height)},e.prototype.destroyRoot=function(){this.svg.remove()},e.prototype.createContainer=function(){this.vis=this.svg.append("g").attr("class","container"),this.axes=this.vis.append("g").attr("class","axes"),this.clippingPathId="clipping-path-"+t.Utils.UUID.generate(),this.defs.append("svg:clipPath").attr("id",this.clippingPathId).append("svg:rect").attr("id","clipping-rect"),this.data=this.vis.append("g").attr({"class":"data","clip-path":"url(#"+this.clippingPathId+")"}),this.overlay=this.vis.append("g").attr("class","overlay")},e.prototype.updateContainer=function(){this.vis.attr({width:this.dim.innerWidth,height:Math.max(this.dim.innerHeight,0),transform:"translate("+this.dim.margin.left+", "+this.dim.margin.top+")"}),d3.select(this.element).select("#clipping-rect").attr({width:Math.max(this.dim.innerWidth,0),height:Math.max(this.dim.innerHeight,0)})},e.prototype.getDimensions=function(){return this.dim},e}(i.BaseFactory);i.Container=e}(i=t.Factory||(t.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var i;!function(i){"use strict";var e=function(i){function e(t){i.call(this),this.element=t}return __extends(e,i),e.prototype.off=function(){i.prototype.off.call(this),this.hide()},e.prototype.create=function(t){this.options=t,this.createTooltip(),this.eventMgr.on("container-move.tooltip",this.show.bind(this)),this.eventMgr.on("container-out.tooltip",this.hide.bind(this)),this.eventMgr.on("outer-world-hover.tooltip",this.showFromCoordinates.bind(this)),this.hide()},e.prototype.update=function(t,i){this.options=i},e.prototype.createTooltip=function(){var t=this.svg=d3.select(this.element).append("div").attr("class","chart-tooltip");t.append("div").attr("class","abscissas"),this.line=this.factoryMgr.get("container").overlay.append("line").attr("class","tooltip-line"),this.dots=this.factoryMgr.get("container").overlay.append("g").attr("class","tooltip-dots")},e.prototype.destroy=function(){this.svg.remove()},e.prototype.getClosestRows=function(t,i,e){for(var n=e.series.filter(function(t){return t.visible}),o=n.map(function(t){return i.getDatasetValues(t,e).filter(t.defined)}),r=[],s=-1,a=Number.POSITIVE_INFINITY,c=[],u=0;u<o.length;u++)for(var p=0;p<o[u].length;p++){if("date"===e.axes.x.type)var h=Math.abs(o[u][p].x.getTime()-t);else var h=Math.abs(o[u][p].x-t);var l=n[u];h===a&&-1===c.indexOf(l)?(r.push({series:l,row:o[u][p]}),c.push(l)):a>h&&(a=h,r=[{series:n[u],row:o[u][p]}],c=[l],s=p)}return{rows:r,index:s}},e.prototype.showFromCoordinates=function(t,i,e){if(!this.isOff()){var n=t.x,o=t.y;if(void 0===n||void 0===o)return void this.hide(void 0,i,e);n instanceof Date&&(n=n.getTime());var r=this.getClosestRows(n,i,e),s=r.rows,a=r.index;if(0===s.length)return void this.hide(void 0,i,e);this.updateTooltipDots(s),this.dots.style("opacity","1"),this.updateLinePosition(s),this.line.style("opacity","1");var c=this.getTooltipContent(s,a,e);e.tooltipHook&&(c=e.tooltipHook(s)),c&&(this.updateTooltipContent(c,a,e),this.updateTooltipPosition(s),this.svg.style("display",null))}},e.prototype.show=function(t,i,e){if(!this.isOff()){var n=this.factoryMgr.get("container"),o=n.getCoordinatesFromEvent(t);this.showFromCoordinates(o,i,e)}},e.prototype.hide=function(t,i,e){this.svg.style("display","none"),this.line.style("opacity","0"),this.dots.style("opacity","0"),e&&e.tooltipHook&&e.tooltipHook(void 0)},e.prototype.getTooltipContent=function(i,e,n){var o=n.getByAxisSide(t.Options.AxisOptions.SIDE.X).tickFormat,r=function(t){return n.getByAxisSide(t).tickFormat},s=function(t){var i=r(t.series.axis),n=i?function(t){return i(t,e)}:function(t){return t},o=n(t.row.y1);return t.series.hasTwoKeys()?"["+n(t.row.y0)+", "+o+"]":o};return{abscissas:o?o(i[0].row.x,e):i[0].row.x,rows:i.map(function(t){return{label:t.series.label,value:s(t),color:t.series.color,id:t.series.id}})}},e.prototype.updateTooltipContent=function(t,i,e){this.svg.select(".abscissas").text(t.abscissas);var n=function(t){return t.attr({"class":"tooltip-item"}),t.append("div").attr({"class":"color-dot"}).style({"background-color":function(t){return t.color}}),t.append("div").attr({"class":"series-label"}),t.append("div").attr({"class":"y-value"}),t},o=function(t){return t.select(".series-label").text(function(t){return t.label}),t.select(".y-value").text(function(t){return t.value}),t},r=this.svg.selectAll(".tooltip-item").data(t.rows,function(t,i){return t.id?t.id:i});r.enter().append("div").call(n).call(o),r.call(o),r.exit().remove()},e.prototype.updateTooltipDots=function(t){var i=this,e=this.factoryMgr.get("x-axis").scale,n=function(t){return i.factoryMgr.get(t+"-axis").scale},o=3,r=function(t,i,e){return"M "+i+" "+e+" m -"+t+", 0 a "+t+","+t+" 0 1,0 "+2*t+",0 a "+t+","+t+" 0 1,0 -"+2*t+",0 "},s=function(t){t.attr("class","tooltip-dots-group"),t.append("path").attr({"class":"tooltip-dot y1"}).on("click",function(t,e){i.eventMgr.trigger("click",t.row,e,t.series,i.options)}),t.append("path").attr({"class":"tooltip-dot y0"}).style({display:function(t){return t.series.hasTwoKeys()?null:"none"}}).on("click",function(t,e){i.eventMgr.trigger("click",t.row,e,t.series,i.options)})},a=function(t){t.select(".tooltip-dot.y1").attr({d:function(t){return r(o,e(t.row.x),n(t.series.axis)(t.row.y1))},stroke:function(t){return t.series.color}}),t.select(".tooltip-dot.y0").attr({d:function(t){return t.series.hasTwoKeys()?r(o,e(t.row.x),n(t.series.axis)(t.row.y0)):""},stroke:function(t){return t.series.color}})},c=this.dots.selectAll(".tooltip-dots-group").data(t);c.enter().append("g").call(s).call(a),c.call(a),c.exit().remove()},e.prototype.updateTooltipPosition=function(t){var i=t.slice(-1)[0],e=this.factoryMgr.get("x-axis"),n=(this.factoryMgr.get("y-axis").scale,this.factoryMgr.get("container").getDimensions().margin),o=this.element.offsetLeft,r=this.element.offsetTop,s=0,a="";e.isInLastHalf(i.row.x)?(a="translate(-100%, 0)",s=-10):s=10,this.svg.style({left:o+n.left+e.scale(i.row.x)+s+"px",top:r+n.top+"px",transform:a})},e.prototype.updateLinePosition=function(t){var i=this.factoryMgr.get("container"),e=i.getDimensions(),n=t.slice(-1)[0],o=this.factoryMgr.get("x-axis"),r=o.scale(n.row.x);this.line.attr({x1:r,x2:r,y1:-e.margin.top,y2:e.innerHeight})},e}(i.BaseFactory);i.Tooltip=e}(i=t.Factory||(t.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var i;!function(t){"use strict";var i=function(t){function i(i){t.call(this),this.element=i}return __extends(i,t),i.prototype.create=function(){this.createLegend()},i.prototype.createLegend=function(){this.div=d3.select(this.element).append("div").attr("class","chart-legend").style("position","absolute")},i.prototype.legendClick=function(){var t=this;return function(i){return i.on("click",function(i){t.eventMgr.trigger("legend-click",i)})}},i.prototype.update=function(t,i){var e=this,n=this.factoryMgr.get("container"),o=(n.getDimensions(),function(t){var i=t.append("div").attr({"class":"item"}).call(e.legendClick());i.append("div").attr({"class":"icon"}),i.append("div").attr({"class":"legend-label"})}),r=function(t){t.attr("class",function(t){return"item "+t.type.join(" ")}).classed("legend-hidden",function(t){return!t.visible}),t.select(".icon").style("background-color",function(t){return t.color}),t.select(".legend-label").text(function(t){return t.label})},s=this.div.selectAll(".item").data(i.series);s.enter().call(o),s.call(r),s.exit().remove()},i.prototype.destroy=function(){this.div.remove()},i}(t.BaseFactory);t.Legend=i}(i=t.Factory||(t.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var i;!function(i){"use strict";var e=function(i){function e(e){var n=this;if(i.call(this),this.side=e,!t.Options.AxisOptions.isValidSide(e))throw new TypeError("Wrong axis side : "+e);this.scale=function(t){return n._scale.call(n,t)}}return __extends(e,i),e.prototype.range=function(){return this._scale.range()},e.prototype.getDomain=function(){return this._scale.domain()},e.prototype.setDomain=function(t){return this._scale.domain.call(this,t)},e.prototype.create=function(){var t=this.factoryMgr.get("container").axes;this.createAxis(t),this.eventMgr.on("pan."+this.key,this.softUpdate.bind(this)),this.eventMgr.on("zoom-end."+this.key,this.softUpdate.bind(this)),this.eventMgr.on("outer-world-domain-change."+this.key,this.updateFromOuterWorld.bind(this)),this.eventMgr.on("resize."+this.key,this.onResize.bind(this))},e.prototype.updateFromOuterWorld=function(t){this.updateScaleDomain(t[this.side[0]]),this.softUpdate()},e.prototype.softUpdate=function(){this.factoryMgr.get("transitions").isOn()?this.svg.transition().call(this.factoryMgr.getBoundFunction("transitions","edit")).call(this.d3axis):this.svg.call(this.d3axis)},e.prototype.onResize=function(){var t=this.factoryMgr.get("container"),i=t.getDimensions();this.updateScaleRange(i,this.options),this.updateAxisContainer(i),this.softUpdate()},e.prototype.update=function(t,i){var e=this.factoryMgr.get("container"),n=e.getDimensions(),o=this.getExtent(t,i);this.options=i.getByAxisSide(this.side),this._scale=this.getScale(),this.updateScaleRange(n,this.options),this.updateScaleDomain(o),this.d3axis=this.getAxis(this._scale,this.options),this.updateAxisOrientation(this.d3axis),this.updateAxisContainer(n),this.shiftAxisTicks(this.options)},e.prototype.shiftAxisTicks=function(t){var i=t.ticksShift,e=i.x,n=i.y;this.svg.selectAll("text").attr("transform","translate("+e+", "+n+")")},e.prototype.destroy=function(){this.destroyAxis()},e.prototype.updateScaleRange=function(t,i){this.isAbscissas()?this._scale.range([i.padding.min,t.innerWidth-i.padding.max]):this._scale.range([t.innerHeight-i.padding.min,i.padding.max])},e.prototype.updateScaleDomain=function(t){this._scale.domain(t)},e.prototype.getScaleDomain=function(){return this._scale?this._scale.domain():[0,1]},e.prototype.getExtentForDatasets=function(t,i,e,n){void 0===n&&(n=!1);var o=n?0:Number.POSITIVE_INFINITY,r=n?0:Number.NEGATIVE_INFINITY;for(var s in t.sets)i(s)&&t.sets[s].values.forEach(function(t){var i=e(t,s);i[0]<o&&(o=i[0]),i[1]>r&&(r=i[1])});return o===r&&(r=o+1),[o===Number.POSITIVE_INFINITY?0:o,r===Number.NEGATIVE_INFINITY?1:r]},e.prototype.getExtent=function(t,i){var e=i.getByAxisSide(this.side),n=void 0;if(this.isAbscissas()){var o=i.getVisibleDatasets(),r=i.getAbsKey();n=this.getExtentForDatasets(t,function(t){return o.indexOf(t)>-1},function(t){return[t[r],t[r]]})}else{var s=i.getSeriesAndDatasetBySide(this.side),a=s.datasetsForSide,c=s.seriesForDataset;n=this.getExtentForDatasets(t,function(t){return a.indexOf(t)>-1},function(t,i){var e=c[i].map(function(i){return t[i.key.y1]}),n=c[i].map(function(i){return t[i.key.y0]||t[i.key.y1]});return[d3.min(n),d3.max(e)]},i.getByAxisSide(this.side).includeZero)}return void 0!==e.min&&(n[0]=e.min),void 0!==e.max&&(n[1]=e.max),n},e.prototype.isAbscissas=function(){return-1!==[t.Options.AxisOptions.SIDE.X,t.Options.AxisOptions.SIDE.X2].indexOf(this.side)},e.prototype.isInLastHalf=function(t){var i=function(t){return t};t instanceof Date&&(i=function(t){return t.getTime()});var e=this._scale.domain(),n=e[0],o=e[1];return i(t)>i(n)+(i(o)-i(n))/2},e.prototype.createAxis=function(t){this.svg=t.append("g").attr("class","axis "+this.side+"-axis")},e.prototype.updateAxisOrientation=function(i){this.isAbscissas()?this.side===t.Options.AxisOptions.SIDE.X?i.orient("bottom"):i.orient("top"):this.side===t.Options.AxisOptions.SIDE.Y?i.orient("left"):i.orient("right")},e.prototype.updateAxisContainer=function(i){this.isAbscissas()?this.side===t.Options.AxisOptions.SIDE.X?this.svg.attr("transform","translate(0, "+i.innerHeight+")"):this.svg.attr("transform","translate(0, 0)"):this.side===t.Options.AxisOptions.SIDE.Y?this.svg.attr("transform","translate(0, 0)"):this.svg.attr("transform","translate("+i.innerWidth+", 0)"),this.softUpdate()},e.prototype.destroyAxis=function(){this.svg.remove()},e.prototype.invert=function(t){return this._scale.invert(t)},e.prototype.isTimeAxis=function(){return this.options.type===t.Options.AxisOptions.TYPE.DATE},e.prototype.getScale=function(){return this.options&&this.options.type===t.Options.AxisOptions.TYPE.DATE?d3.time.scale():this.options&&this.options.type===t.Options.AxisOptions.TYPE.LOG?d3.scale.log():d3.scale.linear()},e.prototype.getAxis=function(i,e){var n;return n=e.hasDynamicTicks()?t.svg.twoSpeedAxis().scale(i):d3.svg.axis().scale(i),e.configure(n),n},e.prototype.cloneAxis=function(){var i;return i=this.options&&this.options.hasDynamicTicks()?t.svg.twoSpeedAxis().ticks(this.d3axis.ticks()):d3.svg.axis().ticks(this.d3axis.ticks()[0]),i.scale(this.d3axis.scale()).orient(this.d3axis.orient()).tickValues(this.d3axis.tickValues()).tickSize(this.d3axis.tickSize())},e}(i.BaseFactory);i.Axis=e}(i=t.Factory||(t.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var i;!function(t){"use strict";var i=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.prototype.create=function(){this.svg=this.factoryMgr.get("container").axes.insert("g",":first-child").attr("class","grid"),this.svg.append("g").classed("x-grid",!0),this.svg.append("g").classed("y-grid",!0),this.eventMgr.on("resize."+this.key,this.softUpdate.bind(this)),this.eventMgr.on("pan."+this.key,this.softUpdate.bind(this)),this.eventMgr.on("zoom-end."+this.key,this.softUpdate.bind(this)),this.eventMgr.on("outer-world-domain-change."+this.key,this.softUpdate.bind(this))},i.prototype.softUpdate=function(){var t=this.factoryMgr.get("container"),i=t.getDimensions();
if(this.xAxis){var e=this.svg.select(".x-grid");this.factoryMgr.get("transitions").isOn()&&(e=e.transition().call(this.factoryMgr.getBoundFunction("transitions","edit"))),e.attr("transform","translate(0, "+i.innerHeight+")").call(this.xAxis.tickSize(-i.innerHeight,0))}if(this.yAxis){var e=this.svg.select(".y-grid");this.factoryMgr.get("transitions").isOn()&&(e=e.transition().call(this.factoryMgr.getBoundFunction("transitions","edit"))),e.call(this.yAxis.tickSize(-i.innerWidth,0))}},i.prototype.update=function(t,i){var e=this.factoryMgr.get("container"),n=e.getDimensions();i.grid.x&&(this.xAxis=this.factoryMgr.get("x-axis").cloneAxis().tickSize(-n.innerHeight,0),this.svg.select(".x-grid").transition().call(this.factoryMgr.getBoundFunction("transitions","edit")).attr("transform","translate(0, "+n.innerHeight+")").call(this.xAxis)),i.grid.y&&(this.yAxis=this.factoryMgr.get("y-axis").cloneAxis(),this.svg.select(".y-grid").transition().call(this.factoryMgr.getBoundFunction("transitions","edit")).call(this.yAxis.tickSize(-n.innerWidth,0)))},i.prototype.destroy=function(){this.svg.remove()},i}(t.BaseFactory);t.Grid=i}(i=t.Factory||(t.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var i;!function(t){"use strict";var i=function(t){function i(){t.apply(this,arguments),this.isActive=!1}return __extends(i,t),i.prototype.create=function(){this.rect=this.factoryMgr.get("container").svg.append("rect").attr("class","chart-brush")},i.prototype.constrainOutgoingDomains=function(t){this.zoomOnX||delete t.x,this.zoomOnY||delete t.y},i.prototype.update=function(t,i){var e=this.factoryMgr.get("container").getDimensions(),n=e.margin,o=n.left,r=n.top;this.zoomOnX=i.zoom.x,this.zoomOnY=i.zoom.y,(this.zoomOnX||this.zoomOnY)&&(this.xStartFn=this.zoomOnX?function(t){return t}:function(t){return o},this.xEndFn=this.zoomOnX?function(t){return t}:function(t){return e.innerWidth+o},this.yStartFn=this.zoomOnY?function(t){return t}:function(t){return r},this.yEndFn=this.zoomOnY?function(t){return t}:function(t){return e.innerHeight+r},this.registerEvents(this.factoryMgr.get("container")))},i.prototype.show=function(t){var i=t.xStart,e=t.xEnd,n=t.yStart,o=t.yEnd;r=i>e?[e,i]:[i,e],i=r[0],e=r[1],s=n>o?[o,n]:[n,o],n=s[0],o=s[1],this.rect.attr({x:i,width:e-i,y:n,height:o-n}).style("opacity","1");var r,s},i.prototype.hide=function(){this.rect.style("opacity","0")},i.prototype.updateAxes=function(t){var i=t.xStart,e=t.xEnd,n=t.yStart,o=t.yEnd;d=i>e?[e,i]:[i,e],i=d[0],e=d[1],f=n>o?[o,n]:[n,o],n=f[0],o=f[1];var r=this.factoryMgr.get("container").getDimensions(),s=r.margin,a=s.left,c=s.top,u=this.factoryMgr.get("x-axis"),p=this.factoryMgr.get("x2-axis");u.setDomain([u.invert(i-a),u.invert(e-a)]),p.setDomain(u.getDomain());var h=this.factoryMgr.get("y-axis"),l=this.factoryMgr.get("y2-axis");h.setDomain([h.invert(o-c),h.invert(n-c)]),l.setDomain([l.invert(o-c),l.invert(n-c)]);var d,f},i.prototype.registerEvents=function(t){var i,e,n,o,r,s=this,a=function(t){return t+"."+s.key},c=function(){s.isActive=!1,s.hide(),void 0!==e&&void 0!==o&&(s.updateAxes({xStart:i,xEnd:e,yStart:n,yEnd:o}),s.eventMgr.trigger("zoom-end"),i=e=n=o=void 0,r()),s.eventMgr.on(a("window-mouseup"),null)};t.svg.on(a("mousedown"),function(){var t=d3.event;t.altKey&&(r=s.factoryMgr.turnFactoriesOff(["tooltip"]),s.isActive=!0,s.eventMgr.on(a("window-mouseup"),c),e=d3.mouse(t.currentTarget),i=e[0],n=e[1],i=s.xStartFn(i),n=s.yStartFn(n));var e}).on(a("mousemove"),function(){s.isActive&&(t=d3.mouse(d3.event.currentTarget),e=t[0],o=t[1],e=s.xEndFn(e),o=s.yEndFn(o),s.show({xStart:i,xEnd:e,yStart:n,yEnd:o}),s.eventMgr.trigger("zoom"));var t})},i}(t.BaseFactory);t.Zoom=i}(i=t.Factory||(t.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var i;!function(t){"use strict";var i=function(t){function i(){t.apply(this,arguments),this.isActive=!1,this.hasMoved=!1}return __extends(i,t),i.prototype.constrainOutgoingDomains=function(t){this.panOnX||delete t.x,this.panOnY||delete t.y},i.prototype.move=function(t,i){if(0!==t){var e=this.factoryMgr.get("x-axis"),n=this.factoryMgr.get("x2-axis");e.setDomain(e.range().map(function(i){return i+t}).map(e.invert,e)),n.setDomain(e.getDomain())}if(0!==i){var o=this.factoryMgr.get("y-axis"),r=this.factoryMgr.get("y2-axis");o.setDomain(o.range().map(function(t){return t+i}).map(o.invert,o)),r.setDomain(r.range().map(function(t){return t+i}).map(r.invert,r))}},i.prototype.update=function(t,i){var e=this;this.panOnX=i.pan.x,this.panOnY=i.pan.y;var n,o,r,s=this.factoryMgr.get("container"),a=function(t){return t+"."+e.key},c=function(){e.hasMoved&&e.eventMgr.trigger("pan-end"),r&&r(),e.isActive=e.hasMoved=!1,r=void 0,e.eventMgr.on(a("window-mouseup"),null),e.eventMgr.on(a("window-mousemove"),null)},u=function(){if(e.isActive){var t=d3.mouse(s.svg.node()),i=t[0],a=t[1],c=e.panOnX?n-i:0,u=e.panOnY?o-a:0;0===c&&0===u||(r||(r=e.factoryMgr.turnFactoriesOff(["tooltip","transitions"])),e.hasMoved=!0,e.move(c,u),e.eventMgr.trigger("pan")),p=[i,a],n=p[0],o=p[1]}var p};s.svg.on(a("mousedown"),function(){var t=d3.event;t.altKey||(e.isActive=!0,i=d3.mouse(t.currentTarget),n=i[0],o=i[1],e.eventMgr.on(a("window-mouseup"),c),e.eventMgr.on(a("window-mousemove"),u));var i})},i}(t.BaseFactory);t.Pan=i}(i=t.Factory||(t.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var i;!function(t){"use strict";var i=function(t){function i(){t.apply(this,arguments),this.duration=i.defaultDuration,this.ease="cubic"}return __extends(i,t),i.prototype.off=function(){t.prototype.off.call(this),this.duration=0},i.prototype.on=function(){t.prototype.on.call(this),this.duration=i.defaultDuration},i.prototype.enter=function(t){var i=this.duration,e=this.ease,n=t[0].length,o=function(t,e){return n?e/n*i:0};t.duration(i).delay(o).ease(e)},i.prototype.edit=function(t){var i=this.duration,e=this.ease,n=0;t.duration(i).delay(n).ease(e)},i.prototype.exit=function(t){var i=this.duration,e=this.ease,n=0;t.duration(i).delay(n).ease(e)},i.defaultDuration=250,i}(t.BaseFactory);t.Transition=i}(i=t.Factory||(t.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var i;!function(i){var e;!function(i){"use strict";var e=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.prototype.create=function(){this.createContainer(this.factoryMgr.get("container").data),this.eventMgr.on("data-update."+this.type,this.update.bind(this)),this.eventMgr.on("pan."+this.type,this.softUpdate.bind(this)),this.eventMgr.on("zoom-end."+this.type,this.softUpdate.bind(this)),this.eventMgr.on("outer-world-domain-change."+this.key,this.softUpdate.bind(this)),this.eventMgr.on("resize."+this.type,this.softUpdate.bind(this))},i.prototype.update=function(t,i){this.data=t,this.options=i,this.softUpdate()},i.prototype.getAxes=function(t){return{xAxis:this.factoryMgr.get("x-axis"),yAxis:this.factoryMgr.get(t.axis+"-axis")}},i.prototype.softUpdate=function(){var t=this.options.getSeriesByType(this.type).filter(function(t){return t.visible});this.updateSeriesContainer(t)},i.prototype.destroy=function(){this.svg.remove()},i.prototype.createContainer=function(t){this.svg=t.append("g").attr("class",this.type+i.containerClassSuffix)},i.prototype.updateSeriesContainer=function(t){var e=this,n=this.svg.selectAll("."+this.type+i.seriesClassSuffix).data(t,function(t){return t.id});n.enter().append("g").attr({"class":function(t){return e.type+i.seriesClassSuffix+" "+t.id}}),this.styleSeries(n),this.updateSeries(n,t),n.exit().remove()},i.prototype.updateSeries=function(t,i){var e=this;t.each(function(t,n){var o=d3.select(this);e.updateData(o,t,n,i.length)})},i.prototype.updateData=function(t,i,e,n){},i.prototype.styleSeries=function(t){},i.containerClassSuffix="-data",i.seriesClassSuffix="-series",i}(t.Factory.BaseFactory);i.SeriesFactory=e}(e=i.Series||(i.Series={}))}(i=t.Factory||(t.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var i;!function(i){var e;!function(e){"use strict";var n=function(i){function e(){i.apply(this,arguments),this.type=t.Options.SeriesOptions.TYPE.DOT}return __extends(e,i),e.prototype.updateData=function(t,i,e,n){var o=this.getAxes(i),r=o.xAxis,s=o.yAxis,a=this.data.getDatasetValues(i,this.options).filter(i.defined),c=2,u=t.selectAll("."+this.type).data(a,function(t){return""+t.x}),p=function(t){t.attr({r:function(t){return c},cx:function(t){return r.scale(t.x)},cy:function(t){return s.range()[0]}})},h=function(t){t.attr({cx:function(t){return r.scale(t.x)},cy:function(t){return s.scale(t.y1)}}).style("opacity",i.visible?1:0)};this.factoryMgr.get("transitions").isOn()?(u.enter().append("circle").attr("class",this.type).call(this.eventMgr.datumEnter(i,this.options)).call(this.eventMgr.datumOver(i,this.options)).call(this.eventMgr.datumMove(i,this.options)).call(this.eventMgr.datumLeave(i,this.options)).call(p).transition().call(this.factoryMgr.getBoundFunction("transitions","enter")).call(h),u.transition().call(this.factoryMgr.getBoundFunction("transitions","edit")).call(h),u.exit().transition().call(this.factoryMgr.getBoundFunction("transitions","exit")).call(p).each("end",function(){d3.select(this).remove()})):(u.enter().append("circle").attr("class",this.type).call(this.eventMgr.datumEnter(i,this.options)).call(this.eventMgr.datumOver(i,this.options)).call(this.eventMgr.datumMove(i,this.options)).call(this.eventMgr.datumLeave(i,this.options)).call(h),u.call(h),u.exit().remove())},e.prototype.styleSeries=function(t){t.style({stroke:function(t){return t.color}})},e}(i.Series.SeriesFactory);e.Dot=n}(e=i.Series||(i.Series={}))}(i=t.Factory||(t.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var i;!function(i){var e;!function(e){"use strict";var n=function(i){function e(){i.apply(this,arguments),this.type=t.Options.SeriesOptions.TYPE.LINE}return __extends(e,i),e.prototype.updateData=function(t,i,e,n){t.classed("dashed",i.isDashed());var o=this.getAxes(i),r=o.xAxis,s=o.yAxis,a=this.data.getDatasetValues(i,this.options),c=d3.svg.line().defined(i.defined).x(function(t){return r.scale(t.x)}).y(s.range()[0]).interpolate(i.interpolation.mode).tension(i.interpolation.tension),u=d3.svg.line().defined(i.defined).x(function(t){return r.scale(t.x)}).y(function(t){return s.scale(t.y1)}).interpolate(i.interpolation.mode).tension(i.interpolation.tension),p=t.selectAll("."+this.type).data([a]);this.factoryMgr.get("transitions").isOn()?(p.enter().append("path").attr("class",this.type).attr("d",function(t){return c(t)}).transition().call(this.factoryMgr.getBoundFunction("transitions","enter")).attr("d",function(t){return u(t)}),p.transition().call(this.factoryMgr.getBoundFunction("transitions","edit")).attr("d",function(t){return u(t)}).style("opacity",i.visible?1:0),p.exit().transition().call(this.factoryMgr.getBoundFunction("transitions","exit")).attr("d",function(t){return c(t)}).each("end",function(){d3.select(this).remove()})):(p.enter().append("path").attr("class",this.type).attr("d",function(t){return u(t)}),p.attr("d",function(t){return u(t)}).style("opacity",i.visible?1:0),p.exit().remove())},e.prototype.styleSeries=function(t){t.style({fill:"none",stroke:function(t){return t.color},"stroke-dasharray":function(t){return t.isDashed()?"10,3":void 0}})},e}(i.Series.SeriesFactory);e.Line=n}(e=i.Series||(i.Series={}))}(i=t.Factory||(t.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var i;!function(i){var e;!function(e){"use strict";var n=function(i){function e(){i.apply(this,arguments),this.type=t.Options.SeriesOptions.TYPE.AREA}return __extends(e,i),e.prototype.updateData=function(t,i,e,n){var o=this.getAxes(i),r=o.xAxis,s=o.yAxis,a=this.data.getDatasetValues(i,this.options),c=d3.svg.area().defined(i.defined).x(function(t){return r.scale(t.x)}).y0(s.range()[0]).y1(s.range()[0]).interpolate(i.interpolation.mode).tension(i.interpolation.tension),u=d3.svg.area().defined(i.defined).x(function(t){return r.scale(t.x)}).y0(function(t){return isNaN(s.scale(t.y0))?s.range()[0]:s.scale(t.y0)}).y1(function(t){return s.scale(t.y1)}).interpolate(i.interpolation.mode).tension(i.interpolation.tension),p=t.selectAll("."+this.type).data([a]);this.factoryMgr.get("transitions").isOn()?(p.enter().append("path").attr("class",this.type).attr("d",function(t){return c(t)}).transition().call(this.factoryMgr.getBoundFunction("transitions","enter")).attr("d",function(t){return u(t)}),p.transition().call(this.factoryMgr.getBoundFunction("transitions","edit")).attr("d",function(t){return u(t)}).style("opacity",i.visible?1:0),p.exit().transition().call(this.factoryMgr.getBoundFunction("transitions","exit")).attr("d",function(t){return c(t)}).each("end",function(){d3.select(this).remove()})):(p.enter().append("path").attr("class",this.type).attr("d",function(t){return u(t)}),p.attr("d",function(t){return u(t)}).style("opacity",i.visible?1:0),p.exit().remove())},e.prototype.styleSeries=function(t){t.style({fill:function(t){return t.color},stroke:function(t){return t.color}})},e}(i.Series.SeriesFactory);e.Area=n}(e=i.Series||(i.Series={}))}(i=t.Factory||(t.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var i;!function(i){var e;!function(e){"use strict";var n=function(i){function e(){i.apply(this,arguments),this.type=t.Options.SeriesOptions.TYPE.COLUMN,this.gapFactor=.2,this.outerPadding=this.gapFactor/2*3,this.columnsWidth=0}return __extends(e,i),e.prototype.softUpdate=function(){var t=this.options.getSeriesByType(this.type).filter(function(t){return t.visible});this.updateColumnsWidth(t,this.options),this.updateColumnScale(t,this.options),this.updateSeriesContainer(t)},e.prototype.update=function(t,i){this.data=t,this.options=i;var e=i.getSeriesByType(this.type).filter(function(t){return t.visible});this.updateColumnsWidth(e,i),this.updateColumnScale(e,i),this.updateSeriesContainer(e)},e.prototype.updateColumnsWidth=function(i,e){var n=this.factoryMgr.get("x-axis"),o=this.data.getDatasets(i,e),r=t.Utils.Data.getMinDistance(o,n,"x");this.columnsWidth=r<Number.MAX_VALUE?r/i.length:10},e.prototype.updateColumnScale=function(t,i){var e=this.columnsWidth*t.length/2;this.innerXScale=d3.scale.ordinal().domain(t.map(function(t){return t.id})).rangeBands([-e,e],0,.1)},e.prototype.getTooltipPosition=function(t){return this.innerXScale(t.id)+this.innerXScale.rangeBand()/2},e.prototype.updateData=function(t,i,e,n){var o=this,r=this.getAxes(i),s=r.xAxis,a=r.yAxis,c=this.data.getDatasetValues(i,this.options).filter(i.defined),u=function(t){return s.scale(t.x)+o.innerXScale(i.id)},p=function(t){t.attr({x:u,y:function(t){return a.scale(t.y0)},width:o.innerXScale.rangeBand(),height:0})},h=function(t){t.attr({x:u,y:function(t){return t.y1>0?a.scale(t.y1):a.scale(t.y0)},width:o.innerXScale.rangeBand(),height:function(t){return Math.abs(a.scale(t.y0)-a.scale(t.y1))}}).style("opacity",i.visible?1:0)},l=t.selectAll("."+this.type).data(c,function(t){return""+t.x});this.factoryMgr.get("transitions").isOn()?(l.enter().append("rect").attr("class",this.type).call(this.eventMgr.datumEnter(i,this.options)).call(this.eventMgr.datumOver(i,this.options)).call(this.eventMgr.datumMove(i,this.options)).call(this.eventMgr.datumLeave(i,this.options)).call(p).transition().call(this.factoryMgr.getBoundFunction("transitions","enter")).call(h),l.transition().call(this.factoryMgr.getBoundFunction("transitions","edit")).call(h),l.exit().transition().call(this.factoryMgr.getBoundFunction("transitions","exit")).call(p).each("end",function(){d3.select(this).remove()})):(l.enter().append("rect").attr("class",this.type).call(this.eventMgr.datumEnter(i,this.options)).call(this.eventMgr.datumOver(i,this.options)).call(this.eventMgr.datumMove(i,this.options)).call(this.eventMgr.datumLeave(i,this.options)).call(h),l.call(h),l.exit().remove())},e.prototype.styleSeries=function(t){t.style({fill:function(t){return t.color},stroke:function(t){return t.color},"stroke-width":1})},e}(i.Series.SeriesFactory);e.Column=n}(e=i.Series||(i.Series={}))}(i=t.Factory||(t.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var i;!function(t){"use strict";var i=function(t){function i(i,e,n){t.call(this),this.scope=i,this.attributes=e,this.$parse=n}return __extends(i,t),i.prototype.create=function(){this.unregisteringFunctions=[],this.sanitizeAttributes(),this.syncTooltips(),this.syncDomainsChange(),this.syncDatumEvents()},i.prototype.sanitizeAttributes=function(){var t=this.attributes,i=t.tooltipSyncKey,e=t.domainsSyncKey;if(i&&e&&i===e)throw new Error("Heterogeneous sync keys can't have the same value.")},i.prototype.syncDatumEvents=function(){var t=this,i=this.eventMgr;if(this.attributes.onClick){var e=this.$parse(this.attributes.onClick);i.on("click.directive",function(i,n,o,r){e(t.scope.$parent,{row:i,index:n,series:o,options:r})})}},i.prototype.syncTooltips=function(){var t=this,i=this.eventMgr;this.attributes.tooltipSyncKey&&(this.unregisteringFunctions.push(this.scope.$root.$on(this.attributes.tooltipSyncKey,function(t,e){i.triggerDataAndOptions("outer-world-hover",e)})),i.on("container-move.directive",function(i){t.scope.$emit(t.attributes.tooltipSyncKey,t.factoryMgr.get("container").getCoordinatesFromEvent(i))}),i.on("container-out.directive",function(){t.scope.$emit(t.attributes.tooltipSyncKey,{x:void 0,y:void 0})}))},i.prototype.syncDomainsChange=function(){var t=this,i=this.eventMgr,e=[],n=this.factoryMgr.get("x-axis"),o=this.factoryMgr.get("y-axis");if(this.attributes.onDomainsChange){var r=this.$parse(this.attributes.onDomainsChange);e.push(function(i,e){var n=e.isEndEvent;n&&r(t.scope.$parent,{$domains:i})})}this.attributes.domainsSyncKey&&(this.unregisteringFunctions.push(this.scope.$root.$on(this.attributes.domainsSyncKey,function(e,r,s){e.targetScope!==t.scope&&(r.x&&r.y||(r=angular.copy(r)),r.x||(r.x=n.getScaleDomain()),r.y||(r.y=o.getScaleDomain()),"zoom-end"===s?(i.trigger("outer-world-domain-change",r),t.factoryMgr.turnFactoriesOn(["tooltip"])):"zoom"===s?t.factoryMgr.turnFactoriesOff(["tooltip"]):"pan"===s||"pan-end"===s?(t.factoryMgr.turnFactoriesOff(["transitions","tooltip"]),i.trigger("outer-world-domain-change",r),"pan-end"===s&&t.factoryMgr.turnFactoriesOn(["transitions","tooltip"])):"zoom-pan-reset"===s&&i.trigger("zoom-pan-reset",!1))})),e.push(function(i,e){var n=e.type;t.scope.$emit(t.attributes.domainsSyncKey,i,n)}));var s=function(){return{x:n.getScaleDomain(),y:o.getScaleDomain()}},a=function(t,i){return e.forEach(function(e){return e(t,i)})};i.on("pan.directive",function(){var i=s();t.factoryMgr.get("pan").constrainOutgoingDomains(i),a(i,{type:"pan"})}),i.on("pan-end.directive",function(){var i=s();t.factoryMgr.get("pan").constrainOutgoingDomains(i),a(i,{type:"pan-end",isEndEvent:!0})}),i.on("zoom.directive",function(){var i=s();t.factoryMgr.get("zoom").constrainOutgoingDomains(i),a(i,{type:"zoom",isEndEvent:!1})}),i.on("zoom-end.directive",function(){var i=s();t.factoryMgr.get("zoom").constrainOutgoingDomains(i),a(i,{type:"zoom-end",isEndEvent:!0})}),i.on("zoom-pan-reset.directive",function(t){t&&a(s(),{type:"zoom-pan-reset",isEndEvent:!0})})},i.prototype.destroy=function(){for(var t;t=this.unregisteringFunctions.pop();)t()},i}(t.BaseFactory);t.SyncLayer=i}(i=t.Factory||(t.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){"use strict";var i=function(){function i(i,e,n,o){var r=this;this.$window=i,this.$parse=e,this.$timeout=n,this.$rootScope=o,this.scope={data:"=",options:"=",styles:"=",hoveredCoordinates:"="},this.restrict="E",this.replace=!0,this.template="<div></div>",this.link=function(i,e,n){var o,s,a=new t.Utils.EventManager,c=new t.Utils.FactoryManager;a.init(t.Utils.EventManager.EVENTS),c.registerMany([["container",t.Factory.Container,e[0]],["tooltip",t.Factory.Tooltip,e[0]],["legend",t.Factory.Legend,e[0]],["transitions",t.Factory.Transition],["x-axis",t.Factory.Axis,t.Options.AxisOptions.SIDE.X],["x2-axis",t.Factory.Axis,t.Options.AxisOptions.SIDE.X2],["y-axis",t.Factory.Axis,t.Options.AxisOptions.SIDE.Y],["y2-axis",t.Factory.Axis,t.Options.AxisOptions.SIDE.Y2],["grid",t.Factory.Grid],["pan",t.Factory.Pan],["zoom",t.Factory.Zoom],["sync-layer",t.Factory.SyncLayer,i,n,r.$parse],["series-area",t.Factory.Series.Area],["series-column",t.Factory.Series.Column],["series-line",t.Factory.Series.Line],["series-dot",t.Factory.Series.Dot]]),c.all().forEach(function(t){return t.instance.init(t.key,a,c)});var u=void 0===i.options,p=function(){s=new t.Options.Options(angular.copy(i.options)),o=new t.Utils.Data(i.data),u&&(u=!1,a.trigger("create",s)),a.update(o,s),a.trigger("update",o,s)};u||a.trigger("create",new t.Options.Options(angular.copy(i.options)));var h=function(t){t&&(o.fromJS(t),c.turnFactoriesOff(["transitions"]),a.trigger("data-update",o,s),c.turnFactoriesOn(["transitions"]),a.trigger("update",o,s))};i.$watch("options",p,!0),i.$watch("data",h,!0),a.on("legend-click.directive",function(t){var e=i.options.series.filter(function(i){return i.id===t.id})[0];e.visible=t.getToggledVisibility(),i.$apply()});var l=function(){if(!e||!e[0])return{};var t=e[0].parentElement.getBoundingClientRect();return{height:t.height,width:t.width,left:t.left,right:t.right,bottom:t.bottom,top:t.top}},d=t.Utils.FunctionUtils.debounce(function(){a.trigger("resize",e[0].parentElement)},50);i.$watch(l,d,!0);var f=t.Utils.FunctionUtils.debounce(function(){return i.$apply()},50);angular.element(r.$window).on("resize",f),i.$on("$destroy",function(){a.trigger("destroy"),angular.element(r.$window).off("resize",f)})}}return i}();t.LineChart=i}(n3Charts||(n3Charts={})),angular.module("n3-line-chart",[]).directive("linechart",["$window","$parse","$timeout","$rootScope",function(t,i,e,n){return new n3Charts.LineChart(t,i,e,n)}]);