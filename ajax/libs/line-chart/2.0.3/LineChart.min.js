var n3Charts;!function(n3Charts){"use strict";var LineChart=function(){function LineChart($window,$parse,$timeout,$rootScope){var _this=this;this.$window=$window,this.$parse=$parse,this.$timeout=$timeout,this.$rootScope=$rootScope,this.scope={data:"=",options:"=",styles:"=",hoveredCoordinates:"="},this.restrict="E",this.replace=!0,this.template="<div></div>",this.link=function(scope,element,attributes){var eventMgr=new n3Charts.Utils.EventManager,factoryMgr=new n3Charts.Utils.FactoryManager;eventMgr.init(n3Charts.Utils.EventManager.EVENTS),factoryMgr.registerMany([["container",n3Charts.Factory.Container,element[0]],["tooltip",n3Charts.Factory.Tooltip,element[0]],["legend",n3Charts.Factory.Legend,element[0]],["transitions",n3Charts.Factory.Transition],["x-axis",n3Charts.Factory.Axis,n3Charts.Utils.AxisOptions.SIDE.X],["y-axis",n3Charts.Factory.Axis,n3Charts.Utils.AxisOptions.SIDE.Y],["y2-axis",n3Charts.Factory.Axis,n3Charts.Utils.AxisOptions.SIDE.Y2],["grid",n3Charts.Factory.Grid],["zoom",n3Charts.Factory.Zoom],["series-area",n3Charts.Factory.Series.Area],["series-column",n3Charts.Factory.Series.Column],["series-line",n3Charts.Factory.Series.Line],["series-dot",n3Charts.Factory.Series.Dot]]),factoryMgr.all().forEach(function(f){return f.instance.init(f.key,eventMgr,factoryMgr)});var data,options,deferredCreation=void 0===scope.options,update=function(){options=new n3Charts.Utils.Options(angular.copy(scope.options)),data=new n3Charts.Utils.Data(angular.copy(scope.data)),deferredCreation&&(deferredCreation=!1,eventMgr.trigger("create",options),eventMgr.trigger("resize",element[0].parentElement)),eventMgr.update(data,options),eventMgr.trigger("update",data,options)};deferredCreation||(eventMgr.trigger("create",new n3Charts.Utils.Options(angular.copy(scope.options))),eventMgr.trigger("resize",element[0].parentElement)),scope.$watch("[options, data]",update,!0),eventMgr.on("legend-click.directive",function(series){var foundSeries=scope.options.series.filter(function(s){return s.id===series.id})[0];foundSeries.visible=series.getToggledVisibility(),scope.$apply()}),attributes.syncKey&&(_this.$rootScope.$on(attributes.syncKey,function(event,value){data&&options&&factoryMgr.get("tooltip").showFromCoordinates(value,data,options)}),eventMgr.on("container-move.directive",function(event){scope.$emit(attributes.syncKey,factoryMgr.get("container").getCoordinatesFromEvent(event))}),eventMgr.on("container-out.directive",function(){scope.$emit(attributes.syncKey,{x:void 0,y:void 0})})),scope.elementDimensions={};var $timeout=_this.$timeout,debounce=function(callback,interval){var t=null;return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i-0]=arguments[_i];$timeout.cancel(t),t=$timeout(function(){return callback.apply(_this,args)},interval)}},resizeCb=debounce(function(event){var rect=element[0].parentElement.getBoundingClientRect();scope.elementDimensions.height=rect.height,scope.elementDimensions.width=rect.width,scope.elementDimensions.left=rect.left,scope.elementDimensions.right=rect.right,scope.elementDimensions.bottom=rect.bottom,scope.elementDimensions.top=rect.top,scope.$apply()},50);angular.element(_this.$window).on("resize",resizeCb),scope.$watch("elementDimensions",function(){eventMgr.trigger("resize",element[0].parentElement),update()},!0),scope.$on("$destroy",function(){eventMgr.trigger("destroy"),angular.element(_this.$window).off()})}}return LineChart}();n3Charts.LineChart=LineChart}(n3Charts||(n3Charts={}));var n3Charts;!function(n3Charts){var Utils;!function(Utils){"use strict";var EventManager=function(){function EventManager(){}return EventManager.prototype.init=function(events){return this._dispatch=d3.dispatch.apply(this,events),this},EventManager.prototype.update=function(data,options){this.data=data,this.options=options},EventManager.prototype.on=function(event,callback){return this._dispatch.on(event,callback),this},EventManager.prototype.trigger=function(event){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];return this._dispatch[event].apply(this,args),this},EventManager.prototype.triggerDataAndOptions=function(event){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];return args.push(this.data),args.push(this.options),this._dispatch[event].apply(this,args),this},EventManager.prototype.datumEnter=function(series,options){var _this=this;return function(selection){return selection.on("mouseenter",function(d,i){_this.trigger("enter",d,i,series,options)})}},EventManager.prototype.datumOver=function(series,options){var _this=this;return function(selection){return selection.on("mouseover",function(d,i){_this.trigger("over",d,i,series,options)})}},EventManager.prototype.datumMove=function(series,options){var _this=this;return function(selection){return selection.on("mousemove",function(d,i){_this.trigger("over",d,i,series,options)})}},EventManager.prototype.datumLeave=function(series,options){var _this=this;return function(selection){return selection.on("mouseleave",function(d,i){_this.trigger("leave",d,i,series,options)})}},EventManager.EVENTS=["create","update","resize","destroy","enter","over","move","leave","click","dblclick","legend-click","legend-over","legend-out","container-over","container-move","container-out","focus","toggle","zoom"],EventManager}();Utils.EventManager=EventManager}(Utils=n3Charts.Utils||(n3Charts.Utils={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(n3Charts){var Utils;!function(Utils){"use strict";var FactoryManager=function(){function FactoryManager(){this._factoryStack=[]}return FactoryManager.prototype.index=function(factoryKey){return this._factoryStack.map(function(d){return d.key}).indexOf(factoryKey)},FactoryManager.prototype.get=function(factoryKey){var index=this.index(factoryKey);return index>-1?this._factoryStack[index].instance:null},FactoryManager.prototype.all=function(){return this._factoryStack},FactoryManager.prototype.registerMany=function(factories){var _this=this;return factories.forEach(function(factoryArgs){_this.register.apply(_this,factoryArgs)}),this},FactoryManager.prototype.register=function(key,constructor){for(var args=[],_i=2;_i<arguments.length;_i++)args[_i-2]=arguments[_i];var factory=constructor.bind.apply(constructor,[null].concat(args)),instance=new factory;return this._factoryStack.push({key:key,instance:instance}),instance},FactoryManager.prototype.unregister=function(factoryKey){var index=this.index(factoryKey);return index>-1&&delete this._factoryStack[index],this},FactoryManager}();Utils.FactoryManager=FactoryManager}(Utils=n3Charts.Utils||(n3Charts.Utils={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(n3Charts){var Utils;!function(Utils){"use strict";var BaseFactory=function(){function BaseFactory(){}return BaseFactory.prototype.init=function(key,eventMgr,factoryMgr){this.key=key,this.eventMgr=eventMgr,this.factoryMgr=factoryMgr,this.eventMgr.on("create."+this.key,this.create.bind(this)),this.eventMgr.on("update."+this.key,this.update.bind(this)),this.eventMgr.on("destroy."+this.key,this.destroy.bind(this))},BaseFactory.prototype.create=function(options){},BaseFactory.prototype.update=function(data,options){},BaseFactory.prototype.destroy=function(){},BaseFactory}();Utils.BaseFactory=BaseFactory}(Utils=n3Charts.Utils||(n3Charts.Utils={}))}(n3Charts||(n3Charts={}));var __extends=this&&this.__extends||function(d,b){function __(){this.constructor=d}for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p]);d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)},n3Charts;!function(n3Charts){var Utils;!function(Utils){"use strict";var SeriesFactory=function(_super){function SeriesFactory(){_super.apply(this,arguments)}return __extends(SeriesFactory,_super),SeriesFactory.prototype.update=function(data,options){this.data=data,this.options=options,this.softUpdate()},SeriesFactory.prototype.softUpdate=function(){var series=this.options.getSeriesByType(this.type).filter(function(s){return s.visible});this.updateSeriesContainer(series)},SeriesFactory.prototype.create=function(){this.createContainer(this.factoryMgr.get("container").data),this.eventMgr.on("zoom."+this.type,this.softUpdate.bind(this))},SeriesFactory.prototype.destroy=function(){this.svg.remove()},SeriesFactory.prototype.createContainer=function(parent){this.svg=parent.append("g").attr("class",this.type+SeriesFactory.containerClassSuffix)},SeriesFactory.prototype.updateSeriesContainer=function(series){var _this=this,groups=this.svg.selectAll("."+this.type+SeriesFactory.seriesClassSuffix).data(series,function(d){return d.id});groups.enter().append("g").attr({"class":function(d){return _this.type+SeriesFactory.seriesClassSuffix+" "+d.id}}),this.styleSeries(groups),this.updateSeries(groups,series),groups.exit().remove()},SeriesFactory.prototype.updateSeries=function(groups,series){var self=this;groups.each(function(d,i){var group=d3.select(this);self.updateData(group,d,i,series.length)})},SeriesFactory.prototype.updateData=function(group,series,index,numSeries){},SeriesFactory.prototype.styleSeries=function(group){},SeriesFactory.containerClassSuffix="-data",SeriesFactory.seriesClassSuffix="-series",SeriesFactory}(Utils.BaseFactory);Utils.SeriesFactory=SeriesFactory}(Utils=n3Charts.Utils||(n3Charts.Utils={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(n3Charts){var Utils;!function(Utils){"use strict";var Dataset=function(){function Dataset(values,id){this.fromJS(values,id)}return Dataset.prototype.fromJS=function(values,id){this.id=id,this.values=values},Dataset}();Utils.Dataset=Dataset}(Utils=n3Charts.Utils||(n3Charts.Utils={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(n3Charts){var Utils;!function(Utils){"use strict";var Data=function(){function Data(js){js&&this.fromJS(js)}return Data.prototype.fromJS=function(js){for(var key in js)js.hasOwnProperty(key)&&(js[key]=new Utils.Dataset(js[key],key));this.sets=js},Data.prototype.getDatasets=function(series,options){var _this=this;return series.map(function(d){return _this.getDatasetValues(d,options)})},Data.prototype.getDatasetValues=function(series,options){if(!this.sets||!this.sets[series.dataset].values)return[];var fn,xKey=options.getAbsKey();return fn=series.key.y0?function(d){return{x:d[xKey],y1:d[series.key.y1],y0:d[series.key.y0]}}:function(d){return{x:d[xKey],y1:d[series.key.y1],y0:0}},this.sets[series.dataset].values.map(fn)},Data.getMinDistance=function(data,scale,key,range){return void 0===key&&(key="x"),d3.min(data.map(function(series){return series.map(function(d){return scale(d[key])}).filter(function(d){return range?d>=range[0]&&d<=range[1]:!0}).reduce(function(prev,d,i,arr){var diff=i>0?d-arr[i-1]:Number.MAX_VALUE;return prev>diff?diff:prev},Number.MAX_VALUE)}))},Data}();Utils.Data=Data}(Utils=n3Charts.Utils||(n3Charts.Utils={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(n3Charts){var Utils;!function(Utils){"use strict";var SeriesOptions=function(){function SeriesOptions(js){void 0===js&&(js={}),this.axis="y",this.type=["line"],this.visible=!0,this.defined=function(v){return!0};var options=this.sanitizeOptions(js);this.id=options.id||Utils.Options.uuid(),this.axis=options.axis,this.interpolation=options.interpolation,this.dataset=options.dataset,this.key=options.key,this.color=options.color,this.visible=options.visible,this.label=options.label||options.id,options.defined&&(this.defined=options.defined),options.type.length>0&&(this.type=this.sanitizeType(options.type))}return SeriesOptions.prototype.sanitizeOptions=function(js){var options={};return angular.extend(options,this,js),options.axis=this.sanitizeAxis(options.axis),options.interpolation=this.sanitizeInterpolation(options.interpolation),options.id=Utils.Options.getString(options.id),options.type=Utils.Options.getArray(options.type),options.dataset=Utils.Options.getString(options.dataset),options.key=this.sanitizeKeys(options.key),options.color=Utils.Options.getString(options.color),options.label=Utils.Options.getString(options.label),options.visible=Utils.Options.getBoolean(options.visible),options.defined=Utils.Options.getFunction(options.defined),options},SeriesOptions.prototype.sanitizeInterpolation=function(js){return js?{mode:Utils.Options.getString(js.mode,"linear"),tension:Utils.Options.getNumber(js.tension,.7)}:{mode:"linear",tension:.7}},SeriesOptions.prototype.sanitizeKeys=function(js){return js?"string"==typeof js?{y1:Utils.Options.getString(js)}:{y0:Utils.Options.getString(js.y0),y1:Utils.Options.getString(js.y1)}:{y1:void 0}},SeriesOptions.prototype.getToggledVisibility=function(){return!this.visible},SeriesOptions.prototype.sanitizeType=function(types){return types.filter(function(type){return SeriesOptions.isValidType(type)?!0:(console.warn("Unknow series type : "+type),!1)})},SeriesOptions.prototype.sanitizeAxis=function(axis){if(-1===["y"].indexOf(axis))throw TypeError(axis+" is not a valid series option for axis.");return axis},SeriesOptions.prototype.isAColumn=function(){return this.hasType(SeriesOptions.TYPE.COLUMN)},SeriesOptions.prototype.isDashed=function(){return-1!==this.type.indexOf(SeriesOptions.TYPE.DASHED_LINE)},SeriesOptions.prototype.hasType=function(type){return type===SeriesOptions.TYPE.LINE?-1!==this.type.indexOf(type)||-1!==this.type.indexOf(SeriesOptions.TYPE.DASHED_LINE):-1!==this.type.indexOf(type)},SeriesOptions.prototype.hasTwoKeys=function(){return void 0!==this.key.y0},SeriesOptions.isValidType=function(type){return-1!==d3.values(SeriesOptions.TYPE).indexOf(type)},SeriesOptions.TYPE={DOT:"dot",LINE:"line",DASHED_LINE:"dashed-line",AREA:"area",COLUMN:"column"},SeriesOptions}();Utils.SeriesOptions=SeriesOptions}(Utils=n3Charts.Utils||(n3Charts.Utils={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(n3Charts){var Utils;!function(Utils){"use strict";var AxisOptions=function(){function AxisOptions(js){void 0===js&&(js={}),this.type="linear",this.key="x",this.ticksShift={x:0,y:0},this.parse(js)}return AxisOptions.prototype.parse=function(js){this.type=Utils.Options.getString(js.type,"linear"),this.key=js.key,this.tickFormat=Utils.Options.getFunction(js.tickFormat),this.ticks=js.ticks,js.ticksShift&&(this.ticksShift={x:Utils.Options.getNumber(js.ticksShift.x,0),y:Utils.Options.getNumber(js.ticksShift.y,0)}),this.type===AxisOptions.TYPE.LINEAR?(this.min=Utils.Options.getNumber(js.min,void 0),this.max=Utils.Options.getNumber(js.max,void 0)):this.type===AxisOptions.TYPE.DATE&&(this.min=Utils.Options.getDate(js.min,void 0),this.max=Utils.Options.getDate(js.max,void 0))},AxisOptions.isValidSide=function(side){return-1!==d3.values(AxisOptions.SIDE).indexOf(side)},AxisOptions.prototype.configure=function(axis){return axis.tickFormat(this.tickFormat),this.ticks instanceof Array?axis.tickValues(this.ticks):"number"==typeof this.ticks&&axis.ticks(this.ticks),axis},AxisOptions.SIDE={X:"x",Y:"y",Y2:"y2"},AxisOptions.TYPE={LINEAR:"linear",DATE:"date",LOG:"log"},AxisOptions}();Utils.AxisOptions=AxisOptions}(Utils=n3Charts.Utils||(n3Charts.Utils={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(n3Charts){var Utils;!function(Utils){"use strict";var Options=function(){function Options(js){this.series=[],this.pan={x:!1,y:!1},this.axes={x:{},y:{}},this.margin={top:0,left:40,bottom:40,right:40},this.grid={x:!1,y:!0};var options=this.sanitizeOptions(js);this.margin=options.margin,this.series=options.series,this.axes=options.axes,this.pan=options.pan,this.grid=options.grid,this.tooltipHook=options.tooltipHook}return Options.prototype.sanitizeOptions=function(js){var options={};return angular.extend(options,this,js),options.margin=this.sanitizeMargin(Options.getObject(options.margin,this.margin)),options.series=this.sanitizeSeries(Options.getArray(options.series)),options.axes=this.sanitizeAxes(Options.getObject(options.axes,this.axes)),options.grid=this.sanitizeTwoAxesOptions(options.grid,this.grid),options.pan=this.sanitizeTwoAxesOptions(options.pan,this.pan),options.tooltipHook=Options.getFunction(options.tooltipHook),options},Options.prototype.sanitizeMargin=function(margin){return{top:Options.getNumber(margin.top,0),left:Options.getNumber(margin.left,0),bottom:Options.getNumber(margin.bottom,0),right:Options.getNumber(margin.right,0)}},Options.prototype.sanitizeSeries=function(series){return series.map(function(s){return new Utils.SeriesOptions(s)})},Options.prototype.sanitizeTwoAxesOptions=function(object,def){var g={x:Options.getBoolean(object.x,def.x),y:Options.getBoolean(object.y,def.y)};return g},Options.prototype.sanitizeAxes=function(axes){return Object.keys(axes).reduce(function(prev,key){return prev[key]=new Utils.AxisOptions(axes[key]),prev},{})},Options.prototype.getAbsKey=function(){if(!this.axes[Utils.AxisOptions.SIDE.X])throw new TypeError("Cannot find abs key : "+Utils.AxisOptions.SIDE.X);return this.axes[Utils.AxisOptions.SIDE.X].key},Options.prototype.getVisibleDatasets=function(){var datasets=[];return this.series.forEach(function(series){series.visible&&-1===datasets.indexOf(series.dataset)&&datasets.push(series.dataset)}),datasets},Options.prototype.getSeriesAndDatasetBySide=function(side){if(!Utils.AxisOptions.isValidSide(side))throw new TypeError("Cannot get axis side : "+side);side!==Utils.AxisOptions.SIDE.Y2||this.axes[side]||(side=Utils.AxisOptions.SIDE.Y);var datasetsForSide=[],seriesForDataset={};return this.series.forEach(function(series){series.visible&&series.axis===side&&(datasetsForSide.push(series.dataset),seriesForDataset[series.dataset]||(seriesForDataset[series.dataset]=[]),seriesForDataset[series.dataset].push(series))}),{seriesForDataset:seriesForDataset,datasetsForSide:datasetsForSide}},Options.prototype.getByAxisSide=function(side){if(!Utils.AxisOptions.isValidSide(side))throw new TypeError("Cannot get axis side : "+side);return side!==Utils.AxisOptions.SIDE.Y2||this.axes[side]?this.axes[side]:this.axes[Utils.AxisOptions.SIDE.Y]},Options.prototype.getSeriesByType=function(type){if(!Utils.SeriesOptions.isValidType(type))throw new TypeError("Unknown series type: "+type);return this.series.filter(function(s){return s.hasType(type)})},Options.getBoolean=function(value,defaultValue){return void 0===defaultValue&&(defaultValue=!0),"boolean"==typeof value?value:defaultValue},Options.getNumber=function(value,defaultValue){var n=parseFloat(value);return isNaN(n)?defaultValue:n},Options.getDate=function(value,defaultValue){return value instanceof Date?value:defaultValue},Options.getFunction=function(value){return value instanceof Function?value:void 0},Options.getString=function(value,defaultValue){return value?String(value):defaultValue},Options.getIdentifier=function(value){var s=Options.getString(value);return s.replace(/[^a-zA-Z0-9\-_]/gi,"")},Options.getObject=function(value,defaultValue){if(void 0===defaultValue&&(defaultValue={}),!angular.isObject(value))throw TypeError(value+" option must be an object.");var obj={};return angular.extend(obj,defaultValue,value),obj},Options.getArray=function(value,defaultValue){return void 0===defaultValue&&(defaultValue=[]),defaultValue.concat(value)},Options.uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=16*Math.random()|0,v="x"===c?r:3&r|8;return v.toString(16)})},Options}();Utils.Options=Options}(Utils=n3Charts.Utils||(n3Charts.Utils={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(n3Charts){var Utils;!function(Utils){"use strict";var Dimensions=function(){function Dimensions(){this.width=600,this.height=200,this.innerWidth=560,this.innerHeight=160,this.margin={left:30,bottom:20,right:30,top:20}}return Dimensions.prototype.updateMargins=function(options){var _this=this;if(options&&options.margin){var fn=function(prop){return _this.margin[prop]=Utils.Options.getNumber(options.margin[prop],_this.margin[prop])};fn("top"),fn("bottom"),fn("left"),fn("right")}},Dimensions.prototype.getDimensionByProperty=function(element,propertyName){var style=window.getComputedStyle(element,null);return+style.getPropertyValue(propertyName).replace(/px$/,"")},Dimensions.prototype.fromParentElement=function(parent){var hPadding=this.getDimensionByProperty(parent,"padding-left")+this.getDimensionByProperty(parent,"padding-right"),vPadding=this.getDimensionByProperty(parent,"padding-top")+this.getDimensionByProperty(parent,"padding-bottom");this.width=parent.clientWidth-hPadding,this.height=parent.clientHeight-vPadding,this.innerHeight=this.height-this.margin.top-this.margin.bottom,this.innerWidth=this.width-this.margin.left-this.margin.right},Dimensions}();Utils.Dimensions=Dimensions}(Utils=n3Charts.Utils||(n3Charts.Utils={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(n3Charts){var Factory;!function(Factory){"use strict";var Container=function(_super){function Container(element){_super.call(this),this.element=element,this.dim=new n3Charts.Utils.Dimensions}return __extends(Container,_super),Container.prototype.create=function(options){this.dim.updateMargins(options),this.listenToElement(this.element,options),this.createRoot(),this.createContainer(),this.eventMgr.on("resize",this.dim.fromParentElement.bind(this.dim))},Container.prototype.listenToElement=function(element,options){var eventMgr=this.eventMgr;element.addEventListener("mouseover",function(event){eventMgr.triggerDataAndOptions.apply(eventMgr,["container-over",event])}),element.addEventListener("mousemove",function(event){eventMgr.triggerDataAndOptions.apply(eventMgr,["container-move",event])}),element.addEventListener("mouseout",function(event){eventMgr.triggerDataAndOptions.apply(eventMgr,["container-out",event])})},Container.prototype.getCoordinatesFromEvent=function(event){var dim=this.getDimensions(),_a=event.currentTarget.getBoundingClientRect(),left=_a.left,top=_a.top,xScale=this.factoryMgr.get("x-axis").scale,x=xScale.invert(event.clientX-left-dim.margin.left),yScale=this.factoryMgr.get("y-axis").scale,y=yScale.invert(event.clientY-top-dim.margin.top);return(y<yScale.domain()[0]||y>yScale.domain()[1])&&(y=void 0),(x<xScale.domain()[0]||x>xScale.domain()[1])&&(x=void 0),{y:y,x:x}},Container.prototype.update=function(datasets,options){this.updateRoot(),this.updateContainer()},Container.prototype.destroy=function(){this.destroyRoot()},Container.prototype.createRoot=function(){this.svg=d3.select(this.element).append("svg").attr("class","chart"),this.defs=this.svg.append("defs")},Container.prototype.updateRoot=function(){this.svg.attr("width",this.dim.width).attr("height",this.dim.height)},Container.prototype.destroyRoot=function(){this.svg.remove()},Container.prototype.createContainer=function(){this.vis=this.svg.append("g").attr("class","container"),this.axes=this.vis.append("g").attr("class","axes"),this.defs.append("svg:clipPath").attr("id","clipping-path").append("svg:rect").attr("id","clipping-rect"),this.data=this.vis.append("g").attr({"class":"data","clip-path":"url(#clipping-path)"}),this.overlay=this.vis.append("g").attr("class","overlay")},Container.prototype.updateContainer=function(){this.vis.attr({width:this.dim.innerWidth,height:this.dim.innerHeight,transform:"translate("+this.dim.margin.left+", "+this.dim.margin.top+")"}),d3.select(this.element).select("#clipping-rect").attr({width:this.dim.innerWidth,height:this.dim.innerHeight+this.dim.margin.top,transform:"translate(0, "+-this.dim.margin.top+")"})},Container.prototype.getDimensions=function(){return this.dim},Container}(n3Charts.Utils.BaseFactory);Factory.Container=Container}(Factory=n3Charts.Factory||(n3Charts.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(n3Charts){var Factory;!function(Factory){"use strict";var Tooltip=function(_super){function Tooltip(element){_super.call(this),this.element=element}return __extends(Tooltip,_super),Tooltip.prototype.create=function(){this.createTooltip(),this.eventMgr.on("container-move.tooltip",this.show.bind(this)),this.eventMgr.on("container-out.tooltip",this.hide.bind(this)),this.hide()},Tooltip.prototype.createTooltip=function(){var svg=this.svg=d3.select(this.element).append("div").attr("class","chart-tooltip");svg.append("div").attr("class","abscissas"),this.line=this.factoryMgr.get("container").overlay.append("line").attr("class","tooltip-line"),this.dots=this.factoryMgr.get("container").overlay.append("g").attr("class","tooltip-dots")},Tooltip.prototype.destroy=function(){this.svg.remove()},Tooltip.prototype.getClosestRows=function(x,data,options){for(var visibleSeries=options.series.filter(function(series){return series.visible}),datasets=visibleSeries.map(function(series){return data.getDatasetValues(series,options).filter(series.defined)}),closestRows=[],closestIndex=-1,minDistance=Number.POSITIVE_INFINITY,i=0;i<datasets.length;i++)for(var j=0;j<datasets[i].length;j++){if("date"===options.axes.x.type)var distance=Math.abs(datasets[i][j].x.getTime()-x);else var distance=Math.abs(datasets[i][j].x-x);distance===minDistance?closestRows.push({series:visibleSeries[i],row:datasets[i][j]}):minDistance>distance&&(minDistance=distance,closestRows=[{series:visibleSeries[i],row:datasets[i][j]}],closestIndex=j)}return{rows:closestRows,index:closestIndex}},Tooltip.prototype.showFromCoordinates=function(coordinates,data,options){var x=coordinates.x,y=coordinates.y;if(void 0===x||void 0===y)return void this.hide();x instanceof Date&&(x=x.getTime());var _a=this.getClosestRows(x,data,options),rows=_a.rows,index=_a.index;if(0===rows.length)return void this.hide();this.updateTooltipDots(rows),this.dots.style("opacity","1"),this.updateLinePosition(rows),this.line.style("opacity","1");var tooltipContent=this.getTooltipContent(rows,index,options);options.tooltipHook&&(tooltipContent=options.tooltipHook(rows)),tooltipContent&&(this.updateTooltipContent(tooltipContent,index,options),this.updateTooltipPosition(rows),this.svg.style("display",null))},Tooltip.prototype.show=function(event,data,options){var container=this.factoryMgr.get("container"),coordinates=container.getCoordinatesFromEvent(event);this.showFromCoordinates(coordinates,data,options)},Tooltip.prototype.getTooltipContent=function(rows,closestIndex,options){var xTickFormat=options.getByAxisSide(n3Charts.Utils.AxisOptions.SIDE.X).tickFormat,yTickFormat=options.getByAxisSide(n3Charts.Utils.AxisOptions.SIDE.Y).tickFormat,getRowValue=function(d){var fn=yTickFormat?function(y1){return yTickFormat(y1,closestIndex)}:function(y1){return y1},y1Label=fn(d.row.y1);return d.series.hasTwoKeys()?"["+fn(d.row.y0)+", "+y1Label+"]":y1Label};return{abscissas:xTickFormat?xTickFormat(rows[0].row.x,closestIndex):rows[0].row.x,rows:rows.map(function(row){return{label:row.series.label,value:getRowValue(row),color:row.series.color,id:row.series.id}})}},Tooltip.prototype.updateTooltipContent=function(result,closestIndex,options){this.svg.select(".abscissas").text(result.abscissas);var initItem=function(s){return s.attr({"class":"tooltip-item"}),s.append("div").attr({"class":"color-dot"}).style({"background-color":function(d){return d.color}}),s.append("div").attr({"class":"series-label"}),s.append("div").attr({"class":"y-value"}),s},updateItem=function(s){return s.select(".series-label").text(function(d){return d.label}),s.select(".y-value").text(function(d){return d.value}),s},items=this.svg.selectAll(".tooltip-item").data(result.rows,function(d,i){return d.id?d.id:i});items.enter().append("div").call(initItem).call(updateItem),items.call(updateItem),items.exit().remove()},Tooltip.prototype.updateTooltipDots=function(rows){var xScale=this.factoryMgr.get("x-axis").scale,yScale=this.factoryMgr.get("y-axis").scale,radius=3,circlePath=function(r,cx,cy){return"M "+cx+" "+cy+" m -"+r+", 0 a "+r+","+r+" 0 1,0 "+2*r+",0 a "+r+","+r+" 0 1,0 -"+2*r+",0 "},initDots=function(s){s.attr("class","tooltip-dots-group"),s.append("path").attr({"class":"tooltip-dot y1"}),s.append("path").attr({"class":"tooltip-dot y0"}).style({display:function(d){return d.series.hasTwoKeys()?null:"none"}})},updateDots=function(s){s.select(".tooltip-dot.y1").attr({d:function(d){return circlePath(radius,xScale(d.row.x),yScale(d.row.y1))},stroke:function(d){return d.series.color}}),s.select(".tooltip-dot.y0").attr({d:function(d){return d.series.hasTwoKeys()?circlePath(radius,xScale(d.row.x),yScale(d.row.y0)):""},stroke:function(d){return d.series.color}})},dots=this.dots.selectAll(".tooltip-dots-group").data(rows);dots.enter().append("g").call(initDots).call(updateDots),dots.call(updateDots),dots.exit().remove()},Tooltip.prototype.updateTooltipPosition=function(rows){var lastRow=rows.slice(-1)[0],xAxis=this.factoryMgr.get("x-axis"),margin=(this.factoryMgr.get("y-axis").scale,this.factoryMgr.get("container").getDimensions().margin),leftOffset=this.element.offsetLeft,topOffset=this.element.offsetTop,xOffset=0,transform="";xAxis.isInLastHalf(lastRow.row.x)?(transform="translate(-100%, 0)",xOffset=-10):xOffset=10,this.svg.style({left:leftOffset+margin.left+xAxis.scale(lastRow.row.x)+xOffset+"px",top:topOffset+margin.top+"px",transform:transform})},Tooltip.prototype.updateLinePosition=function(rows){var container=this.factoryMgr.get("container"),dim=container.getDimensions(),lastRow=rows.slice(-1)[0],xAxis=this.factoryMgr.get("x-axis"),x=xAxis.scale(lastRow.row.x);this.line.attr({x1:x,x2:x,y1:-dim.margin.top,y2:dim.innerHeight})},Tooltip.prototype.hide=function(){this.svg.style("display","none"),this.line.style("opacity","0"),this.dots.style("opacity","0")},Tooltip}(n3Charts.Utils.BaseFactory);Factory.Tooltip=Tooltip}(Factory=n3Charts.Factory||(n3Charts.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(n3Charts){var Factory;!function(Factory){"use strict";var Legend=function(_super){function Legend(element){_super.call(this),this.element=element}return __extends(Legend,_super),Legend.prototype.create=function(){this.createLegend()},Legend.prototype.createLegend=function(){this.div=d3.select(this.element).append("div").attr("class","chart-legend").style("position","absolute")},Legend.prototype.legendClick=function(){var _this=this;return function(selection){return selection.on("click",function(series){_this.eventMgr.trigger("legend-click",series)})}},Legend.prototype.update=function(data,options){var _this=this,container=this.factoryMgr.get("container"),init=(container.getDimensions(),function(series){var items=series.append("div").attr({"class":"item"}).call(_this.legendClick());items.append("div").attr({"class":"icon"}),items.append("div").attr({"class":"label"})}),update=function(series){series.attr("class",function(d){return"item "+d.type.join(" ")}).classed("hidden",function(d){return!d.visible}),series.select(".icon").style("background-color",function(d){return d.color}),series.select(".label").text(function(d){return d.label})},legendItems=this.div.selectAll(".item").data(options.series);legendItems.enter().call(init),legendItems.call(update),legendItems.exit().remove()},Legend.prototype.destroy=function(){this.div.remove()},Legend}(n3Charts.Utils.BaseFactory);Factory.Legend=Legend}(Factory=n3Charts.Factory||(n3Charts.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(n3Charts){var Factory;!function(Factory){"use strict";var Axis=function(_super){function Axis(side){if(_super.call(this),this.side=side,!n3Charts.Utils.AxisOptions.isValidSide(side))throw new TypeError("Wrong axis side : "+side)}return __extends(Axis,_super),Axis.prototype.create=function(){var vis=this.factoryMgr.get("container").axes;this.createAxis(vis),this.eventMgr.on("zoom."+this.key,this.softUpdate.bind(this))},Axis.prototype.softUpdate=function(){this.svg.call(this.d3axis)},Axis.prototype.update=function(data,options){var container=this.factoryMgr.get("container"),dim=container.getDimensions(),extent=this.getExtent(data,options),axisOptions=options.getByAxisSide(this.side);this.scale=this.getScale(axisOptions),this.updateScaleRange(dim),this.updateScaleDomain(extent),this.d3axis=this.getAxis(this.scale,axisOptions),this.updateAxisOrientation(this.d3axis),this.updateAxisContainer(dim),this.shiftAxisTicks(axisOptions)},Axis.prototype.shiftAxisTicks=function(options){
var _a=options.ticksShift,x=_a.x,y=_a.y;this.svg.selectAll("text").attr("transform","translate("+x+", "+y+")")},Axis.prototype.destroy=function(){this.destroyAxis()},Axis.prototype.updateScaleRange=function(dim){this.isAbscissas()?this.scale.range([0,dim.innerWidth]):this.scale.range([dim.innerHeight,0])},Axis.prototype.updateScaleDomain=function(extent){this.scale.domain(extent)},Axis.prototype.getExtentForDatasets=function(data,filter,accessor){var min=Number.POSITIVE_INFINITY,max=Number.NEGATIVE_INFINITY;for(var key in data.sets)filter(key)&&data.sets[key].values.forEach(function(datum){var data=accessor(datum,key);data[0]<min&&(min=data[0]),data[1]>max&&(max=data[1])});return[min===Number.POSITIVE_INFINITY?0:min,max===Number.NEGATIVE_INFINITY?1:max]},Axis.prototype.getExtent=function(datasets,options){var axisOptions=options.getByAxisSide(this.side),extent=void 0;if(this.isAbscissas()){var activeDatasets=options.getVisibleDatasets(),abscissasKey=options.getAbsKey();extent=this.getExtentForDatasets(datasets,function(key){return activeDatasets.indexOf(key)>-1},function(datum){return[datum[abscissasKey],datum[abscissasKey]]})}else{var _a=options.getSeriesAndDatasetBySide(this.side),datasetsForSide=_a.datasetsForSide,seriesForDataset=_a.seriesForDataset;extent=this.getExtentForDatasets(datasets,function(key){return datasetsForSide.indexOf(key)>-1},function(datum,datasetKey){var highest=seriesForDataset[datasetKey].map(function(series){return datum[series.key.y1]}),lowest=seriesForDataset[datasetKey].map(function(series){return datum[series.key.y0]||datum[series.key.y1]});return[d3.min(lowest),d3.max(highest)]})}return void 0!==axisOptions.min&&(extent[0]=axisOptions.min),void 0!==axisOptions.max&&(extent[1]=axisOptions.max),extent},Axis.prototype.isAbscissas=function(){return this.side===n3Charts.Utils.AxisOptions.SIDE.X},Axis.prototype.isInLastHalf=function(value){var fn=function(v){return v};value instanceof Date&&(fn=function(v){return v.getTime()});var _a=this.scale.domain(),a=_a[0],b=_a[1];return fn(value)>fn(a)+(fn(b)-fn(a))/2},Axis.prototype.createAxis=function(vis){this.svg=vis.append("g").attr("class","axis "+this.side+"-axis")},Axis.prototype.updateAxisOrientation=function(axis){this.isAbscissas()?axis.orient("bottom"):this.side===n3Charts.Utils.AxisOptions.SIDE.Y?axis.orient("left"):axis.orient("right")},Axis.prototype.updateAxisContainer=function(dim){this.isAbscissas()?this.svg.attr("transform","translate(0, "+dim.innerHeight+")"):this.side===n3Charts.Utils.AxisOptions.SIDE.Y?this.svg.attr("transform","translate(0, 0)"):this.svg.attr("transform","translate("+dim.innerWidth+", 0)"),this.svg.transition().call(this.factoryMgr.get("transitions").edit).call(this.d3axis)},Axis.prototype.destroyAxis=function(){this.svg.remove()},Axis.prototype.getScale=function(options){return options.type===n3Charts.Utils.AxisOptions.TYPE.DATE?d3.time.scale():options.type===n3Charts.Utils.AxisOptions.TYPE.LOG?d3.scale.log():d3.scale.linear()},Axis.prototype.getAxis=function(scale,options){var axis=d3.svg.axis().scale(scale);return options.configure(axis),axis},Axis.prototype.cloneAxis=function(){return d3.svg.axis().scale(this.d3axis.scale()).orient(this.d3axis.orient()).tickValues(this.d3axis.tickValues()).ticks(this.d3axis.ticks()[0]).tickSize(this.d3axis.tickSize())},Axis}(n3Charts.Utils.BaseFactory);Factory.Axis=Axis}(Factory=n3Charts.Factory||(n3Charts.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(n3Charts){var Factory;!function(Factory){"use strict";var Grid=function(_super){function Grid(){_super.apply(this,arguments)}return __extends(Grid,_super),Grid.prototype.create=function(){this.svg=this.factoryMgr.get("container").axes.insert("g",":first-child").attr("class","grid"),this.svg.append("g").classed("x-grid",!0),this.svg.append("g").classed("y-grid",!0)},Grid.prototype.update=function(data,options){var container=this.factoryMgr.get("container"),dim=container.getDimensions();if(options.grid.x){var xAxis=this.factoryMgr.get("x-axis").cloneAxis();this.svg.select(".x-grid").transition().call(this.factoryMgr.get("transitions").edit).attr("transform","translate(0, "+dim.innerHeight+")").call(xAxis.tickSize(-dim.innerHeight,0))}if(options.grid.y){var yAxis=this.factoryMgr.get("y-axis").cloneAxis();this.svg.select(".y-grid").transition().call(this.factoryMgr.get("transitions").edit).call(yAxis.tickSize(-dim.innerWidth,0))}},Grid.prototype.destroy=function(){this.svg.remove()},Grid}(n3Charts.Utils.BaseFactory);Factory.Grid=Grid}(Factory=n3Charts.Factory||(n3Charts.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(n3Charts){var Factory;!function(Factory){"use strict";var Zoom=function(_super){function Zoom(){_super.apply(this,arguments)}return __extends(Zoom,_super),Zoom.prototype.create=function(){this.behavior=d3.behavior.zoom()},Zoom.prototype.update=function(data,options){var xAxis=this.factoryMgr.get("x-axis"),yAxis=this.factoryMgr.get("y-axis");if(options.pan.x&&this.behavior.x(xAxis.scale),options.pan.y&&this.behavior.y(yAxis.scale),options.pan.x||options.pan.y){var y2Axis=this.factoryMgr.get("y2-axis"),eventMgr=this.eventMgr,transitions=this.factoryMgr.get("transitions");this.behavior.scaleExtent([1,1]).on("zoom",function(){y2Axis.scale.domain(yAxis.scale.domain()),transitions.off(),eventMgr.trigger("zoom",d3.event.sourceEvent.target),transitions.on()}),this.factoryMgr.get("container").svg.call(this.behavior),this.factoryMgr.get("container").svg.on("wheel.zoom",null),this.factoryMgr.get("container").svg.on("mousewheel.zoom",null)}},Zoom}(n3Charts.Utils.BaseFactory);Factory.Zoom=Zoom}(Factory=n3Charts.Factory||(n3Charts.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(n3Charts){var Factory;!function(Factory){"use strict";var Transition=function(_super){function Transition(){_super.apply(this,arguments)}return __extends(Transition,_super),Transition.prototype.off=function(){Transition.duration=0},Transition.prototype.on=function(){Transition.duration=Transition.defaultDuration},Transition.prototype.enter=function(t){var duration=Transition.duration,ease=Transition.ease,n=t[0].length,delay=function(d,i){return n?i/n*duration:0};t.duration(duration).delay(delay).ease(ease)},Transition.prototype.edit=function(t){var duration=Transition.duration,ease=Transition.ease,delay=0;t.duration(duration).delay(delay).ease(ease)},Transition.prototype.exit=function(t){var duration=Transition.duration,ease=Transition.ease,delay=0;t.duration(duration).delay(delay).ease(ease)},Transition.defaultDuration=250,Transition.duration=Transition.defaultDuration,Transition.ease="cubic",Transition.enabled=!0,Transition}(n3Charts.Utils.BaseFactory);Factory.Transition=Transition}(Factory=n3Charts.Factory||(n3Charts.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(n3Charts){var Factory;!function(Factory){var Series;!function(Series){"use strict";var Dot=function(_super){function Dot(){_super.apply(this,arguments),this.type=n3Charts.Utils.SeriesOptions.TYPE.DOT}return __extends(Dot,_super),Dot.prototype.updateData=function(group,series,index,numSeries){var xAxis=this.factoryMgr.get("x-axis"),yAxis=this.factoryMgr.get("y-axis"),dotsData=this.data.getDatasetValues(series,this.options).filter(series.defined),dotsRadius=2,dots=group.selectAll("."+this.type).data(dotsData,function(d){return d.x}),initPoint=function(s){s.attr({r:function(d){return dotsRadius},cx:function(d){return xAxis.scale(d.x)},cy:function(d){return yAxis.scale.range()[0]}})},updatePoint=function(s){s.attr({cx:function(d){return xAxis.scale(d.x)},cy:function(d){return yAxis.scale(d.y1)}}).style("opacity",series.visible?1:0)};dots.enter().append("circle").attr("class",this.type).call(this.eventMgr.datumEnter(series,this.options)).call(this.eventMgr.datumOver(series,this.options)).call(this.eventMgr.datumMove(series,this.options)).call(this.eventMgr.datumLeave(series,this.options)).call(initPoint).transition().call(this.factoryMgr.get("transitions").enter).call(updatePoint),dots.transition().call(this.factoryMgr.get("transitions").edit).call(updatePoint),dots.exit().transition().call(this.factoryMgr.get("transitions").exit).call(initPoint).each("end",function(){d3.select(this).remove()})},Dot.prototype.styleSeries=function(group){group.style({stroke:function(d){return d.color}})},Dot}(n3Charts.Utils.SeriesFactory);Series.Dot=Dot}(Series=Factory.Series||(Factory.Series={}))}(Factory=n3Charts.Factory||(n3Charts.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(n3Charts){var Factory;!function(Factory){var Series;!function(Series){"use strict";var Line=function(_super){function Line(){_super.apply(this,arguments),this.type=n3Charts.Utils.SeriesOptions.TYPE.LINE}return __extends(Line,_super),Line.prototype.updateData=function(group,series,index,numSeries){group.classed("dashed",series.isDashed());var xAxis=this.factoryMgr.get("x-axis"),yAxis=this.factoryMgr.get("y-axis"),lineData=this.data.getDatasetValues(series,this.options),initLine=d3.svg.line().defined(series.defined).x(function(d){return xAxis.scale(d.x)}).y(yAxis.scale.range()[0]).interpolate(series.interpolation.mode).tension(series.interpolation.tension),updateLine=d3.svg.line().defined(series.defined).x(function(d){return xAxis.scale(d.x)}).y(function(d){return yAxis.scale(d.y1)}).interpolate(series.interpolation.mode).tension(series.interpolation.tension),line=group.selectAll("."+this.type).data([lineData]);line.enter().append("path").attr("class",this.type).attr("d",function(d){return initLine(d)}).transition().call(this.factoryMgr.get("transitions").enter).attr("d",function(d){return updateLine(d)}),line.transition().call(this.factoryMgr.get("transitions").edit).attr("d",function(d){return updateLine(d)}).style("opacity",series.visible?1:0),line.exit().transition().call(this.factoryMgr.get("transitions").exit).attr("d",function(d){return initLine(d)}).each("end",function(){d3.select(this).remove()})},Line.prototype.styleSeries=function(group){group.style({fill:"none",stroke:function(s){return s.color},"stroke-dasharray":function(s){return s.isDashed()?"10,3":void 0}})},Line}(n3Charts.Utils.SeriesFactory);Series.Line=Line}(Series=Factory.Series||(Factory.Series={}))}(Factory=n3Charts.Factory||(n3Charts.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(n3Charts){var Factory;!function(Factory){var Series;!function(Series){"use strict";var Area=function(_super){function Area(){_super.apply(this,arguments),this.type=n3Charts.Utils.SeriesOptions.TYPE.AREA}return __extends(Area,_super),Area.prototype.updateData=function(group,series,index,numSeries){var xAxis=this.factoryMgr.get("x-axis"),yAxis=this.factoryMgr.get("y-axis"),areaData=this.data.getDatasetValues(series,this.options),initArea=d3.svg.area().defined(series.defined).x(function(d){return xAxis.scale(d.x)}).y0(yAxis.scale.range()[0]).y1(yAxis.scale.range()[0]).interpolate(series.interpolation.mode).tension(series.interpolation.tension),updateArea=d3.svg.area().defined(series.defined).x(function(d){return xAxis.scale(d.x)}).y0(function(d){return isNaN(yAxis.scale(d.y0))?yAxis.scale.range()[0]:yAxis.scale(d.y0)}).y1(function(d){return yAxis.scale(d.y1)}).interpolate(series.interpolation.mode).tension(series.interpolation.tension),area=group.selectAll("."+this.type).data([areaData]);area.enter().append("path").attr("class",this.type).attr("d",function(d){return initArea(d)}).transition().call(this.factoryMgr.get("transitions").enter).attr("d",function(d){return updateArea(d)}),area.transition().call(this.factoryMgr.get("transitions").edit).attr("d",function(d){return updateArea(d)}).style("opacity",series.visible?1:0),area.exit().transition().call(this.factoryMgr.get("transitions").exit).attr("d",function(d){return initArea(d)}).each("end",function(){d3.select(this).remove()})},Area.prototype.styleSeries=function(group){group.style({fill:function(s){return s.color},stroke:function(s){return s.color}})},Area}(n3Charts.Utils.SeriesFactory);Series.Area=Area}(Series=Factory.Series||(Factory.Series={}))}(Factory=n3Charts.Factory||(n3Charts.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(n3Charts){var Factory;!function(Factory){var Series;!function(Series){"use strict";var Column=function(_super){function Column(){_super.apply(this,arguments),this.type=n3Charts.Utils.SeriesOptions.TYPE.COLUMN,this.gapFactor=.2,this.outerPadding=this.gapFactor/2*3,this.columnsWidth=0}return __extends(Column,_super),Column.prototype.update=function(data,options){this.data=data,this.options=options;var series=options.getSeriesByType(this.type).filter(function(s){return s.visible});this.updateColumnsWidth(series,options),this.updateColumnScale(series,options),this.updateSeriesContainer(series)},Column.prototype.updateColumnsWidth=function(series,options){var xAxis=this.factoryMgr.get("x-axis"),colsDatasets=this.data.getDatasets(series,options),delta=n3Charts.Utils.Data.getMinDistance(colsDatasets,xAxis.scale,"x");this.columnsWidth=delta<Number.MAX_VALUE?delta/series.length:10},Column.prototype.updateColumnScale=function(series,options){var halfWidth=this.columnsWidth*series.length/2;this.innerXScale=d3.scale.ordinal().domain(series.map(function(s){return s.id})).rangeBands([-halfWidth,halfWidth],0,.1)},Column.prototype.getTooltipPosition=function(series){return this.innerXScale(series.id)+this.innerXScale.rangeBand()/2},Column.prototype.updateData=function(group,series,index,numSeries){var _this=this,xAxis=this.factoryMgr.get("x-axis"),yAxis=this.factoryMgr.get("y-axis"),colsData=this.data.getDatasetValues(series,this.options).filter(series.defined),xFn=function(d){return xAxis.scale(d.x)+_this.innerXScale(series.id)},initCol=function(s){s.attr({x:xFn,y:function(d){return yAxis.scale(d.y0)},width:_this.innerXScale.rangeBand(),height:0})},updateCol=function(s){s.attr({x:xFn,y:function(d){return d.y1>0?yAxis.scale(d.y1):yAxis.scale(d.y0)},width:_this.innerXScale.rangeBand(),height:function(d){return Math.abs(yAxis.scale(d.y0)-yAxis.scale(d.y1))}}).style("opacity",series.visible?1:0)},cols=group.selectAll("."+this.type).data(colsData,function(d){return d.x});cols.enter().append("rect").attr("class",this.type).call(this.eventMgr.datumEnter(series,this.options)).call(this.eventMgr.datumOver(series,this.options)).call(this.eventMgr.datumMove(series,this.options)).call(this.eventMgr.datumLeave(series,this.options)).call(initCol).transition().call(this.factoryMgr.get("transitions").enter).call(updateCol),cols.transition().call(this.factoryMgr.get("transitions").edit).call(updateCol),cols.exit().transition().call(this.factoryMgr.get("transitions").exit).call(initCol).each("end",function(){d3.select(this).remove()})},Column.prototype.styleSeries=function(group){group.style({fill:function(d){return d.color},stroke:function(d){return d.color},"stroke-width":1})},Column}(n3Charts.Utils.SeriesFactory);Series.Column=Column}(Series=Factory.Series||(Factory.Series={}))}(Factory=n3Charts.Factory||(n3Charts.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(n3Charts){"use strict";angular.module("n3-line-chart",[]).directive("linechart",["$window","$parse","$timeout","$rootScope",function($window,$parse,$timeout,$rootScope){return new n3Charts.LineChart($window,$parse,$timeout,$rootScope)}])}(n3Charts||(n3Charts={}));