{"version":3,"file":"js-data-localstorage.js","sources":["../node_modules/js-data-adapter/src/index.js","../node_modules/mout/lang/kindOf.js","../node_modules/mout/lang/isKind.js","../node_modules/mout/lang/isArray.js","../node_modules/mout/number/MAX_INT.js","../node_modules/mout/number/MIN_INT.js","../node_modules/mout/random/random.js","../node_modules/mout/random/rand.js","../node_modules/mout/random/randInt.js","../node_modules/mout/random/choice.js","../node_modules/mout/random/randHex.js","../node_modules/mout/random/guid.js","../src/index.js"],"sourcesContent":["\nimport {utils} from 'js-data'\n\nexport const noop = function (...args) {\n  const self = this\n  const opts = args[args.length - 1]\n  self.dbg(opts.op, ...args)\n  return utils.resolve()\n}\n\nexport const noop2 = function (...args) {\n  const self = this\n  const opts = args[args.length - 2]\n  self.dbg(opts.op, ...args)\n  return utils.resolve()\n}\n\nexport const unique = function (array) {\n  const seen = {}\n  const final = []\n  array.forEach(function (item) {\n    if (item in seen) {\n      return\n    }\n    final.push(item)\n    seen[item] = 0\n  })\n  return final\n}\n\nexport const withoutRelations = function (mapper, props) {\n  return utils.omit(props, mapper.relationFields || [])\n}\n\nconst DEFAULTS = {\n  /**\n   * Whether to log debugging information.\n   *\n   * @name Adapter#debug\n   * @type {boolean}\n   * @default false\n   */\n  debug: false,\n\n  /**\n   * Whether to return a more detailed response object.\n   *\n   * @name Adapter#raw\n   * @type {boolean}\n   * @default false\n   */\n  raw: false\n}\n\n/**\n * Abstract class meant to be extended by adapters.\n *\n * @class Adapter\n * @abstract\n * @param {Object} [opts] Configuration opts.\n * @param {boolean} [opts.debug=false] Whether to log debugging information.\n * @param {boolean} [opts.raw=false] Whether to return a more detailed response\n * object.\n */\nexport function Adapter (opts) {\n  const self = this\n  opts || (opts = {})\n  utils.fillIn(opts, DEFAULTS)\n  utils.fillIn(self, opts)\n}\n\nexport const reserved = [\n  'orderBy',\n  'sort',\n  'limit',\n  'offset',\n  'skip',\n  'where'\n]\n\n/**\n * Response object used when `raw` is `true`. May contain other fields in\n * addition to `data`.\n *\n * @class Response\n */\nexport function Response (data, meta, op) {\n  const self = this\n  meta || (meta = {})\n\n  /**\n   * Response data.\n   *\n   * @name Response#data\n   * @type {*}\n   */\n  self.data = data\n\n  utils.fillIn(self, meta)\n\n  /**\n   * The operation for which the response was created.\n   *\n   * @name Response#op\n   * @type {string}\n   */\n  self.op = op\n}\n\n/**\n * Alternative to ES6 class syntax for extending `Adapter`.\n *\n * @name Adapter.extend\n * @method\n * @param {Object} [instanceProps] Properties that will be added to the\n * prototype of the subclass.\n * @param {Object} [classProps] Properties that will be added as static\n * properties to the subclass itself.\n * @return {Object} Subclass of `Adapter`.\n */\nAdapter.extend = utils.extend\n\nutils.addHiddenPropsToTarget(Adapter.prototype, {\n  /**\n   * Lifecycle method method called by <a href=\"#count__anchor\">count</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#count__anchor\">count</a> to wait for the Promise to resolve before continuing.\n   *\n   * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be the count.\n   *\n   * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#count__anchor\">count</a>.\n   *\n   * @name Adapter#afterCount\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#count__anchor\">count</a>.\n   * @param {Object} props The `props` argument passed to <a href=\"#count__anchor\">count</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#count__anchor\">count</a>.\n   * @property {string} opts.op `afterCount`\n   * @param {Object|Response} response Count or {@link Response}, depending on the value of `opts.raw`.\n   */\n  afterCount: noop2,\n\n  /**\n   * Lifecycle method method called by <a href=\"#create__anchor\">create</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#create__anchor\">create</a> to wait for the Promise to resolve before continuing.\n   *\n   * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be the created record.\n   *\n   * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#create__anchor\">create</a>.\n   *\n   * @name Adapter#afterCreate\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#create__anchor\">create</a>.\n   * @param {Object} props The `props` argument passed to <a href=\"#create__anchor\">create</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#create__anchor\">create</a>.\n   * @property {string} opts.op `afterCreate`\n   * @param {Object|Response} response Created record or {@link Response}, depending on the value of `opts.raw`.\n   */\n  afterCreate: noop2,\n\n  /**\n   * Lifecycle method method called by <a href=\"#createMany__anchor\">createMany</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#createMany__anchor\">createMany</a> to wait for the Promise to resolve before continuing.\n   *\n   * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be the created records.\n   *\n   * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#createMany__anchor\">createMany</a>.\n   *\n   * @name Adapter#afterCreate\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#createMany__anchor\">createMany</a>.\n   * @param {Object[]} props The `props` argument passed to <a href=\"#createMany__anchor\">createMany</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#createMany__anchor\">createMany</a>.\n   * @property {string} opts.op `afterCreateMany`\n   * @param {Object[]|Response} response Created records or {@link Response}, depending on the value of `opts.raw`.\n   */\n  afterCreateMany: noop2,\n\n  /**\n   * Lifecycle method method called by <a href=\"#destroy__anchor\">destroy</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#destroy__anchor\">destroy</a> to wait for the Promise to resolve before continuing.\n   *\n   * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be `undefined`.\n   *\n   * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#destroy__anchor\">destroy</a>.\n   *\n   * @name Adapter#afterDestroy\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#destroy__anchor\">destroy</a>.\n   * @param {(string|number)} id The `id` argument passed to <a href=\"#destroy__anchor\">destroy</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#destroy__anchor\">destroy</a>.\n   * @property {string} opts.op `afterDestroy`\n   * @param {undefined|Response} response `undefined` or {@link Response}, depending on the value of `opts.raw`.\n   */\n  afterDestroy: noop2,\n\n  /**\n   * Lifecycle method method called by <a href=\"#destroyAll__anchor\">destroyAll</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#destroyAll__anchor\">destroyAll</a> to wait for the Promise to resolve before continuing.\n   *\n   * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be `undefined`.\n   *\n   * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#destroyAll__anchor\">destroyAll</a>.\n   *\n   * @name Adapter#afterDestroyAll\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#destroyAll__anchor\">destroyAll</a>.\n   * @param {Object} query The `query` argument passed to <a href=\"#destroyAll__anchor\">destroyAll</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#destroyAll__anchor\">destroyAll</a>.\n   * @property {string} opts.op `afterDestroyAll`\n   * @param {undefined|Response} response `undefined` or {@link Response}, depending on the value of `opts.raw`.\n   */\n  afterDestroyAll: noop2,\n\n  /**\n   * Lifecycle method method called by <a href=\"#find__anchor\">find</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#find__anchor\">find</a> to wait for the Promise to resolve before continuing.\n   *\n   * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be the found record, if any.\n   *\n   * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#find__anchor\">find</a>.\n   *\n   * @name Adapter#afterFind\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#find__anchor\">find</a>.\n   * @param {(string|number)} id The `id` argument passed to <a href=\"#find__anchor\">find</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#find__anchor\">find</a>.\n   * @property {string} opts.op `afterFind`\n   * @param {Object|Response} response The found record or {@link Response}, depending on the value of `opts.raw`.\n   */\n  afterFind: noop2,\n\n  /**\n   * Lifecycle method method called by <a href=\"#findAll__anchor\">findAll</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#findAll__anchor\">findAll</a> to wait for the Promise to resolve before continuing.\n   *\n   * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be the found records, if any.\n   *\n   * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#findAll__anchor\">findAll</a>.\n   *\n   * @name Adapter#afterFindAll\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#findAll__anchor\">findAll</a>.\n   * @param {Object} query The `query` argument passed to <a href=\"#findAll__anchor\">findAll</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#findAll__anchor\">findAll</a>.\n   * @property {string} opts.op `afterFindAll`\n   * @param {Object[]|Response} response The found records or {@link Response}, depending on the value of `opts.raw`.\n   */\n  afterFindAll: noop2,\n\n  /**\n   * Lifecycle method method called by <a href=\"#sum__anchor\">sum</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#sum__anchor\">sum</a> to wait for the Promise to resolve before continuing.\n   *\n   * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be the sum.\n   *\n   * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#sum__anchor\">sum</a>.\n   *\n   * @name Adapter#afterSum\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#sum__anchor\">sum</a>.\n   * @param {string} field The `field` argument passed to <a href=\"#sum__anchor\">sum</a>.\n   * @param {Object} query The `query` argument passed to <a href=\"#sum__anchor\">sum</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#sum__anchor\">sum</a>.\n   * @property {string} opts.op `afterSum`\n   * @param {Object|Response} response Count or {@link Response}, depending on the value of `opts.raw`.\n   */\n  afterSum: noop2,\n\n  /**\n   * Lifecycle method method called by <a href=\"#update__anchor\">update</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#update__anchor\">update</a> to wait for the Promise to resolve before continuing.\n   *\n   * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be the updated record.\n   *\n   * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#update__anchor\">update</a>.\n   *\n   * @name Adapter#afterUpdate\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#update__anchor\">update</a>.\n   * @param {(string|number)} id The `id` argument passed to <a href=\"#update__anchor\">update</a>.\n   * @param {Object} props The `props` argument passed to <a href=\"#update__anchor\">update</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#update__anchor\">update</a>.\n   * @property {string} opts.op `afterUpdate`\n   * @param {Object|Response} response The updated record or {@link Response}, depending on the value of `opts.raw`.\n   */\n  afterUpdate: noop2,\n\n  /**\n   * Lifecycle method method called by <a href=\"#updateAll__anchor\">updateAll</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#updateAll__anchor\">updateAll</a> to wait for the Promise to resolve before continuing.\n   *\n   * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be the updated records, if any.\n   *\n   * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#updateAll__anchor\">updateAll</a>.\n   *\n   * @name Adapter#afterUpdateAll\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#updateAll__anchor\">updateAll</a>.\n   * @param {Object} props The `props` argument passed to <a href=\"#updateAll__anchor\">updateAll</a>.\n   * @param {Object} query The `query` argument passed to <a href=\"#updateAll__anchor\">updateAll</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#updateAll__anchor\">updateAll</a>.\n   * @property {string} opts.op `afterUpdateAll`\n   * @param {Object[]|Response} response The updated records or {@link Response}, depending on the value of `opts.raw`.\n   */\n  afterUpdateAll: noop2,\n\n  /**\n   * Lifecycle method method called by <a href=\"#updateMany__anchor\">updateMany</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#updateMany__anchor\">updateMany</a> to wait for the Promise to resolve before continuing.\n   *\n   * If `opts.raw` is `true` then `response` will be a detailed response object, otherwise `response` will be the updated records, if any.\n   *\n   * `response` may be modified. You can also re-assign `response` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#updateMany__anchor\">updateMany</a>.\n   *\n   * @name Adapter#afterUpdateMany\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#updateMany__anchor\">updateMany</a>.\n   * @param {Object[]} records The `records` argument passed to <a href=\"#updateMany__anchor\">updateMany</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#updateMany__anchor\">updateMany</a>.\n   * @property {string} opts.op `afterUpdateMany`\n   * @param {Object[]|Response} response The updated records or {@link Response}, depending on the value of `opts.raw`.\n   */\n  afterUpdateMany: noop2,\n\n  /**\n   * Lifecycle method method called by <a href=\"#count__anchor\">count</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#count__anchor\">count</a> to wait for the Promise to resolve before continuing.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#count__anchor\">count</a>.\n   *\n   * @name Adapter#beforeCount\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#count__anchor\">count</a>.\n   * @param {Object} query The `query` argument passed to <a href=\"#count__anchor\">count</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#count__anchor\">count</a>.\n   * @property {string} opts.op `beforeCount`\n   */\n  beforeCount: noop,\n\n  /**\n   * Lifecycle method method called by <a href=\"#create__anchor\">create</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#create__anchor\">create</a> to wait for the Promise to resolve before continuing.\n   *\n   * `props` may be modified. You can also re-assign `props` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#create__anchor\">create</a>.\n   *\n   * @name Adapter#beforeCreate\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#create__anchor\">create</a>.\n   * @param {Object} props The `props` argument passed to <a href=\"#create__anchor\">create</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#create__anchor\">create</a>.\n   * @property {string} opts.op `beforeCreate`\n   */\n  beforeCreate: noop,\n\n  /**\n   * Lifecycle method method called by <a href=\"#createMany__anchor\">createMany</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#createMany__anchor\">createMany</a> to wait for the Promise to resolve before continuing.\n   *\n   * `props` may be modified. You can also re-assign `props` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#createMany__anchor\">createMany</a>.\n   *\n   * @name Adapter#beforeCreateMany\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#createMany__anchor\">createMany</a>.\n   * @param {Object[]} props The `props` argument passed to <a href=\"#createMany__anchor\">createMany</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#createMany__anchor\">createMany</a>.\n   * @property {string} opts.op `beforeCreateMany`\n   */\n  beforeCreateMany: noop,\n\n  /**\n   * Lifecycle method method called by <a href=\"#destroy__anchor\">destroy</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#destroy__anchor\">destroy</a> to wait for the Promise to resolve before continuing.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#destroy__anchor\">destroy</a>.\n   *\n   * @name Adapter#beforeDestroy\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#destroy__anchor\">destroy</a>.\n   * @param {(string|number)} id The `id` argument passed to <a href=\"#destroy__anchor\">destroy</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#destroy__anchor\">destroy</a>.\n   * @property {string} opts.op `beforeDestroy`\n   */\n  beforeDestroy: noop,\n\n  /**\n   * Lifecycle method method called by <a href=\"#destroyAll__anchor\">destroyAll</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#destroyAll__anchor\">destroyAll</a> to wait for the Promise to resolve before continuing.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#destroyAll__anchor\">destroyAll</a>.\n   *\n   * @name Adapter#beforeDestroyAll\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#destroyAll__anchor\">destroyAll</a>.\n   * @param {Object} query The `query` argument passed to <a href=\"#destroyAll__anchor\">destroyAll</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#destroyAll__anchor\">destroyAll</a>.\n   * @property {string} opts.op `beforeDestroyAll`\n   */\n  beforeDestroyAll: noop,\n\n  /**\n   * Lifecycle method method called by <a href=\"#find__anchor\">find</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#find__anchor\">find</a> to wait for the Promise to resolve before continuing.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#find__anchor\">find</a>.\n   *\n   * @name Adapter#beforeFind\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#find__anchor\">find</a>.\n   * @param {(string|number)} id The `id` argument passed to <a href=\"#find__anchor\">find</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#find__anchor\">find</a>.\n   * @property {string} opts.op `beforeFind`\n   */\n  beforeFind: noop,\n\n  /**\n   * Lifecycle method method called by <a href=\"#findAll__anchor\">findAll</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#findAll__anchor\">findAll</a> to wait for the Promise to resolve before continuing.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#findAll__anchor\">findAll</a>.\n   *\n   * @name Adapter#beforeFindAll\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#findAll__anchor\">findAll</a>.\n   * @param {Object} query The `query` argument passed to <a href=\"#findAll__anchor\">findAll</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#findAll__anchor\">findAll</a>.\n   * @property {string} opts.op `beforeFindAll`\n   */\n  beforeFindAll: noop,\n\n  /**\n   * Lifecycle method method called by <a href=\"#sum__anchor\">sum</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#sum__anchor\">sum</a> to wait for the Promise to resolve before continuing.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#sum__anchor\">sum</a>.\n   *\n   * @name Adapter#beforeSum\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#sum__anchor\">sum</a>.\n   * @param {Object} query The `query` argument passed to <a href=\"#sum__anchor\">sum</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#sum__anchor\">sum</a>.\n   * @property {string} opts.op `beforeSum`\n   */\n  beforeSum: noop,\n\n  /**\n   * Lifecycle method method called by <a href=\"#update__anchor\">update</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#update__anchor\">update</a> to wait for the Promise to resolve before continuing.\n   *\n   * `props` may be modified. You can also re-assign `props` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#update__anchor\">update</a>.\n   *\n   * @name Adapter#beforeUpdate\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#update__anchor\">update</a>.\n   * @param {(string|number)} id The `id` argument passed to <a href=\"#update__anchor\">update</a>.\n   * @param {Object} props The `props` argument passed to <a href=\"#update__anchor\">update</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#update__anchor\">update</a>.\n   * @property {string} opts.op `beforeUpdate`\n   */\n  beforeUpdate: noop,\n\n  /**\n   * Lifecycle method method called by <a href=\"#updateAll__anchor\">updateAll</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#updateAll__anchor\">updateAll</a> to wait for the Promise to resolve before continuing.\n   *\n   * `props` may be modified. You can also re-assign `props` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#updateAll__anchor\">updateAll</a>.\n   *\n   * @name Adapter#beforeUpdateAll\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#updateAll__anchor\">updateAll</a>.\n   * @param {Object} props The `props` argument passed to <a href=\"#updateAll__anchor\">updateAll</a>.\n   * @param {Object} query The `query` argument passed to <a href=\"#updateAll__anchor\">updateAll</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#updateAll__anchor\">updateAll</a>.\n   * @property {string} opts.op `beforeUpdateAll`\n   */\n  beforeUpdateAll: noop,\n\n  /**\n   * Lifecycle method method called by <a href=\"#updateMany__anchor\">updateMany</a>.\n   *\n   * Override this method to add custom behavior for this lifecycle hook.\n   *\n   * Returning a Promise causes <a href=\"#updateMany__anchor\">updateMany</a> to wait for the Promise to resolve before continuing.\n   *\n   * `props` may be modified. You can also re-assign `props` to another value by returning a different value or a Promise that resolves to a different value.\n   *\n   * A thrown error or rejected Promise will bubble up and reject the Promise returned by <a href=\"#updateMany__anchor\">updateMany</a>.\n   *\n   * @name Adapter#beforeUpdateMany\n   * @method\n   * @param {Object} mapper The `mapper` argument passed to <a href=\"#updateMany__anchor\">updateMany</a>.\n   * @param {Object[]} props The `props` argument passed to <a href=\"#updateMany__anchor\">updateMany</a>.\n   * @param {Object} opts The `opts` argument passed to <a href=\"#updateMany__anchor\">updateMany</a>.\n   * @property {string} opts.op `beforeUpdateMany`\n   */\n  beforeUpdateMany: noop,\n\n  /**\n   * Shortcut for `#log('debug'[, arg1[, arg2[, argn]]])`.\n   *\n   * @name Adapter#dbg\n   * @method\n   */\n  dbg (...args) {\n    this.log('debug', ...args)\n  },\n\n  /**\n   * Retrieve the number of records that match the selection query. Called by\n   * `Mapper#count`.\n   *\n   * @name Adapter#count\n   * @method\n   * @param {Object} mapper The mapper.\n   * @param {Object} [query] Selection query.\n   * @param {Object} [query.where] Filtering criteria.\n   * @param {string|Array} [query.orderBy] Sorting criteria.\n   * @param {string|Array} [query.sort] Same as `query.sort`.\n   * @param {number} [query.limit] Limit results.\n   * @param {number} [query.skip] Offset results.\n   * @param {number} [query.offset] Same as `query.skip`.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] Whether to return a more detailed\n   * response object.\n   * @return {Promise}\n   */\n  count (mapper, query, opts) {\n    const self = this\n    let op\n    query || (query = {})\n    opts || (opts = {})\n\n    // beforeCount lifecycle hook\n    op = opts.op = 'beforeCount'\n    return utils.resolve(self[op](mapper, query, opts)).then(function () {\n      // Allow for re-assignment from lifecycle hook\n      op = opts.op = 'count'\n      self.dbg(op, mapper, query, opts)\n      return utils.resolve(self._count(mapper, query, opts))\n    }).then(function (results) {\n      let [data, result] = results\n      result || (result = {})\n      let response = new Response(data, result, op)\n      response = self.respond(response, opts)\n\n      // afterCount lifecycle hook\n      op = opts.op = 'afterCount'\n      return utils.resolve(self[op](mapper, query, opts, response)).then(function (_response) {\n        // Allow for re-assignment from lifecycle hook\n        return utils.isUndefined(_response) ? response : _response\n      })\n    })\n  },\n\n  /**\n   * Create a new record. Called by `Mapper#create`.\n   *\n   * @name Adapter#create\n   * @method\n   * @param {Object} mapper The mapper.\n   * @param {Object} props The record to be created.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] Whether to return a more detailed\n   * response object.\n   * @return {Promise}\n   */\n  create (mapper, props, opts) {\n    const self = this\n    let op\n    props || (props = {})\n    opts || (opts = {})\n\n    // beforeCreate lifecycle hook\n    op = opts.op = 'beforeCreate'\n    return utils.resolve(self[op](mapper, props, opts)).then(function (_props) {\n      // Allow for re-assignment from lifecycle hook\n      props = utils.isUndefined(_props) ? props : _props\n      props = withoutRelations(mapper, props)\n      op = opts.op = 'create'\n      self.dbg(op, mapper, props, opts)\n      return utils.resolve(self._create(mapper, props, opts))\n    }).then(function (results) {\n      let [data, result] = results\n      result || (result = {})\n      let response = new Response(data, result, 'create')\n      response.created = data ? 1 : 0\n      response = self.respond(response, opts)\n\n      // afterCreate lifecycle hook\n      op = opts.op = 'afterCreate'\n      return utils.resolve(self[op](mapper, props, opts, response)).then(function (_response) {\n        // Allow for re-assignment from lifecycle hook\n        return utils.isUndefined(_response) ? response : _response\n      })\n    })\n  },\n\n  /**\n   * Create multiple records in a single batch. Called by `Mapper#createMany`.\n   *\n   * @name Adapter#createMany\n   * @method\n   * @param {Object} mapper The mapper.\n   * @param {Object} props The records to be created.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] Whether to return a more detailed\n   * response object.\n   * @return {Promise}\n   */\n  createMany (mapper, props, opts) {\n    const self = this\n    let op\n    props || (props = {})\n    opts || (opts = {})\n\n    // beforeCreateMany lifecycle hook\n    op = opts.op = 'beforeCreateMany'\n    return utils.resolve(self[op](mapper, props, opts)).then(function (_props) {\n      // Allow for re-assignment from lifecycle hook\n      props = utils.isUndefined(_props) ? props : _props\n      props = props.map(function (record) {\n        return withoutRelations(mapper, record)\n      })\n      op = opts.op = 'createMany'\n      self.dbg(op, mapper, props, opts)\n      return utils.resolve(self._createMany(mapper, props, opts))\n    }).then(function (results) {\n      let [data, result] = results\n      data || (data = [])\n      result || (result = {})\n      let response = new Response(data, result, 'createMany')\n      response.created = data.length\n      response = self.respond(response, opts)\n\n      // afterCreateMany lifecycle hook\n      op = opts.op = 'afterCreateMany'\n      return utils.resolve(self[op](mapper, props, opts, response)).then(function (_response) {\n        // Allow for re-assignment from lifecycle hook\n        return utils.isUndefined(_response) ? response : _response\n      })\n    })\n  },\n\n  /**\n   * Destroy the record with the given primary key. Called by\n   * `Mapper#destroy`.\n   *\n   * @name Adapter#destroy\n   * @method\n   * @param {Object} mapper The mapper.\n   * @param {(string|number)} id Primary key of the record to destroy.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] Whether to return a more detailed\n   * response object.\n   * @return {Promise}\n   */\n  destroy (mapper, id, opts) {\n    const self = this\n    let op\n    opts || (opts = {})\n\n    // beforeDestroy lifecycle hook\n    op = opts.op = 'beforeDestroy'\n    return utils.resolve(self[op](mapper, id, opts)).then(function () {\n      op = opts.op = 'destroy'\n      self.dbg(op, mapper, id, opts)\n      return utils.resolve(self._destroy(mapper, id, opts))\n    }).then(function (results) {\n      let [data, result] = results\n      result || (result = {})\n      let response = new Response(data, result, 'destroy')\n      response = self.respond(response, opts)\n\n      // afterDestroy lifecycle hook\n      op = opts.op = 'afterDestroy'\n      return utils.resolve(self[op](mapper, id, opts, response)).then(function (_response) {\n        // Allow for re-assignment from lifecycle hook\n        return utils.isUndefined(_response) ? response : _response\n      })\n    })\n  },\n\n  /**\n   * Destroy the records that match the selection query. Called by\n   * `Mapper#destroyAll`.\n   *\n   * @name Adapter#destroyAll\n   * @method\n   * @param {Object} mapper the mapper.\n   * @param {Object} [query] Selection query.\n   * @param {Object} [query.where] Filtering criteria.\n   * @param {string|Array} [query.orderBy] Sorting criteria.\n   * @param {string|Array} [query.sort] Same as `query.sort`.\n   * @param {number} [query.limit] Limit results.\n   * @param {number} [query.skip] Offset results.\n   * @param {number} [query.offset] Same as `query.skip`.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] Whether to return a more detailed\n   * response object.\n   * @return {Promise}\n   */\n  destroyAll (mapper, query, opts) {\n    const self = this\n    let op\n    query || (query = {})\n    opts || (opts = {})\n\n    // beforeDestroyAll lifecycle hook\n    op = opts.op = 'beforeDestroyAll'\n    return utils.resolve(self[op](mapper, query, opts)).then(function () {\n      op = opts.op = 'destroyAll'\n      self.dbg(op, mapper, query, opts)\n      return utils.resolve(self._destroyAll(mapper, query, opts))\n    }).then(function (results) {\n      let [data, result] = results\n      result || (result = {})\n      let response = new Response(data, result, 'destroyAll')\n      response = self.respond(response, opts)\n\n      // afterDestroyAll lifecycle hook\n      op = opts.op = 'afterDestroyAll'\n      return utils.resolve(self[op](mapper, query, opts, response)).then(function (_response) {\n        // Allow for re-assignment from lifecycle hook\n        return utils.isUndefined(_response) ? response : _response\n      })\n    })\n  },\n\n  /**\n   * Load a belongsTo relationship.\n   *\n   * Override with care.\n   *\n   * @name Adapter#loadBelongsTo\n   * @method\n   * @return {Promise}\n   */\n  loadBelongsTo (mapper, def, records, __opts) {\n    const self = this\n    const relationDef = def.getRelation()\n\n    if (utils.isObject(records) && !utils.isArray(records)) {\n      const record = records\n      return self.find(relationDef, self.makeBelongsToForeignKey(mapper, def, record), __opts).then(function (relatedItem) {\n        def.setLocalField(record, relatedItem)\n      })\n    } else {\n      const keys = records.map(function (record) {\n        return self.makeBelongsToForeignKey(mapper, def, record)\n      }).filter(function (key) {\n        return key\n      })\n      return self.findAll(relationDef, {\n        where: {\n          [relationDef.idAttribute]: {\n            'in': keys\n          }\n        }\n      }, __opts).then(function (relatedItems) {\n        records.forEach(function (record) {\n          relatedItems.forEach(function (relatedItem) {\n            if (relatedItem[relationDef.idAttribute] === record[def.foreignKey]) {\n              def.setLocalField(record, relatedItem)\n            }\n          })\n        })\n      })\n    }\n  },\n\n  /**\n   * Retrieve the record with the given primary key. Called by `Mapper#find`.\n   *\n   * @name Adapter#find\n   * @method\n   * @param {Object} mapper The mapper.\n   * @param {(string|number)} id Primary key of the record to retrieve.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] Whether to return a more detailed\n   * response object.\n   * @param {string[]} [opts.with=[]] Relations to eager load.\n   * @return {Promise}\n   */\n  find (mapper, id, opts) {\n    const self = this\n    let record, op\n    opts || (opts = {})\n    opts.with || (opts.with = [])\n\n    // beforeFind lifecycle hook\n    op = opts.op = 'beforeFind'\n    return utils.resolve(self[op](mapper, id, opts)).then(function () {\n      op = opts.op = 'find'\n      self.dbg(op, mapper, id, opts)\n      return utils.resolve(self._find(mapper, id, opts))\n    }).then(function (results) {\n      let [_record] = results\n      if (!_record) {\n        return\n      }\n      record = _record\n      const tasks = []\n\n      utils.forEachRelation(mapper, opts, function (def, __opts) {\n        let task\n        if (def.foreignKey && (def.type === 'hasOne' || def.type === 'hasMany')) {\n          if (def.type === 'hasOne') {\n            task = self.loadHasOne(mapper, def, record, __opts)\n          } else {\n            task = self.loadHasMany(mapper, def, record, __opts)\n          }\n        } else if (def.type === 'hasMany' && def.localKeys) {\n          task = self.loadHasManyLocalKeys(mapper, def, record, __opts)\n        } else if (def.type === 'hasMany' && def.foreignKeys) {\n          task = self.loadHasManyForeignKeys(mapper, def, record, __opts)\n        } else if (def.type === 'belongsTo') {\n          task = self.loadBelongsTo(mapper, def, record, __opts)\n        }\n        if (task) {\n          tasks.push(task)\n        }\n      })\n\n      return Promise.all(tasks)\n    }).then(function () {\n      let response = new Response(record, {}, 'find')\n      response.found = record ? 1 : 0\n      response = self.respond(response, opts)\n\n      // afterFind lifecycle hook\n      op = opts.op = 'afterFind'\n      return utils.resolve(self[op](mapper, id, opts, response)).then(function (_response) {\n        // Allow for re-assignment from lifecycle hook\n        return utils.isUndefined(_response) ? response : _response\n      })\n    })\n  },\n\n  /**\n   * Retrieve the records that match the selection query.\n   *\n   * @name Adapter#findAll\n   * @method\n   * @param {Object} mapper The mapper.\n   * @param {Object} [query] Selection query.\n   * @param {Object} [query.where] Filtering criteria.\n   * @param {string|Array} [query.orderBy] Sorting criteria.\n   * @param {string|Array} [query.sort] Same as `query.sort`.\n   * @param {number} [query.limit] Limit results.\n   * @param {number} [query.skip] Offset results.\n   * @param {number} [query.offset] Same as `query.skip`.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] Whether to return a more detailed\n   * response object.\n   * @param {string[]} [opts.with=[]] Relations to eager load.\n   * @return {Promise}\n   */\n  findAll (mapper, query, opts) {\n    const self = this\n    opts || (opts = {})\n    opts.with || (opts.with = [])\n\n    let records = []\n    let op\n    const activeWith = opts._activeWith\n\n    if (utils.isObject(activeWith)) {\n      const activeQuery = activeWith.query || {}\n      if (activeWith.replace) {\n        query = activeQuery\n      } else {\n        utils.deepFillIn(query, activeQuery)\n      }\n    }\n\n    // beforeFindAll lifecycle hook\n    op = opts.op = 'beforeFindAll'\n    return utils.resolve(self[op](mapper, query, opts)).then(function () {\n      op = opts.op = 'findAll'\n      self.dbg(op, mapper, query, opts)\n      return utils.resolve(self._findAll(mapper, query, opts))\n    }).then(function (results) {\n      let [_records] = results\n      _records || (_records = [])\n      records = _records\n      const tasks = []\n      utils.forEachRelation(mapper, opts, function (def, __opts) {\n        let task\n        if (def.foreignKey && (def.type === 'hasOne' || def.type === 'hasMany')) {\n          if (def.type === 'hasMany') {\n            task = self.loadHasMany(mapper, def, records, __opts)\n          } else {\n            task = self.loadHasOne(mapper, def, records, __opts)\n          }\n        } else if (def.type === 'hasMany' && def.localKeys) {\n          task = self.loadHasManyLocalKeys(mapper, def, records, __opts)\n        } else if (def.type === 'hasMany' && def.foreignKeys) {\n          task = self.loadHasManyForeignKeys(mapper, def, records, __opts)\n        } else if (def.type === 'belongsTo') {\n          task = self.loadBelongsTo(mapper, def, records, __opts)\n        }\n        if (task) {\n          tasks.push(task)\n        }\n      })\n      return Promise.all(tasks)\n    }).then(function () {\n      let response = new Response(records, {}, 'findAll')\n      response.found = records.length\n      response = self.respond(response, opts)\n\n      // afterFindAll lifecycle hook\n      op = opts.op = 'afterFindAll'\n      return utils.resolve(self[op](mapper, query, opts, response)).then(function (_response) {\n        // Allow for re-assignment from lifecycle hook\n        return utils.isUndefined(_response) ? response : _response\n      })\n    })\n  },\n\n  /**\n   * Resolve the value of the specified option based on the given options and\n   * this adapter's settings. Override with care.\n   *\n   * @name Adapter#getOpt\n   * @method\n   * @param {string} opt The name of the option.\n   * @param {Object} [opts] Configuration options.\n   * @return {*} The value of the specified option.\n   */\n  getOpt (opt, opts) {\n    opts || (opts = {})\n    return utils.isUndefined(opts[opt]) ? utils.plainCopy(this[opt]) : utils.plainCopy(opts[opt])\n  },\n\n  /**\n   * Load a hasMany relationship.\n   *\n   * Override with care.\n   *\n   * @name Adapter#loadHasMany\n   * @method\n   * @return {Promise}\n   */\n  loadHasMany (mapper, def, records, __opts) {\n    const self = this\n    let singular = false\n\n    if (utils.isObject(records) && !utils.isArray(records)) {\n      singular = true\n      records = [records]\n    }\n    const IDs = records.map(function (record) {\n      return self.makeHasManyForeignKey(mapper, def, record)\n    })\n    const query = {\n      where: {}\n    }\n    const criteria = query.where[def.foreignKey] = {}\n    if (singular) {\n      // more efficient query when we only have one record\n      criteria['=='] = IDs[0]\n    } else {\n      criteria['in'] = IDs.filter(function (id) {\n        return id\n      })\n    }\n    return self.findAll(def.getRelation(), query, __opts).then(function (relatedItems) {\n      records.forEach(function (record) {\n        let attached = []\n        // avoid unneccesary iteration when we only have one record\n        if (singular) {\n          attached = relatedItems\n        } else {\n          relatedItems.forEach(function (relatedItem) {\n            if (utils.get(relatedItem, def.foreignKey) === record[mapper.idAttribute]) {\n              attached.push(relatedItem)\n            }\n          })\n        }\n        def.setLocalField(record, attached)\n      })\n    })\n  },\n\n  loadHasManyLocalKeys (mapper, def, records, __opts) {\n    const self = this\n    let record\n    const relatedMapper = def.getRelation()\n\n    if (utils.isObject(records) && !utils.isArray(records)) {\n      record = records\n    }\n\n    if (record) {\n      return self.findAll(relatedMapper, {\n        where: {\n          [relatedMapper.idAttribute]: {\n            'in': self.makeHasManyLocalKeys(mapper, def, record)\n          }\n        }\n      }, __opts).then(function (relatedItems) {\n        def.setLocalField(record, relatedItems)\n      })\n    } else {\n      let localKeys = []\n      records.forEach(function (record) {\n        localKeys = localKeys.concat(self.self.makeHasManyLocalKeys(mapper, def, record))\n      })\n      return self.findAll(relatedMapper, {\n        where: {\n          [relatedMapper.idAttribute]: {\n            'in': unique(localKeys).filter(function (x) { return x })\n          }\n        }\n      }, __opts).then(function (relatedItems) {\n        records.forEach(function (item) {\n          let attached = []\n          let itemKeys = utils.get(item, def.localKeys) || []\n          itemKeys = utils.isArray(itemKeys) ? itemKeys : Object.keys(itemKeys)\n          relatedItems.forEach(function (relatedItem) {\n            if (itemKeys && itemKeys.indexOf(relatedItem[relatedMapper.idAttribute]) !== -1) {\n              attached.push(relatedItem)\n            }\n          })\n          def.setLocalField(item, attached)\n        })\n        return relatedItems\n      })\n    }\n  },\n\n  loadHasManyForeignKeys (mapper, def, records, __opts) {\n    const self = this\n    const relatedMapper = def.getRelation()\n    const idAttribute = mapper.idAttribute\n    let record\n\n    if (utils.isObject(records) && !utils.isArray(records)) {\n      record = records\n    }\n\n    if (record) {\n      return self.findAll(def.getRelation(), {\n        where: {\n          [def.foreignKeys]: {\n            'contains': self.makeHasManyForeignKeys(mapper, def, record)\n          }\n        }\n      }, __opts).then(function (relatedItems) {\n        def.setLocalField(record, relatedItems)\n      })\n    } else {\n      return self.findAll(relatedMapper, {\n        where: {\n          [def.foreignKeys]: {\n            'isectNotEmpty': records.map(function (record) {\n              return self.makeHasManyForeignKeys(mapper, def, record)\n            })\n          }\n        }\n      }, __opts).then(function (relatedItems) {\n        const foreignKeysField = def.foreignKeys\n        records.forEach(function (record) {\n          const _relatedItems = []\n          const id = utils.get(record, idAttribute)\n          relatedItems.forEach(function (relatedItem) {\n            const foreignKeys = utils.get(relatedItems, foreignKeysField) || []\n            if (foreignKeys.indexOf(id) !== -1) {\n              _relatedItems.push(relatedItem)\n            }\n          })\n          def.setLocalField(record, _relatedItems)\n        })\n      })\n    }\n  },\n\n  /**\n   * Load a hasOne relationship.\n   *\n   * Override with care.\n   *\n   * @name Adapter#loadHasOne\n   * @method\n   * @return {Promise}\n   */\n  loadHasOne (mapper, def, records, __opts) {\n    if (utils.isObject(records) && !utils.isArray(records)) {\n      records = [records]\n    }\n    return this.loadHasMany(mapper, def, records, __opts).then(function () {\n      records.forEach(function (record) {\n        const relatedData = def.getLocalField(record)\n        if (utils.isArray(relatedData) && relatedData.length) {\n          def.setLocalField(record, relatedData[0])\n        }\n      })\n    })\n  },\n\n  /**\n   * Logging utility method. Override this method if you want to send log\n   * messages to something other than the console.\n   *\n   * @name Adapter#log\n   * @method\n   * @param {string} level Log level.\n   * @param {...*} values Values to log.\n   */\n  log (level, ...args) {\n    if (level && !args.length) {\n      args.push(level)\n      level = 'debug'\n    }\n    if (level === 'debug' && !this.debug) {\n      return\n    }\n    const prefix = `${level.toUpperCase()}: (Adapter)`\n    if (console[level]) {\n      console[level](prefix, ...args)\n    } else {\n      console.log(prefix, ...args)\n    }\n  },\n\n  /**\n   * Return the foreignKey from the given record for the provided relationship.\n   *\n   * There may be reasons why you may want to override this method, like when\n   * the id of the parent doesn't exactly match up to the key on the child.\n   *\n   * Override with care.\n   *\n   * @name Adapter#makeHasManyForeignKey\n   * @method\n   * @return {*}\n   */\n  makeHasManyForeignKey (mapper, def, record) {\n    return def.getForeignKey(record)\n  },\n\n  /**\n   * Return the localKeys from the given record for the provided relationship.\n   *\n   * Override with care.\n   *\n   * @name Adapter#makeHasManyLocalKeys\n   * @method\n   * @return {*}\n   */\n  makeHasManyLocalKeys (mapper, def, record) {\n    let localKeys = []\n    let itemKeys = utils.get(record, def.localKeys) || []\n    itemKeys = utils.isArray(itemKeys) ? itemKeys : Object.keys(itemKeys)\n    localKeys = localKeys.concat(itemKeys)\n    return unique(localKeys).filter(function (x) { return x })\n  },\n\n  /**\n   * Return the foreignKeys from the given record for the provided relationship.\n   *\n   * Override with care.\n   *\n   * @name Adapter#makeHasManyForeignKeys\n   * @method\n   * @return {*}\n   */\n  makeHasManyForeignKeys (mapper, def, record) {\n    return utils.get(record, mapper.idAttribute)\n  },\n\n  /**\n   * Return the foreignKey from the given record for the provided relationship.\n   *\n   * Override with care.\n   *\n   * @name Adapter#makeBelongsToForeignKey\n   * @method\n   * @return {*}\n   */\n  makeBelongsToForeignKey (mapper, def, record) {\n    return def.getForeignKey(record)\n  },\n\n  /**\n   * Retrieve sum of the specified field of the records that match the selection\n   * query. Called by `Mapper#sum`.\n   *\n   * @name Adapter#sum\n   * @method\n   * @param {Object} mapper The mapper.\n   * @param {string} field By to sum.\n   * @param {Object} [query] Selection query.\n   * @param {Object} [query.where] Filtering criteria.\n   * @param {string|Array} [query.orderBy] Sorting criteria.\n   * @param {string|Array} [query.sort] Same as `query.sort`.\n   * @param {number} [query.limit] Limit results.\n   * @param {number} [query.skip] Offset results.\n   * @param {number} [query.offset] Same as `query.skip`.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] Whether to return a more detailed\n   * response object.\n   * @return {Promise}\n   */\n  sum (mapper, field, query, opts) {\n    const self = this\n    let op\n    if (!utils.isString(field)) {\n      throw new Error('field must be a string!')\n    }\n    query || (query = {})\n    opts || (opts = {})\n\n    // beforeSum lifecycle hook\n    op = opts.op = 'beforeSum'\n    return utils.resolve(self[op](mapper, field, query, opts)).then(function () {\n      // Allow for re-assignment from lifecycle hook\n      op = opts.op = 'sum'\n      self.dbg(op, mapper, field, query, opts)\n      return utils.resolve(self._sum(mapper, field, query, opts))\n    }).then(function (results) {\n      let [data, result] = results\n      result || (result = {})\n      let response = new Response(data, result, op)\n      response = self.respond(response, opts)\n\n      // afterSum lifecycle hook\n      op = opts.op = 'afterSum'\n      return utils.resolve(self[op](mapper, field, query, opts, response)).then(function (_response) {\n        // Allow for re-assignment from lifecycle hook\n        return utils.isUndefined(_response) ? response : _response\n      })\n    })\n  },\n\n  /**\n   * @name Adapter#respond\n   * @method\n   * @param {Object} response Response object.\n   * @param {Object} opts Configuration options.\n   * return {Object} If `opts.raw == true` then return `response`, else return\n   * `response.data`.\n   */\n  respond (response, opts) {\n    return this.getOpt('raw', opts) ? response : response.data\n  },\n\n  /**\n   * Apply the given update to the record with the specified primary key. Called\n   * by `Mapper#update`.\n   *\n   * @name Adapter#update\n   * @method\n   * @param {Object} mapper The mapper.\n   * @param {(string|number)} id The primary key of the record to be updated.\n   * @param {Object} props The update to apply to the record.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] Whether to return a more detailed\n   * response object.\n   * @return {Promise}\n   */\n  update (mapper, id, props, opts) {\n    const self = this\n    props || (props = {})\n    opts || (opts = {})\n    let op\n\n    // beforeUpdate lifecycle hook\n    op = opts.op = 'beforeUpdate'\n    return utils.resolve(self[op](mapper, id, props, opts)).then(function (_props) {\n      // Allow for re-assignment from lifecycle hook\n      props = utils.isUndefined(_props) ? props : _props\n      props = withoutRelations(mapper, props)\n      op = opts.op = 'update'\n      self.dbg(op, mapper, id, props, opts)\n      return utils.resolve(self._update(mapper, id, props, opts))\n    }).then(function (results) {\n      let [data, result] = results\n      result || (result = {})\n      let response = new Response(data, result, 'update')\n      response.updated = data ? 1 : 0\n      response = self.respond(response, opts)\n\n      // afterUpdate lifecycle hook\n      op = opts.op = 'afterUpdate'\n      return utils.resolve(self[op](mapper, id, props, opts, response)).then(function (_response) {\n        // Allow for re-assignment from lifecycle hook\n        return utils.isUndefined(_response) ? response : _response\n      })\n    })\n  },\n\n  /**\n   * Apply the given update to all records that match the selection query.\n   * Called by `Mapper#updateAll`.\n   *\n   * @name Adapter#updateAll\n   * @method\n   * @param {Object} mapper The mapper.\n   * @param {Object} props The update to apply to the selected records.\n   * @param {Object} [query] Selection query.\n   * @param {Object} [query.where] Filtering criteria.\n   * @param {string|Array} [query.orderBy] Sorting criteria.\n   * @param {string|Array} [query.sort] Same as `query.sort`.\n   * @param {number} [query.limit] Limit results.\n   * @param {number} [query.skip] Offset results.\n   * @param {number} [query.offset] Same as `query.skip`.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] Whether to return a more detailed\n   * response object.\n   * @return {Promise}\n   */\n  updateAll (mapper, props, query, opts) {\n    const self = this\n    props || (props = {})\n    query || (query = {})\n    opts || (opts = {})\n    let op\n\n    // beforeUpdateAll lifecycle hook\n    op = opts.op = 'beforeUpdateAll'\n    return utils.resolve(self[op](mapper, props, query, opts)).then(function (_props) {\n      // Allow for re-assignment from lifecycle hook\n      props = utils.isUndefined(_props) ? props : _props\n      props = withoutRelations(mapper, props)\n      op = opts.op = 'updateAll'\n      self.dbg(op, mapper, props, query, opts)\n      return utils.resolve(self._updateAll(mapper, props, query, opts))\n    }).then(function (results) {\n      let [data, result] = results\n      data || (data = [])\n      result || (result = {})\n      let response = new Response(data, result, 'updateAll')\n      response.updated = data.length\n      response = self.respond(response, opts)\n\n      // afterUpdateAll lifecycle hook\n      op = opts.op = 'afterUpdateAll'\n      return utils.resolve(self[op](mapper, props, query, opts, response)).then(function (_response) {\n        // Allow for re-assignment from lifecycle hook\n        return utils.isUndefined(_response) ? response : _response\n      })\n    })\n  },\n\n  /**\n   * Update the given records in a single batch. Called by `Mapper#updateMany`.\n   *\n   * @name Adapter#updateMany\n   * @method\n   * @param {Object} mapper The mapper.\n   * @param {Object[]} records The records to update.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] Whether to return a more detailed\n   * response object.\n   * @return {Promise}\n   */\n  updateMany (mapper, records, opts) {\n    const self = this\n    records || (records = [])\n    opts || (opts = {})\n    let op\n    const idAttribute = mapper.idAttribute\n\n    records = records.filter(function (record) {\n      return utils.get(record, idAttribute)\n    })\n\n    // beforeUpdateMany lifecycle hook\n    op = opts.op = 'beforeUpdateMany'\n    return utils.resolve(self[op](mapper, records, opts)).then(function (_records) {\n      // Allow for re-assignment from lifecycle hook\n      records = utils.isUndefined(_records) ? records : _records\n      records = records.map(function (record) {\n        return withoutRelations(mapper, record)\n      })\n      op = opts.op = 'updateMany'\n      self.dbg(op, mapper, records, opts)\n      return utils.resolve(self._updateMany(mapper, records, opts))\n    }).then(function (results) {\n      let [data, result] = results\n      data || (data = [])\n      result || (result = {})\n      let response = new Response(data, result, 'updateMany')\n      response.updated = data.length\n      response = self.respond(response, opts)\n\n      // afterUpdateMany lifecycle hook\n      op = opts.op = 'afterUpdateMany'\n      return utils.resolve(self[op](mapper, records, opts, response)).then(function (_response) {\n        // Allow for re-assignment from lifecycle hook\n        return utils.isUndefined(_response) ? response : _response\n      })\n    })\n  }\n})\n","\n\n    var _rKind = /^\\[object (.*)\\]$/,\n        _toString = Object.prototype.toString,\n        UNDEF;\n\n    /**\n     * Gets the \"kind\" of value. (e.g. \"String\", \"Number\", etc)\n     */\n    function kindOf(val) {\n        if (val === null) {\n            return 'Null';\n        } else if (val === UNDEF) {\n            return 'Undefined';\n        } else {\n            return _rKind.exec( _toString.call(val) )[1];\n        }\n    }\n    module.exports = kindOf;\n\n","var kindOf = require('./kindOf');\n    /**\n     * Check if value is from a specific \"kind\".\n     */\n    function isKind(val, kind){\n        return kindOf(val) === kind;\n    }\n    module.exports = isKind;\n\n","var isKind = require('./isKind');\n    /**\n     */\n    var isArray = Array.isArray || function (val) {\n        return isKind(val, 'Array');\n    };\n    module.exports = isArray;\n\n","/**\n * @constant Maximum 32-bit signed integer value. (2^31 - 1)\n */\n\n    module.exports = 2147483647;\n\n","/**\n * @constant Minimum 32-bit signed integer value (-2^31).\n */\n\n    module.exports = -2147483648;\n\n","\n\n    /**\n     * Just a wrapper to Math.random. No methods inside mout/random should call\n     * Math.random() directly so we can inject the pseudo-random number\n     * generator if needed (ie. in case we need a seeded random or a better\n     * algorithm than the native one)\n     */\n    function random(){\n        return random.get();\n    }\n\n    // we expose the method so it can be swapped if needed\n    random.get = Math.random;\n\n    module.exports = random;\n\n\n","var random = require('./random');\nvar MIN_INT = require('../number/MIN_INT');\nvar MAX_INT = require('../number/MAX_INT');\n\n    /**\n     * Returns random number inside range\n     */\n    function rand(min, max){\n        min = min == null? MIN_INT : min;\n        max = max == null? MAX_INT : max;\n        return min + (max - min) * random();\n    }\n\n    module.exports = rand;\n\n","var MIN_INT = require('../number/MIN_INT');\nvar MAX_INT = require('../number/MAX_INT');\nvar rand = require('./rand');\n\n    /**\n     * Gets random integer inside range or snap to min/max values.\n     */\n    function randInt(min, max){\n        min = min == null? MIN_INT : ~~min;\n        max = max == null? MAX_INT : ~~max;\n        // can't be max + 0.5 otherwise it will round up if `rand`\n        // returns `max` causing it to overflow range.\n        // -0.5 and + 0.49 are required to avoid bias caused by rounding\n        return Math.round( rand(min - 0.5, max + 0.499999999999) );\n    }\n\n    module.exports = randInt;\n\n","var randInt = require('./randInt');\nvar isArray = require('../lang/isArray');\n\n    /**\n     * Returns a random element from the supplied arguments\n     * or from the array (if single argument is an array).\n     */\n    function choice(items) {\n        var target = (arguments.length === 1 && isArray(items))? items : arguments;\n        return target[ randInt(0, target.length - 1) ];\n    }\n\n    module.exports = choice;\n\n\n","var choice = require('./choice');\n\n    var _chars = '0123456789abcdef'.split('');\n\n    /**\n     * Returns a random hexadecimal string\n     */\n    function randHex(size){\n        size = size && size > 0? size : 6;\n        var str = '';\n        while (size--) {\n            str += choice(_chars);\n        }\n        return str;\n    }\n\n    module.exports = randHex;\n\n\n","var randHex = require('./randHex');\nvar choice = require('./choice');\n\n  /**\n   * Returns pseudo-random guid (UUID v4)\n   * IMPORTANT: it's not totally \"safe\" since randHex/choice uses Math.random\n   * by default and sequences can be predicted in some cases. See the\n   * \"random/random\" documentation for more info about it and how to replace\n   * the default PRNG.\n   */\n  function guid() {\n    return (\n        randHex(8)+'-'+\n        randHex(4)+'-'+\n        // v4 UUID always contain \"4\" at this position to specify it was\n        // randomly generated\n        '4' + randHex(3) +'-'+\n        // v4 UUID always contain chars [a,b,8,9] at this position\n        choice(8, 9, 'a', 'b') + randHex(3)+'-'+\n        randHex(12)\n    );\n  }\n  module.exports = guid;\n\n","/* global: localStorage */\n\nimport {Query, utils} from 'js-data'\nimport {Adapter} from '../node_modules/js-data-adapter/src/index'\n\n// This is kinda weird, but it's so we can use Rollup.js\nimport * as Guid from '../node_modules/mout/random/guid'\nconst { default: guid } = Guid\n\nconst __super__ = Adapter.prototype\n\nconst DEFAULTS = {\n  /**\n   * Add a namespace to keys as they are stored.\n   *\n   * @name LocalStorageAdapter#basePath\n   * @type {string}\n   */\n  basePath: '',\n\n  /**\n   * Storage provider for this adapter. The default implementation is simply\n   * `getItem`, `setItem`, and `removeItem`. Each method accepts the same\n   * arguments as `localStorage#getItem`, `localStorage#setItem`, and\n   * `localStorage#removeItem`, but instead of being synchronous, these methods\n   * are asynchronous and return promises. This means you can swap out\n   * `localStorage` for `localForage`.\n   *\n   * @example <caption>Use localForage instead of localStorage</caption>\n   * const adapter = new LocalStorageAdapter({\n   *   storage: localForage\n   * })\n   *\n   * @name LocalStorageAdapter#storage\n   * @type {Object}\n   * @default localStorage\n   */\n  storage: {\n    getItem: function (key) {\n      return utils.resolve(localStorage.getItem(key))\n    },\n    setItem: function (key, value) {\n      return utils.resolve(localStorage.setItem(key, value))\n    },\n    removeItem: function (key) {\n      return utils.resolve(localStorage.removeItem(key))\n    }\n  }\n}\n\nfunction isValidString (value) {\n  return (value != null && value !== '')\n}\nfunction join (items, separator) {\n  separator || (separator = '')\n  return items.filter(isValidString).join(separator)\n}\nfunction makePath (...args) {\n  let result = join(args, '/')\n  return result.replace(/([^:\\/]|^)\\/{2,}/g, '$1/')\n}\nlet queue = []\nlet taskInProcess = false\n\nfunction enqueue (task) {\n  queue.push(task)\n}\n\nfunction dequeue () {\n  if (queue.length && !taskInProcess) {\n    taskInProcess = true\n    queue[0]()\n  }\n}\n\nfunction queueTask (task) {\n  if (!queue.length) {\n    enqueue(task)\n    dequeue()\n  } else {\n    enqueue(task)\n  }\n}\n\nfunction createTask (fn) {\n  return new Promise(fn).then(function (result) {\n    taskInProcess = false\n    queue.shift()\n    setTimeout(dequeue, 0)\n    return result\n  }, function (err) {\n    taskInProcess = false\n    queue.shift()\n    setTimeout(dequeue, 0)\n    return utils.reject(err)\n  })\n}\n\n/**\n * {@link LocalStorageAdapter} class.\n *\n * @name module:js-data-localstorage.LocalStorageAdapter\n * @see LocalStorageAdapter\n */\n\n/**\n * {@link LocalStorageAdapter} class. ES2015 default import.\n *\n * @name module:js-data-localstorage.default\n * @see LocalStorageAdapter\n */\n\n/**\n * LocalStorageAdapter class.\n *\n * @example\n * import {DataStore} from 'js-data'\n * import {LocalStorageAdapter} from 'js-data-localstorage'\n * const store = new DataStore()\n * const adapter = new LocalStorageAdapter()\n * store.registerAdapter('ls', adapter, { 'default': true })\n *\n * @class LocalStorageAdapter\n * @alias LocalStorageAdapter\n * @extends Adapter\n * @param {Object} [opts] Configuration options.\n * @param {string} [opts.basePath=''] See {@link LocalStorageAdapter#basePath}.\n * @param {boolean} [opts.debug=false] See {@link Adapter#debug}.\n * @param {boolean} [opts.raw=false] See {@link Adapter#raw}.\n * @param {Object} [opts.storeage=localStorage] See {@link LocalStorageAdapter#storage}.\n */\nexport function LocalStorageAdapter (opts) {\n  utils.classCallCheck(this, LocalStorageAdapter)\n  opts || (opts = {})\n  utils.fillIn(opts, DEFAULTS)\n  Adapter.call(this, opts)\n}\n\n// Setup prototype inheritance from Adapter\nLocalStorageAdapter.prototype = Object.create(Adapter.prototype, {\n  constructor: {\n    value: LocalStorageAdapter,\n    enumerable: false,\n    writable: true,\n    configurable: true\n  }\n})\n\nObject.defineProperty(LocalStorageAdapter, '__super__', {\n  configurable: true,\n  value: Adapter\n})\n\n/**\n * Alternative to ES6 class syntax for extending `LocalStorageAdapter`.\n *\n * @example <caption>Using the ES2015 class syntax.</caption>\n * class MyLocalStorageAdapter extends LocalStorageAdapter {...}\n * const adapter = new MyLocalStorageAdapter()\n *\n * @example <caption>Using {@link LocalStorageAdapter.extend}.</caption>\n * var instanceProps = {...}\n * var classProps = {...}\n *\n * var MyLocalStorageAdapter = LocalStorageAdapter.extend(instanceProps, classProps)\n * var adapter = new MyLocalStorageAdapter()\n *\n * @method LocalStorageAdapter.extend\n * @static\n * @param {Object} [instanceProps] Properties that will be added to the\n * prototype of the subclass.\n * @param {Object} [classProps] Properties that will be added as static\n * properties to the subclass itself.\n * @return {Constructor} Subclass of `LocalStorageAdapter`.\n */\nLocalStorageAdapter.extend = utils.extend\n\nutils.addHiddenPropsToTarget(LocalStorageAdapter.prototype, {\n  /**\n   * Retrieve the number of records that match the selection query. Internal\n   * method used by Adapter#count.\n   *\n   * @method LocalStorageAdapter#_count\n   * @private\n   * @param {Object} mapper The mapper.\n   * @param {Object} query Selection query.\n   * @param {Object} [opts] Configuration options.\n   * @return {Promise}\n   */\n  _count (mapper, query, opts) {\n    return this._findAll(mapper, query, opts).then((result) => {\n      result[0] = result[0].length\n      return result\n    })\n  },\n\n  _createHelper (mapper, props, opts) {\n    props = utils.plainCopy(props)\n    const idAttribute = mapper.idAttribute\n    const ids = props.map((_props) => {\n      let id = utils.get(_props, idAttribute)\n      if (utils.isUndefined(id)) {\n        id = guid()\n        utils.set(_props, idAttribute, id)\n      }\n      return id\n    })\n    const keys = ids.map((id) => this.getIdPath(mapper, opts, id))\n    const tasks = props.map((_props, i) => this.storage.setItem(keys[i], utils.toJson(_props)))\n    return utils.Promise.all(tasks)\n      .then(() => this.ensureId(ids, mapper, opts))\n      .then(() => utils.Promise.all(keys.map((key) => this.storage.getItem(key))))\n      .then((records) => records.map((record) => utils.fromJson(record)))\n  },\n\n  /**\n   * Create a new record. Internal method used by Adapter#create.\n   *\n   * @method LocalStorageAdapter#_create\n   * @private\n   * @param {Object} mapper The mapper.\n   * @param {Object} props The record to be created.\n   * @param {Object} [opts] Configuration options.\n   * @return {Promise}\n   */\n  _create (mapper, props, opts) {\n    return this._createHelper(mapper, [props], opts)\n      .then((records) => [records[0], {}])\n  },\n\n  /**\n   * Create multiple records in a single batch. Internal method used by\n   * Adapter#createMany.\n   *\n   * @method LocalStorageAdapter#_createMany\n   * @private\n   * @param {Object} mapper The mapper.\n   * @param {Object} props The records to be created.\n   * @param {Object} [opts] Configuration options.\n   * @return {Promise}\n   */\n  _createMany (mapper, props, opts) {\n    return this._createHelper(mapper, props, opts)\n      .then((records) => [records, {}])\n  },\n\n  /**\n   * Destroy the record with the given primary key. Internal method used by\n   * Adapter#destroy.\n   *\n   * @method LocalStorageAdapter#_destroy\n   * @private\n   * @param {Object} mapper The mapper.\n   * @param {(string|number)} id Primary key of the record to destroy.\n   * @param {Object} [opts] Configuration options.\n   * @return {Promise}\n   */\n  _destroy (mapper, id, opts) {\n    // Remove record from storage\n    return this.storage.removeItem(this.getIdPath(mapper, opts, id))\n      // Remove record's key from storage\n      .then(() => this.removeId(id, mapper, opts))\n      .then(() => [undefined, {}])\n  },\n\n  /**\n   * Destroy the records that match the selection query. Internal method used by\n   * Adapter#destroyAll.\n   *\n   * @method LocalStorageAdapter#_destroyAll\n   * @private\n   * @param {Object} mapper the mapper.\n   * @param {Object} [query] Selection query.\n   * @param {Object} [opts] Configuration options.\n   * @return {Promise}\n   */\n  _destroyAll (mapper, query, opts) {\n    return this._findAll(mapper, query, opts)\n      .then((results) => {\n        const [records] = results\n        const idAttribute = mapper.idAttribute\n        // Gather IDs of records to be destroyed\n        const ids = records.map((record) => utils.get(record, idAttribute))\n        // Remove records from storage\n        const tasks = ids.map((id) => this.storage.removeItem(this.getIdPath(mapper, opts, id)))\n        // Remove records' keys from storage\n        return utils.Promise.all(tasks).then(() => this.removeId(ids, mapper, opts))\n      })\n      .then(() => [undefined, {}])\n  },\n\n  /**\n   * Retrieve the record with the given primary key. Internal method used by\n   * Adapter#find.\n   *\n   * @method LocalStorageAdapter#_find\n   * @private\n   * @param {Object} mapper The mapper.\n   * @param {(string|number)} id Primary key of the record to retrieve.\n   * @param {Object} [opts] Configuration options.\n   * @return {Promise}\n   */\n  _find (mapper, id, opts) {\n    const key = this.getIdPath(mapper, opts, id)\n    return this.storage.getItem(key).then((record) => [record ? utils.fromJson(record) : undefined, {}])\n  },\n\n  /**\n   * Retrieve the records that match the selection query. Internal method used\n   * by Adapter#findAll.\n   *\n   * @method LocalStorageAdapter#_findAll\n   * @private\n   * @param {Object} mapper The mapper.\n   * @param {Object} query Selection query.\n   * @param {Object} [opts] Configuration options.\n   * @return {Promise}\n   */\n  _findAll (mapper, query, opts) {\n    query || (query = {})\n    // Load all records into memory...\n    return this.getIds(mapper, opts)\n      .then((ids) => {\n        const tasks = Object.keys(ids).map((id) => this.storage.getItem(this.getIdPath(mapper, opts, id)))\n        return utils.Promise.all(tasks)\n      })\n      .then((records) => records.map((record) => record ? utils.fromJson(record) : undefined).filter((record) => record))\n      .then((records) => {\n        const _query = new Query({\n          index: {\n            getAll () {\n              return records\n            }\n          }\n        })\n        return [_query.filter(query).run(), {}]\n      })\n  },\n\n  /**\n   * Retrieve the number of records that match the selection query. Internal\n   * method used by Adapter#sum.\n   *\n   * @method LocalStorageAdapter#_sum\n   * @private\n   * @param {Object} mapper The mapper.\n   * @param {string} field The field to sum.\n   * @param {Object} query Selection query.\n   * @param {Object} [opts] Configuration options.\n   * @return {Promise}\n   */\n  _sum (mapper, field, query, opts) {\n    return this._findAll(mapper, query, opts)\n      .then((result) => {\n        result[0] = result[0].reduce((sum, record) => sum + (utils.get(record, field) || 0), 0)\n        return result\n      })\n  },\n\n  /**\n   * Apply the given update to the record with the specified primary key.\n   * Internal method used by Adapter#update.\n   *\n   * @method LocalStorageAdapter#_update\n   * @private\n   * @param {Object} mapper The mapper.\n   * @param {(string|number)} id The primary key of the record to be updated.\n   * @param {Object} props The update to apply to the record.\n   * @param {Object} [opts] Configuration options.\n   * @return {Promise}\n   */\n  _update (mapper, id, props, opts) {\n    props || (props = {})\n    return this._find(mapper, id, opts)\n      .then((result) => {\n        const [record] = result\n        if (!record) {\n          throw new Error('Not Found')\n        }\n        const key = this.getIdPath(mapper, opts, id)\n        utils.deepMixIn(record, props)\n        return this.storage.setItem(key, utils.toJson(record))\n      })\n      .then(() => this._find(mapper, id, opts))\n  },\n\n  /**\n   * Apply the given update to all records that match the selection query.\n   * Internal method used by Adapter#updateAll.\n   *\n   * @method LocalStorageAdapter#_updateAll\n   * @private\n   * @param {Object} mapper The mapper.\n   * @param {Object} props The update to apply to the selected records.\n   * @param {Object} [query] Selection query.\n   * @param {Object} [opts] Configuration options.\n   * @return {Promise}\n   */\n  _updateAll (mapper, props, query, opts) {\n    return this._findAll(mapper, query, opts)\n      .then((results) => {\n        let [records] = results\n        const idAttribute = mapper.idAttribute\n        const tasks = records.map((record) => {\n          record || (record = {})\n          const id = utils.get(record, idAttribute)\n          const key = this.getIdPath(mapper, opts, id)\n          utils.deepMixIn(record, props)\n          return this.storage.setItem(key, utils.toJson(record))\n            .then(() => this._find(mapper, id, opts))\n            .then((result) => result[0])\n        })\n        return utils.Promise.all(tasks)\n      })\n      .then((records) => [records, {}])\n  },\n\n  /**\n   * Update the given records in a single batch. Internal method used by\n   * Adapter#updateMany.\n   *\n   * @method LocalStorageAdapter#updateMany\n   * @private\n   * @param {Object} mapper The mapper.\n   * @param {Object[]} records The records to update.\n   * @param {Object} [opts] Configuration options.\n   * @return {Promise}\n   */\n  _updateMany (mapper, records, opts) {\n    records || (records = [])\n    const idAttribute = mapper.idAttribute\n    const tasks = records.filter((record) => record).map((record) => {\n      const id = utils.get(record, idAttribute)\n      if (utils.isUndefined(id)) {\n        return\n      }\n      const key = this.getIdPath(mapper, opts, id)\n      return this.storage.getItem(key)\n        .then((json) => {\n          if (!json) {\n            return\n          }\n          const existingRecord = utils.fromJson(json)\n          utils.deepMixIn(existingRecord, record)\n          return this.storage.setItem(key, utils.toJson(existingRecord))\n        })\n        .then(() => this._find(mapper, id, opts))\n        .then((result) => result[0])\n    }).filter((promise) => promise)\n    return utils.Promise.all(tasks).then((records) => [records, {}])\n  },\n\n  create (mapper, props, opts) {\n    return createTask((success, failure) => {\n      queueTask(() => {\n        __super__.create.call(this, mapper, props, opts).then(success, failure)\n      })\n    })\n  },\n\n  createMany (mapper, props, opts) {\n    return createTask((success, failure) => {\n      queueTask(() => {\n        __super__.createMany.call(this, mapper, props, opts).then(success, failure)\n      })\n    })\n  },\n\n  destroy (mapper, id, opts) {\n    return createTask((success, failure) => {\n      queueTask(() => {\n        __super__.destroy.call(this, mapper, id, opts).then(success, failure)\n      })\n    })\n  },\n\n  destroyAll (mapper, query, opts) {\n    return createTask((success, failure) => {\n      queueTask(() => {\n        __super__.destroyAll.call(this, mapper, query, opts).then(success, failure)\n      })\n    })\n  },\n\n  /**\n   * TODO\n   *\n   * @method LocalStorageAdapter#ensureId\n   */\n  ensureId (id, mapper, opts) {\n    return this.getIds(mapper, opts).then((ids) => {\n      if (utils.isArray(id)) {\n        if (!id.length) {\n          return\n        }\n        id.forEach((_id) => {\n          ids[_id] = 1\n        })\n      } else {\n        ids[id] = 1\n      }\n      return this.saveKeys(ids, mapper, opts)\n    })\n  },\n\n  /**\n   * TODO\n   *\n   * @method LocalStorageAdapter#getPath\n   */\n  getPath (mapper, opts) {\n    opts = opts || {}\n    return makePath(opts.basePath === undefined ? (mapper.basePath === undefined ? this.basePath : mapper.basePath) : opts.basePath, mapper.name)\n  },\n\n  /**\n   * TODO\n   *\n   * @method LocalStorageAdapter#getIdPath\n   */\n  getIdPath (mapper, opts, id) {\n    opts = opts || {}\n    return makePath(opts.basePath || this.basePath || mapper.basePath, mapper.endpoint, id)\n  },\n\n  /**\n   * TODO\n   *\n   * @method LocalStorageAdapter#getIds\n   */\n  getIds (mapper, opts) {\n    let ids\n    const idsPath = this.getPath(mapper, opts)\n    return this.storage.getItem(idsPath).then((idsJson) => {\n      if (idsJson) {\n        ids = utils.fromJson(idsJson)\n      } else {\n        ids = {}\n      }\n      return ids\n    })\n  },\n\n  /**\n   * TODO\n   *\n   * @method LocalStorageAdapter#removeId\n   */\n  removeId (id, mapper, opts) {\n    return this.getIds(mapper, opts).then((ids) => {\n      if (utils.isArray(id)) {\n        if (!id.length) {\n          return\n        }\n        id.forEach(function (_id) {\n          delete ids[_id]\n        })\n      } else {\n        delete ids[id]\n      }\n      return this.saveKeys(ids, mapper, opts)\n    })\n  },\n\n  /**\n   * TODO\n   *\n   * @method LocalStorageAdapter#saveKeys\n   */\n  saveKeys (ids, mapper, opts) {\n    ids || (ids = {})\n    const idsPath = this.getPath(mapper, opts)\n    if (Object.keys(ids).length) {\n      return this.storage.setItem(idsPath, utils.toJson(ids))\n    } else {\n      return this.storage.removeItem(idsPath)\n    }\n  },\n\n  update (mapper, id, props, opts) {\n    return createTask((success, failure) => {\n      queueTask(() => {\n        __super__.update.call(this, mapper, id, props, opts).then(success, failure)\n      })\n    })\n  },\n\n  updateAll (mapper, props, query, opts) {\n    return createTask((success, failure) => {\n      queueTask(() => {\n        __super__.updateAll.call(this, mapper, props, query, opts).then(success, failure)\n      })\n    })\n  },\n\n  updateMany (mapper, records, opts) {\n    return createTask((success, failure) => {\n      queueTask(() => {\n        __super__.updateMany.call(this, mapper, records, opts).then(success, failure)\n      })\n    })\n  }\n})\n\n/**\n * Details of the current version of the `js-data-localstorage` module.\n *\n * @name module:js-data-localstorage.version\n * @type {Object}\n * @property {string} version.full The full semver value.\n * @property {number} version.major The major version number.\n * @property {number} version.minor The minor version number.\n * @property {number} version.patch The patch version number.\n * @property {(string|boolean)} version.alpha The alpha version value,\n * otherwise `false` if the current version is not alpha.\n * @property {(string|boolean)} version.beta The beta version value,\n * otherwise `false` if the current version is not beta.\n */\nexport const version = '<%= version %>'\n\n/**\n * Registered as `js-data-localstorage` in NPM and Bower.\n *\n * @example <caption>Script tag</caption>\n * var LocalStorageAdapter = window.JSDataLocalStorage.LocalStorageAdapter\n * var adapter = new LocalStorageAdapter()\n *\n * @example <caption>CommonJS</caption>\n * var LocalStorageAdapter = require('js-data-localstorage').LocalStorageAdapter\n * var adapter = new LocalStorageAdapter()\n *\n * @example <caption>ES2015 Modules</caption>\n * import {LocalStorageAdapter} from 'js-data-localstorage'\n * const adapter = new LocalStorageAdapter()\n *\n * @example <caption>AMD</caption>\n * define('myApp', ['js-data-localstorage'], function (JSDataLocalStorage) {\n *   var LocalStorageAdapter = JSDataLocalStorage.LocalStorageAdapter\n *   var adapter = new LocalStorageAdapter()\n *\n *   // ...\n * })\n *\n * @module js-data-localstorage\n */\n\nexport default LocalStorageAdapter\n"],"names":["utils","DEFAULTS","require$$0","require$$1","require$$2","Guid.default","Query"],"mappings":"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"}