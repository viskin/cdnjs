/*! Lity - v0.2.0 - 2015-02-25
* http://sorgalla.com/lity/
* Copyright (c) 2015 Jan Sorgalla; Licensed MIT */
!function(a,b){"function"==typeof define&&define.amd?define(["jquery"],function(c){return b(a,c)}):"object"==typeof module&&"object"==typeof module.exports?module.exports=b(a,require("jquery")):a.lity=b(a,a.jQuery||a.Zepto)}(window,function(a,b){"use strict";function c(a,b){if(s){var c=function(){b(),b=function(){}};a.one(s,c),setTimeout(c,500)}else b()}function d(a,c,d){if(1===arguments.length)return b.extend({},a);if("string"==typeof c){if("undefined"==typeof d)return"undefined"==typeof a[c]?null:a[c];a[c]=d}else b.extend(a,c);return this}function e(){return"file:"===a.location.protocol?"http:":""}function f(a){return b('<span class="lity-error"/>').append(a)}function g(a,c){if(!m.test(a))return!1;var d=b('<img src="'+a+'">'),e=b.Deferred(),g=function(){e.reject(f("Failed loading image"))};return c.on("lity:resize",function(a,b){d.css("max-height",Math.floor(b)+"px")}),d.on("load",function(){(!this.complete||"undefined"!=typeof this.naturalWidth&&0===this.naturalWidth)&&g(),e.resolve(d)}).on("error",g),e.promise()}function h(a){if(!n.test(a))return!1;var b;return a.indexOf("youtube.")>-1&&a.indexOf("/embed")<0&&(b=o.exec(a)[1],a=e()+"//www.youtube.com/embed/"+b+"?autoplay=1"),a.indexOf("vimeo.")>-1&&a.indexOf("player.vimeo.")<0&&(b=p.exec(a.split("//")[1])[1],a=e()+"//player.vimeo.com/video/"+b+"?autoplay=1"),a.indexOf("//maps.google.")>-1&&a.indexOf("output=embed")<0&&(a+="&output=embed"),'<div class="lity-iframe-container">                    <iframe frameborder="0" allowfullscreen src="'+a+'"></iframe>                </div>'}function i(a){try{return b(a).clone()}catch(c){return!1}}function j(a){function e(a){m&&m.find(".lity-loader").each(function(){var a=b(this);c(a,function(){a.remove()})}).end().removeClass("lity-loading").find(".lity-content").empty().append(b(a).removeClass("lity-hide")).trigger("lity:ready",[a,j])}function f(){if(m){var a=k.documentElement.clientHeight?k.documentElement.clientHeight:Math.round(l.height());m.trigger("lity:resize",[a])}}function g(a,c,d){m=a.appendTo("body"),setTimeout(function(){m.addClass("lity-opened lity-"+c).on("click","[data-lity-close]",function(a){b(a.target).is("[data-lity-close]")&&i()}).trigger("lity:open",[j]),l.on("resize",f),f(),b.when(d).always(e)},0)}function h(a){var c,d,e=b(t);if(n.handler&&o[n.handler])d=o[n.handler](a,e,j),c=n.handler;else{var f=b.extend({},o),h={};b.each(["iframe","inline"],function(a,b){f[b]&&(h[b]=f[b]),delete f[b]});var k=function(b,f){return f?(d=f(a,e,j),d?(c=b,!1):void 0):!0};b.each(f,k),!c&&b.each(h,k)}return d&&b.when(i()).done(function(){g(e,c,d)}),!!d}function i(){if(m){l.off("resize",f),m.trigger("lity:close",[j]).removeClass("lity-opened").addClass("lity-closed");var a=m;m=null;var d=b.Deferred(),e=function(){a.remove(),d.resolve()};return c(a,e),d.promise()}}function j(a){var c,d=a&&!!a.preventDefault;if(d||(c=a),!c){var e=b(this);c=e.attr("data-lity-target")||e.attr("href")||e.attr("src"),j.options(e.data("lity-options")||e.data("lity")||{})}c&&h(c)&&d&&a.preventDefault()}var m,n=b.extend({},r),o=b.extend({},q);return j.handlers=d.bind(j,o),j.options=d.bind(j,n),j.close=function(){return i(),j},j.options(a)}var k=a.document,l=b(a),m=/\.(png|jpg|jpeg|gif|tiff|bmp)(\?\S*)?$/i,n=/^([a-z]+:)?\/\//i,o=/v=([^&]+)/,p=/\/([^\?&]+)$/,q={image:g,iframe:h,inline:i},r={},s=function(){var a=k.createElement("div"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var c in b)if(void 0!==a.style[c])return b[c];return!1}(),t='<div class="lity lity-loading" tabindex="-1">                    <div class="lity-wrap" data-lity-close>                        <div class="lity-loader">Loading...</div>                        <div class="lity-container">                            <div class="lity-content"></div>                            <button class="lity-close" type="button" title="Close (Esc)" data-lity-close>Ã—</button>                         </div>                     </div>                 </div>                ',u=function(a){return j(a)};return u.version="0.2.0",u.handlers=d.bind(u,q),u.options=d.bind(u,r),b(k).on("click","[data-lity]",j()),u});