(function e(b,g,d){function c(m,j){if(!g[m]){if(!b[m]){var i=typeof require=="function"&&require;if(!j&&i){return i(m,!0)}if(a){return a(m,!0)}var k=new Error("Cannot find module '"+m+"'");throw k.code="MODULE_NOT_FOUND",k}var h=g[m]={exports:{}};b[m][0].call(h.exports,function(l){var o=b[m][1][l];return c(o?o:l)},h,h.exports,e,b,g,d)}return g[m].exports}var a=typeof require=="function"&&require;for(var f=0;f<d.length;f++){c(d[f])}return c})({1:[function(c,a,d){var l,f,h,b,g,k,j=function(p,n){for(var m in n){if(i.call(n,m)){p[m]=n[m]}}function o(){this.constructor=p}o.prototype=n.prototype;p.prototype=new o();p.__super__=n.prototype;return p},i={}.hasOwnProperty;k=c("./node");b=k.Position;l=(function(){function m(n){this.tree_widget=n;this.hovered_area=null;this.$ghost=null;this.hit_areas=[];this.is_dragging=false;this.current_item=null}m.prototype.mouseCapture=function(o){var n,p;n=$(o.target);if(!this.mustCaptureElement(n)){return null}if(this.tree_widget.options.onIsMoveHandle&&!this.tree_widget.options.onIsMoveHandle(n)){return null}p=this.tree_widget._getNodeElement(n);if(p&&this.tree_widget.options.onCanMove){if(!this.tree_widget.options.onCanMove(p.node)){p=null}}this.current_item=p;return this.current_item!==null};m.prototype.mouseStart=function(n){var o;this.refresh();o=$(n.target).offset();this.drag_element=new f(this.current_item.node,n.page_x-o.left,n.page_y-o.top,this.tree_widget.element);this.is_dragging=true;this.current_item.$element.addClass("jqtree-moving");return true};m.prototype.mouseDrag=function(n){var p,o;this.drag_element.move(n.page_x,n.page_y);p=this.findHoveredArea(n.page_x,n.page_y);o=this.canMoveToArea(p);if(o&&p){if(!p.node.isFolder()){this.stopOpenFolderTimer()}if(this.hovered_area!==p){this.hovered_area=p;if(this.mustOpenFolderTimer(p)){this.startOpenFolderTimer(p.node)}else{this.stopOpenFolderTimer()}this.updateDropHint()}}else{this.removeHover();this.removeDropHint();this.stopOpenFolderTimer()}return true};m.prototype.mustCaptureElement=function(n){return !n.is("input,select")};m.prototype.canMoveToArea=function(n){var o;if(!n){return false}else{if(this.tree_widget.options.onCanMoveTo){o=b.getName(n.position);return this.tree_widget.options.onCanMoveTo(this.current_item.node,n.node,o)}else{return true}}};m.prototype.mouseStop=function(n){this.moveItem(n);this.clear();this.removeHover();this.removeDropHint();this.removeHitAreas();if(this.current_item){this.current_item.$element.removeClass("jqtree-moving");this.current_item=null}this.is_dragging=false;return false};m.prototype.refresh=function(){this.removeHitAreas();if(this.current_item){this.generateHitAreas();this.current_item=this.tree_widget._getNodeElementForNode(this.current_item.node);if(this.is_dragging){return this.current_item.$element.addClass("jqtree-moving")}}};m.prototype.removeHitAreas=function(){return this.hit_areas=[]};m.prototype.clear=function(){this.drag_element.remove();return this.drag_element=null};m.prototype.removeDropHint=function(){if(this.previous_ghost){return this.previous_ghost.remove()}};m.prototype.removeHover=function(){return this.hovered_area=null};m.prototype.generateHitAreas=function(){var n;n=new h(this.tree_widget.tree,this.current_item.node,this.getTreeDimensions().bottom);return this.hit_areas=n.generate()};m.prototype.findHoveredArea=function(o,t){var r,q,s,n,p;q=this.getTreeDimensions();if(o<q.left||t<q.top||o>q.right||t>q.bottom){return null}n=0;s=this.hit_areas.length;while(n<s){p=(n+s)>>1;r=this.hit_areas[p];if(t<r.top){s=p}else{if(t>r.bottom){n=p+1}else{return r}}}return null};m.prototype.mustOpenFolderTimer=function(o){var n;n=o.node;return n.isFolder()&&!n.is_open&&o.position===b.INSIDE};m.prototype.updateDropHint=function(){var n;if(!this.hovered_area){return}this.removeDropHint();n=this.tree_widget._getNodeElementForNode(this.hovered_area.node);return this.previous_ghost=n.addDropHint(this.hovered_area.position)};m.prototype.startOpenFolderTimer=function(o){var n;n=(function(p){return function(){return p.tree_widget._openNode(o,p.tree_widget.options.slide,function(){p.refresh();return p.updateDropHint()})}})(this);this.stopOpenFolderTimer();return this.open_folder_timer=setTimeout(n,this.tree_widget.options.openFolderDelay)};m.prototype.stopOpenFolderTimer=function(){if(this.open_folder_timer){clearTimeout(this.open_folder_timer);return this.open_folder_timer=null}};m.prototype.moveItem=function(p){var q,s,r,n,o,t;if(this.hovered_area&&this.hovered_area.position!==b.NONE&&this.canMoveToArea(this.hovered_area)){r=this.current_item.node;t=this.hovered_area.node;n=this.hovered_area.position;o=r.parent;if(n===b.INSIDE){this.hovered_area.node.is_open=true}q=(function(u){return function(){u.tree_widget.tree.moveNode(r,t,n);u.tree_widget.element.empty();return u.tree_widget._refreshElements()}})(this);s=this.tree_widget._triggerEvent("tree.move",{move_info:{moved_node:r,target_node:t,position:b.getName(n),previous_parent:o,do_move:q,original_event:p.original_event}});if(!s.isDefaultPrevented()){return q()}}};m.prototype.getTreeDimensions=function(){var n;n=this.tree_widget.element.offset();return{left:n.left,top:n.top,right:n.left+this.tree_widget.element.width(),bottom:n.top+this.tree_widget.element.height()+16}};return m})();g=(function(){function m(n){this.tree=n}m.prototype.iterate=function(){var o,n;n=true;o=(function(p){return function(t,q){var z,r,y,v,u,w,x,s;x=(t.is_open||!t.element)&&t.hasChildren();if(t.element){z=$(t.element);if(!z.is(":visible")){return}if(n){p.handleFirstNode(t,z);n=false}if(!t.hasChildren()){p.handleNode(t,q,z)}else{if(t.is_open){if(!p.handleOpenFolder(t,z)){x=false}}else{p.handleClosedFolder(t,q,z)}}}if(x){y=t.children.length;s=t.children;for(v=u=0,w=s.length;u<w;v=++u){r=s[v];if(v===(y-1)){o(t.children[v],null)}else{o(t.children[v],t.children[v+1])}}if(t.is_open){return p.handleAfterOpenFolder(t,q,z)}}}})(this);return o(this.tree,null)};m.prototype.handleNode=function(p,o,n){};m.prototype.handleOpenFolder=function(o,n){};m.prototype.handleClosedFolder=function(p,o,n){};m.prototype.handleAfterOpenFolder=function(p,o,n){};m.prototype.handleFirstNode=function(o,n){};return m})();h=(function(m){j(n,m);function n(o,q,p){n.__super__.constructor.call(this,o);this.current_node=q;this.tree_bottom=p}n.prototype.generate=function(){this.positions=[];this.last_top=0;this.iterate();return this.generateHitAreas(this.positions)};n.prototype.getTop=function(o){return o.offset().top};n.prototype.addPosition=function(q,o,r){var p;p={top:r,node:q,position:o};this.positions.push(p);return this.last_top=r};n.prototype.handleNode=function(q,p,o){var r;r=this.getTop(o);if(q===this.current_node){this.addPosition(q,b.NONE,r)}else{this.addPosition(q,b.INSIDE,r)}if(p===this.current_node||q===this.current_node){return this.addPosition(q,b.NONE,r)}else{return this.addPosition(q,b.AFTER,r)}};n.prototype.handleOpenFolder=function(p,o){if(p===this.current_node){return false}if(p.children[0]!==this.current_node){this.addPosition(p,b.INSIDE,this.getTop(o))}return true};n.prototype.handleClosedFolder=function(q,p,o){var r;r=this.getTop(o);if(q===this.current_node){return this.addPosition(q,b.NONE,r)}else{this.addPosition(q,b.INSIDE,r);if(p!==this.current_node){return this.addPosition(q,b.AFTER,r)}}};n.prototype.handleFirstNode=function(p,o){if(p!==this.current_node){return this.addPosition(p,b.BEFORE,this.getTop($(p.element)))}};n.prototype.handleAfterOpenFolder=function(q,p,o){if(q===this.current_node.node||p===this.current_node.node){return this.addPosition(q,b.NONE,this.last_top)}else{return this.addPosition(q,b.AFTER,this.last_top)}};n.prototype.generateHitAreas=function(q){var u,s,r,p,o,t;t=-1;u=[];s=[];for(r=0,p=q.length;r<p;r++){o=q[r];if(o.top!==t&&u.length){if(u.length){this.generateHitAreasForGroup(s,u,t,o.top)}t=o.top;u=[]}u.push(o)}this.generateHitAreasForGroup(s,u,t,this.tree_bottom);return s};n.prototype.generateHitAreasForGroup=function(q,r,u,o){var p,w,s,t,v;v=Math.min(r.length,4);p=Math.round((o-u)/v);w=u;s=0;while(s<v){t=r[s];q.push({top:w,bottom:w+p,node:t.node,position:t.position});w+=p;s+=1}return null};return n})(g);f=(function(){function m(p,o,n,q){this.offset_x=o;this.offset_y=n;this.$element=$('<span class="jqtree-title jqtree-dragging">'+p.name+"</span>");this.$element.css("position","absolute");q.append(this.$element)}m.prototype.move=function(o,n){return this.$element.offset({left:o-this.offset_x,top:n-this.offset_y})};m.prototype.remove=function(){return this.$element.remove()};return m})();a.exports=l},{"./node":5}],2:[function(f,g,c){var b,d,h,i,a;i=f("./node_element");d=i.NodeElement;a=f("./util");h=a.html_escape;b=(function(){function j(k){this.tree_widget=k;this.opened_icon_element=this.createButtonElement(k.options.openedIcon);this.closed_icon_element=this.createButtonElement(k.options.closedIcon)}j.prototype.render=function(k){if(k&&k.parent){return this.renderFromNode(k)}else{return this.renderFromRoot()}};j.prototype.renderFromRoot=function(){var k;k=this.tree_widget.element;k.empty();return this.createDomElements(k[0],this.tree_widget.tree.children,true,true)};j.prototype.renderFromNode=function(m){var l,k;l=$(m.element);k=this.createLi(m);this.attachNodeData(m,k);l.after(k);l.remove();if(m.children){return this.createDomElements(k,m.children,false,false)}};j.prototype.createDomElements=function(n,l,s,m){var k,o,p,r,q;q=this.createUl(s);n.appendChild(q);for(o=0,p=l.length;o<p;o++){k=l[o];r=this.createLi(k);q.appendChild(r);this.attachNodeData(k,r);if(k.hasChildren()){this.createDomElements(r,k.children,false,k.is_open)}}return null};j.prototype.attachNodeData=function(l,k){l.element=k;return $(k).data("node",l)};j.prototype.createUl=function(m){var l,k;if(m){l="jqtree-tree"}else{l=""}k=document.createElement("ul");k.className="jqtree_common "+l;return k};j.prototype.createLi=function(l){var k;if(l.isFolder()){k=this.createFolderLi(l)}else{k=this.createNodeLi(l)}if(this.tree_widget.options.onCreateLi){this.tree_widget.options.onCreateLi(l,$(k))}return k};j.prototype.createFolderLi=function(o){var m,p,l,n,k,r,s,q;m=this.getButtonClasses(o);k=this.getFolderClasses(o);n=this.escapeIfNecessary(o.name);if(o.is_open){r=this.opened_icon_element}else{r=this.closed_icon_element}s=document.createElement("li");s.className="jqtree_common "+k;l=document.createElement("div");l.className="jqtree-element jqtree_common";s.appendChild(l);p=document.createElement("a");p.className="jqtree_common "+m;p.appendChild(r.cloneNode(false));l.appendChild(p);q=document.createElement("span");q.className="jqtree_common jqtree-title jqtree-title-folder";l.appendChild(q);q.innerHTML=n;return s};j.prototype.createNodeLi=function(n){var p,q,m,k,o,l;o=["jqtree_common"];if(this.tree_widget.select_node_handler&&this.tree_widget.select_node_handler.isNodeSelected(n)){o.push("jqtree-selected")}p=o.join(" ");m=this.escapeIfNecessary(n.name);k=document.createElement("li");k.className=p;q=document.createElement("div");q.className="jqtree-element jqtree_common";k.appendChild(q);l=document.createElement("span");l.className="jqtree-title jqtree_common";l.innerHTML=m;q.appendChild(l);return k};j.prototype.getButtonClasses=function(l){var k;k=["jqtree-toggler"];if(!l.is_open){k.push("jqtree-closed")}return k.join(" ")};j.prototype.getFolderClasses=function(l){var k;k=["jqtree-folder"];if(!l.is_open){k.push("jqtree-closed")}if(this.tree_widget.select_node_handler&&this.tree_widget.select_node_handler.isNodeSelected(l)){k.push("jqtree-selected")}if(l.is_loading){k.push("jqtree-loading")}return k.join(" ")};j.prototype.escapeIfNecessary=function(k){if(this.tree_widget.options.autoEscape){return h(k)}else{return k}};j.prototype.createButtonElement=function(k){var l;if(typeof k==="string"){l=document.createElement("div");l.innerHTML=k;return document.createTextNode(l.innerHTML)}else{return $(k)[0]}};return j})();g.exports=b},{"./node_element":6,"./util":12}],3:[function(b,d,a){var c,f=function(g,h){return function(){return g.apply(h,arguments)}};c=(function(){var k,h,j,g;h=37;g=38;j=39;k=40;function i(l){this.selectNode=f(this.selectNode,this);this.tree_widget=l;if(l.options.keyboardSupport){$(document).bind("keydown.jqtree",$.proxy(this.handleKeyDown,this))}}i.prototype.deinit=function(){return $(document).unbind("keydown.jqtree")};i.prototype.moveDown=function(){var l;l=this.tree_widget.getSelectedNode();if(l){return this.selectNode(l.getNextNode())}else{return false}};i.prototype.moveUp=function(){var l;l=this.tree_widget.getSelectedNode();if(l){return this.selectNode(l.getPreviousNode())}else{return false}};i.prototype.moveRight=function(){var l;l=this.tree_widget.getSelectedNode();if(l&&l.isFolder()&&!l.is_open){this.tree_widget.openNode(l);return false}else{return true}};i.prototype.moveLeft=function(){var l;l=this.tree_widget.getSelectedNode();if(l&&l.isFolder()&&l.is_open){this.tree_widget.closeNode(l);return false}else{return true}};i.prototype.handleKeyDown=function(m){var l;if(!this.tree_widget.options.keyboardSupport){return true}if($(document.activeElement).is("textarea,input,select")){return true}if(!this.tree_widget.getSelectedNode()){return true}l=m.which;switch(l){case k:return this.moveDown();case g:return this.moveUp();case j:return this.moveRight();case h:return this.moveLeft()}return true};i.prototype.selectNode=function(l){if(!l){return true}else{this.tree_widget.selectNode(l);if(this.tree_widget.scroll_handler&&(!this.tree_widget.scroll_handler.isScrolledIntoView($(l.element).find(".jqtree-element")))){this.tree_widget.scrollToNode(l)}return false}};return i})();d.exports=c},{}],4:[function(b,c,a){var g,f,h=function(l,j){for(var i in j){if(d.call(j,i)){l[i]=j[i]}}function k(){this.constructor=l}k.prototype=j.prototype;l.prototype=new k();l.__super__=j.prototype;return l},d={}.hasOwnProperty;f=b("./simple.widget");g=(function(i){h(j,i);function j(){return j.__super__.constructor.apply(this,arguments)}j.is_mouse_handled=false;j.prototype._init=function(){this.$el.bind("mousedown.mousewidget",$.proxy(this._mouseDown,this));this.$el.bind("touchstart.mousewidget",$.proxy(this._touchStart,this));this.is_mouse_started=false;this.mouse_delay=0;this._mouse_delay_timer=null;this._is_mouse_delay_met=true;return this.mouse_down_info=null};j.prototype._deinit=function(){var k;this.$el.unbind("mousedown.mousewidget");this.$el.unbind("touchstart.mousewidget");k=$(document);k.unbind("mousemove.mousewidget");return k.unbind("mouseup.mousewidget")};j.prototype._mouseDown=function(l){var k;if(l.which!==1){return}k=this._handleMouseDown(l,this._getPositionInfo(l));if(k){l.preventDefault()}return k};j.prototype._handleMouseDown=function(l,k){if(j.is_mouse_handled){return}if(this.is_mouse_started){this._handleMouseUp(k)}this.mouse_down_info=k;if(!this._mouseCapture(k)){return}this._handleStartMouse();this.is_mouse_handled=true;return true};j.prototype._handleStartMouse=function(){var k;k=$(document);k.bind("mousemove.mousewidget",$.proxy(this._mouseMove,this));k.bind("touchmove.mousewidget",$.proxy(this._touchMove,this));k.bind("mouseup.mousewidget",$.proxy(this._mouseUp,this));k.bind("touchend.mousewidget",$.proxy(this._touchEnd,this));if(this.mouse_delay){return this._startMouseDelayTimer()}};j.prototype._startMouseDelayTimer=function(){if(this._mouse_delay_timer){clearTimeout(this._mouse_delay_timer)}this._mouse_delay_timer=setTimeout((function(k){return function(){return k._is_mouse_delay_met=true}})(this),this.mouse_delay);return this._is_mouse_delay_met=false};j.prototype._mouseMove=function(k){return this._handleMouseMove(k,this._getPositionInfo(k))};j.prototype._handleMouseMove=function(l,k){if(this.is_mouse_started){this._mouseDrag(k);return l.preventDefault()}if(this.mouse_delay&&!this._is_mouse_delay_met){return true}this.is_mouse_started=this._mouseStart(this.mouse_down_info)!==false;if(this.is_mouse_started){this._mouseDrag(k)}else{this._handleMouseUp(k)}return !this.is_mouse_started};j.prototype._getPositionInfo=function(k){return{page_x:k.pageX,page_y:k.pageY,target:k.target,original_event:k}};j.prototype._mouseUp=function(k){return this._handleMouseUp(this._getPositionInfo(k))};j.prototype._handleMouseUp=function(k){var l;l=$(document);l.unbind("mousemove.mousewidget");l.unbind("touchmove.mousewidget");l.unbind("mouseup.mousewidget");l.unbind("touchend.mousewidget");if(this.is_mouse_started){this.is_mouse_started=false;this._mouseStop(k)}};j.prototype._mouseCapture=function(k){return true};j.prototype._mouseStart=function(k){return null};j.prototype._mouseDrag=function(k){return null};j.prototype._mouseStop=function(k){return null};j.prototype.setMouseDelay=function(k){return this.mouse_delay=k};j.prototype._touchStart=function(k){var l;if(k.originalEvent.touches.length>1){return}l=k.originalEvent.changedTouches[0];return this._handleMouseDown(k,this._getPositionInfo(l))};j.prototype._touchMove=function(k){var l;if(k.originalEvent.touches.length>1){return}l=k.originalEvent.changedTouches[0];return this._handleMouseMove(k,this._getPositionInfo(l))};j.prototype._touchEnd=function(k){var l;if(k.originalEvent.touches.length>1){return}l=k.originalEvent.changedTouches[0];return this._handleMouseUp(this._getPositionInfo(l))};return j})(f);c.exports=g},{"./simple.widget":10}],5:[function(d,f,b){var c,a;a={getName:function(g){return a.strings[g-1]},nameToIndex:function(h){var k,g,l;for(k=g=1,l=a.strings.length;1<=l?g<=l:g>=l;k=1<=l?++g:--g){if(a.strings[k-1]===h){return k}}return 0}};a.BEFORE=1;a.AFTER=2;a.INSIDE=3;a.NONE=4;a.strings=["before","after","inside","none"];c=(function(){function g(i,h,j){if(h==null){h=false}if(j==null){j=g}this.setData(i);this.children=[];this.parent=null;if(h){this.id_mapping={};this.tree=this;this.node_class=j}}g.prototype.setData=function(j){var h,i;if(typeof j!=="object"){this.name=j}else{for(h in j){i=j[h];if(h==="label"){this.name=i}else{this[h]=i}}}return null};g.prototype.initFromData=function(i){var h,j;j=(function(k){return function(l){k.setData(l);if(l.children){return h(l.children)}}})(this);h=(function(k){return function(o){var p,m,l,n;for(m=0,l=o.length;m<l;m++){p=o[m];n=new k.tree.node_class("");n.initFromData(p);k.addChild(n)}return null}})(this);j(i);return null};g.prototype.loadFromData=function(l){var i,h,k,m;this.removeChildren();for(i=0,h=l.length;i<h;i++){m=l[i];k=new this.tree.node_class(m);this.addChild(k);if(typeof m==="object"&&m.children){k.loadFromData(m.children)}}return null};g.prototype.addChild=function(h){this.children.push(h);return h._setParent(this)};g.prototype.addChildAtPosition=function(i,h){this.children.splice(h,0,i);return i._setParent(this)};g.prototype._setParent=function(h){this.parent=h;this.tree=h.tree;return this.tree.addNodeToIndex(this)};g.prototype.removeChild=function(h){h.removeChildren();return this._removeChild(h)};g.prototype._removeChild=function(h){this.children.splice(this.getChildIndex(h),1);return this.tree.removeNodeFromIndex(h)};g.prototype.getChildIndex=function(h){return $.inArray(h,this.children)};g.prototype.hasChildren=function(){return this.children.length!==0};g.prototype.isFolder=function(){return this.hasChildren()||this.load_on_demand};g.prototype.iterate=function(i){var h;h=function(o,q){var p,m,l,n,k;if(o.children){n=o.children;for(m=0,l=n.length;m<l;m++){p=n[m];k=i(p,q);if(k&&p.hasChildren()){h(p,q+1)}}return null}};h(this,0);return null};g.prototype.moveNode=function(i,j,h){if(i.isParentOf(j)){return}i.parent._removeChild(i);if(h===a.AFTER){return j.parent.addChildAtPosition(i,j.parent.getChildIndex(j)+1)}else{if(h===a.BEFORE){return j.parent.addChildAtPosition(i,j.parent.getChildIndex(j))}else{if(h===a.INSIDE){return j.addChildAtPosition(i,0)}}}};g.prototype.getData=function(){var h;h=(function(i){return function(o){var s,p,n,l,r,q,m;s=[];for(p=0,l=o.length;p<l;p++){r=o[p];q={};for(n in r){m=r[n];if((n!=="parent"&&n!=="children"&&n!=="element"&&n!=="tree")&&Object.prototype.hasOwnProperty.call(r,n)){q[n]=m}}if(r.hasChildren()){q.children=h(r.children)}s.push(q)}return s}})(this);return h(this.children)};g.prototype.getNodeByName=function(i){var h;h=null;this.iterate(function(j){if(j.name===i){h=j;return false}else{return true}});return h};g.prototype.addAfter=function(i){var j,h;if(!this.parent){return null}else{h=new this.tree.node_class(i);j=this.parent.getChildIndex(this);this.parent.addChildAtPosition(h,j+1);return h}};g.prototype.addBefore=function(i){var j,h;if(!this.parent){return null}else{h=new this.tree.node_class(i);j=this.parent.getChildIndex(this);this.parent.addChildAtPosition(h,j);return h}};g.prototype.addParent=function(m){var o,i,h,n,l,k;if(!this.parent){return null}else{n=new this.tree.node_class(m);n._setParent(this.tree);l=this.parent;k=l.children;for(i=0,h=k.length;i<h;i++){o=k[i];n.addChild(o)}l.children=[];l.addChild(n);return n}};g.prototype.remove=function(){if(this.parent){this.parent.removeChild(this);return this.parent=null}};g.prototype.append=function(i){var h;h=new this.tree.node_class(i);this.addChild(h);return h};g.prototype.prepend=function(i){var h;h=new this.tree.node_class(i);this.addChildAtPosition(h,0);return h};g.prototype.isParentOf=function(i){var h;h=i.parent;while(h){if(h===this){return true}h=h.parent}return false};g.prototype.getLevel=function(){var i,h;i=0;h=this;while(h.parent){i+=1;h=h.parent}return i};g.prototype.getNodeById=function(h){return this.id_mapping[h]};g.prototype.addNodeToIndex=function(h){if(h.id!=null){return this.id_mapping[h.id]=h}};g.prototype.removeNodeFromIndex=function(h){if(h.id!=null){return delete this.id_mapping[h.id]}};g.prototype.removeChildren=function(){this.iterate((function(h){return function(i){h.tree.removeNodeFromIndex(i);return true}})(this));return this.children=[]};g.prototype.getPreviousSibling=function(){var h;if(!this.parent){return null}else{h=this.parent.getChildIndex(this)-1;if(h>=0){return this.parent.children[h]}else{return null}}};g.prototype.getNextSibling=function(){var h;if(!this.parent){return null}else{h=this.parent.getChildIndex(this)+1;if(h<this.parent.children.length){return this.parent.children[h]}else{return null}}};g.prototype.getNodesByProperty=function(h,i){return this.filter(function(j){return j[h]===i})};g.prototype.filter=function(i){var h;h=[];this.iterate(function(j){if(i(j)){h.push(j)}return true});return h};g.prototype.getNextNode=function(i){var h;if(i==null){i=true}if(i&&this.hasChildren()&&this.is_open){return this.children[0]}else{if(!this.parent){return null}else{h=this.getNextSibling();if(h){return h}else{return this.parent.getNextNode(false)}}}};g.prototype.getPreviousNode=function(){var h;if(!this.parent){return null}else{h=this.getPreviousSibling();if(h){if(!h.hasChildren()||!h.is_open){return h}else{return h.getLastChild()}}else{if(this.parent.parent){return this.parent}else{return null}}}};g.prototype.getLastChild=function(){var h;if(!this.hasChildren()){return null}else{h=this.children[this.children.length-1];if(!h.hasChildren()||!h.is_open){return h}else{return h.getLastChild()}}};return g})();f.exports={Node:c,Position:a}},{}],6:[function(f,b,i){var a,h,j,g,c,d,l=function(p,n){for(var m in n){if(k.call(n,m)){p[m]=n[m]}}function o(){this.constructor=p}o.prototype=n.prototype;p.prototype=new o();p.__super__=n.prototype;return p},k={}.hasOwnProperty;d=f("./node");c=d.Position;g=(function(){function m(n,o){this.init(n,o)}m.prototype.init=function(n,o){this.node=n;this.tree_widget=o;if(!n.element){n.element=this.tree_widget.element}return this.$element=$(n.element)};m.prototype.getUl=function(){return this.$element.children("ul:first")};m.prototype.getSpan=function(){return this.$element.children(".jqtree-element").find("span.jqtree-title")};m.prototype.getLi=function(){return this.$element};m.prototype.addDropHint=function(n){if(n===c.INSIDE){return new a(this.$element)}else{return new j(this.node,this.$element,n)}};m.prototype.select=function(){return this.getLi().addClass("jqtree-selected")};m.prototype.deselect=function(){return this.getLi().removeClass("jqtree-selected")};return m})();h=(function(n){l(m,n);function m(){return m.__super__.constructor.apply(this,arguments)}m.prototype.open=function(r,o){var q,p;if(o==null){o=true}if(!this.node.is_open){this.node.is_open=true;q=this.getButton();q.removeClass("jqtree-closed");q.html("");q.append(this.tree_widget.renderer.opened_icon_element.cloneNode(false));p=(function(s){return function(){s.getLi().removeClass("jqtree-closed");if(r){r()}return s.tree_widget._triggerEvent("tree.open",{node:s.node})}})(this);if(o){return this.getUl().slideDown("fast",p)}else{this.getUl().show();return p()}}};m.prototype.close=function(o){var q,p;if(o==null){o=true}if(this.node.is_open){this.node.is_open=false;q=this.getButton();q.addClass("jqtree-closed");q.html("");q.append(this.tree_widget.renderer.closed_icon_element.cloneNode(false));p=(function(r){return function(){r.getLi().addClass("jqtree-closed");return r.tree_widget._triggerEvent("tree.close",{node:r.node})}})(this);if(o){return this.getUl().slideUp("fast",p)}else{this.getUl().hide();return p()}}};m.prototype.getButton=function(){return this.$element.children(".jqtree-element").find("a.jqtree-toggler")};m.prototype.addDropHint=function(o){if(!this.node.is_open&&o===c.INSIDE){return new a(this.$element)}else{return new j(this.node,this.$element,o)}};return m})(g);a=(function(){function m(o){var n,p;n=o.children(".jqtree-element");p=o.width()-4;this.$hint=$('<span class="jqtree-border"></span>');n.append(this.$hint);this.$hint.css({width:p,height:n.outerHeight()-4})}m.prototype.remove=function(){return this.$hint.remove()};return m})();j=(function(){function m(p,o,n){this.$element=o;this.node=p;this.$ghost=$('<li class="jqtree_common jqtree-ghost"><span class="jqtree_common jqtree-circle"></span><span class="jqtree_common jqtree-line"></span></li>');if(n===c.AFTER){this.moveAfter()}else{if(n===c.BEFORE){this.moveBefore()}else{if(n===c.INSIDE){if(p.isFolder()&&p.is_open){this.moveInsideOpenFolder()}else{this.moveInside()}}}}}m.prototype.remove=function(){return this.$ghost.remove()};m.prototype.moveAfter=function(){return this.$element.after(this.$ghost)};m.prototype.moveBefore=function(){return this.$element.before(this.$ghost)};m.prototype.moveInsideOpenFolder=function(){return $(this.node.children[0].element).before(this.$ghost)};m.prototype.moveInside=function(){this.$element.after(this.$ghost);return this.$ghost.addClass("jqtree-inside")};return m})();b.exports={FolderElement:h,NodeElement:g}},{"./node":5}],7:[function(c,d,b){var h,f,g,a;a=c("./util");f=a.indexOf;g=a.isInt;h=(function(){function i(j){this.tree_widget=j}i.prototype.saveState=function(){var j;j=JSON.stringify(this.getState());if(this.tree_widget.options.onSetStateFromStorage){return this.tree_widget.options.onSetStateFromStorage(j)}else{if(this.supportsLocalStorage()){return localStorage.setItem(this.getCookieName(),j)}else{if($.cookie){$.cookie.raw=true;return $.cookie(this.getCookieName(),j,{path:"/"})}}}};i.prototype.getStateFromStorage=function(){var j;j=this._loadFromStorage();if(j){return this._parseState(j)}else{return null}};i.prototype._parseState=function(k){var j;j=$.parseJSON(k);if(j&&j.selected_node&&g(j.selected_node)){j.selected_node=[j.selected_node]}return j};i.prototype._loadFromStorage=function(){if(this.tree_widget.options.onGetStateFromStorage){return this.tree_widget.options.onGetStateFromStorage()}else{if(this.supportsLocalStorage()){return localStorage.getItem(this.getCookieName())}else{if($.cookie){$.cookie.raw=true;return $.cookie(this.getCookieName())}else{return null}}}};i.prototype.getState=function(){var k,j;k=(function(l){return function(){var m;m=[];l.tree_widget.tree.iterate(function(n){if(n.is_open&&n.id&&n.hasChildren()){m.push(n.id)}return true});return m}})(this);j=(function(l){return function(){var m;return(function(){var p,n,q,o;q=this.tree_widget.getSelectedNodes();o=[];for(p=0,n=q.length;p<n;p++){m=q[p];o.push(m.id)}return o}).call(l)}})(this);return{open_nodes:k(),selected_node:j()}};i.prototype.setInitialState=function(k){var j;if(!k){return false}else{j=this._openInitialNodes(k.open_nodes);this._selectInitialNodes(k.selected_node);return j}};i.prototype._openInitialNodes=function(m){var l,j,k,n,o;k=false;for(l=0,j=m.length;l<j;l++){o=m[l];n=this.tree_widget.getNodeById(o);if(n){if(!n.load_on_demand){n.is_open=true}else{k=true}}}return k};i.prototype._selectInitialNodes=function(l){var k,j,m,n,o;o=0;for(k=0,j=l.length;k<j;k++){n=l[k];m=this.tree_widget.getNodeById(n);if(m){o+=1;this.tree_widget.select_node_handler.addToSelection(m)}}return o!==0};i.prototype.setInitialStateOnDemand=function(j){if(j){return this._setInitialStateOnDemand(j.open_nodes,j.selected_node)}};i.prototype._setInitialStateOnDemand=function(l,j){var m,k;k=(function(n){return function(){var q,o,p,r,s;p=[];for(q=0,o=l.length;q<o;q++){s=l[q];r=n.tree_widget.getNodeById(s);if(!r){p.push(s)}else{if(!r.is_loading){if(r.load_on_demand){m(r)}else{n.tree_widget._openNode(r,false)}}}}l=p;if(n._selectInitialNodes(j)){return n.tree_widget._refreshElements()}}})(this);m=(function(n){return function(o){return n.tree_widget._openNode(o,false,k)}})(this);return k()};i.prototype.getCookieName=function(){if(typeof this.tree_widget.options.saveState==="string"){return this.tree_widget.options.saveState}else{return"tree"}};i.prototype.supportsLocalStorage=function(){var j;j=function(){var k,l;if(typeof localStorage==="undefined"||localStorage===null){return false}else{try{l="_storage_test";sessionStorage.setItem(l,true);sessionStorage.removeItem(l)}catch(m){k=m;return false}return true}};if(this._supportsLocalStorage==null){this._supportsLocalStorage=j()}return this._supportsLocalStorage};i.prototype.getNodeIdToBeSelected=function(){var j;j=this.getStateFromStorage();if(j&&j.selected_node){return j.selected_node[0]}else{return null}};return i})();d.exports=h},{"./util":12}],8:[function(c,d,a){var b;b=(function(){function f(g){this.tree_widget=g;this.previous_top=-1;this._initScrollParent()}f.prototype._initScrollParent=function(){var g,h,i;h=(function(j){return function(){var p,n,l,m,k,o;p=["overflow","overflow-y"];l=function(s){var u,r,q,t;for(r=0,q=p.length;r<q;r++){u=p[r];if((t=$.css(s,u))==="auto"||t==="scroll"){return true}}return false};if(l(j.tree_widget.$el[0])){return j.tree_widget.$el}o=j.tree_widget.$el.parents();for(m=0,k=o.length;m<k;m++){n=o[m];if(l(n)){return $(n)}}return null}})(this);i=(function(j){return function(){j.scroll_parent_top=0;return j.$scroll_parent=null}})(this);if(this.tree_widget.$el.css("position")==="fixed"){i()}g=h();if(g&&g.length&&g[0].tagName!=="HTML"){this.$scroll_parent=g;return this.scroll_parent_top=this.$scroll_parent.offset().top}else{return i()}};f.prototype.checkScrolling=function(){var g;g=this.tree_widget.dnd_handler.hovered_area;if(g&&g.top!==this.previous_top){this.previous_top=g.top;if(this.$scroll_parent){return this._handleScrollingWithScrollParent(g)}else{return this._handleScrollingWithDocument(g)}}};f.prototype._handleScrollingWithScrollParent=function(h){var g;g=this.scroll_parent_top+this.$scroll_parent[0].offsetHeight-h.bottom;if(g<20){this.$scroll_parent[0].scrollTop+=20;this.tree_widget.refreshHitAreas();return this.previous_top=-1}else{if((h.top-this.scroll_parent_top)<20){this.$scroll_parent[0].scrollTop-=20;this.tree_widget.refreshHitAreas();return this.previous_top=-1}}};f.prototype._handleScrollingWithDocument=function(h){var g;g=h.top-$(document).scrollTop();if(g<20){return $(document).scrollTop($(document).scrollTop()-20)}else{if($(window).height()-(h.bottom-$(document).scrollTop())<20){return $(document).scrollTop($(document).scrollTop()+20)}}};f.prototype.scrollTo=function(h){var g;if(this.$scroll_parent){return this.$scroll_parent[0].scrollTop=h}else{g=this.tree_widget.$el.offset().top;return $(document).scrollTop(h+g)}};f.prototype.isScrolledIntoView=function(h){var g,l,k,j,i;g=$(h);if(this.$scroll_parent){i=0;j=this.$scroll_parent.height();k=g.offset().top-this.scroll_parent_top;l=k+g.height()}else{i=$(window).scrollTop();j=i+$(window).height();k=g.offset().top;l=k+g.height()}return(l<=j)&&(k>=i)};return f})();d.exports=b},{}],9:[function(c,d,b){var a;a=(function(){function f(g){this.tree_widget=g;this.clear()}f.prototype.getSelectedNode=function(){var g;g=this.getSelectedNodes();if(g.length){return g[0]}else{return false}};f.prototype.getSelectedNodes=function(){var i,h,g;if(this.selected_single_node){return[this.selected_single_node]}else{g=[];for(i in this.selected_nodes){h=this.tree_widget.getNodeById(i);if(h){g.push(h)}}return g}};f.prototype.getSelectedNodesUnder=function(h){var j,i,g;if(this.selected_single_node){if(h.isParentOf(this.selected_single_node)){return[this.selected_single_node]}else{return[]}}else{g=[];for(j in this.selected_nodes){i=this.tree_widget.getNodeById(j);if(i&&h.isParentOf(i)){g.push(i)}}return g}};f.prototype.isNodeSelected=function(g){if(g.id){return this.selected_nodes[g.id]}else{if(this.selected_single_node){return this.selected_single_node.element===g.element}else{return false}}};f.prototype.clear=function(){this.selected_nodes={};return this.selected_single_node=null};f.prototype.removeFromSelection=function(g,h){if(h==null){h=false}if(!g.id){if(this.selected_single_node&&g.element===this.selected_single_node.element){return this.selected_single_node=null}}else{delete this.selected_nodes[g.id];if(h){return g.iterate((function(i){return function(j){delete i.selected_nodes[g.id];return true}})(this))}}};f.prototype.addToSelection=function(g){if(g.id){return this.selected_nodes[g.id]=true}else{return this.selected_single_node=g}};return f})();d.exports=a},{}],10:[function(b,c,a){var d,f=[].slice;d=(function(){g.prototype.defaults={};function g(i,h){this.$el=$(i);this.options=$.extend({},this.defaults,h)}g.prototype.destroy=function(){return this._deinit()};g.prototype._init=function(){return null};g.prototype._deinit=function(){return null};g.register=function(n,l){var m,k,h,i,j;i=function(){return"simple_widget_"+l};j=function(p,o){var q;q=$.data(p,o);if(q&&(q instanceof g)){return q}else{return null}};k=function(r,p){var t,s,v,q,o,u;t=i();for(q=0,o=r.length;q<o;q++){s=r[q];v=j(s,t);if(!v){u=new n(s,p);if(!$.data(s,t)){$.data(s,t,u)}u._init()}}return r};h=function(r){var t,s,q,o,p,u;t=i();p=[];for(q=0,o=r.length;q<o;q++){s=r[q];u=j(s,t);if(u){u.destroy()}p.push($.removeData(s,t))}return p};m=function(v,t,u){var o,q,s,w,r,p;w=null;for(q=0,s=v.length;q<s;q++){o=v[q];r=$.data(o,i());if(r&&(r instanceof g)){p=r[t];if(p&&(typeof p==="function")){w=p.apply(r,u)}}}return w};return $.fn[l]=function(){var q,p,r,s,o;r=arguments[0],p=2<=arguments.length?f.call(arguments,1):[];q=this;if(r===void 0||typeof r==="object"){o=r;return k(q,o)}else{if(typeof r==="string"&&r[0]!=="_"){s=r;if(s==="destroy"){return h(q)}else{if(s==="get_widget_class"){return n}else{return m(q,s,p)}}}}}};return g})();c.exports=d},{}],11:[function(j,a,u){var n,p,q,f,h,g,s,i,w,b,k,m,l,o,d,v,c,r=function(A,y){for(var x in y){if(t.call(y,x)){A[x]=y[x]}}function z(){this.constructor=A}z.prototype=y.prototype;A.prototype=new z();A.__super__=y.prototype;return A},t={}.hasOwnProperty;o=j("./version");n=j("./drag_and_drop_handler");p=j("./elements_renderer");h=j("./key_handler");g=j("./mouse.widget");b=j("./save_state_handler");k=j("./scroll_handler");m=j("./select_node_handler");l=j("./simple.widget");v=j("./node");s=v.Node;w=v.Position;c=j("./util");d=j("./node_element");i=d.NodeElement;q=d.FolderElement;f=(function(y){r(x,y);function x(){return x.__super__.constructor.apply(this,arguments)}x.prototype.defaults={autoOpen:false,saveState:false,dragAndDrop:false,selectable:true,useContextMenu:true,onCanSelectNode:null,onSetStateFromStorage:null,onGetStateFromStorage:null,onCreateLi:null,onIsMoveHandle:null,onCanMove:null,onCanMoveTo:null,onLoadFailed:null,autoEscape:true,dataUrl:null,closedIcon:"&#x25ba;",openedIcon:"&#x25bc;",slide:true,nodeClass:s,dataFilter:null,keyboardSupport:true,openFolderDelay:500};x.prototype.toggle=function(A,z){if(z==null){z=null}if(z===null){z=this.options.slide}if(A.is_open){return this.closeNode(A,z)}else{return this.openNode(A,z)}};x.prototype.getTree=function(){return this.tree};x.prototype.selectNode=function(z){return this._selectNode(z,false)};x.prototype._selectNode=function(B,z){var D,C,E,A;if(z==null){z=false}if(!this.select_node_handler){return}D=(function(F){return function(){if(F.options.onCanSelectNode){return F.options.selectable&&F.options.onCanSelectNode(B)}else{return F.options.selectable}}})(this);E=(function(F){return function(){var G;G=B.parent;if(G&&G.parent&&!G.is_open){return F.openNode(G,false)}}})(this);A=(function(F){return function(){if(F.options.saveState){return F.save_state_handler.saveState()}}})(this);if(!B){this._deselectCurrentNode();A();return}if(!D()){return}if(this.select_node_handler.isNodeSelected(B)){if(z){this._deselectCurrentNode();this._triggerEvent("tree.select",{node:null,previous_node:B})}}else{C=this.getSelectedNode();this._deselectCurrentNode();this.addToSelection(B);this._triggerEvent("tree.select",{node:B,deselected_node:C});E()}return A()};x.prototype.getSelectedNode=function(){if(this.select_node_handler){return this.select_node_handler.getSelectedNode()}else{return null}};x.prototype.toJson=function(){return JSON.stringify(this.tree.getData())};x.prototype.loadData=function(z,A){return this._loadData(z,A)};x.prototype.loadDataFromUrl=function(z,B,A){if($.type(z)!=="string"){A=B;B=z;z=null}return this._loadDataFromUrl(z,B,A)};x.prototype.reload=function(){return this.loadDataFromUrl()};x.prototype._loadDataFromUrl=function(E,F,B){var G,D,A,H,C,z;G=null;D=(function(I){return function(){if(F){G=$(F.element)}else{G=I.element}return G.addClass("jqtree-loading")}})(this);z=function(){if(G){return G.removeClass("jqtree-loading")}};C=function(){if($.type(E)==="string"){E={url:E}}if(!E.method){return E.method="get"}};A=(function(I){return function(J){z();I._loadData(J,F);if(B&&$.isFunction(B)){return B()}}})(this);H=(function(I){return function(){C();return $.ajax({url:E.url,data:E.data,type:E.method.toUpperCase(),cache:false,dataType:"json",success:function(J){var K;if($.isArray(J)||typeof J==="object"){K=J}else{K=$.parseJSON(J)}if(I.options.dataFilter){K=I.options.dataFilter(K)}return A(K)},error:function(J){z();if(I.options.onLoadFailed){return I.options.onLoadFailed(J)}}})}})(this);if(!E){E=this._getDataUrlInfo(F)}D();if(!E){z()}else{if($.isArray(E)){A(E)}else{return H()}}};x.prototype._loadData=function(z,B){var C,A;if(B==null){B=null}C=(function(D){return function(){var G,E,H,F;if(D.select_node_handler){F=D.select_node_handler.getSelectedNodesUnder(B);for(G=0,E=F.length;G<E;G++){H=F[G];D.select_node_handler.removeFromSelection(H)}}return null}})(this);A=(function(D){return function(){B.loadFromData(z);B.load_on_demand=false;B.is_loading=false;return D._refreshElements(B)}})(this);if(!z){return}this._triggerEvent("tree.load_data",{tree_data:z});if(!B){this._initTree(z)}else{C();A()}if(this.isDragging()){return this.dnd_handler.refresh()}};x.prototype.getNodeById=function(z){return this.tree.getNodeById(z)};x.prototype.getNodeByName=function(z){return this.tree.getNodeByName(z)};x.prototype.getNodesByProperty=function(z,A){return this.tree.getNodesByProperty(z,A)};x.prototype.openNode=function(A,z){if(z==null){z=null}if(z===null){z=this.options.slide}return this._openNode(A,z)};x.prototype._openNode=function(B,z,C){var D,A;if(z==null){z=true}D=(function(E){return function(G,H,F){var I;I=new q(G,E);return I.open(F,H)}})(this);if(B.isFolder()){if(B.load_on_demand){return this._loadFolderOnDemand(B,z,C)}else{A=B.parent;while(A){if(A.parent){D(A,false,null)}A=A.parent}D(B,z,C);return this._saveState()}}};x.prototype._loadFolderOnDemand=function(A,z,B){if(z==null){z=true}A.is_loading=true;return this._loadDataFromUrl(null,A,(function(C){return function(){return C._openNode(A,z,B)}})(this))};x.prototype.closeNode=function(A,z){if(z==null){z=null}if(z===null){z=this.options.slide}if(A.isFolder()){new q(A,this).close(z);return this._saveState()}};x.prototype.isDragging=function(){if(this.dnd_handler){return this.dnd_handler.is_dragging}else{return false}};x.prototype.refreshHitAreas=function(){return this.dnd_handler.refresh()};x.prototype.addNodeAfter=function(A,z){var B;B=z.addAfter(A);this._refreshElements(z.parent);return B};x.prototype.addNodeBefore=function(A,z){var B;B=z.addBefore(A);this._refreshElements(z.parent);return B};x.prototype.addParentNode=function(A,z){var B;B=z.addParent(A);this._refreshElements(B.parent);return B};x.prototype.removeNode=function(A){var z;z=A.parent;if(z){this.select_node_handler.removeFromSelection(A,true);A.remove();return this._refreshElements(z)}};x.prototype.appendNode=function(A,B){var z;B=B||this.tree;z=B.append(A);this._refreshElements(B);return z};x.prototype.prependNode=function(A,B){var z;if(!B){B=this.tree}z=B.prepend(A);this._refreshElements(B);return z};x.prototype.updateNode=function(z,B){var A;A=B.id&&B.id!==z.id;if(A){this.tree.removeNodeFromIndex(z)}z.setData(B);if(A){this.tree.addNodeToIndex(z)}this.renderer.renderFromNode(z);return this._selectCurrentNode()};x.prototype.moveNode=function(B,C,z){var A;A=w.nameToIndex(z);this.tree.moveNode(B,C,A);return this._refreshElements()};x.prototype.getStateFromStorage=function(){return this.save_state_handler.getStateFromStorage()};x.prototype.addToSelection=function(z){if(z){this.select_node_handler.addToSelection(z);this._getNodeElementForNode(z).select();return this._saveState()}};x.prototype.getSelectedNodes=function(){return this.select_node_handler.getSelectedNodes()};x.prototype.isNodeSelected=function(z){return this.select_node_handler.isNodeSelected(z)};x.prototype.removeFromSelection=function(z){this.select_node_handler.removeFromSelection(z);this._getNodeElementForNode(z).deselect();return this._saveState()};x.prototype.scrollToNode=function(A){var z,B;z=$(A.element);B=z.offset().top-this.$el.offset().top;return this.scroll_handler.scrollTo(B)};x.prototype.getState=function(){return this.save_state_handler.getState()};x.prototype.setState=function(z){this.save_state_handler.setInitialState(z);return this._refreshElements()};x.prototype.setOption=function(z,A){return this.options[z]=A};x.prototype.moveDown=function(){if(this.key_handler){return this.key_handler.moveDown()}};x.prototype.moveUp=function(){if(this.key_handler){return this.key_handler.moveUp()}};x.prototype.getVersion=function(){return o};x.prototype._init=function(){x.__super__._init.call(this);this.element=this.$el;this.mouse_delay=300;this.is_initialized=false;this.renderer=new p(this);if(b!=null){this.save_state_handler=new b(this)}else{this.options.saveState=false}if(m!=null){this.select_node_handler=new m(this)}if(n!=null){this.dnd_handler=new n(this)}else{this.options.dragAndDrop=false}if(k!=null){this.scroll_handler=new k(this)}if((h!=null)&&(m!=null)){this.key_handler=new h(this)}this._initData();this.element.click($.proxy(this._click,this));this.element.dblclick($.proxy(this._dblclick,this));if(this.options.useContextMenu){return this.element.bind("contextmenu",$.proxy(this._contextmenu,this))}};x.prototype._deinit=function(){this.element.empty();this.element.unbind();if(this.key_handler){this.key_handler.deinit()}this.tree=null;return x.__super__._deinit.call(this)};x.prototype._initData=function(){if(this.options.data){return this._loadData(this.options.data)}else{return this._loadDataFromUrl(this._getDataUrlInfo())}};x.prototype._getDataUrlInfo=function(A){var z,B;z=this.options.dataUrl||this.element.data("url");B=(function(C){return function(){var F,E,D;D={url:z};if(A&&A.id){F={node:A.id};D.data=F}else{E=C._getNodeIdToBeSelected();if(E){F={selected_node:E};D.data=F}}return D}})(this);if($.isFunction(z)){return z(A)}else{if($.type(z)==="string"){return B()}else{return z}}};x.prototype._getNodeIdToBeSelected=function(){if(this.options.saveState){return this.save_state_handler.getNodeIdToBeSelected()}else{return null}};x.prototype._initTree=function(A){var z;this.tree=new this.options.nodeClass(null,true,this.options.nodeClass);if(this.select_node_handler){this.select_node_handler.clear()}this.tree.loadFromData(A);z=this._setInitialState();this._refreshElements();if(z){this._setInitialStateOnDemand()}if(!this.is_initialized){this.is_initialized=true;return this._triggerEvent("tree.init")}};x.prototype._setInitialState=function(){var C,D,A,B,z;z=(function(E){return function(){var F,G;if(!(E.options.saveState&&E.save_state_handler)){return[false,false]}else{G=E.save_state_handler.getStateFromStorage();if(!G){return[false,false]}else{F=E.save_state_handler.setInitialState(G);return[true,F]}}}})(this);C=(function(E){return function(){var F,G;if(E.options.autoOpen===false){return false}F=E._getAutoOpenMaxLevel();G=false;E.tree.iterate(function(H,I){if(H.load_on_demand){G=true;return false}else{if(!H.hasChildren()){return false}else{H.is_open=true;return I!==F}}});return G}})(this);B=z(),D=B[0],A=B[1];if(!D){A=C()}return A};x.prototype._setInitialStateOnDemand=function(){var A,z;z=(function(B){return function(){var C;if(!(B.options.saveState&&B.save_state_handler)){return false}else{C=B.save_state_handler.getStateFromStorage();if(!C){return false}else{B.save_state_handler.setInitialStateOnDemand(C);return true}}}})(this);A=(function(B){return function(){var F,E,D,C;D=B._getAutoOpenMaxLevel();E=[];F=function(G){return B._openNode(G,false,C)};C=function(){return B.tree.iterate(function(G,H){if(G.load_on_demand){if(!G.is_loading){F(G)}return false}else{B._openNode(G,false);return H!==D}})};return C()}})(this);if(!z()){return A()}};x.prototype._getAutoOpenMaxLevel=function(){if(this.options.autoOpen===true){return -1}else{return parseInt(this.options.autoOpen)}};x.prototype._refreshElements=function(z){if(z==null){z=null}this.renderer.render(z);return this._triggerEvent("tree.refresh")};x.prototype._click=function(B){var C,A,z;C=this._getClickTarget(B.target);if(C){if(C.type==="button"){this.toggle(C.node,this.options.slide);B.preventDefault();return B.stopPropagation()}else{if(C.type==="label"){z=C.node;A=this._triggerEvent("tree.click",{node:z,click_event:B});if(!A.isDefaultPrevented()){return this._selectNode(z,true)}}}}};x.prototype._dblclick=function(z){var A;A=this._getClickTarget(z.target);if(A&&A.type==="label"){return this._triggerEvent("tree.dblclick",{node:A.node,click_event:z})}};x.prototype._getClickTarget=function(B){var D,A,z,C;z=$(B);D=z.closest(".jqtree-toggler");if(D.length){C=this._getNode(D);if(C){return{type:"button",node:C}}}else{A=z.closest(".jqtree-element");if(A.length){C=this._getNode(A);if(C){return{type:"label",node:C}}}}return null};x.prototype._getNode=function(z){var A;A=z.closest("li.jqtree_common");if(A.length===0){return null}else{return A.data("node")}};x.prototype._getNodeElementForNode=function(z){if(z.isFolder()){return new q(z,this)}else{return new i(z,this)}};x.prototype._getNodeElement=function(z){var A;A=this._getNode(z);if(A){return this._getNodeElementForNode(A)}else{return null}};x.prototype._contextmenu=function(B){var z,A;z=$(B.target).closest("ul.jqtree-tree .jqtree-element");if(z.length){A=this._getNode(z);if(A){B.preventDefault();B.stopPropagation();this._triggerEvent("tree.contextmenu",{node:A,click_event:B});return false}}};x.prototype._saveState=function(){if(this.options.saveState){return this.save_state_handler.saveState()}};x.prototype._mouseCapture=function(z){if(this.options.dragAndDrop){return this.dnd_handler.mouseCapture(z)}else{return false}};x.prototype._mouseStart=function(z){if(this.options.dragAndDrop){return this.dnd_handler.mouseStart(z)}else{return false}};x.prototype._mouseDrag=function(A){var z;if(this.options.dragAndDrop){z=this.dnd_handler.mouseDrag(A);if(this.scroll_handler){this.scroll_handler.checkScrolling()}return z}else{return false}};x.prototype._mouseStop=function(z){if(this.options.dragAndDrop){return this.dnd_handler.mouseStop(z)}else{return false}};x.prototype._triggerEvent=function(B,z){var A;A=$.Event(B);$.extend(A,z);this.element.trigger(A);return A};x.prototype.testGenerateHitAreas=function(z){this.dnd_handler.current_item=this._getNodeElementForNode(z);this.dnd_handler.generateHitAreas();return this.dnd_handler.hit_areas};x.prototype._selectCurrentNode=function(){var z;z=this.getSelectedNode();if(z){d=this._getNodeElementForNode(z);if(d){return d.select()}}};x.prototype._deselectCurrentNode=function(){var z;z=this.getSelectedNode();if(z){return this.removeFromSelection(z)}};return x})(g);f.getModule=function(y){var x;x={node:v,util:c};return x[y]};l.register(f,"tree")},{"./drag_and_drop_handler":1,"./elements_renderer":2,"./key_handler":3,"./mouse.widget":4,"./node":5,"./node_element":6,"./save_state_handler":7,"./scroll_handler":8,"./select_node_handler":9,"./simple.widget":10,"./util":12,"./version":13}],12:[function(b,d,a){var c,g,f,h;c=function(p,n){var m,l,k,o;for(m=l=0,k=p.length;l<k;m=++l){o=p[m];if(o===n){return m}}return -1};f=function(j,i){if(j.indexOf){return j.indexOf(i)}else{return c(j,i)}};h=function(i){return typeof i==="number"&&i%1===0};g=function(i){return(""+i).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};d.exports={_indexOf:c,html_escape:g,indexOf:f,isInt:h}},{}],13:[function(b,c,a){c.exports="1.0.0"},{}]},{},[11]);