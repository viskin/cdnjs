(function e(b,g,d){function c(m,j){if(!g[m]){if(!b[m]){var i=typeof require=="function"&&require;if(!j&&i){return i(m,!0)}if(a){return a(m,!0)}var k=new Error("Cannot find module '"+m+"'");throw k.code="MODULE_NOT_FOUND",k}var h=g[m]={exports:{}};b[m][0].call(h.exports,function(l){var o=b[m][1][l];return c(o?o:l)},h,h.exports,e,b,g,d)}return g[m].exports}var a=typeof require=="function"&&require;for(var f=0;f<d.length;f++){c(d[f])}return c})({1:[function(c,a,d){var f,m,g,i,b,h,l,k=function(q,o){for(var n in o){if(j.call(o,n)){q[n]=o[n]}}function p(){this.constructor=q}p.prototype=o.prototype;q.prototype=new p();q.__super__=o.prototype;return q},j={}.hasOwnProperty;l=c("./node");b=l.Position;f=jQuery;m=(function(){function n(o){this.tree_widget=o;this.hovered_area=null;this.$ghost=null;this.hit_areas=[];this.is_dragging=false;this.current_item=null}n.prototype.mouseCapture=function(p){var o,q;o=f(p.target);if(!this.mustCaptureElement(o)){return null}if(this.tree_widget.options.onIsMoveHandle&&!this.tree_widget.options.onIsMoveHandle(o)){return null}q=this.tree_widget._getNodeElement(o);if(q&&this.tree_widget.options.onCanMove){if(!this.tree_widget.options.onCanMove(q.node)){q=null}}this.current_item=q;return this.current_item!==null};n.prototype.mouseStart=function(o){var p;this.refresh();p=f(o.target).offset();this.drag_element=new g(this.current_item.node,o.page_x-p.left,o.page_y-p.top,this.tree_widget.element);this.is_dragging=true;this.current_item.$element.addClass("jqtree-moving");return true};n.prototype.mouseDrag=function(o){var q,p;this.drag_element.move(o.page_x,o.page_y);q=this.findHoveredArea(o.page_x,o.page_y);p=this.canMoveToArea(q);if(p&&q){if(!q.node.isFolder()){this.stopOpenFolderTimer()}if(this.hovered_area!==q){this.hovered_area=q;if(this.mustOpenFolderTimer(q)){this.startOpenFolderTimer(q.node)}else{this.stopOpenFolderTimer()}this.updateDropHint()}}else{this.removeHover();this.removeDropHint();this.stopOpenFolderTimer()}return true};n.prototype.mustCaptureElement=function(o){return !o.is("input,select")};n.prototype.canMoveToArea=function(o){var p;if(!o){return false}else{if(this.tree_widget.options.onCanMoveTo){p=b.getName(o.position);return this.tree_widget.options.onCanMoveTo(this.current_item.node,o.node,p)}else{return true}}};n.prototype.mouseStop=function(o){this.moveItem(o);this.clear();this.removeHover();this.removeDropHint();this.removeHitAreas();if(this.current_item){this.current_item.$element.removeClass("jqtree-moving");this.current_item=null}this.is_dragging=false;return false};n.prototype.refresh=function(){this.removeHitAreas();if(this.current_item){this.generateHitAreas();this.current_item=this.tree_widget._getNodeElementForNode(this.current_item.node);if(this.is_dragging){return this.current_item.$element.addClass("jqtree-moving")}}};n.prototype.removeHitAreas=function(){return this.hit_areas=[]};n.prototype.clear=function(){this.drag_element.remove();return this.drag_element=null};n.prototype.removeDropHint=function(){if(this.previous_ghost){return this.previous_ghost.remove()}};n.prototype.removeHover=function(){return this.hovered_area=null};n.prototype.generateHitAreas=function(){var o;o=new i(this.tree_widget.tree,this.current_item.node,this.getTreeDimensions().bottom);return this.hit_areas=o.generate()};n.prototype.findHoveredArea=function(p,u){var s,r,t,o,q;r=this.getTreeDimensions();if(p<r.left||u<r.top||p>r.right||u>r.bottom){return null}o=0;t=this.hit_areas.length;while(o<t){q=(o+t)>>1;s=this.hit_areas[q];if(u<s.top){t=q}else{if(u>s.bottom){o=q+1}else{return s}}}return null};n.prototype.mustOpenFolderTimer=function(p){var o;o=p.node;return o.isFolder()&&!o.is_open&&p.position===b.INSIDE};n.prototype.updateDropHint=function(){var o;if(!this.hovered_area){return}this.removeDropHint();o=this.tree_widget._getNodeElementForNode(this.hovered_area.node);return this.previous_ghost=o.addDropHint(this.hovered_area.position)};n.prototype.startOpenFolderTimer=function(p){var o;o=(function(q){return function(){return q.tree_widget._openNode(p,q.tree_widget.options.slide,function(){q.refresh();return q.updateDropHint()})}})(this);this.stopOpenFolderTimer();return this.open_folder_timer=setTimeout(o,this.tree_widget.options.openFolderDelay)};n.prototype.stopOpenFolderTimer=function(){if(this.open_folder_timer){clearTimeout(this.open_folder_timer);return this.open_folder_timer=null}};n.prototype.moveItem=function(q){var r,t,s,o,p,u;if(this.hovered_area&&this.hovered_area.position!==b.NONE&&this.canMoveToArea(this.hovered_area)){s=this.current_item.node;u=this.hovered_area.node;o=this.hovered_area.position;p=s.parent;if(o===b.INSIDE){this.hovered_area.node.is_open=true}r=(function(v){return function(){v.tree_widget.tree.moveNode(s,u,o);v.tree_widget.element.empty();return v.tree_widget._refreshElements()}})(this);t=this.tree_widget._triggerEvent("tree.move",{move_info:{moved_node:s,target_node:u,position:b.getName(o),previous_parent:p,do_move:r,original_event:q.original_event}});if(!t.isDefaultPrevented()){return r()}}};n.prototype.getTreeDimensions=function(){var o;o=this.tree_widget.element.offset();return{left:o.left,top:o.top,right:o.left+this.tree_widget.element.width(),bottom:o.top+this.tree_widget.element.height()+16}};return n})();h=(function(){function n(o){this.tree=o}n.prototype.iterate=function(){var p,o;o=true;p=(function(q){return function(u,r){var A,s,z,w,v,x,y,t;y=(u.is_open||!u.element)&&u.hasChildren();if(u.element){A=f(u.element);if(!A.is(":visible")){return}if(o){q.handleFirstNode(u,A);o=false}if(!u.hasChildren()){q.handleNode(u,r,A)}else{if(u.is_open){if(!q.handleOpenFolder(u,A)){y=false}}else{q.handleClosedFolder(u,r,A)}}}if(y){z=u.children.length;t=u.children;for(w=v=0,x=t.length;v<x;w=++v){s=t[w];if(w===(z-1)){p(u.children[w],null)}else{p(u.children[w],u.children[w+1])}}if(u.is_open){return q.handleAfterOpenFolder(u,r,A)}}}})(this);return p(this.tree,null)};n.prototype.handleNode=function(q,p,o){};n.prototype.handleOpenFolder=function(p,o){};n.prototype.handleClosedFolder=function(q,p,o){};n.prototype.handleAfterOpenFolder=function(q,p,o){};n.prototype.handleFirstNode=function(p,o){};return n})();i=(function(n){k(o,n);function o(p,r,q){o.__super__.constructor.call(this,p);this.current_node=r;this.tree_bottom=q}o.prototype.generate=function(){this.positions=[];this.last_top=0;this.iterate();return this.generateHitAreas(this.positions)};o.prototype.getTop=function(p){return p.offset().top};o.prototype.addPosition=function(r,p,s){var q;q={top:s,node:r,position:p};this.positions.push(q);return this.last_top=s};o.prototype.handleNode=function(r,q,p){var s;s=this.getTop(p);if(r===this.current_node){this.addPosition(r,b.NONE,s)}else{this.addPosition(r,b.INSIDE,s)}if(q===this.current_node||r===this.current_node){return this.addPosition(r,b.NONE,s)}else{return this.addPosition(r,b.AFTER,s)}};o.prototype.handleOpenFolder=function(q,p){if(q===this.current_node){return false}if(q.children[0]!==this.current_node){this.addPosition(q,b.INSIDE,this.getTop(p))}return true};o.prototype.handleClosedFolder=function(r,q,p){var s;s=this.getTop(p);if(r===this.current_node){return this.addPosition(r,b.NONE,s)}else{this.addPosition(r,b.INSIDE,s);if(q!==this.current_node){return this.addPosition(r,b.AFTER,s)}}};o.prototype.handleFirstNode=function(q,p){if(q!==this.current_node){return this.addPosition(q,b.BEFORE,this.getTop(f(q.element)))}};o.prototype.handleAfterOpenFolder=function(r,q,p){if(r===this.current_node.node||q===this.current_node.node){return this.addPosition(r,b.NONE,this.last_top)}else{return this.addPosition(r,b.AFTER,this.last_top)}};o.prototype.generateHitAreas=function(r){var v,t,s,q,p,u;u=-1;v=[];t=[];for(s=0,q=r.length;s<q;s++){p=r[s];if(p.top!==u&&v.length){if(v.length){this.generateHitAreasForGroup(t,v,u,p.top)}u=p.top;v=[]}v.push(p)}this.generateHitAreasForGroup(t,v,u,this.tree_bottom);return t};o.prototype.generateHitAreasForGroup=function(r,s,v,p){var q,x,t,u,w;w=Math.min(s.length,4);q=Math.round((p-v)/w);x=v;t=0;while(t<w){u=s[t];r.push({top:x,bottom:x+q,node:u.node,position:u.position});x+=q;t+=1}return null};return o})(h);g=(function(){function n(q,p,o,r){this.offset_x=p;this.offset_y=o;this.$element=f('<span class="jqtree-title jqtree-dragging">'+q.name+"</span>");this.$element.css("position","absolute");r.append(this.$element)}n.prototype.move=function(p,o){return this.$element.offset({left:p-this.offset_x,top:o-this.offset_y})};n.prototype.remove=function(){return this.$element.remove()};return n})();a.exports=m},{"./node":5}],2:[function(b,a,f){var g,j,d,i,c,h;c=b("./node_element");d=c.NodeElement;h=b("./util");i=h.html_escape;g=jQuery;j=(function(){function k(l){this.tree_widget=l;this.opened_icon_element=this.createButtonElement(l.options.openedIcon);this.closed_icon_element=this.createButtonElement(l.options.closedIcon)}k.prototype.render=function(l){if(l&&l.parent){return this.renderFromNode(l)}else{return this.renderFromRoot()}};k.prototype.renderFromRoot=function(){var l;l=this.tree_widget.element;l.empty();return this.createDomElements(l[0],this.tree_widget.tree.children,true,true)};k.prototype.renderFromNode=function(n){var m,l;m=g(n.element);l=this.createLi(n);this.attachNodeData(n,l);m.after(l);m.remove();if(n.children){return this.createDomElements(l,n.children,false,false)}};k.prototype.createDomElements=function(o,m,t,n){var l,p,q,s,r;r=this.createUl(t);o.appendChild(r);for(p=0,q=m.length;p<q;p++){l=m[p];s=this.createLi(l);r.appendChild(s);this.attachNodeData(l,s);if(l.hasChildren()){this.createDomElements(s,l.children,false,l.is_open)}}return null};k.prototype.attachNodeData=function(m,l){m.element=l;return g(l).data("node",m)};k.prototype.createUl=function(n){var m,l;if(!n){m=""}else{m="jqtree-tree";if(this.tree_widget.options.rtl){m+=" jqtree-rtl"}}l=document.createElement("ul");l.className="jqtree_common "+m;return l};k.prototype.createLi=function(m){var l;if(m.isFolder()){l=this.createFolderLi(m)}else{l=this.createNodeLi(m)}if(this.tree_widget.options.onCreateLi){this.tree_widget.options.onCreateLi(m,g(l))}return l};k.prototype.createFolderLi=function(p){var n,q,m,o,l,s,t,r;n=this.getButtonClasses(p);l=this.getFolderClasses(p);o=this.escapeIfNecessary(p.name);if(p.is_open){s=this.opened_icon_element}else{s=this.closed_icon_element}t=document.createElement("li");t.className="jqtree_common "+l;m=document.createElement("div");m.className="jqtree-element jqtree_common";t.appendChild(m);q=document.createElement("a");q.className="jqtree_common "+n;q.appendChild(s.cloneNode(false));m.appendChild(q);r=document.createElement("span");r.className="jqtree_common jqtree-title jqtree-title-folder";m.appendChild(r);r.innerHTML=o;return t};k.prototype.createNodeLi=function(o){var q,r,n,l,p,m;p=["jqtree_common"];if(this.tree_widget.select_node_handler&&this.tree_widget.select_node_handler.isNodeSelected(o)){p.push("jqtree-selected")}q=p.join(" ");n=this.escapeIfNecessary(o.name);l=document.createElement("li");l.className=q;r=document.createElement("div");r.className="jqtree-element jqtree_common";l.appendChild(r);m=document.createElement("span");m.className="jqtree-title jqtree_common";m.innerHTML=n;r.appendChild(m);return l};k.prototype.getButtonClasses=function(m){var l;l=["jqtree-toggler"];if(!m.is_open){l.push("jqtree-closed")}return l.join(" ")};k.prototype.getFolderClasses=function(m){var l;l=["jqtree-folder"];if(!m.is_open){l.push("jqtree-closed")}if(this.tree_widget.select_node_handler&&this.tree_widget.select_node_handler.isNodeSelected(m)){l.push("jqtree-selected")}if(m.is_loading){l.push("jqtree-loading")}return l.join(" ")};k.prototype.escapeIfNecessary=function(l){if(this.tree_widget.options.autoEscape){return i(l)}else{return l}};k.prototype.createButtonElement=function(l){var m;if(typeof l==="string"){m=document.createElement("div");m.innerHTML=l;return document.createTextNode(m.innerHTML)}else{return g(l)[0]}};return k})();a.exports=j},{"./node_element":6,"./util":12}],3:[function(b,d,a){var f,c,g=function(h,i){return function(){return h.apply(i,arguments)}};f=jQuery;c=(function(){var l,i,k,h;i=37;h=38;k=39;l=40;function j(m){this.selectNode=g(this.selectNode,this);this.tree_widget=m;if(m.options.keyboardSupport){f(document).bind("keydown.jqtree",f.proxy(this.handleKeyDown,this))}}j.prototype.deinit=function(){return f(document).unbind("keydown.jqtree")};j.prototype.moveDown=function(){var m;m=this.tree_widget.getSelectedNode();if(m){return this.selectNode(m.getNextNode())}else{return false}};j.prototype.moveUp=function(){var m;m=this.tree_widget.getSelectedNode();if(m){return this.selectNode(m.getPreviousNode())}else{return false}};j.prototype.moveRight=function(){var m;m=this.tree_widget.getSelectedNode();if(m&&m.isFolder()&&!m.is_open){this.tree_widget.openNode(m);return false}else{return true}};j.prototype.moveLeft=function(){var m;m=this.tree_widget.getSelectedNode();if(m&&m.isFolder()&&m.is_open){this.tree_widget.closeNode(m);return false}else{return true}};j.prototype.handleKeyDown=function(n){var m;if(!this.tree_widget.options.keyboardSupport){return true}if(f(document.activeElement).is("textarea,input,select")){return true}if(!this.tree_widget.getSelectedNode()){return true}m=n.which;switch(m){case l:return this.moveDown();case h:return this.moveUp();case k:return this.moveRight();case i:return this.moveLeft()}return true};j.prototype.selectNode=function(m){if(!m){return true}else{this.tree_widget.selectNode(m);if(this.tree_widget.scroll_handler&&(!this.tree_widget.scroll_handler.isScrolledIntoView(f(m.element).find(".jqtree-element")))){this.tree_widget.scrollToNode(m)}return false}};return j})();d.exports=c},{}],4:[function(b,c,a){var f,h,g,i=function(m,k){for(var j in k){if(d.call(k,j)){m[j]=k[j]}}function l(){this.constructor=m}l.prototype=k.prototype;m.prototype=new l();m.__super__=k.prototype;return m},d={}.hasOwnProperty;g=b("./simple.widget");f=jQuery;h=(function(j){i(k,j);function k(){return k.__super__.constructor.apply(this,arguments)}k.is_mouse_handled=false;k.prototype._init=function(){this.$el.bind("mousedown.mousewidget",f.proxy(this._mouseDown,this));this.$el.bind("touchstart.mousewidget",f.proxy(this._touchStart,this));this.is_mouse_started=false;this.mouse_delay=0;this._mouse_delay_timer=null;this._is_mouse_delay_met=true;return this.mouse_down_info=null};k.prototype._deinit=function(){var l;this.$el.unbind("mousedown.mousewidget");this.$el.unbind("touchstart.mousewidget");l=f(document);l.unbind("mousemove.mousewidget");return l.unbind("mouseup.mousewidget")};k.prototype._mouseDown=function(m){var l;if(m.which!==1){return}l=this._handleMouseDown(m,this._getPositionInfo(m));if(l){m.preventDefault()}return l};k.prototype._handleMouseDown=function(m,l){if(k.is_mouse_handled){return}if(this.is_mouse_started){this._handleMouseUp(l)}this.mouse_down_info=l;if(!this._mouseCapture(l)){return}this._handleStartMouse();this.is_mouse_handled=true;return true};k.prototype._handleStartMouse=function(){var l;l=f(document);l.bind("mousemove.mousewidget",f.proxy(this._mouseMove,this));l.bind("touchmove.mousewidget",f.proxy(this._touchMove,this));l.bind("mouseup.mousewidget",f.proxy(this._mouseUp,this));l.bind("touchend.mousewidget",f.proxy(this._touchEnd,this));if(this.mouse_delay){return this._startMouseDelayTimer()}};k.prototype._startMouseDelayTimer=function(){if(this._mouse_delay_timer){clearTimeout(this._mouse_delay_timer)}this._mouse_delay_timer=setTimeout((function(l){return function(){return l._is_mouse_delay_met=true}})(this),this.mouse_delay);return this._is_mouse_delay_met=false};k.prototype._mouseMove=function(l){return this._handleMouseMove(l,this._getPositionInfo(l))};k.prototype._handleMouseMove=function(m,l){if(this.is_mouse_started){this._mouseDrag(l);return m.preventDefault()}if(this.mouse_delay&&!this._is_mouse_delay_met){return true}this.is_mouse_started=this._mouseStart(this.mouse_down_info)!==false;if(this.is_mouse_started){this._mouseDrag(l)}else{this._handleMouseUp(l)}return !this.is_mouse_started};k.prototype._getPositionInfo=function(l){return{page_x:l.pageX,page_y:l.pageY,target:l.target,original_event:l}};k.prototype._mouseUp=function(l){return this._handleMouseUp(this._getPositionInfo(l))};k.prototype._handleMouseUp=function(l){var m;m=f(document);m.unbind("mousemove.mousewidget");m.unbind("touchmove.mousewidget");m.unbind("mouseup.mousewidget");m.unbind("touchend.mousewidget");if(this.is_mouse_started){this.is_mouse_started=false;this._mouseStop(l)}};k.prototype._mouseCapture=function(l){return true};k.prototype._mouseStart=function(l){return null};k.prototype._mouseDrag=function(l){return null};k.prototype._mouseStop=function(l){return null};k.prototype.setMouseDelay=function(l){return this.mouse_delay=l};k.prototype._touchStart=function(l){var m;if(l.originalEvent.touches.length>1){return}m=l.originalEvent.changedTouches[0];return this._handleMouseDown(l,this._getPositionInfo(m))};k.prototype._touchMove=function(l){var m;if(l.originalEvent.touches.length>1){return}m=l.originalEvent.changedTouches[0];return this._handleMouseMove(l,this._getPositionInfo(m))};k.prototype._touchEnd=function(l){var m;if(l.originalEvent.touches.length>1){return}m=l.originalEvent.changedTouches[0];return this._handleMouseUp(this._getPositionInfo(m))};return k})(g);c.exports=h},{"./simple.widget":10}],5:[function(d,f,b){var g,c,a;g=jQuery;a={getName:function(h){return a.strings[h-1]},nameToIndex:function(k){var l,h,m;for(l=h=1,m=a.strings.length;1<=m?h<=m:h>=m;l=1<=m?++h:--h){if(a.strings[l-1]===k){return l}}return 0}};a.BEFORE=1;a.AFTER=2;a.INSIDE=3;a.NONE=4;a.strings=["before","after","inside","none"];c=(function(){function h(j,i,k){if(i==null){i=false}if(k==null){k=h}this.setData(j);this.children=[];this.parent=null;if(i){this.id_mapping={};this.tree=this;this.node_class=k}}h.prototype.setData=function(k){var i,j;if(typeof k!=="object"){this.name=k}else{for(i in k){j=k[i];if(i==="label"){this.name=j}else{this[i]=j}}}return null};h.prototype.initFromData=function(j){var i,k;k=(function(l){return function(m){l.setData(m);if(m.children){return i(m.children)}}})(this);i=(function(l){return function(p){var q,n,m,o;for(n=0,m=p.length;n<m;n++){q=p[n];o=new l.tree.node_class("");o.initFromData(q);l.addChild(o)}return null}})(this);k(j);return null};h.prototype.loadFromData=function(m){var k,i,l,n;this.removeChildren();for(k=0,i=m.length;k<i;k++){n=m[k];l=new this.tree.node_class(n);this.addChild(l);if(typeof n==="object"&&n.children){l.loadFromData(n.children)}}return null};h.prototype.addChild=function(i){this.children.push(i);return i._setParent(this)};h.prototype.addChildAtPosition=function(j,i){this.children.splice(i,0,j);return j._setParent(this)};h.prototype._setParent=function(i){this.parent=i;this.tree=i.tree;return this.tree.addNodeToIndex(this)};h.prototype.removeChild=function(i){i.removeChildren();return this._removeChild(i)};h.prototype._removeChild=function(i){this.children.splice(this.getChildIndex(i),1);return this.tree.removeNodeFromIndex(i)};h.prototype.getChildIndex=function(i){return g.inArray(i,this.children)};h.prototype.hasChildren=function(){return this.children.length!==0};h.prototype.isFolder=function(){return this.hasChildren()||this.load_on_demand};h.prototype.iterate=function(j){var i;i=function(o,q){var p,m,l,n,k;if(o.children){n=o.children;for(m=0,l=n.length;m<l;m++){p=n[m];k=j(p,q);if(k&&p.hasChildren()){i(p,q+1)}}return null}};i(this,0);return null};h.prototype.moveNode=function(j,k,i){if(j.isParentOf(k)){return}j.parent._removeChild(j);if(i===a.AFTER){return k.parent.addChildAtPosition(j,k.parent.getChildIndex(k)+1)}else{if(i===a.BEFORE){return k.parent.addChildAtPosition(j,k.parent.getChildIndex(k))}else{if(i===a.INSIDE){return k.addChildAtPosition(j,0)}}}};h.prototype.getData=function(i){var j;if(i==null){i=false}j=function(o){var s,p,n,l,r,q,m;s=[];for(p=0,l=o.length;p<l;p++){r=o[p];q={};for(n in r){m=r[n];if((n!=="parent"&&n!=="children"&&n!=="element"&&n!=="tree")&&Object.prototype.hasOwnProperty.call(r,n)){q[n]=m}}if(r.hasChildren()){q.children=j(r.children)}s.push(q)}return s};if(i){return j([this])}else{return j(this.children)}};h.prototype.getNodeByName=function(j){var i;i=null;this.iterate(function(k){if(k.name===j){i=k;return false}else{return true}});return i};h.prototype.addAfter=function(j){var k,i;if(!this.parent){return null}else{i=new this.tree.node_class(j);k=this.parent.getChildIndex(this);this.parent.addChildAtPosition(i,k+1);return i}};h.prototype.addBefore=function(j){var k,i;if(!this.parent){return null}else{i=new this.tree.node_class(j);k=this.parent.getChildIndex(this);this.parent.addChildAtPosition(i,k);return i}};h.prototype.addParent=function(n){var p,k,i,o,m,l;if(!this.parent){return null}else{o=new this.tree.node_class(n);o._setParent(this.tree);m=this.parent;l=m.children;for(k=0,i=l.length;k<i;k++){p=l[k];o.addChild(p)}m.children=[];m.addChild(o);return o}};h.prototype.remove=function(){if(this.parent){this.parent.removeChild(this);return this.parent=null}};h.prototype.append=function(j){var i;i=new this.tree.node_class(j);this.addChild(i);return i};h.prototype.prepend=function(j){var i;i=new this.tree.node_class(j);this.addChildAtPosition(i,0);return i};h.prototype.isParentOf=function(j){var i;i=j.parent;while(i){if(i===this){return true}i=i.parent}return false};h.prototype.getLevel=function(){var j,i;j=0;i=this;while(i.parent){j+=1;i=i.parent}return j};h.prototype.getNodeById=function(i){return this.id_mapping[i]};h.prototype.addNodeToIndex=function(i){if(i.id!=null){return this.id_mapping[i.id]=i}};h.prototype.removeNodeFromIndex=function(i){if(i.id!=null){return delete this.id_mapping[i.id]}};h.prototype.removeChildren=function(){this.iterate((function(i){return function(j){i.tree.removeNodeFromIndex(j);return true}})(this));return this.children=[]};h.prototype.getPreviousSibling=function(){var i;if(!this.parent){return null}else{i=this.parent.getChildIndex(this)-1;if(i>=0){return this.parent.children[i]}else{return null}}};h.prototype.getNextSibling=function(){var i;if(!this.parent){return null}else{i=this.parent.getChildIndex(this)+1;if(i<this.parent.children.length){return this.parent.children[i]}else{return null}}};h.prototype.getNodesByProperty=function(i,j){return this.filter(function(k){return k[i]===j})};h.prototype.filter=function(j){var i;i=[];this.iterate(function(k){if(j(k)){i.push(k)}return true});return i};h.prototype.getNextNode=function(j){var i;if(j==null){j=true}if(j&&this.hasChildren()&&this.is_open){return this.children[0]}else{if(!this.parent){return null}else{i=this.getNextSibling();if(i){return i}else{return this.parent.getNextNode(false)}}}};h.prototype.getPreviousNode=function(){var i;if(!this.parent){return null}else{i=this.getPreviousSibling();if(i){if(!i.hasChildren()||!i.is_open){return i}else{return i.getLastChild()}}else{if(this.parent.parent){return this.parent}else{return null}}}};h.prototype.getLastChild=function(){var i;if(!this.hasChildren()){return null}else{i=this.children[this.children.length-1];if(!i.hasChildren()||!i.is_open){return i}else{return i.getLastChild()}}};return h})();f.exports={Node:c,Position:a}},{}],6:[function(f,b,i){var j,a,h,k,g,c,d,m=function(q,o){for(var n in o){if(l.call(o,n)){q[n]=o[n]}}function p(){this.constructor=q}p.prototype=o.prototype;q.prototype=new p();q.__super__=o.prototype;return q},l={}.hasOwnProperty;d=f("./node");c=d.Position;j=jQuery;g=(function(){function n(o,p){this.init(o,p)}n.prototype.init=function(o,p){this.node=o;this.tree_widget=p;if(!o.element){o.element=this.tree_widget.element}return this.$element=j(o.element)};n.prototype.getUl=function(){return this.$element.children("ul:first")};n.prototype.getSpan=function(){return this.$element.children(".jqtree-element").find("span.jqtree-title")};n.prototype.getLi=function(){return this.$element};n.prototype.addDropHint=function(o){if(o===c.INSIDE){return new a(this.$element)}else{return new k(this.node,this.$element,o)}};n.prototype.select=function(){return this.getLi().addClass("jqtree-selected")};n.prototype.deselect=function(){return this.getLi().removeClass("jqtree-selected")};return n})();h=(function(o){m(n,o);function n(){return n.__super__.constructor.apply(this,arguments)}n.prototype.open=function(s,p){var r,q;if(p==null){p=true}if(!this.node.is_open){this.node.is_open=true;r=this.getButton();r.removeClass("jqtree-closed");r.html("");r.append(this.tree_widget.renderer.opened_icon_element.cloneNode(false));q=(function(t){return function(){t.getLi().removeClass("jqtree-closed");if(s){s()}return t.tree_widget._triggerEvent("tree.open",{node:t.node})}})(this);if(p){return this.getUl().slideDown("fast",q)}else{this.getUl().show();return q()}}};n.prototype.close=function(p){var r,q;if(p==null){p=true}if(this.node.is_open){this.node.is_open=false;r=this.getButton();r.addClass("jqtree-closed");r.html("");r.append(this.tree_widget.renderer.closed_icon_element.cloneNode(false));q=(function(s){return function(){s.getLi().addClass("jqtree-closed");return s.tree_widget._triggerEvent("tree.close",{node:s.node})}})(this);if(p){return this.getUl().slideUp("fast",q)}else{this.getUl().hide();return q()}}};n.prototype.getButton=function(){return this.$element.children(".jqtree-element").find("a.jqtree-toggler")};n.prototype.addDropHint=function(p){if(!this.node.is_open&&p===c.INSIDE){return new a(this.$element)}else{return new k(this.node,this.$element,p)}};return n})(g);a=(function(){function n(p){var o,q;o=p.children(".jqtree-element");q=p.width()-4;this.$hint=j('<span class="jqtree-border"></span>');o.append(this.$hint);this.$hint.css({width:q,height:o.outerHeight()-4})}n.prototype.remove=function(){return this.$hint.remove()};return n})();k=(function(){function n(q,p,o){this.$element=p;this.node=q;this.$ghost=j('<li class="jqtree_common jqtree-ghost"><span class="jqtree_common jqtree-circle"></span><span class="jqtree_common jqtree-line"></span></li>');if(o===c.AFTER){this.moveAfter()}else{if(o===c.BEFORE){this.moveBefore()}else{if(o===c.INSIDE){if(q.isFolder()&&q.is_open){this.moveInsideOpenFolder()}else{this.moveInside()}}}}}n.prototype.remove=function(){return this.$ghost.remove()};n.prototype.moveAfter=function(){return this.$element.after(this.$ghost)};n.prototype.moveBefore=function(){return this.$element.before(this.$ghost)};n.prototype.moveInsideOpenFolder=function(){return j(this.node.children[0].element).before(this.$ghost)};n.prototype.moveInside=function(){this.$element.after(this.$ghost);return this.$ghost.addClass("jqtree-inside")};return n})();b.exports={FolderElement:h,NodeElement:g}},{"./node":5}],7:[function(c,d,b){var g,i,f,h,a;a=c("./util");f=a.indexOf;h=a.isInt;g=jQuery;i=(function(){function j(k){this.tree_widget=k}j.prototype.saveState=function(){var k;k=JSON.stringify(this.getState());if(this.tree_widget.options.onSetStateFromStorage){return this.tree_widget.options.onSetStateFromStorage(k)}else{if(this.supportsLocalStorage()){return localStorage.setItem(this.getCookieName(),k)}else{if(g.cookie){g.cookie.raw=true;return g.cookie(this.getCookieName(),k,{path:"/"})}}}};j.prototype.getStateFromStorage=function(){var k;k=this._loadFromStorage();if(k){return this._parseState(k)}else{return null}};j.prototype._parseState=function(l){var k;k=g.parseJSON(l);if(k&&k.selected_node&&h(k.selected_node)){k.selected_node=[k.selected_node]}return k};j.prototype._loadFromStorage=function(){if(this.tree_widget.options.onGetStateFromStorage){return this.tree_widget.options.onGetStateFromStorage()}else{if(this.supportsLocalStorage()){return localStorage.getItem(this.getCookieName())}else{if(g.cookie){g.cookie.raw=true;return g.cookie(this.getCookieName())}else{return null}}}};j.prototype.getState=function(){var l,k;l=(function(m){return function(){var n;n=[];m.tree_widget.tree.iterate(function(o){if(o.is_open&&o.id&&o.hasChildren()){n.push(o.id)}return true});return n}})(this);k=(function(m){return function(){var o;return(function(){var q,n,r,p;r=this.tree_widget.getSelectedNodes();p=[];for(q=0,n=r.length;q<n;q++){o=r[q];p.push(o.id)}return p}).call(m)}})(this);return{open_nodes:l(),selected_node:k()}};j.prototype.setInitialState=function(l){var k;if(!l){return false}else{k=this._openInitialNodes(l.open_nodes);this._selectInitialNodes(l.selected_node);return k}};j.prototype._openInitialNodes=function(n){var m,k,l,o,p;l=false;for(m=0,k=n.length;m<k;m++){p=n[m];o=this.tree_widget.getNodeById(p);if(o){if(!o.load_on_demand){o.is_open=true}else{l=true}}}return l};j.prototype._selectInitialNodes=function(m){var l,k,n,o,p;p=0;for(l=0,k=m.length;l<k;l++){o=m[l];n=this.tree_widget.getNodeById(o);if(n){p+=1;this.tree_widget.select_node_handler.addToSelection(n)}}return p!==0};j.prototype.setInitialStateOnDemand=function(k){if(k){return this._setInitialStateOnDemand(k.open_nodes,k.selected_node)}};j.prototype._setInitialStateOnDemand=function(m,k){var n,l;l=(function(o){return function(){var r,p,q,s,t;q=[];for(r=0,p=m.length;r<p;r++){t=m[r];s=o.tree_widget.getNodeById(t);if(!s){q.push(t)}else{if(!s.is_loading){if(s.load_on_demand){n(s)}else{o.tree_widget._openNode(s,false)}}}}m=q;if(o._selectInitialNodes(k)){return o.tree_widget._refreshElements()}}})(this);n=(function(o){return function(p){return o.tree_widget._openNode(p,false,l)}})(this);return l()};j.prototype.getCookieName=function(){if(typeof this.tree_widget.options.saveState==="string"){return this.tree_widget.options.saveState}else{return"tree"}};j.prototype.supportsLocalStorage=function(){var k;k=function(){var l,m;if(typeof localStorage==="undefined"||localStorage===null){return false}else{try{m="_storage_test";sessionStorage.setItem(m,true);sessionStorage.removeItem(m)}catch(n){l=n;return false}return true}};if(this._supportsLocalStorage==null){this._supportsLocalStorage=k()}return this._supportsLocalStorage};j.prototype.getNodeIdToBeSelected=function(){var k;k=this.getStateFromStorage();if(k&&k.selected_node){return k.selected_node[0]}else{return null}};return j})();d.exports=i},{"./util":12}],8:[function(c,d,a){var f,b;f=jQuery;b=(function(){function g(h){this.tree_widget=h;this.previous_top=-1;this._initScrollParent()}g.prototype._initScrollParent=function(){var h,i,j;i=(function(k){return function(){var q,o,m,n,l,p;q=["overflow","overflow-y"];m=function(t){var v,s,r,u;for(s=0,r=q.length;s<r;s++){v=q[s];if((u=f.css(t,v))==="auto"||u==="scroll"){return true}}return false};if(m(k.tree_widget.$el[0])){return k.tree_widget.$el}p=k.tree_widget.$el.parents();for(n=0,l=p.length;n<l;n++){o=p[n];if(m(o)){return f(o)}}return null}})(this);j=(function(k){return function(){k.scroll_parent_top=0;return k.$scroll_parent=null}})(this);if(this.tree_widget.$el.css("position")==="fixed"){j()}h=i();if(h&&h.length&&h[0].tagName!=="HTML"){this.$scroll_parent=h;return this.scroll_parent_top=this.$scroll_parent.offset().top}else{return j()}};g.prototype.checkScrolling=function(){var h;h=this.tree_widget.dnd_handler.hovered_area;if(h&&h.top!==this.previous_top){this.previous_top=h.top;if(this.$scroll_parent){return this._handleScrollingWithScrollParent(h)}else{return this._handleScrollingWithDocument(h)}}};g.prototype._handleScrollingWithScrollParent=function(i){var h;h=this.scroll_parent_top+this.$scroll_parent[0].offsetHeight-i.bottom;if(h<20){this.$scroll_parent[0].scrollTop+=20;this.tree_widget.refreshHitAreas();return this.previous_top=-1}else{if((i.top-this.scroll_parent_top)<20){this.$scroll_parent[0].scrollTop-=20;this.tree_widget.refreshHitAreas();return this.previous_top=-1}}};g.prototype._handleScrollingWithDocument=function(i){var h;h=i.top-f(document).scrollTop();if(h<20){return f(document).scrollTop(f(document).scrollTop()-20)}else{if(f(window).height()-(i.bottom-f(document).scrollTop())<20){return f(document).scrollTop(f(document).scrollTop()+20)}}};g.prototype.scrollTo=function(i){var h;if(this.$scroll_parent){return this.$scroll_parent[0].scrollTop=i}else{h=this.tree_widget.$el.offset().top;return f(document).scrollTop(i+h)}};g.prototype.isScrolledIntoView=function(i){var h,m,l,k,j;h=f(i);if(this.$scroll_parent){j=0;k=this.$scroll_parent.height();l=h.offset().top-this.scroll_parent_top;m=l+h.height()}else{j=f(window).scrollTop();k=j+f(window).height();l=h.offset().top;m=l+h.height()}return(m<=k)&&(l>=j)};return g})();d.exports=b},{}],9:[function(c,d,b){var f,a;f=jQuery;a=(function(){function g(h){this.tree_widget=h;this.clear()}g.prototype.getSelectedNode=function(){var h;h=this.getSelectedNodes();if(h.length){return h[0]}else{return false}};g.prototype.getSelectedNodes=function(){var j,i,h;if(this.selected_single_node){return[this.selected_single_node]}else{h=[];for(j in this.selected_nodes){i=this.tree_widget.getNodeById(j);if(i){h.push(i)}}return h}};g.prototype.getSelectedNodesUnder=function(i){var k,j,h;if(this.selected_single_node){if(i.isParentOf(this.selected_single_node)){return[this.selected_single_node]}else{return[]}}else{h=[];for(k in this.selected_nodes){j=this.tree_widget.getNodeById(k);if(j&&i.isParentOf(j)){h.push(j)}}return h}};g.prototype.isNodeSelected=function(h){if(h.id){return this.selected_nodes[h.id]}else{if(this.selected_single_node){return this.selected_single_node.element===h.element}else{return false}}};g.prototype.clear=function(){this.selected_nodes={};return this.selected_single_node=null};g.prototype.removeFromSelection=function(h,i){if(i==null){i=false}if(!h.id){if(this.selected_single_node&&h.element===this.selected_single_node.element){return this.selected_single_node=null}}else{delete this.selected_nodes[h.id];if(i){return h.iterate((function(j){return function(k){delete j.selected_nodes[h.id];return true}})(this))}}};g.prototype.addToSelection=function(h){if(h.id){return this.selected_nodes[h.id]=true}else{return this.selected_single_node=h}};return g})();d.exports=a},{}],10:[function(b,c,a){var d,f,g=[].slice;d=jQuery;f=(function(){h.prototype.defaults={};function h(j,i){this.$el=d(j);this.options=d.extend({},this.defaults,i)}h.prototype.destroy=function(){return this._deinit()};h.prototype._init=function(){return null};h.prototype._deinit=function(){return null};h.register=function(o,m){var n,l,i,j,k;j=function(){return"simple_widget_"+m};k=function(q,p){var r;r=d.data(q,p);if(r&&(r instanceof h)){return r}else{return null}};l=function(s,q){var u,t,w,r,p,v;u=j();for(r=0,p=s.length;r<p;r++){t=s[r];w=k(t,u);if(!w){v=new o(t,q);if(!d.data(t,u)){d.data(t,u,v)}v._init()}}return s};i=function(s){var u,t,r,p,q,v;u=j();q=[];for(r=0,p=s.length;r<p;r++){t=s[r];v=k(t,u);if(v){v.destroy()}q.push(d.removeData(t,u))}return q};n=function(w,u,v){var p,r,t,x,s,q;x=null;for(r=0,t=w.length;r<t;r++){p=w[r];s=d.data(p,j());if(s&&(s instanceof h)){q=s[u];if(q&&(typeof q==="function")){x=q.apply(s,v)}}}return x};return d.fn[m]=function(){var r,q,s,t,p;s=arguments[0],q=2<=arguments.length?g.call(arguments,1):[];r=this;if(s===void 0||typeof s==="object"){p=s;return l(r,p)}else{if(typeof s==="string"&&s[0]!=="_"){t=s;if(t==="destroy"){return i(r)}else{if(t==="get_widget_class"){return o}else{return n(r,t,q)}}}}}};return h})();c.exports=f},{}],11:[function(k,a,v){var f,o,q,r,g,i,h,t,j,x,b,l,n,m,p,d,w,c,s=function(B,z){for(var y in z){if(u.call(z,y)){B[y]=z[y]}}function A(){this.constructor=B}A.prototype=z.prototype;B.prototype=new A();B.__super__=z.prototype;return B},u={}.hasOwnProperty;p=k("./version");o=k("./drag_and_drop_handler");q=k("./elements_renderer");i=k("./key_handler");h=k("./mouse.widget");b=k("./save_state_handler");l=k("./scroll_handler");n=k("./select_node_handler");m=k("./simple.widget");w=k("./node");t=w.Node;x=w.Position;c=k("./util");d=k("./node_element");j=d.NodeElement;r=d.FolderElement;f=jQuery;g=(function(z){s(y,z);function y(){return y.__super__.constructor.apply(this,arguments)}y.prototype.defaults={autoOpen:false,saveState:false,dragAndDrop:false,selectable:true,useContextMenu:true,onCanSelectNode:null,onSetStateFromStorage:null,onGetStateFromStorage:null,onCreateLi:null,onIsMoveHandle:null,onCanMove:null,onCanMoveTo:null,onLoadFailed:null,autoEscape:true,dataUrl:null,closedIcon:null,openedIcon:"&#x25bc;",slide:true,nodeClass:t,dataFilter:null,keyboardSupport:true,openFolderDelay:500,rtl:null};y.prototype.toggle=function(B,A){if(A==null){A=null}if(A===null){A=this.options.slide}if(B.is_open){return this.closeNode(B,A)}else{return this.openNode(B,A)}};y.prototype.getTree=function(){return this.tree};y.prototype.selectNode=function(A){return this._selectNode(A,false)};y.prototype._selectNode=function(C,A){var E,D,F,B;if(A==null){A=false}if(!this.select_node_handler){return}E=(function(G){return function(){if(G.options.onCanSelectNode){return G.options.selectable&&G.options.onCanSelectNode(C)}else{return G.options.selectable}}})(this);F=(function(G){return function(){var H;H=C.parent;if(H&&H.parent&&!H.is_open){return G.openNode(H,false)}}})(this);B=(function(G){return function(){if(G.options.saveState){return G.save_state_handler.saveState()}}})(this);if(!C){this._deselectCurrentNode();B();return}if(!E()){return}if(this.select_node_handler.isNodeSelected(C)){if(A){this._deselectCurrentNode();this._triggerEvent("tree.select",{node:null,previous_node:C})}}else{D=this.getSelectedNode();this._deselectCurrentNode();this.addToSelection(C);this._triggerEvent("tree.select",{node:C,deselected_node:D});F()}return B()};y.prototype.getSelectedNode=function(){if(this.select_node_handler){return this.select_node_handler.getSelectedNode()}else{return null}};y.prototype.toJson=function(){return JSON.stringify(this.tree.getData())};y.prototype.loadData=function(A,B){return this._loadData(A,B)};y.prototype.loadDataFromUrl=function(A,C,B){if(f.type(A)!=="string"){B=C;C=A;A=null}return this._loadDataFromUrl(A,C,B)};y.prototype.reload=function(){return this.loadDataFromUrl()};y.prototype._loadDataFromUrl=function(F,G,C){var H,E,B,I,D,A;H=null;E=(function(J){return function(){if(G){H=f(G.element)}else{H=J.element}return H.addClass("jqtree-loading")}})(this);A=function(){if(H){return H.removeClass("jqtree-loading")}};D=function(){if(f.type(F)==="string"){F={url:F}}if(!F.method){return F.method="get"}};B=(function(J){return function(K){A();J._loadData(K,G);if(C&&f.isFunction(C)){return C()}}})(this);I=(function(J){return function(){D();return f.ajax({url:F.url,data:F.data,type:F.method.toUpperCase(),cache:false,dataType:"json",success:function(K){var L;if(f.isArray(K)||typeof K==="object"){L=K}else{L=f.parseJSON(K)}if(J.options.dataFilter){L=J.options.dataFilter(L)}return B(L)},error:function(K){A();if(J.options.onLoadFailed){return J.options.onLoadFailed(K)}}})}})(this);if(!F){F=this._getDataUrlInfo(G)}E();if(!F){A()}else{if(f.isArray(F)){B(F)}else{return I()}}};y.prototype._loadData=function(A,C){var D,B;if(C==null){C=null}D=(function(E){return function(){var H,F,I,G;if(E.select_node_handler){G=E.select_node_handler.getSelectedNodesUnder(C);for(H=0,F=G.length;H<F;H++){I=G[H];E.select_node_handler.removeFromSelection(I)}}return null}})(this);B=(function(E){return function(){C.loadFromData(A);C.load_on_demand=false;C.is_loading=false;return E._refreshElements(C)}})(this);if(!A){return}this._triggerEvent("tree.load_data",{tree_data:A});if(!C){this._initTree(A)}else{D();B()}if(this.isDragging()){return this.dnd_handler.refresh()}};y.prototype.getNodeById=function(A){return this.tree.getNodeById(A)};y.prototype.getNodeByName=function(A){return this.tree.getNodeByName(A)};y.prototype.getNodesByProperty=function(A,B){return this.tree.getNodesByProperty(A,B)};y.prototype.openNode=function(B,A){if(A==null){A=null}if(A===null){A=this.options.slide}return this._openNode(B,A)};y.prototype._openNode=function(C,A,D){var E,B;if(A==null){A=true}E=(function(F){return function(H,I,G){var J;J=new r(H,F);return J.open(G,I)}})(this);if(C.isFolder()){if(C.load_on_demand){return this._loadFolderOnDemand(C,A,D)}else{B=C.parent;while(B){if(B.parent){E(B,false,null)}B=B.parent}E(C,A,D);return this._saveState()}}};y.prototype._loadFolderOnDemand=function(B,A,C){if(A==null){A=true}B.is_loading=true;return this._loadDataFromUrl(null,B,(function(D){return function(){return D._openNode(B,A,C)}})(this))};y.prototype.closeNode=function(B,A){if(A==null){A=null}if(A===null){A=this.options.slide}if(B.isFolder()){new r(B,this).close(A);return this._saveState()}};y.prototype.isDragging=function(){if(this.dnd_handler){return this.dnd_handler.is_dragging}else{return false}};y.prototype.refreshHitAreas=function(){return this.dnd_handler.refresh()};y.prototype.addNodeAfter=function(B,A){var C;C=A.addAfter(B);this._refreshElements(A.parent);return C};y.prototype.addNodeBefore=function(B,A){var C;C=A.addBefore(B);this._refreshElements(A.parent);return C};y.prototype.addParentNode=function(B,A){var C;C=A.addParent(B);this._refreshElements(C.parent);return C};y.prototype.removeNode=function(B){var A;A=B.parent;if(A){this.select_node_handler.removeFromSelection(B,true);B.remove();return this._refreshElements(A)}};y.prototype.appendNode=function(B,C){var A;C=C||this.tree;A=C.append(B);this._refreshElements(C);return A};y.prototype.prependNode=function(B,C){var A;if(!C){C=this.tree}A=C.prepend(B);this._refreshElements(C);return A};y.prototype.updateNode=function(A,C){var B;B=C.id&&C.id!==A.id;if(B){this.tree.removeNodeFromIndex(A)}A.setData(C);if(B){this.tree.addNodeToIndex(A)}this.renderer.renderFromNode(A);return this._selectCurrentNode()};y.prototype.moveNode=function(C,D,A){var B;B=x.nameToIndex(A);this.tree.moveNode(C,D,B);return this._refreshElements()};y.prototype.getStateFromStorage=function(){return this.save_state_handler.getStateFromStorage()};y.prototype.addToSelection=function(A){if(A){this.select_node_handler.addToSelection(A);this._getNodeElementForNode(A).select();return this._saveState()}};y.prototype.getSelectedNodes=function(){return this.select_node_handler.getSelectedNodes()};y.prototype.isNodeSelected=function(A){return this.select_node_handler.isNodeSelected(A)};y.prototype.removeFromSelection=function(A){this.select_node_handler.removeFromSelection(A);this._getNodeElementForNode(A).deselect();return this._saveState()};y.prototype.scrollToNode=function(B){var A,C;A=f(B.element);C=A.offset().top-this.$el.offset().top;return this.scroll_handler.scrollTo(C)};y.prototype.getState=function(){return this.save_state_handler.getState()};y.prototype.setState=function(A){this.save_state_handler.setInitialState(A);return this._refreshElements()};y.prototype.setOption=function(A,B){return this.options[A]=B};y.prototype.moveDown=function(){if(this.key_handler){return this.key_handler.moveDown()}};y.prototype.moveUp=function(){if(this.key_handler){return this.key_handler.moveUp()}};y.prototype.getVersion=function(){return p};y.prototype._init=function(){y.__super__._init.call(this);this.element=this.$el;this.mouse_delay=300;this.is_initialized=false;this.options.rtl=this._getRtlOption();if(!this.options.closedIcon){this.options.closedIcon=this._getDefaultClosedIcon()}this.renderer=new q(this);if(b!=null){this.save_state_handler=new b(this)}else{this.options.saveState=false}if(n!=null){this.select_node_handler=new n(this)}if(o!=null){this.dnd_handler=new o(this)}else{this.options.dragAndDrop=false}if(l!=null){this.scroll_handler=new l(this)}if((i!=null)&&(n!=null)){this.key_handler=new i(this)}this._initData();this.element.click(f.proxy(this._click,this));this.element.dblclick(f.proxy(this._dblclick,this));if(this.options.useContextMenu){return this.element.bind("contextmenu",f.proxy(this._contextmenu,this))}};y.prototype._deinit=function(){this.element.empty();this.element.unbind();if(this.key_handler){this.key_handler.deinit()}this.tree=null;return y.__super__._deinit.call(this)};y.prototype._initData=function(){if(this.options.data){return this._loadData(this.options.data)}else{return this._loadDataFromUrl(this._getDataUrlInfo())}};y.prototype._getDataUrlInfo=function(B){var A,C;A=this.options.dataUrl||this.element.data("url");C=(function(D){return function(){var G,F,E;E={url:A};if(B&&B.id){G={node:B.id};E.data=G}else{F=D._getNodeIdToBeSelected();if(F){G={selected_node:F};E.data=G}}return E}})(this);if(f.isFunction(A)){return A(B)}else{if(f.type(A)==="string"){return C()}else{return A}}};y.prototype._getNodeIdToBeSelected=function(){if(this.options.saveState){return this.save_state_handler.getNodeIdToBeSelected()}else{return null}};y.prototype._initTree=function(B){var A;this.tree=new this.options.nodeClass(null,true,this.options.nodeClass);if(this.select_node_handler){this.select_node_handler.clear()}this.tree.loadFromData(B);A=this._setInitialState();this._refreshElements();if(A){this._setInitialStateOnDemand()}if(!this.is_initialized){this.is_initialized=true;return this._triggerEvent("tree.init")}};y.prototype._setInitialState=function(){var D,E,B,C,A;A=(function(F){return function(){var G,H;if(!(F.options.saveState&&F.save_state_handler)){return[false,false]}else{H=F.save_state_handler.getStateFromStorage();if(!H){return[false,false]}else{G=F.save_state_handler.setInitialState(H);return[true,G]}}}})(this);D=(function(F){return function(){var G,H;if(F.options.autoOpen===false){return false}G=F._getAutoOpenMaxLevel();H=false;F.tree.iterate(function(I,J){if(I.load_on_demand){H=true;return false}else{if(!I.hasChildren()){return false}else{I.is_open=true;return J!==G}}});return H}})(this);C=A(),E=C[0],B=C[1];if(!E){B=D()}return B};y.prototype._setInitialStateOnDemand=function(){var B,A;A=(function(C){return function(){var D;if(!(C.options.saveState&&C.save_state_handler)){return false}else{D=C.save_state_handler.getStateFromStorage();if(!D){return false}else{C.save_state_handler.setInitialStateOnDemand(D);return true}}}})(this);B=(function(C){return function(){var G,F,E,D;E=C._getAutoOpenMaxLevel();F=[];G=function(H){return C._openNode(H,false,D)};D=function(){return C.tree.iterate(function(H,I){if(H.load_on_demand){if(!H.is_loading){G(H)}return false}else{C._openNode(H,false);return I!==E}})};return D()}})(this);if(!A()){return B()}};y.prototype._getAutoOpenMaxLevel=function(){if(this.options.autoOpen===true){return -1}else{return parseInt(this.options.autoOpen)}};y.prototype._refreshElements=function(A){if(A==null){A=null}this.renderer.render(A);return this._triggerEvent("tree.refresh")};y.prototype._click=function(C){var D,B,A;D=this._getClickTarget(C.target);if(D){if(D.type==="button"){this.toggle(D.node,this.options.slide);C.preventDefault();return C.stopPropagation()}else{if(D.type==="label"){A=D.node;B=this._triggerEvent("tree.click",{node:A,click_event:C});if(!B.isDefaultPrevented()){return this._selectNode(A,true)}}}}};y.prototype._dblclick=function(A){var B;B=this._getClickTarget(A.target);if(B&&B.type==="label"){return this._triggerEvent("tree.dblclick",{node:B.node,click_event:A})}};y.prototype._getClickTarget=function(C){var E,B,A,D;A=f(C);E=A.closest(".jqtree-toggler");if(E.length){D=this._getNode(E);if(D){return{type:"button",node:D}}}else{B=A.closest(".jqtree-element");if(B.length){D=this._getNode(B);if(D){return{type:"label",node:D}}}}return null};y.prototype._getNode=function(A){var B;B=A.closest("li.jqtree_common");if(B.length===0){return null}else{return B.data("node")}};y.prototype._getNodeElementForNode=function(A){if(A.isFolder()){return new r(A,this)}else{return new j(A,this)}};y.prototype._getNodeElement=function(A){var B;B=this._getNode(A);if(B){return this._getNodeElementForNode(B)}else{return null}};y.prototype._contextmenu=function(C){var A,B;A=f(C.target).closest("ul.jqtree-tree .jqtree-element");if(A.length){B=this._getNode(A);if(B){C.preventDefault();C.stopPropagation();this._triggerEvent("tree.contextmenu",{node:B,click_event:C});return false}}};y.prototype._saveState=function(){if(this.options.saveState){return this.save_state_handler.saveState()}};y.prototype._mouseCapture=function(A){if(this.options.dragAndDrop){return this.dnd_handler.mouseCapture(A)}else{return false}};y.prototype._mouseStart=function(A){if(this.options.dragAndDrop){return this.dnd_handler.mouseStart(A)}else{return false}};y.prototype._mouseDrag=function(B){var A;if(this.options.dragAndDrop){A=this.dnd_handler.mouseDrag(B);if(this.scroll_handler){this.scroll_handler.checkScrolling()}return A}else{return false}};y.prototype._mouseStop=function(A){if(this.options.dragAndDrop){return this.dnd_handler.mouseStop(A)}else{return false}};y.prototype._triggerEvent=function(C,A){var B;B=f.Event(C);f.extend(B,A);this.element.trigger(B);return B};y.prototype.testGenerateHitAreas=function(A){this.dnd_handler.current_item=this._getNodeElementForNode(A);this.dnd_handler.generateHitAreas();return this.dnd_handler.hit_areas};y.prototype._selectCurrentNode=function(){var A;A=this.getSelectedNode();if(A){d=this._getNodeElementForNode(A);if(d){return d.select()}}};y.prototype._deselectCurrentNode=function(){var A;A=this.getSelectedNode();if(A){return this.removeFromSelection(A)}};y.prototype._getDefaultClosedIcon=function(){if(this.options.rtl){return"&#x25c0;"}else{return"&#x25ba;"}};y.prototype._getRtlOption=function(){var A;if(this.options.rtl!==null){return this.options.rtl}else{A=this.element.data("rtl");if((A!=null)&&A!==false){return true}else{return false}}};return y})(h);g.getModule=function(z){var y;y={node:w,util:c};return y[z]};m.register(g,"tree")},{"./drag_and_drop_handler":1,"./elements_renderer":2,"./key_handler":3,"./mouse.widget":4,"./node":5,"./node_element":6,"./save_state_handler":7,"./scroll_handler":8,"./select_node_handler":9,"./simple.widget":10,"./util":12,"./version":13}],12:[function(b,d,a){var c,g,f,h;c=function(p,n){var m,l,k,o;for(m=l=0,k=p.length;l<k;m=++l){o=p[m];if(o===n){return m}}return -1};f=function(j,i){if(j.indexOf){return j.indexOf(i)}else{return c(j,i)}};h=function(i){return typeof i==="number"&&i%1===0};g=function(i){return(""+i).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};d.exports={_indexOf:c,html_escape:g,indexOf:f,isInt:h}},{}],13:[function(b,c,a){c.exports="1.1.0"},{}]},{},[11]);