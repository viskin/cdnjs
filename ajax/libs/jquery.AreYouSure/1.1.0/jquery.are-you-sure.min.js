/*!
 * jQuery Plugin: Are-You-Sure (Dirty Form Detection)
 * https://github.com/codedance/jquery.AreYouSure/
 *
 * Copyright (c) 2012-2013, Chris Dance and PaperCut Software http://www.papercut.com/
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * Author:   chris.dance@papercut.com
 * Version:  1.1.0
 * Date:     3rd Feb 2013
 */
(function(a){a.fn.areYouSure=function(d){var e=a.extend({message:"You have unsaved changes!",dirtyClass:"dirty",change:null,fieldSelector:"select,textarea,input[type='text'],input[type='password'],input[type='checkbox'],input[type='radio']"},d);var c=function(h){if(h.hasClass("ays-ignore")||h.hasClass("aysIgnore")||h.attr("data-ays-ignore")){return null}var i;var g=h.attr("type");if(h.is("select")){g="select"}switch(g){case"checkbox":case"radio":i=h.is(":checked");break;case"select":i="";h.children("option").each(function(k){var j=a(this);if(j.is(":selected")){i+=j.val()}});break;default:i=h.val()}return i};var f=function(){var g=a(this);g.data("ays-orig",c(g))};var b=function(g){var i=function(l){return(c(l)!=l.data("ays-orig"))};var j=false;var h=a(this).parents("form");if(i(a(g.target))){j=true}if(!j){h.find(e.fieldSelector).each(function(){$field=a(this);if(i($field)){j=true;return false}})}var k=j!=h.hasClass(e.dirtyClass);h.toggleClass(e.dirtyClass,j);if(k&&e.change){e.change.call(h,h)}};a(window).bind("beforeunload",function(){$dirtyForms=a("form").filter("."+e.dirtyClass);if($dirtyForms.length>0){return e.message}});return this.each(function(g){if(!a(this).is("form")){return}a(this).submit(function(){a(this).removeClass(e.dirtyClass)});a(this).find(e.fieldSelector).each(f);a(this).find(e.fieldSelector).bind("change keyup",b)})}})(jQuery);