/*!
 * jQuery Plugin: Are-You-Sure (Dirty Form Detection)
 * https://github.com/codedance/jquery.AreYouSure/
 *
 * Copyright (c) 2012-2013, Chris Dance and PaperCut Software http://www.papercut.com/
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * Author:   chris.dance@papercut.com
 * Version:  1.3.0
 * Date:     14th May 2013
 */
(function(a){a.fn.areYouSure=function(d){var e=a.extend({message:"You have unsaved changes!",dirtyClass:"dirty",change:null,fieldSelector:"select,textarea,input[type='text'],input[type='password'],input[type='checkbox'],input[type='radio'],input[type='hidden']"},d);var c=function(i){if(i.hasClass("ays-ignore")||i.hasClass("aysIgnore")||i.attr("data-ays-ignore")){return null}if(i.is(":disabled")){return"ays-disabled"}var j;var h=i.attr("type");if(i.is("select")){h="select"}switch(h){case"checkbox":case"radio":j=i.is(":checked");break;case"select":j="";i.children("option").each(function(l){var k=a(this);if(k.is(":selected")){j+=k.val()}});break;default:j=i.val()}return j};var g=function(){var h=a(this);h.data("ays-orig",c(h))};var b=function(h){var j=function(l){return(c(l)!=l.data("ays-orig"))};var k=false;var i=a(this).parents("form");if(j(a(h.target))){k=true}if(!k){i.find(e.fieldSelector).each(function(){$field=a(this);if(j($field)){k=true;return false}})}f(i,k)};var f=function(h,i){var j=i!=h.hasClass(e.dirtyClass);h.toggleClass(e.dirtyClass,i);if(j&&e.change){e.change.call(h,h)}};a(window).bind("beforeunload",function(){$dirtyForms=a("form").filter("."+e.dirtyClass);if($dirtyForms.length>0){return e.message}});return this.each(function(h){if(!a(this).is("form")){return}a(this).submit(function(){a(this).removeClass(e.dirtyClass)});a(this).find(e.fieldSelector).each(g);a(this).find(e.fieldSelector).bind("change keyup",b);a(this).bind("reset",function(){f(a(this),false)})})}})(jQuery);