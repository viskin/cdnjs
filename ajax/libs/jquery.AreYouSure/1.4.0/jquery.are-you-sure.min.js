/*!
 * jQuery Plugin: Are-You-Sure (Dirty Form Detection)
 * https://github.com/codedance/jquery.AreYouSure/
 *
 * Copyright (c) 2012-2013, Chris Dance and PaperCut Software http://www.papercut.com/
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * Author:   chris.dance@papercut.com
 * Version:  1.4.0
 * Date:     2nd Oct 2013
 */
(function(a){a.fn.areYouSure=function(e){var f=a.extend({message:"You have unsaved changes!",dirtyClass:"dirty",change:null,silent:false,fieldSelector:"select,textarea,input[type='text'],input[type='password'],input[type='checkbox'],input[type='radio'],input[type='hidden']"},e);var d=function(j){if(j.hasClass("ays-ignore")||j.hasClass("aysIgnore")||j.attr("data-ays-ignore")||j.attr("name")===undefined){return null}if(j.is(":disabled")){return"ays-disabled"}var k;var i=j.attr("type");if(j.is("select")){i="select"}switch(i){case"checkbox":case"radio":k=j.is(":checked");break;case"select":k="";j.children("option").each(function(m){var l=a(this);if(l.is(":selected")){k+=l.val()}});break;default:k=j.val()}return k};var h=function(){var i=a(this);i.data("ays-orig",d(i))};var c=function(i){var k=function(m){return(d(m)!=m.data("ays-orig"))};var l=false;var j=a(this).parents("form");if(k(a(i.target))){l=true}if(!l){j.find(f.fieldSelector).each(function(){$field=a(this);if(k($field)){l=true;return false}})}g(j,l)};var g=function(i,j){var k=j!=i.hasClass(f.dirtyClass);i.toggleClass(f.dirtyClass,j);if(k){if(f.change){f.change.call(i,i)}if(j){i.trigger("dirty.areYouSure",[i])}if(!j){i.trigger("clean.areYouSure",[i])}i.trigger("change.areYouSure",[i])}};var b=function(){var j=a(this);var i=j.find(f.fieldSelector).not("[ays-orig]");a(i).each(h);a(i).bind("change keyup",c)};if(!f.silent){a(window).bind("beforeunload",function(){$dirtyForms=a("form").filter("."+f.dirtyClass);if($dirtyForms.length>0){return f.message}})}return this.each(function(k){if(!a(this).is("form")){return}var j=a(this);j.submit(function(){j.removeClass(f.dirtyClass)});j.bind("reset",function(){g(j,false)});j.bind("rescan.areYouSure",b);var i=j.find(f.fieldSelector);a(i).each(h);a(i).bind("change keyup",c)})}})(jQuery);