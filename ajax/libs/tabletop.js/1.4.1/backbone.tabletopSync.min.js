Backbone.tabletopSync=function(h,d,c,b){if(typeof c=="function"){c={success:c,error:b}}var g;var f=d.tabletop||d.collection.tabletop;var a=f.instance;if(typeof(a)=="undefined"){a=Tabletop.init({key:f.key,wanted:[f.sheet],wait:true});f.instance=a}else{a.addWanted(f.sheet)}if(typeof(f.sheet)=="undefined"){return}var e=a.sheets(f.sheet);if(typeof(e)==="undefined"){if(typeof(a.foundSheetNames)!=="undefined"&&_.indexOf(a.foundSheetNames,f.sheet)===-1){throw ("Can't seem to find sheet "+f.sheet)}a.fetch(function(){Backbone.tabletopSync(h,d,c,b)});return}switch(h){case"read":if(d.id){g=_.find(e.all(),function(i){return d.id==i[d.idAttribute]},this)}else{g=e.all()}break;default:throw ("Backbone.tabletopSync is read-only")}if(g){c.success(g)}else{c.error("Record not found")}};