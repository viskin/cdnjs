/*!
Mailchimp Ajax Submit
jQuery Plugin
Author: Siddharth Doshi

Use:
===
$('#form_id').ajaxchimp(options);
 
- Form should have one <input> element with attribute 'type=email'
- Form should have one label element with attribute 'for=email_input_id' (used to display error/success message)
- All options are optional.
 
Options:
=======
options = {
    callback: callbackFunction,
    url: 'http://blahblah.us1.list-manage.com/subscribe/post?u=5afsdhfuhdsiufdba6f8802&id=4djhfdsh99f',
}
 
Notes:
===== 
To get the mailchimp JSONP url (undocumented), change 'post?' to 'post-json?' and add '&c=?' to the end.
For e.g. 'http://blahblah.us1.list-manage.com/subscribe/post-json?u=5afsdhfuhdsiufdba6f8802&id=4djhfdsh99f&c=?',
*/
(function(a){a.fn.ajaxChimp=function(e){var g=this;var d=g.find("input[type=email]");var c=g.find("label[for="+d.attr("id")+"]");var f=a.extend({url:g.attr("action")},e);var b=f.url.replace("/post?","/post-json?").concat("&c=?");g.attr("novalidate","true");d.attr("name","EMAIL");g.submit(function(){function i(p){if(p.result==="success"){c.html("We have sent you a confirmation email.");c.removeClass("error").addClass("valid");d.removeClass("error").addClass("valid")}else{d.removeClass("valid").addClass("error");c.removeClass("valid").addClass("error");var k=-1;var o;try{var n=p.msg.split(" - ",2);if(n[1]===undefined){o=p.msg}else{var l=parseInt(n[0],10);if(l.toString()===n[0]){k=n[0];o=n[1]}else{k=-1;o=p.msg}}}catch(m){k=-1;o=p.msg}c.html(o)}c.show(2000);if(f.callback){f.callback(p)}}var j={};var h=g.serializeArray();a.each(h,function(k,l){j[l.name]=l.value});a.ajax({url:b,data:j,success:i,dataType:"jsonp",error:function(l,k){console.log("mailchimp ajax submit error: "+k)}});c.html("Submitting...").show(2000);return false});return this}})(jQuery);