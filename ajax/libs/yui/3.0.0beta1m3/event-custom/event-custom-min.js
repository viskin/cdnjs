YUI.add("event-custom",function(E){E.Env.evt={handles:{},plugins:{}};(function(){var F=0,G=1;E.Do={objs:{},before:function(I,K,L,M){var J=I,H;if(M){H=[I,M].concat(E.Array(arguments,4,true));J=E.rbind.apply(E,H);}return this._inject(F,J,K,L);},after:function(I,K,L,M){var J=I,H;if(M){H=[I,M].concat(E.Array(arguments,4,true));J=E.rbind.apply(E,H);}return this._inject(G,J,K,L);},_inject:function(H,J,K,M){var N=E.stamp(K),L,I;if(!this.objs[N]){this.objs[N]={};}L=this.objs[N];if(!L[M]){L[M]=new E.Do.Method(K,M);K[M]=function(){return L[M].exec.apply(L[M],arguments);};}I=N+E.stamp(J)+M;L[M].register(I,J,H);return new E.EventHandle(L[M],I);},detach:function(H){if(H.detach){H.detach();}},_unload:function(I,H){}};E.Do.Method=function(H,I){this.obj=H;this.methodName=I;this.method=H[I];this.before={};this.after={};};E.Do.Method.prototype.register=function(I,J,H){if(H){this.after[I]=J;}else{this.before[I]=J;}};E.Do.Method.prototype._delete=function(H){delete this.before[H];delete this.after[H];};E.Do.Method.prototype.exec=function(){var J=E.Array(arguments,0,true),K,I,N,L=this.before,H=this.after,M=false;for(K in L){if(L.hasOwnProperty(K)){I=L[K].apply(this.obj,J);if(I){switch(I.constructor){case E.Do.Halt:return I.retVal;case E.Do.AlterArgs:J=I.newArgs;break;case E.Do.Prevent:M=true;break;default:}}}}if(!M){I=this.method.apply(this.obj,J);}for(K in H){if(H.hasOwnProperty(K)){N=H[K].apply(this.obj,J);if(N&&N.constructor==E.Do.Halt){return N.retVal;}else{if(N&&N.constructor==E.Do.AlterReturn){I=N.newRetVal;}}}}return I;};E.Do.AlterArgs=function(I,H){this.msg=I;this.newArgs=H;};E.Do.AlterReturn=function(I,H){this.msg=I;this.newRetVal=H;};E.Do.Halt=function(I,H){this.msg=I;this.retVal=H;};E.Do.Prevent=function(H){this.msg=H;};E.Do.Error=E.Do.Halt;})();(function(){E.EventFacade=function(G,F){G=G||{};this.details=G.details;this.type=G.type;this.target=G.target;this.currentTarget=F;this.relatedTarget=G.relatedTarget;this.stopPropagation=function(){G.stopPropagation();};this.stopImmediatePropagation=function(){G.stopImmediatePropagation();};this.preventDefault=function(){G.preventDefault();};this.halt=function(H){G.halt(H);};};})();var D="after",B=["broadcast","bubbles","context","configured","currentTarget","defaultFn","details","emitFacade","fireOnce","host","preventable","preventedFn","queuable","silent","stoppedFn","target","type"],A=new E.EventFacade(),C=9;E.EventHandle=function(F,G){this.evt=F;this.sub=G;};E.EventHandle.prototype={detach:function(){if(this.evt){this.evt._delete(this.sub);}}};E.CustomEvent=function(F,G){G=G||{};this.id=E.stamp(this);this.type=F;this.context=E;this.logSystem=(F=="yui:log");this.broadcast=0;this.silent=this.logSystem;this.queuable=false;this.subscribers={};this.afters={};this.fired=false;this.fireOnce=false;this.stopped=0;this.prevented=0;this.host=null;this.defaultFn=null;this.stoppedFn=null;this.preventedFn=null;this.preventable=true;this.bubbles=true;this.signature=C;this.hasSubscribers=false;this.hasAfters=false;this.emitFacade=false;this.applyConfig(G,true);this.log("Creating "+this.type);};E.CustomEvent.prototype={_YUI_EVENT:true,applyConfig:function(G,F){if(G){E.mix(this,G,F,B);}},_on:function(J,H,G,F){if(!J){E.error("Invalid callback for CE: "+this.type);}var I=new E.Subscriber(J,H,G,F);if(this.fireOnce&&this.fired){E.later(0,this,this._notify,I);}if(F==D){this.afters[I.id]=I;this.hasAfters=true;}else{this.subscribers[I.id]=I;this.hasSubscribers=true;}return new E.EventHandle(this,I);},subscribe:function(G,F){return this._on(G,F,arguments,true);},on:function(G,F){return this._on(G,F,arguments,true);},after:function(G,F){return this._on(G,F,arguments,D);},detach:function(J,H){if(J&&J.detach){return J.detach();}if(!J){return this.unsubscribeAll();}var K=false,G=this.subscribers,F,I;for(F in G){if(G.hasOwnProperty(F)){I=G[F];if(I&&I.contains(J,H)){this._delete(I);K=true;}}}return K;},unsubscribe:function(){return this.detach.apply(this,arguments);},_getFacade:function(){var F=this._facade,I,G=this.details,H;if(!F){F=new E.EventFacade(this,this.currentTarget);}I=G&&G[0];if(E.Lang.isObject(I,true)){H={};E.mix(H,F,true,A);E.mix(F,I,true);E.mix(F,H,true);}F.details=this.details;F.target=this.target;F.currentTarget=this.currentTarget;F.stopped=0;F.prevented=0;this._facade=F;return this._facade;},_notify:function(J,H,F){this.log(this.type+"->"+": "+J);var G,I;if(this.emitFacade){if(!F){F=this._getFacade(H);if(E.Lang.isObject(H[0])){H[0]=F;}else{H.unshift(F);}}}G=J.notify(I||this.context,H,this);if(false===G||this.stopped>1){this.log(this.type+" cancelled by subscriber");return false;}return true;},log:function(G,F){if(!this.silent){}},fire:function(){var O=E.Env._eventstack,H,Q,N,I,J,F,K,G,L,M=true,P;if(O){if(this.queuable&&this.type!=O.next.type){this.log("queue "+this.type);O.queue.push([this,arguments]);return true;}}else{E.Env._eventstack={id:this.id,next:this,silent:this.silent,logging:(this.type==="yui:log"),stopped:0,prevented:0,queue:[]};O=E.Env._eventstack;}if(this.fireOnce&&this.fired){this.log("fireOnce event: "+this.type+" already fired");}else{N=E.Array(arguments,0,true);this.stopped=0;this.prevented=0;this.target=this.target||this.host;P=new E.EventTarget({fireOnce:true,context:this.host});this.events=P;if(this.preventedFn){P.on("prevented",this.preventedFn);}if(this.stoppedFn){P.on("stopped",this.stoppedFn);}this.currentTarget=this.host||this.currentTarget;this.fired=true;this.details=N.slice();this.log("Firing "+this.type);L=false;O.lastLogState=O.logging;J=null;if(this.emitFacade){this._facade=null;J=this._getFacade(N);if(E.Lang.isObject(N[0])){N[0]=J;}else{N.unshift(J);}}if(this.hasSubscribers){H=E.merge(this.subscribers);for(I in H){if(H.hasOwnProperty(I)){if(!L){O.logging=(O.logging||(this.type==="yui:log"));L=true;}if(this.stopped==2){break;}Q=H[I];if(Q&&Q.fn){M=this._notify(Q,N,J);if(false===M){this.stopped=2;}}}}}O.logging=(O.lastLogState);if(this.bubbles&&this.host&&!this.stopped){O.stopped=0;O.prevented=0;M=this.host.bubble(this);this.stopped=Math.max(this.stopped,O.stopped);
this.prevented=Math.max(this.prevented,O.prevented);}if(this.defaultFn&&!this.prevented){this.defaultFn.apply(this.host||this,N);}if(!this.stopped&&this.broadcast){if(this.host!==E){E.fire.apply(E,N);}if(this.broadcast==2){E.Global.fire.apply(E.Global,N);}}if(this.hasAfters&&!this.prevented&&this.stopped<2){H=E.merge(this.afters);for(I in H){if(H.hasOwnProperty(I)){if(!L){O.logging=(O.logging||(this.type==="yui:log"));L=true;}if(this.stopped==2){break;}Q=H[I];if(Q&&Q.fn){M=this._notify(Q,N,J);if(false===M){this.stopped=2;}}}}}}if(O.id===this.id){K=O.queue;while(K.length){F=K.pop();G=F[0];O.stopped=0;O.prevented=0;O.next=G;M=G.fire.apply(G,F[1]);}E.Env._eventstack=null;}return(M!==false);},unsubscribeAll:function(){return this.detachAll.apply(this,arguments);},detachAll:function(){var H=this.subscribers,G,F=0;for(G in H){if(H.hasOwnProperty(G)){this._delete(H[G]);F++;}}this.subscribers={};return F;},_delete:function(F){if(F){delete F.fn;delete F.context;delete this.subscribers[F.id];delete this.afters[F.id];}},toString:function(){return this.type;},stopPropagation:function(){this.stopped=1;E.Env._eventstack.stopped=1;this.events.fire("stopped",this);},stopImmediatePropagation:function(){this.stopped=2;E.Env._eventstack.stopped=2;this.events.fire("stopped",this);},preventDefault:function(){if(this.preventable){this.prevented=1;E.Env._eventstack.prevented=1;this.events.fire("prevented",this);}},halt:function(F){if(F){this.stopImmediatePropagation();}else{this.stopPropagation();}this.preventDefault();}};E.Subscriber=function(H,G,F){this.fn=H;this.context=G;this.id=E.stamp(this);this.wrappedFn=H;this.events=null;if(G){this.wrappedFn=E.rbind.apply(E,F);}};E.Subscriber.prototype={notify:function(F,H,K){var L=this.context||F,G=true,I=function(){switch(K.signature){case 0:G=this.fn.call(L,K.type,H,this.context);break;case 1:G=this.fn.call(L,H[0]||null,this.context);break;default:G=this.wrappedFn.apply(L,H||[]);}};if(E.config.throwFail){I.call(this);}else{try{I.call(this);}catch(J){E.error(this+" failed: "+J.message,J);}}return G;},contains:function(G,F){if(F){return((this.fn==G)&&this.context==F);}else{return(this.fn==G);}},toString:function(){return"Subscriber "+this.id;}};(function(){var F=E.Lang,H=":",I=/[,|]\s*/,J="~AFTER~",K=E.cached(function(O,N){var L=N;if(!F.isString(L)){return L;}if(L=="*"){return null;}if(L.indexOf(H)==-1&&O){L=O+H+L;}return L;}),G=E.cached(function(S,O){var N=O,R,P,T,L,Q;if(!F.isString(N)){return N;}L=N.indexOf(J);if(L>-1){T=true;N=N.substr(J.length);}R=N.split(I);if(R.length>1){P=R[0];N=R[1];}Q=K(S,N);return[P,Q,T,N];}),M=function(L){var N=(F.isObject(L))?L:{};this._yuievt={id:E.guid(),events:{},targets:{},config:N,chain:("chain" in N)?N.chain:E.config.chain,defaults:{context:N.context||this,host:this,emitFacade:N.emitFacade,fireOnce:N.fireOnce,queuable:N.queuable,broadcast:N.broadcast,bubbles:("bubbles" in N)?N.bubbles:true}};};M.prototype={on:function(X,Y,N){var P=G(this._yuievt.config.prefix,X),S,W,U,T,O,V,R,Z=E.Env.evt.handles,L,Q,a;if(F.isObject(X,true)){S=Y;W=N;U=E.Array(arguments,0,true);T={};L=X._after;delete X._after;E.each(X,function(c,b){if(c){S=c.fn||((E.Lang.isFunction(c))?c:S);W=c.context||W;}U[0]=(L)?J+b:b;U[1]=S;U[2]=W;T[b]=this.on.apply(this,U);},this);return(this._yuievt.chain)?this:T;}else{if(F.isFunction(X)){return E.Do.before.apply(E.Do,arguments);}}V=P[0];L=P[2];a=P[3];if(E.Node&&(this instanceof E.Node)&&(a in E.Node.DOM_EVENTS)){U=E.Array(arguments,0,true);U.splice(2,0,E.Node.getDOMNode(this));return E.on.apply(E,U);}X=P[1];if(this instanceof YUI){Q=E.Env.evt.plugins[X];U=E.Array(arguments,0,true);U[0]=X;if(Q&&Q.on){R=Q.on.apply(E,U);}else{if((!X)||(!Q&&E.Node&&(a in E.Node.DOM_EVENTS))){R=E.Event.attach.apply(E.Event,U);}}}if(!R){O=this._yuievt.events[X]||this.publish(X);U=E.Array(arguments,1,true);S=(L)?O.after:O.on;R=S.apply(O,U);}if(V){Z[V]=Z[V]||{};Z[V][X]=Z[V][X]||[];Z[V][X].push(R);}return(this._yuievt.chain)?this:R;},subscribe:function(){return this.on.apply(this,arguments);},detach:function(W,Y,L){var P=G(this._yuievt.config.prefix,W),V=F.isArray(P)?P[0]:null,b=(P)?P[3]:null,R,S,Z=E.Env.evt.handles,X,U,a=this._yuievt.events,O,Q,T=true,N=function(e,d){var c=e[d];if(c){while(c.length){R=c.pop();R.detach();}}};if(V){X=Z[V];W=P[1];if(X){if(W){N(X,W);}else{for(Q in X){if(X.hasOwnProperty(Q)){N(X,Q);}}}return(this._yuievt.chain)?this:true;}}else{if(F.isObject(W)&&W.detach){T=W.detach();return(this._yuievt.chain)?this:true;}else{if(E.Node&&(this instanceof E.Node)&&((!b)||(b in E.Node.DOM_EVENTS))){U=E.Array(arguments,0,true);U[2]=E.Node.getDOMNode(this);return E.detach.apply(E,U);}}}S=E.Env.evt.plugins[b];if(this instanceof YUI){U=E.Array(arguments,0,true);if(S&&S.detach){return S.detach.apply(E,U);}else{if(!W||(!S&&W.indexOf(":")==-1)){U[0]=W;return E.Event.detach.apply(E.Event,U);}}}if(W){O=a[W];if(O){return O.detach(Y,L);}}else{for(Q in a){if(a.hasOwnProperty(Q)){T=T&&a[Q].detach(Y,L);}}return T;}return(this._yuievt.chain)?this:false;},unsubscribe:function(){return this.detach.apply(this,arguments);},detachAll:function(L){L=K(this._yuievt.config.prefix,L);return this.detach(L);},unsubscribeAll:function(){return this.detachAll.apply(this,arguments);},publish:function(O,P){O=K(this._yuievt.config.prefix,O);var N,Q,L,R=P||{};if(F.isObject(O)){L={};E.each(O,function(T,S){L[S]=this.publish(S,T||P);},this);return L;}N=this._yuievt.events;Q=N[O];if(Q){if(P){Q.applyConfig(P,true);}}else{E.mix(R,this._yuievt.defaults);Q=new E.CustomEvent(O,R);N[O]=Q;}if(typeof R==E.CustomEvent){N[O].broadcast=false;}return N[O];},addTarget:function(L){this._yuievt.targets[E.stamp(L)]=L;this._yuievt.hasTargets=true;},removeTarget:function(L){delete this._yuievt.targets[E.stamp(L)];},fire:function(P){var R=F.isString(P),O=(R)?P:(P&&P.type),Q,L,N;O=K(this._yuievt.config.prefix,O);Q=this.getEvent(O);if(!Q){if(this._yuievt.hasTargets){Q=this.publish(O);Q.details=E.Array(arguments,(R)?1:0,true);return this.bubble(Q);}N=true;}else{L=E.Array(arguments,(R)?1:0,true);N=Q.fire.apply(Q,L);
Q.target=null;}return(this._yuievt.chain)?this:N;},getEvent:function(L){L=K(this._yuievt.config.prefix,L);var N=this._yuievt.events;return(N&&L in N)?N[L]:null;},bubble:function(N){var S=this._yuievt.targets,O=true,Q,R,T,L,P;if(!N.stopped&&S){for(P in S){if(S.hasOwnProperty(P)){Q=S[P];R=N.type;T=Q.getEvent(R);L=N.target||this;if(!T){T=Q.publish(R,N);T.context=(N.host===N.context)?Q:N.context;T.host=Q;T.defaultFn=null;T.preventedFn=null;T.stoppedFn=null;}T.target=L;T.currentTarget=Q;O=O&&T.fire.apply(T,N.details);if(T.stopped){break;}}}}return O;},after:function(O,N){var L=E.Array(arguments,0,true);switch(F.type(O)){case"function":return E.Do.after.apply(E.Do,arguments);case"object":L[0]._after=true;break;default:L[0]=J+O;}return this.on.apply(this,L);},before:function(){return this.on.apply(this,arguments);}};E.EventTarget=M;E.mix(E,M.prototype,false,false,{bubbles:false});M.call(E);YUI.Env.globalEvents=YUI.Env.globalEvents||new M();E.Global=YUI.Env.globalEvents;})();},"@VERSION@",{requires:["oop"]});