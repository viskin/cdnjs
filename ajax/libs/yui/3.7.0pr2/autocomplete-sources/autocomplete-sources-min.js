YUI.add("autocomplete-sources",function(h,g){var a=h.AutoCompleteBase,f=h.Lang,b="_sourceSuccess",d="maxResults",e="requestTemplate",c="resultListLocator";h.mix(a.prototype,{_YQL_SOURCE_REGEX:/^(?:select|set|use)\s+/i,_beforeCreateObjectSource:function(i){if(i instanceof h.Node&&i.get("nodeName").toLowerCase()==="select"){return this._createSelectSource(i);}if(h.JSONPRequest&&i instanceof h.JSONPRequest){return this._createJSONPSource(i);}return this._createObjectSource(i);},_createIOSource:function(m){var k={type:"io"},l=this,o,j,n;function i(p){var q=p.request;if(l._cache&&q in l._cache){l[b](l._cache[q],p);return;}if(o&&o.isInProgress()){o.abort();}o=h.io(l._getXHRUrl(m,p),{on:{success:function(u,r){var t;try{t=h.JSON.parse(r.responseText);}catch(s){h.error("JSON parse error",s);}if(t){l._cache&&(l._cache[q]=t);l[b](t,p);}}}});}k.sendRequest=function(p){j=p;if(n){return;}n=true;h.use("io-base","json-parse",function(){k.sendRequest=i;i(j);});};return k;},_createJSONPSource:function(m){var k={type:"jsonp"},l=this,j,n;function i(o){var q=o.request,p=o.query;if(l._cache&&q in l._cache){l[b](l._cache[q],o);return;}m._config.on.success=function(r){l._cache&&(l._cache[q]=r);l[b](r,o);};m.send(p);}k.sendRequest=function(o){j=o;if(n){return;}n=true;h.use("jsonp",function(){if(!(m instanceof h.JSONPRequest)){m=new h.JSONPRequest(m,{format:h.bind(l._jsonpFormatter,l)});}k.sendRequest=i;i(j);});};return k;},_createSelectSource:function(j){var i=this;return{type:"select",sendRequest:function(l){var k=[];j.get("options").each(function(m){k.push({html:m.get("innerHTML"),index:m.get("index"),node:m,selected:m.get("selected"),text:m.get("text"),value:m.get("value")});});i[b](k,l);}};},_createStringSource:function(i){if(this._YQL_SOURCE_REGEX.test(i)){return this._createYQLSource(i);}else{if(i.indexOf("{callback}")!==-1){return this._createJSONPSource(i);}else{return this._createIOSource(i);}}},_createYQLSource:function(m){var l=this,n={type:"yql"},j,o,k;if(!l.get(c)){l.set(c,l._defaultYQLLocator);}function i(t){var u=t.query,r=l.get("yqlEnv"),p=l.get(d),v,s,q;q=f.sub(m,{maxResults:p>0?p:1000,request:t.request,query:u});if(l._cache&&q in l._cache){l[b](l._cache[q],t);return;}v=function(w){l._cache&&(l._cache[q]=w);l[b](w,t);};s={proto:l.get("yqlProtocol")};if(k){k._callback=v;k._opts=s;k._params.q=q;if(r){k._params.env=r;}}else{k=new h.YQLRequest(q,{on:{success:v},allowCache:false},r?{env:r}:null,s);}k.send();}n.sendRequest=function(p){j=p;if(!o){o=true;h.use("yql",function(){n.sendRequest=i;i(j);});}};return n;},_defaultYQLLocator:function(j){var k=j&&j.query&&j.query.results,i;if(k&&f.isObject(k)){i=h.Object.values(k)||[];k=i.length===1?i[0]:i;if(!f.isArray(k)){k=[k];}}else{k=[];}return k;},_getXHRUrl:function(j,k){var i=this.get(d);if(k.query!==k.request){j+=k.request;}return f.sub(j,{maxResults:i>0?i:1000,query:encodeURIComponent(k.query)});},_jsonpFormatter:function(j,k,l){var i=this.get(d),m=this.get(e);if(m){j+=m(l);}return f.sub(j,{callback:k,maxResults:i>0?i:1000,query:encodeURIComponent(l)});}});h.mix(a.ATTRS,{yqlEnv:{value:null},yqlProtocol:{value:"http"}});h.mix(a.SOURCE_TYPES,{io:"_createIOSource",jsonp:"_createJSONPSource",object:"_beforeCreateObjectSource",select:"_createSelectSource",string:"_createStringSource",yql:"_createYQLSource"},true);},"@VERSION@",{"optional":["io-base","json-parse","jsonp","yql"],"requires":["autocomplete-base"]});