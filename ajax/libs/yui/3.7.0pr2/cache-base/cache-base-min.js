YUI.add("cache-base",function(e,d){var a=e.Lang,b=e.Lang.isDate,c=function(){c.superclass.constructor.apply(this,arguments);};e.mix(c,{NAME:"cache",ATTRS:{max:{value:0,setter:"_setMax"},size:{readOnly:true,getter:"_getSize"},uniqueKeys:{value:false},expires:{value:0,validator:function(f){return e.Lang.isDate(f)||(e.Lang.isNumber(f)&&f>=0);}},entries:{readOnly:true,getter:"_getEntries"}}});e.extend(c,e.Base,{_entries:null,initializer:function(f){this.publish("add",{defaultFn:this._defAddFn});this.publish("flush",{defaultFn:this._defFlushFn});this._entries=[];},destructor:function(){this._entries=[];},_setMax:function(g){var f=this._entries;if(g>0){if(f){while(f.length>g){f.shift();}}}else{g=0;this._entries=[];}return g;},_getSize:function(){return this._entries.length;},_getEntries:function(){return this._entries;},_defAddFn:function(i){var g=this._entries,h=i.entry,f=this.get("max"),j;if(this.get("uniqueKeys")){j=this._position(i.entry.request);if(a.isValue(j)){g.splice(j,1);}}while(f&&g.length>=f){g.shift();}g[g.length]=h;},_defFlushFn:function(h){var f=this._entries,g=h.details[0],i;if(g&&a.isValue(g.request)){i=this._position(g.request);if(a.isValue(i)){f.splice(i,1);}}else{this._entries=[];}},_isMatch:function(g,f){if(!f.expires||new Date()<f.expires){return(g===f.request);}return false;},_position:function(j){var f=this._entries,h=f.length,g=h-1;if((this.get("max")===null)||this.get("max")>0){for(;g>=0;g--){if(this._isMatch(j,f[g])){return g;}}}return null;},add:function(h,g){var f=this.get("expires");if(this.get("initialized")&&((this.get("max")===null)||this.get("max")>0)&&(a.isValue(h)||a.isNull(h)||a.isUndefined(h))){this.fire("add",{entry:{request:h,response:g,cached:new Date(),expires:b(f)?f:(f?new Date(new Date().getTime()+this.get("expires")):null)}});}else{}},flush:function(f){this.fire("flush",{request:(a.isValue(f)?f:null)});},retrieve:function(i){var f=this._entries,h=f.length,g=null,j;if((h>0)&&((this.get("max")===null)||(this.get("max")>0))){this.fire("request",{request:i});j=this._position(i);if(a.isValue(j)){g=f[j];this.fire("retrieve",{entry:g});if(j<h-1){f.splice(j,1);f[f.length]=g;}return g;}}return null;}});e.Cache=c;},"@VERSION@",{"requires":["base"]});