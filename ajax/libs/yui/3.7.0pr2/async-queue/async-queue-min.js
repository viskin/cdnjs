YUI.add("async-queue",function(a,i){a.AsyncQueue=function(){this._init();this.add.apply(this,arguments);};var d=a.AsyncQueue,b="execute",g="shift",f="promote",e="remove",h=a.Lang.isObject,c=a.Lang.isFunction;d.defaults=a.mix({autoContinue:true,iterations:1,timeout:10,until:function(){this.iterations|=0;return this.iterations<=0;}},a.config.queueDefaults||{});a.extend(d,a.EventTarget,{_running:false,_init:function(){a.EventTarget.call(this,{prefix:"queue",emitFacade:true});this._q=[];this.defaults={};this._initEvents();},_initEvents:function(){this.publish({"execute":{defaultFn:this._defExecFn,emitFacade:true},"shift":{defaultFn:this._defShiftFn,emitFacade:true},"add":{defaultFn:this._defAddFn,emitFacade:true},"promote":{defaultFn:this._defPromoteFn,emitFacade:true},"remove":{defaultFn:this._defRemoveFn,emitFacade:true}});},next:function(){var j;while(this._q.length){j=this._q[0]=this._prepare(this._q[0]);if(j&&j.until()){this.fire(g,{callback:j});j=null;}else{break;}}return j||null;},_defShiftFn:function(j){if(this.indexOf(j.callback)===0){this._q.shift();}},_prepare:function(l){if(c(l)&&l._prepared){return l;}var j=a.merge(d.defaults,{context:this,args:[],_prepared:true},this.defaults,(c(l)?{fn:l}:l)),k=a.bind(function(){if(!k._running){k.iterations--;}if(c(k.fn)){k.fn.apply(k.context||a,a.Array(k.args));}},this);return a.mix(k,j);},run:function(){var k,j=true;for(k=this.next();j&&k&&!this.isRunning();k=this.next()){j=(k.timeout<0)?this._execute(k):this._schedule(k);}if(!k){this.fire("complete");}return this;},_execute:function(k){this._running=k._running=true;k.iterations--;this.fire(b,{callback:k});var j=this._running&&k.autoContinue;this._running=k._running=false;return j;},_schedule:function(j){this._running=a.later(j.timeout,this,function(){if(this._execute(j)){this.run();}});return false;},isRunning:function(){return !!this._running;},_defExecFn:function(j){j.callback();},add:function(){this.fire("add",{callbacks:a.Array(arguments,0,true)});return this;},_defAddFn:function(k){var l=this._q,j=[];a.Array.each(k.callbacks,function(m){if(h(m)){l.push(m);j.push(m);}});k.added=j;},pause:function(){if(h(this._running)){this._running.cancel();}this._running=false;return this;},stop:function(){this._q=[];return this.pause();},indexOf:function(m){var k=0,j=this._q.length,l;for(;k<j;++k){l=this._q[k];if(l===m||l.id===m){return k;}}return -1;},getCallback:function(k){var j=this.indexOf(k);return(j>-1)?this._q[j]:null;},promote:function(l){var k={callback:l},j;if(this.isRunning()){j=this.after(g,function(){this.fire(f,k);j.detach();},this);}else{this.fire(f,k);}return this;},_defPromoteFn:function(l){var j=this.indexOf(l.callback),k=(j>-1)?this._q.splice(j,1)[0]:null;l.promoted=k;if(k){this._q.unshift(k);}},remove:function(l){var k={callback:l},j;if(this.isRunning()){j=this.after(g,function(){this.fire(e,k);j.detach();},this);}else{this.fire(e,k);}return this;},_defRemoveFn:function(k){var j=this.indexOf(k.callback);k.removed=(j>-1)?this._q.splice(j,1)[0]:null;},size:function(){if(!this.isRunning()){this.next();}return this._q.length;}});},"@VERSION@",{"requires":["event-custom"]});