YUI.add("datatable-head",function(Y,NAME){var Lang=Y.Lang,fromTemplate=Lang.sub,isArray=Lang.isArray,toArray=Y.Array;Y.namespace("DataTable").HeaderView=Y.Base.create("tableHeader",Y.View,[],{CELL_TEMPLATE:'<th id="{id}" colspan="{_colspan}" rowspan="{_rowspan}" class="{className}" scope="col" {_id}{abbr}>{content}</th>',ROW_TEMPLATE:"<tr>{content}</tr>",THEAD_TEMPLATE:'<thead class="{className}"></thead>',getClassName:function(){var host=this.host,NAME=host&&host.constructor.NAME||this.constructor.NAME;return host&&host.getClassName?host.getClassName.apply(host,arguments):Y.ClassNameManager.getClassName.apply(Y.ClassNameManager,[NAME].concat(toArray(arguments,0,!0)))},render:function(){var table=this.get("container"),thead=this.theadNode||(this.theadNode=this._createTHeadNode()),columns=this.columns,defaults={_colspan:1,_rowspan:1,abbr:""},i,len,j,jlen,col,html,content,values;if(thead&&columns){html="";if(columns.length)for(i=0,len=columns.length;i<len;++i){content="";for(j=0,jlen=columns[i].length;j<jlen;++j)col=columns[i][j],values=Y.merge(defaults,col,{className:this.getClassName("header"),content:col.label||col.key||"Column "+(j+1)}),values._id=col._id?' data-yui3-col-id="'+col._id+'"':"",col.abbr&&(values.abbr=' abbr="'+col.abbr+'"'),col.className&&(values.className+=" "+col.className),col._first&&(values.className+=" "+this.getClassName("first","header")),col._id&&(values.className+=" "+this.getClassName("col",col._id)),content+=fromTemplate(col.headerTemplate||this.CELL_TEMPLATE,values);html+=fromTemplate(this.ROW_TEMPLATE,{content:content})}thead.setHTML(html),thead.get("parentNode")!==table&&table.insertBefore(thead,table.one("tfoot, tbody"))}return this.bindUI(),this},_afterColumnsChange:function(e){this.columns=this._parseColumns(e.newVal),this.render()},bindUI:function(){this._eventHandles.columnsChange||(this._eventHandles.columnsChange=this.after("columnsChange",Y.bind("_afterColumnsChange",this)))},_createTHeadNode:function(){return Y.Node.create(fromTemplate(this.THEAD_TEMPLATE,{className:this.getClassName("columns")}))},destructor:function(){(new Y.EventHandle(Y.Object.values(this._eventHandles))).detach()},initializer:function(config){this.host=config.host,this.columns=this._parseColumns(config.columns),this._eventHandles=[]},_parseColumns:function(data){var columns=[],stack=[],rowSpan=1,entry,row,col,children,parent,i,len,j;if(isArray(data)&&data.length){data=data.slice(),stack.push([data,-1]);while(stack.length){entry=stack[stack.length-1],row=entry[0],i=entry[1]+1;for(len=row.length;i<len;++i){row[i]=col=Y.merge(row[i]),children=col.children,Y.stamp(col),col.id||(col.id=Y.guid());if(isArray(children)&&children.length){stack.push([children,-1]),entry[1]=i,rowSpan=Math.max(rowSpan,stack.length);break}col._colspan=1}if(i>=len){if(stack.length>1){entry=stack[stack.length-2],parent=entry[0][entry[1]],parent._colspan=0;for(i=0,len=row.length;i<len;++i)row[i]._parent=parent,parent._colspan+=row[i]._colspan}stack.pop()}}for(i=0;i<rowSpan;++i)columns.push([]);stack.push([data,-1]);while(stack.length){entry=stack[stack.length-1],row=entry[0],i=entry[1]+1;for(len=row.length;i<len;++i){col=row[i],children=col.children,columns[stack.length-1].push(col),entry[1]=i,col._headers=[col.id];for(j=stack.length-2;j>=0;--j)parent=stack[j][0][stack[j][1]],col._headers.unshift(parent.id);if(children&&children.length){stack.push([children,-1]);break}col._rowspan=rowSpan-stack.length+1}i>=len&&stack.pop()}}for(i=0,len=columns.length;i<len;i+=col._rowspan)col=columns[i][0],col._first=!0;return columns}})},"@VERSION@",{requires:["datatable-core","view","classnamemanager"]})