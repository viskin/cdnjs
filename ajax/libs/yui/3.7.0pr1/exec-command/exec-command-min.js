YUI.add("exec-command",function(c,b){var a=function(){a.superclass.constructor.apply(this,arguments);};c.extend(a,c.Base,{_lastKey:null,_inst:null,command:function(g,f){var e=a.COMMANDS[g];if(e){return e.call(this,g,f);}else{return this._command(g,f);}},_command:function(h,g){var f=this.getInstance();try{try{f.config.doc.execCommand("styleWithCSS",null,1);}catch(k){try{f.config.doc.execCommand("useCSS",null,0);}catch(j){}}f.config.doc.execCommand(h,null,g);}catch(i){}},getInstance:function(){if(!this._inst){this._inst=this.get("host").getInstance();}return this._inst;},initializer:function(){c.mix(this.get("host"),{execCommand:function(f,e){return this.exec.command(f,e);},_execCommand:function(f,e){return this.exec._command(f,e);}});this.get("host").on("dom:keypress",c.bind(function(f){this._lastKey=f.keyCode;},this));},_wrapContent:function(g,f){var e=(this.getInstance().host.editorPara&&!f?true:false);if(e){g="<p>"+g+"</p>";}else{g=g+"<br>";}return g;}},{NAME:"execCommand",NS:"exec",ATTRS:{host:{value:false}},COMMANDS:{wrap:function(g,e){var f=this.getInstance();return(new f.EditorSelection()).wrapContent(e);},inserthtml:function(g,e){var f=this.getInstance();if(f.EditorSelection.hasCursor()||c.UA.ie){return(new f.EditorSelection()).insertContent(e);}else{this._command("inserthtml",e);}},insertandfocus:function(i,f){var h=this.getInstance(),e,g;if(h.EditorSelection.hasCursor()){f+=h.EditorSelection.CURSOR;e=this.command("inserthtml",f);g=new h.EditorSelection();g.focusCursor(true,true);}else{this.command("inserthtml",f);}return e;},insertbr:function(k){var j=this.getInstance(),i=new j.EditorSelection(),e="<var>|</var>",f=null,h=(c.UA.webkit)?"span.Apple-style-span,var":"var";if(i._selection.pasteHTML){i._selection.pasteHTML(e);}else{this._command("inserthtml",e);}var g=function(m){var l=j.Node.create("<br>");m.insert(l,"before");return l;};j.all(h).each(function(o){var m=true;if(c.UA.webkit){m=false;if(o.get("innerHTML")==="|"){m=true;}}if(m){f=g(o);if((!f.previous()||!f.previous().test("br"))&&c.UA.gecko){var l=f.cloneNode();f.insert(l,"after");f=l;}o.remove();}});if(c.UA.webkit&&f){g(f);i.selectNode(f);}},insertimage:function(f,e){return this.command("inserthtml",'<img src="'+e+'">');},addclass:function(g,e){var f=this.getInstance();return(new f.EditorSelection()).getSelected().addClass(e);},removeclass:function(g,e){var f=this.getInstance();return(new f.EditorSelection()).getSelected().removeClass(e);},forecolor:function(g,h){var f=this.getInstance(),e=new f.EditorSelection(),i;if(!c.UA.ie){this._command("useCSS",false);}if(f.EditorSelection.hasCursor()){if(e.isCollapsed){if(e.anchorNode&&(e.anchorNode.get("innerHTML")==="&nbsp;")){e.anchorNode.setStyle("color",h);i=e.anchorNode;}else{i=this.command("inserthtml",'<span style="color: '+h+'">'+f.EditorSelection.CURSOR+"</span>");e.focusCursor(true,true);}return i;}else{return this._command(g,h);}}else{this._command(g,h);}},backcolor:function(g,h){var f=this.getInstance(),e=new f.EditorSelection(),i;if(c.UA.gecko||c.UA.opera){g="hilitecolor";}if(!c.UA.ie){this._command("useCSS",false);}if(f.EditorSelection.hasCursor()){if(e.isCollapsed){if(e.anchorNode&&(e.anchorNode.get("innerHTML")==="&nbsp;")){e.anchorNode.setStyle("backgroundColor",h);i=e.anchorNode;}else{i=this.command("inserthtml",'<span style="background-color: '+h+'">'+f.EditorSelection.CURSOR+"</span>");e.focusCursor(true,true);}return i;}else{return this._command(g,h);}}else{this._command(g,h);}},hilitecolor:function(){return a.COMMANDS.backcolor.apply(this,arguments);},fontname2:function(g,h){this._command("fontname",h);var f=this.getInstance(),e=new f.EditorSelection();if(e.isCollapsed&&(this._lastKey!=32)){if(e.anchorNode.test("font")){e.anchorNode.set("face",h);}}},fontsize2:function(g,i){this._command("fontsize",i);var f=this.getInstance(),e=new f.EditorSelection();if(e.isCollapsed&&e.anchorNode&&(this._lastKey!=32)){if(c.UA.webkit){if(e.anchorNode.getStyle("lineHeight")){e.anchorNode.setStyle("lineHeight","");}}if(e.anchorNode.test("font")){e.anchorNode.set("size",i);}else{if(c.UA.gecko){var h=e.anchorNode.ancestor(f.EditorSelection.DEFAULT_BLOCK_TAG);if(h){h.setStyle("fontSize","");}}}}},insertunorderedlist:function(e){this.command("list","ul");},insertorderedlist:function(e){this.command("list","ol");},list:function(z,D){var g=this.getInstance(),j,p=this,y="dir",f="yui3-touched",r,m,o,i,t,v,k,l,B,e,x=(g.host.editorPara?true:false),w=new g.EditorSelection();z="insert"+((D==="ul")?"un":"")+"orderedlist";if(c.UA.ie&&!w.isCollapsed){m=w._selection;j=m.htmlText;o=g.Node.create(j)||g.one("body");if(o.test("li")||o.one("li")){this._command(z,null);return;}if(o.test(D)){i=m.item?m.item(0):m.parentElement();t=g.one(i);e=t.all("li");v="<div>";e.each(function(n){v=p._wrapContent(n.get("innerHTML"));});v+="</div>";k=g.Node.create(v);if(t.get("parentNode").test("div")){t=t.get("parentNode");}if(t&&t.hasAttribute(y)){if(x){k.all("p").setAttribute(y,t.getAttribute(y));}else{k.setAttribute(y,t.getAttribute(y));}}if(x){t.replace(k.get("innerHTML"));}else{t.replace(k);}if(m.moveToElementText){m.moveToElementText(k._node);}m.select();}else{l=c.one(m.parentElement());if(!l.test(g.EditorSelection.BLOCKS)){l=l.ancestor(g.EditorSelection.BLOCKS);}if(l){if(l.hasAttribute(y)){r=l.getAttribute(y);}}if(j.indexOf("<br>")>-1){j=j.split(/<br>/i);}else{var C=g.Node.create(j),u=C?C.all("p"):null;if(u&&u.size()){j=[];u.each(function(s){j.push(s.get("innerHTML"));});}else{j=[j];}}B="<"+D+' id="ie-list">';c.each(j,function(s){var n=g.Node.create(s);if(n&&n.test("p")){if(n.hasAttribute(y)){r=n.getAttribute(y);}s=n.get("innerHTML");}B+="<li>"+s+"</li>";});B+="</"+D+">";m.pasteHTML(B);i=g.config.doc.getElementById("ie-list");i.id="";if(r){i.setAttribute(y,r);}if(m.moveToElementText){m.moveToElementText(i);}m.select();}}else{if(c.UA.ie){l=g.one(w._selection.parentElement());if(l.test("p")){if(l&&l.hasAttribute(y)){r=l.getAttribute(y);}j=c.EditorSelection.getText(l);if(j===""){var A="";if(r){A=' dir="'+r+'"';
}B=g.Node.create(c.Lang.sub("<{tag}{dir}><li></li></{tag}>",{tag:D,dir:A}));l.replace(B);w.selectNode(B.one("li"));}else{this._command(z,null);}}else{this._command(z,null);}}else{g.all(D).addClass(f);if(w.anchorNode.test(g.EditorSelection.BLOCKS)){l=w.anchorNode;}else{l=w.anchorNode.ancestor(g.EditorSelection.BLOCKS);}if(!l){l=w.anchorNode.one(g.EditorSelection.BLOCKS);}if(l&&l.hasAttribute(y)){r=l.getAttribute(y);}if(l&&l.test(D)){var h=l.ancestor("p");j=g.Node.create("<div/>");i=l.all("li");i.each(function(n){j.append(p._wrapContent(n.get("innerHTML"),h));});if(r){if(x){j.all("p").setAttribute(y,r);}else{j.setAttribute(y,r);}}if(x){j=g.Node.create(j.get("innerHTML"));}var q=j.get("firstChild");l.replace(j);w.selectNode(q);}else{this._command(z,null);}B=g.all(D);if(r){if(B.size()){B.each(function(s){if(!s.hasClass(f)){s.setAttribute(y,r);}});}}B.removeClass(f);}}},justify:function(j,k){if(c.UA.webkit){var i=this.getInstance(),h=new i.EditorSelection(),e=h.anchorNode;var g=e.getStyle("backgroundColor");this._command(k);h=new i.EditorSelection();if(h.anchorNode.test("div")){var f="<span>"+h.anchorNode.get("innerHTML")+"</span>";h.anchorNode.set("innerHTML",f);h.anchorNode.one("span").setStyle("backgroundColor",g);h.selectNode(h.anchorNode.one("span"));}}else{this._command(k);}},justifycenter:function(e){this.command("justify","justifycenter");},justifyleft:function(e){this.command("justify","justifyleft");},justifyright:function(e){this.command("justify","justifyright");},justifyfull:function(e){this.command("justify","justifyfull");}}});var d=function(j,v,r){var k=this.getInstance(),t=k.config.doc,h=t.selection.createRange(),g=t.queryCommandValue(j),l,f,i,e,n,u,q;if(g){l=h.htmlText;f=new RegExp(r,"g");i=l.match(f);if(i){l=l.replace(r+";","").replace(r,"");h.pasteHTML('<var id="yui-ie-bs">');e=t.getElementById("yui-ie-bs");n=t.createElement("div");u=t.createElement(v);n.innerHTML=l;if(e.parentNode!==k.config.doc.body){e=e.parentNode;}q=n.childNodes;e.parentNode.replaceChild(u,e);c.each(q,function(m){u.appendChild(m);});h.collapse();if(h.moveToElementText){h.moveToElementText(u);}h.select();}}this._command(j);};if(c.UA.ie){a.COMMANDS.bold=function(){d.call(this,"bold","b","FONT-WEIGHT: bold");};a.COMMANDS.italic=function(){d.call(this,"italic","i","FONT-STYLE: italic");};a.COMMANDS.underline=function(){d.call(this,"underline","u","TEXT-DECORATION: underline");};}c.namespace("Plugin");c.Plugin.ExecCommand=a;},"@VERSION@",{"requires":["frame"]});