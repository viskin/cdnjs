YUI.add("slider",function(A){var g="slider",X="rail",k="thumb",j="value",T="min",m="max",Q="thumbImage",l="railSize",a="contentBox",P="slideStart",Z="slideEnd",W="thumbDrag",c="sync",H="positionThumb",h="rendered",b="disabled",N="disabledChange",V=".",o="px",D="width",d="height",R="complete",J=A.Lang,e=J.isBoolean,O=J.isString,n=J.isNumber,G=A.ClassNameManager.getClassName,K="image",B=G(g,X),C=G(g,k),S=G(g,k,K),E=G(g,K,"error"),I=Math,U=I.max,i=I.round,F=I.floor;function f(){f.superclass.constructor.apply(this,arguments);}A.mix(f,{NAME:g,AXIS_KEYS:{x:{offsetEdge:"left",dim:D,offAxisDim:d,eventPageAxis:"pageX",ddStick:"stickX",xyIndex:0},y:{offsetEdge:"top",dim:d,offAxisDim:D,eventPageAxis:"pageY",ddStick:"stickY",xyIndex:1}},HTML_PARSER:{rail:V+B,thumb:V+C,thumbImage:V+S},ATTRS:{axis:{value:"x",writeOnce:true,validator:function(L){return this._validateNewAxis(L);},setter:function(L){return this._setAxisFn(L);}},min:{value:0,validator:function(L){return this._validateNewMin(L);}},max:{value:100,validator:function(L){return this._validateNewMax(L);}},value:{value:0,validator:function(L){return this._validateNewValue(L);},setter:function(L){return this._setValueFn(L);}},rail:{value:null,validator:function(L){return this._validateNewRail(L);},setter:function(L){return this._setRailFn(L);}},thumb:{value:null,validator:function(L){return this._validateNewThumb(L);},setter:function(L){return this._setThumbFn(L);}},thumbImage:{value:null,validator:function(L){return this._validateNewThumbImage(L);},setter:function(L){return this._setThumbImageFn(L);}},railSize:{value:"0",validator:function(L){return this._validateNewRailSize(L);}},railEnabled:{value:true,validator:e}}});A.extend(f,A.Widget,{_key:null,_factor:1,_railSize:null,_thumbSize:null,_thumbOffset:0,_stall:false,_disabled:false,initializer:function(){this._key=f.AXIS_KEYS[this.get("axis")];this.after("minChange",this._afterMinChange);this.after("maxChange",this._afterMaxChange);this.after("railSizeChange",this._afterRailSizeChange);this.publish(P);this.publish(Z);this.publish(c,{defaultFn:this._defSyncFn});this.publish(H,{defaultFn:this._defPositionThumbFn});},renderUI:function(){this._initRail();this._initThumb();},_initRail:function(){var L=this.get(a),M=this.get(X);if(!M){M=L.appendChild(A.Node.create('<div class="'+B+'"></div>'));this.set(X,M);}else{if(!L.contains(M)){L.appendChild(M);}}M.addClass(B);M.addClass(this.getClassName(X,this.get("axis")));},_initThumb:function(){var M=this.get(X),L=this.get(k);if(L&&!this.get(Q)&&L.get("nodeName").toLowerCase()==="img"){this.set(Q,L);this.set(k,null);L=null;}if(!L){L=A.Node.create('<div class="'+C+'"></div>');this.set(k,L);}L.addClass(C);if(!M.contains(L)){M.appendChild(L);}if(this.get(Q)){this._initThumbImage();}},_initThumbImage:function(){var M=this.get(k),L=this.get(Q);if(L){L.replaceClass(C,S);if(!M.contains(L)){M.appendChild(L);}}},bindUI:function(){this.publish(W,{defaultFn:this._defUpdateValueFromDD});this._bindThumbDD();this.after("valueChange",this._afterValueChange);this.after("thumbImageChange",this._afterThumbImageChange);this.after(N,this._afterDisabledChange);},_bindThumbDD:function(){var M={node:this.get(k),constrain2node:this.get(X)},L;M[this._key.ddStick]=true;this._dd=L=new A.DD.Drag(M);L.on("drag:start",A.bind(this._onDDStartDrag,this));L.on("drag:drag",A.bind(this._onDDDrag,this));L.on("drag:end",A.bind(this._onDDEndDrag,this));this._initRailDD();},_initRailDD:function(){this.get(X).on("mousedown",A.bind(this._handleRailMouseDown,this));},_handleRailMouseDown:function(Y){if(this.get("railEnabled")&&!this.get(b)){var L=this._dd,p=this._key.xyIndex,M;if(L.get("primaryButtonOnly")&&Y.button>1){return false;}L._dragThreshMet=true;L._fixIEMouseDown();Y.halt();A.DD.DDM.activeDrag=L;M=L.get("dragNode").getXY();M[p]+=this._thumbOffset;L._setStartPosition(M);L.set("activeHandle",L.get("dragNode"));L.start();L._alignNode([Y.pageX,Y.pageY]);}},syncUI:function(){var L=this.get(Q);if(this._isImageLoading(L)){this._scheduleSync();}else{this._ready(L,!this._isImageLoaded(L));}},_scheduleSync:function(){var L,M;if(!this._stall){this._disabled=this.get(b);this.set(b,true);this._stall=this.on(N,this._stallDisabledChange);L=this.get(Q);M=A.bind(this._imageLoaded,this,L);L.on("load",M);L.on("error",M);}},_stallDisabledChange:function(L){this._disabled=L.newVal;L.preventDefault();},_imageLoaded:function(L,Y){var M=(Y.type.toLowerCase().indexOf("error")>-1);if(this._stall){this._stall.detach();}this._stall=false;this._ready(L,M);this.set(b,this._disabled);},_ready:function(L,M){var Y=M?"addClass":"removeClass";this.get(a)[Y](E);this.fire(c);},_defSyncFn:function(L){this._uiSetThumbSize();this._setThumbOffset();this._uiSetRailSize();this._setRailOffsetXY();this._setDDGutter();this._setFactor();var M=this.get(j);this.fire(H,{value:M,offset:this._convertValueToOffset(M)});},_uiSetThumbSize:function(){var M=this.get(k),p=this._key.dim,L=this.get(Q),Y;Y=parseInt(M.getComputedStyle(p),10);if(L&&this._isImageLoaded(L)){Y=L.get(p);}this._thumbSize=Y;},_setThumbOffset:function(){this._thumbOffset=F(this._thumbSize/2);},_uiSetRailSize:function(){var r=this.get(X),M=this.get(k),L=this.get(Q),q=this._key.dim,Y=this.get(l),p=false;if(parseInt(Y,10)){r.setStyle(q,Y);Y=parseInt(r.getComputedStyle(q),10);}else{Y=this.get(q);if(parseInt(Y,10)){p=true;r.setStyle(q,Y);Y=parseInt(r.getComputedStyle(q),10);}Y=U(Y|0,parseInt(M.getComputedStyle(q),10),parseInt(r.getComputedStyle(q),10));if(L&&this._isImageLoaded(L)){Y=U(L.get(q),Y);}}r.setStyle(q,Y+o);this._railSize=Y;if(p){q=this._key.offAxisDim;Y=this.get(q);if(Y){r.set(q,Y);}}},_setRailOffsetXY:function(){this._offsetXY=this.get(X).getXY()[this._key.xyIndex]-this._thumbOffset;},_setDDGutter:function(){var p=[0,0,0,0],M=this._key.xyIndex,Y=this._thumbOffset,q=-Y,L=-1*(this._thumbSize-Y);if(M){p[0]=q;p[2]=L;}else{p[3]=q;p[1]=L;}this._dd.set("gutter",p.join(" "));},_setFactor:function(){this._factor=this._railSize?(this.get(m)-this.get(T))/this._railSize:1;},getValue:function(){return this.get(j);
},setValue:function(L){this.set(j,L);},_validateNewAxis:function(L){return O(L)&&"xXyY".indexOf(L.charAt(0))>-1;},_validateNewMin:function(L){return n(L);},_validateNewMax:function(L){return n(L);},_validateNewValue:function(M){var Y=this.get(T),L=this.get(m);return n(M)&&(Y<L?(M>=Y&&M<=L):(M>=L&&M<=Y));},_validateNewRail:function(L){return !this.get(h)||L;},_validateNewThumb:function(L){return !this.get(h)||L;},_validateNewThumbImage:function(L){return !this.get(h)||L;},_validateNewRailSize:function(L){return O(L)&&(L==="0"||/^\d+(?:p[xtc]|%|e[mx]|in|[mc]m)$/.test(L));},_setAxisFn:function(L){return L.charAt(0).toLowerCase();},_setValueFn:function(L){return L;},_setRailFn:function(L){return A.get(L)||null;},_setThumbFn:function(L){return A.get(L)||null;},_setThumbImageFn:function(L){return L?A.get(L)||A.Node.create('<img src="'+L+'" alt="Slider thumb">'):null;},_onDDStartDrag:function(L){this._setRailOffsetXY();this.fire(P,{ddEvent:L});},_onDDDrag:function(L){this.fire(W,{ddEvent:L});},_defUpdateValueFromDD:function(M){var L=this.get(j),Y=M.ddEvent[this._key.eventPageAxis]-this._offsetXY;Y=i(this.get(T)+(Y*this._factor));if(L!==Y){this.set(j,Y,{ddEvent:M.ddEvent});}},_onDDEndDrag:function(L){this.fire(Z,{ddEvent:L});},_defPositionThumbFn:function(L){this._uiPositionThumb(L.offset);},_uiPositionThumb:function(M){var L=this._dd;M+=this._offsetXY;L._setStartPosition(L.get("dragNode").getXY());L._alignNode([M,M],true);},_afterValueChange:function(M){if(!M.ddEvent){var L=this._convertValueToOffset(M.newVal);this.fire(H,{value:M.newVal,offset:L});}},_convertValueToOffset:function(M){var Y=this.get(T),L=this.get(m);return i(((M-Y)/(L-Y))*this._railSize);},_afterThumbChange:function(M){var L;if(this.get(h)){if(M.prevValue){M.prevValue.get("parentNode").removeChild(M.prevValue);}this._initThumb();L=this.get(k);this._dd.set("node",L);this._dd.set("dragNode",L);this.syncUI();}},_afterThumbImageChange:function(L){if(this.get(h)){if(L.prevValue){L.prevValue.get("parentNode").removeChild(L.prevValue);}this._initThumbImage();this.syncUI();}},_afterMinChange:function(L){this._refresh(L);},_afterMaxChange:function(L){this._refresh(L);},_afterRailSizeChange:function(L){this._refresh(L);},_afterDisabledChange:function(L){if(this._dd){this._dd.set("lock",L.newVal);}},_refresh:function(L){if(L.newVal!==L.prevVal&&this.get(h)){this.syncUI();}},_isImageLoading:function(L){return L&&!L.get(R);},_isImageLoaded:function(M){if(M){var L=M.get("naturalWidth");return M.get(R)&&(!n(L)?M.get(D):L);}return true;}});A.Slider=f;},"@VERSION@",{requires:["widget","dd-constrain"]});