YUI.add("node-menunav",function(D){var l=D.UA,AL=D.Lang,s=D.later,AH=D.ClassNameManager.getClassName,P="menu",G="menuitem",AD="hidden",z="tabIndex",Q="parentNode",W="children",v="offsetHeight",y="offsetWidth",AJ="px",g="id",I=".",E="handledMouseOut",q="handledMouseOver",b="active",AG="label",d="a",t="mousedown",AK="keydown",x="click",O="",U="first-of-type",k=AH(P),AC=AH(P,AD),a=AH(P,"horizontal"),AE=AH(P,AG),i=AH(P,AG,b),Z=AH(P,AG,(P+"visible")),J=AH(G),A=AH(G,b),h=I+k;var K=function(AO){var AQ=AO.previous(),AN,AP,AM,Y;if(!AQ){AN=AO.get(Q);AM=AN.get(Q).get(W);if(AM.size()>1){Y=AN.previous();if(Y){AP=Y.get(W);}else{AP=AM.item(AM.size()-1).get(W);}}else{AP=AN.get(W);}AQ=AP.item(AP.size()-1);}return AQ;};var c=function(AO){var AQ=AO.next(),AN,AP,AM,Y;if(!AQ){AN=AO.get(Q);AM=AN.get(Q).get(W);if(AM.size()>1){Y=AN.next();if(Y){AP=Y.get(W);}else{AP=AM.item(0).get(W);}}else{AP=AO.get(Q).get(W);}AQ=AP.item(0);}return AQ;};var R=function(Y,AM){Y.setAttribute("role",AM);};var S=function(Y,AN,AM){Y.setAttribute(("aria-"+AN),AM);};var AF=function(Y){R(Y,"presentation");};var AA=function(Y){Y.set(z,-1);};var M=function(Y){Y.set(z,0);};var F=function(Y){var AM=false;if(Y){AM=Y.get("nodeName").toLowerCase()===d;}return AM;};var N=function(Y){return Y.hasClass(J);};var r=function(Y){return Y.hasClass(AE);};var p=function(Y){return Y.hasClass(a);};var m=function(Y){return Y.hasClass(Z);};var o=function(Y){return F(Y)?Y:Y.query(d);};var w=function(AN,AM,Y){var AO;if(AN){if(AN.hasClass(AM)){AO=AN;}if(!AO&&Y){AO=AN.ancestor((I+AM));}}return AO;};var L=function(Y){return Y.ancestor(h);};var X=function(AM,Y){return w(AM,k,Y);};var AB=function(AM,Y){var AN;if(AM){AN=w(AM,J,Y);}return AN;};var n=function(AM,Y){var AN;if(AM){if(Y){AN=w(AM,AE,Y);}else{AN=w(AM,AE)||AM.query((I+AE));}}return AN;};var B=function(AM,Y){var AN;if(AM){AN=AB(AM,Y)||n(AM,Y);}return AN;};var V=function(AO,AN){var Y,AP,AM;if(AO){Y=N(AO)?AO:AO.get(Q);AP=AN?K(Y):c(Y);AM=B(AP);}return AM;};var AI=function(Y){return V(Y,true);};var C=function(Y){return B(Y.query("li"));};var f=function(Y){return N(Y)?A:i;};var j=function(AN){var AM;if(AN){AM=o(AN);try{AM.blur();}catch(Y){}}};var u=function(AN){var AM;if(AN){AM=o(AN);try{AM.focus();}catch(Y){}}};var e=function(Y,AM){return Y&&!Y[q]&&(Y===AM||Y.contains(AM));};var H=function(AM,Y){return AM&&!AM[E]&&(AM!==Y&&!AM.contains(Y));};var T=function(AN){var AM=this,AU=AN.owner,AS,AT,AR,AO,AQ,AP,Y;if(AU){AT=AN.useARIA;AR=AN.autoSubmenuDisplay;AO=AN.mouseOutHideDelay;AM._useARIA=AL.isBoolean(AT)?AT:((l.gecko&&l.gecko>=1.9)||(l.ie&&l.ie>=8));AM._autoSubmenuDisplay=AL.isBoolean(AR)?AR:true;AM._submenuShowDelay=AN.submenuShowDelay||250;AM._submenuHideDelay=AN.submenuHideDelay||250;AM._mouseOutHideDelay=AL.isNumber(AO)?AO:750;AQ=AU.queryAll(h);if(AQ){AQ.addClass(AC);}Y=AU.queryAll("ul:"+U);if(Y){Y.addClass(U);}AU.on("mouseover",AM._onMouseOver,AM);AU.on("mouseout",AM._onMouseOut,AM);AU.on("mousemove",AM._onMouseMove,AM);AU.on(t,AM._toggleSubmenuDisplay,AM);AU.on(AK,AM._toggleSubmenuDisplay,AM);AU.on(x,AM._toggleSubmenuDisplay,AM);AU.on("keypress",AM._onKeyPress,AM);AU.on(AK,AM._onKeyDown,AM);AS=AU.get("ownerDocument");AS.on(t,AM._onDocMouseDown,AM);D.on("focus",D.bind(AM._onDocFocus,AM),AS);AM._rootMenu=AU;if(AM._useARIA){AM._applyARIA(AU);AP=C(AU);if(AP){M(o(AP));AM._firstItem=AP;}}}};T.NS="MenuNav";T.SHIM_TEMPLATE_TITLE="Menu Stacking Shim";T.SHIM_TEMPLATE='<iframe frameborder="0" tabindex="-1" class="'+AH("shim")+'" title="'+T.SHIM_TEMPLATE_TITLE+'" src="javascript:false;"></iframe>';T.prototype={_rootMenu:null,_activeItem:null,_activeMenu:null,_hasFocus:false,_blockMouseEvent:false,_currentMouseX:0,_movingToSubmenu:false,_showSubmenuTimer:null,_hideSubmenuTimer:null,_hideAllSubmenusTimer:null,_firstItem:null,_autoSubmenuDisplay:true,_isRoot:function(Y){return this._rootMenu.compareTo(Y);},_getTopmostSubmenu:function(AO){var AN=this,Y=L(AO),AM;if(!Y){AM=AO;}else{if(AN._isRoot(Y)){AM=AO;}else{AM=AN._getTopmostSubmenu(Y);}}return AM;},_clearActiveItem:function(){var AM=this,Y=AM._activeItem;if(Y){Y.removeClass(f(Y));if(AM._useARIA){AA(o(Y));}}AM._activeItem=null;},_setActiveItem:function(AM){var Y=this;if(AM){Y._clearActiveItem();AM.addClass(f(AM));if(Y._useARIA){M(o(AM));}Y._activeItem=AM;}},_focusItem:function(Y){if(Y&&this._hasFocus){s(0,null,u,Y);}},_applyARIA:function(AO){var AN=this,AS=AN._isRoot(AO),Y,AR,AQ,AM,AU,AP,AT;R(AO,(AS&&p(AO)?"menubar":P));if(!AS){Y=AO.previous();AR=Y.query(I+AH(P,"toggle"));if(AR){Y=AR;}AT=Y.get(g);if(!AT){AT=D.guid();Y.set(g,AT);}S(AO,"labelledby",AT);S(AO,AD,true);}AQ=AO.queryAll("ul,li");if(AQ){AQ.each(function(AV){AF(AV);});}AM=AO.queryAll((I+AH(G,"content")));if(AM){AM.each(function(AV){AA(AV);R(AV,G);});}AU=AO.queryAll((I+AE));if(AU){AU.each(function(AV){Y=AV;AR=AV.query((I+AH(P,"toggle")));if(AR){AF(AR);AA(AR);Y=AR.previous();}R(Y,G);S(Y,"haspopup",true);AA(Y);AP=AV.next();if(AP){AN._applyARIA(AP);}});}},_showMenu:function(AQ){var AN=this,Y=L(AQ),AO=AQ.get(Q),AM=AO.getXY(),AP;if(AN._useARIA){S(AQ,AD,false);}if(p(Y)){AM[1]=AM[1]+AO.get(v);}else{AM[0]=AM[0]+AO.get(y);}AQ.setXY(AM);if(l.ie<8){if(l.ie===6&&!AQ.hasIFrameShim){AQ.appendChild(D.Node.create(T.SHIM_TEMPLATE));AQ.hasIFrameShim=true;}AQ.setStyles({height:O,width:O});AQ.setStyles({height:(AQ.get(v)+AJ),width:(AQ.get(y)+AJ)});}AQ.previous().addClass(Z);AQ.removeClass(AC);AP=C(AQ);AN._focusItem(AP);},_hideMenu:function(AO,AM){var AN=this,AP=AO.previous(),Y;AP.removeClass(Z);if(AM){AN._setActiveItem(AP);AN._focusItem(AP);}Y=AO.query((I+A));if(Y){Y.removeClass(A);}AO.setStyles({left:O,top:O});AO.addClass(AC);S(AO,AD,true);},_hideAllSubmenus:function(AN){var AM=this,Y=AN.queryAll(h);if(Y){Y.each(D.bind(function(AO){AM._hideMenu(AO);},AM));}},_cancelShowSubmenuTimer:function(){var AM=this,Y=AM._showSubmenuTimer;if(Y){Y.cancel();AM._showSubmenuTimer=null;}},_cancelHideSubmenuTimer:function(){var Y=this,AM=Y._hideSubmenuTimer;if(AM){AM.cancel();Y._hideSubmenuTimer=null;}},_onMenuMouseOver:function(AO,AN){var AM=this,Y=AM._hideAllSubmenusTimer;
if(Y){Y.cancel();AM._hideAllSubmenusTimer=null;}AM._cancelHideSubmenuTimer();AM._activeMenu=AO;if(AM._movingToSubmenu&&p(AO)){AM._movingToSubmenu=false;}},_onMenuMouseOut:function(AS,AQ){var AP=this,AN=AP._activeMenu,AR=AQ.relatedTarget,Y=AP._activeItem,AO,AM;if(AN&&!AN.contains(AR)){AO=L(AN);if(AO&&!AO.contains(AR)){if(AP._mouseOutHideDelay>0){AP._cancelShowSubmenuTimer();AP._hideAllSubmenusTimer=s(AP._mouseOutHideDelay,AP,function(){var AT;AN=AP._activeMenu;AP._hideAllSubmenus(AP._rootMenu);if(AN){AT=AP._getTopmostSubmenu(AN);AP._focusItem(AT.previous());}});}}else{if(Y){AM=L(Y);if(!AP._isRoot(AM)){AP._focusItem(AM.previous());}}}}},_onMenuLabelMouseOver:function(AP,AR){var AQ=this,AO=AQ._activeMenu,Y=AQ._isRoot(AO),AN=(AQ._autoSubmenuDisplay&&Y||!Y),AM;AQ._setActiveItem(AP);AQ._focusItem(AP);if(AN&&!AQ._movingToSubmenu){AQ._cancelHideSubmenuTimer();AQ._cancelShowSubmenuTimer();if(!m(AP)){AM=AP.next();if(AM){AQ._hideAllSubmenus(AO);AQ._showSubmenuTimer=s(AQ._submenuShowDelay,AQ,AQ._showMenu,AM);}}}},_onMenuLabelMouseOut:function(AO,AQ){var AP=this,Y=AP._isRoot(AP._activeMenu),AN=(AP._autoSubmenuDisplay&&Y||!Y),AR=AQ.relatedTarget,AM=AO.next();AP._clearActiveItem();if(AN){if(AP._movingToSubmenu&&!AP._showSubmenuTimer&&AM){AP._hideSubmenuTimer=s(AP._submenuHideDelay,AP,AP._hideMenu,AM);}else{if(!AP._movingToSubmenu&&AM&&!AM.contains(AR)&&AR!==AM){AP._cancelShowSubmenuTimer();AP._hideMenu(AM);}}}},_onMenuItemMouseOver:function(AO,AQ){var AP=this,AN=AP._activeMenu,Y=AP._isRoot(AN),AM=(AP._autoSubmenuDisplay&&Y||!Y);AP._setActiveItem(AO);AP._focusItem(AO);if(AM&&!AP._movingToSubmenu){AP._hideAllSubmenus(AN);}},_onMenuItemMouseOut:function(Y,AM){this._clearActiveItem();},_onVerticalMenuKeyDown:function(Y){var AM=this,AR=AM._activeMenu,AX=AM._rootMenu,AN=Y.target,AP=B(AN,true),AQ=false,AV=Y.keyCode,AT,AO,AS,AW,AU;switch(AV){case 37:AO=L(AR);if(AO&&p(AO)){AM._hideMenu(AR);AS=K(AR.get(Q));AU=B(AS);if(AU){if(r(AU)){AT=AU.next();if(AT){AM._showMenu(AT);AM._setActiveItem(C(AT));}else{AM._setActiveItem(AU);u(AU);}}else{AM._setActiveItem(AU);u(AU);}}}else{if(!AM._isRoot(AR)){AM._hideMenu(AR,true);}}AQ=true;break;case 39:if(r(AN)){AT=AN.next();if(AT){AM._showMenu(AT);AM._setActiveItem(C(AT));}}else{if(p(AX)){AT=AM._getTopmostSubmenu(AR);AS=c(AT.get(Q));AU=B(AS);AM._hideAllSubmenus(AX);if(AU){if(r(AU)){AT=AU.next();if(AT){AM._showMenu(AT);AM._setActiveItem(C(AT));}else{AM._setActiveItem(AU);u(AU);}}else{AM._setActiveItem(AU);u(AU);}}}}AQ=true;break;case 38:case 40:AM._hideAllSubmenus(AR);AW=AV===38?AI(AP):V(AP);AM._setActiveItem(AW);u(AW);AQ=true;break;}if(AQ){Y.preventDefault();}},_onHorizontalMenuKeyDown:function(Y){var AM=this,AQ=AM._activeMenu,AN=Y.target,AO=B(AN,true),AP=false,AS=Y.keyCode,AT,AR;switch(AS){case 37:case 39:AM._hideAllSubmenus(AQ);AT=AS===37?AI(AO):V(AO);AM._setActiveItem(AT);u(AT);AP=true;break;case 40:AM._hideAllSubmenus(AQ);if(r(AO)){AR=AO.next();if(AR){AM._showMenu(AR);AM._setActiveItem(C(AR));}AP=true;}break;}if(AP){Y.preventDefault();}},_onMouseMove:function(AM){var Y=this;s(10,Y,function(){Y._currentMouseX=AM.pageX;});},_onMouseOver:function(AP){var AO=this,AM,Y,AR,AN,AQ;if(AO._blockMouseEvent){AO._blockMouseEvent=false;}else{AM=AP.target;Y=X(AM,true);AR=n(AM,true);AQ=AB(AM,true);if(e(Y,AM)){AO._onMenuMouseOver(Y,AP);Y[q]=true;Y[E]=false;AN=L(Y);if(AN){AN[E]=true;AN[q]=false;}}if(e(AR,AM)){AO._onMenuLabelMouseOver(AR,AP);AR[q]=true;AR[E]=false;}if(e(AQ,AM)){AO._onMenuItemMouseOver(AQ,AP);AQ[q]=true;AQ[E]=false;}}},_onMouseOut:function(AM){var AN=this,AP=AN._activeMenu,AU=false,AO,AQ,AS,Y,AR,AT;AN._movingToSubmenu=(AP&&!p(AP)&&((AM.pageX-5)>AN._currentMouseX));AO=AM.target;AQ=AM.relatedTarget;AS=X(AO,true);Y=n(AO,true);AT=AB(AO,true);if(H(Y,AQ)){AN._onMenuLabelMouseOut(Y,AM);Y[E]=true;Y[q]=false;}if(H(AT,AQ)){AN._onMenuItemMouseOut(AT,AM);AT[E]=true;AT[q]=false;}if(Y){AR=Y.next();if(AR&&(AQ===AR||AR.contains(AQ))){AU=true;}}if(H(AS,AQ)||AU){AN._onMenuMouseOut(AS,AM);AS[E]=true;AS[q]=false;}},_toggleSubmenuDisplay:function(AN){var AO=this,AP=AN.target,AM=n(AP,true),Y=AN.type,AT,AS,AR,AU,AV,AQ;if(AM){AT=F(AP)?AP:AP.ancestor(F);if(AT){AR=AT.getAttribute("href",2);AU=AR.indexOf("#");AV=AR.length;if(AU===0&&AV>1){AQ=AR.substr(1,AV);AS=AM.next();if(AS&&(AS.get(g)===AQ)){if(Y===t||(Y===AK&&AN.keyCode===13)){if(l.webkit&&!AO._hasFocus){AO._hasFocus=true;}if(m(AM)){AO._hideMenu(AS);u(AM);}else{AO._hideAllSubmenus(AO._rootMenu);AO._showMenu(AS);}}if(Y===x){AN.preventDefault();}}}}}},_onKeyPress:function(Y){switch(Y.keyCode){case 37:case 38:case 39:case 40:Y.preventDefault();break;}},_onKeyDown:function(AQ){var AP=this,Y=AP._activeItem,AM=AQ.target,AO=L(AM),AN;if(AO){AP._activeMenu=AO;if(p(AO)){AP._onHorizontalMenuKeyDown(AQ);}else{AP._onVerticalMenuKeyDown(AQ);}if(AQ.keyCode===27){if(!AP._isRoot(AO)){AP._hideMenu(AO,true);AQ.stopPropagation();AP._blockMouseEvent=l.gecko?true:false;}else{if(Y){if(r(Y)&&m(Y)){AN=Y.next();if(AN){AP._hideMenu(AN);}}else{j(AM);AP._clearActiveItem();}}}}}},_onDocMouseDown:function(AO){var AN=this,AM=AN._rootMenu,Y=AO.target;if(!AM.compareTo(Y)&&!AM.contains(Y)){AN._hideAllSubmenus(AM);if(l.webkit){AN._hasFocus=false;AN._clearActiveItem();}}},_onDocFocus:function(AP){var AO=this,AM=AO._useARIA,AQ=AO._firstItem,Y=AO._activeItem,AN=AP.target;if(AO._rootMenu.contains(AN)){if(!AO._hasFocus){AO._hasFocus=true;Y=B(AN,true);if(Y){AO._setActiveItem(Y);}}}else{AO._clearActiveItem();AO._hasFocus=false;if(AQ&&AM){M(o(AQ));}}}};D.namespace("plugin");D.plugin.NodeMenuNav=T;},"@VERSION@",{requires:["node","classnamemanager"]});