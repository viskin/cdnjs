/*! jQuery UI Virtual Keyboard v1.21.3 */
!function(a,b,c){"use strict";var d=a.keyboard=function(e,f){var g,h=this;h.version="1.21.3",h.$el=a(e),h.el=e,h.$el.data("keyboard",h),h.init=function(){var b=d.css;h.settings=f||{},h.options=g=a.extend(!0,{},d.defaultOptions,f),h.namespace=".keyboard"+Math.random().toString(16).slice(2),h.shiftActive=h.altActive=h.metaActive=h.sets=h.capsLock=!1,h.rows=["","-shift","-alt","-alt-shift"],h.inPlaceholder=h.$el.attr("placeholder")||"",h.watermark=d.watermark&&""!==h.inPlaceholder,h.repeatTime=1e3/(g.repeatRate||20),g.preventDoubleEventTime=g.preventDoubleEventTime||100,h.isOpen=!1,h.wheel=a.isFunction(a.fn.mousewheel),h.alwaysAllowed=[20,33,34,35,36,37,38,39,40,45,46],h.$keyboard=[],h.enabled=!0,a.isEmptyObject(g.position)||(g.position.orig_at=g.position.at),h.checkCaret=g.lockInput||d.checkCaret,h.last={start:0,end:0,key:"",val:"",keyset:[!1,!1,!1]},h.temp=["",0,0],a.each("initialized beforeVisible visible hidden canceled accepted beforeClose".split(" "),function(b,c){a.isFunction(g[c])&&h.$el.bind(c+h.namespace,g[c])}),g.alwaysOpen&&(g.stayOpen=!0),a(c).bind("mousedown keyup touchstart checkkeyboard ".split(" ").join(h.namespace+" "),function(c){if(!h.opening&&(h.escClose(c),c.target&&a(c.target).hasClass(b.input))){var d=a(c.target).data("keyboard");d===h&&d.options.openOn&&d.focusOn()}}),h.$el.addClass(b.input+" "+g.css.input).attr({"aria-haspopup":"true",role:"textbox"}),(h.$el.is(":disabled")||h.$el.attr("readonly")&&!h.$el.hasClass(b.locked))&&h.$el.addClass(b.noKeyboard),g.openOn&&h.$el.bind(g.openOn+h.namespace,function(){h.focusOn()}),h.watermark||""!==h.$el.val()||""===h.inPlaceholder||""===h.$el.attr("placeholder")||h.$el.addClass(b.placeholder).val(h.inPlaceholder),h.$el.trigger(d.events.kbInit,[h,h.el]),g.alwaysOpen&&h.reveal()},h.toggle=function(){var a=h.$keyboard.find("."+d.css.keyToggle),b=!h.enabled;h.$preview.prop("readonly",b),h.$keyboard.toggleClass(d.css.keyDisabled,b).find("."+d.css.keyButton).not(a).prop("disabled",b).attr("aria-disabled",b),a.toggleClass(d.css.keyDisabled,b),b&&h.typing_options&&(h.typing_options.text="")},h.setCurrent=function(){var b=d.css;a("."+b.hasFocus).removeClass(b.hasFocus),a("."+b.isCurrent).removeClass(b.isCurrent),h.$el.addClass(b.isCurrent),h.$keyboard.addClass(b.hasFocus),h.isCurrent(!0),h.isOpen=!0},h.isCurrent=function(a){var b=d.currentKeyboard||!1;return a?b=d.currentKeyboard=h.el:a===!1&&b===h.el&&(b=d.currentKeyboard=""),b===h.el},h.isVisible=function(){return h.$keyboard&&h.$keyboard.length?h.$keyboard.is(":visible"):!1},h.focusOn=function(){h.$el.is(":visible")&&setTimeout(function(){/(number|email)/i.test(h.el.type)||h.saveCaret()},20),h.isVisible()||(clearTimeout(h.timer),h.reveal()),g.alwaysOpen&&h.setCurrent()},h.reveal=function(b){var e=d.css;return h.opening=!0,a("."+e.keyboard).not("."+e.alwaysOpen).remove(),b&&(h.isOpen=!1,h.last.value=h.$preview&&h.$preview.val()||"",h.$keyboard.length&&(h.$keyboard.remove(),h.$keyboard=[],h.shiftActive=h.altActive=h.metaActive=!1)),h.$el.is(":disabled")||h.$el.attr("readonly")&&!h.$el.hasClass(e.locked)?void h.$el.addClass(e.noKeyboard):(h.$el.removeClass(e.noKeyboard),g.openOn&&h.$el.unbind(g.openOn+h.namespace),(!h.$keyboard||h.$keyboard&&(!h.$keyboard.length||a.contains(c.body,h.$keyboard[0])))&&h.startup(),h.watermark||h.el.value!==h.inPlaceholder||h.$el.removeClass(e.placeholder).val(""),h.originalContent=h.$el.val(),h.$preview.val(b?h.last.value:h.originalContent),g.acceptValid&&h.checkValid(),g.resetDefault&&(h.shiftActive=h.altActive=h.metaActive=!1,h.showKeySet()),g.appendLocally||"body"!==g.appendTo||h.$keyboard.css({position:"absolute",left:0,top:0}),h.$el.trigger(d.events.kbBeforeVisible,[h,h.el]),h.setCurrent(),h.toggle(),h.$keyboard.show(),g.usePreview&&d.msie&&("undefined"==typeof h.width&&(h.$preview.hide(),h.width=Math.ceil(h.$keyboard.width()),h.$preview.show()),h.$preview.width(h.width)),h.position=a.isEmptyObject(g.position)?!1:g.position,a.ui&&a.ui.position&&h.position&&(h.position.of=h.position.of||h.$el.data("keyboardPosition")||h.$el,h.position.collision=h.position.collision||"flipfit flipfit",g.position.at=g.usePreview?g.position.orig_at:g.position.at2,h.$keyboard.position(h.position)),h.checkDecimal(),h.lineHeight=parseInt(h.$preview.css("lineHeight"),10)||parseInt(h.$preview.css("font-size"),10)+4,g.caretToEnd&&(h.last.start=h.last.end=h.originalContent.length),d.allie&&(0===h.last.end&&h.last.start>0&&(h.last.end=h.last.start),h.last.start<0&&(h.last.start=h.last.end=h.originalContent.length)),setTimeout(function(){h.opening=!1,g.initialFocus&&h.$preview.focus().caret(h.last),h.$el.trigger(d.events.kbVisible,[h,h.el]),h.timer=setTimeout(function(){h.saveCaret()},200)},10),h)},h.updateLanguage=function(){var b=d.layouts,c=g.language||b[g.layout]&&b[g.layout].lang&&b[g.layout].lang||[g.language||"en"],e=d.language;c=(a.isArray(c)?c[0]:c).split("-")[0],g.display=a.extend(!0,{},e.en.display,e[c]&&e[c].display||{},h.settings.display),g.combos=a.extend(!0,{},e.en.combos,e[c]&&e[c].combos||{},h.settings.combos),g.wheelMessage=e[c]&&e[c].wheelMessage||e.en.wheelMessage,g.rtl=b[g.layout]&&b[g.layout].rtl||e[c]&&e[c].rtl||!1,h.regex=e[c]&&e[c].comboRegex||d.comboRegex,h.decimal=/^\./.test(g.display.dec),h.$el.toggleClass("rtl",g.rtl).css("direction",g.rtl?"rtl":"")},h.startup=function(){var c=d.css;h.$preview=h.$el,h.$keyboard&&h.$keyboard.length||("custom"===g.layout&&(g.layoutHash="custom"+h.customHash()),h.layout="custom"===g.layout?g.layoutHash:g.layout,h.updateLanguage(),"undefined"==typeof d.builtLayouts[h.layout]&&(a.isFunction(g.create)&&g.create(h),h.$keyboard.length||h.buildKeyboard(h.layout,!0)),h.$keyboard=d.builtLayouts[h.layout].$keyboard.clone(),g.usePreview?(a.isEmptyObject(g.position)||(g.position.at=g.position.orig_at),h.$preview=h.$el.clone(!1).removeAttr("id").removeClass(c.placeholder+" "+c.input).addClass(c.preview+" "+g.css.input).removeAttr("aria-haspopup").attr("tabindex","-1").show(),"number"==h.$preview.attr("type")&&h.$preview.attr("type","text"),a("<div />").addClass(c.wrapper).append(h.$preview).prependTo(h.$keyboard)):a.isEmptyObject(g.position)||(g.position.at=g.position.at2)),h.preview=h.$preview[0],h.$decBtn=h.$keyboard.find("."+c.keyPrefix+"dec"),(g.enterNavigation||"TEXTAREA"===h.el.tagName)&&h.alwaysAllowed.push(13),g.lockInput&&h.$preview.addClass(c.locked).attr({readonly:"readonly"}),h.bindKeyboard(),h.$keyboard.appendTo(g.appendLocally?h.$el.parent():g.appendTo||"body"),h.bindKeys(),g.reposition&&a.ui&&a.ui.position&&"body"==g.appendTo&&a(b).bind("resize"+h.namespace,function(){h.position&&h.isVisible()&&h.$keyboard.position(h.position)})},h.saveCaret=function(a,b){var c=h.$preview.focus().caret(a,b);h.last.start=a||c.start,h.last.end=b||c.end},h.bindKeyboard=function(){var b,e=d.builtLayouts[h.layout];h.$preview.unbind("keypress keyup keydown mouseup touchend ".split(" ").join(h.namespace+" ")).bind("click"+h.namespace,function(){setTimeout(function(){h.saveCaret()},150)}).bind("keypress"+h.namespace,function(c){if(g.lockInput)return!1;var f=h.last.key=String.fromCharCode(c.charCode||c.which);if(h.$lastKey=[],h.checkCaret&&h.saveCaret(),h.capsLock=f>=65&&90>=f&&!c.shiftKey||f>=97&&122>=f&&c.shiftKey?!0:!1,g.restrictInput){if((8===c.which||0===c.which)&&a.inArray(c.keyCode,h.alwaysAllowed))return;-1===a.inArray(f,e.acceptedKeys)&&(c.preventDefault(),b=a.extend({},c),b.type=d.events.inputRestricted,h.$el.trigger(b,[h,h.el]),a.isFunction(g.restricted)&&g.restricted(b,h,h.el))}else if((c.ctrlKey||c.metaKey)&&(97===c.which||99===c.which||118===c.which||c.which>=120&&c.which<=122))return;e.hasMappedKeys&&e.mappedKeys.hasOwnProperty(f)&&(h.last.key=e.mappedKeys[f],h.insertText(h.last.key),c.preventDefault()),h.checkMaxLength()}).bind("keyup"+h.namespace,function(b){switch(b.which){case 9:if(h.tab&&g.tabNavigation&&!g.lockInput){h.shiftActive=b.shiftKey;var c=d.keyaction.tab(h);if(h.tab=!1,!c)return!1}else b.preventDefault();break;case 27:return h.close(g.autoAccept&&g.autoAcceptOnEsc?"true":!1),!1}return clearTimeout(h.throttled),h.throttled=setTimeout(function(){h.isVisible()&&h.checkCombos()},100),h.checkMaxLength(),h.$el.trigger(d.events.kbChange,[h,h.el]),h.last.val=h.$preview.val(),a.isFunction(g.change)?(g.change(a.Event("change"),h,h.el),!1):void 0}).bind("keydown"+h.namespace,function(a){switch(a.which){case 8:d.keyaction.bksp(h,null,a),a.preventDefault();break;case 9:return g.tabNavigation?(h.tab=!0,!1):(h.tab=!0,!1);case 13:d.keyaction.enter(h,null,a);break;case 20:h.shiftActive=h.capsLock=!h.capsLock,h.showKeySet(this);break;case 86:if(a.ctrlKey||a.metaKey){if(g.preventPaste)return void a.preventDefault();h.checkCombos()}}}).bind("mouseup touchend ".split(" ").join(h.namespace+" "),function(){h.checkCaret&&h.saveCaret()}),h.$keyboard.bind("mousedown click touchstart ".split(" ").join(h.namespace+" "),function(b){b.stopPropagation(),h.isCurrent()||(h.reveal(),a(c).trigger("checkkeyboard"+h.namespace))}),g.preventPaste&&(h.$preview.bind("contextmenu"+h.namespace,function(a){a.preventDefault()}),h.$el.bind("contextmenu"+h.namespace,function(a){a.preventDefault()}))},h.bindKeys=function(){var b=d.css;h.$allKeys=h.$keyboard.find("button."+b.keyButton).unbind(h.namespace+" "+h.namespace+"kb").bind(g.keyBinding.split(" ").join(h.namespace+" ")+h.namespace+" "+d.events.kbRepeater,function(c){if(c.preventDefault(),!h.$keyboard.is(":visible"))return!1;var e,f,i=0,j=this,k=a(j),l=h.getLayers(k),m=l.map(function(){return a(this).attr("data-curtxt")}).get(),n=(new Date).getTime();if(l.each(function(a,b){return b===j?(i=a,!1):void 0}),f=0>i?k:l.eq(i+k.data("curnum")),e=f.attr("data-action"),e=":"===e?":":(e||"").split(":")[0],!(n-(h.last.eventTime||0)<g.preventDoubleEventTime)){if(h.last.eventTime=n,h.$preview.focus(),h.$lastKey=f,h.last.key=f.attr("data-curtxt"),h.checkCaret&&h.$preview.caret(h.last),e.match("meta")&&(e="meta"),e in d.keyaction&&a.isFunction(d.keyaction[e])){if(d.keyaction[e](h,this,c)===!1)return!1}else"undefined"!=typeof e&&(m=h.last.key=h.wheel&&!a(this).hasClass(b.keyAction)?h.last.key:e,h.insertText(m),h.capsLock||g.stickyShift||c.shiftKey||(h.shiftActive=!1,h.showKeySet(this)));return h.$preview.focus().caret(h.last),h.checkCombos(),h.$el.trigger(d.events.kbChange,[h,h.el]),h.last.val=h.$preview.val(),a.isFunction(g.change)?(g.change(a.Event(d.events.inputChange),h,h.el),!1):void 0}}).bind("mouseenter mouseleave touchstart ".split(" ").join(h.namespace+" "),function(c){if(h.isCurrent()){var d=a(this),e=h.getLayers(d),f=(e.length?e.map(function(){return a(this).attr("data-curtxt")||""}).get():"")||[d.find("."+b.keyText).text()];"mouseenter"!==c.type&&"touchstart"!==c.type||"password"===h.el.type||d.hasClass(g.css.buttonDisabled)||d.addClass(g.css.buttonHover).attr("title",function(a,b){return h.wheel&&""===b&&h.sets&&f.length>1&&"touchstart"!==c.type?g.wheelMessage:b}),"mouseleave"===c.type&&(d.data({curtxt:d.data("original"),curnum:0}),d.removeClass("password"===h.el.type?"":g.css.buttonHover).attr("title",function(a,b){return b===g.wheelMessage?"":b}).find("."+b.keyText).html(d.data("original")))}}).bind("mouseup"+h.namespace+" "+"mouseleave touchend touchmove touchcancel ".split(" ").join(h.namespace+"kb "),function(b){return/(mouseleave|touchend|touchcancel)/i.test(b.type)?a(this).removeClass(g.css.buttonHover):(h.isVisible()&&h.isCurrent()&&h.$preview.focus(),h.checkCaret&&h.$preview.caret(h.last)),h.mouseRepeat=[!1,""],clearTimeout(h.repeater),!1}).bind("click"+h.namespace,function(){return!1}).not("."+b.keyAction).bind("mousewheel"+h.namespace,function(c,d){if(h.wheel){d=d||c.deltaY;var e,f=a(this),g=h.getLayers(f),i=g.length&&g.map(function(){return a(this).attr("data-curtxt")}).get()||[f.find("."+b.keyText).text()];return i.length>1?(e=f.data("curnum")+(d>0?-1:1),e>i.length-1&&(e=0),0>e&&(e=i.length-1)):e=0,f.data({curnum:e,layers:i,curtxt:i[e]}),f.find("."+b.keyText).html(i[e]),!1}}).add("."+b.keyPrefix+"tab bksp space enter".split(" ").join(",."+b.keyPrefix),h.$keyboard).bind("mousedown touchstart ".split(" ").join(h.namespace+"kb "),function(){if(0!==g.repeatRate){var b=a(this);h.mouseRepeat=[!0,b],setTimeout(function(){h.mouseRepeat[0]&&h.mouseRepeat[1]===b&&h.repeatKey(b)},g.repeatDelay)}return!1})},h.insertText=function(a){var b,c,e,f=h.$preview.val(),g=h.$preview.caret(),i=h.$preview.scrollLeft(),j=h.$preview.scrollTop(),k=f.length;g.end<g.start&&(g.end=g.start),g.start>k&&(g.end=g.start=k),"TEXTAREA"===h.preview.tagName&&(d.msie&&"\n"===f.substr(g.start,1)&&(g.start+=1,g.end+=1),e=f.split("\n").length-1,h.preview.scrollTop=e>0?h.lineHeight*e:j),b="bksp"===a&&g.start===g.end?!0:!1,a="bksp"===a?"":a,c=g.start+(b?-1:a.length),i+=parseInt(h.$preview.css("fontSize"),10)*("bksp"===a?-1:1),h.$preview.val(h.$preview.val().substr(0,g.start-(b?1:0))+a+h.$preview.val().substr(g.end)).scrollLeft(i).caret(c,c),h.last.start=h.last.end=c},h.checkMaxLength=function(){var a,b,c=h.$preview.val();g.maxLength!==!1&&c.length>g.maxLength&&(a=h.$preview.caret().start,b=Math.min(a,g.maxLength),g.maxInsert||(c=h.last.val,b=a-1),h.$preview.val(c.substring(0,g.maxLength)),h.saveCaret(b,b)),h.$decBtn.length&&h.checkDecimal()},h.repeatKey=function(a){a.trigger(d.events.kbRepeater),h.mouseRepeat[0]&&(h.repeater=setTimeout(function(){h.repeatKey(a)},h.repeatTime))},h.showKeySet=function(a){g=h.options;var b=d.css,c="",e=(h.shiftActive?1:0)+(h.altActive?2:0);return h.shiftActive||(h.capsLock=!1),h.metaActive?(c=a&&a.name&&/meta/i.test(a.name)?a.name:"",""===c?c=h.metaActive===!0?"":h.metaActive:h.metaActive=c,(!g.stickyShift&&h.last.keyset[2]!==h.metaActive||(h.shiftActive||h.altActive)&&!h.$keyboard.find("."+b.keySet+"-"+c+h.rows[e]).length)&&(h.shiftActive=h.altActive=!1)):!g.stickyShift&&h.last.keyset[2]!==h.metaActive&&h.shiftActive&&(h.shiftActive=h.altActive=!1),e=(h.shiftActive?1:0)+(h.altActive?2:0),c=0!==e||h.metaActive?""===c?"":"-"+c:"-normal",h.$keyboard.find("."+b.keySet+c+h.rows[e]).length?(h.$keyboard.find("."+b.keyPrefix+"alt,."+b.keyPrefix+"shift,."+b.keyAction+"[class*=meta]").removeClass(g.css.buttonActive).end().find("."+b.keyPrefix+"alt").toggleClass(g.css.buttonActive,h.altActive).end().find("."+b.keyPrefix+"shift").toggleClass(g.css.buttonActive,h.shiftActive).end().find("."+b.keyPrefix+"lock").toggleClass(g.css.buttonActive,h.capsLock).end().find("."+b.keySet).hide().end().find("."+b.keySet+c+h.rows[e]).show().end().find("."+b.keyAction+"."+b.keyboard+c).addClass(g.css.buttonActive),h.last.keyset=[h.shiftActive,h.altActive,h.metaActive],void h.$el.trigger(d.events.kbKeysetChange,[h,h.el])):(h.shiftActive=h.last.keyset[0],h.altActive=h.last.keyset[1],void(h.metaActive=h.last.keyset[2]))},h.checkCombos=function(){if(!h.isVisible())return h.$preview.val();var a,b,c,e,f=h.$preview.val(),i=h.$preview.caret(),j=d.builtLayouts[h.layout],k=f.length;if(i.end<i.start&&(i.end=i.start),i.start>k&&(i.end=i.start=k),d.msie&&"\n"===f.substr(i.start,1)&&(i.start+=1,i.end+=1),g.useCombos&&(d.msie?f=f.replace(h.regex,function(a,b,c){return g.combos.hasOwnProperty(b)?g.combos[b][c]||a:a}):h.$preview.length&&(c=i.start-(i.start-2>=0?2:0),h.$preview.caret(c,i.end),e=(h.$preview.caret().text||"").replace(h.regex,function(a,b,c){return g.combos.hasOwnProperty(b)?g.combos[b][c]||a:a}),h.$preview.val(h.$preview.caret().replace(e)),f=h.$preview.val())),g.restrictInput&&""!==f){for(c=f,b=j.acceptedKeys.length,a=0;b>a;a++)""!==c&&(e=j.acceptedKeys[a],f.indexOf(e)>=0&&(/[\[|\]|\\|\^|\$|\.|\||\?|\*|\+|\(|\)|\{|\}]/g.test(e)&&(e="\\"+e),c=c.replace(new RegExp(e,"g"),"")));""!==c&&(f=f.replace(c,""))}return i.start+=f.length-k,i.end+=f.length-k,h.$preview.val(f),h.saveCaret(i.start,i.end),h.preview.scrollTop=h.lineHeight*(f.substring(0,i.start).split("\n").length-1),h.checkMaxLength(),g.acceptValid&&h.checkValid(),f},h.checkValid=function(){var b=d.css,c=!0;a.isFunction(g.validate)&&(c=g.validate(h,h.$preview.val(),!1)),h.$keyboard.find("."+b.keyPrefix+"accept").toggleClass(b.inputInvalid,!c).toggleClass(b.inputValid,c)},h.checkDecimal=function(){h.decimal&&/\./g.test(h.preview.value)||!h.decimal&&/\,/g.test(h.preview.value)?h.$decBtn.attr({disabled:"disabled","aria-disabled":"true"}).removeClass(g.css.buttonDefault+" "+g.css.buttonHover).addClass(g.css.buttonDisabled):h.$decBtn.removeAttr("disabled").attr({"aria-disabled":"false"}).addClass(g.css.buttonDefault).removeClass(g.css.buttonDisabled)},h.getLayers=function(b){var c=d.css,e=b.attr("data-pos"),f=b.closest("."+c.keyboard).find('button[data-pos="'+e+'"]');return f.filter(function(){return""!==a(this).find("."+c.keyText).text()}).add(b)},h.switchInput=function(b,c){if(a.isFunction(g.switchInput))g.switchInput(h,b,c);else{h.$keyboard.length&&h.$keyboard.hide();var d,e=!1,f=a("button, input, textarea, a").filter(":visible").not(":disabled"),i=f.index(h.$el)+(b?1:-1);if(h.$keyboard.length&&h.$keyboard.show(),i>f.length-1&&(e=g.stopAtEnd,i=0),0>i&&(e=g.stopAtEnd,i=f.length-1),!e){if(c=h.close(c),!c)return;d=f.eq(i).data("keyboard"),d&&d.options.openOn.length?d.focusOn():f.eq(i).focus()}}return!1},h.close=function(b){if(h.isOpen){clearTimeout(h.throttled);var c=d.css,e=d.events,f=b?h.checkCombos():h.originalContent;if(b&&a.isFunction(g.validate)&&!g.validate(h,f,!0)&&(f=h.originalContent,b=!1,g.cancelClose))return;h.isCurrent(!1),h.isOpen=!1,h.$preview.val(f),h.$el.removeClass(c.isCurrent+" "+c.inputAutoAccepted).addClass(b?b===!0?"":c.inputAutoAccepted:"").trigger(g.alwaysOpen?"":e.kbBeforeClose,[h,h.el,b||!1]).val(f).scrollTop(h.el.scrollHeight).trigger(b?e.inputAccepted:e.inputCanceled,[h,h.el]).trigger(g.alwaysOpen?e.kbInactive:e.kbHidden,[h,h.el]).blur(),g.openOn&&(h.timer=setTimeout(function(){h.$el.bind(g.openOn+h.namespace,function(){h.focusOn()}),a(":focus")[0]===h.el&&h.$el.blur()},500)),!g.alwaysOpen&&h.$keyboard&&(h.$keyboard.remove(),h.$keyboard=[]),h.watermark||""!==h.el.value||""===h.inPlaceholder||h.$el.addClass(c.placeholder).val(h.inPlaceholder),h.$el.trigger(e.inputChange)}return!!b},h.accept=function(){return h.close(!0)},h.escClose=function(a){return a&&"keyup"===a.type?27===a.which?h.close(g.autoAccept&&g.autoAcceptOnEsc?"true":!1):"":void(h.isOpen&&(!h.isCurrent()&&h.isOpen||h.isOpen&&a.target!==h.el&&!g.stayOpen)&&(d.allie&&a.preventDefault(),h.close(g.autoAccept?"true":!1)))},h.keyBtn=a("<button />").attr({role:"button",type:"button","aria-disabled":"false",tabindex:"-1"}).addClass(d.css.keyButton),h.addKey=function(b,c,e){var f,i,j,k,l,m=d.css,n=c.split(":"),o=n.length-1,p=e===!0?b:g.display[n[0]]||b,q=e===!0?b.charCodeAt(0):b;return/\(.+\)/.test(p)&&(k=p.replace(/\(([^()]+)\)/,""),j=p.match(/\(([^()]+)\)/)[1],p=k,l=k.split(":"),k=""!==l[0]&&l.length>1?l[0]:k,d.builtLayouts[h.layout].mappedKeys[j]=k),l=p.split(":"),""===l[0]&&""===l[1]&&(p=":"),p=""!==l[0]&&l.length>1?l[0]:p,p=a.trim(e?p:n[1]||p),f=l.length>1?a.trim(l[1]).replace(/_/g," ")||"":o>0?n[o]||"":"",i=p.length>2?" "+m.keyWide:"",i+=e?"":" "+m.keyAction,h.keyBtn.clone().attr({"data-value":p,name:q,"data-pos":h.temp[1]+","+h.temp[2],title:f,"data-action":b,"data-original":p,"data-curtxt":p,"data-curnum":0}).addClass((""===q?"":m.keyPrefix+q+i+" ")+g.css.buttonDefault).html('<span class="'+m.keyText+'">'+p+"</span>").appendTo(h.temp[0])},h.customHash=function(){var a,b,c,d,e,f=g.customLayout,h=[],i=[];for(b in f)f.hasOwnProperty(b)&&h.push(f[b]);if(i=i.concat.apply(i,h).join(" "),c=0,e=i.length,0===e)return c;for(a=0;e>a;a++)d=i.charCodeAt(a),c=(c<<5)-c+d,c&=c;return c},h.buildKeyboard=function(b,c){a.isEmptyObject(g.display)&&h.updateLanguage();var e,f,i,j,k,l,m,n,o,p=d.css,q=0,r=d.builtLayouts[b||h.layout]={mappedKeys:{},acceptedKeys:[]},s=r.acceptedKeys=[],t=a("<div />").addClass(p.keyboard+" "+g.css.container+(g.alwaysOpen?" "+p.alwaysOpen:"")).attr({role:"textbox"}).hide();return(c&&"custom"===g.layout||!d.layouts.hasOwnProperty(g.layout))&&(g.layout="custom",d.layouts.custom=g.customLayout||{normal:["{cancel}"]}),a.each(d.layouts[c?g.layout:b],function(b,c){var r;if(""!==b&&!/^(name|lang|rtl)$/i.test(b))for("default"===b&&(b="normal"),q++,j=a("<div />").attr("name",b).addClass(p.keySet+" "+p.keySet+"-"+b).appendTo(t).toggle("normal"===b),i=0;i<c.length;i++){for(l=a.trim(c[i]).replace(/\{(\.?)[\s+]?:[\s+]?(\.?)\}/g,"{$1:$2}"),n=l.split(/\s+/),m=0;m<n.length;m++)if(h.temp=[j,i,m],k=!1,0!==n[m].length)if(/^\{\S+\}$/.test(n[m])){if(f=n[m].match(/^\{(\S+)\}$/)[1],/\!\!/.test(f)&&(f=f.replace("!!",""),k=!0),/^sp:((\d+)?([\.|,]\d+)?)(em|px)?$/i.test(f)&&(o=parseFloat(f.replace(/,/,".").match(/^sp:((\d+)?([\.|,]\d+)?)(em|px)?$/i)[1]||0),a('<span class="'+p.keyText+'">&nbsp;</span>').width(f.match(/px/i)?o+"px":2*o+"em").addClass(p.keySpacer).appendTo(j)),/^empty(:((\d+)?([\.|,]\d+)?)(em|px)?)?$/i.test(f)&&(o=/:/.test(f)?parseFloat(f.replace(/,/,".").match(/^empty:((\d+)?([\.|,]\d+)?)(em|px)?$/i)[1]||0):"",h.addKey(""," ").addClass(g.css.buttonDisabled+" "+g.css.buttonEmpty).attr("aria-disabled",!0).width(o?f.match("px")?o+"px":2*o+"em":"")),/^meta\d+\:?(\w+)?/i.test(f)){h.addKey(f.split(":")[0],f).addClass(p.keyHasActive);continue}switch(r=f.split(":"),r[0].toLowerCase()){case"a":case"accept":h.addKey("accept",f).addClass(g.css.buttonAction+" "+p.keyAction);break;case"alt":case"altgr":h.addKey("alt",f).addClass(p.keyHasActive);break;case"b":case"bksp":h.addKey("bksp",f);break;case"c":case"cancel":h.addKey("cancel",f).addClass(g.css.buttonAction+" "+p.keyAction);break;case"combo":h.addKey("combo",f).addClass(p.keyHasActive).toggleClass(g.css.buttonActive,g.useCombos);break;case"dec":s.push(h.decimal?".":","),h.addKey("dec",f);break;case"e":case"enter":h.addKey("enter",f).addClass(g.css.buttonAction+" "+p.keyAction);break;case"lock":h.addKey("lock",f).addClass(p.keyHasActive);break;case"s":case"shift":h.addKey("shift",f).addClass(p.keyHasActive);break;case"sign":s.push("-"),h.addKey("sign",f);break;case"space":s.push(" "),h.addKey("space",f);break;case"t":case"tab":h.addKey("tab",f);break;default:d.keyaction.hasOwnProperty(r[0])&&h.addKey(r[0],f).toggleClass(g.css.buttonAction+" "+p.keyAction,k)}}else e=n[m],s.push(":"===e?e:e.split(":")[0]),h.addKey(e,e,!0);j.find("."+p.keyButton+":last").after('<br class="'+p.endRow+'">')}}),q>1&&(h.sets=!0),r.hasMappedKeys=!a.isEmptyObject(r.mappedKeys),r.$keyboard=t,t},h.destroy=function(){a(c).unbind(h.namespace),a(b).unbind(h.namespace),h.$keyboard.length&&h.$keyboard.remove();var e=d.css;h.$el.removeClass([e.input,e.locked,e.placeholder,e.noKeyboard,e.alwaysOpen,g.css.input].join(" ")).removeAttr("aria-haspopup").removeAttr("role").unbind(h.namespace).removeData("keyboard")},h.init()};d.css={input:"ui-keyboard-input",wrapper:"ui-keyboard-preview-wrapper",preview:"ui-keyboard-preview",keyboard:"ui-keyboard",keySet:"ui-keyboard-keyset",keyButton:"ui-keyboard-button",keyWide:"ui-keyboard-widekey",keyPrefix:"ui-keyboard-",keyText:"ui-keyboard-text",keyHasActive:"ui-keyboard-hasactivestate",keyAction:"ui-keyboard-actionkey",keySpacer:"ui-keyboard-spacer",keyToggle:"ui-keyboard-toggle",keyDisabled:"ui-keyboard-disabled",locked:"ui-keyboard-lockedinput",alwaysOpen:"ui-keyboard-always-open",noKeyboard:"ui-keyboard-nokeyboard",placeholder:"ui-keyboard-placeholder",hasFocus:"ui-keyboard-has-focus",isCurrent:"ui-keyboard-input-current",inputValid:"ui-keyboard-valid-input",inputInvalid:"ui-keyboard-invalid-input",inputAutoAccepted:"ui-keyboard-autoaccepted",endRow:"ui-keyboard-button-endrow"},d.events={kbChange:"keyboardChange",kbBeforeClose:"beforeClose",kbBeforeVisible:"beforeVisible",kbVisible:"visible",kbInit:"initialized",kbInactive:"inactive",kbHidden:"hidden",kbRepeater:"repeater",kbKeysetChange:"keysetChange",inputAccepted:"accepted",inputCanceled:"canceled",inputChange:"change",inputRestricted:"restricted"},d.keyaction={accept:function(a){return a.close(!0),!1},alt:function(a,b){a.altActive=!a.altActive,a.showKeySet(b)},bksp:function(a){a.insertText("bksp")},cancel:function(a){return a.close(),!1},clear:function(a){a.$preview.val("")},combo:function(a){var b=!a.options.useCombos;return a.options.useCombos=b,a.$keyboard.find("."+d.css.keyPrefix+"combo").toggleClass(a.options.css.buttonActive,b),b&&a.checkCombos(),!1},dec:function(a){a.insertText(a.decimal?".":",")},"default":function(a,b){a.shiftActive=a.altActive=a.metaActive=!1,a.showKeySet(b)},enter:function(b,c,d){var e=b.el.tagName,f=b.options;return d.shiftKey?f.enterNavigation?b.switchInput(!d[f.enterMod],!0):b.close(!0):f.enterNavigation&&("TEXTAREA"!==e||d[f.enterMod])?b.switchInput(!d[f.enterMod],f.autoAccept?"true":!1):void("TEXTAREA"===e&&a(d.target).closest("button").length&&b.insertText(" \n"))},lock:function(a,b){a.last.keyset[0]=a.shiftActive=a.capsLock=!a.capsLock,a.showKeySet(b)},left:function(a){var b=a.$preview.caret();b.start-1>=0&&(a.last.start=a.last.end=b.start-1)},meta:function(b,c){b.metaActive=!a(c).hasClass(b.options.css.buttonActive),b.showKeySet(c)},next:function(a){return a.switchInput(!0,a.options.autoAccept),!1},prev:function(a){return a.switchInput(!1,a.options.autoAccept),!1},right:function(a){var b=a.$preview.caret();b.start+1<=a.$preview.val().length&&(a.last.start=a.last.end=b.start+1)},shift:function(a,b){a.last.keyset[0]=a.shiftActive=!a.shiftActive,a.showKeySet(b)},sign:function(a){/^\-?\d*\.?\d*$/.test(a.$preview.val())&&a.$preview.val(-1*a.$preview.val())},space:function(a){a.insertText(" ")},tab:function(a){var b=a.el.tagName,c=a.options;return"INPUT"===b?c.tabNavigation?a.switchInput(!a.shiftActive,!0):!1:void a.insertText("	")},toggle:function(a){a.enabled=!a.enabled,a.toggle()}},d.builtLayouts={},d.layouts={alpha:{normal:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} a b c d e f g h i j [ ] \\","k l m n o p q r s ; ' {enter}","{shift} t u v w x y z , . / {shift}","{accept} {space} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} A B C D E F G H I J { } |",'K L M N O P Q R S : " {enter}',"{shift} T U V W X Y Z < > ? {shift}","{accept} {space} {cancel}"]},qwerty:{normal:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}","{accept} {space} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}","{accept} {space} {cancel}"]},international:{normal:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}","{accept} {alt} {space} {alt} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}","{accept} {alt} {space} {alt} {cancel}"],alt:["~ ¡ ² ³ ¤ € ¼ ½ ¾ ‘ ’ ¥ × {bksp}","{tab} ä å é ® þ ü ú í ó ö « » ¬","á ß ð f g h j k ø ¶ ´ {enter}","{shift} æ x © v b ñ µ ç > ¿ {shift}","{accept} {alt} {space} {alt} {cancel}"],"alt-shift":["~ ¹ ² ³ £ € ¼ ½ ¾ ‘ ’ ¥ ÷ {bksp}","{tab} Ä Å É ® Þ Ü Ú Í Ó Ö « » ¦","Ä § Ð F G H J K Ø ° ¨ {enter}","{shift} Æ X ¢ V B Ñ µ Ç . ¿ {shift}","{accept} {alt} {space} {alt} {cancel}"]},colemak:{normal:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w f p g j l u y ; [ ] \\","{bksp} a r s t d h n e i o ' {enter}","{shift} z x c v b k m , . / {shift}","{accept} {space} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W F P G J L U Y : { } |",'{bksp} A R S T D H N E I O " {enter}',"{shift} Z X C V B K M < > ? {shift}","{accept} {space} {cancel}"]},dvorak:{normal:["` 1 2 3 4 5 6 7 8 9 0 [ ] {bksp}","{tab} ' , . p y f g c r l / = \\","a o e u i d h t n s - {enter}","{shift} ; q j k x b m w v z {shift}","{accept} {space} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) { } {bksp}",'{tab} " < > P Y F G C R L ? + |',"A O E U I D H T N S _ {enter}","{shift} : Q J K X B M W V Z {shift}","{accept} {space} {cancel}"]},num:{normal:["= ( ) {b}","{clear} / * -","7 8 9 +","4 5 6 {sign}","1 2 3 %","0 {dec} {a} {c}"]}},d.language=a.extend({},d.language,{en:{display:{a:"✔:Accept (Shift-Enter)",accept:"Accept:Accept (Shift-Enter)",alt:"Alt:⌥ AltGr",b:"⌫:Backspace",bksp:"Bksp:Backspace",c:"✖:Cancel (Esc)",cancel:"Cancel:Cancel (Esc)",clear:"C:Clear",combo:"ö:Toggle Combo Keys",dec:".:Decimal",e:"⏎:Enter",empty:" ",enter:"Enter:Enter ⏎",left:"←",lock:"Lock:⇪ Caps Lock",next:"Next ⇨",prev:"⇦ Prev",right:"→",s:"⇧:Shift",shift:"Shift:Shift",sign:"±:Change Sign",space:"&nbsp;:Space",t:"⇥:Tab",tab:"⇥ Tab:Tab",toggle:" "},wheelMessage:"Use mousewheel to see other keys",comboRegex:/([`\'~\^\"ao])([a-z])/gim,combos:{"`":{a:"à",A:"À",e:"è",E:"È",i:"ì",I:"Ì",o:"ò",O:"Ò",u:"ù",U:"Ù",y:"ỳ",Y:"Ỳ"},"'":{a:"á",A:"Á",e:"é",E:"É",i:"í",I:"Í",o:"ó",O:"Ó",u:"ú",U:"Ú",y:"ý",Y:"Ý"},'"':{a:"ä",A:"Ä",e:"ë",E:"Ë",i:"ï",I:"Ï",o:"ö",O:"Ö",u:"ü",U:"Ü",y:"ÿ",Y:"Ÿ"},"^":{a:"â",A:"Â",e:"ê",E:"Ê",i:"î",I:"Î",o:"ô",O:"Ô",u:"û",U:"Û",y:"ŷ",Y:"Ŷ"},"~":{a:"ã",A:"Ã",e:"ẽ",E:"Ẽ",i:"ĩ",I:"Ĩ",o:"õ",O:"Õ",u:"ũ",U:"Ũ",y:"ỹ",Y:"Ỹ",n:"ñ",N:"Ñ"}}}}),d.defaultOptions={language:null,rtl:!1,layout:"qwerty",customLayout:null,position:{of:null,my:"center top",at:"center top",at2:"center bottom"},reposition:!0,usePreview:!0,alwaysOpen:!1,initialFocus:!0,stayOpen:!1,css:{input:"ui-widget-content ui-corner-all",container:"ui-widget-content ui-widget ui-corner-all ui-helper-clearfix",buttonDefault:"ui-state-default ui-corner-all",buttonHover:"ui-state-hover",buttonAction:"ui-state-active",buttonActive:"ui-state-active",buttonDisabled:"ui-state-disabled",buttonEmpty:"ui-keyboard-empty"},autoAccept:!1,autoAcceptOnEsc:!1,lockInput:!1,restrictInput:!1,acceptValid:!1,cancelClose:!0,tabNavigation:!1,enterNavigation:!1,enterMod:"altKey",stopAtEnd:!0,appendLocally:!1,appendTo:"body",stickyShift:!0,preventPaste:!1,caretToEnd:!1,maxLength:!1,maxInsert:!0,repeatDelay:500,repeatRate:20,resetDefault:!1,openOn:"focus",keyBinding:"mousedown touchstart",useCombos:!0,validate:function(){return!0}},d.comboRegex=/([`\'~\^\"ao])([a-z])/gim,d.currentKeyboard="",a('<!--[if lte IE 8]><script>jQuery("body").addClass("oldie");</script><![endif]--><!--[if IE]><script>jQuery("body").addClass("ie");</script><![endif]-->').appendTo("body").remove(),d.msie=a("body").hasClass("oldie"),d.allie=a("body").hasClass("ie"),d.watermark="undefined"!=typeof c.createElement("input").placeholder,a.fn.keyboard=function(b){return this.each(function(){a(this).data("keyboard")||new a.keyboard(this,b)})},a.fn.getkeyboard=function(){return this.data("keyboard")}}(jQuery,window,document),function(a,b,c,d){"use strict";a.fn.caret=function(a,e){if("undefined"==typeof this[0]||this.is(":hidden")||"hidden"===this.css("visibility"))return this;var f,g,h,i,j,k,l,m,n,o=document.selection,p=this[0],q=p.scrollTop,r=!1,s=!0;try{r="selectionStart"in p}catch(t){s=!1}return"object"==typeof a&&"start"in a&&"end"in a?(g=a.start,i=a.end):"number"==typeof a&&"number"==typeof e&&(g=a,i=e),s&&"undefined"!=typeof g?(/(email|number)/i.test(p.type)||(r?(p.selectionStart=g,p.selectionEnd=i):(j=p.createTextRange(),j.collapse(!0),j.moveStart("character",g),j.moveEnd("character",i-g),j.select())),(this.is(":visible")||"hidden"!==this.css("visibility"))&&this.focus(),p.scrollTop=q,this):(/(email|number)/i.test(p.type)?f=h=this.val().length:r?(f=p.selectionStart,h=p.selectionEnd):o?"TEXTAREA"===p.tagName?(n=this.val(),k=o[c](),l=k[d](),l.moveToElementText(p),l.setEndPoint("EndToEnd",k),f=l.text.replace(/\r/g,"\n")[b],h=f+k.text.replace(/\r/g,"\n")[b]):(n=this.val().replace(/\r/g,"\n"),k=o[c]()[d](),k.moveEnd("character",n[b]),f=""===k.text?n[b]:n.lastIndexOf(k.text),k=o[c]()[d](),k.moveStart("character",-n[b]),h=k.text[b]):(f=0,h=(p.value||"").length),m=(p.value||"").substring(f,h),{start:f,end:h,text:m,replace:function(a){return p.value.substring(0,f)+a+p.value.substring(h,p.value[b])}})};var e=a('<div style="height:0px;width:0px;overflow:hidden;"><input type="text" value="testing"></div>').prependTo("body");e.find("input").caret(3,3),a.keyboard.checkCaret=3!==e.find("input").hide().show().caret().start,e.remove()}(jQuery,"length","createRange","duplicate");