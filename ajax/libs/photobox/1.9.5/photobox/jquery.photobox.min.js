!function(e,t,o){"use strict";function i(){Z&&re.hide(),q.off().on("click",P.toggle),W.off().on("click","a",E.click),G&&re.addClass("msie"),J&&re.addClass("mobile"),re.off().on("click","img",function(e){e.stopPropagation()}),e(t.body).append(re),z=t.documentElement}function n(e,t,o){1==t?(F.css({transform:"translateX(25%)",transition:".2s",opacity:0}),setTimeout(function(){H(D)},200)):-1==t&&(F.css({transform:"translateX(-25%)",transition:".2s",opacity:0}),setTimeout(function(){H(O)},200)),1==o?N.prop("checked",!0):-1==o&&N.prop("checked",!1)}function s(e){var o,i=t.createElement("p").style,n=["ms","O","Moz","Webkit"];if(""==i[e])return e;for(e=e.charAt(0).toUpperCase()+e.slice(1),o=n.length;o--;)if(""==i[n[o]+e])return n[o]+e}function a(e){var t=e.keyCode,o=A.keys;return o.close.indexOf(t)>=0&&y()||o.next.indexOf(t)>=0&&!A.single&&h(O)||o.prev.indexOf(t)>=0&&!A.single&&h(D)||!0}function r(e,t,o){1==o?h(O):-1==o&&h(D)}function l(){var e="pbPrevBtn"==this.id?D:O;return h(e),!1}function u(e){L=Q,Q=e,k=U[e][0],D=(Q||(A.loop?U.length:0))-1,O=(Q+1)%U.length||(A.loop?0:-1)}function h(e){if(!A.loop){var t=Q==U.length-1&&e==O,o=0==Q&&e==D;if(t||o)return}H(e)}function c(){var t=U[Q][0],o=e("<a>").prop("href",U[Q][0])[0].search?"&":"?";return t+=o+"vq=hd720&wmode=opaque",e("<iframe>").prop({scrolling:"no",frameborder:0,allowTransparency:!0,src:t}).attr({webkitAllowFullScreen:!0,mozallowfullscreen:!0,allowFullScreen:!0})}function d(){if(Y.off(K).removeClass("change"),A.counter){try{var e=A.counter.replace("A",Q+1).replace("B",U.length)}catch(t){A.counter="(A/B)",d()}R.find(".counter").text(e)}A.title&&R.find(".title").html("<span>"+U[Q][1]+"</span>")}function f(){re.addClass("error"),F[0].src=$,ie.onerror=null}function p(e){function t(){clearTimeout(i),o.off(K).css({transition:"none"}),re.removeClass("video"),"video"==M?(F[0].src=$,X.addClass("prepare"),re.addClass("video")):F.prop({src:k,"class":"prepare"}),setTimeout(function(){F.add(X).removeAttr("style").removeClass("prepare"),re.removeClass("hide next prev"),setTimeout(function(){F.add(X).on(K,m),G&&m()},0)},50)}var o,i;i=setTimeout(t,2e3),j.fadeOut(300,function(){re.removeClass("pbLoading"),j.removeAttr("style")}),re.addClass("hide"),F.add(X).removeAttr("style").removeClass("zoomable"),console.log(e,L,T[L]),e||"video"!=T[L].rel?o=F:(o=X,F.addClass("prepare")),e||G?t():o.on(K,t)}function m(){F.add(X).off(K).addClass("zoomable"),"video"==M?X.removeClass("hide"):q&&A.autoplay&&P.play(),"function"==typeof x.callback&&x.callback.apply(T[Q])}function v(o,i,n){if(n)return!1;if("video"==M){var s=X.data("zoom")||1;if(s+=i/10,.5>s)return!1;X.data("zoom",s).css({width:624*s,height:351*s})}else{var s=F.data("zoom")||1,a=F[0].getBoundingClientRect();s+=i/10,.1>s&&(s=.1),oe(function(){F.data("zoom",s).css({transform:"scale("+s+")"})}),a.height>z.clientHeight||a.width>z.clientWidth?e(t).on("mousemove.photobox",b):(e(t).off("mousemove.photobox"),F[0].style[ee]="50% 50%")}return!1}function g(e,t){e.preventDefault(),e.stopPropagation();var o,i=x.thumbsList;i.css("height",i[0].clientHeight+10*t),o=R[0].clientHeight/2,_[0].style.cssText="margin-top: -"+o+"px; padding: "+o+"px 0;",W.hide().show(0)}function b(e){var t=e.clientY/z.clientHeight*(z.clientHeight+200)-100,o=t/z.clientHeight*100,i=e.clientX/z.clientWidth*100,n=i.toFixed(2)+"% "+o.toFixed(2)+"%";oe(function(){F[0].style[ee]=n})}function w(){clearTimeout(P.autoPlayTimer),e(t).off("mousemove.photobox"),ie.onload=function(){},ie.src=ne.src=se.src=k}function y(){function t(){""!=re[0].className&&(re.removeClass("show hide error pbLoading"),F.removeAttr("class").removeAttr("style").off().data("zoom",1),R.find(".title").empty(),Z&&setTimeout(function(){re.hide()},200),A.hideFlash&&e("iframe, object, embed").css("visibility","visible"))}return re.hasClass("show")?(w(),X.find("iframe").prop("src","").empty(),C.prototype.setup(),le.clear(),re.removeClass("on video").addClass("hide"),F.on(K,t),G&&t(),setTimeout(function(){x=null},1e3),setTimeout(t,500),void("function"==typeof A.afterClose&&A.afterClose(re))):!1}var C,x,A,T,k,L,M,D,O,E,z,P,H,S,F,X,B,I,N,R,Y,j,q,W,_,U=[],Q=-1,K="transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",G=!("placeholder"in t.createElement("input")),Z=function(){var t=e("<p>")[0];return t.style.cssText="pointer-events:auto",!t.style.pointerEvents}(),J="ontouchend"in t,V=e(),$="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",ee=s("transformOrigin"),te=s("transition"),oe=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)},ie={},ne=new Image,se=new Image,ae={single:!1,beforeShow:null,afterClose:null,loop:!0,thumb:null,thumbs:!0,counter:"(A/B)",title:!0,autoplay:!1,time:3e3,history:!0,hideFlash:!0,zoomable:!0,wheelNextPrev:!0,keys:{close:"27, 88, 67",prev:"37, 80",next:"39, 78"}},re=e('<div id="pbOverlay">').append(N=e('<input type="checkbox" id="pbThumbsToggler" checked hidden>'),j=e('<div class="pbLoader"><b></b><b></b><b></b></div>'),B=e('<div id="pbPrevBtn" class="prevNext"><b></b></div>').on("click",l),I=e('<div id="pbNextBtn" class="prevNext"><b></b></div>').on("click",l),_=e('<div class="pbWrapper">').append(F=e("<img>"),X=e("<div>")),S=e('<div id="pbCloseBtn">').on("click",y)[0],q=e('<div id="pbAutoplayBtn">').append(e('<div class="pbProgress">')),R=e('<div id="pbCaption">').append('<label for="pbThumbsToggler" title="thumbnails on/off"></label>',Y=e('<div class="pbCaptionText">').append('<div class="title"></div><div class="counter">'),W=e("<div>").addClass("pbThumbs")));e.fn.photobox=function(t,o,n){return this.each(function(){var s,a=e(this).data("_photobox");return a?("destroy"===t&&a.destroy(),this):("string"!=typeof t&&(t="a"),"prepareDOM"===t?(i(),this):(s=e.extend({},ae,o||{}),x=new C(s,this,t),e(this).data("_photobox",x),void(x.callback=n)))})},C=function(o,i,n){this.options=e.extend({},o),this.target=n,this.selector=e(i||t),this.thumbsList=null;var s=this.imageLinksFilter(this.selector.find(n));this.imageLinks=s[0],this.images=s[1],this.init()},C.prototype={init:function(){var e=this;this.selector.one("mouseenter.photobox",this.target,function(t){e.thumbsList=E.generate.apply(e)}),this.selector.on("click.photobox",this.target,function(t){t.preventDefault(),e.open(this)}),this.observerTimeout=null,1==this.selector[0].nodeType&&e.observeDOM(e.selector[0],function(){clearTimeout(e.observerTimeout),e.observerTimeout=setTimeout(function(){var t,o=e.imageLinksFilter(e.selector.find(e.target)),i=0,n=!1;if(e.imageLinks.length!=o[0].length){if(e.imageLinks=o[0],e.images=o[1],x&&e.selector==x.selector){for(U=e.images,T=e.imageLinks,t=U.length;t--;)U[t][0]==k&&(n=!0);n&&re.removeClass("hasArrows")}e.thumbsList=E.generate.apply(e),W.html(e.thumbsList),e.images.length&&k&&e.options.thumbs&&(i=e.thumbsList.find('a[href="'+k+'"]').eq(0).parent().index(),-1==i&&(i=0),u(i),E.changeActive(i,0))}},50)})},open:function(t){var o=e.inArray(t,this.imageLinks);return-1==o?!1:(A=this.options,U=this.images,T=this.imageLinks,x=this,this.setup(1),re.on(K,function(){re.off(K).addClass("on"),H(o,!0)}).addClass("show"),G&&re.trigger("MSTransitionEnd"),!1)},imageLinksFilter:function(t){var o,i=this,n=[],s={};return[t.filter(function(t){var a,r=e(this),l="";return s.content=r[0].getAttribute("title")||"",i.options.thumb&&(a=r.find(i.options.thumb)[0]),i.options.thumb&&a||(a=r.find("img")[0]),a&&(o=a.getAttribute("data-pb-captionlink"),l=a.getAttribute("src"),s.content=a.getAttribute("alt")||a.getAttribute("title")||""),o&&(o=o.split("["),2==o.length?(s.linkText=o[0],s.linkHref=o[1].slice(0,-1)):(s.linkText=o,s.linkHref=o),s.content+=' <a href="'+s.linkHref+'">'+s.linkText+"</a>"),n.push([r[0].href,s.content,l]),!0}),n]},observeDOM:function(){var e=o.MutationObserver||o.WebKitMutationObserver,t=o.addEventListener;return function(o,i){if(e){var n=new e(function(e,t){(e[0].addedNodes.length||e[0].removedNodes.length)&&i()});n.observe(o,{childList:!0,subtree:!0})}else t&&(o.addEventListener("DOMNodeInserted",i,!1),o.addEventListener("DOMNodeRemoved",i,!1))}}(),setup:function(i){var s=i?"on":"off";F[0].src=$,A.thumbs&&(J||W[s]("mouseenter.photobox",E.calc)[s]("mousemove.photobox",E.move)),i?(F.css({transition:"0s"}).removeAttr("style"),re.show(),W.html(this.thumbsList).trigger("mouseenter.photobox"),A.thumbs?re.addClass("thumbs"):(N.prop("checked",!1),re.removeClass("thumbs")),this.images.length<2||A.single?re.removeClass("thumbs hasArrows hasCounter hasAutoplay"):(re.addClass("hasArrows hasCounter"),A.time>1e3?(re.addClass("hasAutoplay"),A.autoplay?P.progress.start():P.pause()):re.removeClass("hasAutoplay")),A.hideFlash&&e("iframe, object, embed").css("visibility","hidden")):e(o).off("resize.photobox"),e(t).off("keydown.photobox")[s]({"keydown.photobox":a}),J&&(re.removeClass("hasArrows"),_[s]("swipe",n)),A.zoomable&&(re[s]({"mousewheel.photobox":v}),G||W[s]({"mousewheel.photobox":g})),!A.single&&A.wheelNextPrev&&re[s]({"mousewheel.photobox":r})},destroy:function(){A=this.options,this.selector.off("click.photobox",this.target).removeData("_photobox"),y()}},E=function(){var t,o,i,n,s=0,a=0,r=0,l=0,u=null;return{generate:function(){var t,o,i,n,s,a=e("<ul>"),r=[],l=this.imageLinks.size();for(s=0;l>s;s++)i=this.imageLinks[s],o=this.images[s][2],o&&(t=this.images[s][1],n=i.rel?" class='"+i.rel+"'":"",r.push("<li"+n+'><a href="'+i.href+'"><img src="'+o+'" alt="" title="'+t+'" /></a></li>'));return a.html(r.join("")),a},click:function(t){t.preventDefault(),V.removeClass("active"),V=e(this).parent().addClass("active");var o=e(this.parentNode).index();return H(o,0,1)},changeActiveTimeout:null,changeActive:function(e,t,o){V.index();V.removeClass("active"),V=W.find("li").eq(e).addClass("active"),!o&&V[0]&&(clearTimeout(this.changeActiveTimeout),this.changeActiveTimeout=setTimeout(function(){var e=V[0].offsetLeft+V[0].clientWidth/2-z.clientWidth/2;t?W.delay(800):W.stop(),W.animate({scrollLeft:e},500,"swing")},200))},calc:function(e){return o=W[0],s=o.clientWidth,a=o.scrollWidth,t=.15*s,r=W.offset().left,l=e.pageX-t-r,n=l/(s-2*t),i=(a-s)*n,W.animate({scrollLeft:i},200),clearTimeout(u),u=setTimeout(function(){u=null},200),this},move:function(e){if(!u){var i,n,l=e.pageX-t-r;0>l&&(l=0),i=l/(s-2*t),n=(a-s)*i,oe(function(){o.scrollLeft=n})}}}}(),P={autoPlayTimer:!1,play:function(){P.autoPlayTimer=setTimeout(function(){H(O)},A.time),P.progress.start(),q.removeClass("play"),P.setTitle("Click to stop autoplay"),A.autoplay=!0},pause:function(){clearTimeout(P.autoPlayTimer),P.progress.reset(),q.addClass("play"),P.setTitle("Click to resume autoplay"),A.autoplay=!1},progress:{reset:function(){q.find("div").removeAttr("style"),setTimeout(function(){q.removeClass("playing")},200)},start:function(){G||q.find("div").css(te,A.time+"ms"),q.addClass("playing")}},setTitle:function(e){e&&q.prop("title",e+" (every "+A.time/1e3+" seconds)")},toggle:function(e){e.stopPropagation(),P[A.autoplay?"pause":"play"]()}},H=function(){var e;return function(t,o,i){if(!e){if(e=setTimeout(function(){e=null},150),(!t||0>t)&&(t=0),A.loop||(I[t==U.length-1?"addClass":"removeClass"]("hide"),B[0==t?"addClass":"removeClass"]("hide")),"function"==typeof A.beforeShow&&A.beforeShow(T[t]),re.removeClass("error").addClass(t>Q?"next":"prev"),u(t),w(),X.empty(),ie.onerror=null,F.add(X).data("zoom",1),M="video"==T[t].rel?"video":"image","video"==M)X.html(c()).addClass("hide"),p(o);else{var n=setTimeout(function(){re.addClass("pbLoading")},50);G&&re.addClass("hide"),A.autoplay&&P.progress.reset(),ie=new Image,ie.onload=function(){ie.onload=null,D>=0&&(ne.src=U[D][0]),O>=0&&(se.src=U[O][0]),clearTimeout(n),p(o)},ie.onerror=f,ie.src=k}Y.on(K,d).addClass("change"),(o||G)&&d(),A.thumbs&&E.changeActive(t,o,i),le.save()}}}();var le={save:function(){"pushState"in window.history&&decodeURIComponent(window.location.hash.slice(1))!=k&&A.history&&window.history.pushState("photobox",t.title+"-"+U[Q][1],window.location.pathname+window.location.search+"#"+encodeURIComponent(k))},load:function(){if(A&&!A.history)return!1;var e=decodeURIComponent(window.location.hash.slice(1));!e&&re.hasClass("show")&&y()},clear:function(){A.history&&"pushState"in window.history&&window.history.pushState("photobox",t.title,window.location.pathname+window.location.search)}};window.onpopstate=function(){var e=window.onpopstate;return function(t){e&&e.apply(this,arguments),"photobox"==t.state&&le.load()}}(),e.event.special.swipe={setup:function(){e(this).bind("touchstart",e.event.special.swipe.handler)},teardown:function(){e(this).unbind("touchstart",e.event.special.swipe.handler)},handler:function(t){function o(){h.removeEventListener("touchmove",i),n=s=null}function i(i){i.preventDefault();var r=n-i.touches[0].pageX,c=s-i.touches[0].pageY;return Math.abs(r)>=20?(o(),l=r>0?-1:1):Math.abs(c)>=20&&(o(),u=c>0?1:-1),t.type="swipe",a.unshift(t,l,u),(e.event.dispatch||e.event.handle).apply(h,a)}var n,s,a=[].slice.call(arguments,1),r=t.originalEvent.touches,l=0,u=0,h=this;t=e.event.fix(t),1==r.length&&(n=r[0].pageX,s=r[0].pageY,this.addEventListener("touchmove",i,!1))}},!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(e){function t(t){var a=t||window.event,r=l.call(arguments,1),u=0,c=0,d=0,f=0,p=0,m=0;if(t=e.event.fix(a),t.type="mousewheel","detail"in a&&(d=-1*a.detail),"wheelDelta"in a&&(d=a.wheelDelta),"wheelDeltaY"in a&&(d=a.wheelDeltaY),"wheelDeltaX"in a&&(c=-1*a.wheelDeltaX),"axis"in a&&a.axis===a.HORIZONTAL_AXIS&&(c=-1*d,d=0),u=0===d?c:d,"deltaY"in a&&(d=-1*a.deltaY,u=d),"deltaX"in a&&(c=a.deltaX,0===d&&(u=-1*c)),0!==d||0!==c){if(1===a.deltaMode){var v=e.data(this,"mousewheel-line-height");u*=v,d*=v,c*=v}else if(2===a.deltaMode){var g=e.data(this,"mousewheel-page-height");u*=g,d*=g,c*=g}if(f=Math.max(Math.abs(d),Math.abs(c)),(!s||s>f)&&(s=f,i(a,f)&&(s/=40)),i(a,f)&&(u/=40,c/=40,d/=40),u=Math[u>=1?"floor":"ceil"](u/s),c=Math[c>=1?"floor":"ceil"](c/s),d=Math[d>=1?"floor":"ceil"](d/s),h.settings.normalizeOffset&&this.getBoundingClientRect){var b=this.getBoundingClientRect();p=t.clientX-b.left,m=t.clientY-b.top}return t.deltaX=c,t.deltaY=d,t.deltaFactor=s,t.offsetX=p,t.offsetY=m,t.deltaMode=0,r.unshift(t,u,c,d),n&&clearTimeout(n),n=setTimeout(o,200),(e.event.dispatch||e.event.handle).apply(this,r)}}function o(){s=null}function i(e,t){return h.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120===0}var n,s,a=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],r="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(e.event.fixHooks)for(var u=a.length;u;)e.event.fixHooks[a[--u]]=e.event.mouseHooks;var h=e.event.special.mousewheel={version:"3.1.11",setup:function(){if(this.addEventListener)for(var o=r.length;o;)this.addEventListener(r[--o],t,!1);else this.onmousewheel=t;e.data(this,"mousewheel-line-height",h.getLineHeight(this)),e.data(this,"mousewheel-page-height",h.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var o=r.length;o;)this.removeEventListener(r[--o],t,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var o=e(t)["offsetParent"in e.fn?"offsetParent":"parent"]();return o.length||(o=e("body")),parseInt(o.css("fontSize"),10)},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),e(t).ready(i),window._photobox={close:y,history:le,defaults:ae}}(jQuery,document,window);
//# sourceMappingURL=./jquery.photobox.min.js.map