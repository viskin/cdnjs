/*!
 * jQuery Lazy - min - v0.3.1
 * http://jquery.eisbehr.de/lazy/
 * http://eisbehr.de/
 *
 * Copyright 2014, Daniel 'Eisbehr' Kern
 *
 * Dual licensed under the MIT and GPL-2.0 licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl-2.0.html
 *
 * jQuery("img.lazy").lazy();
 */
(function(e,t,n,r){e.fn.lazy=function(i){"use strict";function h(){if(s.delay>=0)setTimeout(function(){p(true)},s.delay);if(s.delay<0||s.combined){p(false);E(function(){e(s.appendScroll).bind("scroll",g(s.throttle,function(){E(function(){p(false)},this,true)}))},this);E(function(){e(s.appendScroll).bind("resize",g(s.throttle,function(){a=-1;E(function(){p(false)},this,true)}))},this)}}function p(t){if(!o.length)return;var n=false;for(var r=0;r<o.length;r++){(function(){var i=o[r];var u=e(i);if(v(i)||t){var a=o[r].tagName.toLowerCase();if(u.attr(s.attribute)&&(a=="img"&&u.attr(s.attribute)!=u.attr("src")||a!="img"&&u.attr(s.attribute)!=u.css("background-image"))&&!u.data(s.handledName)&&(u.is(":visible")||!s.visibleOnly)){n=true;u.data(s.handledName,true);E(function(){d(u,a)},this)}}})()}if(n)E(function(){o=e(o).filter(function(){return!e(this).data(s.handledName)})},this)}function d(n,r){var i=e(new Image);++u;if(s.onError)i.error(function(){b(s.onError,n);y()});else i.error(function(){y()});var o=false;i.one("load",function(){var e=function(){if(!o){t.setTimeout(e,100);return}n.hide();if(r=="img")n.attr("src",i.attr("src"));else n.css("background-image","url("+i.attr("src")+")");n[s.effect](s.effectTime);if(s.removeAttribute)n.removeAttr(s.attribute);b(s.afterLoad,n);i.unbind("load").remove();y()};e()});b(s.beforeLoad,n);i.attr("src",n.attr(s.attribute));b(s.onLoad,n);o=true;if(i.complete)i.load()}function v(e){var t=m(),n=e.getBoundingClientRect();return t+s.threshold>n.top&&-s.threshold<n.bottom}function m(){if(a>=0)return a;a=t.innerHeight||n.documentElement.clientHeight||n.body.clientHeight||n.body.offsetHeight||s.fallbackHeight;return a}function g(e,t){function o(){function u(){i=+(new Date);t.apply(r)}var o=+(new Date)-i;n&&clearTimeout(n);if(o>e||!s.enableThrottle)u();else n=setTimeout(u,e-o)}var n,i=0;return o}function y(){--u;if(!o.size()&&!u)b(s.onFinishedAll,null)}function b(e,t){if(e){if(t)E(function(){e(t)},this);else E(e,this)}}function w(){f=setTimeout(function(){E();if(l.length)w()},2)}function E(e,n,r){if(e){if(s.enableQueueing)e.call(n||t);if(!r||r&&!c){l.push([e,n,r]);if(r)c=true}if(l.length==1)w();return 0}var i=l.shift();if(!i)return 0;if(i[2])c=false;i[0].call(i[1]||t);return 0}var s={bind:"load",threshold:500,fallbackHeight:2e3,visibleOnly:false,appendScroll:t,delay:-1,combined:false,attribute:"data-src",removeAttribute:true,handledName:"handled",effect:"show",effectTime:0,enableThrottle:false,throttle:250,enableQueueing:true,beforeLoad:null,onLoad:null,afterLoad:null,onError:null,onFinishedAll:null},o=this,u=0,a=-1,f=null,l=[],c=false;(function(){if(i)e.extend(s,i);if(s.onError)o.each(function(){var t=this;E(function(){e(t).bind("error",function(){b(s.onError,e(this))})},t)});if(s.bind=="load")e(t).load(h);else if(s.bind=="event")h()})();return this};e.fn.Lazy=e.fn.lazy})(jQuery,window,document);