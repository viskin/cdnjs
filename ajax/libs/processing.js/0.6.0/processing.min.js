!function(){this.Processing=function e(t,r){"string"==typeof t&&(t=document.getElementById(t));var n=e.build(t);return r&&n.init(r),n},Processing.lib={};var ajax=function(e){var t=new window.XMLHttpRequest;return t?(t.open("GET",e+"?t="+(new Date).getTime(),!1),t.send(null),t.responseText):!1},init=function(){for(var e=document.getElementsByTagName("canvas"),t=0,r=e.length;r>t;t++){var n=e[t].getAttribute("data-src");null===n&&(n=e[t].getAttribute("datasrc")),n&&Processing(e[t],ajax(n))}},newWebGLArray=function(e){var t=!1;try{t=!0}catch(r){}return t===!0?new WebGLFloatArray(e):new CanvasFloatArray(e)},programObject,boxVerts=[.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5],boxOutlineVerts=[.5,.5,.5,.5,-.5,.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5],boxBuffer,boxOutlineBuffer,sphereBuffer,lineBuffer,pointBuffer,vertexShaderSource="attribute vec3 Vertex;uniform vec4 color;uniform mat4 model;uniform mat4 view;uniform mat4 projection;void main(void){  gl_FrontColor = color;  gl_Position = projection * view * model * vec4(Vertex, 1.0);}",fragmentShaderSource="void main(void){  gl_FragColor = gl_Color;}";document.addEventListener("DOMContentLoaded",function(){init()},!1),Processing.debug=function(){},Processing.parse=function(e,t){e=e.replace(/('(.){1}')/g,"$1.charCodeAt(0)");var r=[];e=e.replace(/(["'])(\\\1|.)*?(\1)/g,function(e){return r.push(e),"<STRING "+(r.length-1)+">"}),e=e.replace(/\/\/.*\n/g,"\n"),e=e.replace(/([^\s])%([^\s])/g,"$1 % $2"),e=e.replace(/(\s*=\s*|\(*\s*)frameRate(\s*\)+?|\s*;)/,"$1p.FRAME_RATE$2"),e=e.replace(/(?:static )?(\w+(?:\[\])* )(\w+)\s*(\([^\)]*\)\s*\{)/g,function(e,t,r,n){return"if"===r||"for"===r||"while"===r?e:"processing."+r+" = function "+r+n}),e=e.replace(/import\s+(.+);/g,""),e=e.replace(/\.length\(\)/g,".length"),e=e.replace(/([\(,]\s*)(\w+)((?:\[\])+| )\s*(\w+\s*[\),])/g,"$1$4"),e=e.replace(/([\(,]\s*)(\w+)((?:\[\])+| )\s*(\w+\s*[\),])/g,"$1$4"),e=e.replace(/new (\w+)((?:\[([^\]]*)\])+)/g,function(e,t,r){return"new ArrayList("+r.replace(/\[\]/g,"[0]").slice(1,-1).split("][").join(", ")+")"}),e=e.replace(/(?:static )?\w+\[\]\s*(\w+)\[?\]?\s*=\s*\{.*?\};/g,function(e){return e.replace(/\{/g,"[").replace(/\}/g,"]")});for(var n=/(\n\s*(?:int|float)(?!\[\])*(?:\s*|[^\(;]*?,\s*))([a-zA-Z]\w*)\s*(,|;)/i;n.test(e);)e=e.replace(new RegExp(n),function(e,t,r,n){return t+" "+r+" = 0"+n});e=e.replace(/(?:static\s+)?(?:final\s+)?(\w+)((?:\[\])+| ) *(\w+)\[?\]?(\s*[=,;])/g,function(e,t,r,n,o){return"return"===t?e:"var "+n+o}),e=e.replace(/\=\s*\{((.|\s)*?)\};/g,function(e,t){return"= ["+t.replace(/\{/g,"[").replace(/\}/g,"]")+"]"}),e=e.replace(/super\(/g,"superMethod(");var o=["int","float","boolean","String","byte","double","long","ArrayList"],s=function(e,t,r,n,s){o.push(t);var a="";return n=n.replace(/final\s+var\s+(\w+\s*=\s*.*?;)/g,function(e,r){return a+=" "+t+"."+r,""}),"function "+t+"() {with(this){\n "+(r?"var __self=this;function superMethod(){extendClass(__self,arguments,"+r+");}\n":"")+n.replace(/\s*,\s*/g,";\n  this.").replace(/\b(var |final |public )+\s*/g,"this.").replace(/\b(var |final |public )+\s*/g,"this.").replace(/this\.(\w+);/g,"this.$1 = null;")+(r?"extendClass(this, "+r+");\n":"")+"<CLASS "+t+" "+a+">"+("string"==typeof s?s:t+"(")},a=function(e){for(var t=e,r=0,n=1,o=0;n!==o;){var s=t.indexOf("{"),a=t.indexOf("}");a>s&&-1!==s?(n++,t=t.slice(s+1),r+=s+1):(o++,t=t.slice(a+1),r+=a+1)}return e.slice(0,r-1)},i=/(?:public |abstract |static )*class (\w+)\s*(?:extends\s*(\w+)\s*)?\{\s*((?:.|\n)*?)\b\1\s*\(/g,p=/(?:public |abstract |static )*class (\w+)\s*(?:extends\s*(\w+)\s*)?\{\s*((?:.|\n)*?)(processing)/g;e=e.replace(i,s),e=e.replace(p,s);for(var u,c=/<CLASS (\w+) (.*?)>/;u=e.match(c);){var l=RegExp.leftContext,h=RegExp.rightContext,m=a(h),f=u[1],g=u[2]||"";h=h.slice(m.length+1),m=m.replace(new RegExp("\\b"+f+"\\(([^\\)]*?)\\)\\s*{","g"),function(e,t){t=t.split(/,\s*?/),t[0].match(/^\s*$/)&&t.shift();for(var r="if ( arguments.length === "+t.length+" ) {\n",n=0;n<t.length;n++)r+=" var "+t[n]+" = arguments["+n+"];\n";return r}),m=m.replace(/(?:public )?processing.\w+ = function (\w+)\((.*?)\)/g,function(e,t,r){return"ADDMETHOD(this, '"+t+"', function("+r+")"});for(var d,x=/ADDMETHOD([\s\S]*?\{)/,v="";d=m.match(x);){var C=RegExp.leftContext,y=RegExp.rightContext,A=a(y);v+="addMethod"+d[1]+A+"});",m=C+y.slice(A.length+1)}m=v+m,e=l+m+"\n}}"+g+h}e=e.replace(/processing.\w+ = function addMethod/g,"addMethod"),e.match(/size\((?:.+),(?:.+),\s*(OPENGL|P3D)\s*\);/)&&(t.use3DContext=!0),e=e.replace(/\(int\)/g,"0|"),e=e.replace(new RegExp("\\(("+o.join("|")+")(\\[\\])*\\)","g"),"");var S=function(e){var t=[];return e.replace(/(..)/g,function(e){t.push(parseInt(e,16))}),t};e=e.replace(/#([a-f0-9]{6})/gi,function(e,t){var r=S(t);return"DefaultColor("+r[0]+","+r[1]+","+r[2]+")"}),e=e.replace(/(\d+)f/g,"$1");for(var M=0;M<r.length;M++)e=e.replace(new RegExp("(.*)(<STRING "+M+">)(.*)","g"),function(e,t,n,o){for(var s=e,a=!0,i="",p=!1,u=0;u<t.length;u++)a?('"'===t.charAt(u)||"'"===t.charAt(u))&&(i=t.charAt(u),a=!1):p?p=!1:"\\"===t.charAt(u)?p=!0:t.charAt(u)===i&&(a=!0,i="");return a&&(s=t+r[M]+o),s});return e},Processing.build=function buildProcessing(curElement){function decToBin(e,t){var r=1;r<<=t-1;for(var n="",o=0;t>o;o++)n+=r&e?"1":"0",r>>>=1;return n}function uniformf(e,t,r){var n=curContext.getUniformLocation(e,t);-1!==n&&(4===r.length?curContext.uniform4fv(n,r):3===r.length?curContext.uniform3fv(n,r):2===r.length?curContext.uniform2fv(n,r):curContext.uniform1f(n,r))}function uniformi(e,t,r){var n=curContext.getUniformLocation(e,t);-1!==n&&(4===r.length?curContext.uniform4iv(n,r):3===r.length?curContext.uniform3iv(n,r):2===r.length?curContext.uniform2iv(n,r):curContext.uniform1i(n,r))}function vertexAttribPointer(e,t,r,n){var o=curContext.getAttribLocation(e,t);-1!==o&&(curContext.bindBuffer(curContext.ARRAY_BUFFER,n),curContext.vertexAttribPointer(o,r,curContext.FLOAT,!1,0,0),curContext.enableVertexAttribArray(o))}function uniformMatrix(e,t,r,n){var o=curContext.getUniformLocation(e,t);-1!==o&&(16===n.length?curContext.uniformMatrix4fv(o,r,n):9===n.length?curContext.uniformMatrix3fv(o,r,n):curContext.uniformMatrix2fv(o,r,n))}function getImage(e){if("string"==typeof e)return document.getElementById(e);if(e.img)return e.img;(e.getContext||e.canvas)&&(e.pixels=e.getContext("2d").createImageData?e.getContext("2d").createImageData(e.width,e.height):e.getContext("2d").getImageData(0,0,e.width,e.height));for(var t=0,r=e.pixels.length;r>t;t++){var n=4*t,o=(e.pixels[t]||"rgba(0,0,0,1)").slice(5,-1).split(",");e.data[n+0]=parseInt(o[0],10),e.data[n+1]=parseInt(o[1],10),e.data[n+2]=parseInt(o[2],10),e.data[n+3]=100*parseFloat(o[3])}var s=document.createElement("canvas");s.width=e.width,s.height=e.height;var a=s.getContext("2d");return a.putImageData(e.pixels,0,0),e.canvas=s,e}var p={},curContext;p.use3DContext=!1,p.name="Processing.js Instance",p.PI=Math.PI,p.TWO_PI=2*p.PI,p.HALF_PI=p.PI/2,p.SINCOS_LENGTH=parseInt(720,10),p.MAX_FLOAT=3.4028235e38,p.MIN_FLOAT=-3.4028235e38,p.MAX_INT=2147483647,p.MIN_INT=-2147483648,p.CORNER=0,p.RADIUS=1,p.CENTER_RADIUS=1,p.CENTER=2,p.POLYGON=2,p.QUADS=5,p.TRIANGLES=6,p.POINTS=7,p.LINES=8,p.TRIANGLE_STRIP=9,p.TRIANGLE_FAN=4,p.QUAD_STRIP=3,p.CORNERS=10,p.CLOSE=!0,p.RGB=1,p.HSB=2,p.OPENGL="OPENGL",p.P3D="P3D",p.FRAME_RATE=0,p.focused=!0,p.ARROW="default",p.CROSS="crosshair",p.HAND="pointer",p.MOVE="move",p.TEXT="text",p.WAIT="wait",p.NOCURSOR="url('data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=='), auto",p.ALPHA_MASK=4278190080,p.RED_MASK=16711680,p.GREEN_MASK=65280,p.BLUE_MASK=255,p.REPLACE=0,p.BLEND=1,p.ADD=2,p.SUBTRACT=4,p.LIGHTEST=8,p.DARKEST=16,p.DIFFERENCE=32,p.EXCLUSION=64,p.MULTIPLY=128,p.SCREEN=256,p.OVERLAY=512,p.HARD_LIGHT=1024,p.SOFT_LIGHT=2048,p.DODGE=4096,p.BURN=8192,p.PRECISIONB=15,p.PRECISIONF=1<<p.PRECISIONB,p.PREC_MAXVAL=p.PRECISIONF-1,p.PREC_ALPHA_SHIFT=24-p.PRECISIONB,p.PREC_RED_SHIFT=16-p.PRECISIONB,p.ROUND="round",p.SQUARE="butt",p.PROJECT="square",p.MITER="miter",p.BEVEL="bevel",p.CENTER=88888880,p.NORMAL_MODE_AUTO=0,p.NORMAL_MODE_SHAPE=1,p.NORMAL_MODE_VERTEX=2,p.BACKSPACE=8,p.TAB=9,p.ENTER=10,p.RETURN=13,p.ESC=27,p.DELETE=127,p.CODED=65535,p.SHIFT=16,p.CONTROL=17,p.ALT=18,p.UP=38,p.RIGHT=39,p.DOWN=40,p.LEFT=37;var codedKeys=[p.SHIFT,p.CONTROL,p.ALT,p.UP,p.RIGHT,p.DOWN,p.LEFT],online=!0,doFill=!0,fillStyle="rgba( 255, 255, 255, 1 )",doStroke=!0,strokeStyle="rgba( 204, 204, 204, 1 )",lineWidth=1,loopStarted=!1,hasBackground=!1,doLoop=!0,looping=0,curRectMode=p.CORNER,curEllipseMode=p.CENTER,normalX=0,normalY=0,normalZ=0,normalMode=p.NORMAL_MODE_AUTO,inSetup=!1,inDraw=!1,curBackground="rgba( 204, 204, 204, 1 )",curFrameRate=1e3,curCursor=p.ARROW,oldCursor=document.body.style.cursor,curMsPerFrame=1,curShape=p.POLYGON,curShapeCount=0,curvePoints=[],curTightness=0,opacityRange=255,redRange=255,greenRange=255,blueRange=255,pathOpen=!1,mousePressed=!1,mouseDragging=!1,keyPressed=!1,curColorMode=p.RGB,curTint=-1,curTextSize=12,curTextFont="Arial",getLoaded=!1,start=(new Date).getTime(),timeSinceLastFPS=start,framesSinceLastFPS=0,sphereDetailV=0,sphereDetailU=0,sphereX=[],sphereY=[],sphereZ=[],sinLUT=new Array(p.SINCOS_LENGTH),cosLUT=new Array(p.SINCOS_LENGTH),sphereVerts,sphereNorms,cam,cameraInv,forwardTransform,modelView,modelViewInv,userMatrixStack,inverseCopy,projection,frustumMode=!1,cameraFOV=60*(Math.PI/180),cameraX=curElement.width/2,cameraY=curElement.height/2,cameraZ=cameraY/Math.tan(cameraFOV/2),cameraNear=cameraZ/10,cameraFar=10*cameraZ,cameraAspect=curElement.width/curElement.height,firstX,firstY,secondX,secondY,prevX,prevY,styleArray=new Array(0);p.ln="",p.glyphTable={},p.pmouseX=0,p.pmouseY=0,p.mouseX=0,p.mouseY=0,p.mouseButton=0,p.mouseDown=!1,p.mouseClicked=void 0,p.mouseDragged=void 0,p.mouseMoved=void 0,p.mousePressed=void 0,p.mouseReleased=void 0,p.keyPressed=void 0,p.keyReleased=void 0,p.draw=void 0,p.setup=void 0,p.width=curElement.width-0,p.height=curElement.height-0,p.frameCount=0,p.split=function(e,t){return e.split(t)},p.splitTokens=function(e,t){1===arguments.length&&(t="\n	\r\f "),t="["+t+"]";for(var r=new Array(0),n=0,o=e.search(t);o>=0;)0===o?e=e.substring(1):(r[n]=e.substring(0,o),n++,e=e.substring(o)),o=e.search(t);return e.length>0&&(r[n]=e),0===r.length&&(r=void 0),r},p.append=function(e,t){return e[e.length]=t,e},p.concat=function(e,t){return e.concat(t)},p.sort=function(e,t){var r=[];if(e.length>0){for(var n=t>0?t:e.length,o=0;n>o;o++)r.push(e[o]);if("string"==typeof e[0]?r.sort():r.sort(function(e,t){return e-t}),t>0)for(var s=r.length;s<e.length;s++)r.push(e[s])}return r},p.splice=function(e,t,r){if(0===e.length&&0===t.length)return e;if(t instanceof Array)for(var n=0,o=r;n<t.length;o++,n++)e.splice(o,0,t[n]);else e.splice(r,0,t);return e},p.subset=function(e,t,r){return 2===arguments.length?p.subset(e,t,e.length-t):3===arguments.length?e.slice(t,t+r):void 0},p.join=function(e,t){return e.join(t)},p.shorten=function(e){for(var t=new Array(0),r=e.length,n=0;r>n;n++)t[n]=e[n];return t.pop(),t},p.expand=function(e,t){for(var r=new Array(0),n=e.length,o=0;n>o;o++)r[o]=e[o];return 1===arguments.length?r.length*=2:2===arguments.length&&(r.length=t),r},p.ArrayList=function e(t,r,n){var o=new Array(0|t);if(r)for(var s=0;t>s;s++){o[s]=[];for(var a=0;r>a;a++)for(var i=o[s][a]=n?new Array(n):0,p=0;n>p;p++)i[p]=0}else for(var u=0;t>u;u++)o[u]=0;return o.get=function(e){return this[e]},o.add=function(e){return this.push(e)},o.size=function(){return this.length},o.clear=function(){this.length=0},o.remove=function(e){return this.splice(e,1)},o.isEmpty=function(){return!this.length},o.clone=function(){for(var r=new e(t),n=0;t>n;n++)r[n]=this[n];return r},o},p.reverse=function(e){return e.reverse()},p.rgbaToInt=function(e){var t=/\(([^\)]+)\)/.exec(e).slice(1,2)[0].split(",");return 255*t[3]<<24|t[0]<<16|t[1]<<8|t[2]},p.mix=function(e,t,r){return e+((t-e)*r>>8)},p.peg=function(e){return 0>e?0:e>255?255:e},p.modes={replace:function(e,t){return p.rgbaToInt(t)},blend:function(e,t){var r=p.rgbaToInt(e),n=p.rgbaToInt(t),o=(n&p.ALPHA_MASK)>>>24;return Math.min(((r&p.ALPHA_MASK)>>>24)+o,255)<<24|p.mix(r&p.RED_MASK,n&p.RED_MASK,o)&p.RED_MASK|p.mix(r&p.GREEN_MASK,n&p.GREEN_MASK,o)&p.GREEN_MASK|p.mix(r&p.BLUE_MASK,n&p.BLUE_MASK,o)},add:function(e,t){var r=p.rgbaToInt(e),n=p.rgbaToInt(t),o=(n&p.ALPHA_MASK)>>>24;return Math.min(((r&p.ALPHA_MASK)>>>24)+o,255)<<24|Math.min((r&p.RED_MASK)+((n&p.RED_MASK)>>8)*o,p.RED_MASK)&p.RED_MASK|Math.min((r&p.GREEN_MASK)+((n&p.GREEN_MASK)>>8)*o,p.GREEN_MASK)&p.GREEN_MASK|Math.min((r&p.BLUE_MASK)+((n&p.BLUE_MASK)*o>>8),p.BLUE_MASK)},subtract:function(e,t){var r=p.rgbaToInt(e),n=p.rgbaToInt(t),o=(n&p.ALPHA_MASK)>>>24;return Math.min(((r&p.ALPHA_MASK)>>>24)+o,255)<<24|Math.max((r&p.RED_MASK)-((n&p.RED_MASK)>>8)*o,p.GREEN_MASK)&p.RED_MASK|Math.max((r&p.GREEN_MASK)-((n&p.GREEN_MASK)>>8)*o,p.BLUE_MASK)&p.GREEN_MASK|Math.max((r&p.BLUE_MASK)-((n&p.BLUE_MASK)*o>>8),0)},lightest:function(e,t){var r=p.rgbaToInt(e),n=p.rgbaToInt(t),o=(n&p.ALPHA_MASK)>>>24;return Math.min(((r&p.ALPHA_MASK)>>>24)+o,255)<<24|Math.max(r&p.RED_MASK,((n&p.RED_MASK)>>8)*o)&p.RED_MASK|Math.max(r&p.GREEN_MASK,((n&p.GREEN_MASK)>>8)*o)&p.GREEN_MASK|Math.max(r&p.BLUE_MASK,(n&p.BLUE_MASK)*o>>8)},darkest:function(e,t){var r=p.rgbaToInt(e),n=p.rgbaToInt(t),o=(n&p.ALPHA_MASK)>>>24;return Math.min(((r&p.ALPHA_MASK)>>>24)+o,255)<<24|p.mix(r&p.RED_MASK,Math.min(r&p.RED_MASK,((n&p.RED_MASK)>>8)*o),o)&p.RED_MASK|p.mix(r&p.GREEN_MASK,Math.min(r&p.GREEN_MASK,((n&p.GREEN_MASK)>>8)*o),o)&p.GREEN_MASK|p.mix(r&p.BLUE_MASK,Math.min(r&p.BLUE_MASK,(n&p.BLUE_MASK)*o>>8),o)},difference:function(e,t){var r=p.rgbaToInt(e),n=p.rgbaToInt(t),o=(n&p.ALPHA_MASK)>>>24,s=(r&p.RED_MASK)>>16,a=(r&p.GREEN_MASK)>>8,i=r&p.BLUE_MASK,u=(n&p.RED_MASK)>>16,c=(n&p.GREEN_MASK)>>8,l=n&p.BLUE_MASK,h=s>u?s-u:u-s,m=a>c?a-c:c-a,f=i>l?i-l:l-i;return Math.min(((r&p.ALPHA_MASK)>>>24)+o,255)<<24|p.peg(s+((h-s)*o>>8))<<16|p.peg(a+((m-a)*o>>8))<<8|p.peg(i+((f-i)*o>>8))},exclusion:function(e,t){var r=p.rgbaToInt(e),n=p.rgbaToInt(t),o=(n&p.ALPHA_MASK)>>>24,s=(r&p.RED_MASK)>>16,a=(r&p.GREEN_MASK)>>8,i=r&p.BLUE_MASK,u=(n&p.RED_MASK)>>16,c=(n&p.GREEN_MASK)>>8,l=n&p.BLUE_MASK,h=s+u-(s*u>>7),m=a+c-(a*c>>7),f=i+l-(i*l>>7);return Math.min(((r&p.ALPHA_MASK)>>>24)+o,255)<<24|p.peg(s+((h-s)*o>>8))<<16|p.peg(a+((m-a)*o>>8))<<8|p.peg(i+((f-i)*o>>8))},multiply:function(e,t){var r=p.rgbaToInt(e),n=p.rgbaToInt(t),o=(n&p.ALPHA_MASK)>>>24,s=(r&p.RED_MASK)>>16,a=(r&p.GREEN_MASK)>>8,i=r&p.BLUE_MASK,u=(n&p.RED_MASK)>>16,c=(n&p.GREEN_MASK)>>8,l=n&p.BLUE_MASK,h=s*u>>8,m=a*c>>8,f=i*l>>8;return Math.min(((r&p.ALPHA_MASK)>>>24)+o,255)<<24|p.peg(s+((h-s)*o>>8))<<16|p.peg(a+((m-a)*o>>8))<<8|p.peg(i+((f-i)*o>>8))},screen:function(e,t){var r=p.rgbaToInt(e),n=p.rgbaToInt(t),o=(n&p.ALPHA_MASK)>>>24,s=(r&p.RED_MASK)>>16,a=(r&p.GREEN_MASK)>>8,i=r&p.BLUE_MASK,u=(n&p.RED_MASK)>>16,c=(n&p.GREEN_MASK)>>8,l=n&p.BLUE_MASK,h=255-((255-s)*(255-u)>>8),m=255-((255-a)*(255-c)>>8),f=255-((255-i)*(255-l)>>8);return Math.min(((r&p.ALPHA_MASK)>>>24)+o,255)<<24|p.peg(s+((h-s)*o>>8))<<16|p.peg(a+((m-a)*o>>8))<<8|p.peg(i+((f-i)*o>>8))},hard_light:function(e,t){var r=p.rgbaToInt(e),n=p.rgbaToInt(t),o=(n&p.ALPHA_MASK)>>>24,s=(r&p.RED_MASK)>>16,a=(r&p.GREEN_MASK)>>8,i=r&p.BLUE_MASK,u=(n&p.RED_MASK)>>16,c=(n&p.GREEN_MASK)>>8,l=n&p.BLUE_MASK,h=128>u?s*u>>7:255-((255-s)*(255-u)>>7),m=128>c?a*c>>7:255-((255-a)*(255-c)>>7),f=128>l?i*l>>7:255-((255-i)*(255-l)>>7);return Math.min(((r&p.ALPHA_MASK)>>>24)+o,255)<<24|p.peg(s+((h-s)*o>>8))<<16|p.peg(a+((m-a)*o>>8))<<8|p.peg(i+((f-i)*o>>8))},soft_light:function(e,t){var r=p.rgbaToInt(e),n=p.rgbaToInt(t),o=(n&p.ALPHA_MASK)>>>24,s=(r&p.RED_MASK)>>16,a=(r&p.GREEN_MASK)>>8,i=r&p.BLUE_MASK,u=(n&p.RED_MASK)>>16,c=(n&p.GREEN_MASK)>>8,l=n&p.BLUE_MASK,h=(s*u>>7)+(s*s>>8)-(s*s*u>>15),m=(a*c>>7)+(a*a>>8)-(a*a*c>>15),f=(i*l>>7)+(i*i>>8)-(i*i*l>>15);return Math.min(((r&p.ALPHA_MASK)>>>24)+o,255)<<24|p.peg(s+((h-s)*o>>8))<<16|p.peg(a+((m-a)*o>>8))<<8|p.peg(i+((f-i)*o>>8))},overlay:function(e,t){var r=p.rgbaToInt(e),n=p.rgbaToInt(t),o=(n&p.ALPHA_MASK)>>>24,s=(r&p.RED_MASK)>>16,a=(r&p.GREEN_MASK)>>8,i=r&p.BLUE_MASK,u=(n&p.RED_MASK)>>16,c=(n&p.GREEN_MASK)>>8,l=n&p.BLUE_MASK,h=128>s?s*u>>7:255-((255-s)*(255-u)>>7),m=128>a?a*c>>7:255-((255-a)*(255-c)>>7),f=128>i?i*l>>7:255-((255-i)*(255-l)>>7);return Math.min(((r&p.ALPHA_MASK)>>>24)+o,255)<<24|p.peg(s+((h-s)*o>>8))<<16|p.peg(a+((m-a)*o>>8))<<8|p.peg(i+((f-i)*o>>8))},dodge:function(e,t){var r=p.rgbaToInt(e),n=p.rgbaToInt(t),o=(n&p.ALPHA_MASK)>>>24,s=(r&p.RED_MASK)>>16,a=(r&p.GREEN_MASK)>>8,i=r&p.BLUE_MASK,u=(n&p.RED_MASK)>>16,c=(n&p.GREEN_MASK)>>8,l=n&p.BLUE_MASK,h=255===u?255:p.peg((s<<8)/(255-u)),m=255===c?255:p.peg((a<<8)/(255-c)),f=255===l?255:p.peg((i<<8)/(255-l));return Math.min(((r&p.ALPHA_MASK)>>>24)+o,255)<<24|p.peg(s+((h-s)*o>>8))<<16|p.peg(a+((m-a)*o>>8))<<8|p.peg(i+((f-i)*o>>8))},burn:function(e,t){var r=p.rgbaToInt(e),n=p.rgbaToInt(t),o=(n&p.ALPHA_MASK)>>>24,s=(r&p.RED_MASK)>>16,a=(r&p.GREEN_MASK)>>8,i=r&p.BLUE_MASK,u=(n&p.RED_MASK)>>16,c=(n&p.GREEN_MASK)>>8,l=n&p.BLUE_MASK,h=0===u?0:255-p.peg((255-s<<8)/u),m=0===c?0:255-p.peg((255-a<<8)/c),f=0===l?0:255-p.peg((255-i<<8)/l);return Math.min(((r&p.ALPHA_MASK)>>>24)+o,255)<<24|p.peg(s+((h-s)*o>>8))<<16|p.peg(a+((m-a)*o>>8))<<8|p.peg(i+((f-i)*o>>8))}},p.color=function(e,t,r,n){function o(e,t,r){e=e/redRange*360,t=t/greenRange*100,r=r/blueRange*100;var n=Math.round(r/100*255);if(0===t)return[n,n,n];var o=e%360,s=o%60,a=Math.round(r*(100-t)/1e4*255),i=Math.round(r*(6e3-t*s)/6e5*255),p=Math.round(r*(6e3-t*(60-s))/6e5*255);switch(Math.floor(o/60)){case 0:return[n,p,a];case 1:return[i,n,a];case 2:return[a,n,p];case 3:return[a,i,n];case 4:return[p,a,n];case 5:return[n,a,i]}}function s(e,t){return Math.round(255*(e/t))}var a,i,u,c,l;if(3===arguments.length)l=p.color(e,t,r,opacityRange);else if(4===arguments.length){var h=n/opacityRange;h=isNaN(h)?1:h,curColorMode===p.HSB?(c=o(e,t,r),a=c[0],i=c[1],u=c[2]):(a=s(e,redRange),i=s(t,greenRange),u=s(r,blueRange)),l="rgba("+a+","+i+","+u+","+h+")"}else if("string"==typeof e){if(l=e,2===arguments.length){var m=l.split(",");m[3]=t/opacityRange+")",l=m.join(",")}}else if(2===arguments.length)l=p.color(e,e,e,t);else if("number"==typeof e&&256>e&&e>=0)l=p.color(e,e,e,opacityRange);else if("number"==typeof e){var f=0;f=0>e?4294967296- -1*e:e;var g=Math.floor(f%4294967296/16777216),d=Math.floor(f%16777216/65536),x=Math.floor(f%65536/256),v=f%256;l=p.color(d,x,v,g)}else l=p.color(redRange,greenRange,blueRange,opacityRange);return l};var verifyChannel=function(e){return e.constructor===Array?e:p.color(e)};p.red=function(e){return parseInt(verifyChannel(e).slice(5),10)},p.green=function(e){return parseInt(verifyChannel(e).split(",")[1],10)},p.blue=function(e){return parseInt(verifyChannel(e).split(",")[2],10)},p.alpha=function(e){return parseInt(255*parseFloat(verifyChannel(e).split(",")[3]),10)},p.lerpColor=function(e,t,r){var n=p.color(e).split(","),o=parseInt(n[0].split("(")[1],10),s=parseInt(n[1],10),a=parseInt(n[2],10),i=parseFloat(n[3].split(")")[0],10),u=p.color(t).split(","),c=parseInt(u[0].split("(")[1],10),l=parseInt(u[1],10),h=parseInt(u[2],10),m=parseFloat(u[3].split(")")[0],10),f=parseInt(p.lerp(o,c,r),10),g=parseInt(p.lerp(s,l,r),10),d=parseInt(p.lerp(a,h,r),10),x=parseFloat(p.lerp(i,m,r),10),v="rgba("+f+","+g+","+d+","+x+")";return v},p.DefaultColor=function(e,t,r){var n=curColorMode;curColorMode=p.RGB;var o=p.color(e/255*redRange,t/255*greenRange,r/255*blueRange);return curColorMode=n,o},p.colorMode=function(e,t,r,n,o){curColorMode=e,arguments.length>=4&&(redRange=t,greenRange=r,blueRange=n),5===arguments.length&&(opacityRange=o),2===arguments.length&&p.colorMode(e,t,t,t,t)},p.blendColor=function(e,t,r){var n=0;switch(r){case p.REPLACE:n=p.modes.replace(e,t);break;case p.BLEND:n=p.modes.blend(e,t);break;case p.ADD:n=p.modes.add(e,t);break;case p.SUBTRACT:n=p.modes.subtract(e,t);break;case p.LIGHTEST:n=p.modes.lightest(e,t);break;case p.DARKEST:n=p.modes.darkest(e,t);break;case p.DIFFERENCE:n=p.modes.difference(e,t);break;case p.EXCLUSION:n=p.modes.exclusion(e,t);break;case p.MULTIPLY:n=p.modes.multiply(e,t);break;case p.SCREEN:n=p.modes.screen(e,t);break;case p.HARD_LIGHT:n=p.modes.hard_light(e,t);break;case p.SOFT_LIGHT:n=p.modes.soft_light(e,t);break;case p.OVERLAY:n=p.modes.overlay(e,t);break;case p.DODGE:n=p.modes.dodge(e,t);break;case p.BURN:n=p.modes.burn(e,t)}return n},p.translate=function(e,t,r){p.use3DContext?forwardTransform.translate(e,t,r):curContext.translate(e,t)},p.scale=function(e,t,r){p.use3DContext?forwardTransform.scale(e,t,r):curContext.scale(e,t||e)},p.pushMatrix=function(){p.use3DContext?userMatrixStack.load(modelView):curContext.save()},p.popMatrix=function(){p.use3DContext?modelView.set(userMatrixStack.pop()):curContext.restore()},p.resetMatrix=function(){forwardTransform.reset()},p.applyMatrix=function(){var e=arguments;if(!p.use3DContext){for(var t=e.length;16>t;t++)e[t]=0;e[10]=e[15]=1}forwardTransform.apply(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},p.rotateX=function(e){forwardTransform.rotateX(e)},p.rotateZ=function(e){forwardTransform.rotateZ(e)},p.rotateY=function(e){forwardTransform.rotateY(e)},p.rotate=function(e){p.use3DContext?forwardTransform.rotateZ(e):curContext.rotate(e)},p.pushStyle=function(){curContext.save(),p.pushMatrix();var e={doFill:doFill,doStroke:doStroke,curTint:curTint,curRectMode:curRectMode,curColorMode:curColorMode,redRange:redRange,blueRange:blueRange,greenRange:greenRange,opacityRange:opacityRange,curTextFont:curTextFont,curTextSize:curTextSize};styleArray.push(e)},p.popStyle=function(){var e=styleArray.pop();if(!e)throw"Too many popStyle() without enough pushStyle()";curContext.restore(),p.popMatrix(),doFill=e.doFill,doStroke=e.doStroke,curTint=e.curTint,curRectMode=e.curRectmode,curColorMode=e.curColorMode,redRange=e.redRange,blueRange=e.blueRange,greenRange=e.greenRange,opacityRange=e.opacityRange,curTextFont=e.curTextFont,curTextSize=e.curTextSize},p.year=function(){return(new Date).getYear()+1900},p.month=function(){return(new Date).getMonth()},p.day=function(){return(new Date).getDay()},p.hour=function(){return(new Date).getHours()},p.minute=function(){return(new Date).getMinutes()},p.second=function(){return(new Date).getSeconds()},p.millis=function(){return(new Date).getTime()-start},p.noLoop=function(){doLoop=!1,loopStarted=!1,clearInterval(looping)},p.redraw=function(){var e=((new Date).getTime()-timeSinceLastFPS)/1e3;framesSinceLastFPS++;var t=framesSinceLastFPS/e;e>.5&&(timeSinceLastFPS=(new Date).getTime(),framesSinceLastFPS=0,p.FRAME_RATE=t),p.frameCount++,inDraw=!0,p.use3DContext?(curContext.clear(curContext.COLOR_BUFFER_BIT|curContext.DEPTH_BUFFER_BIT),p.camera(),p.draw()):(p.pushMatrix(),p.draw(),p.popMatrix()),inDraw=!1},p.loop=function(){loopStarted||(looping=window.setInterval(function(){try{try{p.focused=document.hasFocus()}catch(e){}p.redraw()}catch(t){throw window.clearInterval(looping),t}},curMsPerFrame),doLoop=!0,loopStarted=!0)},p.frameRate=function(e){curFrameRate=e,curMsPerFrame=1e3/curFrameRate},p.exit=function(){window.clearInterval(looping)},p.cursor=function(e){curCursor=document.body.style.cursor=e},p.noCursor=function(){curCursor=document.body.style.cursor=p.NOCURSOR},p.link=function(e){window.location=e},p.beginDraw=function(){},p.endDraw=function(){},p.Import=function(){};var contextMenu=function(e){e.preventDefault(),e.stopPropagation()};p.disableContextMenu=function(){curElement.addEventListener("contextmenu",contextMenu,!1)},p.enableContextMenu=function(){curElement.removeEventListener("contextmenu",contextMenu,!1)},p.binary=function(e,t){var r=32;if("string"==typeof e&&e.length>1){var n=e.slice(5,-1).split(","),o=[decToBin(255*n[3],8),decToBin(n[0],8),decToBin(n[1],8),decToBin(n[2],8)],s=o[0]+o[1]+o[2]+o[3];return t?s=s.substr(-t):(s=s.replace(/^0+$/g,"0"),s=s.replace(/^0{1,}1/g,"1")),s}"string"==typeof e&&(e=e.charCodeAt(0),r=t?32:16);var a=decToBin(e,r);return t&&(a=a.substr(-t)),a},p.unbinary=function(e){var t=new RegExp("^[0|1]{8}$"),r=0;if(isNaN(e))throw"NaN_Err";if(1===arguments.length||8===e.length){if(t.test(e)){for(var n=0;8>n;n++)r+=Math.pow(2,n)*parseInt(e.charAt(7-n),10);return r+""}throw"notBinary: the value passed into unbinary was not an 8 bit binary number"}throw"longErr"},p.nfs=function(e,t,r){var n,o,s,a;if("object"==typeof e&&e.constructor===Array){n=new Array(0),o=e.length;for(var i=0;o>i;i++)n[i]=p.nfs(e[i],t,r)}else if(3===arguments.length){var u=0>e?!0:!1;0===r&&(r=1),a=0>r?Math.round(e):Math.round(e*Math.pow(10,r))/Math.pow(10,r);var c=Math.abs(a).toString().split(".");for(s=t-c[0].length;s>0;s--)c[0]="0"+c[0];if(2===c.length||r>0){for(c[1]=2===c.length?c[1]:"",s=r-c[1].length;s>0;s--)c[1]+="0";n=c.join(".")}else n=c[0];n=(u?"-":" ")+n}else 2===arguments.length&&(n=p.nfs(e,t,-1));return n},p.nfp=function(e,t,r){var n,o,s,a;if("object"==typeof e&&e.constructor===Array){n=new Array(0),o=e.length;for(var i=0;o>i;i++)n[i]=p.nfp(e[i],t,r)}else if(3===arguments.length){var u=0>e?!0:!1;0===r&&(r=1),a=0>r?Math.round(e):Math.round(e*Math.pow(10,r))/Math.pow(10,r);var c=Math.abs(a).toString().split(".");for(s=t-c[0].length;s>0;s--)c[0]="0"+c[0];if(2===c.length||r>0){for(c[1]=2===c.length?c[1]:"",s=r-c[1].length;s>0;s--)c[1]+="0";n=c.join(".")}else n=c[0];n=(u?"-":"+")+n}else 2===arguments.length&&(n=p.nfp(e,t,-1));return n},p.nfc=function(e,t){var r,n=t>=0?t:0;if("object"==typeof e){r=new Array(0);for(var o=0;o<e.length;o++)r[o]=p.nfc(e[o],n)}else if(2===arguments.length){var s=p.nfs(e,0,n),a=new Array(0);a=s.split(".");for(var i=a[0],u=a.length>1?"."+a[1]:"",c=/(\d+)(\d{3})/;c.test(i);)i=i.replace(c,"$1,$2");r=i+u}else 1===arguments.length&&(r=p.nfc(e,0));return r};var decimalToHex=function(e,t){t="undefined"==typeof t||null===t?t=8:t,0>e&&(e=4294967295+e+1);for(var r=Number(e).toString(16).toUpperCase();r.length<t;)r="0"+r;return r.length>=t&&(r=r.substring(r.length-t,r.length)),r};p.hex=function t(e,r){var n="",o=/^rgba?\((\d{1,3}),(\d{1,3}),(\d{1,3})(,\d?\.?\d*)?\)$/i;return n=1===arguments.length?t(e,8):o.test(e)?decimalToHex(p.rgbaToInt(e),r):decimalToHex(e,r)},p.unhex=function(e){for(var t=0,r=1,n=0,o=e.length-1,s=o;s>=0;s--){try{switch(e[s]){case"0":n=0;break;case"1":n=1;break;case"2":n=2;break;case"3":n=3;break;case"4":n=4;break;case"5":n=5;break;case"6":n=6;break;case"7":n=7;break;case"8":n=8;break;case"9":n=9;break;case"A":case"a":n=10;break;case"B":case"b":n=11;break;case"C":case"c":n=12;break;case"D":case"d":n=13;break;case"E":case"e":n=14;break;case"F":case"f":n=15;break;default:return 0}t+=n*r,r*=16}catch(a){Processing.debug(a)}t>2147483647&&(t-=4294967296)}return t},p.loadStrings=function(e){return ajax(e).split("\n")},p.nf=function(){var e,t,r,n,o,s,a,i,p;if(2===arguments.length&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]&&-1===(arguments[0]+"").indexOf(".")){for(t=arguments[0],r=arguments[1],a=0>t,a&&(t=Math.abs(t)),e=""+t,p=r-e.length;p>0;p--)e="0"+e;a&&(e="-"+e)}else if(2===arguments.length&&"object"==typeof arguments[0]&&arguments[0].constructor===Array&&"number"==typeof arguments[1])for(n=arguments[0],r=arguments[1],e=new Array(n.length),p=0;p<n.length&&void 0!==e;p++)i=this.nf(n[p],r),void 0===i?e=void 0:e[p]=i;else if(3===arguments.length&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]&&"number"==typeof arguments[2]&&(arguments[0]+"").indexOf(".")>=0){for(t=arguments[0],o=arguments[1],s=arguments[2],a=0>t,a&&(t=Math.abs(t)),0>s&&Math.floor(t)%2===1&&t-Math.floor(t)>=.5&&(t+=1),e=""+t,p=o-e.indexOf(".");p>0;p--)e="0"+e;var u=e.length-e.indexOf(".")-1;if(s>=u)for(p=s-(e.length-e.indexOf(".")-1);p>0;p--)e+="0";else s>0?e=e.substring(0,e.length-(u-s)):0>s&&(e=e.substring(0,e.indexOf(".")));a&&(e="-"+e)}else if(3===arguments.length&&"object"==typeof arguments[0]&&arguments[0].constructor===Array&&"number"==typeof arguments[1]&&"number"==typeof arguments[2])for(n=arguments[0],o=arguments[1],s=arguments[2],e=new Array(n.length),p=0;p<n.length&&void 0!==e;p++)i=this.nf(n[p],o,s),void 0===i?e=void 0:e[p]=i;return e},p.matchAll=function(e,t){var r,n=0,o=[],s=new RegExp(t,"g");for(r=o[n]=s.exec(e);r;)n++,r=o[n]=s.exec(e);return o.slice(0,n)},String.prototype.replaceAll=function(e,t){return this.replace(new RegExp(e,"g"),t)},String.prototype.equals=function(e){var t=!0;if(this.length===e.length){for(var r=0;r<this.length;r++)if(this.charAt(r)!==e.charAt(r)){t=!1;break}}else t=!1;return t},p.match=function(e,t){return e.match(t)};var tinylogLite=function(){"use strict";var e={},t="undefined",r="function",n=!1,o=!0,s="log";return typeof tinylog!==t&&typeof tinylog[s]===r?e[s]=tinylog[s]:typeof document===t||document.fake?typeof print===r&&(e[s]=print):!function(){var t=document,r="div",a="style",i="title",p={zIndex:1e4,position:"fixed",bottom:"0px",width:"100%",height:"15%",fontFamily:"sans-serif",color:"black",backgroundColor:"white"},u={position:"relative",fontFamily:"monospace",overflow:"auto",height:"100%"},c={height:"5px",marginTop:"-5px",cursor:"n-resize",backgroundColor:"darkgrey"},l={position:"absolute",top:"0px",right:"15px",border:"1px solid black",borderTop:"none",cursor:"pointer",fontWeight:"bold",textAlign:"center",padding:"1px 5px",backgroundColor:"#eb0000"},h={borderBottom:"1px solid #d3d3d3",minHeight:"16px"},m={fontSize:"12px",margin:"0 5px 0 5px",maxWidth:"100%",whiteSpace:"pre-wrap",overflow:"auto"},f=t.defaultView,g=t.documentElement,d=g[a],x=function(){for(var e,t,r,n=arguments.length;n--;){t=arguments[n--],e=arguments[n][a];for(r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}},v=function(e,t,r){return e.addEventListener?e.addEventListener(t,r,n):e.attachEvent&&e.attachEvent("on"+t,r),[e,t,r]},C=function(e,t,r){e.removeEventListener?e.removeEventListener(t,r,n):e.detachEvent&&e.detachEvent("on"+t,r)},y=function(e){for(var t=e.childNodes,r=t.length;r--;)e.removeChild(t.item(0))},A=function(e,t){return e.appendChild(t)},S=function(e){return t.createElement(e)},M=function(e){return t.createTextNode(e)},b=e[s]=function(E){var R,_=d.paddingBottom,w=S(r),T=w[a],P=A(w,S(r)),D=A(w,S(r)),L=A(w,S(r)),I=n,k=n,N=n,O=function(){d.paddingBottom=w.clientHeight+"px"},F=function(e){var t=f.innerHeight,r=P.clientHeight;0>e?e=0:e+r>t&&(e=t-r),T.height=e/t*100+"%",O()},K=[v(t,"mousemove",function(e){I&&(F(f.innerHeight-e.clientY),D.scrollTop=N)}),v(t,"mouseup",function(){I&&(I=N=n)}),v(P,"dblclick",function(e){e.preventDefault(),k?(F(k),k=n):(k=w.clientHeight,T.height="0px")}),v(P,"mousedown",function(e){e.preventDefault(),I=o,N=D.scrollTop}),v(P,"contextmenu",function(){I=n}),v(L,"click",function(){R()})];R=function(){for(var t=K.length;t--;)C.apply(e,K[t]);g.removeChild(w),d.paddingBottom=_,y(D),y(w),e[s]=b},x(w,p,D,u,P,c,L,l),L[i]="Close Log",A(L,M("X")),P[i]="Double-click to toggle log minimization",g.insertBefore(w,g.firstChild),e[s]=function(e){var t=A(D,S(r)),n=A(t,S(r));t[i]=(new Date).toLocaleTimeString(),x(t,h,n,m),A(n,M(e)),D.scrollTop=D.scrollHeight},e[s](E)}}(),e}(),logBuffer=[];p.console=window.console||tinylogLite,p.println=function(e){var t=logBuffer.length;t&&(tinylogLite.log(logBuffer.join("")),logBuffer.length=0),0===arguments.length&&0===t?tinylogLite.log(""):0!==arguments.length&&tinylogLite.log(e)},p.print=function(e){logBuffer.push(e)},p.str=function r(e){var t;if(1===arguments.length)if("string"==typeof e&&1===e.length)t=e;else if("object"==typeof e&&e.constructor===Array){t=new Array(0);for(var n=0;n<e.length;n++)t[n]=r(e[n])
}else t=e+"";return t},p.char=function n(e){var t;if(1===arguments.length&&"number"==typeof e&&-1===(e+"").indexOf("."))t=String.fromCharCode(e);else{if(1!==arguments.length||"object"!=typeof e||e.constructor!==Array)throw"char() may receive only one argument of type int, byte, int[], or byte[].";t=new Array(0);for(var r=0;r<e.length;r++)t[r]=n(e[r])}return t},p.trim=function(e){var t;if("object"==typeof e&&e.constructor===Array){t=new Array(0);for(var r=0;r<e.length;r++)t[r]=p.trim(e[r])}else t=e.replace(/^\s*/,"").replace(/\s*$/,"").replace(/\r*$/,"");return t},p.sq=function(e){return e*e},p.sqrt=function(e){return Math.sqrt(e)},p.int=function(e){var t;if((e||0===e)&&1===arguments.length)if("number"==typeof e){var r=0>e;r&&(e=Math.abs(e)),t=Math.floor(e),r&&(t=-t)}else if("boolean"==typeof e)t=e===!0?1:0;else if("string"==typeof e)e.indexOf(" ")>-1?t=0:1===e.length?t=e.charCodeAt(0):(t=parseInt(e,10),isNaN(t)&&(t=0));else if("object"==typeof e&&e.constructor===Array){t=new Array(e.length);for(var n=0;n<e.length;n++)t[n]="string"==typeof e[n]&&e[n].indexOf(".")>-1?0:p.int(e[n])}return t},p.min=function(){var e;e=1===arguments.length&&"object"==typeof arguments[0]&&arguments[0].constructor===Array?arguments[0]:arguments;for(var t=0;t<e.length;t++)if("number"!=typeof e[t])return void 0;return Math.min.apply(this,e)},p.max=function(){var e;e=1===arguments.length&&"object"==typeof arguments[0]&&arguments[0].constructor===Array?arguments[0]:arguments;for(var t=0;t<e.length;t++)if("number"!=typeof e[t])return void 0;return Math.max.apply(this,e)},p.floor=function(e){return Math.floor(e)},p.float=function(e){var t;if(1===arguments.length)if("number"==typeof e){if((e+"").indexOf(".")>-1)throw"float() may not accept float arguments.";t=e.toFixed(1)}else if("boolean"==typeof e)t=e===!0?1:0,t=t.toFixed(1);else if("string"==typeof e)e.indexOf(" ")>-1?t=0/0:1===e.length?(t=e.charCodeAt(0),t=t.toFixed(1)):t=parseFloat(e);else if("object"==typeof e&&e.constructor===Array){t=new Array(e.length);for(var r=0;r<e.length;r++)t[r]=p.float(e[r])}return t},p.ceil=function(e){return Math.ceil(e)},p.round=function(e){return Math.round(e)},p.lerp=function(e,t,r){return(t-e)*r+e},p.abs=function(e){return Math.abs(e)},p.cos=function(e){return Math.cos(e)},p.sin=function(e){return Math.sin(e)},p.pow=function(e,t){return Math.pow(e,t)},p.tan=function(e){return Math.tan(e)},p.atan=function(e){return Math.atan(e)},p.atan2=function(e,t){return Math.atan2(e,t)},p.radians=function(e){return e/180*p.PI},p.log=function(e){return Math.log(e)},p.exp=function(e){return Math.exp(e)},p.asin=function(e){return Math.asin(e)},p.acos=function(e){return Math.acos(e)},p.boolean=function(e){var t=!1;if(e&&"number"==typeof e&&0!==e)t=!0;else if(e&&"boolean"==typeof e&&e===!0)t=!0;else if(e&&"string"==typeof e&&"true"===e.toLowerCase())t=!0;else if(e&&"object"==typeof e&&e.constructor===Array){t=new Array(e.length);for(var r=0;r<e.length;r++)t[r]=p.boolean(e[r])}return t},p.dist=function(e,t,r,n){return Math.sqrt(Math.pow(r-e,2)+Math.pow(n-t,2))},p.map=function(e,t,r,n,o){return n+(o-n)*((e-t)/(r-t))},p.mag=function(e,t,r){return 2===arguments.length?Math.sqrt(e*e+t*t):3===arguments.length?Math.sqrt(e*e+t*t+r*r):void 0},p.Random=function(){var e,t=!1;this.nextGaussian=function(){if(t)return t=!1,e;var r,n,o;do r=2*p.random(1)-1,n=2*p.random(1)-1,o=r*r+n*n;while(o>=1||0===o);var s=Math.sqrt(-2*Math.log(o)/o);return e=n*s,t=!0,r*s}},p.byte=function(e){return e||0},p.norm=function(e,t,r){var n=r-t;return 1/n*e-1/n*t},p.random=function(e,t){return 2===arguments.length?e+Math.random()*(t-e):Math.random()*e};var noiseGen=function(e,t){var r=e+57*t;return r=r<<13^r,Math.abs(1-(r*(r*r*15731+789221)+1376312589&2147483647)/1073741824)},smoothedNoise=function(e,t){var r=(noiseGen(e-1,t-1)+noiseGen(e+1,t-1)+noiseGen(e-1,t+1)+noiseGen(e+1,t+1))/16,n=(noiseGen(e-1,t)+noiseGen(e+1,t)+noiseGen(e,t-1)+noiseGen(e,t+1))/8,o=noiseGen(e,t)/4;return r+n+o},interpolate=function(e,t,r){var n=r*p.PI,o=.5*(1-Math.cos(n));return e*(1-o)+t*o},interpolatedNoise=function(e,t){var r=Math.floor(e),n=e-r,o=Math.floor(t),s=t-o,a=smoothedNoise(r,o),i=smoothedNoise(r+1,o),p=smoothedNoise(r,o+1),u=smoothedNoise(r+1,o+1),c=interpolate(a,i,n),l=interpolate(p,u,n);return interpolate(c,l,s)},perlinNoise_2D=function(e,t){for(var r=0,n=.25,o=3,s=0;o>=s;s++){var a=Math.pow(2,s),i=Math.pow(n,s);r+=interpolatedNoise(e*a,t*a)*i}return r},perlinNoise_3D=function(){return 0};p.noise=function(e,t,r){switch(arguments.length){case 2:return perlinNoise_2D(e,t);case 3:return perlinNoise_3D(e,t,r);case 1:return perlinNoise_2D(e,e)}},p.constrain=function(e,t,r){return Math.min(Math.max(e,t),r)},p.degrees=function(e){return e=180*e/p.PI,0>e&&(e=360+e),e},p.size=function(e,t,r){if(!r||"OPENGL"!==r&&"P3D"!==r)"undefined"==typeof curContext&&(curContext=curElement.getContext("2d"));else{try{curContext||(curContext=curElement.getContext("experimental-webgl"))}catch(n){Processing.debug(n)}if(!curContext)throw"OPENGL 3D context is not supported on this browser.";for(var o=0;o<p.SINCOS_LENGTH;o++)sinLUT[o]=p.sin(o*(p.PI/180)*.5),cosLUT[o]=p.cos(o*(p.PI/180)*.5);curContext.viewport(0,0,curElement.width,curElement.height),curContext.clearColor(.8,.8,.8,1),curContext.enable(curContext.DEPTH_TEST),curContext.enable(curContext.BLEND),curContext.blendFunc(curContext.SRC_ALPHA,curContext.ONE_MINUS_SRC_ALPHA);var s=curContext.createShader(curContext.VERTEX_SHADER);if(curContext.shaderSource(s,vertexShaderSource),curContext.compileShader(s),!curContext.getShaderParameter(s,curContext.COMPILE_STATUS))throw curContext.getShaderInfoLog(s);var a=curContext.createShader(curContext.FRAGMENT_SHADER);if(curContext.shaderSource(a,fragmentShaderSource),curContext.compileShader(a),!curContext.getShaderParameter(a,curContext.COMPILE_STATUS))throw curContext.getShaderInfoLog(a);if(programObject=curContext.createProgram(),curContext.attachShader(programObject,s),curContext.attachShader(programObject,a),curContext.linkProgram(programObject),!curContext.getProgramParameter(programObject,curContext.LINK_STATUS))throw"Error linking shaders.";curContext.useProgram(programObject),boxBuffer=curContext.createBuffer(),curContext.bindBuffer(curContext.ARRAY_BUFFER,boxBuffer),curContext.bufferData(curContext.ARRAY_BUFFER,newWebGLArray(boxVerts),curContext.DYNAMIC_DRAW),boxOutlineBuffer=curContext.createBuffer(),curContext.bindBuffer(curContext.ARRAY_BUFFER,boxOutlineBuffer),curContext.bufferData(curContext.ARRAY_BUFFER,newWebGLArray(boxOutlineVerts),curContext.DYNAMIC_DRAW),sphereBuffer=curContext.createBuffer(),curContext.bindBuffer(curContext.ARRAY_BUFFER,sphereBuffer),lineBuffer=curContext.createBuffer(),curContext.bindBuffer(curContext.ARRAY_BUFFER,lineBuffer),pointBuffer=curContext.createBuffer(),curContext.bindBuffer(curContext.ARRAY_BUFFER,pointBuffer),curContext.bufferData(curContext.ARRAY_BUFFER,newWebGLArray([0,0,0]),curContext.STATIC_DRAW),p.camera(),p.perspective(),userMatrixStack=new PMatrix3DStack,p.stroke(0),p.fill(255)}var i={fillStyle:curContext.fillStyle,strokeStyle:curContext.strokeStyle,lineCap:curContext.lineCap,lineJoin:curContext.lineJoin};curElement.width=p.width=e,curElement.height=p.height=t;for(var u in i)i&&(curContext[u]=i[u]);hasBackground&&p.background()};var PVector=function(e,t,r){this.x=e||0,this.y=t||0,this.z=r||0},createPVectorMethod=function(e){return function(t,r){var n=t.get();return n[e](r),n}},createSimplePVectorMethod=function(e){return function(t,r){return t[e](r)}},simplePVMethods="dist dot cross".split(" "),method=simplePVMethods.length;for(PVector.angleBetween=function(e,t){return Math.acos(e.dot(t)/(e.mag()*t.mag()))},PVector.prototype={set:function(e,t,r){1===arguments.length?this.set(e.x||e[0],e.y||e[1],e.z||e[2]):(this.x=e,this.y=t,this.z=r)},get:function(){return new PVector(this.x,this.y,this.z)},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},add:function(e,t,r){3===arguments.length?(this.x+=e,this.y+=t,this.z+=r):1===arguments.length&&(this.x+=e.x,this.y+=e.y,this.z+=e.z)},sub:function(e,t,r){3===arguments.length?(this.x-=e,this.y-=t,this.z-=r):1===arguments.length&&(this.x-=e.x,this.y-=e.y,this.z-=e.z)},mult:function(e){"number"==typeof e?(this.x*=e,this.y*=e,this.z*=e):"object"==typeof e&&(this.x*=e.x,this.y*=e.y,this.z*=e.z)},div:function(e){"number"==typeof e?(this.x/=e,this.y/=e,this.z/=e):"object"==typeof e&&(this.x/=e.x,this.y/=e.y,this.z/=e.z)},dist:function(e){var t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return Math.sqrt(t*t+r*r+n*n)},dot:function(e,t,r){var n;return 3===arguments.length?n=this.x*e+this.y*t+this.z*r:1===arguments.length&&(n=this.x*e.x+this.y*e.y+this.z*e.z),n},cross:function(e){var t=this.y*e.z-e.y*this.z,r=this.z*e.x-e.z*this.x,n=this.x*e.y-e.x*this.y;return new PVector(t,r,n)},normalize:function(){var e=this.mag();e>0&&this.div(e)},limit:function(e){this.mag()>e&&(this.normalize(),this.mult(e))},heading2D:function(){var e=Math.atan2(-this.y,this.x);return-e},toString:function(){return"["+this.x+", "+this.y+", "+this.z+"]"},array:function(){return[this.x,this.y,this.z]}};method--;)PVector[simplePVMethods[method]]=createSimplePVectorMethod(simplePVMethods[method]);for(method in PVector.prototype)PVector.prototype.hasOwnProperty(method)&&!PVector.hasOwnProperty(method)&&(PVector[method]=createPVectorMethod(method));p.PVector=PVector;var PMatrix3D=function(){this.reset()};PMatrix3D.prototype={set:function(){if(16===arguments.length){var e=arguments;this.set([e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]])}else 1===arguments.length&&arguments[0]instanceof PMatrix3D?this.elements=arguments[0].array():1===arguments.length&&arguments[0]instanceof Array&&(this.elements=arguments[0].slice())},get:function(){var e=new PMatrix3D;return e.set(this.elements),e},reset:function(){this.set([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])},array:function(){return this.elements.slice()},translate:function(e,t,r){"undefined"==typeof r&&(e=0),this.elements[3]+=e*this.elements[0]+t*this.elements[1]+r*this.elements[2],this.elements[7]+=e*this.elements[4]+t*this.elements[5]+r*this.elements[6],this.elements[11]+=e*this.elements[8]+t*this.elements[9]+r*this.elements[10],this.elements[15]+=e*this.elements[12]+t*this.elements[13]+r*this.elements[14]},transpose:function(){var e=this.elements.slice();this.elements[0]=e[0],this.elements[1]=e[4],this.elements[2]=e[8],this.elements[3]=e[12],this.elements[4]=e[1],this.elements[5]=e[5],this.elements[6]=e[9],this.elements[7]=e[13],this.elements[8]=e[2],this.elements[9]=e[6],this.elements[10]=e[10],this.elements[11]=e[14],this.elements[12]=e[3],this.elements[13]=e[7],this.elements[14]=e[11],this.elements[15]=e[15]},mult:function(e,t){var r,n,o,s;return e instanceof PVector?(r=e.x,n=e.y,o=e.z,s=1,t||(t=new PVector)):e instanceof Array&&(r=e[0],n=e[1],o=e[2],s=e[3]||1,(!t||3!==t.length&&4!==t.length)&&(t=[0,0,0])),t instanceof Array&&(3===t.length?(t[0]=this.elements[0]*r+this.elements[1]*n+this.elements[2]*o+this.elements[3],t[1]=this.elements[4]*r+this.elements[5]*n+this.elements[6]*o+this.elements[7],t[2]=this.elements[8]*r+this.elements[9]*n+this.elements[10]*o+this.elements[11]):4===t.length&&(t[0]=this.elements[0]*r+this.elements[1]*n+this.elements[2]*o+this.elements[3]*s,t[1]=this.elements[4]*r+this.elements[5]*n+this.elements[6]*o+this.elements[7]*s,t[2]=this.elements[8]*r+this.elements[9]*n+this.elements[10]*o+this.elements[11]*s,t[3]=this.elements[12]*r+this.elements[13]*n+this.elements[14]*o+this.elements[15]*s)),t instanceof PVector&&(t.x=this.elements[0]*r+this.elements[1]*n+this.elements[2]*o+this.elements[3],t.y=this.elements[4]*r+this.elements[5]*n+this.elements[6]*o+this.elements[7],t.z=this.elements[8]*r+this.elements[9]*n+this.elements[10]*o+this.elements[11]),t},preApply:function(){if(1===arguments.length&&arguments[0]instanceof PMatrix3D)this.preApply(arguments[0].array());else if(16===arguments.length){var e=arguments;this.preApply([e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]])}else if(1===arguments.length&&arguments[0]instanceof Array){for(var t=arguments[0],r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n=0,o=0;4>o;o++)for(var s=0;4>s;s++,n++)r[n]+=this.elements[s+0]*t[4*o+0]+this.elements[s+4]*t[4*o+1]+this.elements[s+8]*t[4*o+2]+this.elements[s+12]*t[4*o+3];this.elements=r.slice()}},apply:function(){if(1===arguments.length&&arguments[0]instanceof PMatrix3D)this.apply(arguments[0].array());else if(16===arguments.length){var e=arguments;this.apply([e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]])}else if(1===arguments.length&&arguments[0]instanceof Array){for(var t=arguments[0],r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n=0,o=0;4>o;o++)for(var s=0;4>s;s++,n++)r[n]+=this.elements[4*o+0]*t[s+0]+this.elements[4*o+1]*t[s+4]+this.elements[4*o+2]*t[s+8]+this.elements[4*o+3]*t[s+12];this.elements=r.slice()}},rotate:function(e,t,r,n){if(r){var o=p.cos(e),s=p.sin(e),a=1-o;this.apply(a*t*t+o,a*t*r-s*n,a*t*n+s*r,0,a*t*r+s*n,a*r*r+o,a*r*n-s*t,0,a*t*n-s*r,a*r*n+s*t,a*n*n+o,0,0,0,0,1)}else this.rotateZ(e)},invApply:function(){"undefined"==typeof inverseCopy&&(inverseCopy=new PMatrix3D);var e=arguments;return inverseCopy.set(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]),inverseCopy.invert()?(this.preApply(inverseCopy),!0):!1},rotateX:function(e){var t=p.cos(e),r=p.sin(e);this.apply([1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1])},rotateY:function(e){var t=p.cos(e),r=p.sin(e);this.apply([t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1])},rotateZ:function(e){var t=Math.cos(e),r=Math.sin(e);this.apply([t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1])},scale:function(e,t,r){!e||t||r?e&&t&&!r&&(r=1):t=r=e,e&&t&&r&&(this.elements[0]*=e,this.elements[1]*=t,this.elements[2]*=r,this.elements[4]*=e,this.elements[5]*=t,this.elements[6]*=r,this.elements[8]*=e,this.elements[9]*=t,this.elements[10]*=r,this.elements[12]*=e,this.elements[13]*=t,this.elements[14]*=r)},skewX:function(e){var t=p.tan(e);this.apply(1,t,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},skewY:function(e){var t=Math.tan(e);this.apply(1,0,0,0,t,1,0,0,0,0,1,0,0,0,0,1)},multX:function(e,t,r,n){return r?n?this.elements[0]*e+this.elements[1]*t+this.elements[2]*r+this.elements[3]*n:this.elements[0]*e+this.elements[1]*t+this.elements[2]*r+this.elements[3]:this.elements[0]*e+this.elements[1]*t+this.elements[3]},multY:function(e,t,r,n){return r?n?this.elements[4]*e+this.elements[5]*t+this.elements[6]*r+this.elements[7]*n:this.elements[4]*e+this.elements[5]*t+this.elements[6]*r+this.elements[7]:this.elements[4]*e+this.elements[5]*t+this.elements[7]},multZ:function(e,t,r,n){return n?this.elements[8]*e+this.elements[9]*t+this.elements[10]*r+this.elements[11]*n:this.elements[8]*e+this.elements[9]*t+this.elements[10]*r+this.elements[11]},multW:function(e,t,r,n){return n?this.elements[12]*e+this.elements[13]*t+this.elements[14]*r+this.elements[15]*n:this.elements[12]*e+this.elements[13]*t+this.elements[14]*r+this.elements[15]},invert:function(){var e=[],t=this.elements[0]*this.elements[5]-this.elements[1]*this.elements[4],r=this.elements[0]*this.elements[6]-this.elements[2]*this.elements[4],n=this.elements[0]*this.elements[7]-this.elements[3]*this.elements[4],o=this.elements[1]*this.elements[6]-this.elements[2]*this.elements[5],s=this.elements[1]*this.elements[7]-this.elements[3]*this.elements[5],a=this.elements[2]*this.elements[7]-this.elements[3]*this.elements[6],i=this.elements[8]*this.elements[13]-this.elements[9]*this.elements[12],p=this.elements[8]*this.elements[14]-this.elements[10]*this.elements[12],u=this.elements[8]*this.elements[15]-this.elements[11]*this.elements[12],c=this.elements[9]*this.elements[14]-this.elements[10]*this.elements[13],l=this.elements[9]*this.elements[15]-this.elements[11]*this.elements[13],h=this.elements[10]*this.elements[15]-this.elements[11]*this.elements[14],m=t*h-r*l+n*c+o*u-s*p+a*i;if(Math.abs(m)<=1e-9)return!1;e[0]=+this.elements[5]*h-this.elements[6]*l+this.elements[7]*c,e[4]=-this.elements[4]*h+this.elements[6]*u-this.elements[7]*p,e[8]=+this.elements[4]*l-this.elements[5]*u+this.elements[7]*i,e[12]=-this.elements[4]*c+this.elements[5]*p-this.elements[6]*i,e[1]=-this.elements[1]*h+this.elements[2]*l-this.elements[3]*c,e[5]=+this.elements[0]*h-this.elements[2]*u+this.elements[3]*p,e[9]=-this.elements[0]*l+this.elements[1]*u-this.elements[3]*i,e[13]=+this.elements[0]*c-this.elements[1]*p+this.elements[2]*i,e[2]=+this.elements[13]*a-this.elements[14]*s+this.elements[15]*o,e[6]=-this.elements[12]*a+this.elements[14]*n-this.elements[15]*r,e[10]=+this.elements[12]*s-this.elements[13]*n+this.elements[15]*t,e[14]=-this.elements[12]*o+this.elements[13]*r-this.elements[14]*t,e[3]=-this.elements[9]*a+this.elements[10]*s-this.elements[11]*o,e[7]=+this.elements[8]*a-this.elements[10]*n+this.elements[11]*r,e[11]=-this.elements[8]*s+this.elements[9]*n-this.elements[11]*t,e[15]=+this.elements[8]*o-this.elements[9]*r+this.elements[10]*t;var f=1/m;return e[0]*=f,e[1]*=f,e[2]*=f,e[3]*=f,e[4]*=f,e[5]*=f,e[6]*=f,e[7]*=f,e[8]*=f,e[9]*=f,e[10]*=f,e[11]*=f,e[12]*=f,e[13]*=f,e[14]*=f,e[15]*=f,this.elements=e.slice(),!0},toString:function(){for(var e="",t=0;15>t;t++)e+=this.elements[t]+", ";return e+=this.elements[15]},print:function(){var e="",t=3;e+=p.nfs(this.elements[0],t,4)+" "+p.nfs(this.elements[1],t,4)+" "+p.nfs(this.elements[2],t,4)+" "+p.nfs(this.elements[3],t,4)+"\n",e+=p.nfs(this.elements[4],t,4)+" "+p.nfs(this.elements[5],t,4)+" "+p.nfs(this.elements[6],t,4)+" "+p.nfs(this.elements[7],t,4)+"\n",e+=p.nfs(this.elements[8],t,4)+" "+p.nfs(this.elements[9],t,4)+" "+p.nfs(this.elements[10],t,4)+" "+p.nfs(this.elements[11],t,4)+"\n",e+=p.nfs(this.elements[12],t,4)+" "+p.nfs(this.elements[13],t,4)+" "+p.nfs(this.elements[14],t,4)+" "+p.nfs(this.elements[15],t,4)+"\n",p.println(e)}};var PMatrix3DStack=function(){this.matrixStack=[]};PMatrix3DStack.prototype.load=function(){var e=new PMatrix3D;e.set(1===arguments.length?arguments[0]:arguments),this.matrixStack.push(e)},PMatrix3DStack.prototype.push=function(){this.matrixStack.push(this.peek())},PMatrix3DStack.prototype.pop=function(){return this.matrixStack.pop()},PMatrix3DStack.prototype.peek=function(){var e=new PMatrix3D;return e.set(this.matrixStack[this.matrixStack.length-1]),e},PMatrix3DStack.prototype.mult=function(e){this.matrixStack[this.matrixStack.length-1].apply(e)},p.camera=function(e,t,r,n,o,s,a,i,u){if(0===arguments.length)cameraX=curElement.width/2,cameraY=curElement.height/2,cameraZ=cameraY/Math.tan(cameraFOV/2),p.camera(cameraX,cameraY,cameraZ,cameraX,cameraY,0,0,1,0);else{var c=new p.PVector(e-n,t-o,r-s),l=new p.PVector(a,i,u);c.normalize();var h=p.PVector.cross(l,c);l=p.PVector.cross(c,h),h.normalize(),l.normalize(),cam=new PMatrix3D,cam.set(h.x,h.y,h.z,0,l.x,l.y,l.z,0,c.x,c.y,c.z,0,0,0,0,1),cam.translate(-e,-t,-r),cameraInv=new PMatrix3D,cameraInv.invApply(h.x,h.y,h.z,0,l.x,l.y,l.z,0,c.x,c.y,c.z,0,0,0,0,1),cameraInv.translate(e,t,r),modelView=new PMatrix3D,modelView.set(cam),forwardTransform=modelView,modelViewInv=new PMatrix3D,modelViewInv.set(cameraInv)}},p.perspective=function(e,t,r,n){if(0===arguments.length)cameraY=curElement.height/2,cameraZ=cameraY/Math.tan(cameraFOV/2),cameraNear=cameraZ/10,cameraFar=10*cameraZ,cameraAspect=curElement.width/curElement.height,p.perspective(cameraFOV,cameraAspect,cameraNear,cameraFar);else{var o,s,a,i;o=r*Math.tan(e/2),s=-o,a=o*t,i=s*t,p.frustum(i,a,s,o,r,n)}},p.frustum=function(e,t,r,n,o,s){frustumMode=!0,projection=new PMatrix3D,projection.set(2*o/(t-e),0,(t+e)/(t-e),0,0,2*o/(n-r),(n+r)/(n-r),0,0,0,-(s+o)/(s-o),-(2*s*o)/(s-o),0,0,-1,0)},p.ortho=function(e,t,r,n,o,s){if(0===arguments.length)p.ortho(0,p.width,0,p.height,-10,10);else{var a=2/(t-e),i=2/(n-r),u=-2/(s-o),c=-(t+e)/(t-e),l=-(n+r)/(n-r),h=-(s+o)/(s-o);projection=new PMatrix3D,projection.set(a,0,0,c,0,i,0,l,0,0,u,h,0,0,0,1),frustumMode=!1}},p.printProjection=function(){projection.print()},p.printCamera=function(){cam.print()},p.box=function(e,t,r){var n;if(curContext){t&&r||(t=r=e);var o=new PMatrix3D;o.scale(e,t,r);var s=new PMatrix3D;s.scale(1,-1,1),s.apply(modelView.array()),uniformMatrix(programObject,"model",!0,o.array()),uniformMatrix(programObject,"view",!0,s.array()),uniformMatrix(programObject,"projection",!0,projection.array()),doFill===!0&&(curContext.enable(curContext.POLYGON_OFFSET_FILL),curContext.polygonOffset(1,1),n=fillStyle.slice(5,-1).split(","),uniformf(programObject,"color",[n[0]/255,n[1]/255,n[2]/255,n[3]]),vertexAttribPointer(programObject,"Vertex",3,boxBuffer),curContext.drawArrays(curContext.TRIANGLES,0,boxVerts.length/3),curContext.disable(curContext.POLYGON_OFFSET_FILL)),lineWidth>0&&doStroke&&(n=strokeStyle.slice(5,-1).split(","),uniformf(programObject,"color",[n[0]/255,n[1]/255,n[2]/255,n[3]]),curContext.lineWidth(lineWidth),vertexAttribPointer(programObject,"Vertex",3,boxOutlineBuffer),curContext.drawArrays(curContext.LINES,0,boxOutlineVerts.length/3))}};var initSphere=function(){var e;for(sphereVerts=[],sphereNorms=[],e=0;sphereDetailU>e;e++)sphereNorms.push(0),sphereNorms.push(-1),sphereNorms.push(0),sphereVerts.push(0),sphereVerts.push(-1),sphereVerts.push(0),sphereNorms.push(sphereX[e]),sphereNorms.push(sphereY[e]),sphereNorms.push(sphereZ[e]),sphereVerts.push(sphereX[e]),sphereVerts.push(sphereY[e]),sphereVerts.push(sphereZ[e]);sphereVerts.push(0),sphereVerts.push(-1),sphereVerts.push(0),sphereNorms.push(sphereX[0]),sphereNorms.push(sphereY[0]),sphereNorms.push(sphereZ[0]),sphereVerts.push(sphereX[0]),sphereVerts.push(sphereY[0]),sphereVerts.push(sphereZ[0]);var t,r,n,o=0;for(e=2;sphereDetailV>e;e++){t=r=o,o+=sphereDetailU,n=o;for(var s=0;sphereDetailU>s;s++)sphereNorms.push(parseFloat(sphereX[t])),sphereNorms.push(parseFloat(sphereY[t])),sphereNorms.push(parseFloat(sphereZ[t])),sphereVerts.push(parseFloat(sphereX[t])),sphereVerts.push(parseFloat(sphereY[t])),sphereVerts.push(parseFloat(sphereZ[t++])),sphereNorms.push(parseFloat(sphereX[n])),sphereNorms.push(parseFloat(sphereY[n])),sphereNorms.push(parseFloat(sphereZ[n])),sphereVerts.push(parseFloat(sphereX[n])),sphereVerts.push(parseFloat(sphereY[n])),sphereVerts.push(parseFloat(sphereZ[n++]));t=r,n=o,sphereNorms.push(parseFloat(sphereX[t])),sphereNorms.push(parseFloat(sphereY[t])),sphereNorms.push(parseFloat(sphereZ[t])),sphereVerts.push(parseFloat(sphereX[t])),sphereVerts.push(parseFloat(sphereY[t])),sphereVerts.push(parseFloat(sphereZ[t])),sphereNorms.push(parseFloat(sphereX[n])),sphereNorms.push(parseFloat(sphereY[n])),sphereNorms.push(parseFloat(sphereZ[n])),sphereVerts.push(parseFloat(sphereX[n])),sphereVerts.push(parseFloat(sphereY[n])),sphereVerts.push(parseFloat(sphereZ[n]))}for(e=0;sphereDetailU>e;e++)n=o+e,sphereNorms.push(parseFloat(sphereX[n])),sphereNorms.push(parseFloat(sphereY[n])),sphereNorms.push(parseFloat(sphereZ[n])),sphereVerts.push(parseFloat(sphereX[n])),sphereVerts.push(parseFloat(sphereY[n])),sphereVerts.push(parseFloat(sphereZ[n])),sphereNorms.push(0),sphereNorms.push(1),sphereNorms.push(0),sphereVerts.push(0),sphereVerts.push(1),sphereVerts.push(0);sphereNorms.push(parseFloat(sphereX[o])),sphereNorms.push(parseFloat(sphereY[o])),sphereNorms.push(parseFloat(sphereZ[o])),sphereVerts.push(parseFloat(sphereX[o])),sphereVerts.push(parseFloat(sphereY[o])),sphereVerts.push(parseFloat(sphereZ[o])),sphereNorms.push(0),sphereNorms.push(1),sphereNorms.push(0),sphereVerts.push(0),sphereVerts.push(1),sphereVerts.push(0),vertexAttribPointer(programObject,"Vertex",3,sphereBuffer),curContext.bufferData(curContext.ARRAY_BUFFER,newWebGLArray(sphereVerts),curContext.STATIC_DRAW)};p.sphereDetail=function(e,t){var r;if(1===arguments.length&&(e=t=arguments[0]),3>e&&(e=3),2>t&&(t=2),e!==sphereDetailU||t!==sphereDetailV){var n=p.SINCOS_LENGTH/e,o=new Array(e),s=new Array(e);for(r=0;e>r;r++)o[r]=cosLUT[parseInt(r*n%p.SINCOS_LENGTH,10)],s[r]=sinLUT[parseInt(r*n%p.SINCOS_LENGTH,10)];var a=e*(t-1)+2,i=0;sphereX=new Array(a),sphereY=new Array(a),sphereZ=new Array(a);var u=.5*p.SINCOS_LENGTH/t,c=u;for(r=1;t>r;r++){for(var l=sinLUT[parseInt(c%p.SINCOS_LENGTH,10)],h=-cosLUT[parseInt(c%p.SINCOS_LENGTH,10)],m=0;e>m;m++)sphereX[i]=o[m]*l,sphereY[i]=h,sphereZ[i++]=s[m]*l;c+=u}sphereDetailU=e,sphereDetailV=t,initSphere()}},p.sphere=function(){if(p.use3DContext){var e,t=arguments[0];(3>sphereDetailU||2>sphereDetailV)&&p.sphereDetail(30);var r=new PMatrix3D;r.scale(t,t,t);var n=new PMatrix3D;n.scale(1,-1,1),n.apply(modelView.array()),uniformMatrix(programObject,"model",!0,r.array()),uniformMatrix(programObject,"view",!0,n.array()),uniformMatrix(programObject,"projection",!0,projection.array()),vertexAttribPointer(programObject,"Vertex",3,sphereBuffer),doFill===!0&&(curContext.enable(curContext.POLYGON_OFFSET_FILL),curContext.polygonOffset(1,1),e=fillStyle.slice(5,-1).split(","),uniformf(programObject,"color",[e[0]/255,e[1]/255,e[2]/255,e[3]]),curContext.drawArrays(curContext.TRIANGLE_STRIP,0,sphereVerts.length/3),curContext.disable(curContext.POLYGON_OFFSET_FILL)),lineWidth>0&&doStroke&&(e=strokeStyle.slice(5,-1).split(","),uniformf(programObject,"color",[e[0]/255,e[1]/255,e[2]/255,e[3]]),curContext.lineWidth(lineWidth),curContext.drawArrays(curContext.LINE_STRIP,0,sphereVerts.length/3))}},p.modelX=function(e,t,r){var n=modelView.array(),o=cameraInv.array(),s=n[0]*e+n[1]*t+n[2]*r+n[3],a=n[4]*e+n[5]*t+n[6]*r+n[7],i=n[8]*e+n[9]*t+n[10]*r+n[11],p=n[12]*e+n[13]*t+n[14]*r+n[15],u=o[0]*s+o[1]*a+o[2]*i+o[3]*p,c=o[12]*s+o[13]*a+o[14]*i+o[15]*p;return 0!==c?u/c:u},p.modelY=function(e,t,r){var n=modelView.array(),o=cameraInv.array(),s=n[0]*e+n[1]*t+n[2]*r+n[3],a=n[4]*e+n[5]*t+n[6]*r+n[7],i=n[8]*e+n[9]*t+n[10]*r+n[11],p=n[12]*e+n[13]*t+n[14]*r+n[15],u=o[4]*s+o[5]*a+o[6]*i+o[7]*p,c=o[12]*s+o[13]*a+o[14]*i+o[15]*p;return 0!==c?u/c:u},p.modelZ=function(e,t,r){var n=modelView.array(),o=cameraInv.array(),s=n[0]*e+n[1]*t+n[2]*r+n[3],a=n[4]*e+n[5]*t+n[6]*r+n[7],i=n[8]*e+n[9]*t+n[10]*r+n[11],p=n[12]*e+n[13]*t+n[14]*r+n[15],u=o[8]*s+o[9]*a+o[10]*i+o[11]*p,c=o[12]*s+o[13]*a+o[14]*i+o[15]*p;return 0!==c?u/c:u},p.fill=function(){doFill=!0,p.use3DContext?fillStyle=p.color.apply(this,arguments):curContext.fillStyle=p.color.apply(this,arguments)},p.noFill=function(){doFill=!1},p.stroke=function(){doStroke=!0,p.use3DContext?strokeStyle=p.color.apply(this,arguments):curContext.strokeStyle=p.color.apply(this,arguments)},p.noStroke=function(){doStroke=!1},p.strokeWeight=function(e){p.use3DContext?lineWidth=e:curContext.lineWidth=e},p.strokeCap=function(e){curContext.lineCap=e},p.strokeJoin=function(e){curContext.lineJoin=e},p.smooth=function(){},p.noSmooth=function(){},p.Point=function o(e,t){this.x=e,this.y=t,this.copy=function(){return new o(e,t)}},p.point=function(e,t,r){if(p.use3DContext){var n=new PMatrix3D;n.translate(e,t,r||0);var o=new PMatrix3D;if(o.scale(1,-1,1),o.apply(modelView.array()),uniformMatrix(programObject,"model",!0,n.array()),uniformMatrix(programObject,"view",!0,o.array()),uniformMatrix(programObject,"projection",!0,projection.array()),lineWidth>0&&doStroke){var s=strokeStyle.slice(5,-1).split(",");uniformf(programObject,"color",[s[0]/255,s[1]/255,s[2]/255,s[3]]),vertexAttribPointer(programObject,"Vertex",3,pointBuffer),curContext.drawArrays(curContext.POINTS,0,1)}}else{var a=curContext.fillStyle;curContext.fillStyle=curContext.strokeStyle,curContext.fillRect(Math.round(e),Math.round(t),1,1),curContext.fillStyle=a}},p.beginShape=function(e){curShape=e,curShapeCount=0,curvePoints=[]},p.endShape=function(e){0!==curShapeCount&&(e&&doFill&&curContext.lineTo(firstX,firstY),doFill&&curContext.fill(),doStroke&&curContext.stroke(),curContext.closePath(),curShapeCount=0,pathOpen=!1),pathOpen&&(doFill&&curContext.fill(),doStroke&&curContext.stroke(),curContext.closePath(),curShapeCount=0,pathOpen=!1)},p.vertex=function(e,t,r,n,o,s){0===curShapeCount&&curShape!==p.POINTS?(pathOpen=!0,curContext.beginPath(),curContext.moveTo(e,t),firstX=e,firstY=t):curShape===p.POINTS?p.point(e,t):2===arguments.length?((curShape!==p.QUAD_STRIP||2!==curShapeCount)&&curContext.lineTo(e,t),curShape===p.TRIANGLE_STRIP&&(2===curShapeCount&&(p.endShape(p.CLOSE),pathOpen=!0,curContext.beginPath(),curContext.moveTo(prevX,prevY),curContext.lineTo(e,t),curShapeCount=1),firstX=prevX,firstY=prevY),curShape===p.TRIANGLE_FAN&&2===curShapeCount&&(p.endShape(p.CLOSE),pathOpen=!0,curContext.beginPath(),curContext.moveTo(firstX,firstY),curContext.lineTo(e,t),curShapeCount=1),curShape===p.QUAD_STRIP&&3===curShapeCount&&(curContext.lineTo(prevX,prevY),p.endShape(p.CLOSE),pathOpen=!0,curContext.beginPath(),curContext.moveTo(prevX,prevY),curContext.lineTo(e,t),curShapeCount=1),curShape===p.QUAD_STRIP&&(firstX=secondX,firstY=secondY,secondX=prevX,secondY=prevY)):4===arguments.length?curShapeCount>1&&(curContext.moveTo(prevX,prevY),curContext.quadraticCurveTo(firstX,firstY,e,t),curShapeCount=1):6===arguments.length&&curContext.bezierCurveTo(e,t,r,n,o,s),prevX=e,prevY=t,curShapeCount++,(curShape===p.LINES&&2===curShapeCount||curShape===p.TRIANGLES&&3===curShapeCount||curShape===p.QUADS&&4===curShapeCount)&&p.endShape(p.CLOSE)},p.curveVertex=function(e,t){if(curvePoints.length<3)curvePoints.push([e,t]);else{var r=[],n=1-curTightness;curvePoints.push([e,t]),r[0]=[curvePoints[1][0],curvePoints[1][1]],r[1]=[curvePoints[1][0]+(n*curvePoints[2][0]-n*curvePoints[0][0])/6,curvePoints[1][1]+(n*curvePoints[2][1]-n*curvePoints[0][1])/6],r[2]=[curvePoints[2][0]+(n*curvePoints[1][0]-n*curvePoints[3][0])/6,curvePoints[2][1]+(n*curvePoints[1][1]-n*curvePoints[3][1])/6],r[3]=[curvePoints[2][0],curvePoints[2][1]],pathOpen?curShapeCount=1:p.vertex(r[0][0],r[0][1]),p.vertex(r[1][0],r[1][1],r[2][0],r[2][1],r[3][0],r[3][1]),curvePoints.shift()}},p.curve=function(e,t,r,n,o,s,a,i){p.beginShape(),p.curveVertex(e,t),p.curveVertex(r,n),p.curveVertex(o,s),p.curveVertex(a,i),p.endShape()},p.curveTightness=function(e){curTightness=e},p.bezierVertex=p.vertex,p.rectMode=function(e){curRectMode=e},p.imageMode=function(){},p.ellipseMode=function(e){curEllipseMode=e},p.arc=function(e,t,r,n,o,s){0>=r||(curEllipseMode===p.CORNER&&(e+=r/2,t+=n/2),curContext.moveTo(e,t),curContext.beginPath(),curContext.arc(e,t,curEllipseMode===p.CENTER_RADIUS?r:r/2,o,s,!1),doStroke&&curContext.stroke(),curContext.lineTo(e,t),doFill&&curContext.fill(),curContext.closePath())},p.line=function(){var e,t,r,n,o,s;if(p.use3DContext){6===arguments.length?(e=arguments[0],t=arguments[1],r=arguments[2],n=arguments[3],o=arguments[4],s=arguments[5]):4===arguments.length&&(e=arguments[0],t=arguments[1],r=0,n=arguments[2],o=arguments[3],s=0);var a=[e,t,r,n,o,s],i=new PMatrix3D,u=new PMatrix3D;if(u.scale(1,-1,1),u.apply(modelView.array()),uniformMatrix(programObject,"model",!0,i.array()),uniformMatrix(programObject,"view",!0,u.array()),uniformMatrix(programObject,"projection",!0,projection.array()),lineWidth>0&&doStroke){var c=strokeStyle.slice(5,-1).split(",");uniformf(programObject,"color",[c[0]/255,c[1]/255,c[2]/255,c[3]]),curContext.lineWidth(lineWidth),vertexAttribPointer(programObject,"Vertex",3,lineBuffer),curContext.bufferData(curContext.ARRAY_BUFFER,newWebGLArray(a),curContext.STREAM_DRAW),curContext.drawArrays(curContext.LINES,0,2)}}else e=arguments[0],t=arguments[1],n=arguments[2],o=arguments[3],curContext.beginPath(),curContext.moveTo(e||0,t||0),curContext.lineTo(n||0,o||0),curContext.stroke(),curContext.closePath()},p.bezier=function(e,t,r,n,o,s,a,i){curContext.beginPath(),curContext.moveTo(e,t),curContext.bezierCurveTo(r,n,o,s,a,i),curContext.stroke(),curContext.closePath()},p.bezierPoint=function(e,t,r,n,o){return(1-o)*(1-o)*(1-o)*e+3*(1-o)*(1-o)*o*t+3*(1-o)*o*o*r+o*o*o*n},p.bezierTangent=function(e,t,r,n,o){return 3*o*o*(-e+3*t-3*r+n)+6*o*(e-2*t+r)+3*(-e+t)},p.curvePoint=function(e,t,r,n,o){return.5*(2*t+(-e+r)*o+(2*e-5*t+4*r-n)*o*o+(-e+3*t-3*r+n)*o*o*o)},p.curveTangent=function(e,t,r,n,o){return.5*(-e+r+2*(2*e-5*t+4*r-n)*o+3*(-e+3*t-3*r+n)*o*o)},p.triangle=function(e,t,r,n,o,s){p.beginShape(),p.vertex(e,t),p.vertex(r,n),p.vertex(o,s),p.endShape()
},p.quad=function(e,t,r,n,o,s,a,i){curContext.lineCap="square",p.beginShape(),p.vertex(e,t),p.vertex(r,n),p.vertex(o,s),p.vertex(a,i),p.endShape()},p.rect=function(e,t,r,n){if(r||n){curContext.beginPath();var o=0,s=0;curRectMode===p.CORNERS&&(r-=e,n-=t),curRectMode===p.RADIUS&&(r*=2,n*=2),(curRectMode===p.CENTER||curRectMode===p.RADIUS)&&(e-=r/2,t-=n/2),curContext.rect(Math.round(e)-o,Math.round(t)-o,Math.round(r)+s,Math.round(n)+s),doFill&&curContext.fill(),doStroke&&curContext.stroke(),curContext.closePath()}},p.ellipse=function(e,t,r,n){if(e=e||0,t=t||0,!(0>=r&&0>=n)){curContext.beginPath(),curEllipseMode===p.RADIUS&&(r*=2,n*=2),curEllipseMode===p.CORNERS&&(r-=e,n-=t),(curEllipseMode===p.CORNER||curEllipseMode===p.CORNERS)&&(e+=r/2,t+=n/2);var o=0;if(r===n)curContext.arc(e-o,t-o,r/2,0,p.TWO_PI,!1);else{var s=r/2,a=n/2,i=.5522847498307933,u=i*s,c=i*a;curContext.moveTo(e+s,t),curContext.bezierCurveTo(e+s,t-c,e+u,t-a,e,t-a),curContext.bezierCurveTo(e-u,t-a,e-s,t-c,e-s,t),curContext.bezierCurveTo(e-s,t+c,e-u,t+a,e,t+a),curContext.bezierCurveTo(e+u,t+a,e+s,t+c,e+s,t)}doFill&&curContext.fill(),doStroke&&curContext.stroke(),curContext.closePath()}},p.normal=function(e,t,r){if(3!==arguments.length||"number"!=typeof e||"number"!=typeof t||"number"!=typeof r)throw"normal() requires three numeric arguments.";normalX=e,normalY=t,normalZ=r,0!==curShape&&(normalMode===p.NORMAL_MODE_AUTO?normalMode=p.NORMAL_MODE_SHAPE:normalMode===p.NORMAL_MODE_SHAPE&&(normalMode=p.NORMAL_MODE_VERTEX))},p.save=function(){};var buildImageObject=function(e){var t=e.data,r=p.createImage(e.width,e.height),n=t.length;if(Object.defineProperty&&Object.getOwnPropertyDescriptor&&!Object.getOwnPropertyDescriptor(r,"pixels").get||r.__defineGetter__&&r.__lookupGetter__&&!r.__lookupGetter__("pixels")){var o,s=function(){if(o)return o;o=[];for(var e=0;n>e;e+=4)o.push(p.color(t[e],t[e+1],t[e+2],t[e+3]));return o};Object.defineProperty?Object.defineProperty(r,"pixels",{get:s}):r.__defineGetter__&&r.__defineGetter__("pixels",s)}else{r.pixels=[];for(var a=0;n>a;a+=4)r.pixels.push(p.color(t[a],t[a+1],t[a+2],t[a+3]))}return r};p.loadImage=function(e,t,r){var n=document.createElement("img");return n.loaded=!1,n.mask=function(){},n.onload=function(){var e=this.height,t=this.width,o=document.createElement("canvas");o.width=t,o.height=e;var s=o.getContext("2d");s.drawImage(this,0,0),this.data=buildImageObject(s.getImageData(0,0,t,e)),this.data.img=n,this.get=this.data.get,this.pixels=this.data.pixels,this.loaded=!0,r&&r()},n.src=e,n},p.get=function(e,t){if(!arguments.length){var r=p.createGraphics(p.width,p.height);return r.image(curContext,0,0),r}return getLoaded||(getLoaded=buildImageObject(curContext.getImageData(0,0,p.width,p.height))),getLoaded.get(e,t)},p.createGraphics=function(e,t){var r=document.createElement("canvas"),n=Processing.build(r);return n.size(e,t),n.canvas=r,n},p.set=function(e,t,r){if(r&&r.img)p.image(r,e,t);else{var n=curContext.fillStyle,o=r;curContext.fillStyle=o,curContext.fillRect(Math.round(e),Math.round(t),1,1),curContext.fillStyle=n}},p.loadPixels=function(){p.pixels=buildImageObject(curContext.getImageData(0,0,p.width,p.height)).pixels},p.updatePixels=function(){var e=/(\d+),(\d+),(\d+),(\d+)/,t={};t.width=p.width,t.height=p.height,t.data=[],curContext.createImageData&&(t=curContext.createImageData(p.width,p.height));for(var r=t.data,n=0,o=0,s=p.pixels.length;s>o;o++){var a=(p.pixels[o]||"rgba(0,0,0,1)").match(e);r[n+0]=parseInt(a[1],10),r[n+1]=parseInt(a[2],10),r[n+2]=parseInt(a[3],10),r[n+3]=255*parseFloat(a[4]),n+=4}curContext.putImageData(t,0,0)},p.background=function(e){var t,r;if(p.use3DContext){var n=arguments;1===arguments.length?"string"==typeof arguments[0]?(t=arguments[0].slice(5,-1).split(","),curContext.clearColor(t[0]/255,t[1]/255,t[2]/255,t[3])):"number"==typeof arguments[0]&&curContext.clearColor(n[0]/255,n[0]/255,n[0]/255,1):2===arguments.length?"string"==typeof arguments[0]?(t=arguments[0].slice(5,-1).split(","),curContext.clearColor(t[0]/255,t[1]/255,t[2]/255,1)):"number"==typeof arguments[0]&&(t=arguments[0]/255,r=1,curContext.clearColor(t,t,t,r)):(3===arguments.length||4===arguments.length)&&curContext.clearColor(n[0]/255,n[1]/255,n[2]/255,1)}else if(arguments.length&&(curBackground=e.data&&e.data.img?e.data:p.color.apply(this,arguments)),curBackground.img)p.image(e,0,0);else{var o=curContext.fillStyle;curContext.fillStyle=curBackground+"",curContext.fillRect(0,0,p.width,p.height),curContext.fillStyle=o}hasBackground=!0};var getImage_old=function(e){if("string"==typeof e)return document.getElementById(e);if(e.img||e.canvas)return e.img||e.canvas;for(var t=0,r=e.pixels.length;r>t;t++){var n=4*t,o=(e.pixels[t]||"rgba(0,0,0,1)").slice(5,-1).split(",");e.data[n+0]=parseInt(o[0],10),e.data[n+1]=parseInt(o[1],10),e.data[n+2]=parseInt(o[2],10),e.data[n+3]=100*parseFloat(o[3])}var s=document.createElement("canvas");s.width=e.width,s.height=e.height;var a=s.getContext("2d");return a.putImageData(e,0,0),e.canvas=s,s};return p.AniSprite=function(e,t){this.images=[],this.pos=0;for(var r=0;t>r;r++)this.images.push(e+p.nf(r,(""+t).length)+".gif");this.display=function(e,r){p.image_old(this.images[this.pos],e,r),++this.pos>=t&&(this.pos=0)},this.getWidth=function(){return getImage_old(this.images[0]).width},this.getHeight=function(){return getImage_old(this.images[0]).height}},p.createImage=function(e,t){var r={};return r.width=e,r.height=t,r.data=[],curContext.createImageData&&(r=curContext.createImageData(e,t)),r.pixels=new Array(e*t),r.get=function(t,r){return this.pixels[e*r+t]},r._mask=null,r.mask=function(e){this._mask=e},r.loadPixels=function(){},r.updatePixels=function(){},r},p.image_old=function(e,t,r,n,o){t=t||0,r=r||0;var s,a=getImage(e);if(curTint>=0&&(s=curContext.globalAlpha,curContext.globalAlpha=curTint/opacityRange),3===arguments.length?curContext.drawImage(a,t,r):curContext.drawImage(a,t,r,n,o),curTint>=0&&(curContext.globalAlpha=s),e._mask){var i=curContext.globalCompositeOperation;curContext.globalCompositeOperation="darker",p.image(e._mask,t,r),curContext.globalCompositeOperation=i}},p.image=function(e,t,r,n,o){if(e.data||e.canvas){t=t||0,r=r||0;var s,a=getImage(e.data||e.canvas);if(curTint>=0&&(s=curContext.globalAlpha,curContext.globalAlpha=curTint/opacityRange),3===arguments.length?curContext.drawImage(a,t,r):curContext.drawImage(a,t,r,n,o),curTint>=0&&(curContext.globalAlpha=s),e._mask){var i=curContext.globalCompositeOperation;curContext.globalCompositeOperation="darker",p.image(e._mask,t,r),curContext.globalCompositeOperation=i}}},p.clear=function(e,t,r,n){0===arguments.length?curContext.clearRect(0,0,p.width,p.height):curContext.clearRect(e,t,r,n)},p.tint=function(e,t){curTint=t},p.loadFont=function(e){if(-1===e.indexOf(".svg"))return{name:e,width:function(e){return curContext.mozMeasureText?curContext.mozMeasureText("number"==typeof e?String.fromCharCode(e):e)/curTextSize:0}};var t=p.loadGlyphs(e);return{name:e,glyph:!0,units_per_em:t.units_per_em,horiz_adv_x:1/t.units_per_em*t.horiz_adv_x,ascent:t.ascent,descent:t.descent,width:function(t){for(var r=0,n=t.length,o=0;n>o;o++)try{r+=parseFloat(p.glyphLook(p.glyphTable[e],t[o]).horiz_adv_x)}catch(s){Processing.debug(s)}return r/p.glyphTable[e].units_per_em}}},p.createFont=function(){},p.textFont=function(e,t){curTextFont=e,p.textSize(t)},p.textSize=function(e){e&&(curTextSize=e)},p.textAlign=function(){},p.glyphLook=function(e,t){try{switch(t){case"1":return e.one;case"2":return e.two;case"3":return e.three;case"4":return e.four;case"5":return e.five;case"6":return e.six;case"7":return e.seven;case"8":return e.eight;case"9":return e.nine;case"0":return e.zero;case" ":return e.space;case"$":return e.dollar;case"!":return e.exclam;case'"':return e.quotedbl;case"#":return e.numbersign;case"%":return e.percent;case"&":return e.ampersand;case"'":return e.quotesingle;case"(":return e.parenleft;case")":return e.parenright;case"*":return e.asterisk;case"+":return e.plus;case",":return e.comma;case"-":return e.hyphen;case".":return e.period;case"/":return e.slash;case"_":return e.underscore;case":":return e.colon;case";":return e.semicolon;case"<":return e.less;case"=":return e.equal;case">":return e.greater;case"?":return e.question;case"@":return e.at;case"[":return e.bracketleft;case"\\":return e.backslash;case"]":return e.bracketright;case"^":return e.asciicircum;case"`":return e.grave;case"{":return e.braceleft;case"|":return e.bar;case"}":return e.braceright;case"~":return e.asciitilde;default:return e[t]}}catch(r){Processing.debug(r)}},p.text=function(e,t,r){if("number"==typeof e&&(e+"").indexOf(".")>=0?(1e3*e-Math.floor(1e3*e)===.5&&(e-=1e-4),e=e.toFixed(3)):0===e&&(e=e.toString()),curTextFont.glyph){var n=p.glyphTable[curTextFont.name];curContext.save(),curContext.translate(t,r+curTextSize);var o=n.units_per_em,s=1/o*curTextSize;curContext.scale(s,s);for(var a=e.length,i=0;a>i;i++)try{p.glyphLook(n,e[i]).draw()}catch(u){Processing.debug(u)}curContext.restore()}else e&&(curContext.fillText||curContext.mozDrawText)&&(curContext.save(),curContext.font=curContext.mozTextStyle=curTextSize+"px "+curTextFont.name,curContext.fillText?curContext.fillText(e,t,r):curContext.mozDrawText&&(curContext.translate(t,r),curContext.mozDrawText(e)),curContext.restore())},p.loadGlyphs=function loadGlyph(url){var x,y,cx,cy,nx,ny,d,a,lastCom,lenC,horiz_adv_x,getXY="[0-9\\-]+",path,regex=function(e,t){var r,n=0,o=[],s=new RegExp(e,"g");for(r=o[n]=s.exec(t);r;)n++,r=o[n]=s.exec(t);return o},buildPath=function(e){var t=regex("[A-Za-z][0-9\\- ]+|Z",e);path="var path={draw:function(){curContext.beginPath();curContext.save();",x=0,y=0,cx=0,cy=0,nx=0,ny=0,e=0,a=0,lastCom="",lenC=t.length-1;for(var r=0;lenC>r;r++){var n=t[r][0],o=regex(getXY,n);switch(n[0]){case"M":x=parseFloat(o[0][0]),y=parseFloat(o[1][0]),path+="curContext.moveTo("+x+","+-y+");";break;case"L":x=parseFloat(o[0][0]),y=parseFloat(o[1][0]),path+="curContext.lineTo("+x+","+-y+");";break;case"H":x=parseFloat(o[0][0]),path+="curContext.lineTo("+x+","+-y+");";break;case"V":y=parseFloat(o[0][0]),path+="curContext.lineTo("+x+","+-y+");";break;case"T":nx=parseFloat(o[0][0]),ny=parseFloat(o[1][0]),"Q"===lastCom||"T"===lastCom?(e=Math.sqrt(Math.pow(x-cx,2)+Math.pow(cy-y,2)),a=Math.PI+Math.atan2(cx-x,cy-y),cx=x+Math.sin(a)*e,cy=y+Math.cos(a)*e):(cx=x,cy=y),path+="curContext.quadraticCurveTo("+cx+","+-cy+","+nx+","+-ny+");",x=nx,y=ny;break;case"Q":cx=parseFloat(o[0][0]),cy=parseFloat(o[1][0]),nx=parseFloat(o[2][0]),ny=parseFloat(o[3][0]),path+="curContext.quadraticCurveTo("+cx+","+-cy+","+nx+","+-ny+");",x=nx,y=ny;break;case"Z":path+="curContext.closePath();"}lastCom=n[0]}return path+="doStroke?curContext.stroke():0;",path+="doFill?curContext.fill():0;",path+="curContext.restore();",path+="curContext.translate("+horiz_adv_x+",0);",path+="}}"},parseSVGFont=function parseSVGFontse(svg){var font=svg.getElementsByTagName("font");p.glyphTable[url].horiz_adv_x=font[0].getAttribute("horiz-adv-x");var font_face=svg.getElementsByTagName("font-face")[0];p.glyphTable[url].units_per_em=parseFloat(font_face.getAttribute("units-per-em")),p.glyphTable[url].ascent=parseFloat(font_face.getAttribute("ascent")),p.glyphTable[url].descent=parseFloat(font_face.getAttribute("descent"));for(var glyph=svg.getElementsByTagName("glyph"),len=glyph.length,i=0;len>i;i++){var unicode=glyph[i].getAttribute("unicode"),name=glyph[i].getAttribute("glyph-name");horiz_adv_x=glyph[i].getAttribute("horiz-adv-x"),null===horiz_adv_x&&(horiz_adv_x=p.glyphTable[url].horiz_adv_x),d=glyph[i].getAttribute("d"),void 0!==d&&(path=buildPath(d),eval(path),p.glyphTable[url][name]={name:name,unicode:unicode,horiz_adv_x:horiz_adv_x,draw:path.draw})}},loadXML=function(){var e;try{e=document.implementation.createDocument("","",null)}catch(t){return void Processing.debug(t.message)}try{e.async=!1,e.load(url),parseSVGFont(e.getElementsByTagName("svg")[0])}catch(r){Processing.debug(r);try{var n=new window.XMLHttpRequest;n.open("GET",url,!1),n.send(null),parseSVGFont(n.responseXML.documentElement)}catch(o){Processing.debug(r)}}};return p.glyphTable[url]={},loadXML(url),p.glyphTable[url]},p.extendClass=function(e,t,r){3===arguments.length?r.apply(e,t):t.call(e)},p.addMethod=function(e,t,r){if(e[t]){var n=r.length,o=e[t];e[t]=function(){return arguments.length===n?r.apply(this,arguments):o.apply(this,arguments)}}else e[t]=r},p.init=function init(code){function attach(e,t,r){e.addEventListener?e.addEventListener(t,r,!1):e.attachEvent("on"+t,r)}if(code){var parsedCode=Processing.parse(code,p);p.use3DContext||(curContext=curElement.getContext("2d"),curContext.translate(.5,.5),curContext.lineCap="round",p.stroke(0),p.fill(255),p.disableContextMenu());for(var i in Processing.lib)Processing.lib&&Processing.lib[i].call(p);!function(processing){with(processing)eval(parsedCode)}(p)}p.setup&&(inSetup=!0,p.setup()),inSetup=!1,p.draw&&(doLoop?p.loop():p.redraw()),attach(curElement,"mousemove",function(e){p.pmouseX=p.mouseX,p.pmouseY=p.mouseY;var t=null!==window.scrollX&&"undefined"!=typeof window.scrollX?window.scrollX:window.pageXOffset,r=null!==window.scrollY&&"undefined"!=typeof window.scrollY?window.scrollY:window.pageYOffset;p.mouseX=e.clientX-curElement.offsetLeft+t,p.mouseY=e.clientY-curElement.offsetTop+r,p.cursor(curCursor),p.mouseMoved&&!mousePressed&&p.mouseMoved(),mousePressed&&p.mouseDragged&&(p.mouseDragged(),p.mouseDragging=!0)}),attach(curElement,"mouseout",function(){document.body.style.cursor=oldCursor}),attach(curElement,"mousedown",function(e){switch(mousePressed=!0,p.mouseDragging=!1,e.which){case 1:p.mouseButton=p.LEFT;break;case 2:p.mouseButton=p.CENTER;break;case 3:p.mouseButton=p.RIGHT}p.mouseDown=!0,"function"==typeof p.mousePressed?p.mousePressed():p.mousePressed=!0}),attach(curElement,"mouseup",function(){mousePressed=!1,p.mouseClicked&&!p.mouseDragging&&p.mouseClicked(),"function"!=typeof p.mousePressed&&(p.mousePressed=!1),p.mouseReleased&&p.mouseReleased()}),attach(document,"keydown",function(e){if(keyPressed=!0,p.keyCode=null,p.key=e.keyCode,e.keyCode>=65&&e.keyCode<=90)e.shiftKey||(p.key+=32);else if(e.keyCode>=48&&e.keyCode<=57){if(e.shiftKey)switch(e.keyCode){case 49:p.key=33;break;case 50:p.key=64;break;case 51:p.key=35;break;case 52:p.key=36;break;case 53:p.key=37;break;case 54:p.key=94;break;case 55:p.key=38;break;case 56:p.key=42;break;case 57:p.key=40;break;case 48:p.key=41}}else if(codedKeys.indexOf(e.keyCode)>=0)p.key=p.CODED,p.keyCode=e.keyCode;else if(e.shiftKey)switch(e.keyCode){case 107:p.key=43;break;case 219:p.key=123;break;case 221:p.key=125;break;case 222:p.key=34}else switch(e.keyCode){case 188:p.key=44;break;case 109:p.key=45;break;case 190:p.key=46;break;case 191:p.key=47;break;case 192:p.key=96;break;case 219:p.key=91;break;case 220:p.key=92;break;case 221:p.key=93;break;case 222:p.key=39}"function"==typeof p.keyPressed?p.keyPressed():p.keyPressed=!0}),attach(document,"keyup",function(){keyPressed=!1,"function"!=typeof p.keyPressed&&(p.keyPressed=!1),p.keyReleased&&p.keyReleased()})},p}}();