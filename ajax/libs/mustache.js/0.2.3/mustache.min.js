var Mustache=function(){var e=function(){};return e.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":!0},render:function(e,t,r,n){if(-1==e.indexOf(this.otag))return n?e:void this.send(e);n||(this.buffer=[]),e=this.render_pragmas(e);var i=this.render_section(e,t,r);return n?this.render_tags(i,t,r,n):void this.render_tags(i,t,r,n)},send:function(e){""!=e&&this.buffer.push(e)},render_pragmas:function(e){if(-1==e.indexOf(this.otag+"%"))return e;var t=this,r=new RegExp(this.otag+"%([\\w_-]+) ?([\\w]+=[\\w]+)?"+this.ctag);return e.replace(r,function(e,r,n){if(!t.pragmas_implemented[r])throw{message:"This implementation of mustache doesn't understand the '"+r+"' pragma"};if(t.pragmas[r]={},n){var i=n.split("=");t.pragmas[r][i[0]]=i[1]}return""})},render_partial:function(e,t,r){if(!r||!r[e])throw{message:"unknown_partial '"+e+"'"};return"object"!=typeof t[e]?r[e]:this.render(r[e],t[e],r,!0)},render_section:function(e,t,r){if(-1==e.indexOf(this.otag+"#"))return e;var n=this,i=new RegExp(this.otag+"\\#(.+)"+this.ctag+"\\s*([\\s\\S]+?)"+this.otag+"\\/\\1"+this.ctag+"\\s*","mg");return e.replace(i,function(e,i,a){var s=n.find(i,t);return n.is_array(s)?n.map(s,function(e){return n.render(a,n.merge(t,n.create_context(e)),r,!0)}).join(""):s?n.render(a,t,r,!0):""})},render_tags:function(e,t,r,n){for(var i=this,a=function(){return new RegExp(i.otag+"(=|!|>|\\{|%)?([^/#]+?)\\1?"+i.ctag+"+","g")},s=a(),u=e.split("\n"),o=0;o<u.length;o++)u[o]=u[o].replace(s,function(e,n,u){switch(n){case"!":return e;case"=":return i.set_delimiters(u),s=a(),"";case">":return i.render_partial(u,t,r);case"{":return i.find(u,t);default:return i.escape(i.find(u,t))}},this),n||this.send(u[o]);return n?u.join("\n"):void 0},set_delimiters:function(e){var t=e.split(" ");this.otag=this.escape_regex(t[0]),this.ctag=this.escape_regex(t[1])},escape_regex:function(e){if(!arguments.callee.sRE){var t=["/",".","*","+","?","|","(",")","[","]","{","}","\\"];arguments.callee.sRE=new RegExp("(\\"+t.join("|\\")+")","g")}return e.replace(arguments.callee.sRE,"\\$1")},find:function(e,t){return e=this.trim(e),"function"==typeof t[e]?t[e].apply(t):void 0!==t[e]?t[e]:""},escape:function(e){return(null==e?"":e).toString().replace(/[&"<>\\]/g,function(e){switch(e){case"&":return"&amp;";case"\\":return"\\\\";case'"':return'"';case"<":return"&lt;";case">":return"&gt;";default:return e}})},merge:function(e,t){var r={};for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);for(var n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);return r},create_context:function(e){if(this.is_object(e))return e;if(this.pragmas["IMPLICIT-ITERATOR"]){var t=this.pragmas["IMPLICIT-ITERATOR"].iterator||".",r={};return r[t]=e,r}},is_object:function(e){return e&&"object"==typeof e},is_array:function(e){return"[object Array]"===Object.prototype.toString.call(e)},trim:function(e){return e.replace(/^\s*|\s*$/g,"")},map:function(e,t){if("function"==typeof e.map)return e.map(t);for(var r=[],n=e.length,i=0;n>i;i++)r.push(t(e[i]));return r}},{name:"mustache.js",version:"0.2.3",to_html:function(t,r,n,i){var a=new e;return i&&(a.send=i),a.render(t,r,n),i?void 0:a.buffer.join("\n")}}}();