var Mustache=function(){var e=function(){};return e.prototype={otag:"{{",ctag:"}}",pragmas:{},render:function(e,t,r){if(-1==e.indexOf(this.otag))return e;e=this.render_pragmas(e);var n=this.render_section(e,t,r);return this.render_tags(n,t,r)},render_pragmas:function(e){if(-1==e.indexOf(this.otag+"%"))return e;var t=this,r=new RegExp(this.otag+"%(.+)"+this.ctag);return e.replace(r,function(e,r){return t.pragmas[r]=!0,""})},render_partial:function(e,t,r){if("object"!=typeof t[e])throw{message:"subcontext for '"+e+"' is not an object"};if(!r||!r[e])throw{message:"unknown_partial"};return this.render(r[e],t[e],r)},render_section:function(e,t,r){if(-1==e.indexOf(this.otag+"#"))return e;var n=this,i=new RegExp(this.otag+"\\#(.+)"+this.ctag+"\\s*([\\s\\S]+?)"+this.otag+"\\/\\1"+this.ctag+"\\s*","mg");return e.replace(i,function(e,i,a){var s=n.find(i,t);return n.is_array(s)?n.map(s,function(e){return n.render(a,n.merge(t,n.create_context(e)),r)}).join(""):s?n.render(a,t,r):""})},render_tags:function(e,t,r){for(var n=e.split("\n"),i=function(){return new RegExp(a.otag+"(=|!|>|\\{|%)?([^/#]+?)\\1?"+a.ctag+"+","g")},a=this,s=i(),c=0;c<n.length;c++)n[c]=n[c].replace(s,function(e,n,o){switch(n){case"!":return e;case"=":return a.set_delimiters(o),s=i(),c--,"";case">":return a.render_partial(o,t,r);case"{":return a.find(o,t);default:return a.escape(a.find(o,t))}},this);return n.join("\n")},set_delimiters:function(e){var t=e.split(" ");this.otag=this.escape_regex(t[0]),this.ctag=this.escape_regex(t[1])},escape_regex:function(e){if(!arguments.callee.sRE){var t=["/",".","*","+","?","|","(",")","[","]","{","}","\\"];arguments.callee.sRE=new RegExp("(\\"+t.join("|\\")+")","g")}return e.replace(arguments.callee.sRE,"\\$1")},find:function(e,t){return e=this.trim(e),"function"==typeof t[e]?t[e].apply(t):void 0!==t[e]?t[e]:""},escape:function(e){return e.toString().replace(/[&"<>\\]/g,function(e){switch(e){case"&":return"&amp;";case"\\":return"\\\\";case'"':return'"';case"<":return"&lt;";case">":return"&gt;";default:return e}})},merge:function(e,t){var r={};for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);for(var n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);return r},create_context:function(e){return this.is_object(e)?e:this.pragmas["JSTACHE-ENABLE-STRING-ARRAYS"]?{".":e}:void 0},is_object:function(e){return e&&"object"==typeof e},is_array:function(e){return e&&"object"==typeof e&&e.constructor===Array},trim:function(e){return e.replace(/^\s*|\s*$/g,"")},map:function(e,t){if("function"==typeof e.map)return e.map(t);var r=[],n=e.length;for(i=0;n>i;i++)r.push(t(e[i]));return r}},{name:"mustache.js",version:"0.2",to_html:function(t,r,n){return(new e).render(t,r,n)}}}();