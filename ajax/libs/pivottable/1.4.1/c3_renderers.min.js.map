{"version":3,"sources":["/source/c3_renderers.coffee","c3_renderers.min.js"],"names":["callWithJQuery","pivotModule","exports","module","require","define","amd","jQuery","$","makeC3Chart","chartOpts","pivotData","opts","agg","colKey","colKeys","columns","dataArray","datum","defaults","fullAggName","h","hAxisTitle","headers","i","j","len","len1","params","ref","renderArea","result","row","rowHeader","rowKey","rowKeys","tree2","vAxisTitle","x","y","localeStrings","vs","by","c3","width","window","height","extend","type","getRowKeys","length","push","getColKeys","results","join","aggregatorName","valAttrs","colAttrs","rowAttrs","tree","parseFloat","format","value","getAggregator","size","axis","label","data","tooltip","grouped","tick","fit","json","keys","legend","show","title","name","a","b","c","d","categories","stacked","groups","k","len2","style","appendTo","bindto","generate","detach","remove","pivotUtilities","c3_renderers","Line Chart","Bar Chart","Stacked Bar Chart","Area Chart","Scatter Chart","call","this"],"mappings":"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","file":"c3_renderers.min.js","sourcesContent":["callWithJQuery = (pivotModule) ->\n    if typeof exports is \"object\" and typeof module is \"object\" # CommonJS\n        pivotModule require(\"jquery\")\n    else if typeof define is \"function\" and define.amd # AMD\n        define [\"jquery\"], pivotModule\n    # Plain browser env\n    else\n        pivotModule jQuery\n        \ncallWithJQuery ($) ->\n\n    makeC3Chart = (chartOpts = {}) -> (pivotData, opts) ->\n        defaults =\n            localeStrings:\n                vs: \"vs\"\n                by: \"by\"\n            c3:\n                width: -> $(window).width() / 1.4\n                height: -> $(window).height() / 1.4\n\n        opts = $.extend defaults, opts\n        chartOpts.type ?= \"line\"\n\n        rowKeys = pivotData.getRowKeys()\n        rowKeys.push [] if rowKeys.length == 0\n        colKeys = pivotData.getColKeys()\n        colKeys.push [] if colKeys.length == 0\n\n        headers = (h.join(\"-\") for h in colKeys)\n\n        fullAggName = pivotData.aggregatorName \n        if pivotData.valAttrs.length\n            fullAggName += \"(#{pivotData.valAttrs.join(\", \")})\"\n\n        if chartOpts.type == \"scatter\"\n            dataArray = []\n            hAxisTitle = pivotData.colAttrs.join(\"-\")\n            vAxisTitle = pivotData.rowAttrs.join(\"-\")\n            for y, tree2 of pivotData.tree\n                for x, agg of tree2\n                    datum = {}\n                    datum[hAxisTitle] = parseFloat(x)\n                    datum[vAxisTitle] = parseFloat(y)\n                    datum[\"tooltip\"] = agg.format(agg.value())\n                    dataArray.push datum\n        else\n            columns = []\n            for rowKey in rowKeys\n                rowHeader = rowKey.join(\"-\")\n                row = [if rowHeader == \"\" then pivotData.aggregatorName else rowHeader]\n                for colKey in colKeys\n                    agg = pivotData.getAggregator(rowKey, colKey)\n                    if agg.value()?\n                        row.push agg.value()\n                    else row.push null\n                columns.push row\n\n\n            vAxisTitle = pivotData.aggregatorName+ \n                if pivotData.valAttrs.length then \"(#{pivotData.valAttrs.join(\", \")})\" else \"\"\n            hAxisTitle = pivotData.colAttrs.join(\"-\")\n\n        params = \n            size:\n                height: opts.c3.height()\n                width: opts.c3.width()\n            axis: \n                y: label: vAxisTitle\n                x: label: hAxisTitle\n            data: \n                type: chartOpts.type\n            tooltip:\n                grouped: false\n\n        if chartOpts.type == \"scatter\"\n            params.data.x = hAxisTitle\n            params.axis.x.tick = fit: false\n            params.data.json = dataArray\n            params.data.keys = value: [hAxisTitle,vAxisTitle]\n            params.legend = show: false \n            params.tooltip.format =  \n                title: -> fullAggName\n                name: -> \"\"\n                value: (a,b,c,d) -> dataArray[d].tooltip\n        else\n            params.axis.x.type= 'category'\n            params.axis.x.categories = headers\n            params.data.columns = columns\n\n\n        if chartOpts.stacked?\n            params.data.groups = [x.join(\"-\") for x in rowKeys]\n        renderArea = $(\"<div>\", style: \"display:none;\").appendTo $(\"body\")\n        result = $(\"<div>\").appendTo renderArea\n        params.bindto = result[0]\n        c3.generate params\n        result.detach()\n        renderArea.remove()\n        return result\n\n    $.pivotUtilities.c3_renderers = \n        \"Line Chart\": makeC3Chart()\n        \"Bar Chart\": makeC3Chart(type: \"bar\")\n        \"Stacked Bar Chart\": makeC3Chart(type: \"bar\", stacked: true)\n        \"Area Chart\": makeC3Chart(type: \"area\", stacked: true)\n        \"Scatter Chart\": makeC3Chart(type: \"scatter\")\n","(function(){var t;(t=function(t){return\"object\"==typeof exports&&\"object\"==typeof module?t(require(\"jquery\")):\"function\"==typeof define&&define.amd?define([\"jquery\"],t):t(jQuery)})(function(t){var e;return e=function(e){return null==e&&(e={}),function(r,n){var a,o,i,l,u,s,c,p,h,g,d,f,y,v,j,w,x,b,m,A,k,C,q,N,S,B,F;if(c={localeStrings:{vs:\"vs\",by:\"by\"},c3:{width:function(){return t(window).width()/1.4},height:function(){return t(window).height()/1.4}}},n=t.extend(c,n),null==e.type&&(e.type=\"line\"),q=r.getRowKeys(),0===q.length&&q.push([]),i=r.getColKeys(),0===i.length&&i.push([]),d=function(){var t,e,r;for(r=[],t=0,e=i.length;e>t;t++)h=i[t],r.push(h.join(\"-\"));return r}(),p=r.aggregatorName,r.valAttrs.length&&(p+=\"(\"+r.valAttrs.join(\", \")+\")\"),\"scatter\"===e.type){u=[],g=r.colAttrs.join(\"-\"),S=r.rowAttrs.join(\"-\"),x=r.tree;for(F in x){N=x[F];for(B in N)a=N[B],s={},s[g]=parseFloat(B),s[S]=parseFloat(F),s.tooltip=a.format(a.value()),u.push(s)}}else{for(l=[],f=0,v=q.length;v>f;f++){for(C=q[f],k=C.join(\"-\"),A=[\"\"===k?r.aggregatorName:k],y=0,j=i.length;j>y;y++)o=i[y],a=r.getAggregator(C,o),A.push(null!=a.value()?a.value():null);l.push(A)}S=r.aggregatorName+(r.valAttrs.length?\"(\"+r.valAttrs.join(\", \")+\")\":\"\"),g=r.colAttrs.join(\"-\")}return w={size:{height:n.c3.height(),width:n.c3.width()},axis:{y:{label:S},x:{label:g}},data:{type:e.type},tooltip:{grouped:!1}},\"scatter\"===e.type?(w.data.x=g,w.axis.x.tick={fit:!1},w.data.json=u,w.data.keys={value:[g,S]},w.legend={show:!1},w.tooltip.format={title:function(){return p},name:function(){return\"\"},value:function(t,e,r,n){return u[n].tooltip}}):(w.axis.x.type=\"category\",w.axis.x.categories=d,w.data.columns=l),null!=e.stacked&&(w.data.groups=[function(){var t,e,r;for(r=[],t=0,e=q.length;e>t;t++)B=q[t],r.push(B.join(\"-\"));return r}()]),b=t(\"<div>\",{style:\"display:none;\"}).appendTo(t(\"body\")),m=t(\"<div>\").appendTo(b),w.bindto=m[0],c3.generate(w),m.detach(),b.remove(),m}},t.pivotUtilities.c3_renderers={\"Line Chart\":e(),\"Bar Chart\":e({type:\"bar\"}),\"Stacked Bar Chart\":e({type:\"bar\",stacked:!0}),\"Area Chart\":e({type:\"area\",stacked:!0}),\"Scatter Chart\":e({type:\"scatter\"})}})}).call(this);\n//# sourceMappingURL=c3_renderers.min.js.map"],"sourceRoot":"/source/"}