{"version":3,"sources":["/source/c3_renderers.coffee","c3_renderers.min.js"],"names":["callWithJQuery","pivotModule","exports","module","require","define","amd","jQuery","$","makeC3Chart","chartOpts","pivotData","opts","agg","colKey","colKeys","columns","dataArray","datum","defaults","fullAggName","h","hAxisTitle","headers","i","j","len","len1","params","ref","renderArea","result","row","rowHeader","rowKey","rowKeys","tree2","vAxisTitle","val","x","y","localeStrings","vs","by","c3","width","window","height","extend","type","getRowKeys","length","push","getColKeys","results","join","aggregatorName","valAttrs","colAttrs","rowAttrs","tree","parseFloat","format","value","getAggregator","isNumeric","toPrecision","toFixed","size","axis","label","data","tooltip","grouped","tick","fit","json","keys","legend","show","title","name","a","b","c","d","categories","stacked","groups","k","len2","style","appendTo","bindto","generate","detach","remove","pivotUtilities","c3_renderers","Line Chart","Bar Chart","Stacked Bar Chart","Area Chart","Scatter Chart","call","this"],"mappings":"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","file":"c3_renderers.min.js","sourcesContent":["callWithJQuery = (pivotModule) ->\n    if typeof exports is \"object\" and typeof module is \"object\" # CommonJS\n        pivotModule require(\"jquery\")\n    else if typeof define is \"function\" and define.amd # AMD\n        define [\"jquery\"], pivotModule\n    # Plain browser env\n    else\n        pivotModule jQuery\n        \ncallWithJQuery ($) ->\n\n    makeC3Chart = (chartOpts = {}) -> (pivotData, opts) ->\n        defaults =\n            localeStrings:\n                vs: \"vs\"\n                by: \"by\"\n            c3:\n                width: -> $(window).width() / 1.4\n                height: -> $(window).height() / 1.4\n\n        opts = $.extend defaults, opts\n        chartOpts.type ?= \"line\"\n\n        rowKeys = pivotData.getRowKeys()\n        rowKeys.push [] if rowKeys.length == 0\n        colKeys = pivotData.getColKeys()\n        colKeys.push [] if colKeys.length == 0\n\n        headers = (h.join(\"-\") for h in colKeys)\n\n        fullAggName = pivotData.aggregatorName \n        if pivotData.valAttrs.length\n            fullAggName += \"(#{pivotData.valAttrs.join(\", \")})\"\n\n        if chartOpts.type == \"scatter\"\n            dataArray = []\n            hAxisTitle = pivotData.colAttrs.join(\"-\")\n            vAxisTitle = pivotData.rowAttrs.join(\"-\")\n            for y, tree2 of pivotData.tree\n                for x, agg of tree2\n                    datum = {}\n                    datum[hAxisTitle] = parseFloat(x)\n                    datum[vAxisTitle] = parseFloat(y)\n                    datum[\"tooltip\"] = agg.format(agg.value())\n                    dataArray.push datum\n        else\n            columns = []\n            for rowKey in rowKeys\n                rowHeader = rowKey.join(\"-\")\n                row = [if rowHeader == \"\" then pivotData.aggregatorName else rowHeader]\n                for colKey in colKeys\n                    agg = pivotData.getAggregator(rowKey, colKey)\n                    if agg.value()?\n                        val = agg.value()\n                        if $.isNumeric val\n                            if val < 0\n                                row.push parseFloat(val.toPrecision(3))\n                            else\n                                row.push parseFloat(val.toFixed(3))\n                        else\n                            row.push val\n\n                    else row.push null\n                columns.push row\n\n\n            vAxisTitle = pivotData.aggregatorName+ \n                if pivotData.valAttrs.length then \"(#{pivotData.valAttrs.join(\", \")})\" else \"\"\n            hAxisTitle = pivotData.colAttrs.join(\"-\")\n\n        params = \n            size:\n                height: opts.c3.height()\n                width: opts.c3.width()\n            axis: \n                y: label: vAxisTitle\n                x: label: hAxisTitle\n            data: \n                type: chartOpts.type\n            tooltip:\n                grouped: false\n\n        if chartOpts.type == \"scatter\"\n            params.data.x = hAxisTitle\n            params.axis.x.tick = fit: false\n            params.data.json = dataArray\n            params.data.keys = value: [hAxisTitle,vAxisTitle]\n            params.legend = show: false \n            params.tooltip.format =  \n                title: -> fullAggName\n                name: -> \"\"\n                value: (a,b,c,d) -> dataArray[d].tooltip\n        else\n            params.axis.x.type= 'category'\n            params.axis.x.categories = headers\n            params.data.columns = columns\n\n\n        if chartOpts.stacked?\n            params.data.groups = [x.join(\"-\") for x in rowKeys]\n        renderArea = $(\"<div>\", style: \"display:none;\").appendTo $(\"body\")\n        result = $(\"<div>\").appendTo renderArea\n        params.bindto = result[0]\n        c3.generate params\n        result.detach()\n        renderArea.remove()\n        return result\n\n    $.pivotUtilities.c3_renderers = \n        \"Line Chart\": makeC3Chart()\n        \"Bar Chart\": makeC3Chart(type: \"bar\")\n        \"Stacked Bar Chart\": makeC3Chart(type: \"bar\", stacked: true)\n        \"Area Chart\": makeC3Chart(type: \"area\", stacked: true)\n        \"Scatter Chart\": makeC3Chart(type: \"scatter\")\n","(function(){var t;(t=function(t){return\"object\"==typeof exports&&\"object\"==typeof module?t(require(\"jquery\")):\"function\"==typeof define&&define.amd?define([\"jquery\"],t):t(jQuery)})(function(t){var e;return e=function(e){return null==e&&(e={}),function(r,n){var a,o,i,l,u,s,c,p,h,g,d,f,y,v,j,w,x,b,m,A,k,C,q,N,S,B,F;if(c={localeStrings:{vs:\"vs\",by:\"by\"},c3:{width:function(){return t(window).width()/1.4},height:function(){return t(window).height()/1.4}}},n=t.extend(c,n),null==e.type&&(e.type=\"line\"),q=r.getRowKeys(),0===q.length&&q.push([]),i=r.getColKeys(),0===i.length&&i.push([]),d=function(){var t,e,r;for(r=[],t=0,e=i.length;e>t;t++)h=i[t],r.push(h.join(\"-\"));return r}(),p=r.aggregatorName,r.valAttrs.length&&(p+=\"(\"+r.valAttrs.join(\", \")+\")\"),\"scatter\"===e.type){u=[],g=r.colAttrs.join(\"-\"),S=r.rowAttrs.join(\"-\"),x=r.tree;for(F in x){N=x[F];for(B in N)a=N[B],s={},s[g]=parseFloat(B),s[S]=parseFloat(F),s.tooltip=a.format(a.value()),u.push(s)}}else{for(l=[],f=0,v=q.length;v>f;f++){for(C=q[f],k=C.join(\"-\"),A=[\"\"===k?r.aggregatorName:k],y=0,j=i.length;j>y;y++)o=i[y],a=r.getAggregator(C,o),A.push(null!=a.value()?a.value():null);l.push(A)}S=r.aggregatorName+(r.valAttrs.length?\"(\"+r.valAttrs.join(\", \")+\")\":\"\"),g=r.colAttrs.join(\"-\")}return w={size:{height:n.c3.height(),width:n.c3.width()},axis:{y:{label:S},x:{label:g}},data:{type:e.type},tooltip:{grouped:!1}},\"scatter\"===e.type?(w.data.x=g,w.axis.x.tick={fit:!1},w.data.json=u,w.data.keys={value:[g,S]},w.legend={show:!1},w.tooltip.format={title:function(){return p},name:function(){return\"\"},value:function(t,e,r,n){return u[n].tooltip}}):(w.axis.x.type=\"category\",w.axis.x.categories=d,w.data.columns=l),null!=e.stacked&&(w.data.groups=[function(){var t,e,r;for(r=[],t=0,e=q.length;e>t;t++)B=q[t],r.push(B.join(\"-\"));return r}()]),b=t(\"<div>\",{style:\"display:none;\"}).appendTo(t(\"body\")),m=t(\"<div>\").appendTo(b),w.bindto=m[0],c3.generate(w),m.detach(),b.remove(),m}},t.pivotUtilities.c3_renderers={\"Line Chart\":e(),\"Bar Chart\":e({type:\"bar\"}),\"Stacked Bar Chart\":e({type:\"bar\",stacked:!0}),\"Area Chart\":e({type:\"area\",stacked:!0}),\"Scatter Chart\":e({type:\"scatter\"})}})}).call(this);\n//# sourceMappingURL=c3_renderers.min.js.map"],"sourceRoot":"/source/"}