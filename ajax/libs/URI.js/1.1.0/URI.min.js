!function(r){function s(t){return t.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function e(t){return"[object Array]"===String(Object.prototype.toString.call(t))}function n(t,s){var n,i,a={};if(e(s))for(n=0,i=s.length;i>n;n++)a[s[n]]=!0;else a[s]=!0;for(n=0,i=t.length;i>n;n++)a[t[n]]!==r&&(t.splice(n,1),i--,n--);return t}var i=function(t){return this instanceof i?(t===r&&(t=location.href+""),this.href(t),this):new i(t)},a=i.prototype;i.encode=encodeURIComponent,i.decode=decodeURIComponent,a.encode=i.encode,a.decode=i.decode,i.idn_expression=/[^a-z0-9\.-]/i,i.punycode_expression=/(xn--)/i,i.ip4_expression=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,i.ip6_expression=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,i.find_uri_expression=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/gi,i.defaultPorts={http:"80",https:"443",ftp:"21"},i.parse=function(t){var r,s={};return r=t.indexOf("#"),r>-1&&(s.fragment=t.substring(r+1)||null,t=t.substring(0,r)),r=t.indexOf("?"),r>-1&&(s.query=t.substring(r+1)||null,t=t.substring(0,r)),r=t.indexOf("://"),r>-1&&(s.protocol=t.substring(0,r),t=t.substring(r+3),t=i.parseAuthority(t,s)),s.path=t,s},i.parseHost=function(r,s){var e=r.indexOf("/");if(-1===e&&(e=r.length),"["===r[0]){var n=r.indexOf("]");s.hostname=r.substring(1,n)||null,s.port=r.substring(n+2,e)||null}else r.indexOf(":")!==r.lastIndexOf(":")?(s.hostname=r.substring(0,e)||null,s.port=null):(t=r.substring(0,e).split(":"),s.hostname=t[0]||null,s.port=t[1]||null);return r.substring(e)||"/"},i.parseAuthority=function(r,s){var e=r.indexOf("@");return e>-1?(t=r.substring(0,e).split(":"),s.username=t[0]?i.decode(t[0]):null,s.password=t[1]?i.decode(t[1]):null,r=r.substring(e+1)):(s.username=null,s.password=null),i.parseHost(r,s)},i.parseQuery=function(t){t=t.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,"");for(var r={},s=t.split("&"),e=s.length,n=0;e>n;n++){var a=s[n].split("="),o=i.decode(a.shift()),h=a.length?i.decode(a.join("=")):null;r[o]?("string"==typeof r[o]&&(r[o]=[r[o]]),r[o].push(h)):r[o]=h}return r},i.build=function(t){var r="";return"string"==typeof t.protocol&&t.protocol.length&&(r+=t.protocol+"://"),r+=i.buildAuthority(t)||"","string"==typeof t.path&&("/"!==t.path[0]&&"string"==typeof t.hostname&&(r+="/"),r+=t.path),"string"==typeof t.query&&(r+="?"+t.query),"string"==typeof t.fragment&&(r+="#"+t.fragment),r},i.buildHost=function(t){var r="";return t.hostname?(i.ip6_expression.test(t.hostname)?r+=t.port?"["+t.hostname+"]:"+t.port:t.hostname:(r+=t.hostname,t.port&&(r+=":"+t.port)),r):""},i.buildAuthority=function(t){var r="";return t.username&&(r+=i.encode(t.username),t.password&&(r+=":"+i.encode(t.password)),r+="@"),r+=i.buildHost(t)},i.buildQuery=function(t){var s="";for(var n in t)if(Object.hasOwnProperty.call(t,n)){var a=i.encode(n+"");if(e(t[n]))for(var o={},h=0,p=t[n].length;p>h;h++)t[n][h]!==r&&o[t[n][h]+""]===r&&(s+="&"+a+(null!==t[n][h]?"="+i.encode(t[n][h]+""):""),o[t[n][h]+""]=!0);else t[n]!==r&&(s+="&"+a+(null!==t[n]?"="+i.encode(t[n]+""):""))}return s.substring(1)},i.addQuery=function(t,s,n){if("object"==typeof s)for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&i.addQuery(t,a,s[a]);else{if("string"!=typeof s)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");if(t[s]===r)return void(t[s]=n);"string"==typeof t[s]&&(t[s]=[t[s]]),e(n)||(n=[n]),t[s]=t[s].concat(n)}},i.removeQuery=function(t,s,a){if(e(s))for(var o=0,h=s.length;h>o;o++)t[s[o]]=r;else if("object"==typeof s)for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&i.removeQuery(t,p,s[p]);else{if("string"!=typeof s)throw new TypeError("URI.addQuery() accepts an object, string as the first parameter");a!==r?t[s]===a?t[s]=r:e(t[s])&&(t[s]=n(t[s],a)):t[s]=r}},i.commonPath=function(t,r){var s,e=Math.min(t.length,r.length);for(s=0;e>s;s++)if(t[s]!==r[s]){s--;break}return 1>s?t[0]===r[0]&&"/"===t[0]?"/":"":("/"!==t[s]&&(s=t.substring(0,s).lastIndexOf("/")),t.substring(0,s+1))},i.withinString=function(t,r){return t.replace(i.find_uri_expression,r)},a.build=function(){return this._string=i.build(this._parts),this},a.toString=function(){return this._string},a.valueOf=function(){return this.toString()};var o,h={protocol:"protocol",username:"username",password:"password",hostname:"hostname",port:"port"};for(o in h)a[o]=function(t){return function(s,e){return s===r?this._parts[t]||"":(this._parts[t]=s,e!==!1&&this.build(),this)}}(h[o]);h={query:"?",fragment:"#"};for(o in h)a[o]=function(t,s){return function(e,n){return e===r?this._parts[t]||"":(null!==e&&(e+="",e[0]===s&&(e=e.substring(1))),this._parts[t]=e,n!==!1&&this.build(),this)}}(o,h[o]);h={search:["?","query"],hash:["#","fragment"]};for(o in h)a[o]=function(t,r){return function(s,e){var n=this[t](s,e);return"string"==typeof n&&n.length?r+n:n}}(h[o][1],h[o][0]);a.pathname=function(t,s){return t===r?this._parts.path||"/":(this._parts.path=t||"/",s!==!1&&this.build(),this)},a.path=a.pathname,a.href=function(t,s){if(t===r)return this.toString();this._string="",this._parts={protocol:null,username:null,password:null,hostname:null,port:null,path:null,query:null,fragment:null};var e,n=t instanceof i,a="object"==typeof t&&(t.hostname||t.path);if("string"==typeof t)this._parts=i.parse(t);else{if(!n&&!a)throw new TypeError("invalid input");var o=n?t._parts:t;for(e in o)Object.hasOwnProperty.call(this._parts,e)&&(this._parts[e]=o[e])}return s!==!1&&this.build(),this},a.is=function(t){var r=!1,s=!1,e=!1,n=!1,a=!1,o=!1,h=!0;switch(this._parts.hostname&&(h=!1,s=i.ip4_expression.test(this._parts.hostname),e=i.ip6_expression.test(this._parts.hostname),r=s||e,n=!r,a=n&&i.idn_expression.test(this._parts.hostname),o=n&&i.punycode_expression.test(this._parts.hostname)),t.toLowerCase()){case"relative":return h;case"domain":case"name":return n;case"ip":return r;case"ip4":case"ipv4":case"inet4":return s;case"ip6":case"ipv6":case"inet6":return e;case"idn":return a;case"punycode":return o}return null},a.host=function(t,s){return t===r?this._parts.hostname?i.buildHost(this._parts):"":(i.parseHost(t,this._parts),s!==!1&&this.build(),this)},a.authority=function(t,s){return t===r?this._parts.hostname?i.buildAuthority(this._parts):"":(i.parseAuthority(t,this._parts),s!==!1&&this.build(),this)},a.domain=function(t,e){if(t===r)return!this._parts.hostname||this.is("IP")?"":this._parts.hostname.match(/\.?([^\.]+.[^\.]+)$/)[1]||this._parts.hostname;if(!t)throw new TypeError("cannot set domain empty");if(!this._parts.hostname||this.is("IP"))this._parts.hostname=t;else{var n=new RegExp(s(this.domain())+"$");this._parts.hostname=this._parts.hostname.replace(n,t)}return e!==!1&&this.build(),this},a.tld=function(t,e){if(t===r){if(!this._parts.hostname||this.is("IP"))return"";var n=this._parts.hostname.lastIndexOf(".");return this._parts.hostname.substring(n+1)}if(!t)throw new TypeError("cannot set TLD empty");if(!this._parts.hostname||this.is("IP"))throw new ReferenceError("cannot set TLD on non-domain host");var i=new RegExp(s(this.tld())+"$");return this._parts.hostname=this._parts.hostname.replace(i,t),e!==!1&&this.build(),this},a.directory=function(t,e){if(t===r){if(!this._parts.path||"/"===this._parts.path)return"/";var n=this._parts.path.length-this.filename().length-1;return this._parts.path.substring(0,n)}var i=this._parts.path.length-this.filename().length,a=this._parts.path.substring(0,i),o=new RegExp("^"+s(a));return this.is("relative")||(t||(t="/"),"/"!==t[0]&&(t="/"+t)),t&&"/"!==t[t.length-1]&&(t+="/"),this._parts.path=this._parts.path.replace(o,t),e!==!1&&this.build(),this},a.filename=function(t,e){if(t===r){if(!this._parts.path||"/"===this._parts.path)return"";var n=this._parts.path.lastIndexOf("/");return this._parts.path.substring(n+1)}"/"===t[0]&&(t=t.substring(1));var i=new RegExp(s(this.filename())+"$");return this._parts.path=this._parts.path.replace(i,t),e!==!1&&this.build(),this},a.suffix=function(t,e){if(t===r){if(!this._parts.path||"/"===this._parts.path)return"";var n,i=this.filename(),a=i.lastIndexOf(".");return-1===a?"":(n=i.substring(a+1),/^[a-z0-9]+$/i.test(n)?n:"")}"."===t[0]&&(t=t.substring(1));var o,h=this.suffix();if(h)o=new RegExp(t?s(h)+"$":s("."+h)+"$");else{if(!t)return this;this._parts.path+="."+t}return o&&(this._parts.path=this._parts.path.replace(o,t)),e!==!1&&this.build(),this};var p=a.query;a.query=function(t,s){return t===!0?i.parseQuery(this._parts.query):t!==r&&"string"!=typeof t?(this._parts.query=i.buildQuery(t),s!==!1&&this.build(),this):p.call(this,t,s)},a.addQuery=function(t,r,s){var e=i.parseQuery(this._parts.query);return i.addQuery(e,t,r),this._parts.query=i.buildQuery(e),"string"!=typeof t&&(s=r),s!==!1&&this.build(),this},a.removeQuery=function(t,r,s){var e=i.parseQuery(this._parts.query);return i.removeQuery(e,t,r),this._parts.query=i.buildQuery(e),"string"!=typeof t&&(s=r),s!==!1&&this.build(),this},a.addSearch=a.addQuery,a.removeSearch=a.removeQuery,a.normalize=function(){return this.normalizeProtocol(!1).normalizeHostname(!1).normalizePort(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build()},a.normalizeProtocol=function(t){return"string"==typeof this._parts.protocol&&(this._parts.protocol=this._parts.protocol.toLowerCase(),t!==!1&&this.build()),this},a.normalizeHostname=function(t){return this._parts.hostname&&(this.is("IDN")&&window.punycode?this._parts.hostname=punycode.toASCII(this._parts.hostname):this.is("IPv6")&&window.IPv6&&(this._parts.hostname=IPv6.best(this._parts.hostname)),this._parts.hostname=this._parts.hostname.toLowerCase(),t!==!1&&this.build()),this},a.normalizePort=function(t){return"string"==typeof this._parts.protocol&&this._parts.port===i.defaultPorts[this._parts.protocol]&&(this._parts.port=null,t!==!1&&this.build()),this},a.normalizePath=function(t){if(!this._parts.path||"/"===this._parts.path)return this;var r,s,e,n,i=this._parts.path;for("/"!==i[0]&&("."===i[0]&&(s=i.substring(0,i.indexOf("/"))),r=!0,i="/"+i),i=i.replace(/(\/(\.\/)+)|\/{2,}/g,"/");;){if(e=i.indexOf("/../"),-1===e)break;if(0===e){i=i.substring(3);break}n=i.substring(0,e).lastIndexOf("/"),-1===n&&(n=e),i=i.substring(0,n)+i.substring(e+3)}return r&&this.is("relative")&&(i=s?s+i:i.substring(1)),this._parts.path=i,t!==!1&&this.build(),this},a.normalizePathname=a.normalizePath,a.normalizeQuery=function(t){return"string"==typeof this._parts.query&&(this._parts.query.length?this.query(i.parseQuery(this._parts.query)):this._parts.query=null,t!==!1&&this.build()),this},a.normalizeFragment=function(t){return this._parts.fragment||(this._parts.fragment=null,t!==!1&&this.build()),this},a.normalizeSearch=a.normalizeQuery,a.normalizeHash=a.normalizeFragment,a.absoluteTo=function(t){if(!this.is("relative"))throw new Error("Cannot resolve non-relative URL");t instanceof i||(t=new i(t));for(var r,s=new i(this),e=["protocol","username","password","hostname","port"],n=0;r=e[n];n++)s._parts[r]=t._parts[r];return"/"!==s.path()[0]&&(s._parts.path=t.directory()+"/"+s._parts.path,s.normalizePath()),s.build(),s},a.relativeTo=function(t){if(t instanceof i||(t=new i(t)),"/"!==this.path()[0]||"/"!==t.path()[0])throw new Error("Cannot calculate common path from non-relative URLs");for(var r,e=new i(this),n=["protocol","username","password","hostname","port"],a=i.commonPath(e.path(),t.path()),o=t.directory(),h=0;r=n[h];h++)e._parts[r]=null;if(!a||"/"===a)return e;if(o+"/"===a)e._parts.path="./"+e.filename();else{for(var p="../",u=new RegExp("^"+s(a)),l=o.replace(u,"/").match(/\//g).length-1;l--;)p+="../";e._parts.path=e._parts.path.replace(u,p)}return e.build(),e},window.URI=i}();