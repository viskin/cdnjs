(function(d){var j=window;if(!Object.keys){Object.keys=(function(){var v=Object.prototype.hasOwnProperty,w=!({toString:null}).propertyIsEnumerable("toString"),u=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],t=u.length;return function(z){if(typeof z!=="object"&&(typeof z!=="function"||z===null)){throw new TypeError("Object.keys called on non-object")}var x=[],A,y;for(A in z){if(v.call(z,A)){x.push(A)}}if(w){for(y=0;y<t;y++){if(v.call(z,u[y])){x.push(u[y])}}}return x}}())}var b=false;var e=200;var k=(location.hash==="#debug");function c(t){if(k){console.log(t)}}var n=["Days","Hours","Minutes","Seconds"];var p={Seconds:"Minutes",Minutes:"Hours",Hours:"Days",Days:"Years"};var q={Seconds:1,Minutes:60,Hours:3600,Days:86400,Months:2678400,Years:31536000};function r(v){var u=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;v=v.replace(u,function(x,z,y,w){return z+z+y+y+w+w});var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(v);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}function f(){var t=document.createElement("canvas");return !!(t.getContext&&t.getContext("2d"))}function a(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}function m(){return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(u){var t=this.length>>>0;var v=Number(arguments[1])||0;v=(v<0)?Math.ceil(v):Math.floor(v);if(v<0){v+=t}for(;v<t;v++){if(v in this&&this[v]===u){return v}}return -1}}function g(y){var u=y.match(/^[0-9]{4}-[0-9]{2}-[0-9]{2}\s[0-9]{1,2}:[0-9]{2}:[0-9]{2}$/);if(u!==null&&u.length>0){var w=y.split(" ");var t=w[0].split("-");var v=w[1].split(":");return new Date(t[0],t[1]-1,t[2],v[0],v[1],v[2])}var x=Date.parse(y);if(!isNaN(x)){return x}x=Date.parse(y.replace(/-/g,"/").replace("T"," "));if(!isNaN(x)){return x}return new Date()}function i(H,J,E,A,z){var C={};var B={};var u={};var I={};var D={};var y={};var w=null;for(var x=0;x<A.length;x++){var G=A[x];var v;if(w===null){v=E/q[G]}else{v=q[w]/q[G]}var t=(H/q[G]);var F=(J/q[G]);if(z){if(t>0){t=Math.floor(t)}else{t=Math.ceil(t)}if(F>0){F=Math.floor(F)}else{F=Math.ceil(F)}}if(G!=="Days"){t=t%v;F=F%v}C[G]=t;u[G]=Math.abs(t);B[G]=F;y[G]=Math.abs(F);I[G]=Math.abs(t)/v;D[G]=Math.abs(F)/v;w=G}return{raw_time:C,raw_old_time:B,time:u,old_time:y,pct:I,old_pct:D}}var o={};function l(){if(typeof j.TC_Instance_List!=="undefined"){o=j.TC_Instance_List}else{j.TC_Instance_List=o}}(function(){var u=["webkit","moz"];for(var t=0;t<u.length&&!window.top.requestAnimationFrame;++t){window.top.requestAnimationFrame=window.top[u[t]+"RequestAnimationFrame"];window.top.cancelAnimationFrame=window.top[u[t]+"CancelAnimationFrame"]}if(!window.top.requestAnimationFrame||!window.top.cancelAnimationFrame){window.top.requestAnimationFrame=function(A,x,v){if(typeof v==="undefined"){v={data:{last_frame:0}}}var w=new Date().getTime();var y=Math.max(0,16-(w-v.data.last_frame));var z=window.top.setTimeout(function(){A(w+y)},y);v.data.last_frame=w+y;return z};window.top.cancelAnimationFrame=function(v){clearTimeout(v)}}})();var h=function(u,t){this.element=u;this.container;this.listeners=null;this.data={paused:false,last_frame:0,animation_frame:null,timer:false,total_duration:null,prev_time:null,drawn_units:[],text_elements:{Days:null,Hours:null,Minutes:null,Seconds:null},attributes:{canvas:null,context:null,item_size:null,line_width:null,radius:null,outer_radius:null},state:{fading:{Days:false,Hours:false,Minutes:false,Seconds:false}}};this.config=null;this.setOptions(t);this.initialize()};h.prototype.clearListeners=function(){this.listeners={all:[],visible:[]}};h.prototype.addTime=function(t){if(this.data.attributes.ref_date instanceof Date){var u=this.data.attributes.ref_date;u.setSeconds(u.getSeconds()+t)}else{if(!isNaN(this.data.attributes.ref_date)){this.data.attributes.ref_date+=(t*1000)}}};h.prototype.initialize=function(z){this.data.drawn_units=[];for(var w=0;w<Object.keys(this.config.time).length;w++){var B=Object.keys(this.config.time)[w];if(this.config.time[B].show){this.data.drawn_units.push(B)}}d(this.element).children("div.time_circles").remove();if(typeof z==="undefined"){z=true}if(z||this.listeners===null){this.clearListeners()}this.container=d("<div>");this.container.addClass("time_circles");this.container.appendTo(this.element);var D=this.element.offsetHeight;var u=this.element.offsetWidth;if(D===0){D=d(this.element).height()}if(u===0){u=d(this.element).width()}if(D===0&&u>0){D=u/this.data.drawn_units.length}else{if(u===0&&D>0){u=D*this.data.drawn_units.length}}var A=document.createElement("canvas");A.width=u;A.height=D;this.data.attributes.canvas=d(A);this.data.attributes.canvas.appendTo(this.container);var y=f();if(!y&&typeof G_vmlCanvasManager!=="undefined"){G_vmlCanvasManager.initElement(A);b=true;y=true}if(y){this.data.attributes.context=A.getContext("2d")}this.data.attributes.item_size=Math.min(u/this.data.drawn_units.length,D);this.data.attributes.line_width=this.data.attributes.item_size*this.config.fg_width;this.data.attributes.radius=((this.data.attributes.item_size*0.8)-this.data.attributes.line_width)/2;this.data.attributes.outer_radius=this.data.attributes.radius+0.5*Math.max(this.data.attributes.line_width,this.data.attributes.line_width*this.config.bg_width);var w=0;for(var C in this.data.text_elements){if(!this.config.time[C].show){continue}var t=d("<div>");t.addClass("textDiv_"+C);t.css("top",Math.round(0.35*this.data.attributes.item_size));t.css("left",Math.round(w++*this.data.attributes.item_size));t.css("width",this.data.attributes.item_size);t.appendTo(this.container);var x=d("<h4>");x.text(this.config.time[C].text);x.css("font-size",Math.round(this.config.text_size*this.data.attributes.item_size));x.css("line-height",Math.round(this.config.text_size*this.data.attributes.item_size)+"px");x.appendTo(t);var v=d("<span>");v.css("font-size",Math.round(3*this.config.text_size*this.data.attributes.item_size));v.css("line-height",Math.round(this.config.text_size*this.data.attributes.item_size)+"px");v.appendTo(t);this.data.text_elements[C]=v}this.start();if(!this.config.start){this.data.paused=true}};h.prototype.update=function(){if(b){this.data.attributes.context.clearRect(0,0,this.data.attributes.canvas[0].width,this.data.attributes.canvas[0].hright)}var B,I;var J=this.data.prev_time;var L=new Date();this.data.prev_time=L;if(J===null){J=L}if(!this.config.count_past_zero){if(L>this.data.attributes.ref_date){for(var G=0;G<this.data.drawn_units.length;G++){var M=this.data.drawn_units[G];this.data.text_elements[M].text("0");var A=(G*this.data.attributes.item_size)+(this.data.attributes.item_size/2);var z=this.data.attributes.item_size/2;var D=this.config.time[M].color;this.drawArc(A,z,D,0)}this.stop();return}}B=(this.data.attributes.ref_date-L)/1000;I=(this.data.attributes.ref_date-J)/1000;var H=this.config.animation!=="smooth";var t=i(B,I,this.data.total_duration,this.data.drawn_units,H);var u=i(B,I,q.Years,n,H);var G=0;var E=0;var w=null;var F=this.data.drawn_units.slice();for(var G in n){var M=n[G];if(Math.floor(u.raw_time[M])!==Math.floor(u.raw_old_time[M])){this.notifyListeners(M,Math.floor(u.time[M]),Math.floor(B),"all")}if(F.indexOf(M)<0){continue}if(Math.floor(t.raw_time[M])!==Math.floor(t.raw_old_time[M])){this.notifyListeners(M,Math.floor(t.time[M]),Math.floor(B),"visible")}this.data.text_elements[M].text(Math.floor(Math.abs(t.time[M])));var A=(E*this.data.attributes.item_size)+(this.data.attributes.item_size/2);var z=this.data.attributes.item_size/2;var D=this.config.time[M].color;if(this.config.animation==="smooth"){if(w!==null&&!b){if(Math.floor(t.time[w])>Math.floor(t.old_time[w])){this.radialFade(A,z,D,1,M);this.data.state.fading[M]=true}else{if(Math.floor(t.time[w])<Math.floor(t.old_time[w])){this.radialFade(A,z,D,0,M);this.data.state.fading[M]=true}}}if(!this.data.state.fading[M]){this.drawArc(A,z,D,t.pct[M])}}else{this.animateArc(A,z,D,t.pct[M],t.old_pct[M],(new Date()).getTime()+e)}w=M;E++}if(this.data.paused){return}var C=this;var v=function(){C.update.call(C)};if(this.config.animation==="smooth"){this.data.animation_frame=j.requestAnimationFrame(v,C.element,C)}else{var K=(B%1)*1000;if(K<0){K=1000+K}K+=50;C.data.animation_frame=j.setTimeout(function(){C.data.animation_frame=j.requestAnimationFrame(v,C.element,C)},K)}};h.prototype.animateArc=function(C,A,v,u,B,z){if(this.data.attributes.context===null){return}var D=B-u;if(Math.abs(D)>0.5){if(u===0){this.radialFade(C,A,v,1)}else{this.radialFade(C,A,v,0)}}else{var t=(e-(z-(new Date()).getTime()))/e;if(t>1){t=1}var E=(B*(1-t))+(u*t);this.drawArc(C,A,v,E);if(t>=1){return}var w=this;j.requestAnimationFrame(function(){w.animateArc(C,A,v,u,B,z)},this.element)}};h.prototype.drawArc=function(C,B,u,D){if(this.data.attributes.context===null){return}var z=Math.max(this.data.attributes.outer_radius,this.data.attributes.item_size/2);if(!b){this.data.attributes.context.clearRect(C-z,B-z,z*2,z*2)}if(this.config.use_background){this.data.attributes.context.beginPath();this.data.attributes.context.arc(C,B,this.data.attributes.radius,0,2*Math.PI,false);this.data.attributes.context.lineWidth=this.data.attributes.line_width*this.config.bg_width;this.data.attributes.context.strokeStyle=this.config.circle_bg_color;this.data.attributes.context.stroke()}var A,t,E;var w=(-0.5*Math.PI);var F=2*Math.PI;A=w+(this.config.start_angle/360*F);var v=(2*D*Math.PI);if(this.config.direction==="Both"){E=false;A-=(v/2);t=A+v}else{if(this.config.direction==="Clockwise"){E=false;t=A+v}else{E=true;t=A-v}}this.data.attributes.context.beginPath();this.data.attributes.context.arc(C,B,this.data.attributes.radius,A,t,E);this.data.attributes.context.lineWidth=this.data.attributes.line_width;this.data.attributes.context.strokeStyle=u;this.data.attributes.context.stroke()};h.prototype.radialFade=function(B,A,u,C,D){var z=r(u);var w=this;var t=0.2*((C===1)?-1:1);var v;for(v=0;C<=1&&C>=0;v++){(function(){var x=50*v;var y="rgba("+z.r+", "+z.g+", "+z.b+", "+(Math.round(C*10)/10)+")";j.setTimeout(function(){w.drawArc(B,A,y,1)},x)}());C+=t}if(typeof D!==undefined){j.setTimeout(function(){w.data.state.fading[D]=false},50*v)}};h.prototype.timeLeft=function(){var t=new Date();return((this.data.attributes.ref_date-t)/1000)};h.prototype.start=function(){j.cancelAnimationFrame(this.data.animation_frame);j.clearTimeout(this.data.animation_frame);var u=d(this.element).data("date");if(typeof u==="undefined"){u=d(this.element).attr("data-date")}if(typeof u==="string"){this.data.attributes.ref_date=g(u)}else{if(typeof this.data.timer==="number"){if(this.data.paused){this.data.attributes.ref_date=(new Date()).getTime()+(this.data.timer*1000)}}else{var t=d(this.element).data("timer");if(typeof t==="undefined"){t=d(this.element).attr("data-timer")}if(typeof t==="string"){t=parseFloat(t)}if(typeof t==="number"){this.data.timer=t;this.data.attributes.ref_date=(new Date()).getTime()+(t*1000)}else{this.data.attributes.ref_date=this.config.ref_date}}}this.data.paused=false;this.update.call(this)};h.prototype.restart=function(){this.data.timer=false;this.start()};h.prototype.stop=function(){if(typeof this.data.timer==="number"){this.data.timer=this.timeLeft(this)}this.data.paused=true;j.cancelAnimationFrame(this.data.animation_frame)};h.prototype.destroy=function(){this.clearListeners();this.stop();this.container.remove();d(this.element).removeAttr("data-tc-id");d(this.element).removeData("tc-id")};h.prototype.setOptions=function(t){if(this.config===null){this.default_options.ref_date=new Date();this.config=d.extend(true,{},this.default_options)}d.extend(true,this.config,t);if(this.config.use_top_frame){j=window.top;l()}this.data.total_duration=this.config.total_duration;if(typeof this.data.total_duration==="string"){if(typeof q[this.data.total_duration]!=="undefined"){this.data.total_duration=q[this.data.total_duration]}else{if(this.data.total_duration==="Auto"){for(var u=0;u<Object.keys(this.config.time).length;u++){var v=Object.keys(this.config.time)[u];if(this.config.time[v].show){this.data.total_duration=q[p[v]];break}}}else{this.data.total_duration=q.Years;console.error("Valid values for TimeCircles config.total_duration are either numeric, or (string) Years, Months, Days, Hours, Minutes, Auto")}}}};h.prototype.addListener=function(v,t,u){if(typeof v!=="function"){return}if(typeof u==="undefined"){u="visible"}this.listeners[u].push({func:v,scope:t})};h.prototype.notifyListeners=function(w,y,v,u){for(var t=0;t<this.listeners[u].length;t++){var x=this.listeners[u][t];x.func.apply(x.scope,[w,y,v])}};h.prototype.default_options={ref_date:new Date(),start:true,animation:"smooth",count_past_zero:true,circle_bg_color:"#60686F",use_background:true,fg_width:0.1,bg_width:1.2,text_size:0.07,total_duration:"Auto",direction:"Clockwise",use_top_frame:false,start_angle:0,time:{Days:{show:true,text:"Days",color:"#FC6"},Hours:{show:true,text:"Hours",color:"#9CF"},Minutes:{show:true,text:"Minutes",color:"#BFB"},Seconds:{show:true,text:"Seconds",color:"#F99"}}};var s=function(u,t){this.elements=u;this.options=t;this.foreach()};s.prototype.getInstance=function(w){var t;var v=d(w).data("tc-id");if(typeof v==="undefined"){v=m();d(w).attr("data-tc-id",v)}if(typeof o[v]==="undefined"){var u=this.options;var x=d(w).data("options");if(typeof x==="string"){x=JSON.parse(x)}if(typeof x==="object"){u=d.extend(true,{},this.options,x)}t=new h(w,u);o[v]=t}else{t=o[v];if(typeof this.options!=="undefined"){t.setOptions(this.options)}}return t};s.prototype.addTime=function(t){this.foreach(function(u){u.addTime(t)})};s.prototype.foreach=function(u){var t=this;this.elements.each(function(){var v=t.getInstance(this);if(typeof u==="function"){u(v)}});return this};s.prototype.start=function(){this.foreach(function(t){t.start()});return this};s.prototype.stop=function(){this.foreach(function(t){t.stop()});return this};s.prototype.restart=function(){this.foreach(function(t){t.restart()});return this};s.prototype.rebuild=function(){this.foreach(function(t){t.initialize(false)});return this};s.prototype.getTime=function(){return this.getInstance(this.elements[0]).timeLeft()};s.prototype.addListener=function(u,t){if(typeof t==="undefined"){t="visible"}var v=this;this.foreach(function(w){w.addListener(u,v.elements,t)});return this};s.prototype.destroy=function(){this.foreach(function(t){t.destroy()});return this};s.prototype.end=function(){return this.elements};d.fn.TimeCircles=function(t){return new s(this,t)}}(jQuery));