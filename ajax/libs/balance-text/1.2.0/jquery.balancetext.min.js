(function(f){var b=document.documentElement.style,c=(b.textWrap||b.WebkitTextWrap||b.MozTextWrap||b.MsTextWrap||b.OTextWrap);function j(){this.reset()}j.prototype.reset=function(){this.index=0;this.width=0};var g=function(l){return Boolean(l.match(/^\s$/))};var k=function(n){n.find('br[data-owner="balance-text"]').replaceWith(document.createTextNode(" "));var m=n.find('span[data-owner="balance-text"]');if(m.length>0){var l="";m.each(function(){l+=f(this).text();f(this).remove()});n.html(l)}};var e=function(l){b=l.get(0).currentStyle||window.getComputedStyle(l.get(0),null);return(b.textAlign==="justify")};var d=function(q,l,m){l=f.trim(l);var r=l.split(" ").length;l=l+" ";if(r<2){return l}var p=f("<span></span>").html(l);q.append(p);var o=p.width();p.remove();var n=Math.floor((m-o)/(r-1));p.css("word-spacing",n+"px").attr("data-owner","balance-text");return f("<div></div>").append(p).html()};var i=function(l,m){return((m===0)||(m===l.length)||(g(l.charAt(m-1))&&!g(l.charAt(m))))};var a=function(r,l,q,p,o,s,n){var m;for(;;){while(!i(l,s)){s+=o}r.text(l.substr(0,s));m=r.width();if((o<0)?((m<=p)||(m<=0)||(s===0)):((p<=m)||(q<=m)||(s===l.length))){break}s+=o}n.index=s;n.width=m};f.fn.balanceText=function(){if(c){return this}return this.each(function(){var p=f(this);var C=5000;k(p);var t=p.width();var u=p.height();var B=p.css("white-space");var D=p.css("float");var w=p.css("display");var v=p.css("position");p.css({"white-space":"nowrap","float":"none",display:"inline",position:"static"});var x=p.width();var s=p.height();var l=((B==="pre-wrap")?0:s/4);if(t>0&&x>t&&x<C){var z=p.text();var G="";var o="";var r=e(p);var q=Math.round(u/s);var n=q;while(n>1){var A=Math.round((x+l)/n-l);var m=Math.round((z.length+1)/n)-1;var y=new j();a(p,z,t,A,-1,m,y);var F=new j();m=y.index;a(p,z,t,A,+1,m,F);y.reset();m=F.index;a(p,z,t,A,-1,m,y);var E;if(y.index===0){E=F.index}else{if((t<F.width)||(y.index===F.index)){E=y.index}else{E=((Math.abs(A-y.width)<Math.abs(F.width-A))?y.index:F.index)}}o=z.substr(0,E);if(r){G+=d(p,o,t)}else{G+=o;G+='<br data-owner="balance-text" />'}z=z.substr(E);n--;p.text(z);x=p.width()}if(r){p.html(G+d(p,z,t))}else{p.html(G+z)}}p.css({position:v,display:w,"float":D,"white-space":B})})};function h(){f(".balance-text").balanceText()}h();f(window).resize(h)}(jQuery));