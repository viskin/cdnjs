(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.functionPlot=f()}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";require("./lib/polyfills");var d3=window.d3;var events=require("events");var extend=require("extend");var mousetip=require("./lib/tip");var utils=require("./lib/utils");var helpers=require("./lib/helpers/");var annotations=require("./lib/helpers/annotations");var assert=utils.assert;var Const;var types;var cache=[];module.exports=function(options){options=options||{};options.data=options.data||[];var width,height;var margin;var zoomBehavior;var xScale,yScale;var line=d3.svg.line().x(function(d){return xScale(d[0])}).y(function(d){return yScale(d[1])});function Chart(){var n=Math.random();var letter=String.fromCharCode(Math.floor(n*26)+97);this.id=letter+n.toString(16).substr(2);this.linkedGraphs=[this];options.id=this.id;cache[this.id]=this;this.setUpEventListeners()}Chart.prototype=Object.create(events.prototype);Chart.prototype.update=function(){this.setVars();this.build();return this};Chart.prototype.updateBounds=function(){width=this.meta.width=(options.width||Const.DEFAULT_WIDTH)-margin.left-margin.right;height=this.meta.height=(options.height||Const.DEFAULT_HEIGHT)-margin.top-margin.bottom;var xDomain=this.meta.xDomain;var yDomain=this.meta.yDomain;xScale=this.meta.xScale=d3.scale.linear().domain(xDomain).range([0,width]);yScale=this.meta.yScale=d3.scale.linear().domain(yDomain).range([height,0]);this.meta.xAxis=d3.svg.axis().scale(xScale).orient("bottom");this.meta.yAxis=d3.svg.axis().scale(yScale).orient("left")};Chart.prototype.setVars=function(){var limit=10;this.meta={};margin=this.meta.margin={left:30,right:30,top:20,bottom:20};zoomBehavior=this.meta.zoomBehavior=d3.behavior.zoom();var xDomain=this.meta.xDomain=options.xDomain||[-limit/2,limit/2];var yDomain=this.meta.yDomain=options.yDomain||[-limit/2,limit/2];assert(xDomain[0]<xDomain[1]);assert(yDomain[0]<yDomain[1]);if(options.title){this.meta.margin.top=40}this.updateBounds()};Chart.prototype.build=function(){var root=this.root=d3.select(options.target).selectAll("svg").data([options]);this.root.enter=root.enter().append("svg").attr("class","function-plot").attr("font-size",this.getFontSize());root.attr("width",width+margin.left+margin.right).attr("height",height+margin.top+margin.bottom);this.buildTitle();this.buildLegend();this.buildCanvas();this.buildClip();this.buildAxis();this.buildAxisLabel();this.buildContent();var tip=this.tip=mousetip(extend(options.tip,{owner:this}));this.canvas.call(tip);this.buildZoomHelper()};Chart.prototype.buildTitle=function(){var selection=this.root.selectAll("text.title").data(function(d){return[d.title].filter(Boolean)});selection.enter().append("text").attr("class","title").attr("y",margin.top/2).attr("x",margin.left+width/2).attr("font-size",25).attr("text-anchor","middle").attr("alignment-baseline","middle").text(options.title);selection.exit().remove()};Chart.prototype.buildLegend=function(){this.root.enter.append("text").attr("class","top-right-legend").attr("text-anchor","end");this.root.select(".top-right-legend").attr("y",margin.top/2).attr("x",width+margin.left)};Chart.prototype.buildCanvas=function(){var self=this;this.meta.zoomBehavior.x(xScale).y(yScale).scaleExtent([1e-5,Infinity]).on("zoom",function onZoom(){self.emit("all:zoom",xScale,yScale)});var canvas=this.canvas=this.root.selectAll(".canvas").data(function(d){return[d]});this.canvas.enter=canvas.enter().append("g").attr("class","canvas");canvas.attr("transform","translate("+margin.left+","+margin.top+")").call(zoomBehavior).each(function(){var el=d3.select(this);if(options.disableZoom){el.on(".zoom",null)}})};Chart.prototype.buildClip=function(){var id=this.id;var defs=this.canvas.enter.append("defs");defs.append("clipPath").attr("id","function-plot-clip-"+id).append("rect").attr("class","clip static-clip");this.canvas.selectAll(".clip").attr("width",width).attr("height",height)};Chart.prototype.buildAxis=function(){var canvasEnter=this.canvas.enter;canvasEnter.append("g").attr("class","x axis");canvasEnter.append("g").attr("class","y axis");this.canvas.select(".x.axis").attr("transform","translate(0,"+height+")").call(this.meta.xAxis);this.canvas.select(".y.axis").call(this.meta.yAxis);this.canvas.selectAll(".axis path, .axis line").attr("fill","none").attr("stroke","black").attr("shape-rendering","crispedges").attr("opacity",.1)};Chart.prototype.buildAxisLabel=function(){var xLabel,yLabel;var canvas=this.canvas;xLabel=canvas.selectAll("text.x.axis-label").data(function(d){return[d.xLabel].filter(Boolean)});xLabel.enter().append("text").attr("class","x axis-label").attr("text-anchor","end");xLabel.attr("x",width).attr("y",height-6).text(function(d){return d});xLabel.exit().remove();yLabel=canvas.selectAll("text.y.axis-label").data(function(d){return[d.yLabel].filter(Boolean)});yLabel.enter().append("text").attr("class","y axis-label").attr("y",6).attr("dy",".75em").attr("text-anchor","end").attr("transform","rotate(-90)");yLabel.text(function(d){return d});yLabel.exit().remove()};Chart.prototype.buildContent=function(){var self=this;var canvas=this.canvas;var content=this.content=canvas.selectAll("g.content").data(function(d){return[d]});content.enter().append("g").attr("clip-path","url(#function-plot-clip-"+this.id+")").attr("class","content");var yOrigin=content.selectAll("path.y.origin").data([[[0,yScale.domain()[0]],[0,yScale.domain()[1]]]]);yOrigin.enter().append("path").attr("class","y origin").attr("stroke","#eee");yOrigin.attr("d",line);var xOrigin=content.selectAll("path.x.origin").data([[[xScale.domain()[0],0],[xScale.domain()[1],0]]]);xOrigin.enter().append("path").attr("class","x origin").attr("stroke","#eee");xOrigin.attr("d",line);content.call(annotations({owner:self}));var graphs=content.selectAll("g.graph").data(function(d){return d.data});graphs.enter().append("g").attr("class","graph");graphs.each(function(data,index){data.graphOptions=extend({type:"interval"},data.graphOptions);var sampler=data.graphOptions.type!=="interval"?"builtIn":"interval";data.graphOptions=extend({sampler:sampler},data.graphOptions);var options=extend({owner:self,index:index},data.graphOptions);d3.select(this).call(types[options.type](options));d3.select(this).call(helpers(options))})};Chart.prototype.buildZoomHelper=function(){var self=this;this.canvas.enter.append("rect").attr("class","zoom-and-drag").style("fill","none").style("pointer-events","all");this.canvas.select(".zoom-and-drag").attr("width",width).attr("height",height).on("mouseover",function(){self.emit("all:mouseover")}).on("mouseout",function(){self.emit("all:mouseout")}).on("mousemove",function(){self.emit("all:mousemove")})};Chart.prototype.addLink=function(){for(var i=0;i<arguments.length;i+=1){this.linkedGraphs.push(arguments[i])}};Chart.prototype.getFontSize=function(){return Math.max(Math.max(width,height)/50,8)};Chart.prototype.setUpEventListeners=function(){var instance=this;var events={mousemove:function(x,y){instance.tip.move(x,y)},mouseover:function(){instance.tip.show()},mouseout:function(){instance.tip.hide()},draw:function(){instance.buildContent()},"zoom:scaleUpdate":function(xOther,yOther){zoomBehavior.x(xScale.domain(xOther.domain())).y(yScale.domain(yOther.domain()))},"tip:update":function(x,y,index){var meta=instance.root.datum().data[index];var title=meta.title||"";var format=meta.renderer||function(x,y){return x.toFixed(3)+", "+y.toFixed(3)};var text=[];title&&text.push(title);text.push(format(x,y));instance.root.select(".top-right-legend").attr("fill",Const.COLORS[index]).text(text.join(" "))}};var all={mousemove:function(){var mouse=d3.mouse(instance.root.select("rect.zoom-and-drag").node());var x=xScale.invert(mouse[0]);var y=yScale.invert(mouse[1]);instance.linkedGraphs.forEach(function(graph){graph.emit("mousemove",x,y)})},zoom:function(xScale,yScale){instance.linkedGraphs.forEach(function(graph,i){var canvas=graph.canvas;canvas.select(".x.axis").call(graph.meta.xAxis);canvas.select(".y.axis").call(graph.meta.yAxis);if(i){graph.emit("zoom:scaleUpdate",xScale,yScale)}graph.emit("draw")});instance.emit("all:mousemove")}};Object.keys(events).forEach(function(e){instance.on(e,events[e]);!all[e]&&instance.on("all:"+e,function(){var args=Array.prototype.slice.call(arguments);instance.linkedGraphs.forEach(function(graph){var localArgs=args.slice();localArgs.unshift(e);graph.emit.apply(graph,localArgs)})})});Object.keys(all).forEach(function(e){instance.on("all:"+e,all[e])})};var instance=cache[options.id];if(!instance){instance=new Chart}return instance.update()};Const=module.exports.constants=require("./lib/constants");types=module.exports.types=require("./lib/types/")},{"./lib/constants":2,"./lib/helpers/":7,"./lib/helpers/annotations":4,"./lib/polyfills":9,"./lib/tip":12,"./lib/types/":13,"./lib/utils":17,events:96,extend:50}],2:[function(require,module,exports){"use strict";var d3=window.d3;var Constants={COLORS:["steelblue","red","#05b378","orange","#4040e8","yellow","black","magenta","cyan"].map(function(v){return d3.hsl(v)}),DEFAULT_WIDTH:550,DEFAULT_HEIGHT:350,TIP_X_EPS:1};Constants.DEFAULT_ITERATIONS=null;Constants.MAX_ITERATIONS=Constants.DEFAULT_WIDTH*4;module.exports=Constants},{}],3:[function(require,module,exports){"use strict";var constants=require("./constants");var evalTypeFn={interval:require("./samplers/interval"),builtIn:require("./samplers/builtIn")};var evaluator={range:function(chart,datum){var range=datum.range||[-Infinity,Infinity];var scale=chart.meta.xScale;var start=Math.max(scale.domain()[0],range[0]);var end=Math.min(scale.domain()[1],range[1]);return[start,end]},eval:function(options,datum){var chart=options.owner;var range=this.range(chart,datum);var data;var evalFn=evalTypeFn[datum.graphOptions.sampler];var nSamples=datum.samples||Math.min(constants.MAX_ITERATIONS,constants.DEFAULT_ITERATIONS||chart.meta.width*3);data=evalFn(chart,datum,range,nSamples);chart.emit("eval",data,options.index,options.isHelper);return data}};module.exports=evaluator},{"./constants":2,"./samplers/builtIn":10,"./samplers/interval":11}],4:[function(require,module,exports){"use strict";var d3=window.d3;var assert=require("../utils").assert;module.exports=function(options){var annotations;var xScale=options.owner.meta.xScale;var yScale=options.owner.meta.yScale;var line=d3.svg.line().x(function(d){return d[0]}).y(function(d){return d[1]});annotations=function(parentSelection){parentSelection.each(function(){var current=d3.select(this);var selection=current.selectAll("g.annotations").data(function(d){return d.annotations||[]});selection.enter().append("g").attr("class","annotations");selection.each(function(d){assert(!(d.hasOwnProperty("x")&&d.hasOwnProperty("y")));assert(typeof d.x==="number"||typeof d.y==="number")});var yRange=yScale.range();var xRange=xScale.range();var path=selection.selectAll("path").data(function(d){if(d.hasOwnProperty("x")){return[[[0,yRange[0]],[0,yRange[1]]]]}else{return[[[xRange[0],0],[xRange[1],0]]]}});path.enter().append("path").attr("stroke","#eee").attr("d",line);path.exit().remove();var text=selection.selectAll("text").data(function(d){return[{text:d.text||"",hasX:d.hasOwnProperty("x")}]});text.enter().append("text").attr("y",function(d){return d.hasX?3:0}).attr("x",function(d){return d.hasX?0:3}).attr("dy",function(d){return d.hasX?5:-5}).attr("text-anchor",function(d){return d.hasX?"end":""}).attr("transform",function(d){return d.hasX?"rotate(-90)":""}).text(function(d){return d.text});text.exit().remove();selection.attr("transform",function(d){if(d.hasOwnProperty("x")){return"translate("+xScale(d.x)+", 0)"}else{return"translate(0, "+yScale(d.y)+")"}});selection.exit().remove()})};return annotations}},{"../utils":17}],5:[function(require,module,exports){"use strict";var d3=window.d3;var evaluate=require("./eval").builtIn;var line=require("../types/line");module.exports=function(options){var dataBuilderConfig={skipTip:true,samples:2,graphOptions:{sampler:"builtIn"}};var derivative;function computeLine(d){if(!d.derivative){return[]}var x0=typeof d.derivative.x0==="number"?d.derivative.x0:Infinity;dataBuilderConfig.scope={m:evaluate(d.derivative,"fn",{x:x0}),x0:x0,y0:evaluate(d,"fn",{x:x0})};dataBuilderConfig.fn="m * (x - x0) + y0";return[dataBuilderConfig]}function checkAutoUpdate(d){var self=this;if(!d.derivative){return}if(d.derivative.updateOnMouseMove&&!d.derivative.$$mouseListener){d.derivative.$$mouseListener=function(x0){d.derivative.x0=x0;derivative(self)};options.owner.on("tip:update",d.derivative.$$mouseListener)}}derivative=function(selection){selection.each(function(d){var el=d3.select(this);var data=computeLine.call(selection,d);checkAutoUpdate.call(selection,d);var innerSelection=el.selectAll("g.derivative").data(data);innerSelection.enter().append("g").attr("class","derivative");innerSelection.call(line(options));innerSelection.selectAll("path").attr("opacity",.5);innerSelection.exit().remove()})};return derivative}},{"../types/line":15,"./eval":6}],6:[function(require,module,exports){"use strict";var samplers={interval:require("interval-arithmetic-eval"),builtIn:require("built-in-math-eval")};var extend=require("extend");window.math&&(samplers.builtIn=window.math.compile);function generateEvaluator(samplerName){function check(meta,property){var compile=samplers[samplerName];var hiddenProperty=samplerName+"_Expression_"+"_"+property;var hiddenPropertyCompiled=samplerName+"_ExpressionCompiled_"+property;if(meta[property]!==meta[hiddenProperty]){meta[hiddenProperty]=meta[property];meta[hiddenPropertyCompiled]=compile(meta[property])}meta.scope=meta.scope||{}}function getCompiledExpression(meta,property){return meta[samplerName+"_ExpressionCompiled_"+property]}function evaluate(meta,property,variables){check(meta,property);var compiled=getCompiledExpression(meta,property);return compiled.eval(extend({},meta.scope,variables))}return evaluate}module.exports.builtIn=generateEvaluator("builtIn");module.exports.interval=generateEvaluator("interval")},{"built-in-math-eval":18,extend:50,"interval-arithmetic-eval":51}],7:[function(require,module,exports){"use strict";var d3=window.d3;var derivative=require("./derivative");var secant=require("./secant");var extend=require("extend");module.exports=function(options){var extended=extend(true,{isHelper:true},options);function helper(selection){selection.each(function(){var el=d3.select(this);el.call(derivative(extended));el.call(secant(extended))})}return helper}},{"./derivative":5,"./secant":8,extend:50}],8:[function(require,module,exports){"use strict";var d3=window.d3;var extend=require("extend");var evaluate=require("./eval").builtIn;var line=require("../types/line");var assert=require("../utils").assert;module.exports=function(options){var secantDefaults={isHelper:true,skipTip:true,samples:2,graphOptions:{sampler:"builtIn"}};var secant;function computeSlope(scope){scope.m=(scope.y1-scope.y0)/(scope.x1-scope.x0)}function updateLine(d,secant){assert(secant.x0);secant.scope=secant.scope||{};var x0=secant.x0;var x1=typeof secant.x1==="number"?secant.x1:Infinity;extend(secant.scope,{x0:x0,x1:x1,y0:evaluate(d,"fn",{x:x0}),y1:evaluate(d,"fn",{x:x1})});computeSlope(secant.scope)}function setFn(d,secant){updateLine(d,secant);secant.fn="m * (x - x0) + y0"}function setMouseListener(d,config){var self=this;if(config.updateOnMouseMove&&!config.$$mouseListener){config.$$mouseListener=function(x1){config.x1=x1;updateLine(d,config);secant(self)};options.owner.on("tip:update",config.$$mouseListener)}}function computeLines(d){var self=this;var data=[];d.secants=d.secants||[];for(var i=0;i<d.secants.length;i+=1){var secant=d.secants[i]=extend({},secantDefaults,d.secants[i]);if(!secant.fn){setFn.call(self,d,secant);setMouseListener.call(self,d,secant)}data.push(secant)}return data}secant=function(selection){selection.each(function(d){var el=d3.select(this);var data=computeLines.call(selection,d);var innerSelection=el.selectAll("g.secant").data(data);innerSelection.enter().append("g").attr("class","secant");innerSelection.call(line(options));innerSelection.selectAll("path").attr("opacity",.5);innerSelection.exit().remove()})};return secant}},{"../types/line":15,"../utils":17,"./eval":6,extend:50}],9:[function(require,module,exports){(function(doc,proto){try{doc.querySelector(":scope body")}catch(err){["querySelector","querySelectorAll"].forEach(function(method){var native=proto[method];proto[method]=function(selectors){if(/(^|,)\s*:scope/.test(selectors)){var id=this.id;this.id="ID_"+Date.now();selectors=selectors.replace(/((^|,)\s*):scope/g,"$1#"+this.id);var result=doc[method](selectors);this.id=id;return result}else{return native.call(this,selectors)}}})}})(window.document,Element.prototype)},{}],10:[function(require,module,exports){"use strict";var utils=require("../utils");var evaluate=require("../helpers/eval").builtIn;function checkAsymptote(d0,d1,meta,sign,level){if(!level){return{asymptote:true,d0:d0,d1:d1}}var i;var n=10;var x0=d0[0];var x1=d1[0];var samples=utils.linspace([x0,x1],n);var oldY,oldX;for(i=0;i<n;i+=1){var x=samples[i];var y=evaluate(meta,"fn",{x:x});if(i){var deltaY=y-oldY;var newSign=utils.sgn(deltaY);if(newSign===sign){return checkAsymptote([oldX,oldY],[x,y],meta,sign,level-1)}}oldY=y;oldX=x}return{asymptote:false,d0:d0,d1:d1}}function split(chart,meta,data){var i,oldSign;var deltaX;var st=[];var sets=[];var domain=chart.meta.yScale.domain();var zoomScale=chart.meta.zoomBehavior.scale();var yMin=domain[0];var yMax=domain[1];if(data[0]){st.push(data[0]);deltaX=data[1][0]-data[0][0];oldSign=utils.sgn(data[1][1]-data[0][1])}function updateY(d){d[1]=Math.min(d[1],yMax);d[1]=Math.max(d[1],yMin);return d}i=1;while(i<data.length){var y0=data[i-1][1];var y1=data[i][1];var deltaY=y1-y0;var newSign=utils.sgn(deltaY);if(oldSign!==newSign&&Math.abs(deltaY/deltaX)>1/zoomScale){var check=checkAsymptote(data[i-1],data[i],meta,newSign,3);if(check.asymptote){st.push(updateY(check.d0));sets.push(st);st=[updateY(check.d1)]}}oldSign=newSign;st.push(data[i]);++i}if(st.length){sets.push(st)}return sets}var linear=function(chart,meta,range,n){var allX=utils.linspace(range,n);var yDomain=chart.meta.yScale.domain();var yDomainMargin=yDomain[1]-yDomain[0];var yMin=yDomain[0]-yDomainMargin*1e5;var yMax=yDomain[1]+yDomainMargin*1e5;var data=[];var i;for(i=0;i<allX.length;i+=1){var x=allX[i];var y=evaluate(meta,"fn",{x:x});if(utils.isValidNumber(x)&&utils.isValidNumber(y)){data.push([x,utils.clamp(y,yMin,yMax)])}}data=split(chart,meta,data);return data};function parametric(chart,meta,range,nSamples){var parametricRange=meta.range||[0,2*Math.PI];var tCoords=utils.linspace(parametricRange,nSamples);var samples=[];for(var i=0;i<tCoords.length;i+=1){var t=tCoords[i];var x=evaluate(meta,"x",{t:t});var y=evaluate(meta,"y",{t:t});samples.push([x,y])}return[samples]}function polar(chart,meta,range,nSamples){var polarRange=meta.range||[-Math.PI,Math.PI];var thetaSamples=utils.linspace(polarRange,nSamples);var samples=[];for(var i=0;i<thetaSamples.length;i+=1){var theta=thetaSamples[i];var r=evaluate(meta,"r",{theta:theta});var x=r*Math.cos(theta);var y=r*Math.sin(theta);samples.push([x,y])}return[samples]}function points(chart,meta,range,nSamples){return[meta.points]}var sampler=function(chart,meta,range,nSamples){if(meta.parametric){return parametric.apply(null,arguments)}else if(meta.polar){return polar.apply(null,arguments)}else if(meta.points){return points.apply(null,arguments)}else{return linear.apply(null,arguments)}};module.exports=sampler},{"../helpers/eval":6,"../utils":17}],11:[function(require,module,exports){"use strict";var intervalArithmeticEval=require("interval-arithmetic-eval");var Interval=intervalArithmeticEval.Interval;var evaluate=require("../helpers/eval").interval;var utils=require("../utils");intervalArithmeticEval.policies.disableRounding();function interval1d(chart,meta,range,nSamples){var xCoords=utils.linspace(range,nSamples);var xScale=chart.meta.xScale;var yScale=chart.meta.yScale;var yMin=yScale.domain()[0];var yMax=yScale.domain()[1];var samples=[];var i;for(i=0;i<xCoords.length-1;i+=1){var x={lo:xCoords[i],hi:xCoords[i+1]};var y=evaluate(meta,"fn",{x:x});if(!Interval.empty(y)&&!Interval.whole(y)){samples.push([x,y])}if(Interval.whole(y)){samples.push(null)}}for(i=1;i<samples.length-1;i+=1){if(!samples[i]){var prev=samples[i-1];var next=samples[i+1];if(prev&&next&&!Interval.overlap(prev[1],next[1])){if(prev[1].lo>next[1].hi){prev[1].hi=Math.max(yMax,prev[1].hi);next[1].lo=Math.min(yMin,next[1].lo)}if(prev[1].hi<next[1].lo){prev[1].lo=Math.min(yMin,prev[1].lo);next[1].hi=Math.max(yMax,next[1].hi)}}}}for(i=0;i<samples.length;i+=1){if(samples[i]){if(!isFinite(samples[i][1].lo)){samples[i][1].lo=yMin}if(!isFinite(samples[i][1].hi)){samples[i][1].hi=yMax}}}samples.scaledDx=xScale(xCoords[1])-xScale(xCoords[0]);return[samples]}var rectEps;function smallRect(x,y){return Interval.width(x)<rectEps}function quadTree(x,y,meta){var sample=evaluate(meta,"fn",{x:x,y:y});var fulfills=Interval.zeroIn(sample);if(!fulfills){return this}if(smallRect(x,y)){this.push([x,y]);return this}var midX=x.lo+(x.hi-x.lo)/2;var midY=y.lo+(y.hi-y.lo)/2;var east={lo:midX,hi:x.hi};var west={lo:x.lo,hi:midX};var north={lo:midY,hi:y.hi};var south={lo:y.lo,hi:midY};quadTree.call(this,east,north,meta);quadTree.call(this,east,south,meta);quadTree.call(this,west,north,meta);quadTree.call(this,west,south,meta)}function interval2d(chart,meta){var xScale=chart.meta.xScale;var xDomain=chart.meta.xScale.domain();var yDomain=chart.meta.yScale.domain();var x={lo:xDomain[0],hi:xDomain[1]};var y={lo:yDomain[0],hi:yDomain[1]};var samples=[];rectEps=xScale.invert(1)-xScale.invert(0);quadTree.call(samples,x,y,meta);samples.scaledDx=1;return[samples]}var sampler=function(chart,meta,range,nSamples){if(meta.implicit){return interval2d.apply(null,arguments)}else{return interval1d.apply(null,arguments)}};module.exports=sampler},{"../helpers/eval":6,"../utils":17,"interval-arithmetic-eval":51}],12:[function(require,module,exports){"use strict";var d3=window.d3;var extend=require("extend");var utils=require("./utils");var Const=require("./constants");var evaluate=require("./helpers/eval").builtIn;module.exports=function(config){config=extend({xLine:false,yLine:false,renderer:function(x,y){return"("+x.toFixed(3)+", "+y.toFixed(3)+")"},owner:null},config);var MARGIN=20;var line=d3.svg.line().x(function(d){return d[0]}).y(function(d){return d[1]});function lineGenerator(el,data){return el.append("path").datum(data).attr("stroke","grey").attr("stroke-dasharray","5,5").attr("opacity",.5).attr("d",line)}function tip(selection){var innerSelection=selection.selectAll("g.tip").data(function(d){return[d]});innerSelection.enter().append("g").attr("class","tip").attr("clip-path","url(#function-plot-clip-"+config.owner.id+")");tip.el=innerSelection.selectAll("g.inner-tip").data(function(d){return[d]});tip.el.enter().append("g").attr("class","inner-tip").style("display","none").each(function(){var el=d3.select(this);lineGenerator(el,[[0,-config.owner.meta.height-MARGIN],[0,config.owner.meta.height+MARGIN]]).attr("class","tip-x-line").style("display","none");lineGenerator(el,[[-config.owner.meta.width-MARGIN,0],[config.owner.meta.width+MARGIN,0]]).attr("class","tip-y-line").style("display","none");el.append("circle").attr("r",3);el.append("text").attr("transform","translate(5,-5)")});selection.selectAll(".tip-x-line").style("display",config.xLine?null:"none");selection.selectAll(".tip-y-line").style("display",config.yLine?null:"none")}tip.move=function(x0,y0){var i;var minDist=Infinity;var closestIndex=-1;var x,y;var el=tip.el;var inf=1e8;var meta=config.owner.meta;var data=el.data()[0].data;var xScale=meta.xScale;var yScale=meta.yScale;var width=meta.width;var height=meta.height;for(i=0;i<data.length;i+=1){if(data[i].skipTip||data[i].parametric||data[i].points||data[i].implicit||data[i].polar){continue}var range=data[i].range||[-inf,inf];if(x0>range[0]-Const.TIP_X_EPS&&x0<range[1]+Const.TIP_X_EPS){var candidateY=evaluate(data[i],"fn",{x:x0});if(utils.isValidNumber(candidateY)){var tDist=Math.abs(candidateY-y0);if(tDist<minDist){minDist=tDist;closestIndex=i}}}}if(closestIndex!==-1){x=x0;if(data[closestIndex].range){x=Math.max(x,data[closestIndex].range[0]);x=Math.min(x,data[closestIndex].range[1])}y=evaluate(data[closestIndex],"fn",{x:x});tip.show();config.owner.emit("tip:update",x,y,closestIndex);var clampX=utils.clamp(x,xScale.invert(-MARGIN),xScale.invert(width+MARGIN));var clampY=utils.clamp(y,yScale.invert(height+MARGIN),yScale.invert(-MARGIN));el.attr("transform","translate("+xScale(clampX)+","+yScale(clampY)+")");el.select("circle").attr("fill",Const.COLORS[closestIndex]);el.select("text").attr("fill",Const.COLORS[closestIndex]).text(config.renderer(x,y))}else{tip.hide()}};tip.show=function(){this.el.style("display",null)};tip.hide=function(){this.el.style("display","none")};Object.keys(config).forEach(function(option){utils.getterSetter.call(tip,config,option)});return tip}},{"./constants":2,"./helpers/eval":6,"./utils":17,extend:50}],13:[function(require,module,exports){"use strict";module.exports={line:require("./line"),interval:require("./interval"),scatter:require("./scatter")}},{"./interval":14,"./line":15,"./scatter":16}],14:[function(require,module,exports){"use strict";var d3=window.d3;var Const=require("../constants");var dataBuilder=require("../data");module.exports=function(options){var minWidthHeight;var xScale=options.owner.meta.xScale;var yScale=options.owner.meta.yScale;var line=function(points){var path="";for(var i=0,length=points.length;i<length;i+=1){if(points[i]){var x=points[i][0];var y=points[i][1];var yLo=y.lo;var yHi=y.hi;if(options.closed){yLo=Math.min(yLo,0);yHi=Math.max(yHi,0)}var moveX=xScale(x.lo)+points.scaledDx/2;var moveY=yScale(yHi);var diffY=Math.max(yScale(yLo)-yScale(yHi),minWidthHeight);path+=" M "+moveX+" "+moveY;path+=" v "+diffY}}return path};function plotLine(selection){var index=options.index;selection.each(function(data){var el=plotLine.el=d3.select(this);var evaluatedData=dataBuilder.eval(options,data);var innerSelection=el.selectAll(":scope > path.line").data(evaluatedData);minWidthHeight=Math.max(evaluatedData[0].scaledDx,1.5);innerSelection.enter().append("path").attr("class","line line-"+index).attr("stroke",Const.COLORS[index]).attr("fill","none");innerSelection.each(function(){var path=d3.select(this);path.attr("stroke-width",minWidthHeight).attr("opacity",options.closed?.5:1).attr("d",line)});innerSelection.exit().remove()})}return plotLine}},{"../constants":2,"../data":3}],15:[function(require,module,exports){"use strict";var d3=window.d3;var Const=require("../constants");var dataBuilder=require("../data");module.exports=function(options){var xScale=options.owner.meta.xScale;var yScale=options.owner.meta.yScale;var line=d3.svg.line().interpolate("linear").x(function(d){return xScale(d[0])}).y(function(d){return yScale(d[1])});var area=d3.svg.area().x(function(d){return xScale(d[0])}).y0(yScale(0)).y1(function(d){return yScale(d[1])});function plotLine(selection){var index=options.index;selection.each(function(data){var el=plotLine.el=d3.select(this);var evaluatedData=dataBuilder.eval(options,data);var innerSelection=el.selectAll(":scope > path.line").data(evaluatedData);innerSelection.enter().append("path").attr("class","line line-"+index).attr("stroke-width",1.5).attr("stroke-linecap","round").attr("stroke",Const.COLORS[index]);innerSelection.each(function(){var path=d3.select(this);var d;if(options.closed){path.attr("fill",Const.COLORS[index]);path.attr("fill-opacity",.3);d=area}else{path.attr("fill","none");d=line}path.attr("d",d)});innerSelection.exit().remove()})}return plotLine}},{"../constants":2,"../data":3}],16:[function(require,module,exports){"use strict";var d3=window.d3;var Const=require("../constants");var dataBuilder=require("../data");module.exports=function(options){var xScale=options.owner.meta.xScale;var yScale=options.owner.meta.yScale;function scatter(selection){var index=options.index;selection.each(function(data){var i,j;var fill=d3.hsl(Const.COLORS[index].toString());var evaluatedData=dataBuilder.eval(options,data);var joined=[];for(i=0;i<evaluatedData.length;i+=1){for(j=0;j<evaluatedData[i].length;j+=1){joined.push(evaluatedData[i][j])}}var innerSelection=d3.select(this).selectAll(":scope > circle").data(joined);innerSelection.enter().append("circle").attr("fill",d3.hsl(fill.toString()).brighter(1.5)).attr("stroke",fill);innerSelection.attr("opacity",.7).attr("r",1).attr("cx",function(d){return xScale(d[0])}).attr("cy",function(d){return yScale(d[1])});innerSelection.exit().remove()})}return scatter}},{"../constants":2,"../data":3}],17:[function(require,module,exports){"use strict";module.exports={isValidNumber:function(v){return typeof v==="number"&&!isNaN(v)},linspace:function(range,n){var samples=[];var delta=(range[1]-range[0])/(n-1);for(var i=0;i<n;i+=1){samples.push(range[0]+i*delta)}return samples},getterSetter:function(config,option){var me=this;this[option]=function(value){if(!arguments.length){return config[option]}config[option]=value;return me}},clamp:function(v,min,max){if(min>max){var t=min;min=max;max=t}if(v<min){v=min}if(v>max){v=max}return v},sgn:function(v){if(v<0){return-1}if(v>0){return 1}return 0},bySign:function(v,min,max){if(v<0){if(v<min){return v}return min}else{if(v>max){return v}return max}},assert:function(v,message){message=message||"assertion failed";if(!v){throw new Error(message)}}}},{}],18:[function(require,module,exports){"use strict";module.exports=require("./lib/eval")},{"./lib/eval":20}],19:[function(require,module,exports){"use strict";module.exports=function(){var math=Object.create(Math);math.factory=function(a){if(typeof a!=="number"){throw new TypeError("built-in math factory only accepts numbers")}return Number(a)};math.add=function(a,b){return a+b};math.sub=function(a,b){return a-b};math.mul=function(a,b){return a*b};math.div=function(a,b){return a/b};math.mod=function(a,b){return a%b};math.factorial=function(a){var res=1;for(var i=2;i<=a;i+=1){res*=i}return res};math.logicalOR=function(a,b){return a||b};math.logicalXOR=function(a,b){return a!=b};math.logicalAND=function(a,b){return a&&b};math.bitwiseOR=function(a,b){return a|b};math.bitwiseXOR=function(a,b){return a^b};math.bitwiseAND=function(a,b){return a&b};math.lessThan=function(a,b){return a<b};math.lessEqualThan=function(a,b){return a<=b};math.greaterThan=function(a,b){return a>b};math.greaterEqualThan=function(a,b){return a>=b};math.equal=function(a,b){return a==b};math.strictlyEqual=function(a,b){return a===b};math.notEqual=function(a,b){return a!=b};math.strictlyNotEqual=function(a,b){return a!==b};math.shiftRight=function(a,b){return a>>b};math.shiftLeft=function(a,b){return a<<b};math.unsignedRightShift=function(a,b){return a>>>b};math.negative=function(a){return-a};math.positive=function(a){return a};return math}},{}],20:[function(require,module,exports){"use strict";var CodeGenerator=require("math-codegen");var math=require("./adapter")();function processScope(scope){Object.keys(scope).forEach(function(k){var value=scope[k];scope[k]=math.factory(value)})}module.exports=function(expression){
return(new CodeGenerator).setDefs({$$processScope:processScope}).parse(expression).compile(math)};module.exports.math=math},{"./adapter":19,"math-codegen":21}],21:[function(require,module,exports){"use strict";module.exports=require("./lib/CodeGenerator")},{"./lib/CodeGenerator":22}],22:[function(require,module,exports){"use strict";var Parser=require("mr-parser").Parser;var Interpreter=require("./Interpreter");var extend=require("extend");function CodeGenerator(options,defs){this.statements=[];this.defs=defs||{};this.interpreter=new Interpreter(this,options)}CodeGenerator.prototype.setDefs=function(defs){this.defs=extend(this.defs,defs);return this};CodeGenerator.prototype.compile=function(namespace){if(!namespace||!(typeof namespace==="object"||typeof namespace==="function")){throw TypeError("namespace must be an object")}if(typeof namespace.factory!=="function"){throw TypeError("namespace.factory must be a function")}this.defs.ns=namespace;this.defs.$$mathCodegen={getProperty:function(symbol,scope,ns){if(symbol in scope){return scope[symbol]}if(symbol in ns){return ns[symbol]}throw SyntaxError('symbol "'+symbol+'" is undefined')},functionProxy:function(fn,name){if(typeof fn!=="function"){throw SyntaxError('symbol "'+name+'" must be a function')}return fn}};this.defs.$$processScope=this.defs.$$processScope||function(){};var defsCode=Object.keys(this.defs).map(function(name){return"var "+name+' = defs["'+name+'"]'});if(!this.statements.length){throw Error("there are no statements saved in this generator, make sure you parse an expression before compiling it")}this.statements[this.statements.length-1]="return "+this.statements[this.statements.length-1];var code=this.statements.join(";");var factoryCode=defsCode.join("\n")+"\n"+["return {","  eval: function (scope) {","    scope = scope || {}","    $$processScope(scope)","    "+code,"  },","  code: '"+code+"'","}"].join("\n");var factory=new Function("defs",factoryCode);return factory(this.defs)};CodeGenerator.prototype.parse=function(code){var self=this;var program=(new Parser).parse(code);this.statements=program.blocks.map(function(statement){return self.interpreter.next(statement)});return this};module.exports=CodeGenerator},{"./Interpreter":23,extend:34,"mr-parser":35}],23:[function(require,module,exports){"use strict";var extend=require("extend");var types={ArrayNode:require("./node/ArrayNode"),AssignmentNode:require("./node/AssignmentNode"),ConditionalNode:require("./node/ConditionalNode"),ConstantNode:require("./node/ConstantNode"),FunctionNode:require("./node/FunctionNode"),OperatorNode:require("./node/OperatorNode"),SymbolNode:require("./node/SymbolNode"),UnaryNode:require("./node/UnaryNode")};var Interpreter=function(owner,options){this.owner=owner;this.options=extend({factory:"ns.factory",raw:false,rawArrayExpressionElements:true,rawCallExpressionElements:false},options)};extend(Interpreter.prototype,types);Interpreter.prototype.next=function(node){if(!(node.type in this)){throw new TypeError("the node type "+node.type+" is not implemented")}return this[node.type](node)};Interpreter.prototype.rawify=function(test,fn){var oldRaw=this.options.raw;if(test){this.options.raw=true}fn();if(test){this.options.raw=oldRaw}};module.exports=Interpreter},{"./node/ArrayNode":26,"./node/AssignmentNode":27,"./node/ConditionalNode":28,"./node/ConstantNode":29,"./node/FunctionNode":30,"./node/OperatorNode":31,"./node/SymbolNode":32,"./node/UnaryNode":33,extend:34}],24:[function(require,module,exports){"use strict";module.exports={"+":"add","-":"sub","*":"mul","/":"div","^":"pow","%":"mod","!":"factorial","|":"bitwiseOR","^|":"bitwiseXOR","&":"bitwiseAND","||":"logicalOR",xor:"logicalXOR","&&":"logicalAND","<":"lessThan",">":"greaterThan","<=":"lessEqualThan",">=":"greaterEqualThan","===":"strictlyEqual","==":"equal","!==":"strictlyNotEqual","!=":"notEqual",">>":"shiftRight","<<":"shiftLeft",">>>":"unsignedRightShift"}},{}],25:[function(require,module,exports){"use strict";module.exports={"+":"positive","-":"negative","~":"oneComplement"}},{}],26:[function(require,module,exports){"use strict";module.exports=function(node){var self=this;var arr=[];this.rawify(this.options.rawArrayExpressionElements,function(){arr=node.nodes.map(function(el){return self.next(el)})});var arrString="["+arr.join(",")+"]";if(this.options.raw){return arrString}return this.options.factory+"("+arrString+")"}},{}],27:[function(require,module,exports){"use strict";module.exports=function(node){return'scope["'+node.name+'"] = '+this.next(node.expr)}},{}],28:[function(require,module,exports){"use strict";module.exports=function(node){var condition="!!("+this.next(node.condition)+")";var trueExpr=this.next(node.trueExpr);var falseExpr=this.next(node.falseExpr);return"("+condition+" ? ("+trueExpr+") : ("+falseExpr+") )"}},{}],29:[function(require,module,exports){"use strict";module.exports=function(node){if(this.options.raw){return node.value}return this.options.factory+"("+node.value+")"}},{}],30:[function(require,module,exports){"use strict";var SymbolNode=require("mr-parser").nodeTypes.SymbolNode;var functionProxy=function(node){return"$$mathCodegen.functionProxy("+this.next(new SymbolNode(node.name))+', "'+node.name+'")'};module.exports=function(node){var self=this;var method=functionProxy.call(this,node);var args=[];this.rawify(this.options.rawCallExpressionElements,function(){args=node.args.map(function(arg){return self.next(arg)})});return method+"("+args.join(", ")+")"};module.exports.functionProxy=functionProxy},{"mr-parser":35}],31:[function(require,module,exports){"use strict";var Operators=require("../misc/Operators");module.exports=function(node){if(this.options.raw){return["("+this.next(node.args[0]),node.op,this.next(node.args[1])+")"].join(" ")}var namedOperator=Operators[node.op];if(!namedOperator){throw TypeError("unidentified operator")}return this.FunctionNode({name:namedOperator,args:node.args})}},{"../misc/Operators":24}],32:[function(require,module,exports){"use strict";module.exports=function(node){var id=node.name;return'$$mathCodegen.getProperty("'+id+'", scope, ns)'}},{}],33:[function(require,module,exports){"use strict";var UnaryOperators=require("../misc/UnaryOperators");module.exports=function(node){if(this.options.raw){return node.op+this.next(node.argument)}if(!(node.op in UnaryOperators)){throw new SyntaxError(node.op+" not implemented")}var namedOperator=UnaryOperators[node.op];return this.FunctionNode({name:namedOperator,args:[node.argument]})}},{"../misc/UnaryOperators":25}],34:[function(require,module,exports){"use strict";var hasOwn=Object.prototype.hasOwnProperty;var toStr=Object.prototype.toString;var isArray=function isArray(arr){if(typeof Array.isArray==="function"){return Array.isArray(arr)}return toStr.call(arr)==="[object Array]"};var isPlainObject=function isPlainObject(obj){if(!obj||toStr.call(obj)!=="[object Object]"){return false}var hasOwnConstructor=hasOwn.call(obj,"constructor");var hasIsPrototypeOf=obj.constructor&&obj.constructor.prototype&&hasOwn.call(obj.constructor.prototype,"isPrototypeOf");if(obj.constructor&&!hasOwnConstructor&&!hasIsPrototypeOf){return false}var key;for(key in obj){}return typeof key==="undefined"||hasOwn.call(obj,key)};module.exports=function extend(){var options,name,src,copy,copyIsArray,clone,target=arguments[0],i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=arguments[1]||{};i=2}else if(typeof target!=="object"&&typeof target!=="function"||target==null){target={}}for(;i<length;++i){options=arguments[i];if(options!=null){for(name in options){src=target[name];copy=options[name];if(target!==copy){if(deep&&copy&&(isPlainObject(copy)||(copyIsArray=isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&isArray(src)?src:[]}else{clone=src&&isPlainObject(src)?src:{}}target[name]=extend(deep,clone,copy)}else if(typeof copy!=="undefined"){target[name]=copy}}}}}return target}},{}],35:[function(require,module,exports){"use strict";module.exports.Lexer=require("./lib/Lexer");module.exports.Parser=require("./lib/Parser");module.exports.nodeTypes=require("./lib/node/")},{"./lib/Lexer":36,"./lib/Parser":37,"./lib/node/":48}],36:[function(require,module,exports){var tokenType=require("./token-type");var ESCAPES={n:"\n",f:"\f",r:"\r",t:"	",v:"","'":"'",'"':'"'};var DELIMITERS={",":true,"(":true,")":true,"[":true,"]":true,";":true,"~":true,"!":true,"+":true,"-":true,"*":true,"/":true,"%":true,"^":true,"**":true,"|":true,"&":true,"^|":true,"=":true,":":true,"?":true,"||":true,"&&":true,xor:true,"==":true,"!=":true,"===":true,"!==":true,"<":true,">":true,">=":true,"<=":true,">>>":true,"<<":true,">>":true};function isDigit(c){return c>="0"&&c<="9"}function isIdentifier(c){return c>="a"&&c<="z"||c>="A"&&c<="Z"||c==="$"||c==="_"}function isWhitespace(c){return c===" "||c==="\r"||c==="	"||c==="\n"||c===""||c===" "}function isDelimiter(str){return DELIMITERS[str]}function isQuote(c){return c==="'"||c==='"'}function Lexer(){}Lexer.prototype.throwError=function(message,index){index=typeof index==="undefined"?this.index:index;var error=new Error(message+" at index "+index);error.index=index;error.description=message;throw error};Lexer.prototype.lex=function(text){this.text=text;this.index=0;this.tokens=[];while(this.index<this.text.length){while(isWhitespace(this.peek())){this.consume()}var c=this.peek();var c2=c+this.peek(1);var c3=c2+this.peek(2);if(isDelimiter(c3)){this.tokens.push({type:tokenType.DELIMITER,value:c3});this.consume();this.consume();this.consume()}else if(isDelimiter(c2)){this.tokens.push({type:tokenType.DELIMITER,value:c2});this.consume();this.consume()}else if(isDelimiter(c)){this.tokens.push({type:tokenType.DELIMITER,value:c});this.consume()}else if(isDigit(c)||c==="."&&isDigit(this.peek(1))){this.tokens.push({type:tokenType.NUMBER,value:this.readNumber()})}else if(isQuote(c)){this.tokens.push({type:tokenType.STRING,value:this.readString()})}else if(isIdentifier(c)){this.tokens.push({type:tokenType.SYMBOL,value:this.readIdentifier()})}else{this.throwError("unexpected character "+c)}}this.tokens.push({type:tokenType.EOF});return this.tokens};Lexer.prototype.peek=function(nth){nth=nth||0;if(this.index+nth>=this.text.length){return}return this.text.charAt(this.index+nth)};Lexer.prototype.consume=function(){var current=this.peek();this.index+=1;return current};Lexer.prototype.readNumber=function(){var number="";if(this.peek()==="."){number+=this.consume();if(!isDigit(this.peek())){this.throwError("number expected")}}else{while(isDigit(this.peek())){number+=this.consume()}if(this.peek()==="."){number+=this.consume()}}while(isDigit(this.peek())){number+=this.consume()}if(this.peek()==="e"||this.peek()==="E"){number+=this.consume();if(!(isDigit(this.peek())||this.peek()==="+"||this.peek()==="-")){this.throwError()}if(this.peek()==="+"||this.peek()==="-"){number+=this.consume()}if(!isDigit(this.peek())){this.throwError("number expected")}while(isDigit(this.peek())){number+=this.consume()}}return number};Lexer.prototype.readIdentifier=function(){var text="";while(isIdentifier(this.peek())||isDigit(this.peek())){text+=this.consume()}return text};Lexer.prototype.readString=function(){var quote=this.consume();var string="";var escape;while(true){var c=this.consume();if(!c){this.throwError("string is not closed")}if(escape){if(c==="u"){var hex=this.text.substring(this.index+1,this.index+5);if(!hex.match(/[\da-f]{4}/i)){this.throwError("invalid unicode escape")}this.index+=4;string+=String.fromCharCode(parseInt(hex,16))}else{var replacement=ESCAPES[c];if(replacement){string+=replacement}else{string+=c}}escape=false}else if(c===quote){break}else if(c==="\\"){escape=true}else{string+=c}}return string};module.exports=Lexer},{"./token-type":49}],37:[function(require,module,exports){var tokenType=require("./token-type");var Lexer=require("./Lexer");var ConstantNode=require("./node/ConstantNode");var OperatorNode=require("./node/OperatorNode");var UnaryNode=require("./node/UnaryNode");var SymbolNode=require("./node/SymbolNode");var FunctionNode=require("./node/FunctionNode");var ArrayNode=require("./node/ArrayNode");var ConditionalNode=require("./node/ConditionalNode");var AssignmentNode=require("./node/AssignmentNode");var BlockNode=require("./node/BlockNode");function Parser(){this.lexer=new Lexer;this.tokens=null}Parser.prototype.current=function(){return this.tokens[0]};Parser.prototype.next=function(){return this.tokens[1]};Parser.prototype.peek=function(){if(this.tokens.length){var first=this.tokens[0];for(var i=0;i<arguments.length;i+=1){if(first.value===arguments[i]){return true}}}};Parser.prototype.consume=function(e){return this.tokens.shift()};Parser.prototype.expect=function(e){if(!this.peek(e)){throw Error("expected "+e)}return this.consume()};Parser.prototype.isEOF=function(){return this.current().type===tokenType.EOF};Parser.prototype.parse=function(text){this.tokens=this.lexer.lex(text);return this.program()};Parser.prototype.program=function(){var blocks=[];while(!this.isEOF()){blocks.push(this.assignment());if(this.peek(";")){this.consume()}}this.end();return new BlockNode(blocks)};Parser.prototype.assignment=function(){var left=this.ternary();if(left instanceof SymbolNode&&this.peek("=")){this.consume();return new AssignmentNode(left.name,this.assignment())}return left};Parser.prototype.ternary=function(){var predicate=this.logicalOR();if(this.peek("?")){this.consume();var truthy=this.ternary();this.expect(":");var falsy=this.ternary();return new ConditionalNode(predicate,truthy,falsy)}return predicate};Parser.prototype.logicalOR=function(){var left=this.logicalXOR();if(this.peek("||")){var op=this.consume();var right=this.logicalOR();return new OperatorNode(op.value,[left,right])}return left};Parser.prototype.logicalXOR=function(){var left=this.logicalAND();if(this.current().value==="xor"){var op=this.consume();var right=this.logicalXOR();return new OperatorNode(op.value,[left,right])}return left};Parser.prototype.logicalAND=function(){var left=this.bitwiseOR();if(this.peek("&&")){var op=this.consume();var right=this.logicalAND();return new OperatorNode(op.value,[left,right])}return left};Parser.prototype.bitwiseOR=function(){var left=this.bitwiseXOR();if(this.peek("|")){var op=this.consume();var right=this.bitwiseOR();return new OperatorNode(op.value,[left,right])}return left};Parser.prototype.bitwiseXOR=function(){var left=this.bitwiseAND();if(this.peek("^|")){var op=this.consume();var right=this.bitwiseXOR();return new OperatorNode(op.value,[left,right])}return left};Parser.prototype.bitwiseAND=function(){var left=this.relational();if(this.peek("&")){var op=this.consume();var right=this.bitwiseAND();return new OperatorNode(op.value,[left,right])}return left};Parser.prototype.relational=function(){var left=this.shift();if(this.peek("==","===","!=","!==",">=","<=",">","<")){var op=this.consume();var right=this.shift();return new OperatorNode(op.value,[left,right])}return left};Parser.prototype.shift=function(){var left=this.additive();if(this.peek(">>","<<",">>>")){var op=this.consume();var right=this.shift();return new OperatorNode(op.value,[left,right])}return left};Parser.prototype.additive=function(){var left=this.multiplicative();while(this.peek("+","-")){var op=this.consume();left=new OperatorNode(op.value,[left,this.multiplicative()])}return left};Parser.prototype.multiplicative=function(){var op,right;var left=this.unary();while(this.peek("*","/","%")){op=this.consume();left=new OperatorNode(op.value,[left,this.unary()])}if(this.current().type===tokenType.SYMBOL||this.peek("(")||!(left.type instanceof ConstantNode)&&this.current().type===tokenType.NUMBER){right=this.multiplicative();return new OperatorNode("*",[left,right])}return left};Parser.prototype.unary=function(){if(this.peek("-","+","~")){var op=this.consume();var right=this.unary();return new UnaryNode(op.value,right)}return this.pow()};Parser.prototype.pow=function(){var left=this.factorial();if(this.peek("^","**")){var op=this.consume();var right=this.unary();return new OperatorNode(op.value,[left,right])}return left};Parser.prototype.factorial=function(){var left=this.symbol();if(this.peek("!")){var op=this.consume();return new OperatorNode(op.value,[left])}return left};Parser.prototype.symbol=function(){var current=this.current();if(current.type===tokenType.SYMBOL){var symbol=this.consume();var node=this.functionCall(symbol);return node}return this.string()};Parser.prototype.functionCall=function(symbolToken){var name=symbolToken.value;if(this.peek("(")){this.consume();var params=[];while(!this.peek(")")&&!this.isEOF()){params.push(this.assignment());if(this.peek(",")){this.consume()}}this.expect(")");return new FunctionNode(name,params)}return new SymbolNode(name)};Parser.prototype.string=function(){if(this.current().type===tokenType.STRING){return new ConstantNode(this.consume().value,"string")}return this.array()};Parser.prototype.array=function(){if(this.peek("[")){this.consume();var params=[];while(!this.peek("]")&&!this.isEOF()){params.push(this.assignment());if(this.peek(",")){this.consume()}}this.expect("]");return new ArrayNode(params)}return this.number()};Parser.prototype.number=function(){var token=this.current();if(token.type===tokenType.NUMBER){return new ConstantNode(this.consume().value,"number")}return this.parentheses()};Parser.prototype.parentheses=function(){var token=this.current();if(token.value==="("){this.consume();var left=this.assignment();this.expect(")");return left}return this.end()};Parser.prototype.end=function(){var token=this.current();if(token.type!==tokenType.EOF){throw Error("unexpected end of expression")}};module.exports=Parser},{"./Lexer":36,"./node/ArrayNode":38,"./node/AssignmentNode":39,"./node/BlockNode":40,"./node/ConditionalNode":41,"./node/ConstantNode":42,"./node/FunctionNode":43,"./node/OperatorNode":45,"./node/SymbolNode":46,"./node/UnaryNode":47,"./token-type":49}],38:[function(require,module,exports){var Node=require("./Node");function ArrayNode(nodes){this.nodes=nodes}ArrayNode.prototype=Object.create(Node.prototype);ArrayNode.prototype.type="ArrayNode";module.exports=ArrayNode},{"./Node":44}],39:[function(require,module,exports){var Node=require("./Node");function AssignmentNode(name,expr){this.name=name;this.expr=expr}AssignmentNode.prototype=Object.create(Node.prototype);AssignmentNode.prototype.type="AssignmentNode";module.exports=AssignmentNode},{"./Node":44}],40:[function(require,module,exports){var Node=require("./Node");function BlockNode(blocks){this.blocks=blocks}BlockNode.prototype=Object.create(Node.prototype);BlockNode.prototype.type="BlockNode";module.exports=BlockNode},{"./Node":44}],41:[function(require,module,exports){var Node=require("./Node");function ConditionalNode(predicate,truthy,falsy){this.condition=predicate;this.trueExpr=truthy;this.falseExpr=falsy}ConditionalNode.prototype=Object.create(Node.prototype);ConditionalNode.prototype.type="ConditionalNode";module.exports=ConditionalNode},{"./Node":44}],42:[function(require,module,exports){var Node=require("./Node");var SUPPORTED_TYPES={number:true,string:true,"boolean":true,undefined:true,"null":true};function ConstantNode(value,type){if(!SUPPORTED_TYPES[type]){throw Error("unsupported type '"+type+"'")}this.value=value;this.valueType=type}ConstantNode.prototype=Object.create(Node.prototype);ConstantNode.prototype.type="ConstantNode";module.exports=ConstantNode},{"./Node":44}],43:[function(require,module,exports){var Node=require("./Node");function FunctionNode(name,args){this.name=name;this.args=args}FunctionNode.prototype=Object.create(Node.prototype);FunctionNode.prototype.type="FunctionNode";module.exports=FunctionNode},{"./Node":44}],44:[function(require,module,exports){function Node(){}Node.prototype.type="Node";module.exports=Node},{}],45:[function(require,module,exports){var Node=require("./Node");function OperatorNode(op,args){this.op=op;this.args=args||[]}OperatorNode.prototype=Object.create(Node.prototype);OperatorNode.prototype.type="OperatorNode";module.exports=OperatorNode},{"./Node":44}],46:[function(require,module,exports){var Node=require("./Node");function SymbolNode(name){this.name=name}SymbolNode.prototype=Object.create(Node.prototype);SymbolNode.prototype.type="SymbolNode";module.exports=SymbolNode},{"./Node":44}],47:[function(require,module,exports){var Node=require("./Node");function UnaryNode(op,argument){this.op=op;this.argument=argument}UnaryNode.prototype=Object.create(Node.prototype);UnaryNode.prototype.type="UnaryNode";module.exports=UnaryNode},{"./Node":44}],48:[function(require,module,exports){module.exports={ArrayNode:require("./ArrayNode"),AssignmentNode:require("./AssignmentNode"),BlockNode:require("./BlockNode"),ConditionalNode:require("./ConditionalNode"),ConstantNode:require("./ConstantNode"),FunctionNode:require("./FunctionNode"),Node:require("./Node"),OperatorNode:require("./OperatorNode"),SymbolNode:require("./SymbolNode"),UnaryNode:require("./UnaryNode")}},{"./ArrayNode":38,"./AssignmentNode":39,"./BlockNode":40,"./ConditionalNode":41,"./ConstantNode":42,"./FunctionNode":43,"./Node":44,"./OperatorNode":45,"./SymbolNode":46,"./UnaryNode":47}],49:[function(require,module,exports){module.exports={EOF:0,DELIMITER:1,NUMBER:2,STRING:3,SYMBOL:4}},{}],50:[function(require,module,exports){arguments[4][34][0].apply(exports,arguments)},{dup:34}],51:[function(require,module,exports){"use strict";module.exports=require("./lib/eval")},{"./lib/eval":53}],52:[function(require,module,exports){"use strict";module.exports=function(ns){ns.mod=ns.fmod;ns.lessThan=ns.lt;ns.lessEqualThan=ns.leq;ns.greaterThan=ns.gt;ns.greaterEqualThan=ns.geq;ns.strictlyEqual=ns.equal;ns.strictlyNotEqual=ns.notEqual;ns.logicalAND=function(a,b){return a&&b};ns.logicalXOR=function(a,b){return a^b};ns.logicalOR=function(a,b){return a||b}}},{}],53:[function(require,module,exports){"use strict";var CodeGenerator=require("math-codegen");var Interval=require("interval-arithmetic");require("./adapter")(Interval);function processScope(scope){Object.keys(scope).forEach(function(k){var value=scope[k];if(typeof value==="number"||Array.isArray(value)){scope[k]=Interval.factory(value)}else if(typeof value==="object"&&"lo"in value&&"hi"in value){scope[k]=Interval.factory(value.lo,value.hi)}})}module.exports=function(expression){return(new CodeGenerator).setDefs({$$processScope:processScope}).parse(expression).compile(Interval)};module.exports.policies=require("./policies")(Interval);module.exports.Interval=Interval},{"./adapter":52,"./policies":54,"interval-arithmetic":55,"math-codegen":68}],54:[function(require,module,exports){"use strict";module.exports=function(Interval){return{disableRounding:function(){Interval.rmath.disable()},enableRounding:function(){Interval.rmath.enable()}}}},{}],55:[function(require,module,exports){"use strict";function shallowExtend(){var dest=arguments[0];var p;for(var i=1;i<arguments.length;i+=1){for(p in arguments[i]){if(arguments[i].hasOwnProperty(p)){dest[p]=arguments[i][p]}}}}module.exports=require("./lib/interval");module.exports.rmath=require("./lib/round-math");module.exports.double=require("./lib/double");shallowExtend(module.exports,require("./lib/constants"),require("./lib/operations/relational"),require("./lib/operations/arithmetic"),require("./lib/operations/algebra"),require("./lib/operations/trigonometric"),require("./lib/operations/misc"),require("./lib/operations/utils"))},{"./lib/constants":56,"./lib/double":57,"./lib/interval":58,"./lib/operations/algebra":59,"./lib/operations/arithmetic":60,"./lib/operations/misc":62,"./lib/operations/relational":63,"./lib/operations/trigonometric":64,"./lib/operations/utils":65,"./lib/round-math":67}],56:[function(require,module,exports){"use strict";var Interval=require("./interval");var piLow=(3373259426+273688/(1<<21))/(1<<30);var piHigh=(3373259426+273689/(1<<21))/(1<<30);var constants={};constants.PI_LOW=piLow;constants.PI_HIGH=piHigh;constants.PI_HALF_LOW=piLow/2;constants.PI_HALF_HIGH=piHigh/2;constants.PI_TWICE_LOW=piLow*2;constants.PI_TWICE_HIGH=piHigh*2;constants.PI=new Interval(piLow,piHigh);constants.PI_HALF=new Interval(constants.PI_HALF_LOW,constants.PI_HALF_HIGH);constants.PI_TWICE=new Interval(constants.PI_TWICE_LOW,constants.PI_TWICE_HIGH);constants.ZERO=new Interval(0,0);constants.ONE=new Interval(1,1);constants.WHOLE=(new Interval).setWhole();constants.EMPTY=(new Interval).setEmpty();module.exports=constants},{"./interval":58}],57:[function(require,module,exports){"use strict";var buffer=new ArrayBuffer(8);var dv=new DataView(buffer);var array8=new Uint8Array(buffer);function float64ToOctets(number){dv.setFloat64(0,number,false);return[].slice.call(new Uint8Array(buffer))}function octetsToFloat64(octets){array8.set(octets);return dv.getFloat64(0,false)}function add(bytes,n){for(var i=7;i>=0;i-=1){bytes[i]+=n;if(bytes[i]===256){n=1;bytes[i]=0}else if(bytes[i]===-1){n=-1;bytes[i]=255}else{n=0}}}function solve(a,b){if(a===Number.POSITIVE_INFINITY||a===Number.NEGATIVE_INFINITY||isNaN(a)){return a}var bytes=float64ToOctets(a);add(bytes,b);return octetsToFloat64(bytes)}exports.doubleToOctetArray=float64ToOctets;exports.ieee754NextDouble=function(n){return solve(n,1)};exports.ieee754PrevDouble=function(n){return solve(n,-1)}},{}],58:[function(require,module,exports){"use strict";var utils=require("./operations/utils");var rmath=require("./round-math");function Interval(lo,hi){switch(arguments.length){case 1:if(typeof lo!=="number"){throw new TypeError("lo must be a number")}this.set(lo,lo);if(isNaN(lo)){this.setEmpty()}break;case 2:if(typeof lo!=="number"||typeof hi!=="number"){throw new TypeError("lo,hi must be numbers")}this.set(lo,hi);if(isNaN(lo)||isNaN(hi)||lo>hi){this.setEmpty()}break;default:this.lo=0;this.hi=0;break}}Interval.factory=function(a,b){function assert(a,message){if(!a){throw new Error(message||"assertion failed")}}function singleton(x){if(typeof x==="object"){assert(typeof x.lo==="number"&&typeof x.hi==="number","param must be an Interval");assert(utils.singleton(x),"param needs to be a singleton")}}function getNumber(x){if(typeof x==="object"){singleton(x);return x.lo}return x}assert(arguments.length<=2);var lo,hi;if(arguments.length===2){lo=getNumber(a);hi=getNumber(b)}else if(arguments.length===1){if(Array.isArray(a)){lo=a[0];hi=a[1]}else{lo=hi=getNumber(a)}}else{return new Interval}return new Interval(lo,hi)};Interval.prototype.singleton=function(v){return this.set(v,v)};Interval.prototype.bounded=function(lo,hi){return this.set(rmath.prev(lo),rmath.next(hi))};Interval.prototype.boundedSingleton=function(v){return this.bounded(v,v)};Interval.prototype.set=function(lo,hi){this.lo=lo;this.hi=hi;return this};Interval.prototype.assign=function(lo,hi){if(isNaN(lo)||isNaN(hi)||lo>hi){return this.setEmpty()}return this.set(lo,hi)};Interval.prototype.setEmpty=function(){return this.set(Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY)};Interval.prototype.setWhole=function(){return this.set(Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY)};Interval.prototype.toArray=function(){return[this.lo,this.hi]};module.exports=Interval},{"./operations/utils":65,"./round-math":67}],59:[function(require,module,exports){"use strict";var Interval=require("../interval");var rmath=require("../round-math");var utils=require("./utils");var arithmetic=require("./arithmetic");var constants=require("../constants");var algebra={};algebra.fmod=function(x,y){if(utils.empty(x)||utils.empty(y)){return constants.EMPTY}var yb=x.lo<0?y.lo:y.hi;var n=rmath.intLo(rmath.divLo(x.lo,yb));return arithmetic.sub(x,arithmetic.mul(y,new Interval(n,n)))};algebra.multiplicativeInverse=function(x){if(utils.empty(x)){return constants.EMPTY}if(utils.zeroIn(x)){if(x.lo!==0){if(x.hi!==0){return constants.WHOLE}else{return new Interval(Number.NEGATIVE_INFINITY,rmath.divHi(1,x.lo))}}else{if(x.hi!==0){return new Interval(rmath.divLo(1,x.hi),Number.POSITIVE_INFINITY)}else{return constants.EMPTY}}}else{return new Interval(rmath.divLo(1,x.hi),rmath.divHi(1,x.lo))}};algebra.pow=function(x,power){if(utils.empty(x)){return constants.EMPTY}if(typeof power==="object"){if(!utils.singleton(power)){return constants.EMPTY}power=power.lo}if(power===0){if(x.lo===0&&x.hi===0){return constants.EMPTY}else{return constants.ONE}}else if(power<0){return algebra.multiplicativeInverse(algebra.pow(x,-power))}if(x.hi<0){var yl=rmath.powLo(-x.hi,power);var yh=rmath.powHi(-x.lo,power);if(power&1){return new Interval(-yh,-yl)}else{return new Interval(yl,yh)}}else if(x.lo<0){if(power&1){return new Interval(-rmath.powLo(-x.lo,power),rmath.powHi(x.hi,power))}else{return new Interval(0,rmath.powHi(Math.max(-x.lo,x.hi),power))}}else{return new Interval(rmath.powLo(x.lo,power),rmath.powHi(x.hi,power))}};algebra.sqrt=function(x){if(utils.empty(x)||x.hi<0){return constants.EMPTY}var t=x.lo<=0?0:rmath.sqrtLo(x.lo);return new Interval(t,rmath.sqrtHi(x.hi))};module.exports=algebra},{"../constants":56,"../interval":58,"../round-math":67,"./arithmetic":60,"./utils":65}],60:[function(require,module,exports){"use strict";var Interval=require("../interval");var rmath=require("../round-math");var utils=require("./utils");var constants=require("../constants");var division=require("./division");var arithmetic={};arithmetic.add=function(a,b){return new Interval(rmath.addLo(a.lo,b.lo),rmath.addHi(a.hi,b.hi))};arithmetic.sub=function(a,b){return new Interval(rmath.subLo(a.lo,b.hi),rmath.subHi(a.hi,b.lo))};arithmetic.mul=function(a,b){if(utils.empty(a)||utils.empty(b)){return constants.EMPTY}var al=a.lo;var ah=a.hi;var bl=b.lo;var bh=b.hi;var out=new Interval;if(al<0){if(ah>0){if(bl<0){if(bh>0){out.lo=Math.min(rmath.mulLo(al,bh),rmath.mulLo(ah,bl));out.hi=Math.max(rmath.mulHi(al,bl),rmath.mulHi(ah,bh))}else{out.lo=rmath.mulLo(ah,bl);out.hi=rmath.mulHi(al,bl)}}else{if(bh>0){out.lo=rmath.mulLo(al,bh);out.hi=rmath.mulHi(ah,bh)}else{out.lo=0;out.hi=0}}}else{if(bl<0){if(bh>0){out.lo=rmath.mulLo(al,bh);out.hi=rmath.mulHi(al,bl)}else{out.lo=rmath.mulLo(ah,bh);out.hi=rmath.mulHi(al,bl)}}else{if(bh>0){out.lo=rmath.mulLo(al,bh);out.hi=rmath.mulHi(ah,bl)}else{out.lo=0;out.hi=0}}}}else{if(ah>0){if(bl<0){if(bh>0){out.lo=rmath.mulLo(ah,bl);out.hi=rmath.mulHi(ah,bh)}else{out.lo=rmath.mulLo(ah,bl);out.hi=rmath.mulHi(al,bh)}}else{if(bh>0){out.lo=rmath.mulLo(al,bl);out.hi=rmath.mulHi(ah,bh)}else{out.lo=0;out.hi=0}}}else{out.lo=0;out.hi=0}}return out};arithmetic.div=function(a,b){if(utils.empty(a)||utils.empty(b)){return constants.EMPTY}if(utils.zeroIn(b)){if(b.lo!==0){if(b.hi!==0){return division.zero(a)}else{return division.negative(a,b.lo)}}else{if(b.hi!==0){return division.positive(a,b.hi)}else{return constants.EMPTY}}}else{return division.nonZero(a,b)}};arithmetic.positive=function(a){return new Interval(a.lo,a.hi)};arithmetic.negative=function(a){return new Interval(-a.hi,-a.lo)};module.exports=arithmetic},{"../constants":56,"../interval":58,"../round-math":67,"./division":61,"./utils":65}],61:[function(require,module,exports){"use strict";var Interval=require("../interval");var rmath=require("../round-math");var utils=require("./utils");var constants=require("../constants");var division={nonZero:function(x,y){var xl=x.lo;var xh=x.hi;var yl=y.lo;var yh=y.hi;var out=new Interval;if(xh<0){if(yh<0){out.lo=rmath.divLo(xh,yl);out.hi=rmath.divHi(xl,yh)}else{out.lo=rmath.divLo(xl,yl);out.hi=rmath.divHi(xh,yh)}}else if(xl<0){if(yh<0){out.lo=rmath.divLo(xh,yh);out.hi=rmath.divHi(xl,yh)}else{out.lo=rmath.divLo(xl,yl);out.hi=rmath.divHi(xh,yl)}}else{if(yh<0){out.lo=rmath.divLo(xh,yh);out.hi=rmath.divHi(xl,yl)}else{out.lo=rmath.divLo(xl,yh);out.hi=rmath.divHi(xh,yl)}}return out},positive:function(x,v){if(x.lo===0&&x.hi===0){return x}if(utils.zeroIn(x)){return constants.WHOLE}if(x.hi<0){return new Interval(Number.NEGATIVE_INFINITY,rmath.divHi(x.hi,v))}else{return new Interval(rmath.divLo(x.lo,v),Number.POSITIVE_INFINITY)}},negative:function(x,v){if(x.lo===0&&x.hi===0){return x}if(utils.zeroIn(x)){
return constants.WHOLE}if(x.hi<0){return new Interval(rmath.divLo(x.hi,v),Number.POSITIVE_INFINITY)}else{return new Interval(Number.NEGATIVE_INFINITY,rmath.divHi(x.lo,v))}},zero:function(x){if(x.lo===0&&x.hi===0){return x}return constants.WHOLE}};module.exports=division},{"../constants":56,"../interval":58,"../round-math":67,"./utils":65}],62:[function(require,module,exports){"use strict";var constants=require("../constants");var Interval=require("../interval");var rmath=require("../round-math");var utils=require("./utils");var arithmetic=require("./arithmetic");var misc={};misc.exp=function(x){if(utils.empty(x)){return constants.EMPTY}return new Interval(rmath.expLo(x.lo),rmath.expHi(x.hi))};misc.log=function(x){if(utils.empty(x)){return constants.EMPTY}var l=x.lo<=0?Number.NEGATIVE_INFINITY:rmath.logLo(x.lo);return new Interval(l,rmath.logHi(x.hi))};misc.ln=misc.log;misc.LOG_EXP_10=misc.log(new Interval(10,10));misc.log10=function(x){if(utils.empty(x)){return constants.EMPTY}return arithmetic.div(misc.log(x),misc.LOG_EXP_10)};misc.LOG_EXP_2=misc.log(new Interval(2,2));misc.log2=function(x){if(utils.empty(x)){return constants.EMPTY}return arithmetic.div(misc.log(x),misc.LOG_EXP_2)};misc.hull=function(x,y){var badX=utils.empty(x);var badY=utils.empty(y);if(badX){if(badY){return constants.EMPTY}else{return y}}else{if(badY){return x}else{return new Interval(Math.min(x.lo,y.lo),Math.max(x.hi,y.hi))}}};misc.intersect=function(x,y){if(utils.empty(x)||utils.empty(y)){return constants.EMPTY}var lo=Math.max(x.lo,y.lo);var hi=Math.min(x.hi,y.hi);if(lo<=hi){return new Interval(lo,hi)}return constants.EMPTY};misc.abs=function(x){if(utils.empty(x)){return constants.EMPTY}if(x.lo>=0){return x}if(x.hi<=0){return arithmetic.negative(x)}return new Interval(0,Math.max(-x.lo,x.hi))};misc.max=function(x,y){if(utils.empty(x)){return constants.EMPTY}return new Interval(Math.max(x.lo,y.lo),Math.max(x.hi,y.hi))};misc.min=function(x,y){if(utils.empty(x)){return constants.EMPTY}return new Interval(Math.min(x.lo,y.lo),Math.min(x.hi,y.hi))};misc.clone=function(x){return(new Interval).set(x.lo,x.hi)};module.exports=misc},{"../constants":56,"../interval":58,"../round-math":67,"./arithmetic":60,"./utils":65}],63:[function(require,module,exports){"use strict";var utils=require("./utils");var relational={};relational.equal=function(x,y){if(utils.empty(x)){return utils.empty(y)}return!utils.empty(y)&&x.lo===y.lo&&x.hi===y.hi};relational.almostEqual=function(x,y){var EPS=1e-7;function assert(a,message){if(!a){throw new Error(message||"assertion failed")}}function assertEps(a,b){assert(Math.abs(a-b)<EPS)}x=Array.isArray(x)?x:x.toArray();y=Array.isArray(y)?y:y.toArray();assertEps(x[0],y[0]);assertEps(x[1],y[1]);assert(x[0]<=x[1],"interval must not be empty")};relational.notEqual=function(x,y){if(utils.empty(x)){return!utils.empty(y)}return utils.empty(y)||x.hi<y.lo||x.lo>y.hi};relational.lt=function(x,y){if(utils.empty(x)||utils.empty(y)){return false}return x.hi<y.lo};relational.gt=function(x,y){if(utils.empty(x)||utils.empty(y)){return false}return x.lo>y.hi};relational.leq=function(x,y){if(utils.empty(x)||utils.empty(y)){return false}return x.hi<=y.lo};relational.geq=function(x,y){if(utils.empty(x)||utils.empty(y)){return false}return x.lo>=y.hi};module.exports=relational},{"./utils":65}],64:[function(require,module,exports){"use strict";var constants=require("../constants");var Interval=require("../interval");var rmath=require("../round-math");var utils=require("./utils");var algebra=require("./algebra");var arithmetic=require("./arithmetic");var trigonometric={};trigonometric.cos=function(x){var rlo,rhi;if(utils.empty(x)){return constants.EMPTY}if(x.lo<0){var mult=1e7;x.lo+=2*Math.PI*mult;x.hi+=2*Math.PI*mult}var pi2=constants.PI_TWICE;var t=algebra.fmod(x,pi2);if(utils.width(t)>=pi2.lo){return new Interval(-1,1)}if(t.lo>=constants.PI_HIGH){var cos=trigonometric.cos(arithmetic.sub(t,constants.PI));return arithmetic.negative(cos)}var lo=t.lo;var hi=t.hi;rlo=rmath.cosLo(hi);rhi=rmath.cosHi(lo);if(hi<=constants.PI_LOW){return new Interval(rlo,rhi)}else if(hi<=pi2.lo){return new Interval(-1,Math.max(rlo,rhi))}else{return new Interval(-1,1)}};trigonometric.sin=function(x){if(utils.empty(x)){return constants.EMPTY}return trigonometric.cos(arithmetic.sub(x,constants.PI_HALF))};trigonometric.tan=function(x){if(utils.empty(x)){return constants.EMPTY}if(x.lo<0){var mult=1e7;x.lo+=2*Math.PI*mult;x.hi+=2*Math.PI*mult}var pi=constants.PI;var t=algebra.fmod(x,pi);if(t.lo>=constants.PI_HALF_LOW){t=arithmetic.sub(t,pi)}if(t.lo<=-constants.PI_HALF_LOW||t.hi>=constants.PI_HALF_LOW){return constants.WHOLE}return new Interval(rmath.tanLo(t.lo),rmath.tanHi(t.hi))};trigonometric.asin=function(x){if(utils.empty(x)||x.hi<-1||x.lo>1){return constants.EMPTY}var lo=x.lo<=-1?-constants.PI_HALF_HIGH:rmath.asinLo(x.lo);var hi=x.hi>=1?constants.PI_HALF_HIGH:rmath.asinHi(x.hi);return new Interval(lo,hi)};trigonometric.acos=function(x){if(utils.empty(x)||x.hi<-1||x.lo>1){return constants.EMPTY}var lo=x.hi>=1?0:rmath.acosLo(x.hi);var hi=x.lo<=-1?constants.PI_HIGH:rmath.acosHi(x.lo);return new Interval(lo,hi)};trigonometric.atan=function(x){if(utils.empty(x)){return constants.EMPTY}return new Interval(rmath.atanLo(x.lo),rmath.atanHi(x.hi))};trigonometric.sinh=function(x){if(utils.empty(x)){return constants.EMPTY}return new Interval(rmath.sinhLo(x.lo),rmath.sinhHi(x.hi))};trigonometric.cosh=function(x){if(utils.empty(x)){return constants.EMPTY}if(x.hi<0){return new Interval(rmath.coshLo(x.hi),rmath.coshHi(x.lo))}else if(x.lo>=0){return new Interval(rmath.coshLo(x.lo),rmath.coshHi(x.hi))}else{return new Interval(1,rmath.coshHi(-x.lo>x.hi?x.lo:x.hi))}};trigonometric.tanh=function(x){if(utils.empty(x)){return constants.EMPTY}return new Interval(rmath.tanhLo(x.lo),rmath.tanhHi(x.hi))};module.exports=trigonometric},{"../constants":56,"../interval":58,"../round-math":67,"./algebra":59,"./arithmetic":60,"./utils":65}],65:[function(require,module,exports){"use strict";var rmath=require("../round-math");var utils={};utils.empty=function(a){return a.lo>a.hi};utils.whole=function(a){return a.lo===-Infinity&&a.hi===Infinity};utils.zeroIn=function(a){return utils.in(a,0)};utils.in=function(a,v){if(utils.empty(a)){return false}return a.lo<=v&&v<=a.hi};utils.subset=function(a,b){if(utils.empty(a)){return true}return!utils.empty(b)&&b.lo<=a.lo&&a.hi<=b.hi};utils.overlap=function(a,b){if(utils.empty(a)||utils.empty(b)){return false}return a.lo<=b.lo&&b.lo<=a.hi||b.lo<=a.lo&&a.lo<=b.hi};utils.singleton=function(x){return!utils.empty(x)&&x.lo===x.hi};utils.width=function(x){if(utils.empty(x)){return 0}return rmath.subHi(x.hi,x.lo)};module.exports=utils},{"../round-math":67}],66:[function(require,module,exports){"use strict";Math.sinh=Math.sinh||function(x){var y=Math.exp(x);return(y-1/y)/2};Math.cosh=Math.cosh||function(x){var y=Math.exp(x);return(y+1/y)/2};Math.tanh=Math.tanh||function(x){if(x===Number.POSITIVE_INFINITY){return 1}else if(x===Number.NEGATIVE_INFINITY){return-1}else{var y=Math.exp(2*x);return(y-1)/(y+1)}}},{}],67:[function(require,module,exports){"use strict";require("./polyfill");var double=require("./double");var round={};var MIN_VALUE=double.ieee754NextDouble(0);round.POSITIVE_ZERO=+0;round.NEGATIVE_ZERO=-0;var oldNext;var next=oldNext=round.next=function(v){if(v===0){return MIN_VALUE}if(Math.abs(v)<Number.POSITIVE_INFINITY){if(v>0){return double.ieee754NextDouble(v)}else{return double.ieee754PrevDouble(v)}}return v};var oldPrev;var prev=oldPrev=round.prev=function(v){return-next(-v)};round.addLo=function(x,y){return prev(x+y)};round.addHi=function(x,y){return next(x+y)};round.subLo=function(x,y){return prev(x-y)};round.subHi=function(x,y){return next(x-y)};round.mulLo=function(x,y){return prev(x*y)};round.mulHi=function(x,y){return next(x*y)};round.divLo=function(x,y){return prev(x/y)};round.divHi=function(x,y){return next(x/y)};function toInteger(x){return x<0?Math.ceil(x):Math.floor(x)}round.intLo=function(x){return toInteger(prev(x))};round.intHi=function(x){return toInteger(next(x))};round.logLo=function(x){return prev(Math.log(x))};round.logHi=function(x){return next(Math.log(x))};round.expLo=function(x){return prev(Math.exp(x))};round.expHi=function(x){return next(Math.exp(x))};round.sinLo=function(x){return prev(Math.sin(x))};round.sinHi=function(x){return next(Math.sin(x))};round.cosLo=function(x){return prev(Math.cos(x))};round.cosHi=function(x){return next(Math.cos(x))};round.tanLo=function(x){return prev(Math.tan(x))};round.tanHi=function(x){return next(Math.tan(x))};round.asinLo=function(x){return prev(Math.asin(x))};round.asinHi=function(x){return next(Math.asin(x))};round.acosLo=function(x){return prev(Math.acos(x))};round.acosHi=function(x){return next(Math.acos(x))};round.atanLo=function(x){return prev(Math.atan(x))};round.atanHi=function(x){return next(Math.atan(x))};round.sinhLo=function(x){return prev(Math.sinh(x))};round.sinhHi=function(x){return next(Math.sinh(x))};round.coshLo=function(x){return prev(Math.cosh(x))};round.coshHi=function(x){return next(Math.cosh(x))};round.tanhLo=function(x){return prev(Math.tanh(x))};round.tanhHi=function(x){return next(Math.tanh(x))};round.powLo=function(x,power){if(power%1!==0){return prev(Math.pow(x,power))}var y=power&1?x:1;power>>=1;while(power>0){x=round.mulLo(x,x);if(power&1){y=round.mulLo(x,y)}power>>=1}return y};round.powHi=function(x,power){if(power%1!==0){return next(Math.pow(x,power))}var y=power&1?x:1;power>>=1;while(power>0){x=round.mulHi(x,x);if(power&1){y=round.mulHi(x,y)}power>>=1}return y};round.sqrtLo=function(x){return prev(Math.sqrt(x))};round.sqrtHi=function(x){return next(Math.sqrt(x))};round.disable=function(){next=prev=round.next=round.prev=function(v){return v}};round.enable=function(){prev=round.prev=oldPrev;next=round.next=oldNext};module.exports=round},{"./double":57,"./polyfill":66}],68:[function(require,module,exports){arguments[4][21][0].apply(exports,arguments)},{"./lib/CodeGenerator":69,dup:21}],69:[function(require,module,exports){arguments[4][22][0].apply(exports,arguments)},{"./Interpreter":70,dup:22,extend:50,"mr-parser":81}],70:[function(require,module,exports){arguments[4][23][0].apply(exports,arguments)},{"./node/ArrayNode":73,"./node/AssignmentNode":74,"./node/ConditionalNode":75,"./node/ConstantNode":76,"./node/FunctionNode":77,"./node/OperatorNode":78,"./node/SymbolNode":79,"./node/UnaryNode":80,dup:23,extend:50}],71:[function(require,module,exports){arguments[4][24][0].apply(exports,arguments)},{dup:24}],72:[function(require,module,exports){arguments[4][25][0].apply(exports,arguments)},{dup:25}],73:[function(require,module,exports){arguments[4][26][0].apply(exports,arguments)},{dup:26}],74:[function(require,module,exports){arguments[4][27][0].apply(exports,arguments)},{dup:27}],75:[function(require,module,exports){arguments[4][28][0].apply(exports,arguments)},{dup:28}],76:[function(require,module,exports){arguments[4][29][0].apply(exports,arguments)},{dup:29}],77:[function(require,module,exports){arguments[4][30][0].apply(exports,arguments)},{dup:30,"mr-parser":81}],78:[function(require,module,exports){arguments[4][31][0].apply(exports,arguments)},{"../misc/Operators":71,dup:31}],79:[function(require,module,exports){arguments[4][32][0].apply(exports,arguments)},{dup:32}],80:[function(require,module,exports){arguments[4][33][0].apply(exports,arguments)},{"../misc/UnaryOperators":72,dup:33}],81:[function(require,module,exports){arguments[4][35][0].apply(exports,arguments)},{"./lib/Lexer":82,"./lib/Parser":83,"./lib/node/":94,dup:35}],82:[function(require,module,exports){arguments[4][36][0].apply(exports,arguments)},{"./token-type":95,dup:36}],83:[function(require,module,exports){arguments[4][37][0].apply(exports,arguments)},{"./Lexer":82,"./node/ArrayNode":84,"./node/AssignmentNode":85,"./node/BlockNode":86,"./node/ConditionalNode":87,"./node/ConstantNode":88,"./node/FunctionNode":89,"./node/OperatorNode":91,"./node/SymbolNode":92,"./node/UnaryNode":93,"./token-type":95,dup:37}],84:[function(require,module,exports){arguments[4][38][0].apply(exports,arguments)},{"./Node":90,dup:38}],85:[function(require,module,exports){arguments[4][39][0].apply(exports,arguments)},{"./Node":90,dup:39}],86:[function(require,module,exports){arguments[4][40][0].apply(exports,arguments)},{"./Node":90,dup:40}],87:[function(require,module,exports){arguments[4][41][0].apply(exports,arguments)},{"./Node":90,dup:41}],88:[function(require,module,exports){arguments[4][42][0].apply(exports,arguments)},{"./Node":90,dup:42}],89:[function(require,module,exports){arguments[4][43][0].apply(exports,arguments)},{"./Node":90,dup:43}],90:[function(require,module,exports){arguments[4][44][0].apply(exports,arguments)},{dup:44}],91:[function(require,module,exports){arguments[4][45][0].apply(exports,arguments)},{"./Node":90,dup:45}],92:[function(require,module,exports){arguments[4][46][0].apply(exports,arguments)},{"./Node":90,dup:46}],93:[function(require,module,exports){arguments[4][47][0].apply(exports,arguments)},{"./Node":90,dup:47}],94:[function(require,module,exports){arguments[4][48][0].apply(exports,arguments)},{"./ArrayNode":84,"./AssignmentNode":85,"./BlockNode":86,"./ConditionalNode":87,"./ConstantNode":88,"./FunctionNode":89,"./Node":90,"./OperatorNode":91,"./SymbolNode":92,"./UnaryNode":93,dup:48}],95:[function(require,module,exports){arguments[4][49][0].apply(exports,arguments)},{dup:49}],96:[function(require,module,exports){function EventEmitter(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined}module.exports=EventEmitter;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=undefined;EventEmitter.prototype._maxListeners=undefined;EventEmitter.defaultMaxListeners=10;EventEmitter.prototype.setMaxListeners=function(n){if(!isNumber(n)||n<0||isNaN(n))throw TypeError("n must be a positive number");this._maxListeners=n;return this};EventEmitter.prototype.emit=function(type){var er,handler,len,args,i,listeners;if(!this._events)this._events={};if(type==="error"){if(!this._events.error||isObject(this._events.error)&&!this._events.error.length){er=arguments[1];if(er instanceof Error){throw er}throw TypeError('Uncaught, unspecified "error" event.')}}handler=this._events[type];if(isUndefined(handler))return false;if(isFunction(handler)){switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:len=arguments.length;args=new Array(len-1);for(i=1;i<len;i++)args[i-1]=arguments[i];handler.apply(this,args)}}else if(isObject(handler)){len=arguments.length;args=new Array(len-1);for(i=1;i<len;i++)args[i-1]=arguments[i];listeners=handler.slice();len=listeners.length;for(i=0;i<len;i++)listeners[i].apply(this,args)}return true};EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events)this._events={};if(this._events.newListener)this.emit("newListener",type,isFunction(listener.listener)?listener.listener:listener);if(!this._events[type])this._events[type]=listener;else if(isObject(this._events[type]))this._events[type].push(listener);else this._events[type]=[this._events[type],listener];if(isObject(this._events[type])&&!this._events[type].warned){var m;if(!isUndefined(this._maxListeners)){m=this._maxListeners}else{m=EventEmitter.defaultMaxListeners}if(m&&m>0&&this._events[type].length>m){this._events[type].warned=true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this._events[type].length);if(typeof console.trace==="function"){console.trace()}}}return this};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.once=function(type,listener){if(!isFunction(listener))throw TypeError("listener must be a function");var fired=false;function g(){this.removeListener(type,g);if(!fired){fired=true;listener.apply(this,arguments)}}g.listener=listener;this.on(type,g);return this};EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;list=this._events[type];length=list.length;position=-1;if(list===listener||isFunction(list.listener)&&list.listener===listener){delete this._events[type];if(this._events.removeListener)this.emit("removeListener",type,listener)}else if(isObject(list)){for(i=length;i-->0;){if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}}if(position<0)return this;if(list.length===1){list.length=0;delete this._events[type]}else{list.splice(position,1)}if(this._events.removeListener)this.emit("removeListener",type,listener)}return this};EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===0)this._events={};else if(this._events[type])delete this._events[type];return this}if(arguments.length===0){for(key in this._events){if(key==="removeListener")continue;this.removeAllListeners(key)}this.removeAllListeners("removeListener");this._events={};return this}listeners=this._events[type];if(isFunction(listeners)){this.removeListener(type,listeners)}else{while(listeners.length)this.removeListener(type,listeners[listeners.length-1])}delete this._events[type];return this};EventEmitter.prototype.listeners=function(type){var ret;if(!this._events||!this._events[type])ret=[];else if(isFunction(this._events[type]))ret=[this._events[type]];else ret=this._events[type].slice();return ret};EventEmitter.listenerCount=function(emitter,type){var ret;if(!emitter._events||!emitter._events[type])ret=0;else if(isFunction(emitter._events[type]))ret=1;else ret=emitter._events[type].length;return ret};function isFunction(arg){return typeof arg==="function"}function isNumber(arg){return typeof arg==="number"}function isObject(arg){return typeof arg==="object"&&arg!==null}function isUndefined(arg){return arg===void 0}},{}]},{},[1])(1)});