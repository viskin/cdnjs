(function(){var t,al,n,aq,I,w,x,A,ae,y,j,E,ag,ad,h,p,aj,v,C,an,ai,H,u,g,R,X,am,Z,r,J,T,aa,ab,ah,D,e,N,m,z,b,o,ap,L,q,B,a,av,ac,aw,at,V,G,d,Q,U,ak,ar,Y,ax,F,f,k,s,c,P,au,S,M,K,W,i,af={}.hasOwnProperty,O=function(aB,az){for(var ay in az){if(af.call(az,ay)){aB[ay]=az[ay]}}function aA(){this.constructor=aB}aA.prototype=az.prototype;aB.prototype=new aA();aB.__super__=az.prototype;return aB},l=[].slice,ao=function(ay,az){return function(){return ay.apply(az,arguments)}};t={toString:function(){return"Bacon"}};t.version="0.7.63";E=(typeof global!=="undefined"&&global!==null?global:this).Error;ar=function(){};aw=function(az,ay){return ay};L=function(ay,az){return ay};aa=function(ay){return ay.slice(0)};a=function(ay){return ay instanceof Array};ac=function(ay){return ay instanceof p};H={indexOf:Array.prototype.indexOf?function(az,ay){return az.indexOf(ay)}:function(aB,ay){var aC,aA,az,aD;for(aC=aA=0,az=aB.length;aA<az;aC=++aA){aD=aB[aC];if(ay===aD){return aC}}return -1},indexWhere:function(aA,aC){var aB,az,ay,aD;for(aB=az=0,ay=aA.length;az<ay;aB=++az){aD=aA[aB];if(aC(aD)){return aB}}return -1},head:function(ay){return ay[0]},always:function(ay){return function(){return ay}},negate:function(ay){return function(az){return !ay(az)}},empty:function(ay){return ay.length===0},tail:function(ay){return ay.slice(1,ay.length)},filter:function(aD,aC){var aB,aA,az,ay;aB=[];for(aA=0,az=aC.length;aA<az;aA++){ay=aC[aA];if(aD(ay)){aB.push(ay)}}return aB},map:function(aD,aB){var aA,az,aC,ay;aC=[];for(aA=0,az=aB.length;aA<az;aA++){ay=aB[aA];aC.push(aD(ay))}return aC},each:function(ay,aB){var az,aA;for(az in ay){aA=ay[az];aB(az,aA)}return void 0},toArray:function(ay){if(a(ay)){return ay}else{return[ay]}},contains:function(az,ay){return H.indexOf(az,ay)!==-1},id:function(ay){return ay},last:function(ay){return ay[ay.length-1]},all:function(aB,aC){var aA,az,ay;if(aC==null){aC=H.id}for(aA=0,az=aB.length;aA<az;aA++){ay=aB[aA];if(!aC(ay)){return false}}return true},any:function(aB,aC){var aA,az,ay;if(aC==null){aC=H.id}for(aA=0,az=aB.length;aA<az;aA++){ay=aB[aA];if(aC(ay)){return true}}return false},without:function(ay,az){return H.filter(function(aA){return aA!==ay},az)},remove:function(ay,az){var aA;aA=H.indexOf(az,ay);if(aA>=0){return az.splice(aA,1)}},fold:function(aC,az,aD){var aB,aA,ay;for(aB=0,aA=aC.length;aB<aA;aB++){ay=aC[aB];az=aD(az,ay)}return az},flatMap:function(az,ay){return H.fold(ay,[],function(aB,aA){return aB.concat(az(aA))})},cached:function(az){var ay;ay=h;return function(){if(ay===h){ay=az();az=void 0}return ay}},isFunction:function(ay){return typeof ay==="function"},toString:function(aC){var az,aA,ay,aB;try{ax++;if(aC==null){return"undefined"}else{if(H.isFunction(aC)){return"function"}else{if(a(aC)){if(ax>5){return"[..]"}return"["+H.map(H.toString,aC).toString()+"]"}else{if((aC!=null?aC.toString:void 0)!=null&&aC.toString!==Object.prototype.toString){return aC.toString()}else{if(typeof aC==="object"){if(ax>5){return"{..}"}aA=function(){var aD;aD=[];for(ay in aC){if(!af.call(aC,ay)){continue}aB=function(){try{return aC[ay]}catch(aE){az=aE;return az}}();aD.push(H.toString(ay)+":"+H.toString(aB))}return aD}();return"{"+aA+"}"}else{return aC}}}}}}finally{ax--}}};ax=0;t._=H;ai=t.UpdateBarrier=function(){var aD,aK,az,aA,aH,aL,aI,aJ,aG,ay,aB,aC,aE,aF;ay=void 0;aB=[];aC={};aK=[];az=0;aD=function(aM){if(ay){return aK.push(aM)}else{return aM()}};aE=function(aO,aM){var aN;if(ay){aN=aC[aO.id];if(aN==null){aN=aC[aO.id]=[aM];return aB.push(aO)}else{return aN.push(aM)}}else{return aM()}};aH=function(){while(aB.length>0){aI(0)}return void 0};aI=function(aP){var aQ,aO,aN,aS,aM,aR;aS=aB[aP];aM=aS.id;aR=aC[aM];aB.splice(aP,1);delete aC[aM];aL(aS);for(aO=0,aN=aR.length;aO<aN;aO++){aQ=aR[aO];aQ()}return void 0};aL=function(aR){var aP,aQ,aO,aN,aM;aQ=aR.internalDeps();for(aN=0,aM=aQ.length;aN<aM;aN++){aP=aQ[aN];aL(aP);if(aC[aP.id]){aO=H.indexOf(aB,aP);aI(aO)}}return void 0};aG=function(aP,aO,aQ,aN){var aR,aM;if(ay){return aQ.apply(aO,aN)}else{ay=aP;try{aM=aQ.apply(aO,aN);aH()}finally{ay=void 0;while(az<aK.length){aR=aK[az];az++;aR()}az=0;aK=[]}return aM}};aA=function(){if(ay){return ay.id}else{return void 0}};aF=function(aR,aQ){var aP,aM,aO,aN;aN=false;aM=false;aP=function(){return aM=true};aO=function(){aN=true;return aP()};aP=aR.dispatcher.subscribe(function(aS){return aD(function(){var aT;if(!aN){aT=aQ(aS);if(aT===t.noMore){return aO()}}})});if(aM){aP()}return aO};aJ=function(){return aB.length>0};return{whenDoneWith:aE,hasWaiters:aJ,inTransaction:aG,currentEventId:aA,wrappedSubscribe:aF,afterTransaction:aD}}();an=function(){function ay(az,aB,aA){this.obs=az;this.sync=aB;this.lazy=aA!=null?aA:false;this.queue=[]}ay.prototype.subscribe=function(az){return this.obs.dispatcher.subscribe(az)};ay.prototype.toString=function(){return this.obs.toString()};ay.prototype.markEnded=function(){return this.ended=true};ay.prototype.consume=function(){if(this.lazy){return{value:H.always(this.queue[0])}}else{return this.queue[0]}};ay.prototype.push=function(az){return this.queue=[az]};ay.prototype.mayHave=function(){return true};ay.prototype.hasAtLeast=function(){return this.queue.length};ay.prototype.flatten=true;return ay}();I=function(ay){O(az,ay);function az(){return az.__super__.constructor.apply(this,arguments)}az.prototype.consume=function(){return this.queue.shift()};az.prototype.push=function(aA){return this.queue.push(aA)};az.prototype.mayHave=function(aA){return !this.ended||this.queue.length>=aA};az.prototype.hasAtLeast=function(aA){return this.queue.length>=aA};az.prototype.flatten=false;return az}(an);al=function(ay){O(az,ay);function az(aA){az.__super__.constructor.call(this,aA,true)}az.prototype.consume=function(){var aA;aA=this.queue;this.queue=[];return{value:function(){return aA}}};az.prototype.push=function(aA){return this.queue.push(aA.value())};az.prototype.hasAtLeast=function(){return true};return az}(an);an.isTrigger=function(ay){if(ay instanceof an){return ay.sync}else{return ay instanceof j}};an.fromObservable=function(ay){if(ay instanceof an){return ay}else{if(ay instanceof aj){return new an(ay,false)}else{return new I(ay,true)}}};w=function(){function ay(aB,az,aA){this.context=aB;this.method=az;this.args=aA}ay.prototype.deps=function(){return this.cached||(this.cached=b([this.context].concat(this.args)))};ay.prototype.toString=function(){return H.toString(this.context)+"."+H.toString(this.method)+"("+H.map(H.toString,this.args)+")"};return ay}();e=function(){var ay,az,aA;az=arguments[0],aA=arguments[1],ay=3<=arguments.length?l.call(arguments,2):[];if((az||aA) instanceof w){return az||aA}else{return new w(az,aA,ay)}};W=function(ay,az){az.desc=ay;return az};b=function(ay){if(a(ay)){return H.flatMap(b,ay)}else{if(ac(ay)){return[ay]}else{if(ay instanceof an){return[ay.obs]}else{return[]}}}};t.Desc=w;t.Desc.empty=new t.Desc("","",[]);i=function(ay){return function(){var aA,aB,aC,az;aC=arguments[0],aA=2<=arguments.length?l.call(arguments,1):[];if(typeof aC==="object"&&aA.length){aB=aC;az=aA[0];aC=function(){return aB[az].apply(aB,arguments)};aA=aA.slice(1)}return ay.apply(null,[aC].concat(l.call(aA)))}};G=function(ay){ay=Array.prototype.slice.call(ay);return d.apply(null,ay)};Y=function(az,ay){return function(){var aA;aA=1<=arguments.length?l.call(arguments,0):[];return az.apply(null,ay.concat(aA))}};M=function(ay){return function(az){return function(aB){var aA;if(aB==null){return void 0}else{aA=aB[az];if(H.isFunction(aA)){return aA.apply(aB,ay)}else{return aA}}}}};P=function(aA,ay){var az,aB;aB=aA.slice(1).split(".");az=H.map(M(ay),aB);return function(aE){var aD,aC;for(aD=0,aC=az.length;aD<aC;aD++){aA=az[aD];aE=aA(aE)}return aE}};av=function(ay){return typeof ay==="string"&&ay.length>1&&ay.charAt(0)==="."};d=i(function(){var ay,az;az=arguments[0],ay=2<=arguments.length?l.call(arguments,1):[];if(H.isFunction(az)){if(ay.length){return Y(az,ay)}else{return az}}else{if(av(az)){return P(az,ay)}else{return H.always(az)}}});V=function(az,ay){return d.apply(null,[az].concat(l.call(ay)))};D=function(aC,aA,ay,aB){var az;if(aA instanceof aj){az=aA.sampledBy(aC,function(aE,aD){return[aE,aD]});return aB.call(az,function(aD){var aF,aE;aF=aD[0],aE=aD[1];return aF}).map(function(aD){var aF,aE;aF=aD[0],aE=aD[1];return aE})}else{aA=V(aA,ay);return aB.call(aC,aA)}};s=function(az){var ay;if(H.isFunction(az)){return az}else{if(av(az)){ay=au(az);return function(aB,aA){return aB[ay](aA)}}else{throw new E("not a function or a field key: "+az)}}};au=function(ay){return ay.slice(1)};C=function(){function ay(az){this.value=az}ay.prototype.getOrElse=function(){return this.value};ay.prototype.get=function(){return this.value};ay.prototype.filter=function(az){if(az(this.value)){return new ay(this.value)}else{return h}};ay.prototype.map=function(az){return new ay(az(this.value))};ay.prototype.forEach=function(az){return az(this.value)};ay.prototype.isDefined=true;ay.prototype.toArray=function(){return[this.value]};ay.prototype.inspect=function(){return"Some("+this.value+")"};ay.prototype.toString=function(){return this.inspect()};return ay}();h={getOrElse:function(ay){return ay},filter:function(){return h},map:function(){return h},forEach:function(){},isDefined:false,toArray:function(){return[]},inspect:function(){return"None"},toString:function(){return this.inspect()}};S=function(ay){if(ay instanceof C||ay===h){return ay}else{return new C(ay)}};t.noMore=["<no-more>"];t.more=["<more>"];m=0;y=function(){function ay(){this.id=++m}ay.prototype.isEvent=function(){return true};ay.prototype.isEnd=function(){return false};ay.prototype.isInitial=function(){return false};ay.prototype.isNext=function(){return false};ay.prototype.isError=function(){return false};ay.prototype.hasValue=function(){return false};ay.prototype.filter=function(){return true};ay.prototype.inspect=function(){return this.toString()};ay.prototype.log=function(){return this.toString()};return ay}();ad=function(az){O(ay,az);function ay(aB,aA){ay.__super__.constructor.call(this);if(!aA&&H.isFunction(aB)||aB instanceof ay){this.valueF=aB;this.valueInternal=void 0}else{this.valueF=void 0;this.valueInternal=aB}}ay.prototype.isNext=function(){return true};ay.prototype.hasValue=function(){return true};ay.prototype.value=function(){if(this.valueF instanceof ay){this.valueInternal=this.valueF.value();this.valueF=void 0}else{if(this.valueF){this.valueInternal=this.valueF();this.valueF=void 0}}return this.valueInternal};ay.prototype.fmap=function(aC){var aA,aB;if(this.valueInternal){aB=this.valueInternal;return this.apply(function(){return aC(aB)})}else{aA=this;return this.apply(function(){return aC(aA.value())})}};ay.prototype.apply=function(aA){return new ay(aA)};ay.prototype.filter=function(aA){return aA(this.value())};ay.prototype.toString=function(){return H.toString(this.value())};ay.prototype.log=function(){return this.value()};return ay}(y);ag=function(az){O(ay,az);function ay(){return ay.__super__.constructor.apply(this,arguments)}ay.prototype.isInitial=function(){return true};ay.prototype.isNext=function(){return false};ay.prototype.apply=function(aA){return new ay(aA)};ay.prototype.toNext=function(){return new ad(this)};return ay}(ad);A=function(ay){O(az,ay);function az(){return az.__super__.constructor.apply(this,arguments)}az.prototype.isEnd=function(){return true};az.prototype.fmap=function(){return this};az.prototype.apply=function(){return this};az.prototype.toString=function(){return"<end>"};return az}(y);ae=function(ay){O(az,ay);function az(aA){this.error=aA}az.prototype.isError=function(){return true};az.prototype.fmap=function(){return this};az.prototype.apply=function(){return this};az.prototype.toString=function(){return"<error> "+H.toString(this.error)};return az}(y);t.Event=y;t.Initial=ag;t.Next=ad;t.End=A;t.Error=ae;B=function(ay){return new ag(ay,true)};ak=function(ay){return new ad(ay,true)};N=function(){return new A()};c=function(ay){if(ay instanceof y){return ay}else{return ak(ay)}};q=0;f=function(){};p=function(){function ay(az){this.desc=az;this.id=++q;this.initialDesc=this.desc}ay.prototype.subscribe=function(az){return ai.wrappedSubscribe(this,az)};ay.prototype.subscribeInternal=function(az){return this.dispatcher.subscribe(az)};ay.prototype.onValue=function(){var az;az=G(arguments);return this.subscribe(function(aA){if(aA.hasValue()){return az(aA.value())}})};ay.prototype.onValues=function(az){return this.onValue(function(aA){return az.apply(null,aA)})};ay.prototype.onError=function(){var az;az=G(arguments);return this.subscribe(function(aA){if(aA.isError()){return az(aA.error)}})};ay.prototype.onEnd=function(){var az;az=G(arguments);return this.subscribe(function(aA){if(aA.isEnd()){return az()}})};ay.prototype.name=function(az){this._name=az;return this};ay.prototype.withDescription=function(){this.desc=e.apply(null,arguments);return this};ay.prototype.toString=function(){if(this._name){return this._name}else{return this.desc.toString()}};ay.prototype.internalDeps=function(){return this.initialDesc.deps()};return ay}();p.prototype.assign=p.prototype.onValue;p.prototype.forEach=p.prototype.onValue;p.prototype.inspect=p.prototype.toString;t.Observable=p;aq=function(){function ay(aB){var aA,az,aC;if(aB==null){aB=[]}this.unsubscribe=ao(this.unsubscribe,this);this.unsubscribed=false;this.subscriptions=[];this.starting=[];for(aA=0,az=aB.length;aA<az;aA++){aC=aB[aA];this.add(aC)}}ay.prototype.add=function(aB){var aC,aA,az;if(this.unsubscribed){return}aC=false;aA=ar;this.starting.push(aB);az=function(aD){return function(){if(aD.unsubscribed){return}aC=true;aD.remove(aA);return H.remove(aB,aD.starting)}}(this);aA=aB(this.unsubscribe,az);if(!(this.unsubscribed||aC)){this.subscriptions.push(aA)}else{aA()}H.remove(aB,this.starting);return aA};ay.prototype.remove=function(az){if(this.unsubscribed){return}if(H.remove(az,this.subscriptions)!==void 0){return az()}};ay.prototype.unsubscribe=function(){var aA,az,aC,aB;if(this.unsubscribed){return}this.unsubscribed=true;aC=this.subscriptions;for(aA=0,az=aC.length;aA<az;aA++){aB=aC[aA];aB()}this.subscriptions=[];return this.starting=[]};ay.prototype.count=function(){if(this.unsubscribed){return 0}return this.subscriptions.length+this.starting.length};ay.prototype.empty=function(){return this.count()===0};return ay}();t.CompositeUnsubscribe=aq;x=function(){ay.prototype.pushing=false;ay.prototype.ended=false;ay.prototype.prevError=void 0;ay.prototype.unsubSrc=void 0;function ay(az,aA){this._subscribe=az;this._handleEvent=aA;this.subscribe=ao(this.subscribe,this);this.handleEvent=ao(this.handleEvent,this);this.subscriptions=[];this.queue=[]}ay.prototype.hasSubscribers=function(){return this.subscriptions.length>0};ay.prototype.removeSub=function(az){return this.subscriptions=H.without(az,this.subscriptions)};ay.prototype.push=function(az){if(az.isEnd()){this.ended=true}return ai.inTransaction(az,this,this.pushIt,[az])};ay.prototype.pushToSubscriptions=function(aE){var aF,aA,az,aD,aC,aB;try{aB=this.subscriptions;for(aA=0,az=aB.length;aA<az;aA++){aC=aB[aA];aD=aC.sink(aE);if(aD===t.noMore||aE.isEnd()){this.removeSub(aC)}}return true}catch(aG){aF=aG;this.pushing=false;this.queue=[];throw aF}};ay.prototype.pushIt=function(az){if(!this.pushing){if(az===this.prevError){return}if(az.isError()){this.prevError=az}this.pushing=true;this.pushToSubscriptions(az);this.pushing=false;while(this.queue.length){az=this.queue.shift();this.push(az)}if(this.hasSubscribers()){return t.more}else{this.unsubscribeFromSource();return t.noMore}}else{this.queue.push(az);return t.more}};ay.prototype.handleEvent=function(az){if(this._handleEvent){return this._handleEvent(az)}else{return this.push(az)}};ay.prototype.unsubscribeFromSource=function(){if(this.unsubSrc){this.unsubSrc()}return this.unsubSrc=void 0};ay.prototype.subscribe=function(aA){var az;if(this.ended){aA(N());return ar}else{az={sink:aA};this.subscriptions.push(az);if(this.subscriptions.length===1){this.unsubSrc=this._subscribe(this.handleEvent)}return function(aB){return function(){aB.removeSub(az);if(!aB.hasSubscribers()){return aB.unsubscribeFromSource()}}}(this)}};return ay}();t.Dispatcher=x;j=function(az){O(ay,az);function ay(aC,aA,aB){if(H.isFunction(aC)){aB=aA;aA=aC;aC=w.empty}ay.__super__.constructor.call(this,aC);this.dispatcher=new x(aA,aB);f(this)}ay.prototype.toProperty=function(aA){var aB,aC;aC=arguments.length===0?h:S(function(){return aA});aB=this.dispatcher;return new aj(new t.Desc(this,"toProperty",[aA]),function(aH){var aG,aF,aE,aD;aG=false;aD=ar;aF=t.more;aE=function(){if(!aG){return aC.forEach(function(aI){aG=true;aF=aH(new ag(aI));if(aF===t.noMore){aD();return aD=ar}})}};aD=aB.subscribe(function(aI){if(aI.hasValue()){if(aG&&aI.isInitial()){return t.more}else{if(!aI.isInitial()){aE()}aG=true;aC=new C(aI);return aH(aI)}}else{if(aI.isEnd()){aF=aE()}if(aF!==t.noMore){return aH(aI)}}});aE();return aD})};ay.prototype.toEventStream=function(){return this};ay.prototype.withHandler=function(aA){return new ay(new t.Desc(this,"withHandler",[aA]),this.dispatcher.subscribe,aA)};return ay}(p);t.EventStream=j;t.never=function(){return new j(e(t,"never"),function(ay){ay(N());return ar})};t.when=function(){var aO,aM,aD,aB,aL,aK,aN,aF,aE,aA,aI,aH,aG,az,aC,aR,aJ,ay,aP,aQ;if(arguments.length===0){return t.never()}aN=arguments.length;aQ="when: expecting arguments in the form (Observable+,function)+";ay=[];aG=[];aM=0;az=[];while(aM<aN){az[aM]=arguments[aM];az[aM+1]=arguments[aM+1];aH=H.toArray(arguments[aM]);aO=ab(arguments[aM+1]);aI={f:aO,ixs:[]};aP=false;for(aL=0,aF=aH.length;aL<aF;aL++){aJ=aH[aL];aD=H.indexOf(ay,aJ);if(!aP){aP=an.isTrigger(aJ)}if(aD<0){ay.push(aJ);aD=ay.length-1}aC=aI.ixs;for(aK=0,aE=aC.length;aK<aE;aK++){aB=aC[aK];if(aB.index===aD){aB.count++}}aI.ixs.push({index:aD,count:1})}if(aH.length>0){aG.push(aI)}aM=aM+2}if(!ay.length){return t.never()}ay=H.map(an.fromObservable,ay);aA=H.any(ay,function(aS){return aS.flatten})&&ah(H.map(function(aS){return aS.obs},ay));return aR=new j(new t.Desc(t,"when",az),function(aZ){var aY,aX,aS,aU,aW,aT,aV;aV=[];aS=false;aU=function(a3){var a1,a0,a2;a2=a3.ixs;for(a1=0,a0=a2.length;a1<a0;a1++){aM=a2[a1];if(!ay[aM.index].hasAtLeast(aM.count)){return false}}return true};aX=function(a0){return !a0.sync||a0.ended};aY=function(a3){var a1,a0,a2;a2=a3.ixs;for(a1=0,a0=a2.length;a1<a0;a1++){aM=a2[a1];if(!ay[aM.index].mayHave(aM.count)){return true}}};aW=function(a0){return !a0.source.flatten};aT=function(a0){return function(a2){var a1,a4,a3;a4=function(){return ai.whenDoneWith(aR,a1)};a3=function(){var a8,a6,a5,ba,a9,a7;if(aV.length>0){a9=t.more;a7=aV.pop();for(a6=0,a5=aG.length;a6<a5;a6++){ba=aG[a6];if(aU(ba)){a8=function(){var bc,bb,bd,be;bd=ba.ixs;be=[];for(bb=0,bc=bd.length;bb<bc;bb++){aM=bd[bb];be.push(ay[aM.index].consume())}return be}();a9=aZ(a7.e.apply(function(){var bc,bb;bb=function(){var be,bd,bf;bf=[];for(bd=0,be=a8.length;bd<be;bd++){bc=a8[bd];bf.push(bc.value())}return bf}();return ba.f.apply(ba,bb)}));if(aV.length){aV=H.filter(aW,aV)}if(a9===t.noMore){return a9}else{return a3()}}}}else{return t.more}};a1=function(){var a5;a5=a3();if(aS){aS=false;if(H.all(ay,aX)||H.all(aG,aY)){a5=t.noMore;aZ(N())}}if(a5===t.noMore){a2()}return a5};return a0.subscribe(function(a6){var a5;if(a6.isEnd()){aS=true;a0.markEnded();a4()}else{if(a6.isError()){a5=aZ(a6)}else{a0.push(a6);if(a0.sync){aV.push({source:a0,e:a6});if(aA||ai.hasWaiters()){a4()}else{a1()}}}}if(a5===t.noMore){a2()}return a5||t.more})}};return new t.CompositeUnsubscribe(function(){var a1,a0,a2;a2=[];for(a1=0,a0=ay.length;a1<a0;a1++){aJ=ay[a1];a2.push(aT(aJ))}return a2}()).unsubscribe})};ah=function(aA,az){var ay;if(az==null){az=[]}ay=function(aC){var aB;if(H.contains(az,aC)){return true}else{aB=aC.internalDeps();if(aB.length){az.push(aC);return H.any(aB,ay)}else{az.push(aC);return false}}};return H.any(aA,ay)};ab=function(ay){if(H.isFunction(ay)){return ay}else{return H.always(ay)}};t.groupSimultaneous=function(){var az,ay,aA;aA=1<=arguments.length?l.call(arguments,0):[];if(aA.length===1&&a(aA[0])){aA=aA[0]}ay=function(){var aC,aB,aD;aD=[];for(aC=0,aB=aA.length;aC<aB;aC++){az=aA[aC];aD.push(new al(az))}return aD}();return W(new t.Desc(t,"groupSimultaneous",aA),t.when(ay,function(){var aB;aB=1<=arguments.length?l.call(arguments,0):[];return aB}))};v=function(ay){O(az,ay);function az(aC,aA,aB){this.property=aC;this.subscribe=ao(this.subscribe,this);az.__super__.constructor.call(this,aA,aB);this.current=h;this.currentValueRootId=void 0;this.propertyEnded=false}az.prototype.push=function(aA){if(aA.isEnd()){this.propertyEnded=true}if(aA.hasValue()){this.current=new C(aA);this.currentValueRootId=ai.currentEventId()}return az.__super__.push.call(this,aA)};az.prototype.maybeSubSource=function(aB,aA){if(aA===t.noMore){return ar}else{if(this.propertyEnded){aB(N());return ar}else{return x.prototype.subscribe.call(this,aB)}}};az.prototype.subscribe=function(aC){var aE,aB,aA,aD;aB=false;aA=t.more;if(this.current.isDefined&&(this.hasSubscribers()||this.propertyEnded)){aE=ai.currentEventId();aD=this.currentValueRootId;if(!this.propertyEnded&&aD&&aE&&aE!==aD){ai.whenDoneWith(this.property,function(aF){return function(){if(aF.currentValueRootId===aD){return aC(B(aF.current.get().value()))}}}(this));return this.maybeSubSource(aC,aA)}else{ai.inTransaction(void 0,this,function(){return aA=aC(B(this.current.get().value()))},[]);return this.maybeSubSource(aC,aA)}}else{return this.maybeSubSource(aC,aA)}};return az}(x);aj=function(ay){O(az,ay);function az(aC,aA,aB){az.__super__.constructor.call(this,aC);this.dispatcher=new v(this,aA,aB);f(this)}az.prototype.changes=function(){return new j(new t.Desc(this,"changes",[]),function(aA){return function(aB){return aA.dispatcher.subscribe(function(aC){if(!aC.isInitial()){return aB(aC)}})}}(this))};az.prototype.withHandler=function(aA){return new az(new t.Desc(this,"withHandler",[aA]),this.dispatcher.subscribe,aA)};az.prototype.toProperty=function(){return this};az.prototype.toEventStream=function(){return new j(new t.Desc(this,"toEventStream",[]),function(aA){return function(aB){return aA.dispatcher.subscribe(function(aC){if(aC.isInitial()){aC=aC.toNext()}return aB(aC)})}}(this))};return az}(p);t.Property=aj;t.constant=function(ay){return new aj(new t.Desc(t,"constant",[ay]),function(az){az(B(ay));az(N());return ar})};t.fromBinder=function(ay,az){if(az==null){az=H.id}return new j(new t.Desc(t,"fromBinder",[ay,az]),function(aD){var aE,aB,aA,aC;aC=false;aE=false;aB=function(){if(!aC){if(typeof aA!=="undefined"&&aA!==null){aA();return aC=true}else{return aE=true}}};aA=ay(function(){var aH,aJ,aG,aF,aI,aK;aH=1<=arguments.length?l.call(arguments,0):[];aK=az.apply(this,aH);if(!(a(aK)&&H.last(aK) instanceof y)){aK=[aK]}aI=t.more;for(aG=0,aF=aK.length;aG<aF;aG++){aJ=aK[aG];aI=aD(aJ=c(aJ));if(aI===t.noMore||aJ.isEnd()){aB();return aI}}return aI});if(aE){aB()}return aB})};z=[["addEventListener","removeEventListener"],["addListener","removeListener"],["on","off"],["bind","unbind"]];o=function(aB){var az,ay,aA,aC;for(az=0,ay=z.length;az<ay;az++){aC=z[az];aA=[aB[aC[0]],aB[aC[1]]];if(aA[0]&&aA[1]){return aA}}throw new ae("No suitable event methods in "+aB)};t.fromEventTarget=function(aD,ay,aB){var aC,aA,az;aC=o(aD),aA=aC[0],az=aC[1];return W(new t.Desc(t,"fromEvent",[aD,ay]),t.fromBinder(function(aE){aA.call(aD,ay,aE);return function(){return az.call(aD,ay,aE)}},aB))};t.fromEvent=t.fromEventTarget;t.Observable.prototype.map=function(){var ay,az;az=arguments[0],ay=2<=arguments.length?l.call(arguments,1):[];return D(this,az,ay,function(aA){return W(new t.Desc(this,"map",[aA]),this.withHandler(function(aB){return this.push(aB.fmap(aA))}))})};t.combineAsArray=function(){var aB,aA,az,aC,ay,aD,aE;aE=1<=arguments.length?l.call(arguments,0):[];if(aE.length===1&&a(aE[0])){aE=aE[0]}for(aB=aA=0,az=aE.length;aA<az;aB=++aA){aD=aE[aB];if(!ac(aD)){aE[aB]=t.constant(aD)}}if(aE.length){ay=function(){var aG,aF,aH;aH=[];for(aG=0,aF=aE.length;aG<aF;aG++){aC=aE[aG];aH.push(new an(aC,true))}return aH}();return W(new t.Desc(t,"combineAsArray",aE),t.when(ay,function(){var aF;aF=1<=arguments.length?l.call(arguments,0):[];return aF}).toProperty())}else{return t.constant([])}};t.onValues=function(){var az,ay,aA;aA=2<=arguments.length?l.call(arguments,0,ay=arguments.length-1):(ay=0,[]),az=arguments[ay++];return t.combineAsArray(aA).onValues(az)};t.combineWith=function(){var ay,az;ay=arguments[0],az=2<=arguments.length?l.call(arguments,1):[];return W(new t.Desc(t,"combineWith",[ay].concat(l.call(az))),t.combineAsArray(az).map(function(aA){return ay.apply(null,aA)}))};t.combineTemplate=function(aF){var aA,aB,aH,aG,az,aD,ay,aE,aC,aI;ay=[];aI=[];aD=function(aJ){return aJ[aJ.length-1]};aC=function(aJ,aK,aL){return aD(aJ)[aK]=aL};aA=function(aK,aJ){return function(aM,aL){return aC(aM,aK,aL[aJ])}};az=function(aJ,aK){return function(aL){return aC(aL,aJ,aK)}};aE=function(aJ){if(a(aJ)){return[]}else{return{}}};aH=function(aK,aL){var aM,aJ;if(ac(aL)){aI.push(aL);return ay.push(aA(aK,aI.length-1))}else{if(aL===Object(aL)&&typeof aL!=="function"&&!(aL instanceof RegExp)&&!(aL instanceof Date)){aJ=function(aN){return function(aO){var aP;aP=aE(aL);aC(aO,aN,aP);return aO.push(aP)}};aM=function(aN){return aN.pop()};ay.push(aJ(aK));aG(aL);return ay.push(aM)}else{return ay.push(az(aK,aL))}}};aG=function(aJ){return H.each(aJ,aH)};aG(aF);aB=function(aL){var aK,aO,aN,aM,aJ;aJ=aE(aF);aK=[aJ];for(aN=0,aM=ay.length;aN<aM;aN++){aO=ay[aN];aO(aK,aL)}return aJ};return W(new t.Desc(t,"combineTemplate",[aF]),t.combineAsArray(aI).map(aB))};t.Observable.prototype.combine=function(ay,aA){var az;az=s(aA);return W(new t.Desc(this,"combine",[ay,aA]),t.combineAsArray(this,ay).map(function(aB){return az(aB[0],aB[1])}))};t.Observable.prototype.decode=function(ay){return W(new t.Desc(this,"decode",[ay]),this.combine(t.combineTemplate(ay),function(aA,az){return az[aA]}))};t.Observable.prototype.withStateMachine=function(ay,aA){var az;az=ay;return W(new t.Desc(this,"withStateMachine",[ay,aA]),this.withHandler(function(aG){var aF,aD,aC,aH,aB,aI,aE;aF=aA(az,aG);aH=aF[0],aI=aF[1];az=aH;aE=t.more;for(aD=0,aC=aI.length;aD<aC;aD++){aB=aI[aD];aE=this.push(aB);if(aE===t.noMore){return aE}}return aE}))};t.Observable.prototype.skipDuplicates=function(ay){if(ay==null){ay=function(aA,az){return aA===az}}return W(new t.Desc(this,"skipDuplicates",[]),this.withStateMachine(h,function(aA,az){if(!az.hasValue()){return[aA,[az]]}else{if(az.isInitial()||aA===h||!ay(aA.get(),az.value())){return[new C(az.value()),[az]]}else{return[aA,[]]}}}))};t.Observable.prototype.awaiting=function(ay){return W(new t.Desc(this,"awaiting",[ay]),t.groupSimultaneous(this,ay).map(function(az){var aA,aB;aA=az[0],aB=az[1];return aB.length===0}).toProperty(false).skipDuplicates())};t.Observable.prototype.not=function(){return W(new t.Desc(this,"not",[]),this.map(function(ay){return !ay}))};t.Property.prototype.and=function(ay){return W(new t.Desc(this,"and",[ay]),this.combine(ay,function(az,aA){return az&&aA}))};t.Property.prototype.or=function(ay){return W(new t.Desc(this,"or",[ay]),this.combine(ay,function(az,aA){return az||aA}))};t.scheduler={setTimeout:function(ay,az){return setTimeout(ay,az)},setInterval:function(az,ay){return setInterval(az,ay)},clearInterval:function(ay){return clearInterval(ay)},clearTimeout:function(ay){return clearTimeout(ay)},now:function(){return new Date().getTime()}};t.EventStream.prototype.bufferWithTime=function(ay){return W(new t.Desc(this,"bufferWithTime",[ay]),this.bufferWithTimeOrCount(ay,Number.MAX_VALUE))};t.EventStream.prototype.bufferWithCount=function(ay){return W(new t.Desc(this,"bufferWithCount",[ay]),this.bufferWithTimeOrCount(void 0,ay))};t.EventStream.prototype.bufferWithTimeOrCount=function(ay,az){var aA;aA=function(aB){if(aB.values.length===az){return aB.flush()}else{if(ay!==void 0){return aB.schedule()}}};return W(new t.Desc(this,"bufferWithTimeOrCount",[ay,az]),this.buffer(ay,aA,aA))};t.EventStream.prototype.buffer=function(aA,aC,az){var ay,aD,aB;if(aC==null){aC=ar}if(az==null){az=ar}ay={scheduled:null,end:void 0,values:[],flush:function(){var aE;if(this.scheduled){t.scheduler.clearTimeout(this.scheduled);this.scheduled=null}if(this.values.length>0){aE=this.push(ak(this.values));this.values=[];if(this.end!=null){return this.push(this.end)}else{if(aE!==t.noMore){return az(this)}}}else{if(this.end!=null){return this.push(this.end)}}},schedule:function(){if(!this.scheduled){return this.scheduled=aA(function(aE){return function(){return aE.flush()}}(this))}}};aB=t.more;if(!H.isFunction(aA)){aD=aA;aA=function(aE){return t.scheduler.setTimeout(aE,aD)}}return W(new t.Desc(this,"buffer",[]),this.withHandler(function(aE){ay.push=function(aF){return function(aG){return aF.push(aG)}}(this);if(aE.isError()){aB=this.push(aE)}else{if(aE.isEnd()){ay.end=aE;if(!ay.scheduled){ay.flush()}}else{ay.values.push(aE.value());aC(ay)}}return aB}))};t.Observable.prototype.filter=function(){var ay,az;az=arguments[0],ay=2<=arguments.length?l.call(arguments,1):[];return D(this,az,ay,function(aA){return W(new t.Desc(this,"filter",[aA]),this.withHandler(function(aB){if(aB.filter(aA)){return this.push(aB)}else{return t.more}}))})};t.once=function(ay){return new j(new w(t,"once",[ay]),function(az){az(c(ay));az(N());return ar})};t.EventStream.prototype.concat=function(ay){var az;az=this;return new j(new t.Desc(az,"concat",[ay]),function(aB){var aC,aA;aA=ar;aC=az.dispatcher.subscribe(function(aD){if(aD.isEnd()){return aA=ay.dispatcher.subscribe(aB)}else{return aB(aD)}});return function(){aC();return aA()}})};t.Observable.prototype.flatMap=function(){return ap(this,U(arguments))};t.Observable.prototype.flatMapFirst=function(){return ap(this,U(arguments),true)};ap=function(aA,aE,aB,az){var aD,ay,aC;aC=[aA];aD=[];ay=new j(new t.Desc(aA,"flatMap"+(aB?"First":""),[aE]),function(aH){var aJ,aI,aK,aF,aG;aK=new aq();aF=[];aG=function(aL){var aM;aM=Q(aE(aL.value()));aD.push(aM);return aK.add(function(aO,aN){return aM.dispatcher.subscribe(function(aQ){var aP;if(aQ.isEnd()){H.remove(aM,aD);aI();aJ(aN);return t.noMore}else{if(aQ instanceof ag){aQ=aQ.toNext()}aP=aH(aQ);if(aP===t.noMore){aO()}return aP}})})};aI=function(){var aL;aL=aF.shift();if(aL){return aG(aL)}};aJ=function(aL){aL();if(aK.empty()){return aH(N())}};aK.add(function(aM,aL){return aA.dispatcher.subscribe(function(aN){if(aN.isEnd()){return aJ(aL)}else{if(aN.isError()){return aH(aN)}else{if(aB&&aK.count()>1){return t.more}else{if(aK.unsubscribed){return t.noMore}if(az&&aK.count()>az){return aF.push(aN)}else{return aG(aN)}}}}})});return aK.unsubscribe});ay.internalDeps=function(){if(aD.length){return aC.concat(aD)}else{return aC}};return ay};U=function(ay){if(ay.length===1&&ac(ay[0])){return H.always(ay[0])}else{return G(ay)}};Q=function(ay){if(ac(ay)){return ay}else{return t.once(ay)}};t.Observable.prototype.flatMapWithConcurrencyLimit=function(){var az,ay;ay=arguments[0],az=2<=arguments.length?l.call(arguments,1):[];return W(new t.Desc(this,"flatMapWithConcurrencyLimit",[ay].concat(l.call(az))),ap(this,U(az),false,ay))};t.Observable.prototype.flatMapConcat=function(){return W(new t.Desc(this,"flatMapConcat",Array.prototype.slice.call(arguments,0)),this.flatMapWithConcurrencyLimit.apply(this,[1].concat(l.call(arguments))))};t.later=function(ay,az){return W(new t.Desc(t,"later",[ay,az]),t.fromBinder(function(aB){var aC,aA;aA=function(){return aB([az,N()])};aC=t.scheduler.setTimeout(aA,ay);return function(){return t.scheduler.clearTimeout(aC)}}))};t.Observable.prototype.bufferingThrottle=function(ay){return W(new t.Desc(this,"bufferingThrottle",[ay]),this.flatMapConcat(function(az){return t.once(az).concat(t.later(ay).filter(false))}))};t.Property.prototype.bufferingThrottle=function(){return t.Observable.prototype.bufferingThrottle.apply(this,arguments).toProperty()};n=function(ay){O(az,ay);function az(){this.guardedSink=ao(this.guardedSink,this);this.subscribeAll=ao(this.subscribeAll,this);this.unsubAll=ao(this.unsubAll,this);this.sink=void 0;this.subscriptions=[];this.ended=false;az.__super__.constructor.call(this,new t.Desc(t,"Bus",[]),this.subscribeAll)}az.prototype.unsubAll=function(){var aB,aA,aD,aC;aD=this.subscriptions;for(aB=0,aA=aD.length;aB<aA;aB++){aC=aD[aB];if(typeof aC.unsub==="function"){aC.unsub()}}return void 0};az.prototype.subscribeAll=function(aC){var aB,aA,aE,aD;if(this.ended){aC(N())}else{this.sink=aC;aE=aa(this.subscriptions);for(aB=0,aA=aE.length;aB<aA;aB++){aD=aE[aB];this.subscribeInput(aD)}}return this.unsubAll};az.prototype.guardedSink=function(aA){return function(aB){return function(aC){if(aC.isEnd()){aB.unsubscribeInput(aA);return t.noMore}else{return aB.sink(aC)}}}(this)};az.prototype.subscribeInput=function(aA){return aA.unsub=aA.input.dispatcher.subscribe(this.guardedSink(aA.input))};az.prototype.unsubscribeInput=function(aA){var aD,aC,aB,aF,aE;aF=this.subscriptions;for(aD=aC=0,aB=aF.length;aC<aB;aD=++aC){aE=aF[aD];if(aE.input===aA){if(typeof aE.unsub==="function"){aE.unsub()}this.subscriptions.splice(aD,1);return}}};az.prototype.plug=function(aA){var aB;if(this.ended){return}aB={input:aA};this.subscriptions.push(aB);if(this.sink!=null){this.subscribeInput(aB)}return function(aC){return function(){return aC.unsubscribeInput(aA)}}(this)};az.prototype.end=function(){this.ended=true;this.unsubAll();return typeof this.sink==="function"?this.sink(N()):void 0};az.prototype.push=function(aA){if(!this.ended){return typeof this.sink==="function"?this.sink(ak(aA)):void 0}};az.prototype.error=function(aA){return typeof this.sink==="function"?this.sink(new ae(aA)):void 0};return az}(j);t.Bus=n;at=function(az,ay){return i(function(){var aA,aB,aC;aB=arguments[0],aA=2<=arguments.length?l.call(arguments,1):[];aC=Y(ay,[function(aD,aE){return aB.apply(null,l.call(aD).concat([aE]))}]);return W(new t.Desc(t,az,[aB].concat(l.call(aA))),t.combineAsArray(aA).flatMap(aC))})};t.fromCallback=at("fromCallback",function(){var ay,az;az=arguments[0],ay=2<=arguments.length?l.call(arguments,1):[];return t.fromBinder(function(aA){V(az,ay)(aA);return ar},function(aA){return[aA,N()]})});t.fromNodeCallback=at("fromNodeCallback",function(){var ay,az;az=arguments[0],ay=2<=arguments.length?l.call(arguments,1):[];return t.fromBinder(function(aA){V(az,ay)(aA);return ar},function(aA,aB){if(aA){return[new ae(aA),N()]}return[aB,N()]})});u=function(az,aA){var ay;ay=new j(e(az,"justInitValue"),function(aD){var aB,aC;aC=void 0;aB=az.dispatcher.subscribe(function(aE){if(!aE.isEnd()){aC=aE}return t.noMore});ai.whenDoneWith(ay,function(){if(aC!=null){aD(aC)}return aD(N())});return aB});return ay.concat(aA).toProperty()};t.Observable.prototype.mapEnd=function(){var ay;ay=G(arguments);return W(new t.Desc(this,"mapEnd",[ay]),this.withHandler(function(az){if(az.isEnd()){this.push(ak(ay(az)));this.push(N());return t.noMore}else{return this.push(az)}}))};t.Observable.prototype.skipErrors=function(){return W(new t.Desc(this,"skipErrors",[]),this.withHandler(function(ay){if(ay.isError()){return t.more}else{return this.push(ay)}}))};t.EventStream.prototype.takeUntil=function(ay){var az;az={};return W(new t.Desc(this,"takeUntil",[ay]),t.groupSimultaneous(this.mapEnd(az),ay.skipErrors()).withHandler(function(aE){var aG,aB,aA,aD,aC,aF;if(!aE.hasValue()){return this.push(aE)}else{aD=aE.value(),aG=aD[0],ay=aD[1];if(ay.length){return this.push(N())}else{aC=t.more;for(aB=0,aA=aG.length;aB<aA;aB++){aF=aG[aB];if(aF===az){aC=this.push(N())}else{aC=this.push(ak(aF))}}return aC}}}))};t.Property.prototype.takeUntil=function(az){var ay;ay=this.changes().takeUntil(az);return W(new t.Desc(this,"takeUntil",[az]),u(this,ay))};t.Observable.prototype.flatMapLatest=function(){var ay,az;ay=U(arguments);az=this.toEventStream();return W(new t.Desc(this,"flatMapLatest",[ay]),az.flatMap(function(aA){return Q(ay(aA)).takeUntil(az)}))};t.Property.prototype.delayChanges=function(az,ay){return W(az,u(this,ay(this.changes())))};t.EventStream.prototype.delay=function(ay){return W(new t.Desc(this,"delay",[ay]),this.flatMap(function(az){return t.later(ay,az)}))};t.Property.prototype.delay=function(ay){return this.delayChanges(new t.Desc(this,"delay",[ay]),function(az){return az.delay(ay)})};t.EventStream.prototype.debounce=function(ay){return W(new t.Desc(this,"debounce",[ay]),this.flatMapLatest(function(az){return t.later(ay,az)}))};t.Property.prototype.debounce=function(ay){return this.delayChanges(new t.Desc(this,"debounce",[ay]),function(az){return az.debounce(ay)})};t.EventStream.prototype.debounceImmediate=function(ay){return W(new t.Desc(this,"debounceImmediate",[ay]),this.flatMapFirst(function(az){return t.once(az).concat(t.later(ay).filter(false))}))};t.Observable.prototype.scan=function(az,aB){var aA,aC,ay;aB=s(aB);aA=S(az);ay=function(aD){return function(aI){var aH,aG,aF,aE;aH=false;aE=ar;aG=t.more;aF=function(){if(!aH){return aA.forEach(function(aJ){aH=true;aG=aI(new ag(function(){return aJ}));if(aG===t.noMore){aE();return aE=ar}})}};aE=aD.dispatcher.subscribe(function(aL){var aJ,aK;if(aL.hasValue()){if(aH&&aL.isInitial()){return t.more}else{if(!aL.isInitial()){aF()}aH=true;aK=aA.getOrElse(void 0);aJ=aB(aK,aL.value());aA=new C(aJ);return aI(aL.apply(function(){return aJ}))}}else{if(aL.isEnd()){aG=aF()}if(aG!==t.noMore){return aI(aL)}}});ai.whenDoneWith(aC,aF);return aE}}(this);return aC=new aj(new t.Desc(this,"scan",[az,aB]),ay)};t.Observable.prototype.diff=function(az,ay){ay=s(ay);return W(new t.Desc(this,"diff",[az,ay]),this.scan([az],function(aA,aB){return[aB,ay(aA[0],aB)]}).filter(function(aA){return aA.length===2}).map(function(aA){return aA[1]}))};t.Observable.prototype.doAction=function(){var ay;ay=G(arguments);return W(new t.Desc(this,"doAction",[ay]),this.withHandler(function(az){if(az.hasValue()){ay(az.value())}return this.push(az)}))};t.Observable.prototype.doError=function(){var ay;ay=G(arguments);return W(new t.Desc(this,"doError",[ay]),this.withHandler(function(az){if(az.isError()){ay(az.error)}return this.push(az)}))};t.Observable.prototype.doLog=function(){var ay;ay=1<=arguments.length?l.call(arguments,0):[];return W(new t.Desc(this,"doLog",ay),this.withHandler(function(az){if(typeof console!=="undefined"&&console!==null){if(typeof console.log==="function"){console.log.apply(console,l.call(ay).concat([az.log()]))}}return this.push(az)}))};t.Observable.prototype.endOnError=function(){var ay,az;az=arguments[0],ay=2<=arguments.length?l.call(arguments,1):[];if(az==null){az=true}return D(this,az,ay,function(aA){return W(new t.Desc(this,"endOnError",[]),this.withHandler(function(aB){if(aB.isError()&&aA(aB.error)){this.push(aB);return this.push(N())}else{return this.push(aB)}}))})};p.prototype.errors=function(){return W(new t.Desc(this,"errors",[]),this.filter(function(){return false}))};K=function(ay){return[ay,N()]};t.fromPromise=function(az,aA,ay){if(ay==null){ay=K}return W(new t.Desc(t,"fromPromise",[az]),t.fromBinder(function(aB){var aC;if((aC=az.then(aB,function(aD){return aB(new ae(aD))}))!=null){if(typeof aC.done==="function"){aC.done()}}return function(){if(aA){return typeof az.abort==="function"?az.abort():void 0}}},ay))};t.Observable.prototype.mapError=function(){var ay;ay=G(arguments);return W(new t.Desc(this,"mapError",[ay]),this.withHandler(function(az){if(az.isError()){return this.push(ak(ay(az.error)))}else{return this.push(az)}}))};t.Observable.prototype.flatMapError=function(ay){return W(new t.Desc(this,"flatMapError",[ay]),this.mapError(function(az){return new ae(az)}).flatMap(function(az){if(az instanceof ae){return ay(az.error)}else{return t.once(az)}}))};t.EventStream.prototype.sampledBy=function(ay,az){return W(new t.Desc(this,"sampledBy",[ay,az]),this.toProperty().sampledBy(ay,az))};t.Property.prototype.sampledBy=function(aA,aD){var az,ay,aB,aE,aC;if(aD!=null){aD=s(aD)}else{az=true;aD=function(aF){return aF.value()}}aC=new an(this,false,az);aB=new an(aA,true,az);aE=t.when([aC,aB],aD);ay=aA instanceof aj?aE.toProperty():aE;return W(new t.Desc(this,"sampledBy",[aA,aD]),ay)};t.Property.prototype.sample=function(ay){return W(new t.Desc(this,"sample",[ay]),this.sampledBy(t.interval(ay,{})))};t.Observable.prototype.map=function(){var ay,az;az=arguments[0],ay=2<=arguments.length?l.call(arguments,1):[];if(az instanceof aj){return az.sampledBy(this,L)}else{return D(this,az,ay,function(aA){return W(new t.Desc(this,"map",[aA]),this.withHandler(function(aB){return this.push(aB.fmap(aA))}))})}};t.Observable.prototype.fold=function(ay,az){return W(new t.Desc(this,"fold",[ay,az]),this.scan(ay,az).sampledBy(this.filter(false).mapEnd().toProperty()))};p.prototype.reduce=p.prototype.fold;t.fromPoll=function(ay,az){return W(new t.Desc(t,"fromPoll",[ay,az]),t.fromBinder(function(aA){var aB;aB=t.scheduler.setInterval(aA,ay);return function(){return t.scheduler.clearInterval(aB)}},az))};t.fromArray=function(ay){var az;if(!ay.length){return W(new t.Desc(t,"fromArray",ay),t.never())}else{az=0;return new j(new t.Desc(t,"fromArray",[ay]),function(aF){var aD,aB,aA,aE,aC;aC=false;aE=t.more;aA=false;aB=false;aD=function(){var aG;aB=true;if(aA){return}aA=true;while(aB){aB=false;if(aE!==t.noMore&&!aC){aG=ay[az++];aE=aF(c(aG));if(aE!==t.noMore){if(az===ay.length){aF(N())}else{ai.afterTransaction(aD)}}}}return aA=false};aD();return function(){return aC=true}})}};t.EventStream.prototype.holdWhen=function(aC){var ay,aD,az,aB,aA;aD=new aq();az=false;ay=[];aA=false;aB=this;return new j(new t.Desc(this,"holdWhen",[aC]),function(aF){var aE;aE=function(aG){if(typeof aG==="function"){aG()}if(aD.empty()&&aA){return aF(N())}};aD.add(function(aH,aG){return aC.subscribe(function(aI){var aJ;if(aI.hasValue()){az=aI.value();if(!az){aJ=ay;ay=[];return H.each(aJ,function(aK,aL){return aF(ak(aL))})}}else{if(aI.isEnd()){return aE(aG)}else{return aF(aI)}}})});aD.add(function(aH,aG){return aB.subscribe(function(aI){if(az&&aI.hasValue()){return ay.push(aI.value())}else{if(aI.isEnd()&&ay.length){return aE(aG)}else{return aF(aI)}}})});aA=true;aE();return aD.unsubscribe})};t.interval=function(ay,az){if(az==null){az={}}return W(new t.Desc(t,"interval",[ay,az]),t.fromPoll(ay,function(){return ak(az)}))};t.$={};t.$.asEventStream=function(az,ay,aA){var aB;if(H.isFunction(ay)){aB=[ay,void 0],aA=aB[0],ay=aB[1]}return W(new t.Desc(this.selector||this,"asEventStream",[az]),t.fromBinder(function(aC){return function(aD){aC.on(az,ay,aD);return function(){return aC.off(az,ay,aD)}}}(this),aA))};if((F=typeof jQuery!=="undefined"&&jQuery!==null?jQuery:typeof Zepto!=="undefined"&&Zepto!==null?Zepto:void 0)!=null){F.fn.asEventStream=t.$.asEventStream}t.Observable.prototype.log=function(){var ay;ay=1<=arguments.length?l.call(arguments,0):[];this.subscribe(function(az){return typeof console!=="undefined"&&console!==null?typeof console.log==="function"?console.log.apply(console,l.call(ay).concat([az.log()])):void 0:void 0});return this};t.EventStream.prototype.merge=function(ay){var az;az=this;return W(new t.Desc(az,"merge",[ay]),t.mergeAll(this,ay))};t.mergeAll=function(){var ay;ay=1<=arguments.length?l.call(arguments,0):[];if(a(ay[0])){ay=ay[0]}if(ay.length){return new j(new t.Desc(t,"mergeAll",ay),function(aC){var aA,az,aB;aA=0;aB=function(aD){return function(aE){return aD.dispatcher.subscribe(function(aG){var aF;if(aG.isEnd()){aA++;if(aA===ay.length){return aC(N())}else{return t.more}}else{aF=aC(aG);if(aF===t.noMore){aE()}return aF}})}};az=H.map(aB,ay);return new t.CompositeUnsubscribe(az).unsubscribe})}else{return t.never()}};t.repeatedly=function(aA,ay){var az;az=0;return W(new t.Desc(t,"repeatedly",[aA,ay]),t.fromPoll(aA,function(){return ay[az++%ay.length]}))};t.repeat=function(az){var ay;ay=0;return t.fromBinder(function(aE){var aA,aB,aD,aF,aC;aA=false;aD=t.more;aC=function(){};aB=function(aG){if(aG.isEnd()){if(!aA){return aA=true}else{return aF()}}else{return aD=aE(aG)}};aF=function(){var aG;aA=true;while(aA&&aD!==t.noMore){aG=az(ay++);aA=false;if(aG){aC=aG.subscribeInternal(aB)}else{aE(N())}}return aA=true};aF();return function(){return aC()}})};t.retry=function(aB){var aA,az,aF,aD,aE,ay,aC;if(!H.isFunction(aB.source)){throw new E("'source' option has to be a function")}aC=aB.source;ay=aB.retries||0;aE=aB.maxRetries||ay;aA=aB.delay||function(){return 0};aD=aB.isRetryable||function(){return true};aF=false;az=null;return W(new t.Desc(t,"retry",[aB]),t.repeat(function(){var aG,aH,aI;if(aF){return null}else{aI=function(){return aC().endOnError().withHandler(function(aJ){if(aJ.isError()){az=aJ;if(aD(az.error)&&ay>0){}else{aF=true;return this.push(aJ)}}else{if(aJ.hasValue()){az=null;aF=true}return this.push(aJ)}})};if(az){aG={error:az.error,retriesDone:aE-ay};aH=t.later(aA(aG)).filter(false);ay=ay-1;return aH.concat(t.once().flatMap(aI))}else{return aI()}}}))};t.sequentially=function(aA,ay){var az;az=0;return W(new t.Desc(t,"sequentially",[aA,ay]),t.fromPoll(aA,function(){var aB;aB=ay[az++];if(az<ay.length){return aB}else{if(az===ay.length){return[aB,N()]}else{return N()}}}))};t.Observable.prototype.skip=function(ay){return W(new t.Desc(this,"skip",[ay]),this.withHandler(function(az){if(!az.hasValue()){return this.push(az)}else{if(ay>0){ay--;return t.more}else{return this.push(az)}}}))};t.Observable.prototype.take=function(ay){if(ay<=0){return t.never()}return W(new t.Desc(this,"take",[ay]),this.withHandler(function(az){if(!az.hasValue()){return this.push(az)}else{ay--;if(ay>0){return this.push(az)}else{if(ay===0){this.push(az)}this.push(N());return t.noMore}}}))};t.EventStream.prototype.skipUntil=function(az){var ay;ay=az.take(1).map(true).toProperty(false);return W(new t.Desc(this,"skipUntil",[az]),this.filter(ay))};t.EventStream.prototype.skipWhile=function(){var ay,aA,az;aA=arguments[0],ay=2<=arguments.length?l.call(arguments,1):[];az=false;return D(this,aA,ay,function(aB){return W(new t.Desc(this,"skipWhile",[aB]),this.withHandler(function(aC){if(az||!aC.hasValue()||!aB(aC.value())){if(aC.hasValue()){az=true}return this.push(aC)}else{return t.more}}))})};t.Observable.prototype.slidingWindow=function(az,ay){if(ay==null){ay=0}return W(new t.Desc(this,"slidingWindow",[az,ay]),this.scan([],function(aA,aB){return aA.concat([aB]).slice(-az)}).filter(function(aA){return aA.length>=ay}))};t.spy=function(ay){return k.push(ay)};k=[];f=function(aB){var az,ay,aA;if(k.length){if(!f.running){try{f.running=true;for(az=0,ay=k.length;az<ay;az++){aA=k[az];aA(aB)}}finally{delete f.running}}}return void 0};t.Property.prototype.startWith=function(ay){return W(new t.Desc(this,"startWith",[ay]),this.scan(ay,function(aA,az){return az}))};t.EventStream.prototype.startWith=function(ay){return W(new t.Desc(this,"startWith",[ay]),t.once(ay).concat(this))};t.Observable.prototype.takeWhile=function(){var ay,az;az=arguments[0],ay=2<=arguments.length?l.call(arguments,1):[];return D(this,az,ay,function(aA){return W(new t.Desc(this,"takeWhile",[aA]),this.withHandler(function(aB){if(aB.filter(aA)){return this.push(aB)}else{this.push(N());return t.noMore}}))})};t.update=function(){var aA,az,ay,aB;az=arguments[0],aB=2<=arguments.length?l.call(arguments,1):[];ay=function(aC){return function(){var aD;aD=1<=arguments.length?l.call(arguments,0):[];return function(aE){return aC.apply(null,[aE].concat(aD))}}};aA=aB.length-1;while(aA>0){if(!(aB[aA] instanceof Function)){aB[aA]=function(aC){return function(){return aC}}(aB[aA])}aB[aA]=ay(aB[aA]);aA=aA-2}return W(new t.Desc(t,"update",[az].concat(l.call(aB))),t.when.apply(t,aB).scan(az,function(aC,aD){return aD(aC)}))};t.zipAsArray=function(){var ay;ay=1<=arguments.length?l.call(arguments,0):[];if(a(ay[0])){ay=ay[0]}return W(new t.Desc(t,"zipAsArray",ay),t.zipWith(ay,function(){var az;az=1<=arguments.length?l.call(arguments,0):[];return az}))};t.zipWith=function(){var az,ay,aA;az=arguments[0],aA=2<=arguments.length?l.call(arguments,1):[];if(!H.isFunction(az)){ay=[az,aA[0]],aA=ay[0],az=ay[1]}aA=H.map(function(aB){return aB.toEventStream()},aA);return W(new t.Desc(t,"zipWith",[az].concat(l.call(aA))),t.when(aA,az))};t.Observable.prototype.zip=function(ay,az){if(az==null){az=Array}return W(new t.Desc(this,"zip",[ay]),t.zipWith([this,ay],az))};t.Observable.prototype.first=function(){return W(new t.Desc(this,"first",[]),this.take(1))};t.Observable.prototype.last=function(){var ay;return W(new t.Desc(this,"last",[]),this.withHandler(function(az){if(az.isEnd()){if(ay){this.push(ay)}this.push(N());return t.noMore}else{ay=az}}))};t.EventStream.prototype.throttle=function(ay){return W(new t.Desc(this,"throttle",[ay]),this.bufferWithTime(ay).map(function(az){return az[az.length-1]}))};t.Property.prototype.throttle=function(ay){return this.delayChanges(new t.Desc(this,"throttle",[ay]),function(az){return az.throttle(ay)})};p.prototype.firstToPromise=function(ay){var az=this;if(typeof ay!=="function"){if(typeof Promise==="function"){ay=Promise}else{throw new E("There isn't default Promise, use shim or parameter")}}return new ay(function(aB,aA){return az.subscribe(function(aC){if(aC.hasValue()){aB(aC.value())}if(aC.isError()){aA(aC.error)}return t.noMore})})};p.prototype.toPromise=function(ay){return this.last().firstToPromise(ay)};if(typeof define!=="undefined"&&define!==null&&define.amd!=null){define([],function(){return t});this.Bacon=t}else{if(typeof module!=="undefined"&&module!==null&&module.exports!=null){module.exports=t;t.Bacon=t}else{this.Bacon=t}}}.call(this));