(function(c){var e=function(n,p){if(n.forEach){return n.forEach(p)}for(var o=0;o<n.length;o++){p(n[o],o,n)}};var b=function(n,p){if(n.map){return n.map(p)}var o=[];e(n,function(q,s,r){o.push(p(q,s,r))});return o};var a=function(n,p,o){if(n.reduce){return n.reduce(p,o)}e(n,function(q,s,r){o=p(o,q,s,r)});return o};var j=function(p){if(Object.keys){return Object.keys(p)}var o=[];for(var n in p){if(p.hasOwnProperty(n)){o.push(n)}}return o};var l=function(n,p){if(n.indexOf){return n.indexOf(p)}for(var o=0;o<n.length;o++){if(n[o]===p){return o}}return -1};var i;if(typeof process==="undefined"||!process.nextTick){i=function(n){setTimeout(n,0)}}else{i=process.nextTick}c.forEach=function(n,p,q){if(!n.length){return q()}var o=0;e(n,function(r){p(r,function(s){if(s){q(s);q=function(){}}else{o++;if(o==n.length){q()}}})})};c.forEachSeries=function(n,q,r){if(!n.length){return r()}var p=0;var o=function(){q(n[p],function(s){if(s){r(s);r=function(){}}else{p++;if(p==n.length){r()}else{o()}}})};o()};var f=function(n){return function(){var o=Array.prototype.slice.call(arguments);return n.apply(null,[c.forEach].concat(o))}};var m=function(n){return function(){var o=Array.prototype.slice.call(arguments);return n.apply(null,[c.forEachSeries].concat(o))}};var k=function(q,n,p,r){var o=[];n=b(n,function(s,t){return{index:t,value:s}});q(n,function(s,t){p(s.value,function(w,u){o[s.index]=u;t(w)})},function(s){r(s,o)})};c.map=f(k);c.mapSeries=m(k);c.reduce=function(n,o,p,q){c.forEachSeries(n,function(r,s){p(o,r,function(u,t){o=t;s(u)})},function(r){q(r,o)})};c.inject=c.reduce;c.foldl=c.reduce;c.reduceRight=function(n,o,p,r){var q=b(n,function(s){return s}).reverse();c.reduce(q,o,p,r)};c.foldr=c.reduceRight;var h=function(q,n,p,r){var o=[];n=b(n,function(s,t){return{index:t,value:s}});q(n,function(s,t){p(s.value,function(u){if(u){o.push(s)}t()})},function(s){r(b(o.sort(function(u,t){return u.index-t.index}),function(t){return t.value}))})};c.filter=f(h);c.filterSeries=m(h);c.select=c.filter;c.selectSeries=c.filterSeries;var d=function(q,n,p,r){var o=[];n=b(n,function(s,t){return{index:t,value:s}});q(n,function(s,t){p(s.value,function(u){if(!u){o.push(s)}t()})},function(s){r(b(o.sort(function(u,t){return u.index-t.index}),function(t){return t.value}))})};c.reject=f(d);c.rejectSeries=m(d);var g=function(p,n,o,q){p(n,function(r,s){o(r,function(t){if(t){q(r)}else{s()}})},function(r){q()})};c.detect=f(g);c.detectSeries=m(g);c.some=function(n,o,p){c.forEach(n,function(q,r){o(q,function(s){if(s){p(true);p=function(){}}r()})},function(q){p(false)})};c.any=c.some;c.every=function(n,o,p){c.forEach(n,function(q,r){o(q,function(s){if(!s){p(false);p=function(){}}r()})},function(q){p(true)})};c.all=c.every;c.sortBy=function(n,o,p){c.map(n,function(q,r){o(q,function(s,t){if(s){r(s)}else{r(null,{value:q,criteria:t})}})},function(r,q){if(r){return p(r)}else{p(null,b(q.sort(function(v,u){var t=v.criteria,s=u.criteria;return t<s?-1:t>s?1:0}),function(s){return s.value}))}})};c.auto=function(u,t){t=t||function(){};var r=j(u);if(!r.length){return t(null)}var q=[];var p=[];var n=function(v){p.unshift(v)};var o=function(w){for(var v=0;v<p.length;v++){if(p[v]===w){p.splice(v,1);return}}};var s=function(){e(p,function(v){v()})};n(function(){if(q.length==r.length){t(null)}});e(r,function(w){var v=(u[w] instanceof Function)?[u[w]]:u[w];var A=function(B){if(B){t(B);t=function(){}}else{q.push(w);s()}};var y=v.slice(0,Math.abs(v.length-1))||[];var x=function(){return a(y,function(C,B){return(C&&l(q,B)!=-1)},true)};if(x()){v[v.length-1](A)}else{var z=function(){if(x()){o(z);v[v.length-1](A)}};n(z)}})};c.waterfall=function(p,o){if(!p.length){return o()}o=o||function(){};var n=function(q){return function(t){if(t){o(t);o=function(){}}else{var r=Array.prototype.slice.call(arguments,1);var s=q.next();if(s){r.push(n(s))}else{r.push(o)}i(function(){q.apply(null,r)})}}};n(c.iterator(p))()};c.parallel=function(o,n){n=n||function(){};c.map(o,function(p,q){if(p){p(function(s){var r=Array.prototype.slice.call(arguments,1);if(r.length<=1){r=r[0]}q.call(null,s,r||null)})}},n)};c.series=function(o,n){n=n||function(){};c.mapSeries(o,function(p,q){if(p){p(function(s){var r=Array.prototype.slice.call(arguments,1);if(r.length<=1){r=r[0]}q.call(null,s,r||null)})}},n)};c.iterator=function(o){var n=function(p){var q=function(){if(o.length){o[p].apply(null,arguments)}return q.next()};q.next=function(){return(p<o.length-1)?n(p+1):null};return q};return n(0)};c.apply=function(o){var n=Array.prototype.slice.call(arguments,1);return function(){o.apply(null,n.concat(Array.prototype.slice.call(arguments)))}}})((typeof exports=="undefined")?this["async"]={}:exports);