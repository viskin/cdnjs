/* Postcodify, LGPL v3, see https://github.com/kijin/postcodify */
(function($){if("undefined"==typeof $.fn.postcodify){var e={version:"3.1.0",location:""};$("script").each(function(){var s=$(this).attr("src");if(s){var a=s.match(/^(https?:)?\/\/([^:\/]+)(?=[:\/]).*\/search\.(min\.)?js(?=\?|$)/);a&&(e.location=a[2])}}),$.fn.postcodify=function(s){return this.each(function(){var a=$.extend({api:e.freeAPI.defaultUrl,apiBackup:null,timeout:3e3,timeoutBackup:8e3,callBackupFirst:!1,controls:this,results:this,language:"ko",autoSelect:!1,requireExactQuery:!1,searchButtonContent:null,mapLinkProvider:!1,mapLinkContent:null,overrideDomain:null,insertDbid:null,insertPostcode5:null,insertPostcode6:null,insertAddress:null,insertJibeonAddress:null,insertEnglishAddress:null,insertEnglishJibeonAddress:null,insertDetails:null,insertExtraInfo:null,insertBuildingId:null,insertBuildingName:null,insertBuildingNums:null,insertOtherAddresses:null,beforeSearch:function(){},afterSearch:function(){},beforeSelect:function(){},afterSelect:function(){},onReady:function(){},onSuccess:function(){},onBackup:function(){},onError:function(){},onComplete:function(){},forceDisplayPostcode5:!1,forceDisplayPostcode6:!1,forceUseSSL:!1,focusKeyword:!0,focusDetails:!0,hideBuildingNums:!1,hideOldAddresses:!0,hideSummary:!1,useFullJibeon:!1,useAlert:!1,useCors:!0},s);a.language=a.language.toLowerCase(),a.api===e.freeAPI.defaultUrl&&null===a.apiBackup&&(a.apiBackup=e.freeAPI.backupUrl),a.api&&"//"===a.api.substr(0,2)&&(navigator.userAgent.match(/MSIE [56]\./)?a.api="http:"+a.api:a.forceUseSSL?a.api="https:"+a.api:window.location.protocol.match(/^https?/)||(a.api="http:"+a.api)),a.apiBackup&&"//"===a.apiBackup.substr(0,2)&&(navigator.userAgent.match(/MSIE [56]\./)?a.apiBackup="http:"+a.apiBackup:a.forceUseSSL?a.apiBackup="https:"+a.apiBackup:window.location.protocol.match(/^https?/)||(a.api="http:"+a.api)),null===a.insertBuildingId&&null!==a.insertDbid&&(a.insertBuildingId=a.insertDbid),null===a.searchButtonContent&&(a.searchButtonContent=e.translations[a.language].msgSearch);var t=$(a.results).postcodifyAddClass("search_form"),o=$("<div></div>").postcodifyAddClass("search_controls"),d="postcodify_"+(new Date).getTime().toString()+Math.random().toString().substr(2,4),l=($("<label></label>").attr("for",d).text(e.translations[a.language].msgKeywords).hide().appendTo(o),$('<input type="text" class="keyword" value="" />').attr("id",d).appendTo(o)),r=$('<button type="button" class="search_button"></button>').attr("id",d+"_button").html(a.searchButtonContent).appendTo(o);o.prependTo(a.controls);var n=null,i=!1;return l.keypress(function(e){13==e.which&&(e.preventDefault(),r.trigger("click"))}),r.focusin(function(){r.trigger("click")}),r.click(function(m){m.preventDefault();var o=$.trim(l.val());if(o!==n||!i&&!t.find("div.postcodify_search_result").filter(":visible").size()){if(n=o,t.find("div.postcodify_search_result,div.postcodify_search_status").remove(),o.length<3)return void(a.useAlert?alert(e.translations[a.language].errorTooShort):$('<div class="too_short"></div>').postcodifyAddClass("search_status").html(e.translations[a.language].errorTooShort.replace(/\n/g,"<br>")).appendTo(t));if(a.requireExactQuery&&!o.match(/(\uc0ac\uc11c\ud568|[\ub3d9\ub9ac\uac00\ub85c\uae38])\s*([0-9]+)(-[0-9]+)?(\ubc88\uc9c0?)?($|,|\s)/)&&!o.match(/^p\.?\s?o\.?\s?box\.?\s*([0-9]+)(-[0-9]+)?($|,|\s)/i)&&!o.match(/^([0-9]+)(-[0-9]+)?,?\s*[a-z0-9-\x20]+?(dong|ri|ga|ro|gil)($|,|\s)/i))return void(a.useAlert?alert(e.translations[a.language].errorExactQuery):$('<div class="too_short"></div>').postcodifyAddClass("search_status").html(e.translations[a.language].errorExactQuery.replace(/\n/g,"<br>")).appendTo(t));if(a.beforeSearch(o)!==!1){var g=$(window).scrollTop();r.attr("disabled","disabled");var c;navigator.userAgent&&navigator.userAgent.match(/MSIE [5-8]\./)?(r.text("."),c=setInterval(function(){switch(r.text()){case".":r.text("..");break;case"..":r.text("...");break;case"...":r.text("....");break;case"....":r.text(".")}},160)):(r.html('<img class="searching" alt="'+e.translations[a.language].msgSearch+'" src="'+e.searchProgress+'" />'),c=!1);var s,p,A,h,d,u=function(t,n,i){p=(new Date).getTime(),a.currentRequestUrl=t;var s={url:t,data:{v:e.version,q:o,ref:a.overrideDomain?a.overrideDomain:window.location.hostname,cdn:e.location},processData:!0,cache:!1,timeout:n,type:"GET",success:A,error:i,complete:function(){$(window).scrollTop(g),c!==!1&&clearTimeout(c),r.removeAttr("disabled").html(a.searchButtonContent)}};a.useCors&&"undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest?s.dataType="json":(s.dataType="jsonp",s.jsonpCallback="postcodify_"+p.toString()+Math.random().toString().substr(2,4)),$.ajax(s)};A=function(c){var S=((new Date).getTime()-p)/1e3;if(i=!1,a.currentRequestUrl===a.apiBackup&&(a.callBackupFirst=!0),a.afterSearch(o,c.results,c.lang,c.sort)!==!1){if(c.error&&c.error.toLowerCase().indexOf("database")>-1)a.currentRequestUrl===a.api&&a.apiBackup&&a.api!==a.apiBackup&&(a.onBackup(),u(a.apiBackup,a.timeoutBackup,d));else if(c.error&&c.error.toLowerCase().indexOf("quota")>-1)a.useAlert?alert(e.translations[a.language].errorQuota):(s=$('<div class="quota"></div>').postcodifyAddClass("search_status"),s.html(e.translations[a.language].errorQuota.replace(/\n/g,"<br>")),s.appendTo(t));else if(c.error)a.useAlert?alert(e.translations[a.language].errorError):(s=$('<div class="error"></div>').postcodifyAddClass("search_status"),s.html(e.translations[a.language].errorError.replace(/\n/g,"<br>")),s.appendTo(t)),n=null;else if(c.count<1)a.useAlert?alert(e.translations[a.language].errorEmpty):(s=$('<div class="empty"></div>').postcodifyAddClass("search_status"),s.html(e.translations[a.language].errorEmpty.replace(/\n/g,"<br>")),s.appendTo(t));else if("undefined"==typeof c.results[0].postcode5&&"undefined"==typeof c.results[0].other)a.useAlert?alert(e.translations[a.language].errorVersion):(s=$('<div class="error"></div>').postcodifyAddClass("search_status"),s.html(e.translations[a.language].errorVersion.replace(/\n/g,"<br>")),s.appendTo(t));else{var A;A="undefined"!=typeof c.lang&&"EN"===c.lang?"en":"ko";for(var _=0;_<c.count;_++){var r=c.results[_];"undefined"==typeof r.postcode5&&"undefined"!=typeof r.code5&&(r.postcode5=r.code5,r.postcode6=r.code6.replace(/[^0-9]/,""),r.ko_common=r.address.base,r.ko_doro=r.address["new"],r.ko_jibeon=r.address.old,r.en_common=r.english.base,r.en_doro=r.english["new"],r.en_jibeon=r.english.old,r.building_id=r.dbid,r.building_name=r.address.building,r.building_nums=r.other.bldnum,r.other_addresses=r.other.others,r.road_id=r.other.roadid);var l=$("<div></div>").postcodifyAddClass("search_result");l.data("dbid",r.building_id),l.data("code5",r.postcode5),l.data("code6",r.postcode6.substr(0,3)+"-"+r.postcode6.substr(3,3)),l.data("postcode5",r.postcode5),l.data("postcode6",r.postcode6.substr(0,3)+"-"+r.postcode6.substr(3,3)),l.data("address",r.ko_common+" "+r.ko_doro),l.data("jibeon_address",r.ko_common+" "+r.ko_jibeon),l.data("english_address",(""===r.en_doro?"":r.en_doro+", ")+r.en_common),l.data("english_jibeon_address",(""===r.en_jibeon?"":r.en_jibeon+", ")+r.en_common),l.data("building_id",r.building_id),l.data("building_name",r.building_name),l.data("building_nums",r.building_nums),l.data("extra_info_long",r.ko_jibeon+(""===r.building_name?"":", "+r.building_name)),l.data("extra_info_short",r.ko_jibeon.replace(/\s.+$/,"")+(""===r.building_name?"":", "+r.building_name)),l.data("extra_info_nums",c.nums),l.data("other_addresses",r.other_addresses),l.data("road_id",r.road_id);var g,h;"en"===A?"undefined"!=typeof c.sort&&"JIBEON"===c.sort?(g=l.data("english_jibeon_address"),h=r.en_doro):(g=l.data("english_address"),h=r.en_jibeon):("undefined"!=typeof c.sort&&"JIBEON"===c.sort?(g=l.data("jibeon_address"),h=r.ko_doro):(g=l.data("address"),h=r.ko_jibeon),""!==r.building_name&&null!==r.building_name&&(h+=", "+r.building_name,a.hideBuildingNums||""===r.building_nums||(h+=" "+r.building_nums)));var v=$('<a class="selector" href="#"></a>');v.append($('<span class="address_info"></span>').text(g)),null!==h&&""!==h&&v.append($('<span class="extra_info"></span>').append("("+h+")")),a.forceDisplayPostcode5?$('<div class="code"></div>').text(l.data("postcode5")).appendTo(l):a.forceDisplayPostcode6?$('<div class="code"></div>').text(l.data("postcode6")).appendTo(l):($('<div class="code6"></div>').text(l.data("postcode6")).appendTo(l),$('<div class="code5"></div>').text(l.data("postcode5")).appendTo(l)),$('<div class="address"></div>').append(v).appendTo(l);var k=l.data("other_addresses");if(""!==k){var b=$('<a href="#" class="show_old_addresses">\u25bc</a>');b.attr("title",e.translations[A].msgShowOthers),a.hideOldAddresses||b.css("display","none"),b.appendTo(l.find("div.address"));var y=$('<div class="old_addresses"></div>').text(k);a.hideOldAddresses&&y.css("display","none"),y.appendTo(l)}if(a.mapLinkProvider){var m;m="undefined"!=typeof e.mapProviders[a.mapLinkProvider]?e.mapProviders[a.mapLinkProvider]:a.mapLinkProvider,m=m.replace("$JUSO",encodeURIComponent(l.data("address")).replace(/%20/g,"+")),m=m.replace("$JIBEON",encodeURIComponent(l.data("jibeon_address")).replace(/%20/g,"+"));var C=null!==a.mapLinkContent?a.mapLinkContent:e.translations[A].msgMap,B=$('<a target="_blank"></a>').attr("href",m).html(C);$('<div class="map_link"></div>').append(B).appendTo(l)}l.appendTo(t)}if(!a.hideSummary){var f=$('<div class="summary"></div>').postcodifyAddClass("search_status");f.append('<div class="result_count">'+e.translations[A].msgResultCount+": <span>"+c.count+"</span></div>"),f.append('<div class="search_time">'+e.translations[A].msgSearchTime+": <span>"+Math.round(1e3*c.time)+"ms</span></div>"),f.append('<div class="network_time">'+e.translations[A].msgNetworkTime+": <span>"+Math.round(1e3*(S-parseFloat(c.time)))+"ms</span></div>"),f.appendTo(t)}c.count>=100&&(a.useAlert?alert(e.translations[A].errorTooMany):(s=$('<div class="too_many"></div>').postcodifyAddClass("search_status"),s.html(e.translations[A].errorTooMany.replace(/\n/g,"<br>")),s.insertBefore(t.find("div.postcodify_search_result").first())))}if("undefined"!=typeof c.msg&&""!==c.msg){var w=$('<div class="message"></div>').postcodifyAddClass("search_status");w.text(c.msg),w.insertBefore(t.find("div.too_many").size()?t.find("div.too_many").first():t.find("div.postcodify_search_result").first())}c.error||a.onSuccess(),a.onComplete(),!c.error&&1==c.count&&c.nums&&a.autoSelect&&t.find("div.postcodify_search_result a.selector").first().trigger("click")}},h=function(e,s,t){a.apiBackup?(a.onBackup(),u(a.apiBackup,a.timeoutBackup,d)):d(e,s,t)},d=function(){t.find("div.postcodify_search_status.error").show(),n=null,i=!1,a.onError(),a.onComplete()},i=!0,a.apiBackup&&a.callBackupFirst?u(a.apiBackup,a.timeoutBackup,d):u(a.api,a.timeout,h)}}}),t.on("click","div.code6,div.code5,div.old_addresses",function(e){e.preventDefault(),e.stopPropagation(),$(this).parent().find("a.selector").click()}),t.on("click","a.selector",function(l){l.preventDefault();var e=$(this).parents("div.postcodify_search_result");if(a.beforeSelect(e)!==!1){var o=e.data("address"),n=e.data("jibeon_address"),i=e.data("english_address"),d=e.data("english_jibeon_address");if(e.data("extra_info_nums")){var t=e.data("extra_info_nums"),r=/[0-9]+(-[0-9]+)? ~ [0-9]+(-[0-9]+)?/;o=o.replace(r,t),n=n.replace(r,t),i=i.replace(r,t),d=d.replace(r,t)}if(a.insertPostcode6&&$(a.insertPostcode6).val(e.data("code6")),a.insertPostcode5&&$(a.insertPostcode5).val(e.data("code5")),a.insertAddress&&$(a.insertAddress).val(o),a.insertJibeonAddress&&$(a.insertJibeonAddress).val(n),a.insertEnglishAddress&&$(a.insertEnglishAddress).val(i),a.insertEnglishJibeonAddress&&$(a.insertEnglishJibeonAddress).val(d),a.insertBuildingId&&$(a.insertBuildingId).val(e.data("building_id")),a.insertBuildingName&&$(a.insertBuildingName).val(e.data("building_name")),a.insertBuildingNums&&$(a.insertBuildingNums).val(e.data("building_nums")),a.insertOtherAddresses&&$(a.insertOtherAddresses).val(e.data("other_addresses")),a.insertExtraInfo){var s=e.data(a.useFullJibeon?"extra_info_long":"extra_info_short");s.length&&(s="("+s+")"),$(a.insertExtraInfo).val(a.insertExtraInfo===a.insertAddress?$(a.insertExtraInfo).val()+"\n"+s:s)}a.afterSelect(e)!==!1&&a.insertDetails&&a.focusDetails&&$(a.insertDetails).focus()}}),t.on("click","a.show_old_addresses",function(s){s.preventDefault();var e=$(this).parent().siblings(".old_addresses");e.is(":visible")?($(this).html("&#9660;"),e.hide()):($(this).html("&#9650;"),e.show())}),a.focusKeyword&&l.focus(),a.onReady(),this})},$.fn.postcodifyAddClass=function(e){return this.addClass("postcodify_"+e).addClass("postcode_"+e)},e.freeAPI={defaultUrl:"//api.poesis.kr/post/search.php",backupUrl:"//api.poesis.co.kr/post/search.php"},e.mapProviders={daum:"http://map.daum.net/?map_type=TYPE_MAP&urlLevel=3&q=$JUSO",naver:"http://map.naver.com/?mapMode=0&dlevel=12&query=$JUSO",google:"http://www.google.com/maps/place/"+encodeURIComponent("\ub300\ud55c\ubbfc\uad6d")+"+$JUSO"},e.translations={ko:{errorExactQuery:"\uc815\ud655\ud55c \ub3c4\ub85c\uba85+\uac74\ubb3c\ubc88\ud638 \ub610\ub294 \ub3d9\xb7\ub9ac+\ubc88\uc9c0\ub85c \uac80\uc0c9\ud574 \uc8fc\uc2ed\uc2dc\uc624.\n\uc608: \uc138\uc885\ub300\ub85c 110, \uc5f0\uc9c0\ub3d9 219-2, \uc0ac\uc11c\ud568 123-45",errorError:"\uac80\uc0c9 \uc11c\ubc84\uc640 \ud1b5\uc2e0 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud558\uc600\uc2b5\ub2c8\ub2e4.\n\uc7a0\uc2dc \ud6c4 \ub2e4\uc2dc \uc2dc\ub3c4\ud574 \uc8fc\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4.",errorEmpty:"\uac80\uc0c9 \uacb0\uacfc\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.\n\uc815\ud655\ud55c \ub3c4\ub85c\uba85+\uac74\ubb3c\ubc88\ud638 \ub610\ub294 \ub3d9\xb7\ub9ac+\ubc88\uc9c0\ub85c \uac80\uc0c9\ud574 \uc8fc\uc2dc\uace0,\n\ub2e4\ub978 \uac80\uc0c9\uc5b4 \uc0ac\uc6a9\uc2dc \ub744\uc5b4\uc4f0\uae30\uc5d0 \uc720\uc758\ud558\uc2ed\uc2dc\uc624.",errorQuota:"\uc77c\uc77c \ud5c8\uc6a9 \ucffc\ub9ac\uc218\ub97c \ucd08\uacfc\ud558\uc600\uc2b5\ub2c8\ub2e4.\n\uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud574 \uc8fc\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4.",errorVersion:"\uac80\uc0c9 \uc11c\ubc84\uc758 \ubc84\uc804\uc774 \ub0ae\uc544 \uc774 \uac80\uc0c9\ucc3d\uacfc \ud638\ud658\ub418\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.",errorTooShort:"\uac80\uc0c9\uc5b4\ub294 3\uae00\uc790 \uc774\uc0c1 \uc785\ub825\ud574 \uc8fc\uc2ed\uc2dc\uc624.",errorTooMany:"\uac80\uc0c9 \uacb0\uacfc\uac00 \ub108\ubb34 \ub9ce\uc544 100\uac74\ub9cc \ud45c\uc2dc\ud569\ub2c8\ub2e4.\n\uc815\ud655\ud55c \ub3c4\ub85c\uba85\uacfc \uac74\ubb3c\ubc88\ud638 \ub610\ub294 \ub3d9\xb7\ub9ac\uc640 \ubc88\uc9c0\ub85c \uac80\uc0c9\ud574 \uc8fc\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4.",msgResultCount:"\uac80\uc0c9 \uacb0\uacfc",msgSearchTime:"\uc18c\uc694 \uc2dc\uac04",msgNetworkTime:"\ud1b5\uc2e0 \uc9c0\uc5f0",msgSeeOthers:"\uad00\ub828\uc9c0\ubc88 \ubcf4\uae30",msgKeywords:"\uac80\uc0c9 \ud0a4\uc6cc\ub4dc",msgSearch:"\uac80\uc0c9",msgMap:"\uc9c0\ub3c4"},en:{errorExactQuery:"Please enter the exact name of your street, as well as the number(s).\nExample: 110 Sejong-daero, 219-2 Yeonji-dong, P.O.Box 123-45",errorError:"An error occurred while communicating to the search server.\nPlease try again later.",errorEmpty:"No addresses matched your search.\nPlease enter the exact legal name of your street, as well as the number(s).",errorQuota:"This website and/or your IP address has exceeded its daily search quota.\nPlease contact the administrator.",errorVersion:"The version of the search server is not compatible with this search function.",errorTooShort:"Please enter at least 3 characters.",errorTooMany:"Your search returned too many results. Only the first 100 items are shown below.\nPlease narrow down your search by adding the number(s).",msgResultCount:"Results",msgSearchTime:"Time taken",msgNetworkTime:"Network delay",msgSeeOthers:"See related addresses",msgKeywords:"Search keywords",msgSearch:"Search",msgMap:"Map"}},e.searchProgress="data:image/gif;base64,R0lGODlhEAALAPQAAP///yIiIt7e3tbW1uzs7CcnJyIiIklJSZKSknV1dcPDwz8/P2JiYpmZmXh4eMbGxkJCQiUlJWVlZenp6d3d3fX19VJSUuDg4PPz87+/v6ysrNDQ0PDw8AAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCwAAACwAAAAAEAALAAAFLSAgjmRpnqSgCuLKAq5AEIM4zDVw03ve27ifDgfkEYe04kDIDC5zrtYKRa2WQgAh+QQJCwAAACwAAAAAEAALAAAFJGBhGAVgnqhpHIeRvsDawqns0qeN5+y967tYLyicBYE7EYkYAgAh+QQJCwAAACwAAAAAEAALAAAFNiAgjothLOOIJAkiGgxjpGKiKMkbz7SN6zIawJcDwIK9W/HISxGBzdHTuBNOmcJVCyoUlk7CEAAh+QQJCwAAACwAAAAAEAALAAAFNSAgjqQIRRFUAo3jNGIkSdHqPI8Tz3V55zuaDacDyIQ+YrBH+hWPzJFzOQQaeavWi7oqnVIhACH5BAkLAAAALAAAAAAQAAsAAAUyICCOZGme1rJY5kRRk7hI0mJSVUXJtF3iOl7tltsBZsNfUegjAY3I5sgFY55KqdX1GgIAIfkECQsAAAAsAAAAABAACwAABTcgII5kaZ4kcV2EqLJipmnZhWGXaOOitm2aXQ4g7P2Ct2ER4AMul00kj5g0Al8tADY2y6C+4FIIACH5BAkLAAAALAAAAAAQAAsAAAUvICCOZGme5ERRk6iy7qpyHCVStA3gNa/7txxwlwv2isSacYUc+l4tADQGQ1mvpBAAIfkECQsAAAAsAAAAABAACwAABS8gII5kaZ7kRFGTqLLuqnIcJVK0DeA1r/u3HHCXC/aKxJpxhRz6Xi0ANAZDWa+kEAA7AAAAAAAAAAAA"}})(jQuery);