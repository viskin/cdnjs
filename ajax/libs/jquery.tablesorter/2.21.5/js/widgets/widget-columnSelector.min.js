(function(c){var b=c.tablesorter,a=".tscolsel",d=b.columnSelector={queryAll:"@media only all { [columns] { display: none; } } ",queryBreak:"@media all and (min-width: [size]) { [columns] { display: table-cell; } } ",init:function(g,i,e){var h,f;h=c(e.columnSelector_layout);if(!h.find("input").add(h.filter("input")).length){if(i.debug){b.log("ColumnSelector: >> ERROR: Column Selector aborting, no input found in the layout! ***")}return}i.tableId="tablesorter"+new Date().getTime();i.$table.addClass(i.tableId);f=i.selector={$container:c(e.columnSelector_container||"<div>")};f.$style=c("<style></style>").prop("disabled",true).appendTo("head");f.$breakpoints=c("<style></style>").prop("disabled",true).appendTo("head");f.isInitializing=true;d.setupSelector(g,i,e);if(e.columnSelector_mediaquery){d.setupBreakpoints(i,e)}f.isInitializing=false;if(f.$container.length){d.updateCols(i,e)}else{if(i.debug){b.log("ColumnSelector: >> container not found")}}i.$table.off("refreshColumnSelector"+a).on("refreshColumnSelector"+a,function(m,k){var j,n=c.isArray(k),o=this.config,l=o.widgetOptions;if(k&&o.selector.$container.length){if(n){c.each(k,function(q,p){k[q]=parseInt(p,10)});for(j=0;j<o.columns;j++){o.selector.$container.find("input[data-column="+j+"]").prop("checked",c.inArray(j,k)>=0)}}d.updateAuto(o,l,f.$container.find('input[data-column="auto"]').prop("checked",!n))}else{d.updateBreakpoints(o,l);d.updateCols(o,l)}})},setupSelector:function(m,g,i){var f,h=g.selector,l=h.$container,j=i.columnSelector_saveColumns&&b.storage,k=j?b.storage(m,"tablesorter-columnSelector"):[],e=j?b.storage(m,"tablesorter-columnSelector-auto"):{};h.auto=c.isEmptyObject(e)||c.type(e.auto)!=="boolean"?i.columnSelector_mediaqueryState:e.auto;h.states=[];h.$column=[];h.$wrapper=[];h.$checkbox=[];g.$table.children("thead").find("tr:first th",m).each(function(){var q=c(this),n=q.attr(i.columnSelector_priority)||1,o=q.attr("data-column"),p=b.getData(this,g.headers[o],"columnSelector");if(isNaN(n)&&n.length>0||p==="disable"||(i.columnSelector_columns[o]&&i.columnSelector_columns[o]==="disable")){return true}h.states[o]=k&&typeof(k[o])!=="undefined"?k[o]:typeof(i.columnSelector_columns[o])!=="undefined"?i.columnSelector_columns[o]:(p==="true"||p!=="false");h.$column[o]=c(this);f=q.attr(i.columnSelector_name)||q.text();if(l.length){h.$wrapper[o]=c(i.columnSelector_layout.replace(/\{name\}/g,f)).appendTo(l);h.$checkbox[o]=h.$wrapper[o].find("input").add(h.$wrapper[o].filter("input")).attr("data-column",o).toggleClass(i.columnSelector_cssChecked,h.states[o]).prop("checked",h.states[o]).on("change",function(){h.states[o]=this.checked;d.updateCols(g,i)}).change()}})},setupBreakpoints:function(g,e){var f=g.selector;if(e.columnSelector_mediaquery){f.lastIndex=-1;d.updateBreakpoints(g,e);g.$table.off("updateAll"+a).on("updateAll"+a,function(){d.updateBreakpoints(g,e);d.updateCols(g,e)})}if(f.$container.length){if(e.columnSelector_mediaquery){f.$auto=c(e.columnSelector_layout.replace(/\{name\}/g,e.columnSelector_mediaqueryName)).prependTo(f.$container);f.$auto.find("input").add(f.$auto.filter("input")).attr("data-column","auto").prop("checked",f.auto).toggleClass(e.columnSelector_cssChecked,f.auto).on("change",function(){d.updateAuto(g,e,c(this))}).change()}g.$table.off("update"+a).on("update"+a,function(){d.updateCols(g,e)})}},updateAuto:function(h,f,e){var g=h.selector;g.auto=e.prop("checked")||false;c.each(g.$checkbox,function(j,k){if(k){k[0].disabled=g.auto;g.$wrapper[j].toggleClass("disabled",g.auto)}});if(f.columnSelector_mediaquery){d.updateBreakpoints(h,f)}d.updateCols(h,f);if(h.selector.$popup){h.selector.$popup.find(".tablesorter-column-selector").html(g.$container.html()).find("input").each(function(){var i=c(this).attr("data-column");c(this).prop("checked",i==="auto"?g.auto:g.states[i])})}if(f.columnSelector_saveColumns&&b.storage){b.storage(h.$table[0],"tablesorter-columnSelector-auto",{auto:g.auto})}if(g.auto){h.$table.trigger("columnUpdate")}},updateBreakpoints:function(h,k){var l,e,i,j=h.selector,g="."+h.tableId,f=[],m="";if(k.columnSelector_mediaquery&&!j.auto){j.$breakpoints.prop("disabled",true);j.$style.prop("disabled",false);return}for(l=0;l<6;l++){i=[];h.$headers.filter("["+k.columnSelector_priority+"="+(l+1)+"]").each(function(){e=parseInt(c(this).attr("data-column"),10)+1;i.push(g+" col:nth-child("+e+")");i.push(g+" tr th:nth-child("+e+")");i.push(g+" tr td:nth-child("+e+")")});if(i.length){f=f.concat(i);m+=d.queryBreak.replace(/\[size\]/g,k.columnSelector_breakpoints[l]).replace(/\[columns\]/g,i.join(","))}}if(j.$style){j.$style.prop("disabled",true)}if(f.length){j.$breakpoints.prop("disabled",false).html(d.queryAll.replace(/\[columns\]/g,f.join(","))+m)}},updateCols:function(j,f){if(f.columnSelector_mediaquery&&j.selector.auto||j.selector.isInitializing){return}var e,h=j.selector,g=[],i="."+j.tableId;h.$container.find("input[data-column]").filter('[data-column!="auto"]').each(function(){if(!this.checked){e=parseInt(c(this).attr("data-column"),10)+1;g.push(i+" col:nth-child("+e+")");g.push(i+" tr th:nth-child("+e+")");g.push(i+" tr td:nth-child("+e+")")}c(this).toggleClass(f.columnSelector_cssChecked,this.checked)});if(f.columnSelector_mediaquery){h.$breakpoints.prop("disabled",true)}if(h.$style){h.$style.prop("disabled",false).html(g.length?g.join(",")+" { display: none; }":"")}if(f.columnSelector_saveColumns&&b.storage){b.storage(j.$table[0],"tablesorter-columnSelector",h.states)}j.$table.trigger("columnUpdate")},attachTo:function(h,k){h=c(h)[0];var g,e,f,j=h.config,i=c(k);if(i.length&&j){if(!i.find(".tablesorter-column-selector").length){i.append('<span class="tablesorter-column-selector"></span>')}g=j.selector;e=j.widgetOptions;i.find(".tablesorter-column-selector").html(g.$container.html()).find("input").each(function(){var l=c(this).attr("data-column"),m=l==="auto"?g.auto:g.states[l];c(this).toggleClass(e.columnSelector_cssChecked,m).prop("checked",m)});g.$popup=i.on("change","input",function(){f=c(this).toggleClass(e.columnSelector_cssChecked,this.checked).attr("data-column");g.$container.find('input[data-column="'+f+'"]').prop("checked",this.checked).trigger("change")})}}};b.addWidget({id:"columnSelector",priority:10,options:{columnSelector_container:null,columnSelector_columns:{},columnSelector_saveColumns:true,columnSelector_layout:'<label><input type="checkbox">{name}</label>',columnSelector_name:"data-selector-name",columnSelector_mediaquery:true,columnSelector_mediaqueryName:"Auto: ",columnSelector_mediaqueryState:true,columnSelector_breakpoints:["20em","30em","40em","50em","60em","70em"],columnSelector_priority:"data-priority",columnSelector_cssChecked:"checked"},init:function(g,f,h,e){d.init(g,h,e)},remove:function(f,i,e,h){if(h){return}var g=i.selector;g.$container.empty();if(g.$popup){g.$popup.empty()}g.$style.remove();g.$breakpoints.remove();i.$table.off("updateAll"+a+" update"+a)}})})(jQuery);