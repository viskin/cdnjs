/*! Widget: Build Table - updated 3/26/2015 (v2.21.3) */
;(function(c){var b=c.tablesorter=c.tablesorter||{},a=b.buildTable=function(i,k){var e=i.nodeName==="TABLE"?c(i):c("<table>").appendTo(i),m=e[0],l=k.widgetOptions=c.extend(true,{},a.defaults,k.widgetOptions),f=l.build_processing,h=l.build_type,j=l.build_source||k.data,g=function(o){var n=c.type(o),q=o instanceof jQuery;if(typeof f==="function"){o=f(o,l)}k.data=o;if(q||n==="string"){if(q||/<\s*\/tr\s*>/.test(o)){return a.html(m,o,l)}try{o=c.parseJSON(o||"null");if(o){return a.object(m,o,l)}}catch(p){}}if(n==="array"||n==="string"||h==="array"||h==="csv"){return a.csv(m,o,l)}return a.object(m,o,l)};m.config=k;if(!b.buildTable.hasOwnProperty(h)&&h!==""){if(k.debug){b.log("aborting build table widget, incorrect build type")}return false}if(j instanceof jQuery){g(c.trim(j.html()))}else{if(j&&(j.hasOwnProperty("url")||h==="json")){c.ajax(l.build_source).done(function(d){g(d)}).fail(function(d,o,n){if(k.debug){b.log("aborting build table widget, failed ajax load")}e.html('<tr><td class="error">'+d.status+" "+o+"</td></tr>")})}else{g(j)}}};a.defaults={build_type:"",build_source:"",build_processing:null,build_complete:"tablesorter-build-complete",build_headers:{rows:1,classes:[],text:[],widths:[]},build_footers:{rows:1,classes:[],text:[]},build_numbers:{addColumn:false,sortable:false},build_csvStartLine:0,build_csvSeparator:",",build_objectRowKey:"rows",build_objectCellKey:"cells",build_objectHeaderKey:"headers",build_objectFooterKey:"footers"};a.build={colgroup:function(e){var d="";if(e&&e.length){d+="<colgroup>";c.each(e,function(g,f){d+="<col"+(f?' style="width:'+f+'"':"")+">"});d+="</colgroup>"}return d},cell:function(l,m,g,f,k){var i,e,n=k?c("<col>"):"",o=m.build_headers.classes,h=m.build_headers.widths;if(/string|number/.test(typeof l)){e=c("<"+g+(o&&o[f]?' class="'+o[f]+'"':"")+">"+l+"</"+g+">");if(k&&h&&h[f]){n.width(h[f]||"")}}else{e=c("<"+g+">");for(i in l){if(l.hasOwnProperty(i)){if(i==="text"||i==="html"){e[i](l[i])}else{if(k&&i==="width"){n.width(l[i]||"")}else{e.attr(i,l[i])}}}}}return[e,n]},header:function(g,h){var e=h.build_headers.text,d=h.build_headers.classes,f="<tr>"+(h.build_numbers.addColumn?"<th"+(h.build_numbers.sortable?"":' class="sorter-false"')+">"+h.build_numbers.addColumn+"</th>":"");c.each(g,function(j,k){if(/<\s*\/t(d|h)\s*>/.test(k)){f+=k}else{f+="<th"+(d&&d[j]?' class="'+d[j]+'"':"")+">"+(e&&e[j]?e[j]:k)+"</th>"}});return f+"</tr>"},rows:function(e,d,l,j,f,k){var i=(k?"th":"td"),g="<tr>"+(j.build_numbers.addColumn?"<"+i+">"+(k?"":f)+"</"+i+">":"");c.each(e,function(h,m){if(/<\s*\/t(d|h)\s*>/.test(m)){g+=m}else{g+="<"+(k?i+(l&&l[h]?' class="'+l[h]+'"':""):i)+">"+(k&&d&&d.length&&d[h]?d[h]:m)+"</"+i+">"}});return g+"</tr>"}};a.buildComplete=function(e,d){c(e).trigger(d.build_complete);b.setup(e,e.config)};a.array=function(e,f,d){return a.csv(e,f,d)};a.csv=function(v,j,u){var q,l,g=u.build_type==="csv"||typeof j==="string",i=c(v),w=g?j.replace("\r","").split("\n"):j,n=w.length,k=0,s=false,d=u.build_headers.rows+(g?u.build_csvStartLine:0),m=u.build_footers.rows,e=0,p="",o,t=a.build.colgroup(u.build_headers.widths)+"<thead>";c.each(w,function(h,f){if(h>=n-m){s=true}if((g?h>=u.build_csvStartLine:true)&&(h<d)){l=g?a.splitCSV(f,u.build_csvSeparator):f;e=l.length;t+=a.build.header(l,u)}else{if(h>=d){if(h===d){t+="</thead><tbody>"}o=g?a.splitCSV(f,u.build_csvSeparator):f;if(s&&m>0){t+=(h===n-m?"</tbody><tfoot>":"")+(h===n?"</tfoot>":"")}if(o.length>1){k++;if(o.length!==e){p+="error on line "+h+": Item count ("+o.length+") does not match header count ("+e+") \n"}q=s?u.build_footers.classes:"";t+=a.build.rows(o,u.build_footers.text,q,u,k,s)}}}});t+=(m>0?"":"</tbody>");if(p){i.html(p)}else{i.html(t);a.buildComplete(v,u)}};a.splitCSV=function(h,g){var d,e,f=c.trim(h).split(g=g||",");for(d=f.length-1;d>=0;d--){if(f[d].replace(/\"\s+$/,'"').charAt(f[d].length-1)==='"'){if((e=f[d].replace(/^\s+\"/,'"')).length>1&&e.charAt(0)==='"'){f[d]=f[d].replace(/^\s*"|"\s*$/g,"").replace(/""/g,'"')}else{if(d){f.splice(d-1,2,[f[d-1],f[d]].join(g))}else{f=f.shift().split(g).concat(f)}}}else{f[d].replace(/""/g,'"')}}return f};a.html=function(e,f,d){var g=c(e);if(f instanceof jQuery){g.empty().append(f)}else{g.html(f)}a.buildComplete(e,d)};a.object=function(v,n,s){var k,i,w,e,m,f,p,q=v.config,g=s.build_objectHeaderKey,u=s.build_objectRowKey,o=n.hasOwnProperty(g)&&!c.isEmptyObject(n.kh)?n.kh:n.hasOwnProperty("headers")?n.headers:false,d=n.hasOwnProperty(u)&&!c.isEmptyObject(n.kr)?n.kr:n.hasOwnProperty("rows")?n.rows:false;if(!o||!d||o.length===0||d.length===0){if(q.debug){b.log("aborting build table widget, missing data for object build")}return false}e=c("<colgroup>");m=c("<table><thead/></table>");c.each(o,function(h,j){p=c("<tr>").appendTo(m.find("thead"));i=j.length;for(k=0;k<i;k++){w=a.build.cell(j[k],s,"th",k,h===0);if(w[0]&&w[0].length){w[0].appendTo(p)}if(h===0&&w[1]){w[1].appendTo(e)}}});if(e.find("col[style]").length){m.prepend(e)}f=c("<tbody>");c.each(d,function(l,r){var h;w=c.type(r)==="object";if(w&&r.newTbody){f=c("<tbody>").appendTo(m);for(h in r){if(r.hasOwnProperty(h)&&h!=="newTbody"){f.attr(h,r[h])}}}else{if(l===0){f.appendTo(m)}p=c("<tr>").appendTo(f);if(w){for(h in r){if(r.hasOwnProperty(h)&&h!==s.build_objectCellKey){p.attr(h,r[h])}}if(r.hasOwnProperty(s.build_objectCellKey)){r=r.cells}}i=r.length;for(h=0;h<i;h++){e=a.build.cell(r[h],s,"td",h);if(e[0]&&e[0].length){e[0].appendTo(p)}}}});if(n.hasOwnProperty(s.build_objectFooterKey)){w=n[s.build_objectFooterKey];if(w==="clone"){e=m.find("thead").html();m.append("<tfoot>"+e+"</tfoot>")}else{e=c("<tfoot>").appendTo(m);c.each(w,function(h,j){p=c("<tr>").appendTo(e);i=j.length;for(k=0;k<i;k++){f=a.build.cell(j[k],s,"th",k);if(f[0]&&f[0].length){f[0].appendTo(p)}}})}}c(v).html(m.html());a.buildComplete(v,s)};a.ajax=a.json=function(e,f,d){return a.object(e,f,d)}})(jQuery);