(function(d){var g=d.tablesorter,a=[],e=[],c=[],i=[],h=[],j=[],b=[],k=[],f=g.chart={nonDigit:/[^\d,.\-()]/g,init:function(m,l){m.$table.off(l.chart_event).on(l.chart_event,function(){if(this.hasInitialized){var n=this.config;f.getCols(n,n.widgetOptions);f.getData(n,n.widgetOptions)}})},getCols:function(n,m){var l;a=[];j=[];k=[];for(l=0;l<n.columns;l++){if(m.chart_useSelector&&g.hasWidget(n.table,"columnSelector")&&!n.selector.auto){if((n.selector.states[l]&&d.inArray(l,m.chart_ignoreColumns)<0)||l===m.chart_labelCol||l===m.chart_sort[0][0]){a.push(l)}}else{if(d.inArray(l,m.chart_ignoreColumns)<0||l===m.chart_labelCol||l===m.chart_sort[0][0]){a.push(l)}}}},getData:function(m,l){f.getHeaders(m,l);f.getRows(m,l);i=[e];d.each(c,function(n,o){i.push(o)});m.chart={data:i,categories:h,series:j,category:b,dataset:k}},getHeaders:function(n,l){var m;e=[];j=[];k=[];e.push(n.headerContent[l.chart_labelCol]);d.each(a,function(o,p){if(p===l.chart_labelCol){return true}m=n.headerContent[p];e.push(m);j.push({name:m,data:[]});k.push({seriesname:m,data:[]})})},getRows:function(o,m){var l=o.cache[0].normalized,n=[];c=[];h=[];b=[];d.each(l,function(u,s){var r,q,t=s[o.columns].$row,p=t.children("th,td"),v=[];if((/v/i.test(m.chart_incRows)&&t.is(":visible"))||(/f/i.test(m.chart_incRows)&&!t.hasClass(m.filter_filteredRow||"filtered"))||(!/(v|f)/i.test(m.chart_incRows))){for(r=0;r<o.columns;r++){if(d.inArray(u,m.chart_parsed)>=0){v.push(s[r])}else{q=p[r].getAttribute(o.textAttribute)||p[r].textContent||p.eq(r).text();v.push(d.trim(q))}}n.push(v)}});n.sort(function(q,p){if(m.chart_sort[0][1]===1){return g.sortNatural(p[m.chart_sort[0][0]],q[m.chart_sort[0][0]])}return g.sortNatural(q[m.chart_sort[0][0]],p[m.chart_sort[0][0]])});d.each(n,function(r,q){var s,u=0,t=[],p=q[m.chart_labelCol];t.push(""+p);d.each(q,function(w,x){var v;if(w===m.chart_labelCol){h.push(x);b.push({label:x});return true}s=false;if(m.chart_useSelector&&g.hasWidget(o.table,"columnSelector")&&!o.selector.auto){if(o.selector.states[w]&&d.inArray(w,m.chart_ignoreColumns)<0){s=""+x}}else{if(d.inArray(w,m.chart_ignoreColumns)<0){s=""+x}}if(s!==false){if(/s/i.test(""+m.chart_layout[t.length])){t.push(s);j[u].data.push(s);k[u].data.push(s)}else{v=g.formatFloat(s.replace(f.nonDigit,""),o.table);v=isNaN(v)?s:v;t.push(v);j[u].data.push(v);k[u].data.push({value:v})}u++}});c.push(t)})},remove:function(m,l){m.$table.off(l.chart_event)}};g.addWidget({id:"chart",options:{chart_incRows:"filtered",chart_useSelector:false,chart_ignoreColumns:[],chart_parsed:[],chart_layout:{0:"string"},chart_labelCol:0,chart_sort:[[0,0]],chart_event:"chartData"},init:function(n,m,o,l){f.init(o,l)},remove:function(m,n,l){f.remove(n,l)}})})(jQuery);