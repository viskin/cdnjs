/*! Widget: math - updated 2/9/2015 (v2.19.1) */
;(function(c){var b=c.tablesorter,a={events:("tablesorter-initialized update updateAll updateRows addRows updateCell filterReset filterEnd ").split(" ").join(".tsmath "),getRow:function(l,j,m,e){var d,f,i=l.config,g=[],h=m.closest("tr"),k=h.children();if(!h.hasClass(j.filter_filteredRow||"filtered")){if(j.math_ignore.length){k=k.not("["+e+"=ignore]").not("[data-column="+j.math_ignore.join("],[data-column=")+"]")}g=k.not(m).map(function(){d=c(this);f=d.attr(i.textAttribute);if(typeof f==="undefined"){f=this.textContent||d.text()}f=b.formatFloat(f.replace(/[^\w,. \-()]/g,""),l);return isNaN(f)?0:f}).get()}return g},getColumn:function(s,q,t,o,f){var g,h,e,k,d,j=[],n=s.config,m=q.filter_filteredRow||"filtered",p=parseInt(t.attr("data-column"),10),r=n.$table.children("tbody").children(),l=t.closest("tr");if(o==="above"){k=r.index(l);g=k;while(g>=0){e=r.eq(g).children().filter("[data-column="+p+"]");d=e.filter("["+f+"^=above]").length;if((!r.eq(g).hasClass(m)&&r.eq(g).not("["+f+"=ignore]").length&&g!==k)||d&&g!==k){if(d){g=0}else{if(e.length){h=e.attr(n.textAttribute);if(typeof h==="undefined"){h=e[0].textContent||e.text()}h=b.formatFloat(h.replace(/[^\w,. \-()]/g,""),s);j.push(isNaN(h)?0:h)}}}g--}}else{r.each(function(){e=c(this).children().filter("[data-column="+p+"]");if(!c(this).hasClass(m)&&e.not("["+f+"^=above],["+f+"^=col]").length&&!e.is(t)){h=e.attr(n.textAttribute);if(typeof h==="undefined"){h=(e[0]?e[0].textContent:"")||e.text()}h=b.formatFloat(h.replace(/[^\w,. \-()]/g,""),s);j.push(isNaN(h)?0:h)}})}return j},getAll:function(m,k,f){var g,e,d,h=[],j=m.config,i=k.filter_filteredRow||"filtered",l=j.$table.children("tbody").children();l.each(function(){if(!c(this).hasClass(i)){c(this).children().each(function(){e=c(this);d=parseInt(e.attr("data-column"),10);if(!e.filter("["+f+"]").length&&c.inArray(d,k.math_ignore)<0){g=e.attr(j.textAttribute);if(typeof g==="undefined"){g=(e[0]?e[0].textContent:"")||e.text()}g=b.formatFloat(g.replace(/[^\w,. \-()]/g,""),m);h.push(isNaN(g)?0:g)}})}});return h},recalculate:function(f,i,e,h){if(i&&(!e.math_isUpdating||h)){if(h){b.computeColumnIndex(i.$table.children("tbody").children())}var g="data-"+(e.math_data||"math"),d=i.$tbodies.find("["+g+"]");a.mathType(f,e,d,e.math_priority,g);d=i.$table.find("."+i.cssInfoBlock+", tfoot").find("["+g+"]");a.mathType(f,e,d,e.math_priority,g);a.mathType(f,e,i.$table.find("["+g+"^=all]"),["all"],g);e.math_isUpdating=true;i.$table.trigger("update")}},mathType:function(m,i,k,j,f){if(k.length){var h,n,e,g,d,l=b.equations;if(j[0]==="all"){d=a.getAll(m,i,f)}c.each(j,function(o,p){k.filter("["+f+"^="+p+"]").each(function(){e=c(this);h=(e.attr(f)||"").replace(p+"-","");g=(p==="row")?a.getRow(m,i,e,f):(p==="all")?d:a.getColumn(m,i,e,p,f);if(l[h]){n=l[h](g);if(m.config.debug&&console&&console.log){console.log(e.attr(f),g,"=",n)}a.output(e,i,n,g)}})})}},output:function(g,e,f,h){var d=b.formatMask(g.attr("data-"+e.math_data+"-mask")||e.math_mask,f,e.math_wrapPrefix,e.math_wrapSuffix);if(c.isFunction(e.math_complete)){d=e.math_complete(g,e,d,f,h)}if(d!==false){g.html(d)}}};b.formatMask=function(w,r,t,e){if(!w||isNaN(+r)){return r}var s,q,h,p,E,o,D,x,f,C,u,n,A,y,B,k,F,j,d,z="",g="";B=w.length;k=w.search(/[0-9\-\+#]/);F=k>0?w.substring(0,k):"";z=F;if(k>0&&t){if(/\{content\}/.test(t||"")){z=(t||"").replace(/\{content\}/g,F||"")}else{z=(t||"")+F}}d=w.split("").reverse().join("");j=d.search(/[0-9\-\+#]/);A=B-j;A+=(w.substring(A,A+1)===".")?1:0;F=j>0?w.substring(A,B):"";g=F;if(F!==""&&e){if(/\{content\}/.test(e||"")){g=(e||"").replace(/\{content\}/g,F||"")}else{g=F+(e||"")}}w=w.substring(k,A);r=w.charAt(0)=="-"?-r:+r;s=r<0?r=-r:0;q=w.match(/[^\d\-\+#]/g);h=(q&&q[q.length-1])||".";p=(q&&q[1]&&q[0])||",";w=w.split(h);r=r.toFixed(w[1]&&w[1].length);r=+(r)+"";o=w[1]&&w[1].lastIndexOf("0");x=r.split(".");if(!x[1]||(x[1]&&x[1].length<=o)){r=(+r).toFixed(o+1)}f=w[0].split(p);w[0]=f.join("");E=w[0]&&w[0].indexOf("0");if(E>-1){while(x[0].length<(w[0].length-E)){x[0]="0"+x[0]}}else{if(+x[0]===0){x[0]=""}}r=r.split(".");r[0]=x[0];D=(f[1]&&f[f.length-1].length);if(D){C=r[0];u="";n=C.length%D;y=C.length;for(A=0;A<y;A++){u+=C.charAt(A);if(!((A-n+1)%D)&&A<y-D){u+=p}}r[0]=u}r[1]=(w[1]&&r[1])?h+r[1]:"";return z+((s?"-":"")+r[0]+r[1])+g};b.equations={count:function(d){return d.length},sum:function(e){var d=0;c.each(e,function(f){d+=e[f]});return d},mean:function(e){var d=b.equations.sum(e);return d/e.length},median:function(e){e.sort(function(g,f){return g-f});var d=Math.floor(e.length/2);return(e.length%2)?e[d]:(e[d-1]+e[d])/2},mode:function(j){if(j.length===0){return"none"}var d,f,e={},h=1,g=[j[0]];for(d=0;d<j.length;d++){f=j[d];e[f]=e[f]?e[f]+1:1;if(e[f]>h){g=[f];h=e[f]}else{if(e[f]===h){g.push(f);h=e[f]}}}return g.sort(function(k,i){return k-i})},max:function(d){return Math.max.apply(Math,d)},min:function(d){return Math.min.apply(Math,d)},range:function(e){var d=e.sort(function(g,f){return g-f});return d[e.length-1]-d[0]},variance:function(h,e){var g=b.equations.mean(h),d=0,f=h.length;while(f--){d+=Math.pow((h[f]-g),2)}d/=(h.length-(e?0:1));return d},varp:function(d){return b.equations.variance(d,true)},vars:function(d){return b.equations.variance(d)},stdevs:function(e){var d=b.equations.variance(e);return Math.sqrt(d)},stdevp:function(e){var d=b.equations.variance(e,true);return Math.sqrt(d)}};b.addWidget({id:"math",priority:100,options:{math_data:"math",math_ignore:[],math_mask:"#,##0.00",math_complete:null,math_priority:["row","above","col"],math_prefix:"",math_suffix:"",math_event:"recalculate"},init:function(f,e,g,d){g.$table.off((a.events+" updateComplete.tsmath "+d.math_event).replace(/\s+/g," ")).on(a.events+" "+d.math_event,function(h){var i=h.type==="tablesorter-initialized";if(h.type==="updateAll"){b.computeColumnIndex(g.$table.children("tbody").children())}else{if(!d.math_isUpdating||i){a.recalculate(f,g,d,i)}}}).on("updateComplete.tsmath",function(){setTimeout(function(){d.math_isUpdating=false},500)});d.math_isUpdating=false},remove:function(e,g,d,f){if(f){return}c(e).off((a.events+" updateComplete.tsmath "+d.math_event).replace(/\s+/g," ")).find("[data-"+d.math_data+"]").empty()}})})(jQuery);