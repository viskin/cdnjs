/*! Widget: output - updated 3/26/2015 (v2.21.3) */
;(function(c){var b=c.tablesorter,a=b.output={event:"outputTable",regexQuote:/([\n\t\x09\x0d\x0a]|<[^<]+>)/,regexBR:/(<br([\s\/])?>|\n)/g,regexIMG:/<img[^>]+alt\s*=\s*['"]([^'"]+)['"][^>]*>/i,regexHTML:/<[^<]+>/g,replaceCR:"\x0d\x0a",replaceTab:"\x09",popupTitle:"Output",popupStyle:"width:100%;height:100%;",message:"Your device does not support downloading. Please try again in desktop browser.",init:function(d){d.$table.off(a.event).on(a.event,function(){a.process(d,d.widgetOptions)})},processRow:function(k,o,d,e){var l,r,g,n,f,i,m=k.widgetOptions,p=[],q=m.output_duplicateSpans,h=d&&e&&m.output_headerRows&&c.isFunction(m.output_callbackJSON),j=0;o.each(function(s){if(!p[s]){p[s]=[]}j=0;c(this).children().each(function(){l=c(this);if(l.filter("[rowspan]").length){n=parseInt(l.attr("rowspan"),10)-1;i=a.formatData(m,l.attr(m.output_dataAttrib)||l.html(),d);for(r=1;r<=n;r++){if(!p[s+r]){p[s+r]=[]}p[s+r][j]=d?i:q?i:""}}if(l.filter("[colspan]").length){f=parseInt(l.attr("colspan"),10)-1;i=a.formatData(m,l.attr(m.output_dataAttrib)||l.html(),d);for(g=1;g<=f;g++){if(l.filter("[rowspan]").length){n=parseInt(l.attr("rowspan"),10);for(r=0;r<n;r++){if(!p[s+r]){p[s+r]=[]}p[s+r][j+g]=h?m.output_callbackJSON(l,i,j+g)||i+"("+(j+g)+")":d?i:q?i:""}}else{p[s][j+g]=h?m.output_callbackJSON(l,i,j+g)||i+"("+(j+g)+")":d?i:q?i:""}}}if(l.css("display")!=="none"){while(typeof p[s][j]!=="undefined"){j++}p[s][j]=p[s][j]||a.formatData(m,l.attr(m.output_dataAttrib)||l.html(),d);j++}})});return p},ignoreColumns:function(d,e){c.each(e,function(f,g){e[f]=c.grep(g,function(i,h){return c.inArray(h,d.output_ignoreColumns)<0})});return e},process:function(l,o){var e,m,q,d,j,k,n=window.JSON&&JSON.hasOwnProperty("stringify"),i=0,f=(o.output_separator||",").toLowerCase(),p=f==="json",h=f==="array",g=p||h?",":o.output_separator,r=l.$table;o.output_regex=new RegExp("("+(/\\/.test(g)?"\\":"")+g+")");m=r.find("thead tr:visible").not("."+(b.css.filterRow||"tablesorter-filter-row"));d=a.processRow(l,m,true,p);q=r.children("tbody").children("tr");if(o.output_includeFooter){q=q.add(r.children("tfoot").children("tr").clone())}q=/f/.test(o.output_saveRows)?q.not("."+(o.filter_filteredRow||"filtered")):/v/.test(o.output_saveRows)?q.filter(":visible"):q;j=a.processRow(l,q);k=d.length;if(o.output_ignoreColumns.length){d=a.ignoreColumns(o,d);j=a.ignoreColumns(o,j)}if(p){f=[];c.each(j,function(s,t){f.push(a.row2Hash(d[(k>1&&o.output_headerRows)?s%k:k-1],t))});e=n?JSON.stringify(f):f}else{f=a.row2CSV(o,o.output_headerRows?d:[d[(k>1&&o.output_headerRows)?i%k:k-1]],h).concat(a.row2CSV(o,j,h));e=h&&n?JSON.stringify(f):f.join("\n")}if(c.isFunction(o.output_callback)&&!o.output_callback(l,e)){return}if(/p/i.test(o.output_delivery||"")){a.popup(e,o.output_popupStyle,p||h)}else{a.download(o,e)}},row2CSV:function(g,d,f){var e,j,i=[],h=d.length;for(j=0;j<h;j++){e=d[j].join("").replace(/\"/g,"");if(d[j].length>0&&e!==""){i[i.length]=f?d[j]:d[j].join(g.output_separator)}}return i},row2Hash:function(f,d){var e={};c.each(d,function(g,h){if(g<f.length){e[f[g]]=h}});return e},formatData:function(h,g,i){var e,f=(h.output_separator||",").toLowerCase(),j=f==="json"||f==="array",d=g.replace(/\"/g,h.output_replaceQuote||"\u201c");if(!h.output_trimSpaces){d=d.replace(a.regexBR,a.replaceCR).replace(/\t/g,a.replaceTab)}else{d=d.replace(a.regexBR,"")}e=d.match(a.regexIMG);if(!h.output_includeHTML&&e!==null){d=e[1]}d=h.output_includeHTML&&!i?d:d.replace(a.regexHTML,"");d=h.output_trimSpaces||i?c.trim(d):d;f=j?false:h.output_wrapQuotes||h.output_regex.test(d)||a.regexQuote.test(d);return f?'"'+d+'"':d},popup:function(f,e,d){var g=window.open("",a.popupTitle,e);g.document.write("<html><head><title>"+a.popupTitle+'</title></head><body><textarea wrap="'+(d?"on":"off")+'" style="'+a.popupStyle+'">'+f+"\n</textarea></body></html>");g.document.close();g.focus();return true},download:function(f,i){var j,d,l,k=window.navigator,h=document.createElement("a");if(/(iP)/g.test(k.userAgent)){alert(a.message);return false}try{l=!!new Blob()}catch(g){l=false}if(l){window.URL=window.webkitURL||window.URL;d=new Blob([i],{type:f.output_encoding});if(k.msSaveBlob){k.msSaveBlob(d,f.output_saveFileName)}else{h.href=window.URL.createObjectURL(d);h.download=f.output_saveFileName;if(document.createEvent){j=document.createEvent("MouseEvents");j.initMouseEvent("click",true,true,window,0,0,0,0,0,false,false,false,false,0,null);h.dispatchEvent(j)}}return false}window.open(f.output_encoding+encodeURIComponent(i)+"?download","_self");return true},remove:function(d){d.$table.off(a.event)}};b.addWidget({id:"output",options:{output_separator:",",output_ignoreColumns:[],output_includeFooter:false,output_dataAttrib:"data-name",output_headerRows:false,output_delivery:"popup",output_saveRows:"filtered",output_duplicateSpans:true,output_replaceQuote:"\u201c;",output_includeHTML:false,output_trimSpaces:true,output_wrapQuotes:false,output_popupStyle:"width=500,height=300",output_saveFileName:"mytable.csv",output_callback:function(d,e){return true},output_callbackJSON:function(f,d,e){return d+"("+(e)+")"},output_encoding:"data:application/octet-stream;charset=utf8,"},init:function(e,d,f){a.init(f)},remove:function(d,e){a.remove(e)}})})(jQuery);