/*! Dragtable Mod for TableSorter - 2/7/2015 (v2.19.0) */
;(function(e){var c,d=e.tablesorter;d.dragtable={create:function(k){var j,h=k.originalTable.el,i=k.options.dragHandle.replace(".","");h.children("thead").children().children("th,td").each(function(){var l=e(this);if(!l.find(k.options.dragHandle+",."+i+"-disabled").length){j=k.options.dragaccept?l.hasClass(k.options.dragaccept.replace(".","")):true;l.wrapInner('<div class="'+k.options.sortClass.replace(".","")+'"/>').prepend('<div class="'+i+(j?"":"-disabled")+'"></div>')}})},start:function(h){h=e(h)[0];if(h&&h.config){h.config.widgetOptions.dragtableLast={search:e(h).data("lastSearch"),order:d.dragtable.getOrder(h)}}},update:function(l){var w,m,i,n=l.originalTable,v=n.el[0],u=e(v),o=v.config,p=o&&o.widgetOptions,s=n.startIndex-1,k=n.endIndex-1,j=d.dragtable.getOrder(v)||[],r=d.hasWidget(u,"filter")||false,q=p&&p.dragtableLast||{},h=[];if((q.order||[]).join("")!==j.join("")){if(o.sortList.length){m=e.extend(true,[],o.sortList);e.each(j,function(t,x){i=d.isValueInArray(parseInt(x,10),m);if(x!==q.order[t]&&i>=0){o.sortList[i][0]=t}})}if(r){e.each(q.search||[],function(t){h[t]=q.search[j[t]]})}w=(d.hasWidget(o.$table,"editable")||false)?p.editable_columnsArray:false;if(w){o.widgetOptions.editable_columnsArray=d.dragtable.reindexArrayItem(w,s,k)}w=(d.hasWidget(o.$table,"math")||false)?p.math_ignore:false;if(w){o.widgetOptions.math_ignore=d.dragtable.reindexArrayItem(w,s,k)}w=(d.hasWidget(o.$table,"resizable")||false)?p.resizable_widths:false;if(w){p.resizable_widths=d.dragtable.moveArrayItem(w,s,k)}u.trigger("updateAll",[false,function(){if(r){setTimeout(function(){o.lastCombinedFilter=null;o.$table.data("lastSearch",h);d.setFilters(u,h);if(e.isFunction(l.options.tablesorterComplete)){l.options.tablesorterComplete(o.table)}},10)}}])}},getOrder:function(h){return e(h).children("thead").children("."+d.css.headerRow).children().map(function(){return e(this).attr("data-column")}).get()||[]},startColumnMove:function(k){var i,o=k.el[0].config,m=k.startIndex-1,j=k.endIndex-1,l=o.columns-1,n=j===l?false:j<=m,h=o.$table.children().children("tr");if(o.debug){d.log("Inserting column "+m+(n?" before":" after")+" column "+j)}h.each(function(){i=e(this).children();i.eq(m)[n?"insertBefore":"insertAfter"](i.eq(j))});i=o.$table.children("colgroup").children();i.eq(m)[n?"insertBefore":"insertAfter"](i.eq(j))},swapNodes:function(j,i){var m,l,k,h=j.length;for(m=0;m<h;m++){l=j[m].parentNode;k=j[m].nextSibling===i[m]?j[m]:j[m].nextSibling;i[m].parentNode.insertBefore(j[m],i[m]);l.insertBefore(i[m],k)}},moveArrayItem:function(l,k,i){var j,h=l.length;if(i>=h){j=i-h;while((j--)+1){l.push(c)}}l.splice(i,0,l.splice(k,1)[0]);return l},reindexArrayItem:function(n,m,j){var i=e.inArray(j,n),l=e.inArray(m,n),h=Math.max.apply(Math,n),k=[];if(i>=0&&l>=0){return n}e.each(n,function(o,p){if(j<m){if(p>=j){k.push(p+(p<m?1:0))}else{k.push(p)}}else{if(j>m){if(p===m){k.push(j)}else{if(p<j&&p>=m){k.push(p-1)}else{if(p<=j){k.push(p)}else{if(p>m){k.push(p+(p<j?0:1))}}}}}}});return k.sort()}};
/*! dragtable v2.0.14 Mod */
;e.widget("akottr.dragtable",{options:{revert:false,dragHandle:".table-handle",maxMovingRows:40,excludeFooter:false,onlyHeaderThreshold:100,dragaccept:null,persistState:null,restoreState:null,exact:true,clickDelay:10,containment:null,cursor:"move",cursorAt:false,distance:0,tolerance:"pointer",axis:"x",beforeStart:e.noop,beforeMoving:e.noop,beforeReorganize:e.noop,beforeStop:e.noop,tablesorterComplete:null,sortClass:".sorter"},originalTable:{el:null,selectedHandle:null,sortOrder:null,startIndex:0,endIndex:0},sortableTable:{el:e(),selectedHandle:e(),movingRow:e()},persistState:function(){var h=this;this.originalTable.el.find("th").each(function(j){if(this.id!==""){h.originalTable.sortOrder[this.id]=j}});e.ajax({url:this.options.persistState,data:this.originalTable.sortOrder})},_restoreState:function(h){for(var i in h){if(i in h){this.originalTable.startIndex=e("#"+i).closest("th").prevAll().length+1;this.originalTable.endIndex=parseInt(h[i],10)+1;this._bubbleCols()}}},_bubbleCols:function(){d.dragtable.startColumnMove(this.originalTable)},_rearrangeTableBackroundProcessing:function(){var h=this;return function(){h._bubbleCols();h.options.beforeStop(h.originalTable);h.sortableTable.el.remove();b();d.dragtable.update(h);if(e.isFunction(h.options.persistState)){h.options.persistState(h.originalTable)}else{h.persistState()}}},_rearrangeTable:function(){var h=this;return function(){h.originalTable.selectedHandle.removeClass("dragtable-handle-selected");h.sortableTable.el.sortable("disable");h.sortableTable.el.addClass("dragtable-disabled");h.options.beforeReorganize(h.originalTable,h.sortableTable);h.originalTable.endIndex=h.sortableTable.movingRow.prevAll().length+1;setTimeout(h._rearrangeTableBackroundProcessing(),50)}},_generateSortable:function(A){if(A.cancelBubble){A.cancelBubble=true}else{A.stopPropagation()}var w=this;var u=this.originalTable.el[0].attributes;var p="";for(var y=0;y<u.length;y++){if((u[y].value||u[y].nodeValue)&&u[y].nodeName!="id"&&u[y].nodeName!="width"){p+=u[y].nodeName+'="'+(u[y].value||u[y].nodeValue)+'" '}}var h=[];var r=[];w.originalTable.el.children("thead, tbody").children("tr:visible").slice(0,w.options.maxMovingRow).each(function(){var D=this.attributes;var E="";for(var i=0;i<D.length;i++){if((D[i].value||D[i].nodeValue)&&D[i].nodeName!="id"){E+=" "+D[i].nodeName+'="'+(D[i].value||D[i].nodeValue)+'"'}}h.push(E);r.push(e(this).height())});var x=[];var k=0;var l=w.originalTable.el.children();var C=l.filter("thead").children("tr:visible");var v=l.filter("tbody").children("tr:visible");C.eq(0).children("th, td").filter(":visible").each(function(){var i=e(this).outerWidth();x.push(i);k+=i});if(w.options.exact){var B=k-w.originalTable.el.outerWidth();x[0]-=B}k+=2;var s=0;l.filter("caption").each(function(){s+=e(this).outerHeight()});var z='<ul class="dragtable-sortable" style="position:absolute; width:'+k+'px;">';var q=[];var o,j=C.eq(0).children("th, td").length;for(y=0;y<j;y++){var n=C.children(":nth-child("+(y+1)+")");if(n.is(":visible")){o=0;q[y]='<li style="width:'+n.outerWidth()+'px;"><table '+p+">"+(s?'<caption style="height:'+s+'px;"></caption>':"")+"<thead>";C.each(function(i){q[y]+="<tr "+h[o++]+(r[i]?' style="height:'+r[i]+'px;"':"")+">"+n[i].outerHTML+"</tr>"});q[y]+="</thead><tbody>";n=v.children(":nth-child("+(y+1)+")");if(w.options.maxMovingRows>1){n=n.add(v.children(":nth-child("+(y+1)+")").slice(0,w.options.maxMovingRows-1))}n.each(function(i){q[y]+="<tr "+h[o++]+(r[i]?' style="height:'+r[i]+'px;"':"")+">"+this.outerHTML+"</tr>"});q[y]+="</tbody>";if(!w.options.excludeFooter){q[y]+="<tfoot><tr "+h[o++]+">"+l.filter("tfoot").children("tr:visible").children()[y].outerHTML+"</tr></tfoot>"}q[y]+="</table></li>"}}z+=q.join("")+"</ul>";this.sortableTable.el=this.originalTable.el.before(z).prev();this.sortableTable.el.find("> li > table").each(function(D){e(this).css("width",x[D]+"px")});this.sortableTable.selectedHandle=this.sortableTable.el.find("th .dragtable-handle-selected");var t=!this.options.dragaccept?"li":"li:has("+this.options.dragaccept+")";this.sortableTable.el.sortable({items:t,stop:this._rearrangeTable(),revert:this.options.revert,tolerance:this.options.tolerance,containment:this.options.containment,cursor:this.options.cursor,cursorAt:this.options.cursorAt,distance:this.options.distance,axis:this.options.axis});this.originalTable.startIndex=e(A.target).closest("th,td").prevAll().length+1;this.options.beforeMoving(this.originalTable,this.sortableTable);this.sortableTable.movingRow=this.sortableTable.el.children("li:nth-child("+this.originalTable.startIndex+")");f();this.sortableTable.movingRow.trigger(e.extend(e.Event(A.type),{which:1,clientX:A.clientX,clientY:A.clientY,pageX:A.pageX,pageY:A.pageY,screenX:A.screenX,screenY:A.screenY}));var m=this.sortableTable.el.find(".ui-sortable-placeholder");if(m.height()>0){m.css("height",this.sortableTable.el.find(".ui-sortable-helper").height())}m.html('<div class="outer" style="height:100%;"><div class="inner" style="height:100%;"></div></div>')},bindTo:{},_create:function(){var h=this;h.originalTable={el:h.element,selectedHandle:e(),sortOrder:{},startIndex:0,endIndex:0};d.dragtable.create(h);h.bindTo="> thead > tr > "+(h.options.dragaccept||"th, td");if(h.element.find(h.bindTo).find(h.options.dragHandle).length){h.bindTo+=" "+h.options.dragHandle}if(e.isFunction(h.options.restoreState)){h.options.restoreState(h.originalTable)}else{h._restoreState(h.options.restoreState)}h.originalTable.el.on("mousedown.dragtable",h.bindTo,function(i){if(i.which!==1){return}d.dragtable.start(h.originalTable.el);if(h.options.beforeStart(h.originalTable)===false){return}clearTimeout(h.downTimer);h.downTimer=setTimeout(function(){h.originalTable.selectedHandle=e(h);h.originalTable.selectedHandle.addClass("dragtable-handle-selected");h._generateSortable(i)},h.options.clickDelay)}).on("mouseup.dragtable",h.options.dragHandle,function(){clearTimeout(h.downTimer)})},redraw:function(){this.destroy();this._create()},destroy:function(){this.originalTable.el.off("mousedown.dragtable mouseup.dragtable",this.bindTo);e.Widget.prototype.destroy.apply(this,arguments)}});var g=e(document.body).attr("onselectstart"),a=e(document.body).attr("unselectable");function f(){var h=e('<style id="__dragtable_disable_text_selection__" type="text/css">body { -ms-user-select:none;-moz-user-select:-moz-none;-khtml-user-select:none;-webkit-user-select:none;user-select:none; }</style>');e(document.head).append(h);e(document.body).attr("onselectstart","return false;").attr("unselectable","on");if(window.getSelection){window.getSelection().removeAllRanges()}else{document.selection.empty()}}function b(){e("#__dragtable_disable_text_selection__").remove();if(g){e(document.body).attr("onselectstart",g)}else{e(document.body).removeAttr("onselectstart")}if(a){e(document.body).attr("unselectable",a)}else{e(document.body).removeAttr("unselectable")}}})(jQuery);