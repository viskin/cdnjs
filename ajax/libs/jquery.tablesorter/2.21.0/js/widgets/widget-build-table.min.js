!function(t){"use strict";var e=t.tablesorter=t.tablesorter||{},r=e.buildTable=function(o,l){var n="TABLE"===o.tagName?t(o):t("<table>").appendTo(o),i=n[0],a=l.widgetOptions=t.extend(!0,{},r.defaults,l.widgetOptions),d=a.build_processing,s=a.build_type,u=a.build_source||l.data,c=function(e){var o=t.type(e),n=e instanceof jQuery;if("function"==typeof d&&(e=d(e,a)),l.data=e,n||"string"===o){if(n||/<\s*\/tr\s*>/.test(e))return r.html(i,e,a);try{if(e=t.parseJSON(e||"null"))return r.object(i,e,a)}catch(u){}}return"array"===o||"string"===o||"array"===s||"csv"===s?r.csv(i,e,a):r.object(i,e,a)};return i.config=l,e.buildTable.hasOwnProperty(s)||""===s?void(u instanceof jQuery?c(t.trim(u.html())):u&&(u.hasOwnProperty("url")||"json"===s)?t.ajax(a.build_source).done(function(t){c(t)}).fail(function(t,r){l.debug&&e.log("aborting build table widget, failed ajax load"),n.html('<tr><td class="error">'+t.status+" "+r+"</td></tr>")}):c(u)):(l.debug&&e.log("aborting build table widget, incorrect build type"),!1)};r.defaults={build_type:"",build_source:"",build_processing:null,build_complete:"tablesorter-build-complete",build_headers:{rows:1,classes:[],text:[],widths:[]},build_footers:{rows:1,classes:[],text:[]},build_numbers:{addColumn:!1,sortable:!1},build_csvStartLine:0,build_csvSeparator:",",build_objectRowKey:"rows",build_objectCellKey:"cells",build_objectHeaderKey:"headers",build_objectFooterKey:"footers"},r.build={colgroup:function(e){var r="";return e&&e.length&&(r+="<colgroup>",t.each(e,function(t,e){r+="<col"+(e?' style="width:'+e+'"':"")+">"}),r+="</colgroup>"),r},cell:function(e,r,o,l,n){var i,a,d=n?t("<col>"):"",s=r.build_headers.classes,u=r.build_headers.widths;if(/string|number/.test(typeof e))a=t("<"+o+(s&&s[l]?' class="'+s[l]+'"':"")+">"+e+"</"+o+">"),n&&u&&u[l]&&d.width(u[l]||"");else{a=t("<"+o+">");for(i in e)e.hasOwnProperty(i)&&("text"===i||"html"===i?a[i](e[i]):n&&"width"===i?d.width(e[i]||""):a.attr(i,e[i]))}return[a,d]},header:function(e,r){var o=r.build_headers.text,l=r.build_headers.classes,n="<tr>"+(r.build_numbers.addColumn?"<th"+(r.build_numbers.sortable?"":' class="sorter-false"')+">"+r.build_numbers.addColumn+"</th>":"");return t.each(e,function(t,e){n+=/<\s*\/t(d|h)\s*>/.test(e)?e:"<th"+(l&&l[t]?' class="'+l[t]+'"':"")+">"+(o&&o[t]?o[t]:e)+"</th>"}),n+"</tr>"},rows:function(e,r,o,l,n,i){var a=i?"th":"td",d="<tr>"+(l.build_numbers.addColumn?"<"+a+">"+(i?"":n)+"</"+a+">":"");return t.each(e,function(t,e){d+=/<\s*\/t(d|h)\s*>/.test(e)?e:"<"+(i?a+(o&&o[t]?' class="'+o[t]+'"':""):a)+">"+(i&&r&&r.length&&r[t]?r[t]:e)+"</"+a+">"}),d+"</tr>"}},r.buildComplete=function(r,o){t(r).trigger(o.build_complete),e.setup(r,r.config)},r.array=function(t,e,o){return r.csv(t,e,o)},r.csv=function(e,o,l){var n,i,a,d="csv"===l.build_type||"string"==typeof o,s=t(e),u=d?o.replace("\r","").split("\n"):o,c=u.length,b=0,h=!1,p=l.build_headers.rows+(d?l.build_csvStartLine:0),f=l.build_footers.rows,g=0,y="",_=r.build.colgroup(l.build_headers.widths)+"<thead>";t.each(u,function(t,e){t>=c-f&&(h=!0),(d?t>=l.build_csvStartLine:!0)&&p>t?(i=d?r.splitCSV(e,l.build_csvSeparator):e,g=i.length,_+=r.build.header(i,l)):t>=p&&(t===p&&(_+="</thead><tbody>"),a=d?r.splitCSV(e,l.build_csvSeparator):e,h&&f>0&&(_+=(t===c-f?"</tbody><tfoot>":"")+(t===c?"</tfoot>":"")),a.length>1&&(b++,a.length!==g&&(y+="error on line "+t+": Item count ("+a.length+") does not match header count ("+g+") \n"),n=h?l.build_footers.classes:"",_+=r.build.rows(a,l.build_footers.text,n,l,b,h)))}),_+=f>0?"":"</tbody>",y?s.html(y):(s.html(_),r.buildComplete(e,l))},r.splitCSV=function(e,r){var o,l,n=t.trim(e).split(r=r||",");for(o=n.length-1;o>=0;o--)'"'===n[o].replace(/\"\s+$/,'"').charAt(n[o].length-1)?(l=n[o].replace(/^\s+\"/,'"')).length>1&&'"'===l.charAt(0)?n[o]=n[o].replace(/^\s*"|"\s*$/g,"").replace(/""/g,'"'):o?n.splice(o-1,2,[n[o-1],n[o]].join(r)):n=n.shift().split(r).concat(n):n[o].replace(/""/g,'"');return n},r.html=function(e,o,l){var n=t(e);o instanceof jQuery?n.empty().append(o):n.html(o),r.buildComplete(e,l)},r.object=function(o,l,n){var i,a,d,s,u,c,b,h=o.config,p=n.build_objectHeaderKey,f=n.build_objectRowKey,g=l.hasOwnProperty(p)&&!t.isEmptyObject(l.kh)?l.kh:l.hasOwnProperty("headers")?l.headers:!1,y=l.hasOwnProperty(f)&&!t.isEmptyObject(l.kr)?l.kr:l.hasOwnProperty("rows")?l.rows:!1;return g&&y&&0!==g.length&&0!==y.length?(s=t("<colgroup>"),u=t("<table><thead/></table>"),t.each(g,function(e,o){for(b=t("<tr>").appendTo(u.find("thead")),a=o.length,i=0;a>i;i++)d=r.build.cell(o[i],n,"th",i,0===e),d[0]&&d[0].length&&d[0].appendTo(b),0===e&&d[1]&&d[1].appendTo(s)}),s.find("col[style]").length&&u.prepend(s),c=t("<tbody>"),t.each(y,function(e,o){var l;if(d="object"===t.type(o),d&&o.newTbody){c=t("<tbody>").appendTo(u);for(l in o)o.hasOwnProperty(l)&&"newTbody"!==l&&c.attr(l,o[l])}else{if(0===e&&c.appendTo(u),b=t("<tr>").appendTo(c),d){for(l in o)o.hasOwnProperty(l)&&l!==n.build_objectCellKey&&b.attr(l,o[l]);o.hasOwnProperty(n.build_objectCellKey)&&(o=o.cells)}for(a=o.length,l=0;a>l;l++)s=r.build.cell(o[l],n,"td",l),s[0]&&s[0].length&&s[0].appendTo(b)}}),l.hasOwnProperty(n.build_objectFooterKey)&&(d=l[n.build_objectFooterKey],"clone"===d?(s=u.find("thead").html(),u.append("<tfoot>"+s+"</tfoot>")):(s=t("<tfoot>").appendTo(u),t.each(d,function(e,o){for(b=t("<tr>").appendTo(s),a=o.length,i=0;a>i;i++)c=r.build.cell(o[i],n,"th",i),c[0]&&c[0].length&&c[0].appendTo(b)}))),t(o).html(u.html()),void r.buildComplete(o,n)):(h.debug&&e.log("aborting build table widget, missing data for object build"),!1)},r.ajax=r.json=function(t,e,o){return r.object(t,e,o)}}(jQuery);