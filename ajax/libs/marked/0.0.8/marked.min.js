(function(){var c={newline:/^\n+/,block:/^ {4,}[^\n]*(?:\n {4,}[^\n]*|\n)*(?=\n| *$)/,hr:/^( *[\-*_]){3,} *\n/,heading:/^ *(#{1,6}) *([^\n#]*) *#*/,lheading:/^([^\n]+)\n *(=|-){3,}/,blockquote:/^ *>[^\n]*(?:\n *>[^\n]*)*/,list:/^( *)([*+-]|\d+\.) [^\0]+?(?:\n{2,}(?! )|\s*$)(?!\1\2|\1\d+\.)/,html:/^ *(?:<!--[^\0]*?-->|<(\w+)[^\0]+?<\/\1>|<[^<>\n]+>) *(?:\n{2,}|\s*$)/,text:/^[^\n]+/};c.keys=["newline","block","heading","lheading","hr","blockquote","list","html","text"];c.lexer=function(n){var m=[],l={};n=n.replace(/\r\n/g,"\n").replace(/\r/g,"\n").replace(/\t/g,"    ");n=n.replace(/^ {0,3}\[([^\]]+)\]: *([^ ]+)(?: +"([^\n]+)")? *$/gm,function(p,r,o,q){l[r]={href:o,title:q};return""});m.links=l;return c.token(n,m)};c.token=function(n,o){n=n.replace(/^ +$/gm,"");var q=c,s=c.keys,m=s.length,p,r,l;var t=function(){if(!n){return}for(var u=0;u<m;u++){p=s[u];if(r=q[p].exec(n)){n=n.substring(r[0].length);return true}}};while(t()){switch(p){case"newline":if(r[0].length>1){o.push({type:"space"})}break;case"hr":o.push({type:"hr"});break;case"lheading":o.push({type:"heading",depth:r[2]==="="?1:2,text:r[1]});break;case"heading":o.push({type:"heading",depth:r[1].length,text:r[2]});break;case"block":r=r[0].replace(/^ {4}/gm,"");o.push({type:"block",text:r});break;case"list":o.push({type:"list_start",ordered:isFinite(r[2])});l=/\n *\n *(?:[*+-]|\d+\.)/.test(r[0]);r=r[0].match(/^( *)([*+-]|\d+\.)[^\n]*(?:\n(?!\1(?:\2|\d+\.))[^\n]*)*/gm);i(r,function(u){u=u.replace(/^ *([*+-]|\d+\.) */,"");var v=/\n( +)/.exec(u);if(v){v=new RegExp("^"+v[1],"gm");u=u.replace(v,"")}o.push({type:l?"loose_item_start":"list_item_start"});c.token(u,o);o.push({type:"list_item_end"})});o.push({type:"list_end"});break;case"html":case"text":o.push({type:p,text:r[0]});break;case"blockquote":o.push({type:"blockquote_start"});r=r[0].replace(/^ *>/gm,"");c.token(r,o);o.push({type:"blockquote_end"});break}}return o};var f={escape:/^\\([\\`*{}\[\]()#+\-.!_])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,tag:/^<!--[^\0]*?-->|^<[^\n>]+>/,link:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]\s*\(([^\)]*)\)/,reflink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([^\0]+?)__(?!_)|^\*\*([^\0]+?)\*\*(?!\*)/,em:/^_([^_]+)_|^\*([^*]+)\*/,code:/^`([^`]+)`|^``([^\0]+?)``/,br:/^ {2,}\n(?!\s*$)/,text:/^/};f.keys=["escape","autolink","tag","link","reflink","nolink","strong","em","code","br","text"];f.text=(function(){var l=[];(function m(n){n=f[n].source;l.push(n.replace(/(^|[^\[])\^/g,"$1"));return m})("escape")("tag")("nolink")("strong")("em")("code")("br");return new RegExp("^[^\\0]+?(?="+l.join("|")+"|$)")})();f.lexer=function(o){var m="",u=g.links,p,s,l;var t=f,v=f.keys,n=v.length,q,r;var w=function(){if(!o){return}for(var x=0;x<n;x++){q=v[x];if(r=t[q].exec(o)){o=o.substring(r[0].length);return true}}};while(w()){switch(q){case"escape":m+=r[1];break;case"tag":m+=r[0];break;case"link":case"reflink":case"nolink":if(q!=="link"){p=(r[2]||r[1]).replace(/\s+/g," ");p=u[p];if(!p){m+=r[0][0];o=r[0].substring(1)+o;break}}else{s=/^\s*<?([^\s]*?)>?(?:\s+"([^\n]+)")?\s*$/.exec(r[2]);p={href:s[1],title:s[2]}}if(r[0][0]!=="!"){m+='<a href="'+j(p.href)+'"'+(p.title?' title="'+j(p.title)+'"':"")+">"+f.lexer(r[1])+"</a>"}else{m+='<img src="'+j(p.href)+'" alt="'+j(r[1])+'"'+(p.title?' title="'+j(p.title)+'"':"")+">"}break;case"autolink":if(r[2]==="@"){s=h(r[1]);l=h("mailto:")+s}else{s=j(r[1]);l=s}m+='<a href="'+l+'">'+s+"</a>";break;case"strong":m+="<strong>"+f.lexer(r[2]||r[1])+"</strong>";break;case"em":m+="<em>"+f.lexer(r[2]||r[1])+"</em>";break;case"code":m+="<code>"+j(r[2]||r[1])+"</code>";break;case"br":m+="<br>";break;case"text":m+=j(r[0]);break;default:break}}return m};var g,b;var e=function(){return b=g.pop()};var k=function(){switch(b.type){case"space":return"";case"hr":return"<hr>";case"heading":return"<h"+b.depth+">"+f.lexer(b.text)+"</h"+b.depth+">";case"block":return"<pre><code>"+j(b.text)+"</code></pre>";case"blockquote_start":var l=[];while(e().type!=="blockquote_end"){l.push(k())}return"<blockquote>"+l.join("")+"</blockquote>";case"list_start":var l=[],m=b.ordered?"ol":"ul";while(e().type!=="list_end"){l.push(k())}return"<"+m+">"+l.join("")+"</"+m+">";case"list_item_start":var l=[];while(e().type!=="list_item_end"){l.push(b.type==="text"?f.lexer(b.text):k())}return"<li>"+l.join(" ")+"</li>";case"loose_item_start":var l=[];while(e().type!=="list_item_end"){l.push(k())}return"<li>"+l.join(" ")+"</li>";case"html":return f.lexer(b.text);case"text":var l=[b.text],n;while((n=g[g.length-1])&&n.type==="text"){l.push(e().text)}return"<p>"+f.lexer(l.join(" "))+"</p>"}};var d=function(m){g=m.reverse();var l=[];while(e()){l.push(k())}g=null;b=null;return l.join(" ")};var j=function(l){return l.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")};var h=function(q){var n="",p,o=0,m=q.length;for(;o<m;o++){p=q.charCodeAt(o);if(Math.random()>0.5){p="x"+p.toString(16)}n+="&#"+p+";"}return n};var i=function(p,o){var n=0,m=p.length;for(;n<m;n++){o(p[n])}};var a=function(l){return d(c.lexer(l))};a.parser=d;a.lexer=c.lexer;if(typeof module!=="undefined"){module.exports=a}else{this.marked=a}}).call(this);