(function(){var c={newline:/^\n+/,block:/^ {4,}[^\n]*(?:\n {4,}[^\n]*|\n)*(?=\n| *$)/,hr:/^( *[\-*_]){3,} *\n/,heading:/^ *(#{1,6}) *([^\0]+?) *#* *\n+/,lheading:/^([^\n]+)\n *(=|-){3,}/,blockquote:/^ *>[^\n]*(?:\n *>[^\n]*)*/,list:/^( *)([*+-]|\d+\.) [^\0]+?(?:\n{2,}(?! )|\s*$)(?!\1\2|\1\d+\.)/,html:/^ *(?:<!--[^\0]*?-->|<(\w+)[^\0]+?<\/\1>|<\w+[^>]*>) *(?:\n{2,}|\s*$)/,text:/^[^\n]+/};c.keys=["newline","block","heading","lheading","hr","blockquote","list","html","text"];c.lexer=function(o){var n=[],m={};o=o.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ");o=o.replace(/^ {0,3}\[([^\]]+)\]: *([^ ]+)(?: +"([^\n]+)")? *$/gm,function(q,s,p,r){m[s]={href:p,title:r};return""});n.links=m;return c.token(o,n)};c.token=function(o,p){o=o.replace(/^ +$/gm,"");var r=c,t=c.keys,n=t.length,q,s,m;var u=function(){if(!o){return}for(var v=0;v<n;v++){q=t[v];if(s=r[q].exec(o)){o=o.substring(s[0].length);return true}}};while(u()){switch(q){case"newline":if(s[0].length>1){p.push({type:"space"})}break;case"hr":p.push({type:"hr"});break;case"lheading":p.push({type:"heading",depth:s[2]==="="?1:2,text:s[1]});break;case"heading":p.push({type:"heading",depth:s[1].length,text:s[2]});break;case"block":s=s[0].replace(/^ {4}/gm,"");p.push({type:"block",text:s});break;case"list":p.push({type:"list_start",ordered:isFinite(s[2])});m=/\n *\n *(?:[*+-]|\d+\.)/.test(s[0]);s=s[0].match(/^( *)([*+-]|\d+\.)[^\n]*(?:\n(?!\1(?:\2|\d+\.))[^\n]*)*/gm);i(s,function(v){v=v.replace(/^ *([*+-]|\d+\.) */,"");var w=/\n( +)/.exec(v);if(w){w=new RegExp("^"+w[1],"gm");v=v.replace(w,"")}p.push({type:m?"loose_item_start":"list_item_start"});c.token(v,p);p.push({type:"list_item_end"})});p.push({type:"list_end"});break;case"html":case"text":p.push({type:q,text:s[0]});break;case"blockquote":p.push({type:"blockquote_start"});s=s[0].replace(/^ *>/gm,"");c.token(s,p);p.push({type:"blockquote_end"});break}}return p};var f={escape:/^\\([\\`*{}\[\]()#+\-.!_])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,tag:/^<!--[^\0]*?-->|^<\/?\w+[^>]*>/,link:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]\s*\(([^\)]*)\)/,reflink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([^\0]+?)__(?!_)|^\*\*([^\0]+?)\*\*(?!\*)/,em:/^_([^_]+)_|^\*([^*]+)\*/,code:/^`([^`]+)`|^``([^\0]+?)``/,br:/^ {2,}\n(?!\s*$)/,text:/^/};f.keys=["escape","autolink","tag","link","reflink","nolink","strong","em","code","br","text"];f.text=(function(){var m=[];(function n(o){o=f[o].source;m.push(o.replace(/(^|[^\[])\^/g,"$1"));return n})("escape")("tag")("nolink")("strong")("em")("code")("br");return new RegExp("^[^\\0]+?(?="+m.join("|")+"|$)")})();f.lexer=function(p){var n="",v=g.links,q,t,m;var u=f,w=f.keys,o=w.length,r,s;var x=function(){if(!p){return}for(var y=0;y<o;y++){r=w[y];if(s=u[r].exec(p)){p=p.substring(s[0].length);return true}}};while(x()){switch(r){case"escape":n+=s[1];break;case"tag":n+=s[0];break;case"link":case"reflink":case"nolink":if(r!=="link"){q=(s[2]||s[1]).replace(/\s+/g," ");q=v[q];if(!q){n+=s[0][0];p=s[0].substring(1)+p;break}}else{t=/^\s*<?([^\s]*?)>?(?:\s+"([^\n]+)")?\s*$/.exec(s[2]);q={href:t[1],title:t[2]}}if(s[0][0]!=="!"){n+='<a href="'+j(q.href)+'"'+(q.title?' title="'+j(q.title)+'"':"")+">"+f.lexer(s[1])+"</a>"}else{n+='<img src="'+j(q.href)+'" alt="'+j(s[1])+'"'+(q.title?' title="'+j(q.title)+'"':"")+">"}break;case"autolink":if(s[2]==="@"){t=s[1][6]===":"?h(s[1].substring(7)):h(s[1]);m=h("mailto:")+t}else{t=j(s[1]);m=t}n+='<a href="'+m+'">'+t+"</a>";break;case"strong":n+="<strong>"+f.lexer(s[2]||s[1])+"</strong>";break;case"em":n+="<em>"+f.lexer(s[2]||s[1])+"</em>";break;case"code":n+="<code>"+j(s[2]||s[1])+"</code>";break;case"br":n+="<br>";break;case"text":n+=j(s[0]);break}}return n};var g,b;var e=function(){return b=g.pop()};var l=function(){switch(b.type){case"space":return"";case"hr":return"<hr>";case"heading":return"<h"+b.depth+">"+f.lexer(b.text)+"</h"+b.depth+">";case"block":return"<pre><code>"+j(b.text)+"</code></pre>";case"blockquote_start":var m=[];while(e().type!=="blockquote_end"){m.push(l())}return"<blockquote>"+m.join("")+"</blockquote>";case"list_start":var n=b.ordered?"ol":"ul",m=[];while(e().type!=="list_end"){m.push(l())}return"<"+n+">"+m.join("")+"</"+n+">";case"list_item_start":var m=[];while(e().type!=="list_item_end"){m.push(b.type==="text"?k():l())}return"<li>"+m.join(" ")+"</li>";case"loose_item_start":var m=[];while(e().type!=="list_item_end"){m.push(l())}return"<li>"+m.join(" ")+"</li>";case"html":return f.lexer(b.text);case"text":return"<p>"+k()+"</p>"}};var k=function(){var m=[b.text],n;while((n=g[g.length-1])&&n.type==="text"){m.push(e().text)}return f.lexer(m.join("\n"))};var d=function(n){g=n.reverse();var m=[];while(e()){m.push(l())}g=null;b=null;return m.join(" ")};var j=function(m){return m.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")};var h=function(q){var n="",p,o=0,m=q.length;for(;o<m;o++){p=q.charCodeAt(o);if(Math.random()>0.5){p="x"+p.toString(16)}n+="&#"+p+";"}return n};var i=function(p,o){var n=0,m=p.length;for(;n<m;n++){o(p[n])}};var a=function(m){return d(c.lexer(m))};a.parser=d;a.lexer=c.lexer;if(typeof module!=="undefined"){module.exports=a}else{this.marked=a}}).call(this);