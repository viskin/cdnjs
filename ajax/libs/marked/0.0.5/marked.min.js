(function(){var c={newline:/^\n+/,block:/^ {4,}[^\n]*(?:\n {4,}[^\n]*)*/,heading:/^ *(#{1,6}) *([^\n#]*) *#*/,lheading:/^([^\n]+)\n *(=|-){3,}/,hr:/^( ?[\-*_]){3,}/,blockquote:/^ *>[^\n]*(?:\n *>[^\n]*)*/,list:/^(?:( *)(\*|\+|-|\d+\.)[^\n]+(?:\n(?:\1 )+[^\n]+)*(?:\n+|$)){2,}/g,html:/^<([^\/\s>]+)[^\n>]*>[^\n]*(?:\n[^\n]+)*\n?<\/\1>/,text:/^[^\n]+/};c.keys=["newline","block","heading","lheading","hr","blockquote","list","html","text"];c.lexer=function(n){var m=[],l={};n=n.replace(/\r\n/g,"\n").replace(/\r/g,"\n").replace(/\t/g,"    ");n=n.replace(/^ {0,3}\[([^\]]+)\]: *([^ ]+)(?: +"([^"]+)")? *(?:\n|$)/gm,function(p,r,o,q){l[r]={href:o,title:q};return""});m.links=l;return c.token(n,m)};c.token=function(s,q){var r=c,p=c.keys,l=p.length,o,n;var m=function(){if(!s){return}for(var t=0;t<l;t++){o=p[t];if(n=r[o].exec(s)){s=s.substring(n[0].length);return true}}};while(m()){switch(o){case"newline":if(n[0].length>1){q.push({type:"space"})}break;case"hr":q.push({type:"hr"});break;case"lheading":q.push({type:"heading",depth:n[2]==="="?1:2,text:n[1]});break;case"heading":q.push({type:"heading",depth:n[1].length,text:n[2]});break;case"block":n=n[0].replace(/^ {4}/gm,"");q.push({type:"block",text:n});break;case"list":q.push({type:"list_start",ordered:isFinite(n[2])});n=n[0].match(/^( *)(\*|\+|-|\d+\.)[^\n]+(?:\n(?:\1 )+[^\n]+)*/gm);i(n,function(t){t=t.replace(/^ *(\*|\+|-|\d+\.) */,"");var u=/\n( +)/.exec(t);if(u){u=new RegExp("^"+u[1],"gm");t=t.replace(u,"")}q.push({type:"list_item_start"});c.token(t,q);q.push({type:"list_item_end"})});q.push({type:"list_end"});break;case"html":case"text":q.push({type:o,text:n[0]});break;case"blockquote":q.push({type:"blockquote_start"});n=n[0].replace(/^ *>/gm,"");c.token(n,q);q.push({type:"blockquote_end"});break}}return q};var f={escape:/^\\([\\`*{}\[\]()#+\-.!])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,tag:/^<[^\n>]+>/,link:/^!?\[([^\]]+)\]\(([^\)]+)\)/,reflink:/^!?\[([^\]]+)\]\[([^\]]+)\]/,strong:/^__([\s\S]+?)__|^\*\*([\s\S]+?)\*\*/,em:/^_([^_]+)_|^\*([^*]+)\*/,code:/^`([^`]+)`|^``([\s\S]+?)``/};f.keys=["escape","autolink","tag","link","reflink","strong","em","code"];f.text=(function(q){var p=q.keys,o=0,n=p.length,m=[];for(;o<n;o++){m.push(q[p[o]].source.replace(/(^|[^\[])\^/g,"$1"))}p.push("text");return new RegExp("^([\\s\\S]+?)(?="+m.join("|")+"|$)")})(f);f.lexer=function(o){var m="",u=g.links,p,s,l;var t=f,v=f.keys,n=v.length,q,r;var w=function(){if(!o){return}for(var x=0;x<n;x++){q=v[x];if(r=t[q].exec(o)){o=o.substring(r[0].length);return true}}};while(w()){switch(q){case"escape":m+=r[1];break;case"tag":m+=r[0];break;case"link":case"reflink":if(r[0][0]!=="!"){if(q==="reflink"){p=u[r[2]];if(!p){throw new Error("Undefined Reference: "+r[2])}}else{p={href:r[2],title:r[3]}}m+='<a href="'+j(p.href)+'"'+(p.title?' title="'+j(p.title)+'"':"")+">"+f.lexer(r[1])+"</a>"}else{if(q==="reflink"){p=u[r[2]];if(!p){throw new Error("Undefined Reference: "+r[2])}}else{s=/^([^\s]+)\s*(.+)?$/.exec(r[2]);p={href:s[1],title:s[2]}}m+='<img src="'+j(p.href)+'" alt="'+j(r[1])+'"'+(p.title?' title="'+j(p.title)+'"':"")+">"}break;case"autolink":if(r[2]==="@"){s=h(r[1]);l=h("mailto:")+s}else{s=j(r[1]);l=s}m+='<a href="'+l+'">'+s+"</a>";break;case"strong":m+="<strong>"+f.lexer(r[2]||r[1])+"</strong>";break;case"em":m+="<em>"+f.lexer(r[2]||r[1])+"</em>";break;case"code":m+="<code>"+j(r[2]||r[1])+"</code>";break;case"text":m+=j(r[1]);break;default:break}}return m};var g,b;var e=function(){return b=g.pop()};var k=function(){switch(b.type){case"space":return"";case"hr":return"<hr>";case"heading":return"<h"+b.depth+">"+f.lexer(b.text)+"</h"+b.depth+">";case"block":return"<pre><code>"+j(b.text)+"</code></pre>";case"blockquote_start":var l=[];while(e().type!=="blockquote_end"){l.push(k())}return"<blockquote>"+l.join("")+"</blockquote>";case"list_start":var l=[],m=b.ordered?"ol":"ul";while(e().type!=="list_end"){l.push(k())}return"<"+m+">"+l.join("")+"</"+m+">";case"list_item_start":var l=[];while(e().type!=="list_item_end"){l.push(b.type==="text"?f.lexer(b.text):k())}return"<li>"+l.join(" ")+"</li>";case"html":return f.lexer(b.text);case"text":var l=[b.text],n;while((n=g[g.length-1])&&n.type==="text"){l.push(e().text)}return"<p>"+f.lexer(l.join(" "))+"</p>"}};var d=function(m){g=m.reverse();var l=[];while(e()){l.push(k())}g=null;b=null;return l.join(" ")};var j=function(l){return l.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")};var h=function(q){var n="",p,o=0,m=q.length;for(;o<m;o++){p=q.charCodeAt(o);if(Math.random()>0.5){p="x"+p.toString(16)}n+="&#"+p+";"}return n};var i=function(p,o){var n=0,m=p.length;for(;n<m;n++){o(p[n])}};var a=function(l){return d(c.lexer(l))};a.parser=d;a.lexer=c.lexer;if(typeof module!=="undefined"){module.exports=a}else{this.marked=a}}).call(this);