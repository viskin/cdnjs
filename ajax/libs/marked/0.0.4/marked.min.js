(function(){var c={newline:/^\n/,block:/^ {4,}[^\n]*(?:\n {4,}[^\n]*)*/,heading:/^ *(#{1,6}) *([^\n#]*) *#*/,lheading:/^([^\n]+)\n *(=|-){3,}/,hr:/^( ?[\-*_]){3,}/,blockquote:/^ *>[^\n]*(?:\n *>[^\n]*)*/,list:/^(?:( *)(\*|\+|-|\d+\.)[^\n]+(?:\n(?:\1 )+[^\n]+)*(?:\n+|$)){2,}/g,html:/^<([^\/\s>]+)[^\n>]*>[^\n]*(?:\n[^\n]+)*\n?<\/\1>/,text:/^[^\n]+/};c.keys=["newline","block","heading","lheading","hr","blockquote","list","html","text"];c.lexer=function(n){var m=[],l={};n=n.replace(/\r\n/g,"\n").replace(/\r/g,"\n").replace(/\t/g,"    ");n=n.replace(/^ {0,3}\[([^\]]+)\]: *([^ ]+)(?: +"([^"]+)")? *(?:\n|$)/gm,function(p,r,o,q){l[r]={href:o,title:q};return""});m.links=l;return c.token(n,m,0)};c.token=function(m,n,t){var p=c,r=c.keys,l=r.length,o,q;var s=function(){if(!m){return}for(var u=0;u<l;u++){o=r[u];if(q=p[o].exec(m)){m=m.substring(q[0].length);return true}}};while(s()){switch(o){case"newline":t++;break;case"hr":n.push({type:"hr",line:t});break;case"lheading":n.push({type:"heading",depth:q[2]==="="?1:2,text:q[1],line:t});break;case"heading":n.push({type:"heading",depth:q[1].length,text:q[2],line:t});break;case"block":q=q[0].replace(/^ {4}/gm,"");n.push({type:"block",text:q,line:t});break;case"list":n.push({type:"list_start",ordered:isFinite(q[2]),line:t});q=q[0].match(/^( *)(\*|\+|-|\d+\.)[^\n]+(?:\n(?:\1 )+[^\n]+)*/gm);i(q,function(u){u=u.replace(/^ *(\*|\+|-|\d+\.) */,"");var v=/\n( +)/.exec(u);if(v){v=new RegExp("^"+v[1],"gm");u=u.replace(v,"")}n.push({type:"list_item_start",line:t});c.token(u,n,t);n.push({type:"list_item_end",line:t})});n.push({type:"list_end",line:t});break;case"html":case"text":n.push({type:o,text:q[0],line:t});break;case"blockquote":n.push({type:"blockquote_start",line:t});q=q[0].replace(/^ *>/gm,"");c.token(q,n,t);n.push({type:"blockquote_end",line:t});break}}return n};var f={escape:/^\\([\\`*{}\[\]()#+\-.!])/,autolink:/^<([^ >]+(:|@)[^ >]+)>/,tag:/^<[^\n>]+>/,link:/^!?\[([^\]]+)\]\(([^\)]+)\)/,reflink:/^!?\[([^\]]+)\]\[([^\]]+)\]/,strong:/^__([\s\S]+?)__|^\*\*([\s\S]+?)\*\*/,em:/^_([^_]+)_|^\*([^*]+)\*/,code:/^`([^`]+)`|^``([\s\S]+?)``/};f.keys=["escape","autolink","tag","link","reflink","strong","em","code"];f.text=(function(q){var p=q.keys,o=0,n=p.length,m=[];for(;o<n;o++){m.push(q[p[o]].source.replace(/(^|[^\[])\^/g,"$1"))}p.push("text");return new RegExp("^([\\s\\S]+?)(?="+m.join("|")+"|$)")})(f);f.lexer=function(o){var m="",u=g.links,p={},s,l;var t=f,v=f.keys,n=v.length,q,r;var w=function(){if(!o){return}for(var x=0;x<n;x++){q=v[x];if(r=t[q].exec(o)){o=o.substring(r[0].length);return true}}};while(w()){switch(q){case"escape":m+=r[1];break;case"tag":m+=r[0];break;case"link":case"reflink":if(r[0][0]!=="!"){if(q==="reflink"){p=u[r[2]]}else{p.href=r[2];p.title=r[3]}m+='<a href="'+j(p.href)+'"'+(p.title?' title="'+j(p.title)+'"':"")+">"+f.lexer(r[1])+"</a>"}else{if(q==="reflink"){p=u[r[2]]}else{s=/^([^\s]+)\s*(.+)?$/.exec(r[2]);p.href=s[1];p.title=s[2]}m+='<img src="'+j(p.href)+'" alt="'+j(r[1])+'"'+(p.title?' title="'+j(p.title)+'"':"")+">"}break;case"autolink":if(r[2]==="@"){s=h(r[1]);l=h("mailto:")+s}else{s=j(r[1]);l=s}m+='<a href="'+l+'">'+s+"</a>";break;case"strong":m+="<strong>"+f.lexer(r[2]||r[1])+"</strong>";break;case"em":m+="<em>"+f.lexer(r[2]||r[1])+"</em>";break;case"code":m+="<code>"+j(r[2]||r[1])+"</code>";break;case"text":m+=j(r[1]);break;default:break}}return m};var g,b;var e=function(){return b=g.pop()};var k=function(){switch(b.type){case"hr":return"<hr>";case"heading":return"<h"+b.depth+">"+f.lexer(b.text)+"</h"+b.depth+">";case"block":return"<pre><code>"+j(b.text)+"</code></pre>";case"blockquote_start":var l=[];while(e().type!=="blockquote_end"){l.push(k())}return"<blockquote>"+l.join("")+"</blockquote>";case"list_start":var l=[],m=b.ordered?"ol":"ul";while(e().type!=="list_end"){l.push(k())}return"<"+m+">"+l.join("")+"</"+m+">";case"list_item_start":var l=[];while(e().type!=="list_item_end"){l.push(b.type==="text"?f.lexer(b.text):k())}return"<li>"+l.join(" ")+"</li>";case"html":return f.lexer(b.text);case"text":var l=[b.text],n=b.line,o;while((o=g[g.length-1])&&o.type==="text"&&o.line===++n){l.push(e().text)}return"<p>"+f.lexer(l.join(" "))+"</p>"}};var d=function(m){g=m.reverse();var l=[];while(e()){l.push(k())}g=null;b=null;return l.join(" ")};var j=function(l){return l.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")};var h=function(q){var n="",p,o=0,m=q.length;for(;o<m;o++){p=q.charCodeAt(o);if(Math.random()>0.5){p="x"+p.toString(16)}n+="&#"+p+";"}return n};var i=function(p,o){var n=0,m=p.length;for(;n<m;n++){o(p[n])}};var a=function(l){return d(c.lexer(l))};a.parser=d;a.lexer=c.lexer;if(typeof module!=="undefined"){module.exports=a}else{this.marked=a}}).call(this);