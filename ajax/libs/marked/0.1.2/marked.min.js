(function(){var e={newline:/^\n+/,code:/^ {4,}[^\n]*(?:\n {4,}[^\n]*|\n)*(?=\n| *$)/,hr:/^( *[\-*_]){3,} *\n/,heading:/^ *(#{1,6}) *([^\0]+?) *#* *\n+/,lheading:/^([^\n]+)\n *(=|-){3,}/,blockquote:/^ *>[^\n]*(?:\n *>[^\n]*)*/,list:/^( *)([*+-]|\d+\.) [^\0]+?(?:\n{2,}(?! )|\s*$)(?!\1\2|\1\d+\.)/,html:/^ *(?:<!--[^\0]*?-->|<(\w+)[^\0]+?<\/\1>|<\w+[^>]*>) *(?:\n{2,}|\s*$)/,text:/^[^\n]+/};e.lexer=function(o){var n=[],m={};o=o.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ");o=o.replace(/^ {0,3}\[([^\]]+)\]: *([^ ]+)(?: +"([^\n]+)")? *$/gm,function(q,s,p,r){m[s]={href:p,title:r};return""});n.links=m;return e.token(o,n)};e.token=function(s,r){var s=s.replace(/^ +$/gm,""),t,o,p,q,n,m;while(s){if(o=e.newline.exec(s)){s=s.substring(o[0].length);if(o[0].length>1){r.push({type:"space"})}continue}if(o=e.code.exec(s)){s=s.substring(o[0].length);o=o[0].replace(/^ {4}/gm,"");r.push({type:"code",text:o});continue}if(o=e.heading.exec(s)){s=s.substring(o[0].length);r.push({type:"heading",depth:o[1].length,text:o[2]});continue}if(o=e.lheading.exec(s)){s=s.substring(o[0].length);r.push({type:"heading",depth:o[2]==="="?1:2,text:o[1]});continue}if(o=e.hr.exec(s)){s=s.substring(o[0].length);r.push({type:"hr"});continue}if(o=e.blockquote.exec(s)){s=s.substring(o[0].length);r.push({type:"blockquote_start"});o=o[0].replace(/^ *>/gm,"");e.token(o,r);r.push({type:"blockquote_end"});continue}if(o=e.list.exec(s)){s=s.substring(o[0].length);r.push({type:"list_start",ordered:isFinite(o[2])});t=/\n *\n *(?:[*+-]|\d+\.)/.test(o[0]);o=o[0].match(/^( *)([*+-]|\d+\.)[^\n]*(?:\n(?!\1(?:\2|\d+\.))[^\n]*)*/gm);n=0,m=o.length;for(;n<m;n++){p=o[n].replace(/^ *([*+-]|\d+\.) */,"");q=/\n( +)/.exec(p);if(q){q=new RegExp("^"+q[1],"gm");p=p.replace(q,"")}r.push({type:t?"loose_item_start":"list_item_start"});e.token(p,r);r.push({type:"list_item_end"})}r.push({type:"list_end"});continue}if(o=e.html.exec(s)){s=s.substring(o[0].length);r.push({type:"html",text:o[0]});continue}if(o=e.text.exec(s)){s=s.substring(o[0].length);r.push({type:"text",text:o[0]});continue}}return r};var g={escape:/^\\([\\`*{}\[\]()#+\-.!_])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,tag:/^<!--[^\0]*?-->|^<\/?\w+[^>]*>/,link:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]\s*\(([^\)]*)\)/,reflink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([^\0]+?)__(?!_)|^\*\*([^\0]+?)\*\*(?!\*)/,em:/^_([^_]+)_|^\*([^*]+)\*/,code:/^`([^`]+)`|^``([^\0]+?)``/,br:/^ {2,}\n(?!\s*$)/,text:/^/};g.text=(function(){var m=[];(function n(o){o=g[o].source;m.push(o.replace(/(^|[^\[])\^/g,"$1"));return n})("escape")("tag")("nolink")("strong")("em")("code")("br");return new RegExp("^[^\\0]+?(?="+m.join("|")+"|$)")})();g.lexer=function(s){var o="",n=h.links,q,r,m,p;while(s){if(p=g.escape.exec(s)){s=s.substring(p[0].length);o+=p[1];continue}if(p=g.autolink.exec(s)){s=s.substring(p[0].length);if(p[2]==="@"){r=p[1][6]===":"?i(p[1].substring(7)):i(p[1]);m=i("mailto:")+r}else{r=j(p[1]);m=r}o+='<a href="'+m+'">'+r+"</a>";continue}if(p=g.tag.exec(s)){s=s.substring(p[0].length);o+=p[0];continue}if(p=g.link.exec(s)){s=s.substring(p[0].length);r=/^\s*<?([^\s]*?)>?(?:\s+"([^\n]+)")?\s*$/.exec(p[2]);q={href:r[1],title:r[2]};o+=b(p,q);continue}if((p=g.reflink.exec(s))||(p=g.nolink.exec(s))){s=s.substring(p[0].length);q=(p[2]||p[1]).replace(/\s+/g," ");q=n[q];if(!q){o+=p[0][0];s=p[0].substring(1)+s;continue}o+=b(p,q);continue}if(p=g.strong.exec(s)){s=s.substring(p[0].length);o+="<strong>"+g.lexer(p[2]||p[1])+"</strong>";continue}if(p=g.em.exec(s)){s=s.substring(p[0].length);o+="<em>"+g.lexer(p[2]||p[1])+"</em>";continue}if(p=g.code.exec(s)){s=s.substring(p[0].length);o+="<code>"+j(p[2]||p[1])+"</code>";continue}if(p=g.br.exec(s)){s=s.substring(p[0].length);o+="<br>";continue}if(p=g.text.exec(s)){s=s.substring(p[0].length);o+=j(p[0]);continue}}return o};var b=function(m,n){if(m[0][0]!=="!"){return'<a href="'+j(n.href)+'"'+(n.title?' title="'+j(n.title)+'"':"")+">"+g.lexer(m[1])+"</a>"}else{return'<img src="'+j(n.href)+'" alt="'+j(m[1])+'"'+(n.title?' title="'+j(n.title)+'"':"")+">"}};var h,c;var f=function(){return c=h.pop()};var l=function(){switch(c.type){case"space":return"";case"hr":return"<hr>";case"heading":return"<h"+c.depth+">"+g.lexer(c.text)+"</h"+c.depth+">";case"code":return"<pre><code>"+j(c.text)+"</code></pre>";case"blockquote_start":var m=[];while(f().type!=="blockquote_end"){m.push(l())}return"<blockquote>"+m.join("")+"</blockquote>";case"list_start":var n=c.ordered?"ol":"ul",m=[];while(f().type!=="list_end"){m.push(l())}return"<"+n+">"+m.join("")+"</"+n+">";case"list_item_start":var m=[];while(f().type!=="list_item_end"){m.push(c.type==="text"?k():l())}return"<li>"+m.join(" ")+"</li>";case"loose_item_start":var m=[];while(f().type!=="list_item_end"){m.push(l())}return"<li>"+m.join(" ")+"</li>";case"html":return g.lexer(c.text);case"text":return"<p>"+k()+"</p>"}};var k=function(){var m=[c.text],n;while((n=h[h.length-1])&&n.type==="text"){m.push(f().text)}return g.lexer(m.join("\n"))};var d=function(n){h=n.reverse();var m=[];while(f()){m.push(l())}h=null;c=null;return m.join(" ")};var j=function(m){return m.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")};var i=function(q){var n="",p,o=0,m=q.length;for(;o<m;o++){p=q.charCodeAt(o);if(Math.random()>0.5){p="x"+p.toString(16)}n+="&#"+p+";"}return n};var a=function(m){return d(e.lexer(m))};a.parser=d;a.lexer=e.lexer;if(typeof module!=="undefined"){module.exports=a}else{this.marked=a}}).call(this);