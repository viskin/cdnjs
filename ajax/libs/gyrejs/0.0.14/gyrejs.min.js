!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("Immutable")):"function"==typeof define&&define.amd?define(["Immutable"],e):"object"==typeof exports?exports.GyreJS=e(require("Immutable")):t.GyreJS=e(t.Immutable)}(this,function(t){return function(t){function e(r){if(n[r])return n[r].exports;var u=n[r]={exports:{},id:r,loaded:!1};return t[r].call(u.exports,u,u.exports,e),u.loaded=!0,u.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var u=n(15),a=r(u),s=n(5),i=r(s),o=n(9),c=r(o),f=n(13),d=r(f),l=n(14),p=r(l),h={dispatchLogger:d.default,injectDispatch:p.default},g=new Map,m=a.default(),v=function(t,e){return g.has(t)||console.warn(">> GyreJS: Gyre factory '"+t+"' not registered."),g.get(t)(m,Object.assign({},{NS:t+"-"+Date.now()},e))},_=function(t,e){g.set(t,e)};_("local",i.default),_("smartRest",c.default),e.createGyre=v,e.middleWare=h,e.registerGyreFactory=_},function(e,n){e.exports=t},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var u=n(4),a=r(u),s=function(t,e){var n=arguments.length<=2||void 0===arguments[2]?function(){}:arguments[2],r=arguments.length<=3||void 0===arguments[3]?{}:arguments[3];return function(u,s){var i=a.default(u,s),o=function(e,n){return t(u,i.dispatch,e,n,s)},c=function(t){return u.setState(t,s.NS)},f=function(){return u.getState.get(s.NS)},d=e(o);return i.addActions(n(s)),c(r),{addAction:i.addAction,addActions:i.addActions,dispatch:i.dispatch,getState:f,getReducer:o,reactHoC:d,setState:c,use:i.use}}};e.default=s,t.exports=e.default},function(t,e){"use strict";e.__esModule=!0;var n=function(t){function e(t,r,u){var a,s,i,o,c,f,d,l,p,h,g,m,v;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:a=Object.keys(t),s=Array.isArray(a),i=0,a=s?a:a[Symbol.iterator]();case 1:if(!s){n.next=7;break}if(!(i>=a.length)){n.next=4;break}return n.abrupt("break",36);case 4:o=a[i++],n.next=11;break;case 7:if(i=a.next(),!i.done){n.next=10;break}return n.abrupt("break",36);case 10:o=i.value;case 11:if(c=o,f=t[c],d=u?u.concat([c]):[c],l={name:r?r+"/"+c:c,branch:d,id:f.id?f.id:null,fields:f.fields?f.fields:null},!(l.fields||l.id&&!f.children)){n.next=18;break}return n.next=18,l;case 18:if(!f.children){n.next=34;break}p=Array.isArray(f.id)?f.id:[f.id],h=Array.isArray(p),g=0,p=h?p:p[Symbol.iterator]();case 20:if(!h){n.next=26;break}if(!(g>=p.length)){n.next=23;break}return n.abrupt("break",34);case 23:m=p[g++],n.next=30;break;case 26:if(g=p.next(),!g.done){n.next=29;break}return n.abrupt("break",34);case 29:m=g.value;case 30:return v=m,n.delegateYield(e(f.children,v?c+"/"+v:c,d),"t0",32);case 32:n.next=20;break;case 34:n.next=1;break;case 36:case"end":return n.stop()}},n[0],this)}for(var n=[e].map(regeneratorRuntime.mark),r=e(t),u=r.next(),a=[];!u.done;)a.push(u.value),u=r.next();return a},r=function(t){var e=n(t);return e.map(function(t){var e=t.name;return t.hasOwnProperty("id")&&null!==t.id&&(e=e+"/"+t.id),Array.isArray(t.fields)&&t.fields.length>0&&(e=e+"?fields="+t.fields.toString()),{path:e,type:t.branch[t.branch.length-1],root:t.name}})},u=function(t){return t.status>=200&&t.status<300?t.json().then(function(t){return{success:!0,data:t}}):new Promise(function(e){return e({success:!1,msg:t,code:t.status})})},a=function(t){return function(e){if(e.success){var n=function(){var n=Array.isArray(e.data)?e.data:[e.data],r={},u={};return r[t.get("root")]=[],u[t.get("type")]={},n.forEach(function(e){r[t.get("root")].push(e.id.toString()),u[t.get("type")][e.id.toString()]=e}),{v:{success:!0,data:u,idList:r}}}();if("object"==typeof n)return n.v}return e}},s=function(t,e){var n=t||location.protocol+"//"+location.hostname+(location.port?":"+location.port:"");return fetch(n+"/"+e.get("path")).then(u).then(a(e))},i=function(t){var e=t.length,n=0;if(0===t.length)return n;for(var r=0;e>r;r++){var u=t.charCodeAt(r);n=(n<<5)-n+u,n|=0}return n},o=function(t){return i(JSON.stringify(t))},c={createUrls:r,fetchUrl:s,hashQueryObject:o};e.default=c,t.exports=e.default},function(t,e){"use strict";e.__esModule=!0;var n=function(t,e){var n=new Map,r=[],u=function o(t){for(var u=arguments.length,a=Array(u>1?u-1:0),s=1;u>s;s++)a[s-1]=arguments[s];n.has(t)?r.reduce(function(n,r){return function(){return r(e.NS,t,a,n,o)}},function(){return n.get(t)(a)})():console.warn(">> GyreJS-'"+e.NS+"'-gyre: Unregistered action dispatched: '"+t+"' with arguments:",a,". (This is a no-op)")},a=function(r,u){return n.set(r,function(n){t.updateState(e.NS,u,n)})},s=function(t){Object.keys(t).forEach(function(e){a(e,t[e])})},i=function(t){r.unshift(t)};return{addAction:a,addActions:s,dispatch:u,use:i}};e.default=n,t.exports=e.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var u=n(2),a=r(u),s=n(7),i=r(s),o=n(6),c=r(o);e.default=a.default(i.default,c.default),t.exports=e.default},function(t,e){"use strict";e.__esModule=!0;var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},r=function(t){return function(e,r){return React.createClass({displayName:"GyreJS-localHoC",getInitialState:function(){return{data:null}},componentWillMount:function(){this.unRegisterReducer=t(e,this.handleNewData)},shouldComponentUpdate:function(t){return this.state.data!==t.data},componentWillUnmount:function(){this.unRegisterReducer()},handleNewData:function(t){this.setState({data:t})},render:function(){return"undefined"!=typeof this.state.data?React.createElement(r,n({},this.props,this.state.data)):!1}})}};e.default=r,t.exports=e.default},function(t,e){"use strict";e.__esModule=!0;var n=function(t,e,n,r,u){var a=function(t){var e=t.get(u.NS),a=Array.isArray(n)?n:[n];r(e?a.reduce(function(t,n){return t[n]=e.get(n),t},{}):void 0)};return t.addReducer(a)};e.default=n,t.exports=e.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var u=n(3),a=n(1),s=r(a),i=s.default.Map,o=s.default.List,c="COMPLETED",f="LOADING",d="UPDATING",l="ERROR",p={},h="ADD_QUERY",g="FETCH_QUERY",m="COMPLETE_QUERY",v="FAIL_QUERY",_="CREATE",y=i({status:null,count:0});e.default=function(t){var e=t.hostname;return p[h]=function(t,e,n,r){return t.reduce(function(t,a,s){return"queries"===s&&(t=t.set("queries",a.set(n,y.merge(a.get(n)).merge({hash:n,urls:u.createUrls(e)}).map(function(t,e){switch(e){case"count":return t+1;case"status":return t===c?d:t;default:return t}})).map(function(t,e){return e===n&&-1===[f,d].indexOf(t.get("status"))&&r(g,t),t.set("status",t.get("status")||f)}))),t},t)},p[g]=function(t,n,r){var a=n.get("urls").map(function(t){return u.fetchUrl(e,t)});Promise.all(a).then(function(t){var e=t.reduce(function(t,e){var n=e.success,r=e.msg;return n||(t.success=!1,t.msgList=t.msgList.push(r)),t},{success:!0,msgList:o([])});e.success?r(m,t,n):r(v,e.msgList,n)}).catch(function(t){r(v,[t],n)})},p[m]=function(t,e,n){return t.reduce(function(t,r,u){return"queries"===u&&(t=t.set("queries",r.map(function(t,r){var u=t;return r===n.get("hash")&&(u=u.merge({status:c,idList:e.reduce(function(t,e){return t.merge(e.idList)},i({}))})),u}))),"data"===u&&(t=t.set("data",e.reduce(function(t,e){return t.mergeDeep(e.data)},t.get("data")))),t},t)},p[v]=function(t,e,n){return t.reduce(function(t,r,u){return"queries"===u&&(t=t.set("queries",r.map(function(t,r){var u=t;return r===n.get("hash")&&(u=u.merge({status:l,msg:e})),u}))),t},t)},p[_]=function(t,e,n){return t.reduce(function(t,r,u){if("data"===u){var a=Date.now();t=t.setIn(["data",e,a],s.default.fromJS(n))}return t},t)},p},t.exports=e.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var u=n(2),a=r(u),s=n(11),i=r(s),o=n(10),c=r(o),f=n(8),d=r(f),l=n(12),p=r(l);e.default=a.default(i.default,c.default,d.default,p.default),t.exports=e.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},a=n(1),s=r(a),i=function(t){return function(e,n,r,a){return React.createClass({displayName:"GyreJS-localHoC",getInitialState:function(){return{data:null}},componentWillMount:function(){this.unRegisterReducer=t(e,this.handleNewData)},shouldComponentUpdate:function(t,e){return this.state.status!==e.status?!0:e.data?!s.default.is(e.data,this.state.data):!0},componentWillUnmount:function(){this.unRegisterReducer()},handleNewData:function(t,e){this.setState({data:e,status:t})},render:function(){if(!this.state||!this.state.status)return!1;var t=void 0;switch(this.state.status){case"LOADING":t=r;break;case"ERROR":t=a;break;default:t=n}return t?React.createElement(t,u({},this.props,this.state)):!1}})}};e.default=i,t.exports=e.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var u=n(1),a=r(u),s=n(3),i=a.default.Map,o=function(t,e,n,r,u){var a=u.NS,o=s.hashQueryObject(n),c=function(t){var e=t.getIn([a,"queries",o,"idList"]),n=t.getIn([a,"queries",o]);e?r(n.get("status"),e.reduce(function(e,n,r){var u=e,s=r.split("/").reduce(function(t,e,n){return n%2===0&&n&&t.push("children"),t.push(e),t},[]),i=r.split("/");return i=i[i.length-1],n.forEach(function(e){u=u.mergeDeepIn(s.concat(e),t.getIn([a,"data",i,e]))}),u},i({}))):r(n.get("status"))};return e("ADD_QUERY",n,o),t.addReducer(c)};e.default=o,t.exports=e.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var u=n(1),a=r(u),s=a.default.Map;e.default=s({queries:s({}),data:s({})}),t.exports=e.default},function(t,e){"use strict";e.__esModule=!0;var n=function(t,e,n,r){console.log(">> GyreJS-'"+t+"'-gyre: Applying action '"+e+"' with arguments: ",n),r()};e.default=n,t.exports=e.default},function(t,e){"use strict";e.__esModule=!0;var n=function(t,e,n,r,u){n.push(u),r()};e.default=n,t.exports=e.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var u=n(1),a=r(u),s=a.default.Map,i=function(){var t=s({}),e=[],n=function(){return e.forEach(function(e){return e(t)})},r=function(t){return function(){return e=e.filter(function(e){return e!==t})}},u=function(e,r){return t.get(r)!==e&&(t=t.set(r,e),n()),t},a=function(n){return e.push(n),n(t),r(n)},i=function(){return t},o=function(t,e){return u(s.isMap(t)?t:s(t),e)},c=function(e,n,r){return u(n.apply(void 0,[t.get(e)].concat(r))||t.get(e),e),t};return{addReducer:a,getState:i,setState:o,updateState:c}};e.default=i,t.exports=e.default}])});