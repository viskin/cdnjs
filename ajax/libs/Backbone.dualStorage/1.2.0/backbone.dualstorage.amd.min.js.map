{"version":3,"sources":["./1.2.0/backbone.dualstorage.amd.js"],"names":["root","factory","define","amd","Backbone","DualStorage","require","module","exports","this","S4","backboneSync","callbackTranslator","dualsync","getStoreName","localsync","modelUpdatedWithResponse","onlineSync","parseRemoteResponse","result","Model","prototype","hasTempId","_","isString","id","length","collection","model","Collection","syncDirty","ids","store","_i","_len","_ref","_results","localStorage","getItem","split","push","get","save","dirtyModels","models","call","compact","syncDestroyed","destroy","destroyedModelIds","syncDirtyAndDestroyed","Math","random","toString","substring","window","Store","name","records","recordsOn","sep","generateId","setItem","join","key","dirty","dirtyRecords","include","clean","from","without","destroyed","destroyedRecords","create","isObject","set","idAttribute","JSON","stringify","update","clear","removeItem","hasDirtyOrDestroyed","isEmpty","find","modelAsJson","parse","findAll","reject","record_id","needsTranslation","VERSION","forBackboneCaller","callback","resp","options","forDualstorageCaller","method","isValidModel","preExisting","response","Error","storeName","add","merge","attributes","ignoreCallbacks","success","error","object","property","value","isFunction","parseBeforeLocalSave","modelClone","sync","local","temporaryId","remote","status","xhr","modelAttributes","responseModel","isArray","updatedModel","silent"],"mappings":"CAAA,SAAUA,EAAMC,GACd,MAAsB,kBAAXC,SAAyBA,OAAOC,IAClCD,QAAQ,YAAa,SAASE,GACnC,MAAOJ,GAAKI,SAASC,YAAcJ,EAAQG,KAEjB,kBAAZE,UAA2G,OAA7D,mBAAXC,SAAqC,OAAXA,OAAkBA,OAAOC,QAAU,QACzGD,OAAOC,QAAUP,EAAQK,QAAQ,aAEjCN,EAAKI,SAASC,YAAcJ,EAAQD,EAAKI,WAEjDK,KAAM,SAASL,GAUlB,GAAIM,GAAIC,EAAcC,EAAoBC,EAAUC,EAAcC,EAAWC,EAA0BC,EAAYC,EAAqBC,CAExIf,GAASgB,MAAMC,UAAUC,UAAY,WACnC,MAAOC,GAAEC,SAASf,KAAKgB,KAA0B,KAAnBhB,KAAKgB,GAAGC,QAGxCZ,EAAe,SAASa,EAAYC,GAElC,MADAA,KAAUA,EAAQD,EAAWC,MAAMP,WAC5BF,EAAOQ,EAAY,cAAgBR,EAAOS,EAAO,cAAgBT,EAAOQ,EAAY,QAAUR,EAAOS,EAAO,YAAcT,EAAOS,EAAO,QAGjJxB,EAASyB,WAAWR,UAAUS,UAAY,WACxC,GAAIL,GAAIM,EAAKC,EAAOC,EAAIC,EAAMC,EAAMC,CAIpC,KAHAJ,EAAQK,aAAaC,QAAQ,GAAMxB,EAAaL,MAAS,UACzDsB,EAAOC,GAASA,EAAMO,MAAM,SAC5BH,KACKH,EAAK,EAAGC,EAAOH,EAAIL,OAAaQ,EAALD,EAAWA,IACzCR,EAAKM,EAAIE,GACTG,EAASI,KAA8B,OAAxBL,EAAO1B,KAAKgC,IAAIhB,IAAeU,EAAKO,OAAS,OAE9D,OAAON,IAGThC,EAASyB,WAAWR,UAAUsB,YAAc,WAC1C,GAAIlB,GAAIM,EAAKa,EAAQZ,CAYrB,OAXAA,GAAQK,aAAaC,QAAQ,GAAMxB,EAAaL,MAAS,UACzDsB,EAAOC,GAASA,EAAMO,MAAM,SAC5BK,EAAS,WACP,GAAIX,GAAIC,EAAME,CAEd,KADAA,KACKH,EAAK,EAAGC,EAAOH,EAAIL,OAAaQ,EAALD,EAAWA,IACzCR,EAAKM,EAAIE,GACTG,EAASI,KAAK/B,KAAKgC,IAAIhB,GAEzB,OAAOW,IACNS,KAAKpC,MACDc,EAAEqB,GAAQE,WAGnB1C,EAASyB,WAAWR,UAAU0B,cAAgB,WAC5C,GAAItB,GAAIM,EAAKH,EAAOI,EAAOC,EAAIC,EAAME,CAIrC,KAHAJ,EAAQK,aAAaC,QAAQ,GAAMxB,EAAaL,MAAS,cACzDsB,EAAOC,GAASA,EAAMO,MAAM,SAC5BH,KACKH,EAAK,EAAGC,EAAOH,EAAIL,OAAaQ,EAALD,EAAWA,IACzCR,EAAKM,EAAIE,GACTL,EAAQ,GAAInB,MAAKmB,OACfH,GAAIA,IAENG,EAAMD,WAAalB,KACnB2B,EAASI,KAAKZ,EAAMoB,UAEtB,OAAOZ,IAGThC,EAASyB,WAAWR,UAAU4B,kBAAoB,WAChD,GAAIlB,GAAKC,CAET,OADAA,GAAQK,aAAaC,QAAQ,GAAMxB,EAAaL,MAAS,cAClDsB,EAAOC,GAASA,EAAMO,MAAM,UAGrCnC,EAASyB,WAAWR,UAAU6B,sBAAwB,WAEpD,MADAzC,MAAKqB,YACErB,KAAKsC,iBAGdrC,EAAK,WACH,OAA+B,OAArB,EAAIyC,KAAKC,UAAuB,GAAGC,SAAS,IAAIC,UAAU,IAGtEC,OAAOC,MAAQ,WAGb,QAASA,GAAMC,GACbhD,KAAKgD,KAAOA,EACZhD,KAAKiD,QAAUjD,KAAKkD,UAAUlD,KAAKgD,MAkHrC,MAtHAD,GAAMnC,UAAUuC,IAAM,GAOtBJ,EAAMnC,UAAUwC,WAAa,WAC3B,MAAOnD,KAAOA,IAAO,IAAMA,IAAO,IAAMA,IAAO,IAAMA,IAAO,IAAMA,IAAOA,IAAOA,KAGlF8C,EAAMnC,UAAUqB,KAAO,WACrB,MAAOL,cAAayB,QAAQrD,KAAKgD,KAAMhD,KAAKiD,QAAQK,KAAK,OAG3DP,EAAMnC,UAAUsC,UAAY,SAASK,GACnC,GAAIhC,EAEJ,OADAA,GAAQK,aAAaC,QAAQ0B,GACrBhC,GAASA,EAAMO,MAAM,UAG/BiB,EAAMnC,UAAU4C,MAAQ,SAASrC,GAC/B,GAAIsC,EAMJ,OALAA,GAAezD,KAAKkD,UAAUlD,KAAKgD,KAAO,UACrClC,EAAE4C,QAAQD,EAActC,EAAMH,GAAG4B,cACpCa,EAAa1B,KAAKZ,EAAMH,IACxBY,aAAayB,QAAQrD,KAAKgD,KAAO,SAAUS,EAAaH,KAAK,OAExDnC,GAGT4B,EAAMnC,UAAU+C,MAAQ,SAASxC,EAAOyC,GACtC,GAAIH,GAAclC,CAMlB,OALAA,GAAQ,GAAKvB,KAAKgD,KAAO,IAAMY,EAC/BH,EAAezD,KAAKkD,UAAU3B,GAC1BT,EAAE4C,QAAQD,EAActC,EAAMH,GAAG4B,aACnChB,aAAayB,QAAQ9B,EAAOT,EAAE+C,QAAQJ,EAActC,EAAMH,GAAG4B,YAAYU,KAAK,MAEzEnC,GAGT4B,EAAMnC,UAAUkD,UAAY,SAAS3C,GACnC,GAAI4C,EAMJ,OALAA,GAAmB/D,KAAKkD,UAAUlD,KAAKgD,KAAO,cACzClC,EAAE4C,QAAQK,EAAkB5C,EAAMH,GAAG4B,cACxCmB,EAAiBhC,KAAKZ,EAAMH,IAC5BY,aAAayB,QAAQrD,KAAKgD,KAAO,aAAce,EAAiBT,KAAK,OAEhEnC,GAGT4B,EAAMnC,UAAUoD,OAAS,SAAS7C,GAChC,MAAKL,GAAEmD,SAAS9C,IAGXA,EAAMH,KACTG,EAAMH,GAAKhB,KAAKoD,aAChBjC,EAAM+C,IAAI/C,EAAMgD,YAAahD,EAAMH,KAErCY,aAAayB,QAAQrD,KAAKgD,KAAOhD,KAAKmD,IAAMhC,EAAMH,GAAIoD,KAAKC,UAAUlD,IACrEnB,KAAKiD,QAAQlB,KAAKZ,EAAMH,GAAG4B,YAC3B5C,KAAKiC,OACEd,GATEA,GAYX4B,EAAMnC,UAAU0D,OAAS,SAASnD,GAMhC,MALAS,cAAayB,QAAQrD,KAAKgD,KAAOhD,KAAKmD,IAAMhC,EAAMH,GAAIoD,KAAKC,UAAUlD,IAChEL,EAAE4C,QAAQ1D,KAAKiD,QAAS9B,EAAMH,GAAG4B,aACpC5C,KAAKiD,QAAQlB,KAAKZ,EAAMH,GAAG4B,YAE7B5C,KAAKiC,OACEd,GAGT4B,EAAMnC,UAAU2D,MAAQ,WACtB,GAAIvD,GAAIQ,EAAIC,EAAMC,CAElB,KADAA,EAAO1B,KAAKiD,QACPzB,EAAK,EAAGC,EAAOC,EAAKT,OAAaQ,EAALD,EAAWA,IAC1CR,EAAKU,EAAKF,GACVI,aAAa4C,WAAWxE,KAAKgD,KAAOhD,KAAKmD,IAAMnC,EAGjD,OADAhB,MAAKiD,WACEjD,KAAKiC,QAGdc,EAAMnC,UAAU6D,oBAAsB,WACpC,OAAQ3D,EAAE4D,QAAQ9C,aAAaC,QAAQ7B,KAAKgD,KAAO,aAAelC,EAAE4D,QAAQ9C,aAAaC,QAAQ7B,KAAKgD,KAAO,gBAG/GD,EAAMnC,UAAU+D,KAAO,SAASxD,GAC9B,GAAIyD,EAEJ,OADAA,GAAchD,aAAaC,QAAQ7B,KAAKgD,KAAOhD,KAAKmD,IAAMhC,EAAMH,IAC5C,OAAhB4D,EACK,KAEFR,KAAKS,MAAMD,IAGpB7B,EAAMnC,UAAUkE,QAAU,WACxB,GAAI9D,GAAIQ,EAAIC,EAAMC,EAAMC,CAGxB,KAFAD,EAAO1B,KAAKiD,QACZtB,KACKH,EAAK,EAAGC,EAAOC,EAAKT,OAAaQ,EAALD,EAAWA,IAC1CR,EAAKU,EAAKF,GACVG,EAASI,KAAKqC,KAAKS,MAAMjD,aAAaC,QAAQ7B,KAAKgD,KAAOhD,KAAKmD,IAAMnC,IAEvE,OAAOW,IAGToB,EAAMnC,UAAU2B,QAAU,SAASpB,GAMjC,MALAS,cAAa4C,WAAWxE,KAAKgD,KAAOhD,KAAKmD,IAAMhC,EAAMH,IACrDhB,KAAKiD,QAAUnC,EAAEiE,OAAO/E,KAAKiD,QAAS,SAAS+B,GAC7C,MAAOA,KAAc7D,EAAMH,GAAG4B,aAEhC5C,KAAKiC,OACEd,GAGF4B,KAIT5C,GACE8E,iBAAuC,WAArBtF,EAASuF,QAC3BC,kBAAmB,SAASC,GAC1B,MAAIpF,MAAKiF,iBACA,SAAS9D,EAAOkE,EAAMC,GAC3B,MAAOF,GAAShD,KAAK,KAAMiD,IAGtBD,GAGXG,qBAAsB,SAASH,EAAUjE,EAAOmE,GAC9C,MAAItF,MAAKiF,iBACA,SAASI,GACd,MAAOD,GAAShD,KAAK,KAAMjB,EAAOkE,EAAMC,IAGnCF,IAKb9E,EAAY,SAASkF,EAAQrE,EAAOmE,GAClC,GAAIG,GAAcC,EAAaC,EAAUpE,CAIzC,IAHAkE,EAA2B,UAAXD,GAAmC,wBAAXA,EACxCC,IAAiBA,EAAetE,YAAiBxB,GAASgB,OAC1D8E,IAAiBA,EAAetE,YAAiBxB,GAASyB,aACrDqE,EACH,KAAM,IAAIG,OAAM,oEA0DlB,OAxDArE,GAAQ,GAAIwB,OAAMuC,EAAQO,WAC1BF,EAAW,WACT,OAAQH,GACN,IAAK,OACH,MAAIrE,GAAMH,GACDO,EAAMoD,KAAKxD,GAEXI,EAAMuD,SAGjB,KAAK,sBACH,MAAOvD,GAAMkD,qBACf,KAAK,QACH,MAAOlD,GAAMgD,OACf,KAAK,SACH,MAAMe,GAAQQ,MAAQR,EAAQS,QAAUL,EAAcnE,EAAMoD,KAAKxD,IAOxDuE,GANPvE,EAAQI,EAAMyC,OAAO7C,GACjBmE,EAAQ9B,OACVjC,EAAMiC,MAAMrC,GAEPA,EAKX,KAAK,SAEH,MADAI,GAAM+C,OAAOnD,GACTmE,EAAQ9B,MACHjC,EAAMiC,MAAMrC,GAEZI,EAAMoC,MAAMxC,EAAO,QAG9B,KAAK,SAEH,MADAI,GAAMgB,QAAQpB,GACVmE,EAAQ9B,MACHjC,EAAMuC,UAAU3C,GAEY,KAA/BA,EAAMH,GAAG4B,WAAW3B,OACfM,EAAMoC,MAAMxC,EAAO,SAEnBI,EAAMoC,MAAMxC,EAAO,kBAKpB,MAAZwE,EAAmBA,EAASK,WAAa,UAC3CL,EAAWA,EAASK,YAEjBV,EAAQW,kBACPN,EACFL,EAAQY,QAAQP,GAEhBL,EAAQa,MAAM,qBAGXR,GAGTjF,EAAS,SAAS0F,EAAQC,GACxB,GAAIC,EACJ,OAAKF,IAGLE,EAAQF,EAAOC,GACXvF,EAAEyF,WAAWD,GACRA,EAAMlE,KAAKgE,GAEXE,GANA,MAUX7F,EAAsB,SAAS2F,EAAQT,GACrC,MAAMS,IAAUA,EAAOI,qBAGnB1F,EAAEyF,WAAWH,EAAOI,sBACfJ,EAAOI,qBAAqBb,GADrC,OAFSA,GAOXpF,EAA2B,SAASY,EAAOwE,GACzC,GAAIc,EAKJ,OAJAA,GAAa,GAAI9G,GAASgB,MAC1B8F,EAAWtC,YAAchD,EAAMgD,YAC/BsC,EAAWvC,IAAI/C,EAAM6E,YACrBS,EAAWvC,IAAIuC,EAAW5B,MAAMc,IACzBc,GAGTvG,EAAeP,EAAS+G,KAExBlG,EAAa,SAASgF,EAAQrE,EAAOmE,GAGnC,MAFAA,GAAQY,QAAU/F,EAAmBgF,kBAAkBG,EAAQY,SAC/DZ,EAAQa,MAAQhG,EAAmBgF,kBAAkBG,EAAQa,OACtDjG,EAAasF,EAAQrE,EAAOmE,IAGrClF,EAAW,SAASoF,EAAQrE,EAAOmE,GACjC,GAAIa,GAAOQ,EAAOT,EAASU,CAI3B,IAHAtB,EAAQO,UAAYxF,EAAac,EAAMD,WAAYC,GACnDmE,EAAQY,QAAU/F,EAAmBoF,qBAAqBD,EAAQY,QAAS/E,EAAOmE,GAClFA,EAAQa,MAAQhG,EAAmBoF,qBAAqBD,EAAQa,MAAOhF,EAAOmE,GAC1E5E,EAAOS,EAAO,WAAaT,EAAOS,EAAMD,WAAY,UACtD,MAAOV,GAAWgF,EAAQrE,EAAOmE,EAInC,IAFAqB,EAAQjG,EAAOS,EAAO,UAAYT,EAAOS,EAAMD,WAAY,SAC3DoE,EAAQ9B,MAAQ8B,EAAQuB,UAAW,IAAUF,EACzCrB,EAAQuB,UAAW,GAASF,EAC9B,MAAOrG,GAAUkF,EAAQrE,EAAOmE,EAKlC,QAHAA,EAAQW,iBAAkB,EAC1BC,EAAUZ,EAAQY,QAClBC,EAAQb,EAAQa,MACRX,GACN,IAAK,OACH,MAAIlF,GAAU,sBAAuBa,EAAOmE,GACnCY,EAAQ5F,EAAUkF,EAAQrE,EAAOmE,KAExCA,EAAQY,QAAU,SAASb,EAAMyB,EAAQC,GACvC,GAAI7F,GAAYiD,EAAa6C,EAAiBC,EAAezF,EAAIC,CAKjE,IAJA4D,EAAO5E,EAAoBU,EAAOkE,GAC7BC,EAAQQ,KACXxF,EAAU,QAASa,EAAOmE,GAExBxE,EAAEoG,QAAQ7B,GAGZ,IAFAnE,EAAaC,EACbgD,EAAcjD,EAAWC,MAAMP,UAAUuD,YACpC3C,EAAK,EAAGC,EAAO4D,EAAKpE,OAAaQ,EAALD,EAAWA,IAC1CwF,EAAkB3B,EAAK7D,GACvBL,EAAQD,EAAWc,IAAIgF,EAAgB7C,IAErC8C,EADE9F,EACcZ,EAAyBY,EAAO6F,GAEhC,GAAI9F,GAAWC,MAAM6F,GAEvC1G,EAAU,SAAU2G,EAAe3B,OAGrC2B,GAAgB1G,EAAyBY,EAAOkE,GAChD/E,EAAU,SAAU2G,EAAe3B,EAErC,OAAOY,GAAQb,EAAMyB,EAAQC,IAE/BzB,EAAQa,MAAQ,SAASd,GACvB,MAAOa,GAAQ5F,EAAUkF,EAAQrE,EAAOmE,KAEnC9E,EAAWgF,EAAQrE,EAAOmE,GAGrC,KAAK,SAWH,MAVAA,GAAQY,QAAU,SAASb,EAAMyB,EAAQC,GACvC,GAAII,EAGJ,OAFAA,GAAe5G,EAAyBY,EAAOkE,GAC/C/E,EAAUkF,EAAQ2B,EAAc7B,GACzBY,EAAQb,EAAMyB,EAAQC,IAE/BzB,EAAQa,MAAQ,SAASd,GAEvB,MADAC,GAAQ9B,OAAQ,EACT0C,EAAQ5F,EAAUkF,EAAQrE,EAAOmE,KAEnC9E,EAAWgF,EAAQrE,EAAOmE,EACnC,KAAK,SACH,MAAInE,GAAMN,aACR+F,EAAczF,EAAMH,GACpBsE,EAAQY,QAAU,SAASb,EAAMyB,EAAQC,GACvC,GAAII,EAOJ,OANAA,GAAe5G,EAAyBY,EAAOkE,GAC/ClE,EAAM+C,IAAI/C,EAAMgD,YAAayC,GAC3BQ,QAAQ,IAEV9G,EAAU,SAAUa,EAAOmE,GAC3BhF,EAAU,SAAU6G,EAAc7B,GAC3BY,EAAQb,EAAMyB,EAAQC,IAE/BzB,EAAQa,MAAQ,SAASd,GAKvB,MAJAC,GAAQ9B,OAAQ,EAChBrC,EAAM+C,IAAI/C,EAAMgD,YAAayC,GAC3BQ,QAAQ,IAEHlB,EAAQ5F,EAAUkF,EAAQrE,EAAOmE,KAE1CnE,EAAM+C,IAAI/C,EAAMgD,YAAa,MAC3BiD,QAAQ,IAEH5G,EAAW,SAAUW,EAAOmE,KAEnCA,EAAQY,QAAU,SAASb,EAAMyB,EAAQC,GACvC,GAAII,EAGJ,OAFAA,GAAe5G,EAAyBY,EAAOkE,GAC/C/E,EAAUkF,EAAQ2B,EAAc7B,GACzBY,EAAQb,EAAMyB,EAAQC,IAE/BzB,EAAQa,MAAQ,SAASd,GAEvB,MADAC,GAAQ9B,OAAQ,EACT0C,EAAQ5F,EAAUkF,EAAQrE,EAAOmE,KAEnC9E,EAAWgF,EAAQrE,EAAOmE,GAGrC,KAAK,SACH,MAAInE,GAAMN,YACDP,EAAUkF,EAAQrE,EAAOmE,IAEhCA,EAAQY,QAAU,SAASb,EAAMyB,EAAQC,GAEvC,MADAzG,GAAUkF,EAAQrE,EAAOmE,GAClBY,EAAQb,EAAMyB,EAAQC,IAE/BzB,EAAQa,MAAQ,SAASd,GAEvB,MADAC,GAAQ9B,OAAQ,EACT0C,EAAQ5F,EAAUkF,EAAQrE,EAAOmE,KAEnC9E,EAAWgF,EAAQrE,EAAOmE,MAKzC3F,EAAS+G,KAAOtG","file":"./1.2.0/backbone.dualstorage.amd.min.js"}