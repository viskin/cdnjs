{"version":3,"sources":["./1.4.0/backbone.dualstorage.amd.js"],"names":["root","factory","define","amd","require","module","exports","Backbone","this","S4","backboneSync","callbackTranslator","dualsync","getStoreName","localsync","modelUpdatedWithResponse","onlineSync","parseRemoteResponse","__indexOf","indexOf","item","i","l","length","DualStorage","offlineStatusCodes","Model","prototype","hasTempId","_","isString","id","collection","model","result","Collection","syncDirty","options","ids","store","_i","_len","_ref","_results","localStorage","getItem","split","push","get","save","dirtyModels","models","call","compact","syncDestroyed","set","idAttribute","destroy","destroyedModelIds","syncDirtyAndDestroyed","Math","random","toString","substring","window","Store","name","records","recordsOn","sep","generateId","setItem","join","key","dirty","dirtyRecords","include","clean","from","without","destroyed","destroyedRecords","create","isObject","JSON","stringify","toJSON","update","clear","removeItem","hasDirtyOrDestroyed","isEmpty","find","modelAsJson","parse","findAll","reject","record_id","exists","storeName","needsTranslation","VERSION","forBackboneCaller","callback","resp","forDualstorageCaller","method","isValidModel","preExisting","response","Error","add","merge","attributes","ignoreCallbacks","success","error","object","parseBeforeLocalSave","isFunction","modelClone","originalSync","sync","hasOfflineStatusCode","local","relayErrorCallback","temporaryId","useOfflineStorage","storeExists","remote","xhr","status","online","_status","_xhr","modelAttributes","responseModel","updatedModel","silent"],"mappings":"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","file":"./1.4.0/backbone.dualstorage.amd.min.js"}