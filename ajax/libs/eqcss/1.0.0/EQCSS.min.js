// EQCSS / Tommy Hodgins, Maxime Euzi√®re / MIT licence
// version 1.0.0
EQCSS={data:[],load:function(){for(var a=document.querySelectorAll("style"),c=0;c<a.length;c++)null===a[c].getAttribute("data-eqcss-read")&&(a[c].setAttribute("data-eqcss-read","true"),EQCSS.parse(a[c].innerHTML),EQCSS.apply());a=document.querySelectorAll("script");for(c=0;c<a.length;c++)null===a[c].getAttribute("data-eqcss-read")&&"text/eqcss"===a[c].getAttribute("type")&&(a[c].src?function(){var b=new XMLHttpRequest;b.open("GET",a[c].src,!0);b.send(null);b.onload=function(){EQCSS.parse(b.responseText);
EQCSS.apply()}}():(EQCSS.parse(a[c].innerHTML),EQCSS.apply()),a[c].setAttribute("data-eqcss-read","true"));a=document.querySelectorAll("link");for(c=0;c<a.length;c++)null===a[c].getAttribute("data-eqcss-read")&&"stylesheet"==a[c].getAttribute("rel")&&(a[c].href&&function(){var b=new XMLHttpRequest;b.open("GET",a[c].href,!0);b.send(null);b.onload=function(){EQCSS.parse(b.responseText);EQCSS.apply()}}(),a[c].setAttribute("data-eqcss-read","true"))},parse:function(a){a=a.replace(/\s+/g," ");a=a.replace(/\/\*[\w\W]*?\*\//g,
"");a=a.replace(/@element/g,"\n@element");a=a.replace(/(@element.*?\{([^}]*?\{[^}]*?\}[^}]*?)*\}).*/g,"$1");a.replace(/(@element.*(?!@element))/g,function(a,b){dataEntry={};b.replace(/@element ?["']([^"']*)["']/g,function(a,b){dataEntry.g=b});dataEntry.a=[];b.replace(/and ?\( ?([^:]*) ?: ?([^)]*) ?\)/g,function(a,b,c){a=null;a=c.replace(/^\d+(\D+)$/,"$1");a==c&&(a=null);c=c.replace(/^(\d+)\D+$/,"$1");dataEntry.a.push({measure:b,value:c,b:a})});b.replace(/{(.*)}/g,function(a,b){dataEntry.style=b});
EQCSS.data.push(dataEntry)})},apply:function(){var a,c,b,g,m,l,n,e,d,h,k;for(a=0;a<EQCSS.data.length;a++)for(g=document.querySelectorAll(EQCSS.data[a].g),c=0;c<g.length;c++){m="data-eqcss-"+a+"-"+c;g[c].setAttribute(m,"");n="data-eqcss-"+a+"-"+c+"-parent";g[c]!=document.documentElement&&g[c].parentNode.setAttribute(n,"");l=document.querySelector("#"+m);l||(l=document.createElement("STYLE"),l.id=m,l.setAttribute("data-eqcss-read","true"),document.querySelector("head").appendChild(l));l=document.querySelector("#"+
m);h=!0;b=0;a:for(;b<EQCSS.data[a].a.length;b++){d=window.getComputedStyle(g[c],null);k=null;g[c]!=document.documentElement&&(k=window.getComputedStyle(g[c].parentNode,null));e=!1;if("vw"===EQCSS.data[a].a[b].b){e=!0;var f=parseInt(EQCSS.data[a].a[b].value);EQCSS.data[a].a[b].c=f*window.innerWidth/100}else if("vh"===EQCSS.data[a].a[b].b)e=!0,f=parseInt(EQCSS.data[a].a[b].value),EQCSS.data[a].a[b].c=f*window.innerHeight/100;else if("vmin"===EQCSS.data[a].a[b].b)e=!0,f=parseInt(EQCSS.data[a].a[b].value),
EQCSS.data[a].a[b].c=f*Math.min(window.innerWidth,window.innerHeight)/100;else if("vmax"===EQCSS.data[a].a[b].b)e=!0,f=parseInt(EQCSS.data[a].a[b].value),EQCSS.data[a].a[b].c=f*Math.max(window.innerWidth,window.innerHeight)/100;else if(null!=EQCSS.data[a].a[b].b&&"px"!=EQCSS.data[a].a[b].b&&"%"!=EQCSS.data[a].a[b].b){f=document.createElement("DIV");f.style.visibility="hidden";f.style.border="1px solid red";f.style.width=EQCSS.data[a].a[b].value+EQCSS.data[a].a[b].b;var p=g[c];g[c]!=document.documentElement&&
(p=g[c].parentNode);p.appendChild(f);EQCSS.data[a].a[b].value=parseInt(window.getComputedStyle(f,null).getPropertyValue("width"));EQCSS.data[a].a[b].b="px";p.removeChild(f)}f=e?EQCSS.data[a].a[b].c:parseInt(EQCSS.data[a].a[b].value);switch(EQCSS.data[a].a[b].measure){case "min-width":if(1==e||"px"==EQCSS.data[a].a[b].b)if(e=parseInt(d.getPropertyValue("width")),!(e>=f)){h=!1;break a}if("%"==EQCSS.data[a].a[b].b&&(e=parseInt(d.getPropertyValue("width")),d=parseInt(k.getPropertyValue("width")),!(d/
e<=100/f))){h=!1;break a}break;case "max-width":if(1==e||"px"==EQCSS.data[a].a[b].b)if(e=parseInt(d.getPropertyValue("width")),!(e<=f)){h=!1;break a}if("%"==EQCSS.data[a].a[b].b&&(e=parseInt(d.getPropertyValue("width")),d=parseInt(k.getPropertyValue("width")),!(d/e>=100/f))){h=!1;break a}break;case "min-height":if(1==e||"px"==EQCSS.data[a].a[b].b)if(e=parseInt(d.getPropertyValue("height")),!(e>=f)){h=!1;break a}if("%"==EQCSS.data[a].a[b].b&&(e=parseInt(d.getPropertyValue("height")),d=parseInt(k.getPropertyValue("height")),
!(d/e<=100/f))){h=!1;break a}break;case "max-height":if(1==e||"px"==EQCSS.data[a].a[b].b)if(e=parseInt(d.getPropertyValue("height")),!(e<=f)){h=!1;break a}if("%"==EQCSS.data[a].a[b].b&&(e=parseInt(d.getPropertyValue("height")),d=parseInt(k.getPropertyValue("height")),!(d/e>=100/f))){h=!1;break a}break;case "min-scroll-x":k=g[c].scrollLeft;if(1==e||"px"==EQCSS.data[a].a[b].b){if(!(k>=f)){h=!1;break a}}else if("%"==EQCSS.data[a].a[b].b&&(e=g[c].scrollWidth,d=g[c]==document.documentElement||g[c]==document.body?
window.innerWidth:parseInt(d.getPropertyValue("width")),!(k/(e-d)*100>=f))){h=!1;break a}break;case "min-scroll-y":k=g[c].scrollTop;if(1==e||"px"==EQCSS.data[a].a[b].b){if(!(k>=f)){h=!1;break a}}else if("%"==EQCSS.data[a].a[b].b&&(e=g[c].scrollHeight,d=g[c]==document.documentElement||g[c]==document.body?window.innerHeight:parseInt(d.getPropertyValue("height")),!(k/(e-d)*100>=f))){h=!1;break a}break;case "max-scroll-x":k=g[c].scrollLeft;if(1==e||"px"==EQCSS.data[a].a[b].b){if(!(k<=f)){h=!1;break a}}else if("%"==
EQCSS.data[a].a[b].b&&(e=g[c].scrollWidth,d=g[c]==document.documentElement||g[c]==document.body?window.innerWidth:parseInt(d.getPropertyValue("width")),!(k/(e-d)*100<=f))){h=!1;break a}break;case "max-scroll-y":k=g[c].scrollTop;if(1==e||"px"==EQCSS.data[a].a[b].b){if(!(k<=f)){h=!1;break a}}else if("%"==EQCSS.data[a].a[b].b&&(e=g[c].scrollHeight,d=g[c]==document.documentElement||g[c]==document.body?window.innerHeight:parseInt(d.getPropertyValue("height")),!(k/(e-d)*100<=f))){h=!1;break a}break;case "min-characters":if(g[c].value){if(!(g[c].value.length>=
f)){h=!1;break a}}else if(!(g[c].textContent.length>=f)){h=!1;break a}break;case "max-characters":if(g[c].value){if(!(g[c].value.length<=f)){h=!1;break a}}else if(!(g[c].textContent.length<=f)){h=!1;break a}break;case "min-children":if(!(g[c].children.length>=f)){h=!1;break a}break;case "max-children":if(!(g[c].children.length<=f)){h=!1;break a}break;case "min-lines":e=parseInt(d.getPropertyValue("height"))-parseInt(d.getPropertyValue("border-top-width"))-parseInt(d.getPropertyValue("border-bottom-width"))-
parseInt(d.getPropertyValue("padding-top"))-parseInt(d.getPropertyValue("padding-bottom"));d=parseInt(d.getPropertyValue("line-height"));if(!(e/d>=f)){h=!1;break a}break;case "max-lines":if(e=parseInt(d.getPropertyValue("height"))-parseInt(d.getPropertyValue("border-top-width"))-parseInt(d.getPropertyValue("border-bottom-width"))-parseInt(d.getPropertyValue("padding-top"))-parseInt(d.getPropertyValue("padding-bottom")),d=parseInt(d.getPropertyValue("line-height")),!(e/d+1<=f)){h=!1;break a}}}if(!0===
h){b=EQCSS.data[a].style;b=b.replace(/\$this/g,"["+m+"]");b=b.replace(/\$parent/g,"["+n+"]");b=b.replace(/\$root/g,"html");b=b.replace(/var\(([^()]*(\([^)]*\)[^()]*)*[^()]*)\)/g,function(a,b){return eval(b)||""});try{l.innerHTML=b}catch(q){l.styleSheet.cssText=b}}else try{l.innerHTML=""}catch(q){l.styleSheet.cssText=""}}},f:function(a){function c(){try{n.doScroll("left")}catch(a){setTimeout(c,50);return}b("poll")}function b(c){if("readystatechange"!=c.type||"complete"==l.readyState)("load"==c.type?
window:l)[h](k+c.type,b,!1),!g&&(g=!0)&&a.call(window,c.type||c)}var g=!1,m=!0,l=window.document,n=l.documentElement,e=!~navigator.userAgent.indexOf("MSIE 8"),d=e?"addEventListener":"attachEvent",h=e?"removeEventListener":"detachEvent",k=e?"":"on";if("complete"==l.readyState)a.call(window,"lazy");else{if(!e&&n.doScroll){try{m=!window.frameElement}catch(f){}m&&c()}l[d](k+"DOMContentLoaded",b,!1);l[d](k+"readystatechange",b,!1);window[d](k+"load",b,!1)}}};EQCSS.f(function(){EQCSS.load();EQCSS.apply()});
window.addEventListener("resize",function(){EQCSS.apply()});window.addEventListener("scroll",function(){EQCSS.apply()});