/*! formstone v0.7.6 [analytics.js] 2015-07-18 | MIT License | formstone.it */

!function(a,b,c){"use strict";function d(){r=b.$body}function e(){o.scrollDepth&&k()}function f(){return arguments.length&&"object"!==a.type(arguments[0])?"destroy"===arguments[0]?h.apply(this):m.apply(this,arguments):g.apply(this,arguments),null}function g(b){!u&&r.length&&(u=!0,z="function"===a.type(p.ga),A="undefined"!==a.type(p.dataLayer)&&"function"===a.type(p.dataLayer.push),o=a.extend(o,b||{}),o.scrollDepth&&(k(),q.on(t.scroll,i),q.one(t.load,e)),r.on(t.click,"*["+w+"]",l))}function h(){u&&r.length&&(q.off(t.namespace),r.off(t.namespace))}function i(a){s.startTimer(y,250,j)}function j(){for(var c,d=a.mediaquery("state"),e=b.$window.scrollTop()+b.windowHeight,f=0,g=1/o.scrollStops,h=g,i=1;i<=o.scrollStops;i++)c=Math.round(100*h).toString(),x[c].passed?f++:e>x[c].edge&&(x[c].passed=!0,d.minWidth&&m("ScrollDepth","MinWidth:"+d.minWidth+"px",c)),h+=g;f>=o.scrollStops&&q.off(t.scroll)}function k(){for(var a,b=r.outerHeight(),c={},d=1/o.scrollStops,e=d,f=0,g=1;g<=o.scrollStops;g++)f=parseInt(b*e),a=Math.round(100*e).toString(),c[a]={edge:"100"===a?f-10:f,passsed:x[a]?x[a].passed:!1},e+=d;x=c}function l(b){if(z||A){b.preventDefault();var c=a(this),d=c.attr("href"),e=c.data(v).split(",");for(var f in e)e.hasOwnProperty(f)&&(e[f]=a.trim(e[f]));m(e[0],e[1],e[2]||d,e[3],e[4],c)}}function m(b,c,d,e,f,g){if("function"===a.type(p.ga)){var h={hitType:"event",location:p.location,title:p.document.title};if(b&&(h.eventCategory=b),c&&(h.eventAction=c),d&&(h.eventLabel=d),e&&(h.eventValue=e),f&&(h.nonInteraction=f),"undefined"!==a.type(g)&&!g.attr("data-analytics-stop")){var i="undefined"!==a.type(g[0].href)?g[0].href:"",j=!i.match(/^mailto\:/i)&&!i.match(/^tel\:/i)&&i.indexOf(":")<0?p.location.protocol+"//"+p.location.hostname+"/"+i:i;""!==i&&(g.attr("target")?p.open(j,g.attr("target")):h[z?"hitCallback":"eventCallback"]=function(){document.location=j})}z?p.ga("send",h):A&&(h.event="gaTriggerEvent",p.dataLayer.push(h))}}var n=b.Plugin("analytics",{methods:{_setup:d,_resize:e},utilities:{_delegate:f}}),o={scrollDepth:!1,scrollStops:5},p=b.window,q=b.$window,r=null,s=n.functions,t=n.events,u=!1,v="analytics-event",w="data-"+v,x={},y=null,z=!1,A=!1}(jQuery,Formstone);