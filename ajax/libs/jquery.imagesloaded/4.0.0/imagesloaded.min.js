/*!
 * imagesLoaded v4.0.0
 * JavaScript is all like "You images are done yet or what?"
 * MIT License
 */
(function(b,a){if(typeof define=="function"&&define.amd){define(["eventEmitter/EventEmitter"],function(c){return a(b,c)})}else{if(typeof module=="object"&&module.exports){module.exports=a(b,require("wolfy87-eventemitter"))}else{b.imagesLoaded=a(b,b.EventEmitter)}}})(window,function factory(f,j){var d=f.jQuery;var c=f.console;function g(l,k){for(var m in k){l[m]=k[m]}return l}function a(m){var l=[];if(Array.isArray(m)){l=m}else{if(typeof m.length=="number"){for(var k=0;k<m.length;k++){l.push(m[k])}}else{l.push(m)}}return l}function e(m,l,k){if(!(this instanceof e)){return new e(m,l,k)}if(typeof m=="string"){m=document.querySelectorAll(m)}this.elements=a(m);this.options=g({},this.options);if(typeof l=="function"){k=l}else{g(this.options,l)}if(k){this.on("always",k)}this.getImages();if(d){this.jqDeferred=new d.Deferred()}setTimeout(function(){this.check()}.bind(this))}e.prototype=Object.create(j.prototype);e.prototype.options={};e.prototype.getImages=function(){this.images=[];this.elements.forEach(this.addElementImages,this)};e.prototype.addElementImages=function(o){if(o.nodeName=="IMG"){this.addImage(o)}if(this.options.background===true){this.addElementBackgroundImages(o)}var k=o.nodeType;if(!k||!b[k]){return}var p=o.querySelectorAll("img");for(var n=0;n<p.length;n++){var l=p[n];this.addImage(l)}if(typeof this.options.background=="string"){var m=o.querySelectorAll(this.options.background);for(n=0;n<m.length;n++){var q=m[n];this.addElementBackgroundImages(q)}}};var b={1:true,9:true,11:true};e.prototype.addElementBackgroundImages=function(m){var l=getComputedStyle(m);if(!l){return}var o=/url\((['"])?(.*?)\1\)/gi;var n=o.exec(l.backgroundImage);while(n!==null){var k=n&&n[2];if(k){this.addBackground(k,m)}n=o.exec(l.backgroundImage)}};e.prototype.addImage=function(k){var l=new h(k);this.images.push(l)};e.prototype.addBackground=function(k,m){var l=new i(k,m);this.images.push(l)};e.prototype.check=function(){var l=this;this.progressedCount=0;this.hasAnyBroken=false;if(!this.images.length){this.complete();return}function k(o,n,m){setTimeout(function(){l.progress(o,n,m)})}this.images.forEach(function(m){m.once("progress",k);m.check()})};e.prototype.progress=function(m,l,k){this.progressedCount++;this.hasAnyBroken=this.hasAnyBroken||!m.isLoaded;this.emit("progress",this,m,l);if(this.jqDeferred&&this.jqDeferred.notify){this.jqDeferred.notify(this,m)}if(this.progressedCount==this.images.length){this.complete()}if(this.options.debug&&c){c.log("progress: "+k,m,l)}};e.prototype.complete=function(){var l=this.hasAnyBroken?"fail":"done";this.isComplete=true;this.emit(l,this);this.emit("always",this);if(this.jqDeferred){var k=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[k](this)}};function h(k){this.img=k}h.prototype=Object.create(j.prototype);h.prototype.check=function(){var k=this.getIsImageComplete();if(k){this.confirm(this.img.naturalWidth!==0,"naturalWidth");return}this.proxyImage=new Image();this.proxyImage.addEventListener("load",this);this.proxyImage.addEventListener("error",this);this.img.addEventListener("load",this);this.img.addEventListener("error",this);this.proxyImage.src=this.img.src};h.prototype.getIsImageComplete=function(){return this.img.complete&&this.img.naturalWidth!==undefined};h.prototype.confirm=function(k,l){this.isLoaded=k;this.emit("progress",this,this.img,l)};h.prototype.handleEvent=function(k){var l="on"+k.type;if(this[l]){this[l](k)}};h.prototype.onload=function(){this.confirm(true,"onload");this.unbindEvents()};h.prototype.onerror=function(){this.confirm(false,"onerror");this.unbindEvents()};h.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this);this.proxyImage.removeEventListener("error",this);this.img.removeEventListener("load",this);this.img.removeEventListener("error",this)};function i(k,l){this.url=k;this.element=l;this.img=new Image()}i.prototype=Object.create(h.prototype);i.prototype.check=function(){this.img.addEventListener("load",this);this.img.addEventListener("error",this);this.img.src=this.url;var k=this.getIsImageComplete();if(k){this.confirm(this.img.naturalWidth!==0,"naturalWidth");this.unbindEvents()}};i.prototype.unbindEvents=function(){this.img.addEventListener("load",this);this.img.addEventListener("error",this)};i.prototype.confirm=function(k,l){this.isLoaded=k;this.emit("progress",this,this.element,l)};e.makeJQueryPlugin=function(k){k=k||f.jQuery;if(!k){return}d=k;d.fn.imagesLoaded=function(m,n){var l=new e(this,m,n);return l.jqDeferred.promise(d(this))}};e.makeJQueryPlugin();return e});