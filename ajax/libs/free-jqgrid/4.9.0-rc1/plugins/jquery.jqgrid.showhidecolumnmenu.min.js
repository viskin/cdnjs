(function(a){a.jgrid=a.jgrid||{};a.extend(a.jgrid,{showHideColumnMenu:{adjustGridWidth:true,viewHideDlgColumnsAsDisabled:false,allowHideInernalColumns:false,shrink:false,menuStyle:{"float":"left"},modifyMenuItem:function(d,b,c){if(a.inArray(b.name,["rn","subgrid","cb"])>=0){if(!c.allowHideInernalColumns){d.hide()}return}if(!b.hidedlg){return}if(c.viewHideDlgColumnsAsDisabled){d.addClass("ui-state-disabled")}else{d.hide()}}}});a.jgrid.extend({showHideColumnMenu:function(d){var b=a.extend(true,{},a.jgrid.showHideColumnMenu,d),c=a.ui!=null&&typeof a.ui.version==="string"?/^([0-9]+)\.([0-9]+)\.([0-9]+)$/.exec(a.ui.version):[],e=c!=null&&c.length===4&&c[1]==="1"&&c[2]<11;return this.each(function(){var f=a(this),g=function(){a(this.grid.hDiv).find(".ui-jqgrid-labels").contextmenu(function(s){var m=f.jqGrid("getGridParam"),v=m.colModel,A=m.colNames,z,r=v.length,w,u,t=m.groupHeader,y={},k={},q,o,n,x,h=a("<ul class='ui-jqgrid-showHideColumnMenu'></ul>");for(z=0;z<r;z++){y[v[z].name]=z}if(t!=null&&t.groupHeaders!=null){for(q=0,n=t.groupHeaders.length;q<n;q++){x=t.groupHeaders[q];for(o=0;o<x.numberOfColumns;o++){z=y[x.startColumnName]+o;w=v[z];k[z]=a.isFunction(b.buildItemText)?b.buildItemText.call(f[0],{iCol:z,cm:w,cmName:w.name,colName:A[z],groupTitleText:x.titleText}):a.jgrid.stripHtml(x.titleText)+": "+a.jgrid.stripHtml(A[z]===""?w.name:A[z])}}}for(z=0;z<r;z++){if(k[z]===undefined){w=v[z];k[z]=a.isFunction(b.buildItemText)?b.buildItemText.call(f[0],{iCol:z,cm:w,cmName:w.name,colName:A[z],groupTitleText:null}):a.jgrid.stripHtml(A[z])}}for(z=0;z<r;z++){w=v[z];u=a("<li></li>").data("iCol",z).html(k[z]);b.modifyMenuItem.call(f[0],u,w,b);u.prepend(w.hidden?b.checkboxUnChecked:b.checkboxChecked);if(e){u.wrapInner("<a></a>")}u.appendTo(h)}h.css(b.menuStyle);a("ul.ui-jqgrid-showHideColumnMenu").menu("destroy").remove();h.appendTo("body").menu({select:function(p,B){var l=parseInt(B.item.data("iCol"),10),C=B.item.find(b.checkboxSelector),i=v[l],j=b.isChecked.call(f[0],C,p,i);if(!isNaN(l)&&l>=0&&i!=null&&C.length>0){if(j){b.toUnCheck.call(f[0],C,p,i);f.jqGrid("hideCol",i.name)}else{b.toCheck.call(f[0],C,p,i);f.jqGrid("showCol",i.name)}a(this).parent().css("zoom",1);h.menu("focus",p,B.item)}},create:function(){var j=h.height(),i=window.innerHeight||document.documentElement.clientHeight;if(j>i){h.height(i).css("overflow-y","scroll")}}}).mouseleave(function(){a(this).menu("destroy").remove()}).position({of:a(s.target),my:"left top",at:"right center",collision:"flipfit flipfit"});return false})};b=a.extend(true,(this.p.iconSet==="fontAwesome"||b.iconSet==="fontAwesome")?{checkboxChecked:'<i class="fa fa-check-square-o fa-fw fa-lg"></i>&nbsp;',checkboxUnChecked:'<i class="fa fa-square-o fa-fw fa-lg"></i>&nbsp;',checkboxSelector:"i.fa",isChecked:function(h){return h.hasClass("fa-check-square-o")},toCheck:function(h){h.removeClass("fa-square-o").addClass("fa-check-square-o")},toUnCheck:function(h){h.removeClass("fa-check-square-o").addClass("fa-square-o")}}:{checkboxChecked:'<input disabled="disabled" checked="checked" type="checkbox"/>',checkboxUnChecked:'<input disabled="disabled" type="checkbox"/>',checkboxSelector:"input[type=checkbox]",isChecked:function(h){return h.is(":checked")},toCheck:function(h){h.prop("checked",true)},toUnCheck:function(h){h.prop("checked",false)}},b);g.call(this);f.bind("jqGridAfterSetGroupHeaders",function(){g.call(this)})})}})}(jQuery));