/*!
 * Distpicker v0.2.0
 * https://github.com/fengyuanchen/distpicker
 *
 * Copyright 2014 Fengyuan Chen
 * Released under the MIT license
 *
 * Date: 2014-12-20T10:15:12.070Z
 */
!function(a){"function"==typeof define&&define.amd?define(["jquery","ChineseDistricts"],a):a(jQuery,ChineseDistricts)}(function(a,b){"use strict";if("undefined"==typeof b)throw new Error('The file "distpicker.data.js" must be included first!');var c=".distpicker",d="change"+c,e=function(b,c){this.$element=a(b),this.defaults=a.extend({},e.defaults,a.isPlainObject(c)?c:{}),this.placeholders=a.extend({},e.defaults),this.init()};e.prototype={constructor:e,data:b,init:function(){var b=this.defaults,c=this.$element.find("select"),d=c.length,e={};c.each(function(){a.extend(e,a(this).data())}),e.province?(b.province=e.province,this.$province=c.filter("[data-province]")):this.$province=d>0?c.eq(0):null,e.city?(b.city=e.city,this.$city=c.filter("[data-city]")):this.$city=d>1?c.eq(1):null,e.district?(b.district=e.district,this.$district=c.filter("[data-district]")):this.$district=d>2?c.eq(2):null,this.reset(),this.addListeners()},addListeners:function(){var a=this;this.$province&&this.$province.on(d,function(){a.output("city"),a.output("district")}),this.$city&&this.$city.on(d,function(){a.output("district")})},removeListeners:function(){this.$province&&this.$province.off(d),this.$city&&this.$city.off(d)},output:function(b){var c,d=this.defaults,e=this.placeholders,f=this["$"+b],g=1,h={},i=[],j="";f&&(j=d[b]||"",g="province"===b?1:"city"===b?this.$province.find("option:selected").data().zipcode:"district"===b?this.$city.find("option:selected").data().zipcode:g,h=a.isNumeric(g)?this.data[g]:{},h=a.isPlainObject(h)?h:{},a.each(h,function(a,b){var d=b===j;d&&(c=!0),i.push({zipcode:a,address:b,selected:d})}),c||(d.autoSelect||d.autoselect?i[0].selected=!0:e[b]=j),d.placeholder&&i.unshift({zipcode:"",address:e[b],selected:!1}),f.html(this.template(i)))},template:function(b){var c="";return a.each(b,function(a,b){c+='<option value="'+(b.address&&b.zipcode?b.address:"")+'" data-zipcode="'+(b.zipcode||"")+'"'+(b.selected?" selected":"")+">"+(b.address||"")+"</option>"}),c},reset:function(a){var b=this.defaults;return a?(this.$province&&this.$province.find(":first").prop("selected",!0),this.$city&&(b.placeholder?this.$city.find(":gt(0)").remove():this.output("city")),void(this.$district&&(b.placeholder?this.$district.find(":gt(0)").remove():this.output("district")))):(this.output("province"),this.output("city"),void this.output("district"))},destroy:function(){this.removeListeners(),this.$element.removeData("distpicker")}},e.defaults={autoSelect:!0,placeholder:!0,province:"—— 省 ——",city:"—— 市 ——",district:"—— 区 ——"},e.setDefaults=function(b){a.extend(e.defaults,b)},a.fn.distpicker=function(b){var c,d=[].slice.call(arguments,1);return this.each(function(){var f,g=a(this),h=g.data("distpicker");h||g.data("distpicker",h=new e(this,b)),"string"==typeof b&&a.isFunction(f=h[b])&&(c=f.apply(h,d))}),"undefined"!=typeof c?c:this},a.fn.distpicker.Constructor=e,a.fn.distpicker.setDefaults=e.setDefaults,a(function(){a("[data-distpicker]").distpicker()})});