/**
 * Angular Google Analytics - Easy tracking for your AngularJS application
 * @version v0.0.4 - 2014-09-03
 * @link http://revolunet.com.github.com/angular-google-analytics
 * @author Julien Bouquillon <julien@revolunet.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";angular.module("angular-google-analytics",[]).provider("Analytics",function(){var e,t,n,a,r,i=!1,s=!0,c="",o=!1,g="$routeChangeSuccess",u="auto",m=!1,l=!1,_=!1,d=!1,h={allowLinker:!0};this._logs=[],this.setAccount=function(t){return e=t,!0},this.trackPages=function(e){return s=e,!0},this.trackPrefix=function(e){return c=e,!0},this.setDomainName=function(e){return t=e,!0},this.useAnalytics=function(e){return o=!!e,!0},this.useEnhancedLinkAttribution=function(e){return l=!!e,!0},this.useCrossDomainLinker=function(e){return d=!!e,!0},this.setCrossLinkDomains=function(e){return r=e,!0},this.setPageEvent=function(e){return g=e,!0},this.setCookieConfig=function(e){return u=e,!0},this.useECommerce=function(e){return m=!!e,!0},this.setRemoveRegExp=function(e){return e instanceof RegExp?(n=e,!0):!1},this.setExperimentId=function(e){return a=e,!0},this.ignoreFirstPageLoad=function(e){_=!!e},this.$get=["$document","$rootScope","$location","$window",function(f,p,k,v){function w(){e&&(v._gaq=[],v._gaq.push(["_setAccount",e]),l&&v._gaq.push(["_require","inpage_linkid","//www.google-analytics.com/plugins/ga/inpage_linkid.js"]),s&&!_&&(n?v._gaq.push(["_trackPageview",y()]):v._gaq.push(["_trackPageview"])),t&&v._gaq.push(["_setDomainName",t]),function(){var e=f[0],t=e.createElement("script");t.type="text/javascript",t.async=!0,t.src=("https:"===e.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var n=e.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n)}(),i=!0)}function q(){if(!e)return console.warn("No account id set for Analytics.js");if(function(e,t,n,a,r,i,s){e.GoogleAnalyticsObject=r,e[r]=e[r]||function(){(e[r].q=e[r].q||[]).push(arguments)},e[r].l=1*new Date,i=t.createElement(n),s=t.getElementsByTagName(n)[0],i.async=1,i.src=a,s.parentNode.insertBefore(i,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),angular.isArray(e)?e.forEach(function(e){v.ga("create",e.tracker,u,{name:e.name})}):d?(v.ga("create",e,u,h),v.ga("require","linker"),r&&v.ga("linker:autoLink",r)):v.ga("create",e,u),s&&!_&&v.ga("send","pageview",y()),v.ga&&(m&&v.ga("require","ecommerce","ecommerce.js"),l&&v.ga("require","linkid","linkid.js"),a)){var t=document.createElement("script"),n=document.getElementsByTagName("script")[0];t.src="//www.google-analytics.com/cx/api.js?experiment="+a,n.parentNode.insertBefore(t,n)}}var y=function(){var e=k.path();return n?e.replace(n,""):e};this._log=function(){this._logs.push(arguments)},this._trackPage=function(t,n){n=n?n:f[0].title,s&&!o&&v._gaq?(v._gaq.push(["_set","title",n]),v._gaq.push(["_trackPageview",c+t]),this._log("_trackPageview",arguments)):s&&o&&v.ga&&(angular.isArray(e)?e.forEach(function(e){v.ga(e.name+".send","pageview",{page:c+t,title:n})}):v.ga("send","pageview",{page:c+t,title:n}),this._log("pageview",arguments))},this._trackEvent=function(e,t,n,a){!o&&v._gaq?(v._gaq.push(["_trackEvent",e,t,n,a]),this._log("trackEvent",arguments)):v.ga&&(v.ga("send","event",e,t,n,a),this._log("event",arguments))},this._addTrans=function(e,t,n,a,r,i,s,c,g){!o&&v._gaq?(v._gaq.push(["_addTrans",e,t,n,a,r,i,s,c]),this._log("_addTrans",arguments)):v.ga&&(m?(v.ga("ecommerce:addTransaction",{id:e,affiliation:t,revenue:n,tax:a,shipping:r,currency:g||"USD"}),this._log("ecommerce:addTransaction",arguments)):console.warn("ecommerce no set. Use AnalyticsProvider.setECommerce(true);"))},this._addItem=function(e,t,n,a,r,i){!o&&v._gaq?(v._gaq.push(["_addItem",e,t,n,a,r,i]),this._log("_addItem",arguments)):v.ga&&(v.ga("ecommerce:addItem",{id:e,name:n,sku:t,category:a,price:r,quantity:i}),this._log("ecommerce:addItem",arguments))},this._trackTrans=function(){!o&&v._gaq?(v._gaq.push(["_trackTrans"]),this._log("_trackTrans",arguments)):v.ga&&(v.ga("ecommerce:send"),this._log("ecommerce:send",arguments))},this._clearTrans=function(){v.ga&&(v.ga("ecommerce:clear"),this._log("ecommerce:clear",arguments))},this._send=function(e){v.ga&&(v.ga("send",e),this._log("send",e))},this._set=function(e,t){v.ga&&(v.ga("set",e,t),this._log("set",e,t))},o?q():w();var E=this;return s&&p.$on(g,function(){E._trackPage(y())}),{_logs:E._logs,cookieConfig:u,ecommerce:m,enhancedLinkAttribution:l,getUrl:y,experimentId:a,ignoreFirstPageLoad:_,trackPage:function(e,t){E._trackPage(e,t)},trackEvent:function(e,t,n,a){E._trackEvent(e,t,n,a)},addTrans:function(e,t,n,a,r,i,s,c,o){E._addTrans(e,t,n,a,r,i,s,c,o)},addItem:function(e,t,n,a,r,i){E._addItem(e,t,n,a,r,i)},trackTrans:function(){E._trackTrans()},clearTrans:function(){E._clearTrans()},send:function(e){E._send(e)},set:function(e,t){E._set(e,t)}}}]});