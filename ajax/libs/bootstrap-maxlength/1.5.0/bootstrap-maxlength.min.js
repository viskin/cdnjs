(function(a){a.fn.extend({maxlength:function(p,n){var h=a("body"),c={alwaysShow:false,threshold:10,warningClass:"label label-success",limitReachedClass:"label label-important",separator:" / ",preText:"",postText:"",showMaxLength:true,placement:"bottom",showCharsTyped:true,validate:false,utf8:false};if(a.isFunction(p)&&!n){n=p;p={}}p=a.extend(c,p);function d(q){var u=q.val();var t=u.match(/\n/g);var s=0;var r=0;if(p.utf8){s=t?i(t):0;r=i(q.val())+s}else{s=t?t.length:0;r=q.val().length+s}return r}function i(r){var q=0;for(var t=0;t<r.length;t++){var s=r.charCodeAt(t);if(s<128){q++}else{if((s>127)&&(s<2048)){q=q+2}else{q=q+3}}}return q}function g(r,t,s){var q=true;if(!p.alwaysShow&&(s-d(r)>t)){q=false}return q}function j(q,r){var s=r-d(q);return s}function f(q){q.css({display:"block"})}function l(q){q.css({display:"none"})}function m(r,s){var q="";if(p.message){q=p.message.replace("%charsTyped%",s).replace("%charsRemaining%",r-s).replace("%charsTotal%",r)}else{if(p.preText){q+=p.preText}if(!p.showCharsTyped){q+=r-s}else{q+=s}if(p.showMaxLength){q+=p.separator+r}if(p.postText){q+=p.postText}}return q}function e(r,q,s,t){t.html(m(s,(s-r)));if(r>0){if(g(q,p.threshold,s)){f(t.removeClass(p.limitReachedClass).addClass(p.warningClass))}else{l(t)}}else{f(t.removeClass(p.warningClass).addClass(p.limitReachedClass))}}function o(q){var r=q[0];return a.extend({},(typeof r.getBoundingClientRect==="function")?r.getBoundingClientRect():{width:r.offsetWidth,height:r.offsetHeight},q.offset())}function b(q,u){var w=o(q),t=q.outerWidth(),s=u.outerWidth(),r=u.width(),v=u.height();switch(p.placement){case"bottom":u.css({top:w.top+w.height,left:w.left+w.width/2-r/2});break;case"top":u.css({top:w.top-v,left:w.left+w.width/2-r/2});break;case"left":u.css({top:w.top+w.height/2-v/2,left:w.left-r});break;case"right":u.css({top:w.top+w.height/2-v/2,left:w.left+w.width});break;case"bottom-right":u.css({top:w.top+w.height,left:w.left+w.width});break;case"top-right":u.css({top:w.top-v,left:w.left+t});break;case"top-left":u.css({top:w.top-v,left:w.left-s});break;case"bottom-left":u.css({top:w.top+q.outerHeight(),left:w.left-s});break;case"centered-right":u.css({top:w.top+(v/2),left:w.left+t-s-3});break}}function k(q){return q.attr("maxlength")||q.attr("size")}return this.each(function(){var q=a(this),r,s;q.focus(function(){var u=m(r,"0");r=k(q);s=a('<span class="bootstrap-maxlength"></span>').css({display:"none",position:"absolute",whiteSpace:"nowrap",zIndex:1099}).html(u);if(q.is("textarea")){q.data("maxlenghtsizex",q.outerWidth());q.data("maxlenghtsizey",q.outerHeight());q.mouseup(function(){if(q.outerWidth()!==q.data("maxlenghtsizex")||q.outerHeight()!==q.data("maxlenghtsizey")){b(q,s)}q.data("maxlenghtsizex",q.outerWidth());q.data("maxlenghtsizey",q.outerHeight())})}h.append(s);var t=j(q,k(q));e(t,q,r,s);b(q,s)});q.blur(function(){s.remove()});q.keyup(function(w){var u=j(q,k(q)),t=true,v=w.keyCode||w.which;if(p.validate&&u<0){t=false}else{e(u,q,r,s)}return t})})}})}(jQuery));