/*! angular-multi-select 6.0.0 */

"use strict";function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a},_extends=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},angular_multi_select_consts=angular.module("angular-multi-select-constants",[]);angular_multi_select_consts.constant("angularMultiSelectConstants",{ID_PROPERTY:"id",OPEN_PROPERTY:"open",CHECKED_PROPERTY:"checked",CHILDREN_PROPERTY:"children",INTERNAL_KEY_LEVEL:"$ams_level",INTERNAL_KEY_ORDER:"$ams_order",INTERNAL_KEY_PARENTS_ID:"$ams_parents_id",INTERNAL_KEY_CHILDREN_LEAFS:"$ams_children_leafs",INTERNAL_KEY_CHILDREN_NODES:"$ams_children_nodes",INTERNAL_KEY_CHECKED_CHILDREN:"$ams_checked_children",INTERNAL_KEY_TREE_VISIBILITY:"$ams_tree_visibility",INTERNAL_KEY_CHECKED_MODIFICATION:"$ams_checked_modification",INPUT_DATA_OPEN:!0,INPUT_DATA_CLOSED:!1,INTERNAL_DATA_OPEN:!0,INTERNAL_DATA_CLOSED:!1,INPUT_DATA_CHECKED:!0,INPUT_DATA_UNCHECKED:!1,INTERNAL_DATA_LEAF_CHECKED:!0,INTERNAL_DATA_LEAF_UNCHECKED:!1,INTERNAL_DATA_NODE_CHECKED:1,INTERNAL_DATA_NODE_MIXED:0,INTERNAL_DATA_NODE_UNCHECKED:-1,INTERNAL_DATA_NODE_CHECK_UNDEFINED:null,INTERNAL_DATA_VISIBLE:!0,INTERNAL_DATA_INVISIBLE:!1,INTERNAL_DATA_VISIBILITY_UNDEFINED:null,INTERNAL_STATS_CHECKED_LEAFS:"$ams_stats_checked_leafs",INTERNAL_STATS_CHECKED_NODES:"$ams_stats_checked_nodes",INTERNAL_STATS_UNCHECKED_NODES:"$ams_stats_unchecked_nodes",INTERNAL_STATS_TOTAL_LEAFS:"$ams_stats_total_leafs",INTERNAL_STATS_TOTAL_NODES:"$ams_stats_total_nodes",OUTPUT_DATA_TYPE_OBJECTS:"objects",OUTPUT_DATA_TYPE_ARRAYS:"arrays",OUTPUT_DATA_TYPE_OBJECT:"object",OUTPUT_DATA_TYPE_ARRAY:"array",OUTPUT_DATA_TYPE_VALUE:"value",CSS_OPEN:"open",CSS_CLOSED:"closed",CSS_LEAF_CHECKED:"checked",CSS_LEAF_UNCHECKED:"unchecked",CSS_NODE_MIXED:"mixed",CSS_NODE_CHECKED:"checked",CSS_NODE_UNCHECKED:"unchecked",CSS_LEAF:"leaf",CSS_NODE:"node",FIND_LEAFS:"leafs",FIND_LEAFS_MIXED_NODES:"leafs_mixed_nodes",FIND_LEAFS_CHECKED_NODES:"leafs_checked_nodes",FIND_LEAFS_MIXED_CHECKED_NODES:"leafs_mixed_checked_nodes",FIND_MIXED_NODES:"midex_nodes",FIND_CHECKED_NODES:"checked_nodes",FIND_MIXED_CHECKED_NODES:"mixed_checked_nodes"});var angular_multi_select_data_converter=angular.module("angular-multi-select-data-converter",["angular-multi-select-utils","angular-multi-select-constants"]);angular_multi_select_data_converter.factory("angularMultiSelectDataConverter",["angularMultiSelectUtils","angularMultiSelectConstants",function(a,b){var c=function(b){this.amsu=new a,_extends(this,this.amsu.sanitize_ops(b))};return c.prototype.check_prerequisites=function(a){function c(){for(;-1!==e.indexOf(g);)g++;return g}function d(a){if(h!==!1)for(var g=0;g<a.length;g++){var i=a[g];if(-1!==i.constructor.toString().indexOf("Array"))return h=!1;f.ID_PROPERTY in i&&-1===e.indexOf(i[f.ID_PROPERTY])||(i[f.ID_PROPERTY]=c()),e.push(i[f.ID_PROPERTY]),f.OPEN_PROPERTY in i&&i[f.OPEN_PROPERTY]===b.INPUT_DATA_OPEN||(i[f.OPEN_PROPERTY]=b.INPUT_DATA_CLOSED),f.CHILDREN_PROPERTY in i&&(!Array.isArray(i[f.CHILDREN_PROPERTY])||0===i[f.CHILDREN_PROPERTY].length)&&delete i[f.CHILDREN_PROPERTY],f.CHILDREN_PROPERTY in i&&delete i[f.CHECKED_PROPERTY],f.CHECKED_PROPERTY in i&&i[f.CHECKED_PROPERTY]!==b.INPUT_DATA_CHECKED&&(i[f.CHECKED_PROPERTY]=b.INPUT_DATA_UNCHECKED),f.CHILDREN_PROPERTY in i||f.CHECKED_PROPERTY in i||(i[f.CHECKED_PROPERTY]=b.INPUT_DATA_UNCHECKED),f.CHILDREN_PROPERTY in i&&d(i[f.CHILDREN_PROPERTY])}}if(this.DEBUG===!0&&console.time(this.NAME+" -> check_prerequisites"),!Array.isArray(a))return!1;var e=[],f=this,g=1,h=!0;return d(a),this.DEBUG===!0&&console.timeEnd(this.NAME+" -> check_prerequisites"),h?a:h},c.prototype.to_internal=function(a){function c(a,d){for(var e=0;e<a.length;e++){f=a[e];var j=angular.copy(f);delete j[h.CHECKED_PROPERTY],delete j[h.CHILDREN_PROPERTY],h.CHECKED_PROPERTY in f&&"boolean"==typeof f[h.CHECKED_PROPERTY]?j[h.CHECKED_PROPERTY]=f[h.CHECKED_PROPERTY]:j[h.CHECKED_PROPERTY]=b.INTERNAL_DATA_NODE_CHECK_UNDEFINED,j[b.INTERNAL_KEY_LEVEL]=d,j[b.INTERNAL_KEY_ORDER]=g++,j[b.INTERNAL_KEY_PARENTS_ID]=[],j[b.INTERNAL_KEY_CHILDREN_LEAFS]=0,j[b.INTERNAL_KEY_CHILDREN_NODES]=0,j[b.INTERNAL_KEY_CHECKED_CHILDREN]=0,j[b.INTERNAL_KEY_TREE_VISIBILITY]=b.INTERNAL_DATA_VISIBILITY_UNDEFINED,j[b.INTERNAL_KEY_CHECKED_MODIFICATION]=0,i.push(j),h.CHILDREN_PROPERTY in f&&c(f[h.CHILDREN_PROPERTY],d+1)}}this.DEBUG===!0&&console.time(this.NAME+" -> to_internal");var d,e,f,g=1,h=this,i=[];c(a,0);var j=new Date;for(d=0;d<i.length;d++)if(f=i[d],f[b.INTERNAL_KEY_CHECKED_MODIFICATION]=j.getTime(),0!==f[b.INTERNAL_KEY_LEVEL]){var k=[],l=f[b.INTERNAL_KEY_LEVEL];for(e=d;e>0;e--){var m=i[e];if(!(m[b.INTERNAL_KEY_LEVEL]>=l)&&(l=m[b.INTERNAL_KEY_LEVEL],k.push(m[this.ID_PROPERTY]),0===m[b.INTERNAL_KEY_LEVEL]))break}f[b.INTERNAL_KEY_PARENTS_ID]=k.reverse()}for(d=0;d<i.length;d++)if(f=i[d],0===f[b.INTERNAL_KEY_LEVEL]&&(f[b.INTERNAL_KEY_TREE_VISIBILITY]=b.INTERNAL_DATA_VISIBLE),"boolean"!=typeof f[this.CHECKED_PROPERTY]){var n=0,o=0,p=0;for(e=d+1;e<i.length;e++){var q=i[e];if(f[b.INTERNAL_KEY_LEVEL]===q[b.INTERNAL_KEY_LEVEL]-1&&(q[b.INTERNAL_KEY_TREE_VISIBILITY]=f[this.OPEN_PROPERTY]),f[b.INTERNAL_KEY_LEVEL]>=q[b.INTERNAL_KEY_LEVEL])break;q[this.CHECKED_PROPERTY]===b.INTERNAL_DATA_LEAF_CHECKED?(n++,f[b.INTERNAL_KEY_CHILDREN_LEAFS]++):q[this.CHECKED_PROPERTY]===b.INTERNAL_DATA_LEAF_UNCHECKED?(o++,f[b.INTERNAL_KEY_CHILDREN_LEAFS]++):q[this.CHECKED_PROPERTY]===b.INTERNAL_DATA_NODE_CHECK_UNDEFINED&&(p++,f[b.INTERNAL_KEY_CHILDREN_NODES]++)}f[b.INTERNAL_KEY_CHILDREN_LEAFS]===n?f[this.CHECKED_PROPERTY]=b.INTERNAL_DATA_NODE_CHECKED:f[b.INTERNAL_KEY_CHILDREN_LEAFS]===o?f[this.CHECKED_PROPERTY]=b.INTERNAL_DATA_NODE_UNCHECKED:f[this.CHECKED_PROPERTY]=b.INTERNAL_DATA_NODE_MIXED,f[b.INTERNAL_KEY_CHECKED_CHILDREN]=n}return this.DEBUG===!0&&console.timeEnd(this.NAME+" -> to_internal"),i},c.prototype.to_external=function(a){if(!Array.isArray(a)||0===a.length)return[];this.DEBUG===!0&&console.time(this.NAME+" -> to_external");for(var c=0;c<a.length;c++)delete a[c][b.INTERNAL_KEY_LEVEL],delete a[c][b.INTERNAL_KEY_ORDER],delete a[c][b.INTERNAL_KEY_PARENTS_ID],delete a[c][b.INTERNAL_KEY_CHILDREN_LEAFS],delete a[c][b.INTERNAL_KEY_CHILDREN_NODES],delete a[c][b.INTERNAL_KEY_CHECKED_CHILDREN],delete a[c][b.INTERNAL_KEY_TREE_VISIBILITY],delete a[c][b.INTERNAL_KEY_CHECKED_MODIFICATION],delete a[c].meta,delete a[c].$loki;return this.DEBUG===!0&&console.timeEnd(this.NAME+" -> to_external"),a},c.prototype.to_array_of_objects=function(a,b){if(!Array.isArray(a)||0===a.length)return[];this.DEBUG===!0&&console.time(this.NAME+" -> to_array_of_objects"),void 0===b&&(b=[]);for(var c=[],d=0;d<a.length;d++){var e={},f=a[d];if("object"===("undefined"==typeof f?"undefined":_typeof(f))&&!Array.isArray(f))if(0===b.length)c.push(f);else{for(var g=0;g<b.length;g++)b[g]in f&&(e[b[g]]=f[b[g]]);c.push(e)}}return this.DEBUG===!0&&console.timeEnd(this.NAME+" -> to_array_of_objects"),c},c.prototype.to_array_of_arrays=function(a,b){function c(a){return Object.keys(a).map(function(b){return a[b]})}if(!Array.isArray(a)||0===a.length)return[];this.DEBUG===!0&&console.time(this.NAME+" -> to_array_of_arrays"),void 0===b&&(b=[]);for(var d=[],e=0;e<a.length;e++){var f=[],g=a[e];if("object"===("undefined"==typeof g?"undefined":_typeof(g))&&!Array.isArray(g))if(0===b.length)d.push(c(g));else{for(var h=0;h<b.length;h++)b[h]in g&&f.push(g[b[h]]);d.push(f)}}return this.DEBUG===!0&&console.timeEnd(this.NAME+" -> to_array_of_arrays"),d},c.prototype.to_array=function(a,b){function c(a){return Object.keys(a).map(function(b){return a[b]})}if(!Array.isArray(a)||0===a.length)return[];this.DEBUG===!0&&console.time(this.NAME+" -> to_array"),void 0===b&&(b=[]);var d,e=a[0],f=[];if("object"!==("undefined"==typeof e?"undefined":_typeof(e))||Array.isArray(e));else if(0===b.length){var g=c(e);for(d=0;d<g.length;d++)f.push(g[d])}else for(d=0;d<b.length;d++)b[d]in e&&f.push(e[b[d]]);return this.DEBUG===!0&&console.timeEnd(this.NAME+" -> to_array"),f},c.prototype.to_object=function(a,b){if(!Array.isArray(a)||0===a.length)return{};this.DEBUG===!0&&console.time(this.NAME+" -> to_object"),void 0===b&&(b=[]);var c,d=a[0];if("object"!==("undefined"==typeof d?"undefined":_typeof(d))||Array.isArray(d))c={};else if(0===b.length)c=d;else{for(var e={},f=0;f<b.length;f++)b[f]in d&&(e[b[f]]=d[b[f]]);c=e}return this.DEBUG===!0&&console.timeEnd(this.NAME+" -> to_object"),c},c.prototype.to_value=function(a,b){if(Array.isArray(a)&&0!==a.length){this.DEBUG===!0&&console.time(this.NAME+" -> to_value");var c,d=a[0];if("object"!==("undefined"==typeof d?"undefined":_typeof(d))||Array.isArray(d))c=void 0;else if(void 0===b){var e=Object.keys(d);0===e.length?c=void 0:(b=e[0],c=b in d?d[b]:void 0)}else b=Array.isArray(b)?b[0]:b,c=b in d?d[b]:void 0;return this.DEBUG===!0&&console.timeEnd(this.NAME+" -> to_value"),c}},c}]);var angular_multi_select_engine=angular.module("angular-multi-select-engine",["angular-multi-select-utils","angular-multi-select-constants"]);angular_multi_select_engine.factory("angularMultiSelectEngine",["angularMultiSelectUtils","angularMultiSelectConstants",function(a,b){var c=function(b){this.amsu=new a,_extends(this,this.amsu.sanitize_ops(b)),this.db=new loki,this.on_data_change_fn=null,this.on_visual_change_fn=null};return c.prototype.on_data_change=function(a){var c={skip_internal:!1};a=a||{};for(var d in c)a.hasOwnProperty(d)||(a[d]=c[d]);a.skip_internal===!1&&this.MAX_CHECKED_LEAFS>-1&&this.stats[b.INTERNAL_STATS_CHECKED_LEAFS]>this.MAX_CHECKED_LEAFS&&this.uncheck_first(this.stats[b.INTERNAL_STATS_CHECKED_LEAFS]-this.MAX_CHECKED_LEAFS),"function"==typeof this.on_data_change_fn&&this.on_data_change_fn()},c.prototype.on_visual_change=function(a){var b={skip_internal:!1};a=a||{};for(var c in b)a.hasOwnProperty(c)||(a[c]=b[c]);a.skip_internal===!1,"function"==typeof this.on_visual_change_fn&&this.on_visual_change_fn()},c.prototype.create_collection=function(a){this.DEBUG===!0&&console.time(this.NAME+" -> create_collection"),this.collection=this.db.addCollection(a,{indices:[this.ID_PROPERTY,this.CHECKED_PROPERTY,b.INTERNAL_KEY_LEVEL,b.INTERNAL_KEY_PARENTS_ID,b.INTERNAL_KEY_TREE_VISIBILITY],clone:!0}),this.DEBUG===!0&&console.timeEnd(this.NAME+" -> create_collection")},c.prototype.remove_collection=function(a){this.DEBUG===!0&&console.time(this.NAME+" -> remove_collection"),a=a||this.NAME,this.db.removeCollection(a),this.DEBUG===!0&&console.timeEnd(this.NAME+" -> remove_collection")},c.prototype.insert=function(a){if(this.DEBUG===!0&&console.time(this.NAME+" -> insert"),this.remove_collection(this.NAME),this.create_collection(this.NAME),this.reset_stats(),a=a||[],Array.isArray(a))for(var b=0;b<a.length;b++)this.collection.insert(a[b]),this.update_stats(a[b]);else this.collection.insert(a),this.update_stats(a);this.DEBUG===!0&&console.timeEnd(this.NAME+" -> insert"),this.on_data_change()},c.prototype.get_stats=function(){return this.stats},c.prototype.update_stats=function(a){switch(a[this.CHECKED_PROPERTY]){case b.INTERNAL_DATA_NODE_CHECKED:this.stats[b.INTERNAL_STATS_CHECKED_NODES]++,this.stats[b.INTERNAL_STATS_TOTAL_NODES]++;break;case b.INTERNAL_DATA_NODE_UNCHECKED:this.stats[b.INTERNAL_STATS_UNCHECKED_NODES]++,this.stats[b.INTERNAL_STATS_TOTAL_NODES]++;break;case b.INTERNAL_DATA_NODE_MIXED:this.stats[b.INTERNAL_STATS_TOTAL_NODES]++;break;case b.INTERNAL_DATA_LEAF_CHECKED:this.stats[b.INTERNAL_STATS_CHECKED_LEAFS]++,this.stats[b.INTERNAL_STATS_TOTAL_LEAFS]++;break;case b.INTERNAL_DATA_LEAF_UNCHECKED:this.stats[b.INTERNAL_STATS_TOTAL_LEAFS]++}},c.prototype.reset_stats=function(){var a;this.stats=(a={},_defineProperty(a,b.INTERNAL_STATS_CHECKED_LEAFS,0),_defineProperty(a,b.INTERNAL_STATS_CHECKED_NODES,0),_defineProperty(a,b.INTERNAL_STATS_UNCHECKED_NODES,0),_defineProperty(a,b.INTERNAL_STATS_TOTAL_LEAFS,0),_defineProperty(a,b.INTERNAL_STATS_TOTAL_NODES,0),a)},c.prototype.get_full_tree=function(){this.DEBUG===!0&&console.time(this.NAME+" -> get_full_tree");var a=this.collection.chain().find({}).simplesort(b.INTERNAL_KEY_ORDER,!1).data();return this.DEBUG===!0&&console.time(this.NAME+" -> get_full_tree"),a},c.prototype.get_visible_tree=function(){this.DEBUG===!0&&console.time(this.NAME+" -> get_visible_tree");var a=this.collection.chain().find(_defineProperty({},b.INTERNAL_KEY_TREE_VISIBILITY,b.INTERNAL_DATA_VISIBLE)).simplesort(b.INTERNAL_KEY_ORDER,!1).data();return this.DEBUG===!0&&console.timeEnd(this.NAME+" -> get_visible_tree"),a},c.prototype.get_filtered_tree=function(a){this.DEBUG===!0&&console.time(this.NAME+" -> get_filtered_tree");for(var c=[],d=0;d<a.length;d++){var e=a[d];c.push(_defineProperty({},e.field,{$contains:e.query}))}var f=this.collection.chain().find({$and:c}).simplesort(b.INTERNAL_KEY_ORDER,!1).data();return this.DEBUG===!0&&console.timeEnd(this.NAME+" -> get_filtered_tree"),f},c.prototype.get_checked_tree=function(a){this.DEBUG===!0&&console.time(this.NAME+" -> get_checked_tree");var c;switch(a){case b.FIND_LEAFS:c=[b.INTERNAL_DATA_LEAF_CHECKED];break;case b.FIND_LEAFS_MIXED_NODES:c=[b.INTERNAL_DATA_LEAF_CHECKED,b.INTERNAL_DATA_NODE_MIXED];break;case b.FIND_LEAFS_CHECKED_NODES:c=[b.INTERNAL_DATA_LEAF_CHECKED,b.INTERNAL_DATA_NODE_CHECKED];break;case b.FIND_LEAFS_MIXED_CHECKED_NODES:c=[b.INTERNAL_DATA_LEAF_CHECKED,b.INTERNAL_DATA_NODE_CHECKED,b.INTERNAL_DATA_NODE_MIXED];break;case b.FIND_MIXED_NODES:c=[b.INTERNAL_DATA_NODE_MIXED];break;case b.FIND_CHECKED_NODES:c=[b.INTERNAL_DATA_NODE_CHECKED];break;case b.FIND_MIXED_CHECKED_NODES:c=[b.INTERNAL_DATA_NODE_CHECKED,b.INTERNAL_DATA_NODE_MIXED];break;default:c=[b.INTERNAL_DATA_LEAF_CHECKED]}var d=this.collection.chain().find(_defineProperty({},this.CHECKED_PROPERTY,{$in:c})).simplesort(b.INTERNAL_KEY_ORDER,!1).data();return this.DEBUG===!0&&console.timeEnd(this.NAME+" -> get_checked_tree"),d},c.prototype.toggle_open_node=function(a){0!==a[b.INTERNAL_KEY_CHILDREN_LEAFS]&&(a[this.OPEN_PROPERTY]===b.INTERNAL_DATA_OPEN?this.close_node(a):this.open_node(a),this.on_visual_change())},c.prototype.open_node=function(a){var c=this;this.DEBUG===!0&&console.time(this.NAME+" -> open_node");var d=0;this.collection.chain().find(_defineProperty({},this.ID_PROPERTY,a[this.ID_PROPERTY])).update(function(a){a[c.OPEN_PROPERTY]=b.INTERNAL_DATA_OPEN}),this.collection.chain().find({$and:[_defineProperty({},b.INTERNAL_KEY_PARENTS_ID,{$contains:a[this.ID_PROPERTY]}),_defineProperty({},b.INTERNAL_KEY_LEVEL,{$gte:a[b.INTERNAL_KEY_LEVEL]+1})]}).limit(a[b.INTERNAL_KEY_CHILDREN_LEAFS]+a[b.INTERNAL_KEY_CHILDREN_NODES]).update(function(a){return d>0?void d--:(a[b.INTERNAL_KEY_CHILDREN_LEAFS]>0&&a[c.OPEN_PROPERTY]===b.INTERNAL_DATA_CLOSED&&(d=a[b.INTERNAL_KEY_CHILDREN_LEAFS]+a[b.INTERNAL_KEY_CHILDREN_NODES]),void(a[b.INTERNAL_KEY_TREE_VISIBILITY]=b.INTERNAL_DATA_VISIBLE))}),this.DEBUG===!0&&console.timeEnd(this.NAME+" -> open_node")},c.prototype.close_node=function(a){var c=this;this.DEBUG===!0&&console.time(this.NAME+" -> close_node"),this.collection.chain().find(_defineProperty({},this.ID_PROPERTY,a[this.ID_PROPERTY])).update(function(a){a[c.OPEN_PROPERTY]=b.INTERNAL_DATA_CLOSED}),this.collection.chain().find({$and:[_defineProperty({},b.INTERNAL_KEY_PARENTS_ID,{$contains:a[this.ID_PROPERTY]}),_defineProperty({},b.INTERNAL_KEY_LEVEL,{$gte:a[b.INTERNAL_KEY_LEVEL]+1})]}).limit(a[b.INTERNAL_KEY_CHILDREN_LEAFS]+a[b.INTERNAL_KEY_CHILDREN_NODES]).update(function(a){a[b.INTERNAL_KEY_TREE_VISIBILITY]=b.INTERNAL_DATA_INVISIBLE}),this.DEBUG===!0&&console.timeEnd(this.NAME+" -> close_node")},c.prototype.check_all=function(){var a=this;this.DEBUG===!0&&console.time(this.NAME+" -> check_all"),this.collection.chain().find({}).update(function(c){0===c[b.INTERNAL_KEY_CHILDREN_LEAFS]?c[a.CHECKED_PROPERTY]=b.INTERNAL_DATA_LEAF_CHECKED:(c[a.CHECKED_PROPERTY]=b.INTERNAL_DATA_NODE_CHECKED,c[b.INTERNAL_KEY_CHECKED_CHILDREN]=c[b.INTERNAL_KEY_CHILDREN_LEAFS])}),this.stats[b.INTERNAL_STATS_UNCHECKED_NODES]=0,this.stats[b.INTERNAL_STATS_CHECKED_LEAFS]=this.stats[b.INTERNAL_STATS_TOTAL_LEAFS],this.stats[b.INTERNAL_STATS_CHECKED_NODES]=this.stats[b.INTERNAL_STATS_TOTAL_NODES],this.DEBUG===!0&&console.time(this.NAME+" -> check_all"),this.on_data_change()},c.prototype.uncheck_all=function(){var a=this;this.DEBUG===!0&&console.time(this.NAME+" -> uncheck_all"),this.collection.chain().find({}).update(function(c){0===c[b.INTERNAL_KEY_CHILDREN_LEAFS]?c[a.CHECKED_PROPERTY]=b.INTERNAL_DATA_LEAF_UNCHECKED:(c[a.CHECKED_PROPERTY]=b.INTERNAL_DATA_NODE_UNCHECKED,c[b.INTERNAL_KEY_CHECKED_CHILDREN]=0)}),this.stats[b.INTERNAL_STATS_CHECKED_LEAFS]=0,this.stats[b.INTERNAL_STATS_CHECKED_NODES]=0,this.stats[b.INTERNAL_STATS_UNCHECKED_NODES]=this.stats[b.INTERNAL_STATS_TOTAL_NODES],this.DEBUG===!0&&console.time(this.NAME+" -> uncheck_all"),this.on_data_change()},c.prototype.toggle_check_node=function(a,c){switch(a[this.CHECKED_PROPERTY]){case b.INTERNAL_DATA_NODE_CHECKED:case b.INTERNAL_DATA_LEAF_CHECKED:this.uncheck_node(a,c);break;case b.INTERNAL_DATA_NODE_MIXED:case b.INTERNAL_DATA_NODE_UNCHECKED:case b.INTERNAL_DATA_LEAF_UNCHECKED:this.check_node(a,c)}},c.prototype.check_node_by=function(a){this.DEBUG===!0&&console.time(this.NAME+" -> check_node_by");var c=_slicedToArray(a,2),d=c[0],e=c[1],f=this.collection.findOne({$and:[_defineProperty({},d,e),_defineProperty({},this.CHECKED_PROPERTY,{$nin:[b.INTERNAL_DATA_NODE_CHECKED,b.INTERNAL_DATA_LEAF_CHECKED]})]});null!==f&&this.check_node(f),this.DEBUG===!0&&console.timeEnd(this.NAME+" -> check_node_by")},c.prototype.check_node=function(a,c){var d=this;this.DEBUG===!0&&console.time(this.NAME+" -> check_node");var e={call_on_data_change:!0};c=c||{};for(var f in e)c.hasOwnProperty(f)||(c[f]=e[f]);var g=new Date,h=0,i=a[b.INTERNAL_KEY_CHECKED_CHILDREN];this.collection.chain().find(_defineProperty({},this.ID_PROPERTY,a[this.ID_PROPERTY])).update(function(c){0===a[b.INTERNAL_KEY_CHILDREN_LEAFS]?(d.stats[b.INTERNAL_STATS_CHECKED_LEAFS]++,c[d.CHECKED_PROPERTY]=b.INTERNAL_DATA_LEAF_CHECKED):(c[d.CHECKED_PROPERTY]===b.INTERNAL_DATA_NODE_UNCHECKED&&d.stats[b.INTERNAL_STATS_UNCHECKED_NODES]--,d.stats[b.INTERNAL_STATS_CHECKED_NODES]++,c[d.CHECKED_PROPERTY]=b.INTERNAL_DATA_NODE_CHECKED,c[b.INTERNAL_KEY_CHECKED_CHILDREN]=c[b.INTERNAL_KEY_CHILDREN_LEAFS],h=c[b.INTERNAL_KEY_CHECKED_CHILDREN]-i),c[b.INTERNAL_KEY_CHECKED_MODIFICATION]=g.getTime()}),0===a[b.INTERNAL_KEY_CHILDREN_LEAFS]?this.collection.chain().find(_defineProperty({},this.ID_PROPERTY,{$in:a[b.INTERNAL_KEY_PARENTS_ID]})).simplesort(b.INTERNAL_KEY_ORDER,!0).update(function(a){a[d.CHECKED_PROPERTY]===b.INTERNAL_DATA_NODE_UNCHECKED&&d.stats[b.INTERNAL_STATS_UNCHECKED_NODES]--,a[b.INTERNAL_KEY_CHECKED_CHILDREN]+1===a[b.INTERNAL_KEY_CHILDREN_LEAFS]&&d.stats[b.INTERNAL_STATS_CHECKED_NODES]++,a[b.INTERNAL_KEY_CHECKED_CHILDREN]++,a[b.INTERNAL_KEY_CHECKED_CHILDREN]===a[b.INTERNAL_KEY_CHILDREN_LEAFS]?a[d.CHECKED_PROPERTY]=b.INTERNAL_DATA_NODE_CHECKED:a[d.CHECKED_PROPERTY]=b.INTERNAL_DATA_NODE_MIXED,a[b.INTERNAL_KEY_CHECKED_MODIFICATION]=g.getTime()}):(this.collection.chain().find({$and:[_defineProperty({},b.INTERNAL_KEY_PARENTS_ID,{$contains:a[this.ID_PROPERTY]}),_defineProperty({},b.INTERNAL_KEY_LEVEL,{$gte:a[b.INTERNAL_KEY_LEVEL]+1}),_defineProperty({},this.CHECKED_PROPERTY,{$in:[b.INTERNAL_DATA_NODE_MIXED,b.INTERNAL_DATA_NODE_UNCHECKED,b.INTERNAL_DATA_LEAF_UNCHECKED]})]}).simplesort(b.INTERNAL_KEY_ORDER,!1).update(function(a){0===a[b.INTERNAL_KEY_CHILDREN_LEAFS]?(d.stats[b.INTERNAL_STATS_CHECKED_LEAFS]++,a[d.CHECKED_PROPERTY]=b.INTERNAL_DATA_LEAF_CHECKED):(d.stats[b.INTERNAL_STATS_CHECKED_NODES]++,a[d.CHECKED_PROPERTY]===b.INTERNAL_DATA_NODE_UNCHECKED&&d.stats[b.INTERNAL_STATS_UNCHECKED_NODES]--,a[d.CHECKED_PROPERTY]=b.INTERNAL_DATA_NODE_CHECKED,a[b.INTERNAL_KEY_CHECKED_CHILDREN]=a[b.INTERNAL_KEY_CHILDREN_LEAFS]),a[b.INTERNAL_KEY_CHECKED_MODIFICATION]=g.getTime()}),this.collection.chain().find(_defineProperty({},this.ID_PROPERTY,{$in:a[b.INTERNAL_KEY_PARENTS_ID]})).simplesort(b.INTERNAL_KEY_ORDER,!0).update(function(a){a[d.CHECKED_PROPERTY]===b.INTERNAL_DATA_NODE_UNCHECKED&&d.stats[b.INTERNAL_STATS_UNCHECKED_NODES]--,a[b.INTERNAL_KEY_CHECKED_CHILDREN]+h===a[b.INTERNAL_KEY_CHILDREN_LEAFS]&&d.stats[b.INTERNAL_STATS_CHECKED_NODES]++,a[b.INTERNAL_KEY_CHECKED_CHILDREN]+=h,a[b.INTERNAL_KEY_CHECKED_CHILDREN]===a[b.INTERNAL_KEY_CHILDREN_LEAFS]?a[d.CHECKED_PROPERTY]=b.INTERNAL_DATA_NODE_CHECKED:a[d.CHECKED_PROPERTY]=b.INTERNAL_DATA_NODE_MIXED,a[b.INTERNAL_KEY_CHECKED_MODIFICATION]=g.getTime()})),this.DEBUG===!0&&console.timeEnd(this.NAME+" -> check_node"),c.call_on_data_change&&this.on_data_change()},c.prototype.uncheck_node=function(a,c){var d=this;this.DEBUG===!0&&console.time(this.NAME+" -> uncheck_node");var e={call_on_data_change:!0};c=c||{};for(var f in e)c.hasOwnProperty(f)||(c[f]=e[f]);var g=new Date,h=0,i=a[b.INTERNAL_KEY_CHECKED_CHILDREN];this.collection.chain().find(_defineProperty({},this.ID_PROPERTY,a[this.ID_PROPERTY])).update(function(c){0===a[b.INTERNAL_KEY_CHILDREN_LEAFS]?(d.stats[b.INTERNAL_STATS_CHECKED_LEAFS]--,c[d.CHECKED_PROPERTY]=b.INTERNAL_DATA_LEAF_UNCHECKED):(d.stats[b.INTERNAL_STATS_CHECKED_NODES]--,d.stats[b.INTERNAL_STATS_UNCHECKED_NODES]++,c[d.CHECKED_PROPERTY]=b.INTERNAL_DATA_NODE_UNCHECKED,c[b.INTERNAL_KEY_CHECKED_CHILDREN]=0,h=i-c[b.INTERNAL_KEY_CHECKED_CHILDREN]),c[b.INTERNAL_KEY_CHECKED_MODIFICATION]=g.getTime()}),0===a[b.INTERNAL_KEY_CHILDREN_LEAFS]?this.collection.chain().find(_defineProperty({},this.ID_PROPERTY,{$in:a[b.INTERNAL_KEY_PARENTS_ID]})).simplesort(b.INTERNAL_KEY_ORDER,!0).update(function(a){a[d.CHECKED_PROPERTY]===b.INTERNAL_DATA_NODE_CHECKED&&d.stats[b.INTERNAL_STATS_CHECKED_NODES]--,a[b.INTERNAL_KEY_CHECKED_CHILDREN]-1===0&&d.stats[b.INTERNAL_STATS_UNCHECKED_NODES]++,a[b.INTERNAL_KEY_CHECKED_CHILDREN]--,0===a[b.INTERNAL_KEY_CHECKED_CHILDREN]?a[d.CHECKED_PROPERTY]=b.INTERNAL_DATA_NODE_UNCHECKED:a[d.CHECKED_PROPERTY]=b.INTERNAL_DATA_NODE_MIXED,a[b.INTERNAL_KEY_CHECKED_MODIFICATION]=g.getTime()}):(this.collection.chain().find({$and:[_defineProperty({},b.INTERNAL_KEY_PARENTS_ID,{$contains:a[this.ID_PROPERTY]}),_defineProperty({},b.INTERNAL_KEY_LEVEL,{$gte:a[b.INTERNAL_KEY_LEVEL]+1}),_defineProperty({},this.CHECKED_PROPERTY,{$in:[b.INTERNAL_DATA_NODE_MIXED,b.INTERNAL_DATA_NODE_CHECKED,b.INTERNAL_DATA_LEAF_CHECKED]})]}).simplesort(b.INTERNAL_KEY_ORDER,!1).update(function(a){0===a[b.INTERNAL_KEY_CHILDREN_LEAFS]?(d.stats[b.INTERNAL_STATS_CHECKED_LEAFS]--,a[d.CHECKED_PROPERTY]=b.INTERNAL_DATA_LEAF_UNCHECKED):(d.stats[b.INTERNAL_STATS_UNCHECKED_NODES]++,a[d.CHECKED_PROPERTY]===b.INTERNAL_DATA_NODE_CHECKED&&d.stats[b.INTERNAL_STATS_CHECKED_NODES]--,a[d.CHECKED_PROPERTY]=b.INTERNAL_DATA_NODE_UNCHECKED,a[b.INTERNAL_KEY_CHECKED_CHILDREN]=0),a[b.INTERNAL_KEY_CHECKED_MODIFICATION]=g.getTime()}),this.collection.chain().find(_defineProperty({},this.ID_PROPERTY,{$in:a[b.INTERNAL_KEY_PARENTS_ID]})).simplesort(b.INTERNAL_KEY_ORDER,!0).update(function(a){a[d.CHECKED_PROPERTY]===b.INTERNAL_DATA_NODE_CHECKED&&d.stats[b.INTERNAL_STATS_CHECKED_NODES]--,a[b.INTERNAL_KEY_CHECKED_CHILDREN]-h===0&&d.stats[b.INTERNAL_STATS_UNCHECKED_NODES]++,a[b.INTERNAL_KEY_CHECKED_CHILDREN]-=h,0===a[b.INTERNAL_KEY_CHECKED_CHILDREN]?a[d.CHECKED_PROPERTY]=b.INTERNAL_DATA_NODE_UNCHECKED:a[d.CHECKED_PROPERTY]=b.INTERNAL_DATA_NODE_MIXED,a[b.INTERNAL_KEY_CHECKED_MODIFICATION]=g.getTime()})),this.DEBUG===!0&&console.timeEnd(this.NAME+" -> uncheck_node"),c.call_on_data_change&&this.on_data_change()},c.prototype.uncheck_first=function(a){this.DEBUG===!0&&console.time(this.NAME+" -> uncheck_first"),a=a||1;for(var c=this.collection.chain().find({$and:[_defineProperty({},this.CHECKED_PROPERTY,b.INTERNAL_DATA_LEAF_CHECKED),_defineProperty({},b.INTERNAL_KEY_CHILDREN_LEAFS,0)]}).sort(function(a,c){var d=a[b.INTERNAL_KEY_CHECKED_MODIFICATION]-c[b.INTERNAL_KEY_CHECKED_MODIFICATION];return 0===d?a[b.INTERNAL_KEY_ORDER]-c[b.INTERNAL_KEY_ORDER]:d}).limit(a).data(),d=0;d<c.length;d++)this.toggle_check_node(c[d],{call_on_data_change:!1});this.DEBUG===!0&&console.timeEnd(this.NAME+" -> uncheck_first")},c}]);var angular_multi_select_styles_helper=angular.module("angular-multi-select-styles-helper",["angular-multi-select-utils","angular-multi-select-constants"]);angular_multi_select_styles_helper.run([function(){for(var a=angular.element("<style>"),b=10,c=20,d=document.styleSheets,e=0;e<d.length;e++){var f=d[e];if(f.href&&-1!==f.href.indexOf("angular-multi-select")){var g=f.cssRules;for(e=0;e<g.length;e++){var h=g[e];switch(h.selectorText){case".ams-item .check":b=parseInt(h.style.width);break;case".ams-item-level-0":c=parseInt(h.style.paddingLeft)}}}}var i="";for(e=1;20>e;e++)i+=".ams-item-level-"+e+" { padding-left: "+(e+1)*c+"px; }";a.text(".ams-item { padding-right: "+(b+10)+"px; } "+i),angular.element(document.getElementsByTagName("head")).append(a)}]),angular_multi_select_styles_helper.factory("angularMultiSelectStylesHelper",["$sce","$interpolate","angularMultiSelectUtils","angularMultiSelectConstants",function(a,b,c,d){var e=function(a,e){this.amsu=new c,_extends(this,this.amsu.sanitize_ops(a)),this.START_REPLACE_SYMBOL_REGEX=/<\[/g,this.END_REPLACE_SYMBOL_REGEX=/]>/g,this.START_INTERPOLATE_SYMBOL=b.startSymbol(),this.END_INTERPOLATE_SYMBOL=b.endSymbol(),this.START_REPLACE_SYMBOL_ALTERNATIVE_REGEX=/<#/g,this.END_REPLACE_SYMBOL_ALTERNATIVE_REGEX=/#>/g,this.START_INTERPOLATE_SYMBOL_ALTERNATIVE=b.startSymbol(),this.END_INTERPOLATE_SYMBOL_ALTERNATIVE=b.endSymbol(),this.START_REPLACE_SYMBOL_ALTERNATIVE_REPETITIVE_REGEX=/<#/g,this.END_REPLACE_SYMBOL_ALTERNATIVE_REPETITIVE_REGEX=/#>/g,this.START_INTERPOLATE_SYMBOL_ALTERNATIVE_REPETITIVE="<["+b.startSymbol(),this.END_INTERPOLATE_SYMBOL_ALTERNATIVE_REPETITIVE=b.endSymbol()+"]>",this.dropdown_repr_attr=e.dropdownLabel||"",this.dropdown_repr=this.interpolate_alternative(this.dropdown_repr_attr)({angularMultiSelectConstants:d}),this.dropdown_repr=this.interpolate(this.dropdown_repr),this.node_repr_attr=e.nodeLabel||"",this.node_repr=this.interpolate_alternative_repetitive(this.node_repr_attr)({angularMultiSelectConstants:d}),this.node_repr=this.interpolate(this.node_repr),this.leaf_repr_attr=e.leafLabel||"",this.leaf_repr=this.interpolate_alternative_repetitive(this.leaf_repr_attr)({angularMultiSelectConstants:d}),this.leaf_repr=this.interpolate(this.leaf_repr)};return e.prototype.get_level_class=function(a){return"ams-item-level-"+a[d.INTERNAL_KEY_LEVEL]},e.prototype.get_open_class=function(a){return 0===a[d.INTERNAL_KEY_CHILDREN_LEAFS]?"":a[this.OPEN_PROPERTY]===!0?d.CSS_OPEN:d.CSS_CLOSED},e.prototype.get_checked_class=function(a){return"boolean"==typeof a[this.CHECKED_PROPERTY]?a[this.CHECKED_PROPERTY]?d.CSS_LEAF_CHECKED:d.CSS_LEAF_UNCHECKED:a[this.CHECKED_PROPERTY]<0?d.CSS_NODE_UNCHECKED:a[this.CHECKED_PROPERTY]>0?d.CSS_NODE_CHECKED:d.CSS_NODE_MIXED},e.prototype.get_type_class=function(a){return 0===a[d.INTERNAL_KEY_CHILDREN_LEAFS]?d.CSS_LEAF:d.CSS_NODE},e.prototype.interpolate=function(a){return a=a.replace(this.START_REPLACE_SYMBOL_REGEX,this.START_INTERPOLATE_SYMBOL).replace(this.END_REPLACE_SYMBOL_REGEX,this.END_INTERPOLATE_SYMBOL),b(a)},e.prototype.interpolate_alternative=function(a){return a=a.replace(this.START_REPLACE_SYMBOL_ALTERNATIVE_REGEX,this.START_INTERPOLATE_SYMBOL_ALTERNATIVE).replace(this.END_REPLACE_SYMBOL_ALTERNATIVE_REGEX,this.END_INTERPOLATE_SYMBOL_ALTERNATIVE),b(a)},e.prototype.interpolate_alternative_repetitive=function(a){return a=a.replace(this.START_REPLACE_SYMBOL_ALTERNATIVE_REPETITIVE_REGEX,this.START_INTERPOLATE_SYMBOL_ALTERNATIVE_REPETITIVE).replace(this.END_REPLACE_SYMBOL_ALTERNATIVE_REPETITIVE_REGEX,this.END_INTERPOLATE_SYMBOL_ALTERNATIVE_REPETITIVE),b(a)},e.prototype.create_dropdown_label=function(b){var c=this.dropdown_repr(b);return a.trustAsHtml(c)},e.prototype.create_label=function(b){var c;return c=0===b[d.INTERNAL_KEY_CHILDREN_LEAFS]?this.leaf_repr(b):this.node_repr(b),a.trustAsHtml(c)},e.prototype.transform_position=function(a){var b=a[0],c=b.getElementsByClassName("ams-container")[0],d=0,e=0,f=b.getBoundingClientRect(),g=c.getBoundingClientRect();document.documentElement.clientWidth-(f.left+f.width)<g.width&&f.left+f.width>=g.width&&(d-=g.width-f.width),document.documentElement.clientHeight-(f.top+f.height)<g.height&&f.top>=g.height&&(e-=g.height+f.height),(0>d||0>e)&&(c.style.transform="translate("+d+"px, "+e+"px)")},e}]);var angular_multi_select_utils=angular.module("angular-multi-select-utils",["angular-multi-select-constants"]);angular_multi_select_utils.factory("angularMultiSelectUtils",["angularMultiSelectConstants",function(a){var b=function(){};return b.prototype.sanitize_ops=function(b){return b=b||{},{DEBUG:b.DEBUG||!1,NAME:b.NAME||"angular-multi-select-"+Math.round(Date.now()/1e3)+Math.random(),MAX_CHECKED_LEAFS:b.MAX_CHECKED_LEAFS||-1,ID_PROPERTY:b.ID_PROPERTY||a.ID_PROPERTY,OPEN_PROPERTY:b.OPEN_PROPERTY||a.OPEN_PROPERTY,CHECKED_PROPERTY:b.CHECKED_PROPERTY||a.CHECKED_PROPERTY,CHILDREN_PROPERTY:b.CHILDREN_PROPERTY||a.CHILDREN_PROPERTY}},b.prototype.array_from_attr=function(a){return"string"==typeof a?a.split(",").map(function(a){return a.replace(/^\s+|\s+$/g,"")}):a},b.prototype.element_belongs_to_directive=function(a,b){for(var c=!1,d=angular.element(a).parent();d.length>0;){if(d.attr("name")===b){c=!0;break}d=d.parent()}return c},b.prototype.prevent_scroll_bubbling=function(a){a.addEventListener("mousewheel",function(b){a.clientHeight+a.scrollTop+b.deltaY>=a.scrollHeight?(b.preventDefault(),a.scrollTop=a.scrollHeight):a.scrollTop+b.deltaY<=0&&(b.preventDefault(),a.scrollTop=0)},!1)},b.prototype.process_kb_input=function(a,b){var c=!0,d=a.keyCode?a.keyCode:a.which;switch(d){case 27:b.open=!1;break;case 32:var e=b.items[b.focused_index];void 0!==e&&(b.amse.toggle_open_node(e),a.preventDefault());break;case 38:b.focused_index=-1===b.focused_index?b.items.length-1:b.focused_index-1,c=!1;break;case 40:b.focused_index=b.focused_index+1>b.items.length?0:b.focused_index+1,c=!1;break;default:return}return b.$apply(),c},b.prototype.scroll_to_item=function(a){var b=a[0].getElementsByClassName("ams-item-focused")[0];if(void 0!==b){var c=a[0].getElementsByClassName("ams-items")[0];c.scrollTop=b.offsetTop+b.offsetHeight-c.offsetHeight}},b}]);var angular_multi_select=angular.module("angular-multi-select",["angular-multi-select-utils","angular-multi-select-engine","angular-multi-select-constants","angular-multi-select-styles-helper","angular-multi-select-data-converter"]);angular_multi_select.directive("angularMultiSelect",["$http","$compile","$timeout","$templateCache","angularMultiSelectUtils","angularMultiSelectEngine","angularMultiSelectConstants","angularMultiSelectStylesHelper","angularMultiSelectDataConverter",function(a,b,c,d,e,f,g,h,i){return{restrict:"AE",scope:{inputModel:"=",outputModel:"="},link:function(j,k,l){var m=d.get("angular-multi-select.tpl"),n=b(m)(j);k.append(n);var o={},p=new e;j.ops={DEBUG:"true"===l.debug,NAME:l.name,MAX_CHECKED_LEAFS:parseInt(l.maxCheckedLeafs),ID_PROPERTY:l.idProperty,OPEN_PROPERTY:l.openProperty,CHECKED_PROPERTY:l.checkedProperty,CHILDREN_PROPERTY:l.childrenProperty},j.ops=p.sanitize_ops(j.ops),k.attr("name",j.ops.NAME),o.do_not_check_data="true"===l.doNotCheckData,o.do_not_convert_data="true"===l.doNotConvertData,o.output_keys=p.array_from_attr(l.outputKeys),o.output_type=void 0===l.outputType?"objects":l.outputType,
o.output_filter=void 0===l.outputFilter?g.FIND_LEAFS:l.outputFilter,j.search_field=void 0===l.searchField?null:l.searchField,o.preselect=p.array_from_attr(l.preselect),j.hide_helpers=p.array_from_attr(l.hideHelpers)||[];var q=new f(j.ops),r=new h(j.ops,l),s=new i(j.ops);j.amse=q,j.amssh=r,j.open=!1,j.onclick_listener=function(a){a.target&&(p.element_belongs_to_directive(a.target,j.ops.NAME)||(j.open=!1,j.$apply()))},document.addEventListener("click",j.onclick_listener),j.$watch("open",function(a,b){a===!0&&c(function(){r.transform_position(k)})}),p.prevent_scroll_bubbling(k[0].getElementsByClassName("ams-items")[0]),j.focused_index=-1,j.onkeypress_listener=function(a){if(j.open!==!1){var b=p.process_kb_input(a,j);b||p.scroll_to_item(k)}},document.addEventListener("keydown",j.onkeypress_listener),j.reset_model=null,j.reset=function(){q.insert(j.reset_model),void 0!==o.preselect&&q.check_node_by(o.preselect),j.items=q.get_visible_tree()},j.search="",o.search_promise=null,j.search_spinner_visible=!1,j.$watch("search",function(a,b){if((a!==b||""!==a)&&null!==j.search_field){if(""===a)return null!==o.search_promise&&c.cancel(o.search_promise),j.items=q.get_visible_tree(),void(j.search_spinner_visible=!1);null!==o.search_promise&&c.cancel(o.search_promise),j.search_spinner_visible=!0,o.search_promise=c(function(a){var b=[];b.push({field:j.search_field,query:a}),j.items=q.get_filtered_tree(b),j.search_spinner_visible=!1},1500,!0,a)}}),q.on_data_change_fn=function(){if(j.stats=q.get_stats(),j.items=q.get_visible_tree(),void 0!==j.outputModel){var a=q.get_checked_tree(o.output_filter),b=j.ops.DEBUG?a:s.to_external(a);switch(o.output_type){case g.OUTPUT_DATA_TYPE_OBJECTS:b=s.to_array_of_objects(b,o.output_keys);break;case g.OUTPUT_DATA_TYPE_ARRAYS:b=s.to_array_of_arrays(b,o.output_keys);break;case g.OUTPUT_DATA_TYPE_OBJECT:b=s.to_object(b,o.output_keys);break;case g.OUTPUT_DATA_TYPE_ARRAY:b=s.to_array(b,o.output_keys);break;case g.OUTPUT_DATA_TYPE_VALUE:b=s.to_value(b,o.output_keys)}j.outputModel=b}},q.on_visual_change_fn=function(){j.items=q.get_visible_tree()},o.init=function(a){if(Array.isArray(a)){var b=o.do_not_check_data?a:s.check_prerequisites(a),c=o.do_not_convert_data?b:s.to_internal(b);null===j.reset_model&&(j.reset_model=c),q.insert(c),void 0!==o.preselect&&q.check_node_by(o.preselect)}},j.$watch("inputModel",function(b,c){if("string"==typeof b)try{o.init(JSON.parse(b))}catch(d){a.get(b).then(function(a){o.init(a.data)})}else o.init(b)}),j.$on("$destroy",function(){q.remove_collection(j.ops.NAME),document.removeEventListener("click",j.onclick_listener),document.removeEventListener("keydown",j.onkeypress_listener)})}}}]);var angular_multi_select=angular.module("angular-multi-select");angular_multi_select.run(["$templateCache",function(a){a.put("angular-multi-select.tpl",'\n\n		<div class="ams-button" ng-click="open = !open">\n			<div class="ams-button-text" ng-bind-html="amssh.create_dropdown_label(stats)"></div>\n			<div class="ams-caret"></div>\n		</div>\n\n		<div class="ams-container ng-cloak" ng-show="open">\n\n			<div class="ams-helpers">\n				<div class="selects">\n					<button class="all ams-btn" type="button" accesskey="a" ng-click="amse.check_all()" ng-hide="hide_helpers.indexOf(\'check_all\') > -1">{{ \'CHECK_ALL\' | translate }}</button>\n					<button class="none ams-btn" type="button" accesskey="n" ng-click="amse.uncheck_all()" ng-hide="hide_helpers.indexOf(\'check_none\') > -1">{{ \'CHECK_NONE\' | translate }}</button>\n				</div>\n\n				<div class="resets">\n					<button class="reset ams-btn" type="button" accesskey="r" ng-click="reset()" ng-hide="hide_helpers.indexOf(\'reset\') > -1">{{ \'RESET\' | translate }}</button>\n				</div>\n			</div>\n\n			<div class="ams-search" ng-show="search_field !== null">\n				<input class="ams-search-field" type="text" name="ams-search-field" value="" placeholder="{{ \'SEARCH\' | translate }}" ng-model="search" autofocus>\n				<div class="ams-spinner" ng-show="search_spinner_visible"></div>\n				<button class="clear ams-btn" type="button" accesskey="c" name="clear" title="{{ \'CLEAR\' | translate }}" ng-click="search = \'\'"></button>\n			</div>\n\n			<div class="ams-items">\n				<div\n					ng-repeat="item in items track by item[ops.ID_PROPERTY]"\n					class="ams-item {{ amssh.get_level_class(item) }} {{ amssh.get_type_class(item) }} {{ amssh.get_open_class(item) }} {{ $index === focused_index ? \'ams-item-focused\' : \'\' }}"\n				>\n					<!-- Caret -->\n					<div\n						class="ams-caret {{ amssh.get_open_class(item) }}"\n						ng-click="amse.toggle_open_node(item)"\n					></div>\n\n					<!-- Text of the element -->\n					<div class="ams-item-text" ng-bind-html="amssh.create_label(item)"></div>\n\n					<!-- Check holder -->\n					<div\n						class="check {{ amssh.get_checked_class(item) }}"\n						ng-click="amse.toggle_check_node(item)"\n					>\n					</div>\n				</div>\n			</div>\n\n		</div>\n\n	')}]);var angular_multi_select=angular.module("angular-multi-select");angular_multi_select.filter("translate",["angularMultiSelectI18n",function(a){return function(b){return a.translate(b)}}]);var angular_multi_select=angular.module("angular-multi-select");angular_multi_select.provider("angularMultiSelectI18n",function(){function a(a){return f[a]}function b(a,b){f[a]=b}function c(a){e=a}function d(){function a(a){return f[e][a]||f.en[a]}return{translate:a}}var e="en",f={en:{CHECK_ALL:"Check all",CHECK_NONE:"Uncheck all",RESET:"Reset",SEARCH:"Search...",CLEAR:"Clear"}};return{getTranslation:a,createTranslation:b,setLang:c,$get:d}});
//# sourceMappingURL=angular-multi-select.min.js.map