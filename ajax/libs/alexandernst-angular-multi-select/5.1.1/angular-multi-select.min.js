/*! angular-multi-select 5.1.1 */
var angular_multi_select=angular.module("angular-multi-select",["ng","angular.filter"]);angular_multi_select.directive("angularMultiSelect",["$rootScope","$sce","$timeout","$filter","$interpolate",function(a,b,c,d,e){"use strict";return{restrict:"AE",scope:{inputModel:"=",outputModel:"=",isDisabled:"=",onClear:"&",onClose:"&",onSearchChange:"&",onItemClick:"&",onOpen:"&",onReset:"&",onSelectAll:"&",onSelectNone:"&",translation:"="},templateUrl:"angular-multi-select.htm",link:function(f,g,h){h.idProperty=h.idProperty||"angular-multi-select-id",h.selectionMode=h.selectionMode||"multi",h.selectionMode=h.selectionMode.toLowerCase(),h.helperElements=h.helperElements||"reset filter",h.searchProperty=h.searchProperty||"",h.hiddenProperty=h.hiddenProperty||"",h.minSearchLength=parseInt(h.minSearchLength,10)||3,f._shadowModel=[],f.filteredModel=[],f.searchInput={value:""},f.kbFocus=[],f.kbFocusIndex=null,f.visible=!1,f.buttonLabel="",f.tickProperty=h.tickProperty,f.idProperty=h.idProperty,f.groupProperty=h.groupProperty,f.itemLabel=g.attr(h.$attr.itemLabel),f._interpolatedItemLabel=e(f.itemLabel),f.hiddenProperty=h.hiddenProperty,f.icon={selectAll:"&#10003;",selectNone:"&times;",reset:"&#8630;",tickMark:b.trustAsHtml("&#10003;")},f._trans={selectAll:"Select all",selectNone:"Select none",reset:"Reset",search:"Search..."},angular.extend(f._trans,f.translation),f.lang={selectAll:b.trustAsHtml(f.icon.selectAll+"&nbsp;&nbsp;"+f._trans.selectAll),selectNone:b.trustAsHtml(f.icon.selectNone+"&nbsp;&nbsp;"+f._trans.selectNone),reset:b.trustAsHtml(f.icon.reset+"&nbsp;&nbsp;"+f._trans.reset),search:f._trans.search},f.helperStatus={all:-1!==h.helperElements.search(new RegExp(/\ball\b/))?!0:-1!==h.helperElements.search(new RegExp(/\bnoall\b/))?!1:"multi"===h.selectionMode,none:-1!==h.helperElements.search(new RegExp(/\bnone\b/))?!0:-1!==h.helperElements.search(new RegExp(/\bnonone\b/))?!1:"multi"===h.selectionMode,reset:-1!==h.helperElements.search(new RegExp(/\breset\b/))?!0:-1===h.helperElements.search(new RegExp(/\bnoreset\b/)),filter:-1!==h.helperElements.search(new RegExp(/\bfilter\b/))?!0:-1===h.helperElements.search(new RegExp(/\bnofilter\b/))},f.not=function(a){return function(b){return!a(b)}},f._walk=function(a,b,c){if(angular.isArray(a)){var d=[];return angular.forEach(a,function(a){var e=f._walk(a,b,c);null!==e&&d.push(e)}),d.length>0?d:null}if(angular.isObject(a)){c=c||function(){return!0};var e=c(a);if(a.hasOwnProperty(b)&&angular.isArray(a[b])){var g=[];angular.forEach(a[b],function(a){var d=f._walk(a,b,c);null!==d&&g.push(d)}),g.length!==a[b].length&&(a[b]=g),e=g.length>0}return e?a:null}},f._syncModels=function(a,b){f._walk(b,h.groupProperty,function(b){return f._walk(a,h.groupProperty,function(a){return a[h.idProperty]===b[h.idProperty]&&(a[h.tickProperty]=b[h.tickProperty]),!0}),!0})},f._getParent=function(a,b){var c=null,d=!1,e=null;return f._walk(a,h.groupProperty,function(a){return d===!0?!0:(f._hasChildren(a,!1)>0&&a[h.idProperty]!==b[h.idProperty]&&(e=a),a[h.idProperty]===b[h.idProperty]&&(c=e,d=!0),!0)}),c},f._getLeafs=function(a){var b=[];return f._walk(a,h.groupProperty,function(a){return 0===f._hasChildren(a,!1)&&b.push(a),!0}),b},f._getNodes=function(a){var b=[];return f._walk(a,h.groupProperty,function(a){return f._hasChildren(a,!1)>0&&b.push(a),!0}),b},f._createLabel=function(a){var c=angular.extend({},f.$parent,a),d=f._interpolatedItemLabel(c);return b.trustAsHtml(d)},f._hasChildren=function(a,b){if(b=b||!1,b===!1&&a.hasOwnProperty(h.groupProperty)&&angular.isArray(a[h.groupProperty])&&a[h.groupProperty].length>0)return 1;var c=-1;return f._walk(a,h.groupProperty,function(){return c++,!0}),c},f._isHidden=function(a){return a[h.hiddenProperty]===!0},f._isChecked=function(a){return a[h.tickProperty]===!0},f._areAllChecked=function(a){var b=0,c=0;return f._walk(a,h.groupProperty,function(a){return 0===f._hasChildren(a,!1)&&(f._isChecked(a)&&b++,c++),!0}),c===b?b:b>0?-b:0},f._enforceProps=function(a){var b=[];f._walk(a,h.groupProperty,function(a){return(a.hasOwnProperty(h.idProperty)===!1||-1!==b.indexOf(a[h.idProperty]))&&(a[h.idProperty]=Math.floor(1e8*Math.random()+1)),b.push(a[h.idProperty]),a[h.tickProperty]=a[h.tickProperty]||!1,a[h.hiddenProperty]=a[h.hiddenProperty]||!1,!0})},f._enforceChecks=function(a){var b=0,c=f._getLeafs(a),d=!1;if(angular.forEach(c,function(c){if(d!==!0){var e=f._isChecked(c);e&&b++,b>1&&"single"===h.selectionMode&&(d=!0,f._uncheckAll(a))}}),d!==!0){var e=f._getNodes(a);angular.forEach(e,function(a){a[h.tickProperty]=0!==f._areAllChecked(a)})}},f._flipCheck=function(a){if(f._hasChildren(a)>0){var b=0===Math.abs(f._areAllChecked(a));f._walk(a,h.groupProperty,function(a){return a[h.tickProperty]=b,!0})}else a[h.tickProperty]=!f._isChecked(a)},f._uncheckAll=function(a){f._walk(a,h.groupProperty,function(a){return a[h.tickProperty]=!1,!0})},f._checkAll=function(a){f._walk(a,h.groupProperty,function(a){return a[h.tickProperty]=!0,!0})},f.clickItem=function(a,b){b===!0&&(f.kbFocusIndex=null),"single"===h.selectionMode&&0!==f._areAllChecked(f._shadowModel)&&(0!==f._hasChildren(a,!1)&&1!==f._hasChildren(a)||!f._isChecked(a))&&(f._uncheckAll(f._shadowModel),f._uncheckAll(f.filteredModel)),f._flipCheck(a),f._enforceChecks(f.filteredModel),"single"===h.selectionMode&&(f.visible=!1),f.onItemClick({item:angular.copy(a)})},f._filter=function(a){if(""===h.searchProperty||void 0===f.searchInput.value||""===f.searchInput.value)return!0;var b=angular.extend({},a);b[h.searchProperty]=d("latinize")(b[h.searchProperty]);var c=f.searchInput.value;c=d("latinize")(c);var e=d("fuzzyBy")([b],h.searchProperty,c);return e.length>0},f.fillShadowModel=function(){f._shadowModel=angular.copy(f.inputModel),f._enforceProps(f._shadowModel),f._enforceChecks(f._shadowModel),f.fillFilteredModel()},f.selectAll=function(){f._checkAll(f.filteredModel),f.onSelectAll()},f.selectNone=function(){f._uncheckAll(f.filteredModel),f.onSelectNone()},f.reset=function(){f.onReset(),f.fillShadowModel()},f.clear=function(){f.searchInput.value="",f.onClear()},f.fillFilteredModel=function(){f.filteredModel=angular.copy(f._shadowModel),f.filteredModel=f._walk(f.filteredModel,h.groupProperty,f._filter)},f.$watch("inputModel",function(a,b){(a||!angular.equals(a,b))&&f.fillShadowModel()},!0),f.$watch("filteredModel",function(a){if(a){var c=Math.abs(f._areAllChecked(f.filteredModel));f.buttonLabel=c+" selected",f.buttonLabel=b.trustAsHtml(f.buttonLabel+'<span class="caret"></span>'),f._enforceChecks(f.filteredModel),f._syncModels(f._shadowModel,f.filteredModel),f.outputModel=f._walk(angular.copy(f._shadowModel),h.groupProperty,function(a){return f.kbFocus.push(a[h.idProperty]),f._isChecked(a)}),f.kbFocus=[],f.helperStatus.all===!0&&f.kbFocus.push("all"),f.helperStatus.none===!0&&f.kbFocus.push("none"),f.helperStatus.reset===!0&&f.kbFocus.push("reset"),f.helperStatus.filter===!0&&(f.kbFocus.push("input"),f.kbFocus.push("clear")),f._walk(f.filteredModel,h.groupProperty,function(a){return f.kbFocus.push(a[h.idProperty]),!0})}},!0),f.$watch("searchInput.value",function(a,b){angular.equals(a,b)||((a.length>h.minSearchLength||a.length<b.length&&b.length>=0)&&(f.kbFocusIndex=null,f.fillFilteredModel()),f.onSearchChange({input:a}))}),a.$on("angular-multi-select-on-visible-change",function(a,b){f.$id!==b.id&&b.visible===!0&&f.visible===!0&&(f.visible=!f.visible)}),f.$watch("visible",function(b,d){angular.equals(b,d)||b!==!0?angular.equals(b,d)||b!==!1||(f.stopListeningMouseEvents(),f.stopListeningMouseEvents=null,f.stopListeningKeyboardEvents(),f.stopListeningKeyboardEvents=null,f.onClose()):(f.kbFocusIndex=f.kbFocus.indexOf("input")||0,a.$emit("angular-multi-select-on-visible-change",{visible:f.visible,id:f.$id}),f.stopListeningMouseEvents=f.$on("angular-multi-select-click",function(a,b){for(var c=!1,d=b.event.target;d;){if(void 0!==angular.element(d).attr("angular-multi-select")){c=!0;break}d=d.parentNode}c===!1&&(f.visible=!1,f.$apply())}),f.stopListeningKeyboardEvents=f.$on("angular-multi-select-keydown",function(a,b){var d=b.event.keyCode?b.event.keyCode:b.event.which,e=f.kbFocusIndex,g=!1;if(27===d)f.visible=!1;else if(13===d||32===d){var i=f.kbFocus[f.kbFocusIndex];angular.isNumber(i)&&f._walk(f.filteredModel,h.groupProperty,function(a){return a[h.idProperty]===i&&f.clickItem(a),!0})}else 40===d||39===d||!b.event.shiftKey&&9==d?(null===f.kbFocusIndex&&(f.kbFocusIndex=-1),f.kbFocusIndex<f.kbFocus.length-1?f.kbFocusIndex++:f.kbFocusIndex=0):38===d||37===d||b.event.shiftKey&&9==d?(null===f.kbFocusIndex&&(f.kbFocusIndex=1),f.kbFocusIndex>0?f.kbFocusIndex--:f.kbFocusIndex=f.kbFocus.length-1):g=!0;f.$apply(),g===!0&&c(function(){f.kbFocusIndex=e},0)}),f.onOpen())})}}}]),angular_multi_select.directive("angularMultiSelectKeyTrap",function(){"use strict";return function(a,b){b.bind("keydown",function(b){a.$broadcast("angular-multi-select-keydown",{event:b})})}}),angular_multi_select.directive("angularMultiSelectMouseTrap",function(){"use strict";return function(a,b){b.bind("click",function(b){a.$broadcast("angular-multi-select-click",{event:b})})}}),angular_multi_select.directive("setFocus",function(a){"use strict";return function(b,c,d){d.setFocus=d.setFocus||!1,b.$watch(d.setFocus,function(b){a(function(){b?c[0].focus():c[0].blur()})},!0)}}),angular_multi_select.run(["$templateCache",function(a){"use strict";var b="<div class='multiSelectItem' ng-click='clickItem(item, true);' ng-class='{selected: item[tickProperty], multiSelectGroup:_hasChildren(item, false) > 0, multiSelectFocus: kbFocus[kbFocusIndex] === item[idProperty]}'><div ng-bind-html='_createLabel(item)'></div><span class='tickMark' ng-if='item[tickProperty] === true' ng-bind-html='icon.tickMark'></span></div><ul ng-if='item.sub'><li ng-repeat='item in item[groupProperty] | filter: not(_isHidden)' ng-include=\"'angular-multi-select-item.htm'\" ></li></ul>";a.put("angular-multi-select-item.htm",b)}]),angular_multi_select.run(["$templateCache",function(a){"use strict";var b='<span class="multiSelect inlineBlock"><button class="ams_button" type="button" ng-click="visible = !visible" ng-bind-html="buttonLabel"></button><div class="checkboxLayer" ng-show="visible"><div class="helperContainer" ng-if="helperStatus.filter || helperStatus.all || helperStatus.none || helperStatus.reset "><div class="line" ng-if="helperStatus.all || helperStatus.none || helperStatus.reset "><button type="button" class="helperButton ams_selectall"ng-disabled="isDisabled" ng-if="helperStatus.all" ng-click="selectAll()" ng-bind-html="lang.selectAll" set-focus="kbFocus[kbFocusIndex] === \'all\'""></button><button type="button" class="helperButton ams_selectnone"ng-disabled="isDisabled" ng-if="helperStatus.none" ng-click="selectNone()" ng-bind-html="lang.selectNone" set-focus="kbFocus[kbFocusIndex] === \'none\'"></button><button type="button" class="helperButton reset ams_reset"ng-disabled="isDisabled" ng-if="helperStatus.reset" ng-click="reset()" ng-bind-html="lang.reset" set-focus="kbFocus[kbFocusIndex] === \'reset\'"></button></div><div class="line" style="position:relative" ng-if="helperStatus.filter"><input placeholder="{{ lang.search }}" type="text"ng-model="searchInput.value" class="inputFilter ams_filter" set-focus="kbFocus[kbFocusIndex] === \'input\'"/><button type="button" class="clearButton ams_clear" ng-click="clear()" set-focus="kbFocus[kbFocusIndex] === \'clear\'">×</button> </div> </div> <div class="checkBoxContainer"><ul><li ng-repeat=\'item in filteredModel | filter: not(_isHidden)\' ng-include="\'angular-multi-select-item.htm\'"></li></ul></div></div></div></span>';a.put("angular-multi-select.htm",b)}]);