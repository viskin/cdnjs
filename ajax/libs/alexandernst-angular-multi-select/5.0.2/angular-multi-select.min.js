/*! angular-multi-select 5.0.2 */
var angular_multi_select=angular.module("angular-multi-select",["ng","angular.filter"]);angular_multi_select.directive("angularMultiSelect",["$sce","$timeout","$filter","$interpolate",function(a,b,c,d){"use strict";return{restrict:"AE",scope:{inputModel:"=",outputModel:"=",isDisabled:"=",onClear:"&",onClose:"&",onSearchChange:"&",onItemClick:"&",onOpen:"&",onReset:"&",onSelectAll:"&",onSelectNone:"&",translation:"="},templateUrl:"angular-multi-select.htm",link:function(e,f,g){g.itemLabel=g.itemLabel||"",g.idProperty=g.idProperty||"angular-multi-select-id",g.selectionMode=g.selectionMode||"multi",g.selectionMode=g.selectionMode.toLowerCase(),g.helperElements=g.helperElements||"reset filter",g.searchProperty=g.searchProperty||"",g.hiddenProperty=g.hiddenProperty||"",g.minSearchLength=parseInt(g.minSearchLength,10)||3,e._shadowModel=[],e.filteredModel=[],e.searchInput={value:""},e.kbFocus=[],e.kbFocusIndex=null,e.visible=!1,e.buttonLabel="",e.tickProperty=g.tickProperty,e.idProperty=g.idProperty,e.groupProperty=g.groupProperty,e.itemLabel=g.itemLabel,e.hiddenProperty=g.hiddenProperty,e.icon={selectAll:"&#10003;",selectNone:"&times;",reset:"&#8630;",tickMark:a.trustAsHtml("&#10003;")},e._trans={selectAll:"Select all",selectNone:"Select none",reset:"Reset",search:"Search..."},angular.extend(e._trans,e.translation),e.lang={selectAll:a.trustAsHtml(e.icon.selectAll+"&nbsp;&nbsp;"+e._trans.selectAll),selectNone:a.trustAsHtml(e.icon.selectNone+"&nbsp;&nbsp;"+e._trans.selectNone),reset:a.trustAsHtml(e.icon.reset+"&nbsp;&nbsp;"+e._trans.reset),search:e._trans.search},e.helperStatus={all:-1!==g.helperElements.search(new RegExp(/\ball\b/))?!0:-1!==g.helperElements.search(new RegExp(/\bnoall\b/))?!1:"multi"===g.selectionMode,none:-1!==g.helperElements.search(new RegExp(/\bnone\b/))?!0:-1!==g.helperElements.search(new RegExp(/\bnonone\b/))?!1:"multi"===g.selectionMode,reset:-1!==g.helperElements.search(new RegExp(/\breset\b/))?!0:-1===g.helperElements.search(new RegExp(/\bnoreset\b/)),filter:-1!==g.helperElements.search(new RegExp(/\bfilter\b/))?!0:-1===g.helperElements.search(new RegExp(/\bnofilter\b/))},e.not=function(a){return function(b){return!a(b)}},e._walk=function(a,b,c){if(angular.isArray(a)){var d=[];return angular.forEach(a,function(a){var f=e._walk(a,b,c);null!==f&&d.push(f)}),d.length>0?d:null}if(angular.isObject(a)){c=c||function(){return!0};var f=c(a);if(a.hasOwnProperty(b)&&angular.isArray(a[b])){var g=[];angular.forEach(a[b],function(a){var d=e._walk(a,b,c);null!==d&&g.push(d)}),g.length!==a[b].length&&(a[b]=g),f=g.length>0}return f?a:null}},e._syncModels=function(a,b){e._walk(b,g.groupProperty,function(b){return e._walk(a,g.groupProperty,function(a){return a[g.idProperty]===b[g.idProperty]&&(a[g.tickProperty]=b[g.tickProperty]),!0}),!0})},e._getParent=function(a,b){var c=null,d=!1,f=null;return e._walk(a,g.groupProperty,function(a){return d===!0?!0:(e._hasChildren(a,!1)>0&&a[g.idProperty]!==b[g.idProperty]&&(f=a),a[g.idProperty]===b[g.idProperty]&&(c=f,d=!0),!0)}),c},e._getLeafs=function(a){var b=[];return e._walk(a,g.groupProperty,function(a){return 0===e._hasChildren(a,!1)&&b.push(a),!0}),b},e._getNodes=function(a){var b=[];return e._walk(a,g.groupProperty,function(a){return e._hasChildren(a,!1)>0&&b.push(a),!0}),b},e._createLabel=function(b){var c=g.itemLabel;c=c.replace(/\{\|/g,"{{"),c=c.replace(/\|\}/g,"}}");var e=d(c)(b);return a.trustAsHtml(e)},e._hasChildren=function(a,b){if(b=b||!1,b===!1&&a.hasOwnProperty(g.groupProperty)&&angular.isArray(a[g.groupProperty])&&a[g.groupProperty].length>0)return 1;var c=-1;return e._walk(a,g.groupProperty,function(){return c++,!0}),c},e._isHidden=function(a){return a[g.hiddenProperty]===!0},e._isChecked=function(a){return a[g.tickProperty]===!0},e._areAllChecked=function(a){var b=0,c=0;return e._walk(a,g.groupProperty,function(a){return 0===e._hasChildren(a,!1)&&(e._isChecked(a)&&b++,c++),!0}),c===b?b:b>0?-b:0},e._enforceProps=function(a){var b=[];e._walk(a,g.groupProperty,function(a){return(a.hasOwnProperty(g.idProperty)===!1||-1!==b.indexOf(a[g.idProperty]))&&(a[g.idProperty]=Math.floor(1e8*Math.random()+1)),b.push(a[g.idProperty]),a[g.tickProperty]=a[g.tickProperty]||!1,a[g.hiddenProperty]=a[g.hiddenProperty]||!1,!0})},e._enforceChecks=function(a){var b=0,c=e._getLeafs(a),d=!1;if(angular.forEach(c,function(c){if(d!==!0){var f=e._isChecked(c);f&&b++,b>1&&"single"===g.selectionMode&&(d=!0,e._uncheckAll(a))}}),d!==!0){var f=e._getNodes(a);angular.forEach(f,function(a){a[g.tickProperty]=0!==e._areAllChecked(a)})}},e._flipCheck=function(a){if(e._hasChildren(a)>0){var b=0===Math.abs(e._areAllChecked(a));e._walk(a,g.groupProperty,function(a){return a[g.tickProperty]=b,!0})}else a[g.tickProperty]=!e._isChecked(a)},e._uncheckAll=function(a){e._walk(a,g.groupProperty,function(a){return a[g.tickProperty]=!1,!0})},e._checkAll=function(a){e._walk(a,g.groupProperty,function(a){return a[g.tickProperty]=!0,!0})},e.clickItem=function(a,b){b===!0&&(e.kbFocusIndex=null),"single"===g.selectionMode&&0!==e._areAllChecked(e._shadowModel)&&(0!==e._hasChildren(a,!1)&&1!==e._hasChildren(a)||!e._isChecked(a))&&(e._uncheckAll(e._shadowModel),e._uncheckAll(e.filteredModel)),e._flipCheck(a),e._enforceChecks(e.filteredModel),e.onItemClick({item:angular.copy(a)})},e._filter=function(a){if(""===g.searchProperty||void 0===e.searchInput.value||""===e.searchInput.value)return!0;var b=angular.extend({},a);b[g.searchProperty]=c("latinize")(b[g.searchProperty]);var d=e.searchInput.value;d=c("latinize")(d);var f=c("fuzzyBy")([b],g.searchProperty,d);return f.length>0},e.fillShadowModel=function(){e._shadowModel=angular.copy(e.inputModel),e._enforceProps(e._shadowModel),e._enforceChecks(e._shadowModel),e.fillFilteredModel()},e.selectAll=function(){e._checkAll(e.filteredModel),e.onSelectAll()},e.selectNone=function(){e._uncheckAll(e.filteredModel),e.onSelectNone()},e.reset=function(){e.onReset(),e.fillShadowModel()},e.clear=function(){e.searchInput.value="",e.onClear()},e.fillFilteredModel=function(){e.filteredModel=angular.copy(e._shadowModel),e.filteredModel=e._walk(e.filteredModel,g.groupProperty,e._filter)},e.$watch("inputModel",function(a,b){(a||!angular.equals(a,b))&&e.fillShadowModel()},!0),e.$watch("filteredModel",function(b){if(b){var c=Math.abs(e._areAllChecked(e.filteredModel));e.buttonLabel=c+" selected",e.buttonLabel=a.trustAsHtml(e.buttonLabel+'<span class="caret"></span>'),e._enforceChecks(e.filteredModel),e._syncModels(e._shadowModel,e.filteredModel),e.outputModel=e._walk(angular.copy(e._shadowModel),g.groupProperty,function(a){return e.kbFocus.push(a[g.idProperty]),e._isChecked(a)}),e.kbFocus=[],e.helperStatus.all===!0&&e.kbFocus.push("all"),e.helperStatus.none===!0&&e.kbFocus.push("none"),e.helperStatus.reset===!0&&e.kbFocus.push("reset"),e.helperStatus.filter===!0&&(e.kbFocus.push("input"),e.kbFocus.push("clear")),e._walk(e.filteredModel,g.groupProperty,function(a){return e.kbFocus.push(a[g.idProperty]),!0})}},!0),e.$watch("searchInput.value",function(a,b){angular.equals(a,b)||((a.length>g.minSearchLength||a.length<b.length&&b.length>=0)&&(e.kbFocusIndex=null,e.fillFilteredModel()),e.onSearchChange({input:a}))}),e.$watch("visible",function(a,c){angular.equals(a,c)||a!==!0?angular.equals(a,c)||a!==!1||(e.stopListeningMouseEvents(),e.stopListeningMouseEvents=null,e.stopListeningKeyboardEvents(),e.stopListeningKeyboardEvents=null,e.onClose()):(e.kbFocusIndex=e.kbFocus.indexOf("input")||0,e.stopListeningMouseEvents=e.$on("angular-multi-select-click",function(a,b){var c=!1;angular.forEach($(b.event.target).parents(),function(a){c!==!0&&void 0!==$(a).attr("angular-multi-select")&&(c=!0)}),c===!1&&(e.visible=!1,e.$apply())}),e.stopListeningKeyboardEvents=e.$on("angular-multi-select-keydown",function(a,c){var d=c.event.keyCode?c.event.keyCode:c.event.which,f=e.kbFocusIndex,h=!1;if(27===d)e.visible=!1;else if(13===d||32===d){var i=e.kbFocus[e.kbFocusIndex];angular.isNumber(i)&&e._walk(e.filteredModel,g.groupProperty,function(a){return a[g.idProperty]===i&&e.clickItem(a),!0})}else 40===d||39===d||!c.event.shiftKey&&9==d?(null===e.kbFocusIndex&&(e.kbFocusIndex=-1),e.kbFocusIndex<e.kbFocus.length-1?e.kbFocusIndex++:e.kbFocusIndex=0):38===d||37===d||c.event.shiftKey&&9==d?(null===e.kbFocusIndex&&(e.kbFocusIndex=1),e.kbFocusIndex>0?e.kbFocusIndex--:e.kbFocusIndex=e.kbFocus.length-1):h=!0;e.$apply(),h===!0&&b(function(){e.kbFocusIndex=f},0)}),e.onOpen())})}}}]),angular_multi_select.directive("angularMultiSelectKeyTrap",function(){"use strict";return function(a,b){b.bind("keydown",function(b){a.$broadcast("angular-multi-select-keydown",{event:b})})}}),angular_multi_select.directive("angularMultiSelectMouseTrap",function(){"use strict";return function(a,b){b.bind("click",function(b){a.$broadcast("angular-multi-select-click",{event:b})})}}),angular_multi_select.directive("setFocus",function(a){"use strict";return function(b,c,d){d.setFocus=d.setFocus||!1,b.$watch(d.setFocus,function(b){a(function(){b?c.focus():c.blur()})},!0)}}),angular_multi_select.run(["$templateCache",function(a){"use strict";var b="<div class='multiSelectItem' ng-click='clickItem(item, true);' ng-class='{selected: item[tickProperty], multiSelectGroup:_hasChildren(item, false) > 0, multiSelectFocus: kbFocus[kbFocusIndex] === item[idProperty]}'><div ng-bind-html='_createLabel(item)'></div><span class='tickMark' ng-if='item[tickProperty] === true' ng-bind-html='icon.tickMark'></span></div><ul ng-if='item.sub'><li ng-repeat='item in item[groupProperty] | filter: not(_isHidden)' ng-include=\"'angular-multi-select-item.htm'\" ></li></ul>";a.put("angular-multi-select-item.htm",b)}]),angular_multi_select.run(["$templateCache",function(a){"use strict";var b='<span class="multiSelect inlineBlock"><button class="ams_button" type="button" ng-click="visible = !visible" ng-bind-html="buttonLabel"></button><div class="checkboxLayer" ng-show="visible"><div class="helperContainer" ng-if="helperStatus.filter || helperStatus.all || helperStatus.none || helperStatus.reset "><div class="line" ng-if="helperStatus.all || helperStatus.none || helperStatus.reset "><button type="button" class="helperButton ams_selectall"ng-disabled="isDisabled" ng-if="helperStatus.all" ng-click="selectAll()" ng-bind-html="lang.selectAll" set-focus="kbFocus[kbFocusIndex] === \'all\'""></button><button type="button" class="helperButton ams_selectnone"ng-disabled="isDisabled" ng-if="helperStatus.none" ng-click="selectNone()" ng-bind-html="lang.selectNone" set-focus="kbFocus[kbFocusIndex] === \'none\'"></button><button type="button" class="helperButton reset ams_reset"ng-disabled="isDisabled" ng-if="helperStatus.reset" ng-click="reset()" ng-bind-html="lang.reset" set-focus="kbFocus[kbFocusIndex] === \'reset\'"></button></div><div class="line" style="position:relative" ng-if="helperStatus.filter"><input placeholder="{{ lang.search }}" type="text"ng-model="searchInput.value" class="inputFilter ams_filter" set-focus="kbFocus[kbFocusIndex] === \'input\'"/><button type="button" class="clearButton ams_clear" ng-click="clear()" set-focus="kbFocus[kbFocusIndex] === \'clear\'">×</button> </div> </div> <div class="checkBoxContainer"><ul><li ng-repeat=\'item in filteredModel | filter: not(_isHidden)\' ng-include="\'angular-multi-select-item.htm\'"></li></ul></div></div></div></span>';a.put("angular-multi-select.htm",b)}]);