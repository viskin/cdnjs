// Peity jQuery plugin version 2.0.5
// (c) 2014 Ben Pickles
//
// http://benpickles.github.io/peity
//
// Released under MIT license.
(function(l,q,h){var p=function(a,b){var c=q.createElementNS("http://www.w3.org/2000/svg",a);l(c).attr(b);return c},t="createElementNS"in q&&p("svg").createSVGRect,f=l.fn.peity=function(a,b){t&&this.each(function(){var c=l(this),d=c.data("peity");if(d)a&&(d.type=a),l.extend(d.opts,b);else{var e=f.defaults[a],g={};l.each(c.data(),function(a,b){a in e&&(g[a]=b)});d=new r(c,a,l.extend({},e,g,b));c.change(function(){d.draw()}).data("peity",d)}d.draw()});return this},r=function(a,b,c){this.$el=a;this.type=
b;this.opts=c},n=r.prototype;n.draw=function(){f.graphers[this.type].call(this,this.opts)};n.fill=function(){var a=this.opts.fill;return l.isFunction(a)?a:function(b,c){return a[c%a.length]}};n.prepare=function(a,b){this.svg||this.$el.hide().after(this.svg=p("svg",{"class":"peity"}));return l(this.svg).empty().data("peity",this).attr({height:b,width:a})};n.values=function(){return l.map(this.$el.text().split(this.opts.delimiter),function(a){return parseFloat(a)})};f.defaults={};f.graphers={};f.register=
function(a,b,c){this.defaults[a]=b;this.graphers[a]=c};f.register("pie",{delimiter:null,diameter:16,fill:["#ff9900","#fff4dd","#ffc66e"]},function(a){if(!a.delimiter){var b=this.$el.text().match(/[^0-9\.]/);a.delimiter=b?b[0]:","}b=this.values();if("/"==a.delimiter)var c=b[0],b=[c,h.max(0,b[1]-c)];for(var d=0,c=b.length,e=0;d<c;d++)e+=b[d];for(var a=this.prepare(a.width||a.diameter,a.height||a.diameter),d=a.width(),g=a.height(),a=d/2,g=g/2,o=h.min(a,g),s=h.PI,m=this.fill(),i=-s/2,d=0;d<c;d++){var f=
b[d],k=f/e,j;if(0!=k){if(1==k)j=p("circle",{cx:a,cy:g,r:o});else{j=2*k*s;var k=i+j,n=o*h.cos(i)+a,i=o*h.sin(i)+g,q=o*h.cos(k)+a,r=o*h.sin(k)+g;j=p("path",{d:["M",a,g,"L",n,i,"A",o,o,0,j>s?1:0,1,q,r,"Z"].join(" ")});i=k}l(j).attr("fill",m.call(this,f,d,b));this.svg.appendChild(j)}}});f.register("line",{delimiter:",",fill:"#c6d9fd",height:16,max:null,min:0,stroke:"#4d89f9",strokeWidth:1,width:32},function(a){var b=this.values();1==b.length&&b.push(b[0]);for(var c=h.max.apply(h,"number"==typeof a.max?
b.concat([a.max]):b),d=h.min.apply(h,"number"==typeof a.min?b.concat([a.min]):b),e=this.prepare(a.width,a.height),g=e.width(),e=e.height()-a.strokeWidth,o=g/(b.length-1),c=c-d,c=0==c?e:e/c,f=e+d*c,m=[0,f],i=0;i<b.length;i++)m.push(i*o,e-c*(b[i]-d)+a.strokeWidth/2);m.push(g,f);this.svg.appendChild(p("polygon",{fill:a.fill,points:m.join(" ")}));a.strokeWidth&&this.svg.appendChild(p("polyline",{fill:"transparent",points:m.slice(2,m.length-2).join(" "),stroke:a.stroke,"stroke-width":a.strokeWidth,"stroke-linecap":"square"}))});
f.register("bar",{delimiter:",",fill:["#4D89F9"],gap:1,height:16,max:null,min:0,width:32},function(a){for(var b=this.values(),c=h.max.apply(h,"number"==typeof a.max?b.concat([a.max]):b),d=h.min.apply(h,"number"==typeof a.min?b.concat([a.min]):b),e=this.prepare(a.width,a.height),g=e.width(),f=e.height(),l=c-d,a=a.gap,g=(g+a)/b.length,e=this.fill(),m=function(a){return f-(a-d)/l*f},i=0;i<b.length;i++){var n=b[i],k,j;if(0==l)k=f-1,j=1;else if(j=m(n),0>n?k=m(h.min(c,0)):(k=j,j=m(h.max(d,0))),j-=k,0==
j)j=1,0<c&&k--;this.svg.appendChild(p("rect",{fill:e.call(this,n,i,b),x:i*g,y:k,width:g-a,height:j}))}})})(jQuery,document,Math);
