// Peity jQuery plugin version 2.0.4
// (c) 2014 Ben Pickles
//
// http://benpickles.github.io/peity
//
// Released under MIT license.
(function(e,q,f){var o=function(a,b){var c=q.createElementNS("http://www.w3.org/2000/svg",a);e.each(b,function(a,b){c.setAttribute(a,b)});return c},s="createElementNS"in q&&o("svg",{}).createSVGRect,k=e.fn.peity=function(a,b){s&&this.each(function(){var c=e(this),d=c.data("peity");if(d)a&&(d.type=a),e.extend(d.opts,b);else{var g=k.defaults[a],h={};e.each(c.data(),function(a,b){a in g&&(h[a]=b)});var f=e.extend({},g,h,b),d=new r(c,a,f);c.change(function(){d.draw()}).data("peity",d)}d.draw()});return this},
r=function(a,b,c){this.$el=a;this.type=b;this.opts=c},m=r.prototype;m.draw=function(){k.graphers[this.type].call(this,this.opts)};m.fill=function(){var a=this.opts.fill,b=a;e.isFunction(b)||(b=function(b,d){return a[d%a.length]});return b};m.prepare=function(a,b){var c;this.svg?c=e(this.svg).empty():(this.svg=o("svg",{"class":"peity"}),this.$el.hide().after(this.svg),c=e(this.svg).data("peity",this));this.svg.setAttribute("height",b);this.svg.setAttribute("width",a);return c};m.values=function(){return e.map(this.$el.text().split(this.opts.delimiter),
function(a){return parseFloat(a)})};k.defaults={};k.graphers={};k.register=function(a,b,c){this.defaults[a]=b;this.graphers[a]=c};k.register("pie",{delimiter:null,diameter:16,fill:["#ff9900","#fff4dd","#ffc66e"]},function(a){if(!a.delimiter){var b=this.$el.text().match(/[^0-9\.]/);a.delimiter=b?b[0]:","}b=this.values();if("/"==a.delimiter)var c=b[0],b=[c,f.max(0,b[1]-c)];for(var d=0,c=b.length,g=0;d<c;d++)g+=b[d];for(var a=this.prepare(a.width||a.diameter,a.height||a.diameter),d=a.width(),h=a.height(),
a=d/2,h=h/2,p=f.min(a,h),e=f.PI,k=this.fill(),i=-e/2,d=0;d<c;d++){var n=b[d],l=n/g,j;if(0!=l){if(1==l)j=o("circle",{cx:a,cy:h,r:p});else{j=2*l*e;var l=i+j,m=p*f.cos(i)+a,i=p*f.sin(i)+h,q=p*f.cos(l)+a,r=p*f.sin(l)+h;j=o("path",{d:["M",a,h,"L",m,i,"A",p,p,0,j>e?1:0,1,q,r,"Z"].join(" ")});i=l}j.setAttribute("fill",k.call(this,n,d,b));this.svg.appendChild(j)}}});k.register("line",{delimiter:",",fill:"#c6d9fd",height:16,max:null,min:0,stroke:"#4d89f9",strokeWidth:1,width:32},function(a){var b=this.values();
1==b.length&&b.push(b[0]);for(var c=f.max.apply(f,"number"==typeof a.max?b.concat([a.max]):b),d=f.min.apply(f,"number"==typeof a.min?b.concat([a.min]):b),g=this.prepare(a.width,a.height),h=g.width(),g=g.height()-a.strokeWidth,e=h/(b.length-1),c=c-d,k=0==c?g:g/c,m=g+d*k,c=[0,m],i=0;i<b.length;i++)c.push(i*e,g-k*(b[i]-d)+a.strokeWidth/2);c.push(h,m);b=o("polygon",{fill:a.fill,points:c.join(" ")});this.svg.appendChild(b);a.strokeWidth&&(a=o("polyline",{fill:"transparent",points:c.slice(2,c.length-2).join(" "),
stroke:a.stroke,"stroke-width":a.strokeWidth,"stroke-linecap":"square"}),this.svg.appendChild(a))});k.register("bar",{delimiter:",",fill:["#4D89F9"],gap:1,height:16,max:null,min:0,width:32},function(a){for(var b=this.values(),c=f.max.apply(f,"number"==typeof a.max?b.concat([a.max]):b),d=f.min.apply(f,"number"==typeof a.min?b.concat([a.min]):b),g=this.prepare(a.width,a.height),h=g.width(),e=g.height(),k=c-d,a=a.gap,h=(h+a)/b.length,g=this.fill(),m=function(a){return e-(a-d)/k*e},i=0;i<b.length;i++){var n=
b[i],l,j;if(0==k)l=e-1,j=1;else if(j=m(n),0>n?l=m(f.min(c,0)):(l=j,j=m(f.max(d,0))),j-=l,0==j)j=1,0<c&&l--;n=o("rect",{fill:g.call(this,n,i,b),x:i*h,y:l,width:h-a,height:j});this.svg.appendChild(n)}})})(jQuery,document,Math);
