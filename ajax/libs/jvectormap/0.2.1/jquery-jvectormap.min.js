(function(e){var f={colors:1,values:1,backgroundColor:1,scaleColors:1,normalizeFunction:1},b={onLabelShow:"labelShow",onRegionOver:"regionOver",onRegionOut:"regionOut",onRegionClick:"regionClick",onMarkerLabelShow:"markerLabelShow",onMarkerOver:"markerOver",onMarkerOut:"markerOut",onMarkerClick:"markerClick"};e.fn.vectorMap=function(h){var j={map:"world_en",backgroundColor:"#505050",color:"#ffffff",hoverColor:"black",scaleColors:["#b6d6ff","#005ace"],normalizeFunction:"linear"},k,g,i;if(h==="addMap"){c.maps[arguments[1]]=arguments[2]}else{if(h==="set"&&f[arguments[1]]){g=arguments[1].charAt(0).toUpperCase()+arguments[1].substr(1);this.data("mapObject")["set"+g].apply(this.data("mapObject"),Array.prototype.slice.call(arguments,2))}else{e.extend(j,h);j.container=this;this.css({position:"relative",overflow:"hidden"});k=new c(j);this.data("mapObject",k);for(i in b){if(j[i]){this.bind(b[i]+".jvectormap",j[i])}}}}};var d=function(h,g){this.mode=window.SVGAngle?"svg":"vml";if(this.mode=="svg"){this.createSvgNode=function(j){return document.createElementNS(this.svgns,j)}}else{try{if(!document.namespaces.rvml){document.namespaces.add("rvml","urn:schemas-microsoft-com:vml")}this.createVmlNode=function(j){return document.createElement("<rvml:"+j+' class="rvml">')}}catch(i){this.createVmlNode=function(j){return document.createElement("<"+j+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}document.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)")}if(this.mode=="svg"){this.canvas=this.createSvgNode("svg")}else{this.canvas=this.createVmlNode("group");this.canvas.style.position="absolute"}this.setSize(h,g)};d.prototype={svgns:"http://www.w3.org/2000/svg",mode:"svg",width:0,height:0,canvas:null,setSize:function(k,g){if(this.mode=="svg"){this.canvas.setAttribute("width",k);this.canvas.setAttribute("height",g)}else{this.canvas.style.width=k+"px";this.canvas.style.height=g+"px";this.canvas.coordsize=k+" "+g;this.canvas.coordorigin="0 0";if(this.rootGroup){var m=this.rootGroup.getElementsByTagName("shape");for(var j=0,h=m.length;j<h;j++){m[j].coordsize=k+" "+g;m[j].style.width=k+"px";m[j].style.height=g+"px"}this.rootGroup.coordsize=k+" "+g;this.rootGroup.style.width=k+"px";this.rootGroup.style.height=g+"px"}}this.width=k;this.height=g},createPath:function(g){var h;if(this.mode=="svg"){h=this.createSvgNode("path");h.setAttribute("d",g.path);h.setAttribute("fill-rule","evenodd");h.setFill=function(k){this.setAttribute("fill",k)};h.getFill=function(k){return this.getAttribute("fill")};h.setOpacity=function(k){this.setAttribute("fill-opacity",k)}}else{h=this.createVmlNode("shape");h.coordorigin="0 0";h.coordsize=this.width+" "+this.height;h.style.width=this.width+"px";h.style.height=this.height+"px";h.fillcolor=c.defaultFillColor;h.stroked=false;h.path=d.pathSvgToVml(g.path);var j=this.createVmlNode("skew");j.on=true;j.matrix="0.01,0,0,0.01,0,0";j.offset="0,0";h.appendChild(j);var i=this.createVmlNode("fill");h.appendChild(i);h.setFill=function(k){this.getElementsByTagName("fill")[0].color=k};h.getFill=function(k){return this.getElementsByTagName("fill")[0].color};h.setOpacity=function(k){this.getElementsByTagName("fill")[0].opacity=parseInt(k*100)+"%"}}return h},createCircle:function(g){var h;if(this.mode=="svg"){h=this.createSvgNode("circle");h.setAttribute("cx",g.x);h.setAttribute("cy",g.y);h.setAttribute("r",g.r);h.setAttribute("fill",g.fill);h.setAttribute("stroke",g.stroke);h.setPosition=function(i){h.setAttribute("cx",i.x);h.setAttribute("cy",i.y)}}else{h=this.createVmlNode("oval");h.style.width=g.r*2+"px";h.style.height=g.r*2+"px";h.style.left=g.x-g.r+"px";h.style.top=g.y-g.r+"px";h.fillcolor=g.fill;h.stroke=true;h.strokecolor=g.stroke;h.setPosition=function(i){h.style.left=i.x-g.r+"px";h.style.top=i.y-g.r+"px"}}return h},createGroup:function(g){var h;if(this.mode=="svg"){h=this.createSvgNode("g")}else{h=this.createVmlNode("group");h.style.width=this.width+"px";h.style.height=this.height+"px";h.style.left="0px";h.style.top="0px";h.coordorigin="0 0";h.coordsize=this.width+" "+this.height}if(g){this.rootGroup=h}return h},applyTransformParams:function(i,h,g){if(this.mode=="svg"){this.rootGroup.setAttribute("transform","scale("+i+") translate("+h+", "+g+")")}else{this.rootGroup.coordorigin=(this.width-h-this.width/100)+","+(this.height-g-this.height/100);this.rootGroup.coordsize=this.width/i+","+this.height/i}}};d.pathSvgToVml=function(k){var h="",g=0,l=0,j,i;k=k.replace(/(-?\d+)e(-?\d+)/g,"0");return k.replace(/([MmLlHhVvCcSs])\s*((?:-?\d*(?:\.\d+)?\s*,?\s*)+)/g,function(q,p,r,n){r=r.replace(/(\d)-/g,"$1,-").replace(/\s+/g,",").split(",");if(!r[0]){r.shift()}for(var o=0,m=r.length;o<m;o++){r[o]=Math.round(100*r[o])}switch(p){case"m":g+=r[0];l+=r[1];return"t"+r.join(",");break;case"M":g=r[0];l=r[1];return"m"+r.join(",");break;case"l":g+=r[0];l+=r[1];return"r"+r.join(",");break;case"L":g=r[0];l=r[1];return"l"+r.join(",");break;case"h":g+=r[0];return"r"+r[0]+",0";break;case"H":g=r[0];return"l"+g+","+l;break;case"v":l+=r[0];return"r0,"+r[0];break;case"V":l=r[0];return"l"+g+","+l;break;case"c":j=g+r[r.length-4];i=l+r[r.length-3];g+=r[r.length-2];l+=r[r.length-1];return"v"+r.join(",");break;case"C":j=r[r.length-4];i=r[r.length-3];g=r[r.length-2];l=r[r.length-1];return"c"+r.join(",");break;case"s":r.unshift(l-i);r.unshift(g-j);j=g+r[r.length-4];i=l+r[r.length-3];g+=r[r.length-2];l+=r[r.length-1];return"v"+r.join(",");break;case"S":r.unshift(l+l-i);r.unshift(g+g-j);j=r[r.length-4];i=r[r.length-3];g=r[r.length-2];l=r[r.length-1];return"c"+r.join(",");break}return""}).replace(/z/g,"e")};var c=function(k){k=k||{};var i=this;var j=c.maps[k.map];this.params=k;this.container=k.container;this.defaultWidth=j.width;this.defaultHeight=j.height;this.color=k.color;this.hoverColor=k.hoverColor;this.setBackgroundColor(k.backgroundColor);this.width=k.container.width();this.height=k.container.height();this.resize();e(window).resize(function(){i.width=k.container.width();i.height=k.container.height();i.resize();i.canvas.setSize(i.width,i.height);i.applyTransform()});this.canvas=new d(this.width,this.height);k.container.append(this.canvas.canvas);this.makeDraggable();this.rootGroup=this.canvas.createGroup(true);this.index=c.mapIndex;this.label=e("<div/>").addClass("jvectormap-label").appendTo(e("body"));e("<div/>").addClass("jvectormap-zoomin").text("+").appendTo(k.container);e("<div/>").addClass("jvectormap-zoomout").html("&#x2212;").appendTo(k.container);for(var g in j.paths){var h=this.canvas.createPath({path:j.paths[g].path});h.setFill(this.color);if(this.canvas.mode=="svg"){h.setAttribute("class","jvectormap-region")}else{e(h).addClass("jvectormap-region")}h.id="jvectormap"+i.index+"_"+g;i.countries[g]=h;e(this.rootGroup).append(h)}e(k.container).delegate(".jvectormap-region","mouseover mouseout",function(p){var o=p.target,n=p.target.id.substr(p.target.id.indexOf("_")+1),l=e.Event("labelShow.jvectormap"),m=e.Event("regionOver.jvectormap");if(p.type=="mouseover"){e(k.container).trigger(m,[n]);if(!m.isDefaultPrevented()){if(k.hoverOpacity){o.setOpacity(k.hoverOpacity)}if(k.hoverColor){o.currentFillColor=o.getFill()+"";o.setFill(k.hoverColor)}}i.label.text(j.paths[n].name);e(k.container).trigger(l,[i.label,n]);if(!l.isDefaultPrevented()){i.label.show();i.labelWidth=i.label.width();i.labelHeight=i.label.height()}}else{o.setOpacity(1);if(o.currentFillColor){o.setFill(o.currentFillColor)}i.label.hide();e(k.container).trigger("regionOut.jvectormap",[n])}});e(k.container).delegate(".jvectormap-region","click",function(n){var m=n.target;var l=n.target.id.split("_").pop();e(k.container).trigger("regionClick.jvectormap",[l])});k.container.mousemove(function(l){if(i.label.is(":visible")){i.label.css({left:l.pageX-15-i.labelWidth,top:l.pageY-15-i.labelHeight})}});this.setColors(k.colors);this.canvas.canvas.appendChild(this.rootGroup);if(k.markers){this.createMarkers(k.markers);e(k.container).delegate(".jvectormap-marker","mouseover mouseout",function(p){var m=p.target,o=m.getAttribute("data-index"),n=e.Event("markerLabelShow.jvectormap"),l=e.Event("markerOver.jvectormap");if(p.type=="mouseover"){e(k.container).trigger(l,[o]);e(k.container).trigger(n,[i.label,o]);if(!n.isDefaultPrevented()){i.label.text(i.markers[o].config.name||"");i.label.show();i.labelWidth=i.label.width();i.labelHeight=i.label.height()}}else{i.label.hide();e(k.container).trigger("markerOut.jvectormap",[o])}});e(k.container).delegate(".jvectormap-marker","click",function(n){var l=n.target;var m=l.getAttribute("data-index");e(k.container).trigger("markerClick.jvectormap",[m])})}this.applyTransform();this.colorScale=new a(k.scaleColors,k.normalizeFunction,k.valueMin,k.valueMax);if(k.values){this.values=k.values;this.setValues(k.values)}this.bindZoomButtons();c.mapIndex++};c.prototype={transX:0,transY:0,scale:1,baseTransX:0,baseTransY:0,baseScale:1,width:0,height:0,countries:{},countriesColors:{},countriesData:{},zoomStep:1.4,zoomMaxStep:4,zoomCurStep:1,setColors:function(i,h){if(typeof i=="string"){this.countries[i].setFill(h)}else{var g=i;for(var j in g){if(this.countries[j]){this.countries[j].setFill(g[j])}}}},setValues:function(i){var g=0,j=Number.MAX_VALUE,k;for(var l in i){k=parseFloat(i[l]);if(k>g){g=i[l]}if(k&&k<j){j=k}}this.colorScale.setMin(j);this.colorScale.setMax(g);var h={};for(l in i){k=parseFloat(i[l]);if(k){h[l]=this.colorScale.getColor(k)}else{h[l]=this.color}}this.setColors(h);this.values=i},setBackgroundColor:function(g){this.container.css("background-color",g)},setScaleColors:function(g){this.colorScale.setColors(g);if(this.values){this.setValues(this.values)}},setNormalizeFunction:function(g){this.colorScale.setNormalizeFunction(g);if(this.values){this.setValues(this.values)}},resize:function(){var g=this.baseScale;if(this.width/this.height>this.defaultWidth/this.defaultHeight){this.baseScale=this.height/this.defaultHeight;this.baseTransX=Math.abs(this.width-this.defaultWidth*this.baseScale)/(2*this.baseScale)}else{this.baseScale=this.width/this.defaultWidth;this.baseTransY=Math.abs(this.height-this.defaultHeight*this.baseScale)/(2*this.baseScale)}this.scale*=this.baseScale/g;this.transX*=this.baseScale/g;this.transY*=this.baseScale/g},reset:function(){this.countryTitle.reset();for(var g in this.countries){this.countries[g].setFill(c.defaultColor)}this.scale=this.baseScale;this.transX=this.baseTransX;this.transY=this.baseTransY;this.applyTransform()},applyTransform:function(){var i,h,g,h;if(this.defaultWidth*this.scale<=this.width){i=(this.width-this.defaultWidth*this.scale)/(2*this.scale);g=(this.width-this.defaultWidth*this.scale)/(2*this.scale)}else{i=0;g=(this.width-this.defaultWidth*this.scale)/this.scale}if(this.defaultHeight*this.scale<=this.height){h=(this.height-this.defaultHeight*this.scale)/(2*this.scale);minTransY=(this.height-this.defaultHeight*this.scale)/(2*this.scale)}else{h=0;minTransY=(this.height-this.defaultHeight*this.scale)/this.scale}if(this.transY>h){this.transY=h}else{if(this.transY<minTransY){this.transY=minTransY}}if(this.transX>i){this.transX=i}else{if(this.transX<g){this.transX=g}}this.canvas.applyTransformParams(this.scale,this.transX,this.transY);if(this.markers){this.repositionMarkers()}},makeDraggable:function(){var h=false;var i,g;var j=this;this.container.mousemove(function(m){if(h){var l=j.transX;var k=j.transY;j.transX-=(i-m.pageX)/j.scale;j.transY-=(g-m.pageY)/j.scale;j.applyTransform();i=m.pageX;g=m.pageY}return false}).mousedown(function(k){h=true;i=k.pageX;g=k.pageY;return false}).mouseup(function(){h=false;return false})},bindZoomButtons:function(){var h=this;var g=(e("#zoom").innerHeight()-6*2-15*2-3*2-7-6)/(this.zoomMaxStep-this.zoomCurStep);this.container.find(".jvectormap-zoomin").click(function(){if(h.zoomCurStep<h.zoomMaxStep){var j=h.transX;var i=h.transY;var k=h.scale;h.transX-=(h.width/h.scale-h.width/(h.scale*h.zoomStep))/2;h.transY-=(h.height/h.scale-h.height/(h.scale*h.zoomStep))/2;h.setScale(h.scale*h.zoomStep);h.zoomCurStep++;e("#zoomSlider").css("top",parseInt(e("#zoomSlider").css("top"))-g)}});this.container.find(".jvectormap-zoomout").click(function(){if(h.zoomCurStep>1){var j=h.transX;var i=h.transY;var k=h.scale;h.transX+=(h.width/(h.scale/h.zoomStep)-h.width/h.scale)/2;h.transY+=(h.height/(h.scale/h.zoomStep)-h.height/h.scale)/2;h.setScale(h.scale/h.zoomStep);h.zoomCurStep--;e("#zoomSlider").css("top",parseInt(e("#zoomSlider").css("top"))+g)}})},setScale:function(g){this.scale=g;this.applyTransform()},getCountryPath:function(g){return e("#"+g)[0]},createMarkers:function(n){var l=this.canvas.createGroup(),k,j,h,m,g={latLng:[0,0],r:5,fill:"white",stroke:"#505050"};this.markers=[];for(k=0;k<n.length;k++){m=n[k] instanceof Array?{latLng:n[k]}:n[k];m=e.extend({},g,this.params.markerDefaults,m);h=this.latLngToPoint.apply(this,m.latLng);e.extend(m,h);j=this.canvas.createCircle(m);if(this.canvas.mode=="svg"){j.setAttribute("class","jvectormap-marker");j.setAttribute("data-index",k)}else{e(j).addClass("jvectormap-marker").attr("data-index",k)}this.markers.push({element:j,config:m});e(l).append(j)}this.canvas.canvas.appendChild(l)},repositionMarkers:function(){var h,g;for(h=0;h<this.markers.length;h++){g=this.latLngToPoint.apply(this,this.markers[h].config.latLng);this.markers[h].element.setPosition(g)}},latLngToPoint:function(i,k){var m,j,h=c.maps[this.params.map].projection.centralMeridian,g=this.width-this.baseTransX*2*this.baseScale,o=this.height-this.baseTransY*2*this.baseScale,p,n,l=this.scale/this.baseScale;if(k<(-180+h)){k+=360}m=(k-h)/360*c.circumference,j=(180/Math.PI*(5/4)*Math.log(Math.tan(Math.PI/4+(4/5)*i*Math.PI/360)))/360*c.circumference;p=this.getInsetForPoint(m,j);n=p.bbox;m=(m-n[0].x)/(n[1].x-n[0].x)*p.width*this.scale;j=(j-n[0].y)/(n[1].y-n[0].y)*p.height*this.scale;return{x:m+this.transX*this.scale+p.left*this.scale,y:j+this.transY*this.scale+p.top*this.scale}},getInsetForPoint:function(g,l){var h=c.maps[this.params.map].insets,j,k;for(j=0;j<h.length;j++){k=h[j].bbox;if(g>k[0].x&&g<k[1].x&&l>k[0].y&&l<k[1].y){return h[j]}}}},c.xlink="http://www.w3.org/1999/xlink";c.mapIndex=1;c.maps={};c.circumference=40075017;var a=function(g,h,i,j){if(g){this.setColors(g)}if(h){this.setNormalizeFunction(h)}if(i){this.setMin(i)}if(i){this.setMax(j)}};a.prototype={colors:[],setMin:function(g){this.clearMinValue=g;if(typeof this.normalize==="function"){this.minValue=this.normalize(g)}else{this.minValue=g}},setMax:function(g){this.clearMaxValue=g;if(typeof this.normalize==="function"){this.maxValue=this.normalize(g)}else{this.maxValue=g}},setColors:function(g){for(var h=0;h<g.length;h++){g[h]=a.rgbToArray(g[h])}this.colors=g},setNormalizeFunction:function(g){if(g==="polynomial"){this.normalize=function(h){return Math.pow(h,0.2)}}else{if(g==="linear"){delete this.normalize}else{this.normalize=g}}this.setMin(this.clearMinValue);this.setMax(this.clearMaxValue)},getColor:function(k){if(typeof this.normalize==="function"){k=this.normalize(k)}var o=[];var m=0;var g;for(var j=0;j<this.colors.length-1;j++){g=this.vectorLength(this.vectorSubtract(this.colors[j+1],this.colors[j]));o.push(g);m+=g}var n=(this.maxValue-this.minValue)/m;for(j=0;j<o.length;j++){o[j]*=n}j=0;k-=this.minValue;while(k-o[j]>=0){k-=o[j];j++}var h;if(j==this.colors.length-1){h=this.vectorToNum(this.colors[j]).toString(16)}else{h=(this.vectorToNum(this.vectorAdd(this.colors[j],this.vectorMult(this.vectorSubtract(this.colors[j+1],this.colors[j]),(k)/(o[j]))))).toString(16)}while(h.length<6){h="0"+h}return"#"+h},vectorToNum:function(g){var h=0;for(var j=0;j<g.length;j++){h+=Math.round(g[j])*Math.pow(256,g.length-j-1)}return h},vectorSubtract:function(k,j){var g=[];for(var h=0;h<k.length;h++){g[h]=k[h]-j[h]}return g},vectorAdd:function(k,j){var g=[];for(var h=0;h<k.length;h++){g[h]=k[h]+j[h]}return g},vectorMult:function(h,j){var g=[];for(var k=0;k<h.length;k++){g[k]=h[k]*j}return g},vectorLength:function(h){var g=0;for(var j=0;j<h.length;j++){g+=h[j]*h[j]}return Math.sqrt(g)}};a.arrayToRgb=function(g){var h="#";var k;for(var j=0;j<g.length;j++){k=g[j].toString(16);h+=k.length==1?"0"+k:k}return h};a.rgbToArray=function(g){g=g.substr(1);return[parseInt(g.substr(0,2),16),parseInt(g.substr(2,2),16),parseInt(g.substr(4,2),16)]}})(jQuery);