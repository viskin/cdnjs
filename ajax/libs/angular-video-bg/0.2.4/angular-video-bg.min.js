angular.module("angularVideoBg",[]),angular.module("angularVideoBg").directive("videoBg",["$window","$q",function(a,b){return{restrict:"EA",replace:!0,scope:{videoId:"=",ratio:"=?",loop:"=?",mute:"=?",start:"=?",end:"=?",contentZIndex:"=?",allowClickEvents:"=?",mobileImage:"=?"},transclude:!0,template:"<div><div></div><div ng-transclude></div></div>",link:function(c,d,e,f){function g(a,b){var c;return function(){var d=this,e=arguments,f=function(){c=null,a.apply(d,e)};clearTimeout(c),c=setTimeout(f,b)}}function h(){var a=window.navigator.userAgent,b=a.indexOf("MSIE "),c=a.indexOf("Trident/"),d=a.indexOf("Edge/");if(b>0)return parseInt(a.substring(b+5,a.indexOf(".",b)),10);if(c>0){var e=a.indexOf("rv:");return parseInt(a.substring(e+3,a.indexOf(".",e)),10)}return d>0?parseInt(a.substring(d+5,a.indexOf(".",d)),10):!1}function i(a,b){var c=["top","right","bottom","left"],d=function(c,d){return c[d]=parseInt(b.call(u,a+"-"+d),10),c};return c.reduce(d,{})}function j(a,b){function c(){var a,c=Array.prototype.slice.call(arguments),d=0,e=function(b,c){return a[c]?b+a[c]:b};for(var f in b)b.hasOwnProperty(f)&&(a=b[f],d+=c.reduce(e,0));return d}return{width:a.width+c("left","right"),height:h()&&h()<12?a.height:a.height+c("top","bottom")}}function k(){var a=d.children().eq(1),b=!!a.children().length,e=Array.prototype.slice.call(d.parent().children());if(d.parent().css({position:"relative",overflow:"hidden"}),!b){d.css({position:"absolute",left:"0",top:"0"});var f=e.indexOf(d[0]);f>-1&&e.splice(f,1),a=angular.element(e)}a.css({position:"relative",zIndex:c.contentZIndex||99})}function l(){u=a.getComputedStyle(d.parent()[0]);var b=["width","height"],c=["border","margin"];return h()&&h()<12&&c.push("padding"),b=b.reduce(function(a,b){return a[b]=parseInt(u.getPropertyValue(b),10),a},{}),c=c.reduce(function(a,b){return a[b]=i(b,u.getPropertyValue),a},{}),j(b,c)}function m(){var a=parseInt(x.width/c.ratio,10),b=parseInt(x.height*c.ratio,10),d=x.height<a;return{width:d?x.width:b,height:d?a:x.height}}function n(){k(),x=l(),y=m()}function o(){var a={zIndex:1,position:"absolute",width:y.width+"px",height:y.height+"px",left:parseInt((x.width-y.width)/2,10)+"px",top:parseInt((x.height-y.height)/2,10)+"px"};c.allowClickEvents||(a.pointerEvents="none"),A.css(a)}function p(){w.seekTo(c.start||0)}function q(){var a,b;a=c.end?c.end-(c.start||0):c.start?w.getDuration()-c.start:w.getDuration(),b=1e3*a,setTimeout(p,b)}function r(){c.mute&&!w.isMuted()?w.mute():w.isMuted()&&w.unMute(),p()}function s(a){a.data===YT.PlayerState.PLAYING&&(A.css("display","block"),c.loop&&q())}function t(){n();var a={autoplay:1,controls:0,iv_load_policy:3,cc_load_policy:0,modestbranding:1,playsinline:1,rel:0,showinfo:0,playlist:c.videoId};w=new YT.Player(v,{width:y.width,height:y.height,videoId:c.videoId,playerVars:a,events:{onReady:r,onStateChange:s}}),A=d.children().eq(0),A.css("display","none"),o()}c.ratio=c.ratio||16/9,c.loop=void 0===c.loop?!0:c.loop,c.mute=void 0===c.mute?!0:c.mute,c.mobileImage=c.mobileImage||"//img.youtube.com/vi/"+c.videoId+"/maxresdefault.jpg";var u,v,w,x,y,z=document.querySelector('script[src="//www.youtube.com/iframe_api"]'),A=d.children().eq(0);if(v="player"+Array.prototype.slice.call(document.querySelectorAll("div[video-id]")).indexOf(d[0]),A.attr("id",v),d.parent().css({backgroundImage:"url("+c.mobileImage+")",backgroundSize:"cover",backgroundPosition:"center center"}),!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){if(!a.youTubeIframeAPIReady){var B=b.defer();a.youTubeIframeAPIReady=B.promise,a.onYouTubeIframeAPIReady=function(){B.resolve()}}if(!z){var C=document.createElement("script");C.src="//www.youtube.com/iframe_api";var D=document.getElementsByTagName("script")[0];D.parentNode.insertBefore(C,D)}a.youTubeIframeAPIReady.then(t),angular.element(a).on("resize",g(function(){n(),o()},300))}}}}]);