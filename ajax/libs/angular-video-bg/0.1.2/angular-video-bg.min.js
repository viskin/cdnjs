angular.module("angularVideoBg",[]),angular.module("angularVideoBg").directive("videoBg",["$window","$q",function(a,b){return{restrict:"EA",replace:!0,scope:{videoId:"=",ratio:"=?",loop:"=?",mute:"=?",start:"=?",contentZIndex:"=?",allowClickEvents:"=?"},transclude:!0,template:'<div><div id="player"></div><div ng-transclude></div></div>',link:function(c,d,e,f){function g(a,b){var c=["top","right","bottom","left"],d=function(c,d){return c[d]=parseInt(b.call(s,a+"-"+d),10),c};return c.reduce(d,{})}function h(a,b){function c(){var a,c=Array.prototype.slice.call(arguments),d=0,e=function(b,c){return b+a[c]};for(var f in b)b.hasOwnProperty(f)&&(a=b[f],d+=c.reduce(e,0));return d}return{width:a.width+c("left","right"),height:a.height+c("top","bottom")}}function i(){var a=["width","height"],b=["border","margin","padding"];return a=a.reduce(function(a,b){return a[b]=parseInt(s.getPropertyValue(b),10),a},{}),b=b.reduce(function(a,b){return a[b]=g(b,s.getPropertyValue),a},{}),h(a,b)}function j(){var a=parseInt(q.width/c.ratio,10),b=parseInt(q.height*c.ratio,10),d=q.height<a;return{width:d?q.width:b,height:d?a:q.height}}function k(){q=i(),r=j()}function l(){var a=d.children().eq(1),b=d.children().eq(0);a.css({position:"relative",zIndex:c.contentZIndex||99});var e={zIndex:1,position:"absolute",width:r.width+"px",height:r.height+"px",left:"0",top:parseInt((q.height-r.height)/2,10)+"px"};c.allowClickEvents||(e.pointerEvents="none"),b.css(e)}function m(){c.mute&&!p.isMuted()?p.mute():p.isMuted()&&p.unMute()}function n(){k(),p=new YT.Player("player",{width:q.width,height:parseInt(q.width/c.ratio,10),videoId:c.videoId,playerVars:{autoplay:1,controls:0,iv_load_policy:3,loop:c.loop?1:0,playsinline:1,rel:0,showinfo:0,start:c.start||0},events:{onReady:m}}),l()}function o(a,b){var c;return function(){var d=this,e=arguments,f=function(){c=null,a.apply(d,e)};clearTimeout(c),c=setTimeout(f,b)}}d.css({position:"relative",overflow:"hidden"}),c.ratio=c.ratio||16/9,c.mute=void 0===c.mute?!0:c.mute;var p,q,r,s=a.getComputedStyle(d[0]),t=b.defer(),u=document.createElement("script");a.onYouTubeIframeAPIReady=function(){t.resolve()},u.src="https://www.youtube.com/iframe_api";var v=document.getElementsByTagName("script")[0];v.parentNode.insertBefore(u,v),t.promise.then(n),angular.element(a).on("resize",o(function(){k(),l(),console.log("Window resized!")},300))}}}]);