(function(root,factory){if(typeof define==="function"&&define.amd){define(["cldr","../globalize","./number","./plural","cldr/event","cldr/supplemental"],factory)}else if(typeof exports==="object"){module.exports=factory(require("cldrjs"),require("globalize"))}else{factory(root.Cldr,root.Globalize)}})(this,function(Cldr,Globalize){var formatMessage=Globalize._formatMessage,validateCldr=Globalize._validateCldr,validateDefaultLocale=Globalize._validateDefaultLocale,validateParameterPresence=Globalize._validateParameterPresence,validateParameterTypeString=Globalize._validateParameterTypeString,validateParameterTypeNumber=Globalize._validateParameterTypeNumber;var relativeTimeFormat=function(value,numberFormatter,pluralGenerator,properties){var relativeTime,message=properties["relative-type-"+value];if(message){return message}relativeTime=value<=0?properties["relativeTime-type-past"]:properties["relativeTime-type-future"];value=Math.abs(value);message=relativeTime["relativeTimePattern-count-"+pluralGenerator(value)];return formatMessage(message,[numberFormatter(value)])};var relativeTimeProperties=function(unit,cldr,options){var form=options.form,raw,properties,key,match;if(form){unit=unit+"-"+form}raw=cldr.main(["dates","fields",unit]);properties={"relativeTime-type-future":raw["relativeTime-type-future"],"relativeTime-type-past":raw["relativeTime-type-past"]};for(key in raw){if(raw.hasOwnProperty(key)){match=/relative-type-(-?[0-9]+)/.exec(key);if(match){properties[key]=raw[key]}}}return properties};Globalize.formatRelativeTime=Globalize.prototype.formatRelativeTime=function(value,unit,options){validateParameterPresence(value,"value");validateParameterTypeNumber(value,"value");return this.relativeTimeFormatter(unit,options)(value)};Globalize.relativeTimeFormatter=Globalize.prototype.relativeTimeFormatter=function(unit,options){var cldr,numberFormatter,pluralGenerator,properties;validateParameterPresence(unit,"unit");validateParameterTypeString(unit,"unit");cldr=this.cldr;options=options||{};validateDefaultLocale(cldr);cldr.on("get",validateCldr);properties=relativeTimeProperties(unit,cldr,options);cldr.off("get",validateCldr);numberFormatter=this.numberFormatter(options);pluralGenerator=this.pluralGenerator();return function(value){validateParameterPresence(value,"value");validateParameterTypeNumber(value,"value");return relativeTimeFormat(value,numberFormatter,pluralGenerator,properties)}};return Globalize});