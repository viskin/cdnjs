var sinon=function(){function e(e){try{n.appendChild(e),n.removeChild(e)}catch(t){return!1}return!0}function t(t){return n&&t&&1===t.nodeType&&e(t)}var n="undefined"!=typeof document&&document.createElement("div");return{wrapMethod:function(e,t,n){if(!e)throw new TypeError("Should wrap property of object");if("function"!=typeof n)throw new TypeError("Method wrapper should be function");var r=e[t],i=typeof r;if("function"!=i)throw new TypeError("Attempted to wrap "+i+" property "+t+" as function");if(r.restore&&r.restore.sinon)throw new TypeError("Attempted to wrap "+t+" which is already wrapped");if(r.calledBefore){var s=r.returns?"stubbed":"spied on";throw new TypeError("Attempted to wrap "+t+" which is already "+s)}return e[t]=n,n.displayName=t,n.restore=function(){e[t]=r},n.restore.sinon=!0,n},extend:function(e){for(var t=1,n=arguments.length;n>t;t+=1)for(var r in arguments[t])arguments[t].hasOwnProperty(r)&&(e[r]=arguments[t][r]);return e},create:function(e){if(Object.create)return Object.create(e);var t=function(){};return t.prototype=e,new t},deepEqual:function r(e,n){if("object"!=typeof e||"object"!=typeof n)return e===n;if(t(e)||t(n))return e===n;if(e===n)return!0;if("[object Array]"==Object.prototype.toString.call(e)){if(e.length!==n.length)return!1;for(var i=0,s=e.length;s>i;i+=1)if(!r(e[i],n[i]))return!1;return!0}var o,a=0,u=0;for(o in e)if(a+=1,!r(e[o],n[o]))return!1;for(o in n)u+=1;return a!=u?!1:!0},keys:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t.sort()},functionName:function(e){var t=e.displayName||e.name;if(!t){var n=e.toString().match(/function ([^\s\(]+)/);t=n&&n[1]}return t},functionToString:function(){if(this.getCall&&this.callCount)for(var e,t,n=this.callCount;n--;){e=this.getCall(n).thisValue;for(t in e)if(e[t]===this)return t}return this.displayName||"sinon fake"},getConfig:function(e){var t={};e=e||{};var n=sinon.defaultConfig;for(var r in n)n.hasOwnProperty(r)&&(t[r]=e.hasOwnProperty(r)?e[r]:n[r]);return t},defaultConfig:{injectIntoThis:!0,injectInto:null,properties:["spy","stub","mock","clock","server","requests"],useFakeTimers:!0,useFakeServer:!0}}}();if("object"==typeof module&&"function"==typeof require&&(require.paths.unshift(__dirname),module.exports=sinon,module.exports.spy=require("sinon/spy"),module.exports.stub=require("sinon/stub"),module.exports.mock=require("sinon/mock"),module.exports.collection=require("sinon/collection"),module.exports.assert=require("sinon/assert"),module.exports.test=require("sinon/test"),module.exports.testCase=require("sinon/test_case"),require.paths.shift()),function(e){function t(n,r){if(!r&&"function"==typeof n)return t.create(n);if(!n||!r)return t.create(function(){});var i=n[r];return e.wrapMethod(n,r,t.create(i))}var n,r="object"==typeof module&&"function"==typeof require,i=0;!e&&r&&(e=require("sinon")),e&&(e.extend(t,function(){function r(e,t,n,r){e[t]=function(){if(!this.called)return!1;for(var e,i=0,s=0,o=this.callCount;o>s;s+=1)if(e=this.getCall(s),e[r||t].apply(e,arguments)&&(i+=1,n))return!0;return i===this.callCount}}var s=Array.prototype.slice,o={called:!1,calledOnce:!1,calledTwice:!1,calledThrice:!1,callCount:0,create:function(n){function r(){return r.invoke(n,this,s.call(arguments))}var i;return"function"!=typeof n?n=function(){}:i=e.functionName(n),e.extend(r,t),delete r.create,e.extend(r,n),r.args=[],r.returnValues=[],r.thisValues=[],r.exceptions=[],r.callIds=[],r.prototype=n.prototype,r.displayName=i||"spy",r.toString=e.functionToString,r},invoke:function(e,t,n){var r,s;this.called=!0,this.callCount+=1,this.calledOnce=1==this.callCount,this.calledTwice=2==this.callCount,this.calledThrice=3==this.callCount,this.thisValues.push(t),this.args.push(n),this.callIds.push(i++);try{s=e.apply(t,n)}catch(o){throw this.returnValues.push(void 0),r=o,o}finally{this.exceptions.push(r)}return this.returnValues.push(s),s},getCall:function(e){return 0>e||e>=this.callCount?null:n.create(this.thisValues[e],this.args[e],this.returnValues[e],this.exceptions[e],this.callIds[e])},calledBefore:function(e){return this.called?e.called?this.callIds[0]<e.callIds[0]:!0:!1},calledAfter:function(e){return this.called&&e.called?this.callIds[this.callCount-1]>e.callIds[e.callCount-1]:!1}};return r(o,"calledOn",!0),r(o,"alwaysCalledOn",!1,"calledOn"),r(o,"calledWith",!0),r(o,"alwaysCalledWith",!1,"calledWith"),r(o,"calledWithExactly",!0),r(o,"alwaysCalledWithExactly",!1,"calledWithExactly"),r(o,"threw",!0),r(o,"alwaysThrew",!1,"threw"),r(o,"returned",!0),r(o,"alwaysReturned",!1,"returned"),o}()),n=function(){return{create:function(t,r,s,o,a){var u=e.create(n);return delete u.create,u.thisValue=t,u.args=r,u.returnValue=s,u.exception=o,u.callId="number"==typeof a&&a||i++,u},calledOn:function(e){return this.thisValue===e},calledWith:function(){for(var t=0,n=arguments.length;n>t;t+=1)if(!e.deepEqual(arguments[t],this.args[t]))return!1;return!0},calledWithExactly:function(){return arguments.length==this.args.length&&this.calledWith.apply(this,arguments)},returned:function(e){return this.returnValue===e},threw:function(e){return"undefined"!=typeof e&&this.exception?"string"==typeof e?this.exception.name==e:this.exception===e:!!this.exception},calledBefore:function(e){return this.callId<e.callId},calledAfter:function(e){return this.callId>e.callId}}}(),r?module.exports=t:(e.spy=t,e.spyCall=n))}("object"==typeof sinon&&sinon||null),function(e){function t(n,r,i){if(i&&"function"!=typeof i)throw new TypeError("Custom stub should be function");var s;if(s=i?e.spy&&e.spy.create?e.spy.create(i):i:t.create(),!n&&!r)return e.stub.create();if(!r&&n&&"object"==typeof n){for(var o in n)n.hasOwnProperty(o)&&"function"==typeof n[o]&&t(n,o);return n}return e.wrapMethod(n,r,s)}var n="object"==typeof module&&"function"==typeof require;!e&&n&&(e=require("sinon")),e&&(e.extend(t,function(){var n=Array.prototype.slice;return{create:function(){var n=function(){if(n.exception)throw n.exception;if("number"==typeof n.callArgAt){var e=arguments[n.callArgAt];if("function"!=typeof e)throw new TypeError("argument at index "+n.callArgAt+" is not a function: "+e);e.apply(null,n.callbackArguments)}return n.returnValue};return e.spy&&(n=e.spy.create(n)),e.extend(n,t),n.displayName="stub",n.toString=e.functionToString,n},returns:function(e){return this.returnValue=e,this},"throws":function(e,t){return"string"==typeof e?(this.exception=new Error(t),this.exception.name=e):this.exception=e?e:new Error("Error"),this},callsArg:function(e){if("number"!=typeof e)throw new TypeError("argument index is not number");this.callArgAt=e,this.callbackArguments=[]},callsArgWith:function(e){if("number"!=typeof e)throw new TypeError("argument index is not number");this.callArgAt=e,this.callbackArguments=n.call(arguments,1)}}}()),n?module.exports=t:e.stub=t)}("object"==typeof sinon&&sinon||null),function(e){function t(n){return n?t.create(n):e.expectation.create("Anonymous mock")}function n(e){var t=new Error(e);throw t.name="ExpectationError",t}var r="object"==typeof module&&"function"==typeof require;!e&&r&&(e=require("sinon")),e&&(e.mock=t,e.extend(t,function(){function n(e,t){if(e)for(var n=0,r=e.length;r>n;n+=1)t(e[n])}return{create:function(n){if(!n)throw new TypeError("object is null");var r=e.extend({},t);return r.object=n,delete r.create,r},expects:function(t){if(!t)throw new TypeError("method is falsy");if(this.expectations||(this.expectations={},this.proxies=[]),!this.expectations[t]){this.expectations[t]=[];var n=this;e.wrapMethod(this.object,t,function(){return n.invokeMethod(t,this,arguments)}),this.proxies.push(t)}var r=e.expectation.create(t);return this.expectations[t].push(r),r},restore:function(){var e=this.object;n(this.proxies,function(t){"function"==typeof e[t].restore&&e[t].restore()})},verify:function(){var e,t=this.expectations||{};try{n(this.proxies,function(e){n(t[e],function(e){e.verify()})})}catch(r){e=r}if(this.restore(),e)throw e;return!0},invokeMethod:function(e,t,n){for(var r=this.expectations&&this.expectations[e],i=r&&r.length||0,s=0;i>s;s+=1)if(!r[s].met())return r[s].apply(t,n);return r[i-1].apply(t,n)}}}()),e.expectation=function(){function t(e){return 1==e?"once":2==e?"twice":3==e?"thrice":e+" times"}function r(e){var t="number"==typeof e.minCalls;return!t||e.callCount>=e.minCalls}function i(e){return"number"!=typeof e.maxCalls?!1:e.callCount==e.maxCalls}var s=Array.prototype.slice,o=e.spy.invoke;return{minCalls:1,maxCalls:1,create:function(t){var n=e.extend(e.stub.create(),e.expectation);return delete n.create,n.method=t,n},invoke:function(e,t,n){return this.verifyCallAllowed(t,n),o.apply(this,arguments)},atLeast:function(e){if("number"!=typeof e)throw new TypeError("'"+e+"' is not number");return this.limitsSet||(this.maxCalls=null,this.limitsSet=!0),this.minCalls=e,this},atMost:function(e){if("number"!=typeof e)throw new TypeError("'"+e+"' is not number");return this.limitsSet||(this.minCalls=null,this.limitsSet=!0),this.maxCalls=e,this},never:function(){return this.exactly(0)},once:function(){return this.exactly(1)},twice:function(){return this.exactly(2)},thrice:function(){return this.exactly(3)},exactly:function(e){if("number"!=typeof e)throw new TypeError("'"+e+"' is not a number");return this.atLeast(e),this.atMost(e)},met:function(){return!this.failed&&r(this)},verifyCallAllowed:function(r,s){if(i(this)&&(this.failed=!0,n(this.method+" already called "+t(this.maxCalls))),"expectedThis"in this&&this.expectedThis!==r&&n(this.method+" called with "+r+" as thisValue, expected "+this.expectedThis),"expectedArguments"in this){s&&0!==s.length||n(this.method+" received no arguments, expected "+this.expectedArguments.join()),s.length<this.expectedArguments.length&&n(this.method+" received too few arguments ("+s.join()+"), expected "+this.expectedArguments.join()),this.expectsExactArgCount&&s.length!=this.expectedArguments.length&&n(this.method+" received too many arguments ("+s.join()+"), expected "+this.expectedArguments.join());for(var o=0,a=this.expectedArguments.length;a>o;o+=1)e.deepEqual(this.expectedArguments[o],s[o])||n(this.method+" received wrong arguments ("+s.join()+"), expected "+this.expectedArguments.join())}},withArgs:function(){return this.expectedArguments=s.call(arguments),this},withExactArgs:function(){return this.withArgs.apply(this,arguments),this.expectsExactArgCount=!0,this},on:function(e){return this.expectedThis=e,this},verify:function(){return this.met()||n(this.method+" expected to be called "+t(this.minCalls)+", but was called "+t(this.callCount)),!0}}}(),r?module.exports=t:e.mock=t)}("object"==typeof sinon&&sinon||null),function(e){function t(e){return e.fakes||(e.fakes=[]),e.fakes}function n(e,n){for(var r=t(e),i=0,s=r.length;s>i;i+=1)"function"==typeof r[i][n]&&r[i][n]()}var r="object"==typeof module&&"function"==typeof require;if(!e&&r&&(e=require("sinon")),e){var i={verify:function(){n(this,"verify")},restore:function(){n(this,"restore")},verifyAndRestore:function(){var e;try{this.verify()}catch(t){e=t}if(this.restore(),e)throw e},add:function(e){return t(this).push(e),e},spy:function(){return this.add(e.spy.apply(e,arguments))},stub:function(){return this.add(e.stub.apply(e,arguments))},mock:function(){return this.add(e.mock.apply(e,arguments))},inject:function(e){var t=this;return e.spy=function(){return t.spy.apply(t,arguments)},e.stub=function(){return t.stub.apply(t,arguments)},e.mock=function(){return t.mock.apply(t,arguments)},e}};r?module.exports=i:e.collection=i}}("object"==typeof sinon&&sinon||null),"undefined"==typeof this.sinon)var sinon={};if(sinon.clock=function(){function addTimer(e,t){if(0===e.length)throw new Error("Function requires at least 1 parameter");var n=id++,r=e[1]||0;return this.timeouts||(this.timeouts={}),this.timeouts[n]={id:n,func:e[0],callAt:this.now+r},t===!0&&(this.timeouts[n].interval=r),n}function parseTime(e){if(!e)return 0;var t,n=e.split(":"),r=n.length,i=r,s=0;if(r>3||!/^(\d\d:){0,2}\d\d?$/.test(e))throw new Error("tick only understands numbers and 'h:m:s'");for(;i--;){if(t=parseInt(n[i],10),t>=60)throw new Error("Invalid time "+e);s+=t*Math.pow(60,r-i-1)}return 1e3*s}function createObject(e){var t;if(Object.create)t=Object.create(e);else{var n=function(){};n.prototype=e,t=new n}return t.Date.clock=t,t}var id=0;return{now:0,create:function(e){var t=createObject(this);return"number"==typeof e&&(this.now=e),t},setTimeout:function(){return addTimer.call(this,arguments,!1)},clearTimeout:function(e){this.timeouts||(this.timeouts=[]),delete this.timeouts[e]},setInterval:function(){return addTimer.call(this,arguments,!0)},clearInterval:function(e){this.clearTimeout(e)},tick:function(e){e="number"==typeof e?e:parseTime(e);for(var t=this.now,n=this.now+e,r=this.now,i=this.firstTimerInRange(t,n);i&&n>=t;)this.timeouts[i.id]&&(t=this.now=i.callAt,this.callTimer(i)),i=this.firstTimerInRange(r,n),r=t;this.now=n},firstTimerInRange:function(e,t){var n,r,i;for(var s in this.timeouts)if(this.timeouts.hasOwnProperty(s)){if(this.timeouts[s].callAt<e||this.timeouts[s].callAt>t)continue;(!r||this.timeouts[s].callAt<r)&&(i=this.timeouts[s],r=this.timeouts[s].callAt,n={func:this.timeouts[s].func,callAt:this.timeouts[s].callAt,interval:this.timeouts[s].interval,id:this.timeouts[s].id})}return n||null},callTimer:function(timer){try{"function"==typeof timer.func?timer.func.call(null):eval(timer.func)}catch(e){}this.timeouts[timer.id]&&("number"==typeof timer.interval?this.timeouts[timer.id].callAt+=timer.interval:delete this.timeouts[timer.id])},reset:function(){this.timeouts={}},Date:function(){function e(n,r,i,s,o,a,u){switch(arguments.length){case 0:return new t(e.clock.now);case 1:return new t(n);case 2:return new t(n,r);case 3:return new t(n,r,i);case 4:return new t(n,r,i,s);case 5:return new t(n,r,i,s,o);case 6:return new t(n,r,i,s,o,a);default:return new t(n,r,i,s,o,a,u)}}var t=Date;return t.now&&(e.now=function(){return e.clock.now}),t.toSource&&(e.toSource=function(){return t.toSource()}),e.toString=function(){return t.toString()},e.prototype=t.prototype,e.parse=t.parse,e.UTC=t.UTC,e}()}}(),sinon.timers={setTimeout:setTimeout,clearTimeout:clearTimeout,setInterval:setInterval,clearInterval:clearInterval,Date:Date},sinon.useFakeTimers=function(){function e(){for(var e,t=0,r=this.methods.length;r>t;t++)e=this.methods[t],n[e]=this["_"+e]}function t(e,t){t["_"+e]=n[e],n[e]=function(){return t[e].apply(t,arguments)};for(var r in t[e])t[e].hasOwnProperty(r)&&(n[e][r]=t[e][r]);n[e].clock=t}var n=this,r=["Date","setTimeout","setInterval","clearTimeout","clearInterval"];return function(n){var i=sinon.clock.create(n);i.restore=e,i.methods=Array.prototype.slice.call(arguments,"number"==typeof n?1:0),0===i.methods.length&&(i.methods=r);for(var s=0,o=i.methods.length;o>s;s++)t(i.methods[s],i);return i}}(),"object"==typeof module&&"function"==typeof require&&(module.exports=sinon),"undefined"==typeof sinon&&(this.sinon={}),sinon.xhr={XMLHttpRequest:this.XMLHttpRequest},sinon.FakeXMLHttpRequest=function(){function e(){this.readyState=e.UNSENT,this.requestHeaders={},this.requestBody=null,this.status=0,this.statusText="","function"==typeof e.onCreate&&e.onCreate(this)}function t(t){if(t.readyState!==e.OPENED)throw new Error("INVALID_STATE_ERR");if(t.sendFlag)throw new Error("INVALID_STATE_ERR")}var n={"Accept-Charset":!0,"Accept-Encoding":!0,Connection:!0,"Content-Length":!0,Cookie:!0,Cookie2:!0,"Content-Transfer-Encoding":!0,Date:!0,Expect:!0,Host:!0,"Keep-Alive":!0,Referer:!0,TE:!0,Trailer:!0,"Transfer-Encoding":!0,Upgrade:!0,"User-Agent":!0,Via:!0};return sinon.extend(e.prototype,{async:!0,open:function(t,n,r,i,s){this.method=t,this.url=n,this.async="boolean"==typeof r?r:!0,this.username=i,this.password=s,this.responseText=null,this.responseXML=null,this.requestHeaders={},this.sendFlag=!1,this.readyStateChange(e.OPENED)},readyStateChange:function(e){this.readyState=e,"function"==typeof this.onreadystatechange&&this.onreadystatechange()},setRequestHeader:function(e,r){if(t(this),n[e]||/^(Sec-|Proxy-)/.test(e))throw new Error('Refused to set unsafe header "'+e+'"');this.requestHeaders[e]?this.requestHeaders[e]+=","+r:this.requestHeaders[e]=r},setResponseHeaders:function(t){this.responseHeaders={};for(var n in t)t.hasOwnProperty(n)&&(this.responseHeaders[n.toLowerCase()]=t[n]);this.async&&this.readyStateChange(e.HEADERS_RECEIVED)},send:function(n){if(t(this),!/^(get|head)$/i.test(this.method)){if(this.requestHeaders["Content-Type"]){var r=this.requestHeaders["Content-Type"].split(";");this.requestHeaders["Content-Type"]=r[0]+";charset=utf-8"}else this.requestHeaders["Content-Type"]="text/plain;charset=utf-8";this.requestBody=n}this.errorFlag=!1,this.sendFlag=this.async,this.readyStateChange(e.OPENED),"function"==typeof this.onSend&&this.onSend(this)},abort:function(){this.aborted=!0,this.responseText=null,this.errorFlag=!0,this.requestHeaders={},this.readyState>sinon.FakeXMLHttpRequest.OPENED&&(this.readyStateChange(sinon.FakeXMLHttpRequest.DONE),this.sendFlag=!1),this.readyState=sinon.FakeXMLHttpRequest.UNSENT},getResponseHeader:function(t){return this.readyState<e.HEADERS_RECEIVED?null:/^Set-Cookie2?$/i.test(t)?null:this.responseHeaders[t.toLowerCase()]},getAllResponseHeaders:function(){if(this.readyState<e.HEADERS_RECEIVED)return null;var t={};for(var n in this.responseHeaders)this.responseHeaders.hasOwnProperty(n)&&!/^Set-Cookie2?$/i.test(n)&&(t[n]=this.responseHeaders[n]);return t},setResponseBody:function(t){if(this.readyState==e.DONE)throw new Error("Request done");if(this.async&&this.readyState!=e.HEADERS_RECEIVED)throw new Error("No headers received");var n=this.chunkSize||10,r=0;this.responseText="";do this.async&&this.readyStateChange(e.LOADING),this.responseText+=t.substring(r,r+n),r+=n;while(r<t.length);var i=this.getResponseHeader("Content-Type");!this.responseText||i&&!/(text\/xml)|(application\/xml)|(\+xml)/.test(i)||(this.responseXML=e.parseXML(this.responseText)),this.async?this.readyStateChange(e.DONE):this.readyState=e.DONE},respond:function(t,n,r){this.setResponseHeaders(n||{}),this.status="number"==typeof t?t:200,this.statusText=e.statusCodes[this.status],this.setResponseBody(r||"")}}),sinon.extend(e,{UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4}),e.parseXML=function(e){var t;if("undefined"!=typeof DOMParser){var n=new DOMParser;t=n.parseFromString(e,"text/xml")}else t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e);return t},e.statusCodes={100:"Continue",101:"Switching Protocols",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",300:"Multiple Choice",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported"},e}(),function(e){var t=e.XMLHttpRequest,n=e.ActiveXObject,r="undefined"!=typeof ActiveXObject,i="undefined"!=typeof XMLHttpRequest;sinon.useFakeXMLHttpRequest=function(){return sinon.FakeXMLHttpRequest.restore=function(s){i&&(e.XMLHttpRequest=t),r&&(e.ActiveXObject=n),delete sinon.FakeXMLHttpRequest.restore,s!==!0&&delete sinon.FakeXMLHttpRequest.onCreate},i&&(e.XMLHttpRequest=sinon.FakeXMLHttpRequest),r&&(e.ActiveXObject=function(e){return"Microsoft.XMLHTTP"==e||/^Msxml2\.XMLHTTP/.test(e)?new sinon.FakeXMLHttpRequest:new n(e)}),sinon.FakeXMLHttpRequest}}(this),"object"==typeof module&&"function"==typeof require&&(module.exports=sinon),"undefined"==typeof this.sinon)var sinon={};if(sinon.fakeServer=function(){function e(){}function t(t){return e.prototype=t,new e}function n(e){return"[object Array]"==Object.prototype.toString.call(e)?e:[200,{},e]}function r(e,t,n){var r=e.method,i=!r||r.toLowerCase()==t.toLowerCase(),s=e.url,o=!s||s==n||"function"==typeof s.test&&s.test(n);return i&&o}function i(e,t,n){if(r(e,t,n))return!0;if(!/^https?:\/\//.test(n)||o.test(n)){var i=n.replace(o,"");return r(e,t,i)}return!1}var s=window.location,o=new RegExp("^"+s.protocol+"//"+s.host);return{create:function(){var e=t(this);return this.xhr=sinon.useFakeXMLHttpRequest(),e.requests=[],this.xhr.onCreate=function(t){e.addRequest(t)},e},addRequest:function(e){var t=this;this.requests.push(e),e.onSend=function(){t.handleRequest(this)}},getHTTPMethod:function(e){if(this.fakeHTTPMethods&&/post/i.test(e.method)){var t=e.requestBody.match(/_method=([^\b;]+)/);return t?t[1]:e.method}return e.method},handleRequest:function(e){e.async?(this.queue||(this.queue=[]),this.queue.push(e)):this.processRequest(e)},respondWith:function(e,t,r){1==arguments.length?this.response=n(e):(this.responses||(this.responses=[]),2==arguments.length&&(r=t,t=e,e=null),this.responses.push({method:e,url:t,response:n(r)}))},respond:function(){for(var e=this.queue||[],t=0,n=e.length;n>t;t++)this.processRequest(e[t]);this.queue=[]},processRequest:function(e){try{if(e.aborted)return;var t=this.response||[404,{},""];if(this.responses)for(var n=0,r=this.responses.length;r>n;n++)if(i(this.responses[n],this.getHTTPMethod(e),e.url)){t=this.responses[n].response;break}e.respond(t[0],t[1],t[2])}catch(s){}},restore:function(){return this.xhr.restore&&this.xhr.restore.apply(this.xhr,arguments)}}}(),"object"==typeof module&&"function"==typeof require&&(module.exports=sinon),function(){function e(){}e.prototype=sinon.fakeServer,sinon.fakeServerWithClock=new e,sinon.fakeServerWithClock.addRequest=function(e){if(e.async&&("object"==typeof setTimeout.clock?this.clock=setTimeout.clock:(this.clock=sinon.useFakeTimers(),this.resetClock=!0),!this.longestTimeout)){var t=this.clock.setTimeout,n=this.clock.setInterval,r=this;this.clock.setTimeout=function(e,n){return r.longestTimeout=Math.max(n,r.longestTimeout||0),t.apply(this,arguments)},this.clock.setInterval=function(e,t){return r.longestTimeout=Math.max(t,r.longestTimeout||0),n.apply(this,arguments)}}return sinon.fakeServer.addRequest.call(this,e)},sinon.fakeServerWithClock.respond=function(){var e=sinon.fakeServer.respond.apply(this,arguments);return this.clock&&(this.clock.tick(this.longestTimeout||0),this.longestTimeout=0,this.resetClock&&(this.clock.restore(),this.resetClock=!1)),e},sinon.fakeServerWithClock.restore=function(){return this.clock&&this.clock.restore(),sinon.fakeServer.restore.apply(this,arguments)}}(),"function"==typeof require){var sinon=require("sinon");sinon.extend(sinon,require("sinon/util/fake_timers"))}!function(){function e(e,t,n,r){r&&(t.injectInto?t.injectInto[n]=r:e.args.push(r))}function t(e){var t=sinon.create(sinon.sandbox);return e.useFakeServer&&("object"==typeof e.useFakeServer&&(t.serverPrototype=e.useFakeServer),t.useFakeServer()),e.useFakeTimers&&("object"==typeof e.useFakeTimers?t.useFakeTimers.apply(t,e.useFakeTimers):t.useFakeTimers()),t}sinon.sandbox=sinon.extend(sinon.create(sinon.collection),{useFakeTimers:function(){return this.clock=sinon.useFakeTimers.apply(sinon,arguments),this.add(this.clock)},serverPrototype:sinon.fakeServer,useFakeServer:function(){return this.server=(this.serverPrototype||sinon.fakeServer).create(),this.add(this.server)},inject:function(e){return sinon.collection.inject.call(this,e),this.clock&&(e.clock=this.clock),this.server&&(e.server=this.server,e.requests=this.server.requests),e},create:function(n){if(!n)return sinon.create(sinon.sandbox);var r=t(n);r.args=r.args||[];var i,s,o=r.inject({});if(n.properties)for(var a=0,u=n.properties.length;u>a;a++)i=n.properties[a],s=o[i]||"sandbox"==i&&r,e(r,n,i,s);else e(r,n,"sandbox",s);return r}}),sinon.sandbox.useFakeXMLHttpRequest=sinon.sandbox.useFakeServer,"undefined"!=typeof module&&(module.exports=sinon.sandbox)}(),function(e){function t(t){var n=typeof t;if("function"!=n)throw new TypeError("sinon.test needs to wrap a test function, got "+n);return function(){var n=e.getConfig(e.config);n.injectInto=n.injectIntoThis&&this||n.injectInto;var r,i,s=e.sandbox.create(n),o=Array.prototype.slice.call(arguments).concat(s.args);try{i=t.apply(this,o)}catch(a){r=a}if(s.verifyAndRestore(),r)throw r;return i}}var n="object"==typeof module&&"function"==typeof require;!e&&n&&(e=require("sinon")),e&&(t.config={injectIntoThis:!0,injectInto:null,properties:["spy","stub","mock","clock","server","requests"],useFakeTimers:!0,useFakeServer:!0},n?module.exports=t:e.test=t)}("object"==typeof sinon&&sinon||null),function(e){function t(e,t,n){return function(){t&&t.apply(this,arguments);var r;try{e.apply(this,arguments)}catch(i){r=i}if(n&&n.apply(this,arguments),r)throw r}}function n(n,r){if(!n||"object"!=typeof n)throw new TypeError("sinon.testCase needs an object with test functions");r=r||"test";var i,s,o,a=new RegExp("^"+r),u={},c=n.setUp,l=n.tearDown;for(i in n)if(n.hasOwnProperty(i)){if(s=n[i],/^(setUp|tearDown)$/.test(i))continue;"function"==typeof s&&a.test(i)&&(o=s,(c||l)&&(o=t(s,c,l)),u[i]=e.test(o))}return u}var r="object"==typeof module&&"function"==typeof require;!e&&r&&(e=require("sinon")),e&&Object.prototype.hasOwnProperty&&(r?module.exports=n:e.testCase=n)}("object"==typeof sinon&&sinon||null),function(e){function t(e){return 1==e&&"once"||2==e&&"twice"||3==e&&"thrice"||(e||0)+" times"}function n(e){e||s.fail("fake is not a spy"),"function"!=typeof e&&s.fail(e+" is not a function"),"function"!=typeof e.getCall&&s.fail(e+" is not stubbed")}function r(e,t){var n=e.fail||s.fail;n.call(e,t)}function i(e,i){s[e]=function(o){n(o);var u="function"==typeof o[e]?!o[e].apply(o,a.call(arguments,1)):!o[e];if(u){var c=i.replace("%c",t(o.callCount));c=c.replace("%n",o+""),c=c.replace("%*",[].slice.call(arguments,1).join(", "));for(var l=0,h=arguments.length;h>l;l++)c=c.replace("%"+l,arguments[l]);r(this,c)}else s.pass(e)}}var s,o="object"==typeof module&&"function"==typeof require,a=Array.prototype.slice;!e&&o&&(e=require("sinon")),e&&(s={failException:"AssertError",fail:function(e){var t=new Error(e);throw t.name=this.failException||s.failException,t},pass:function(){},called:function(e){n(e),e.called?s.pass("called"):r(this,"expected "+e+" to have been called at least once but was never called")},notCalled:function(e){n(e),e.called?r(this,"expected "+e+" to not have been called but was called "+t(e.callCount)):s.pass("notCalled")},callOrder:function(){n(arguments[0]);var e=[],t=[],i=!1;e.push(arguments[0]);for(var o=1,a=arguments.length;a>o;o++)n(arguments[o]),e.push(arguments[o]),arguments[o-1].calledBefore(arguments[o])||(i=!0);if(i){t=[].concat(e).sort(function(e,t){var n=e.getCall(0).callId,r=t.getCall(0).callId;return r>n?-1:1});var u,c;try{u=e.join(", "),c=t.join(", ")}catch(l){}r(this,"expected "+(u||"")+" to be called in order but were called as "+c)}else s.pass("callOrder")},callCount:function(e,i){n(e),e.callCount!=i?r(this,"expected "+e+" to be called "+t(i)+" but was called "+t(e.callCount)):s.pass("callCount")},expose:function(e,t){if(!e)throw new TypeError("target is null or undefined");t=t||{};var n="undefined"==typeof t.prefix&&"assert"||t.prefix,r=function(e){return n?n+e.substring(0,1).toUpperCase()+e.substring(1):e};for(var i in this)/^(fail|expose)/.test(i)||(e[r(i)]=this[i]);return("undefined"==typeof t.includeFail||t.includeFail)&&(e.fail=this.fail,e.failException=this.failException),e}},i("calledOnce","expected %n to be called once but was called %c"),i("calledTwice","expected %n to be called twice but was called %c"),i("calledThrice","expected %n to be called thrice but was called %c"),i("calledOn","expected %n to be called with %1 as this"),i("alwaysCalledOn","expected %n to always be called with %1 as this"),i("calledWith","expected %n to be called with arguments %*"),i("alwaysCalledWith","expected %n to always be called with arguments %*"),i("calledWithExactly","expected %n to be called with exact arguments %*"),i("alwaysCalledWithExactly","expected %n to always be called with exact arguments %*"),i("threw","%n did not throw exception"),i("alwaysThrew","%n did not always throw exception"),o?module.exports=s:e.assert=s)}("object"==typeof sinon&&sinon||null);