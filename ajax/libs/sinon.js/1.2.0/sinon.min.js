"use strict";var sinon=(function(){var a=typeof document!="undefined"&&document.createElement("div");function g(l){var m=false;try{l.appendChild(a);m=a.parentNode==l}catch(k){return false}finally{try{l.removeChild(a)}catch(k){}}return m}function f(k){return a&&k&&k.nodeType===1&&g(k)}return{wrapMethod:function h(m,o,q){if(!m){throw new TypeError("Should wrap property of object")}if(typeof q!="function"){throw new TypeError("Method wrapper should be function")}var k=m[o];var n=typeof k;if(n!="function"){throw new TypeError("Attempted to wrap "+n+" property "+o+" as function")}if(k.restore&&k.restore.sinon){throw new TypeError("Attempted to wrap "+o+" which is already wrapped")}if(k.calledBefore){var p=!!k.returns?"stubbed":"spied on";throw new TypeError("Attempted to wrap "+o+" which is already "+p)}var l=m.hasOwnProperty(o);m[o]=q;q.displayName=o;q.restore=function(){if(l){m[o]=k}else{delete m[o]}};q.restore.sinon=true;return q},extend:function d(n){for(var m=1,k=arguments.length;m<k;m+=1){for(var o in arguments[m]){if(arguments[m].hasOwnProperty(o)){n[o]=arguments[m][o]}if(arguments[m].hasOwnProperty("toString")&&arguments[m].toString!=n.toString){n.toString=arguments[m].toString}}}return n},create:function c(l){var k=function(){};k.prototype=l;return new k()},deepEqual:function i(n,k){if(typeof n!="object"||typeof k!="object"){return n===k}if(f(n)||f(k)){return n===k}if(n===k){return true}if(Object.prototype.toString.call(n)=="[object Array]"){if(n.length!==k.length){return false}for(var p=0,m=n.length;p<m;p+=1){if(!i(n[p],k[p])){return false}}return true}var r,o=0,q=0;for(r in n){o+=1;if(!i(n[r],k[r])){return false}}for(r in k){q+=1}if(o!=q){return false}return true},functionName:function e(l){var k=l.displayName||l.name;if(!k){var m=l.toString().match(/function ([^\s\(]+)/);k=m&&m[1]}return k},functionToString:function b(){if(this.getCall&&this.callCount){var k,m,l=this.callCount;while(l--){k=this.getCall(l).thisValue;for(m in k){if(k[m]===this){return m}}}}return this.displayName||"sinon fake"},getConfig:function(l){var k={};l=l||{};var m=sinon.defaultConfig;for(var n in m){if(m.hasOwnProperty(n)){k[n]=l.hasOwnProperty(n)?l[n]:m[n]}}return k},format:function(k){return""+k},defaultConfig:{injectIntoThis:true,injectInto:null,properties:["spy","stub","mock","clock","server","requests"],useFakeTimers:true,useFakeServer:true},timesInWords:function j(k){return k==1&&"once"||k==2&&"twice"||k==3&&"thrice"||(k||0)+" times"},calledInOrder:function(n){for(var m=1,k=n.length;m<k;m++){if(!n[m-1].calledBefore(n[m])){return false}}return true},orderByFirstCall:function(k){return k.sort(function(m,l){return m.getCall(0).callId<l.getCall(0).callId?-1:1})}}}());if(typeof module=="object"&&typeof require=="function"){module.exports=sinon;module.exports.spy=require("./sinon/spy");module.exports.stub=require("./sinon/stub");module.exports.mock=require("./sinon/mock");module.exports.collection=require("./sinon/collection");module.exports.assert=require("./sinon/assert");module.exports.sandbox=require("./sinon/sandbox");module.exports.test=require("./sinon/test");module.exports.testCase=require("./sinon/test_case");module.exports.assert=require("./sinon/assert")}(function(a){var f=typeof module=="object"&&typeof require=="function";var e;var d=0;var b=[].push;if(!a&&f){a=require("../sinon")}if(!a){return}function c(g,h){if(!h&&typeof g=="function"){return c.create(g)}if(!g||!h){return c.create(function(){})}var i=g[h];return a.wrapMethod(g,h,c.create(i))}a.extend(c,(function(){var n=Array.prototype.slice;function h(q,u,s,t,r){q[u]=function(){if(!this.called){return !!r}var w;var y=0;for(var x=0,v=this.callCount;x<v;x+=1){w=this.getCall(x);if(w[t||u].apply(w,arguments)){y+=1;if(s){return true}}}return y===this.callCount}}function o(s,t,r){if(!s){return}var v=t.length;for(var u=0,q=s.length;u<q;u++){if(s[u].matches(t,r)){return s[u]}}}var g=0;var l={reset:function(){this.called=false;this.calledOnce=false;this.calledTwice=false;this.calledThrice=false;this.callCount=0;this.args=[];this.returnValues=[];this.thisValues=[];this.exceptions=[];this.callIds=[]},create:function k(s){var q;if(typeof s!="function"){s=function(){}}else{q=a.functionName(s)}function r(){return r.invoke(s,this,n.call(arguments))}a.extend(r,c);delete r.create;a.extend(r,s);r.reset();r.prototype=s.prototype;r.displayName=q||"spy";r.toString=a.functionToString;r._create=a.spy.create;r.id="spy#"+g++;return r},invoke:function i(u,q,r){var w=o(this.fakes,r);var s,t;this.called=true;this.callCount+=1;this.calledOnce=this.callCount==1;this.calledTwice=this.callCount==2;this.calledThrice=this.callCount==3;b.call(this.thisValues,q);b.call(this.args,r);b.call(this.callIds,d++);try{if(w){t=w.invoke(u,q,r)}else{t=(this.func||u).apply(q,r)}}catch(v){b.call(this.returnValues,undefined);s=v;throw v}finally{b.call(this.exceptions,s)}b.call(this.returnValues,t);return t},getCall:function p(q){if(q<0||q>=this.callCount){return null}return e.create(this,this.thisValues[q],this.args[q],this.returnValues[q],this.exceptions[q],this.callIds[q])},calledBefore:function j(q){if(!this.called){return false}if(!q.called){return true}return this.callIds[0]<q.callIds[0]},calledAfter:function m(q){if(!this.called||!q.called){return false}return this.callIds[this.callCount-1]>q.callIds[q.callCount-1]},withArgs:function(){var s=n.call(arguments);if(this.fakes){var r=o(this.fakes,s,true);if(r){return r}}else{this.fakes=[]}var t=this;var q=this._create();q.matchingAguments=s;b.call(this.fakes,q);q.withArgs=function(){return t.withArgs.apply(t,arguments)};return q},matches:function(r,q){var s=this.matchingAguments;if(s.length<=r.length&&a.deepEqual(s,r.slice(0,s.length))){return !q||s.length==r.length}},printf:function(t){var s=this;var q=[].slice.call(arguments,1);var r;return(t||"").replace(/%(.)/g,function(u,v){r=l.formatters[v];if(typeof r=="function"){return r.call(null,s,q)}else{if(!isNaN(parseInt(v),10)){return a.format(q[v-1])}}return"%"+v})}};h(l,"calledOn",true);h(l,"alwaysCalledOn",false,"calledOn");h(l,"calledWith",true);h(l,"alwaysCalledWith",false,"calledWith");h(l,"calledWithExactly",true);h(l,"alwaysCalledWithExactly",false,"calledWithExactly");h(l,"neverCalledWith",false,"notCalledWith",true);h(l,"threw",true);h(l,"alwaysThrew",false,"threw");h(l,"returned",true);h(l,"alwaysReturned",false,"returned");h(l,"calledWithNew",true);h(l,"alwaysCalledWithNew",false,"calledWithNew");l.formatters={c:function(q){return a.timesInWords(q.callCount)},n:function(q){return q.toString()},C:function(t){var s=[];for(var r=0,q=t.callCount;r<q;++r){b.call(s,"    "+t.getCall(r).toString())}return s.length>0?"\n"+s.join("\n"):""},t:function(s){var t=[];for(var r=0,q=s.callCount;r<q;++r){b.call(t,a.format(s.thisValues[r]))}return t.join(", ")},"*":function(r,q){return q.join(", ")}};return l}()));e=(function(){return{create:function j(t,p,q,s,r,u){var o=a.create(e);delete o.create;o.proxy=t;o.thisValue=p;o.args=q;o.returnValue=s;o.exception=r;o.callId=typeof u=="number"&&u||d++;return o},calledOn:function h(o){return this.thisValue===o},calledWith:function k(){for(var p=0,o=arguments.length;p<o;p+=1){if(!a.deepEqual(arguments[p],this.args[p])){return false}}return true},calledWithExactly:function i(){return arguments.length==this.args.length&&this.calledWith.apply(this,arguments)},notCalledWith:function g(){for(var p=0,o=arguments.length;p<o;p+=1){if(!a.deepEqual(arguments[p],this.args[p])){return true}}return false},returned:function l(o){return this.returnValue===o},threw:function n(o){if(typeof o=="undefined"||!this.exception){return !!this.exception}if(typeof o=="string"){return this.exception.name==o}return this.exception===o},calledWithNew:function m(o){return this.thisValue instanceof this.proxy},calledBefore:function(o){return this.callId<o.callId},calledAfter:function(o){return this.callId>o.callId},toString:function(){var r=this.proxy.toString()+"(";var p=[];for(var q=0,o=this.args.length;q<o;++q){b.call(p,a.format(this.args[q]))}r=r+p.join(", ")+")";if(typeof this.returnValue!="undefined"){r+=" => "+a.format(this.returnValue)}if(this.exception){r+=" !"+this.exception.name;if(this.exception.message){r+="("+this.exception.message+")"}}return r}}}());c.spyCall=e;a.spyCall=e;if(f){module.exports=c}else{a.spy=c}}(typeof sinon=="object"&&sinon||null));(function(a){var h=typeof module=="object"&&typeof require=="function";if(!a&&h){a=require("../sinon")}if(!a){return}function g(i,k,j){if(!!j&&typeof j!="function"){throw new TypeError("Custom stub should be function")}var m;if(j){m=a.spy&&a.spy.create?a.spy.create(j):j}else{m=g.create()}if(!i&&!k){return a.stub.create()}if(!k&&!!i&&typeof i=="object"){for(var l in i){if(i.hasOwnProperty(l)&&typeof i[l]=="function"){g(i,l)}}return i}return a.wrapMethod(i,k,m)}function c(n,k){if(n.callArgAt<0){for(var m=0,j=k.length;m<j;++m){if(!n.callArgProp&&typeof k[m]=="function"){return k[m]}if(n.callArgProp&&k[m]&&typeof k[m][n.callArgProp]=="function"){return k[m][n.callArgProp]}}return null}return k[n.callArgAt]}var f=Array.prototype.join;function d(k,j,i){if(k.callArgAt<0){var l;if(k.callArgProp){l=a.functionName(k)+" expected to yield to '"+k.callArgProp+"', but no object with such a property was passed."}else{l=a.functionName(k)+" expected to yield, but no callback was passed."}if(i.length>0){l+=" Received ["+f.call(i,", ")+"]"}return l}return"argument at index "+k.callArgAt+" is not a function: "+j}function e(k,i){if(typeof k.callArgAt=="number"){var j=c(k,i);if(typeof j!="function"){throw new TypeError(d(k,j,i))}j.apply(null,k.callbackArguments)}}var b=0;a.extend(g,(function(){var n=Array.prototype.slice;function m(o,p){if(typeof o=="string"){this.exception=new Error(p||"");this.exception.name=o}else{if(!o){this.exception=new Error("Error")}else{this.exception=o}}return this}return{create:function k(){var o=function(){if(o.exception){throw o.exception}e(o,arguments);return o.returnValue};o.id="stub#"+b++;var p=o;o=a.spy.create(o);o.func=p;a.extend(o,g);o._create=a.stub.create;o.displayName="stub";o.toString=a.functionToString;return o},returns:function l(o){this.returnValue=o;return this},"throws":m,throwsException:m,callsArg:function i(o){if(typeof o!="number"){throw new TypeError("argument index is not number")}this.callArgAt=o;this.callbackArguments=[];return this},callsArgWith:function j(o){if(typeof o!="number"){throw new TypeError("argument index is not number")}this.callArgAt=o;this.callbackArguments=n.call(arguments,1);return this},yields:function(){this.callArgAt=-1;this.callbackArguments=n.call(arguments,0);return this},yieldsTo:function(o){this.callArgAt=-1;this.callArgProp=o;this.callbackArguments=n.call(arguments,1);return this}}}()));if(h){module.exports=g}else{a.stub=g}}(typeof sinon=="object"&&sinon||null));(function(b){var e=typeof module=="object"&&typeof require=="function";var c=[].push;if(!b&&e){b=require("../sinon")}if(!b){return}function a(f){if(!f){return b.expectation.create("Anonymous mock")}return a.create(f)}b.mock=a;b.extend(a,(function(){function j(o,p){if(!o){return}for(var n=0,m=o.length;n<m;n+=1){p(o[n])}}return{create:function g(l){if(!l){throw new TypeError("object is null")}var m=b.extend({},a);m.object=l;delete m.create;return m},expects:function f(n){if(!n){throw new TypeError("method is falsy")}if(!this.expectations){this.expectations={};this.proxies=[]}if(!this.expectations[n]){this.expectations[n]=[];var m=this;b.wrapMethod(this.object,n,function(){return m.invokeMethod(n,this,arguments)});c.call(this.proxies,n)}var l=b.expectation.create(n);c.call(this.expectations[n],l);return l},restore:function i(){var l=this.object;j(this.proxies,function(m){if(typeof l[m].restore=="function"){l[m].restore()}})},verify:function k(){var n=this.expectations||{};var m=[],l=[];j(this.proxies,function(o){j(n[o],function(p){if(!p.met()){c.call(m,p.toString())}else{c.call(l,p.toString())}})});this.restore();if(m.length>0){b.expectation.fail(m.concat(l).join("\n"))}return true},invokeMethod:function h(r,l,m){var q=this.expectations&&this.expectations[r];var p=q&&q.length||0;for(var n=0;n<p;n+=1){if(!q[n].met()&&q[n].allowsCall(l,m)){return q[n].apply(l,m)}}var o=[];for(n=0;n<p;n+=1){c.call(o,"    "+q[n].toString())}o.unshift("Unexpected call: "+b.spyCall.toString.call({proxy:r,args:m}));b.expectation.fail(o.join("\n"))}}}()));var d=b.timesInWords;b.expectation=(function(){var u=Array.prototype.slice;var q=b.spy.invoke;function i(B){if(B==0){return"never called"}else{return"called "+d(B)}}function j(C){var D=C.minCalls;var B=C.maxCalls;if(typeof D=="number"&&typeof B=="number"){var E=d(D);if(D!=B){E="at least "+E+" and at most "+d(B)}return E}if(typeof D=="number"){return"at least "+d(D)}return"at most "+d(B)}function x(B){var C=typeof B.minCalls=="number";return !C||B.callCount>=B.minCalls}function n(B){if(typeof B.maxCalls!="number"){return false}return B.callCount==B.maxCalls}return{minCalls:1,maxCalls:1,create:function s(B){var C=b.extend(b.stub.create(),b.expectation);delete C.create;C.method=B;return C},invoke:function A(D,B,C){this.verifyCallAllowed(B,C);return q.apply(this,arguments)},atLeast:function p(B){if(typeof B!="number"){throw new TypeError("'"+B+"' is not number")}if(!this.limitsSet){this.maxCalls=null;this.limitsSet=true}this.minCalls=B;return this},atMost:function z(B){if(typeof B!="number"){throw new TypeError("'"+B+"' is not number")}if(!this.limitsSet){this.minCalls=null;this.limitsSet=true}this.maxCalls=B;return this},never:function k(){return this.exactly(0)},once:function y(){return this.exactly(1)},twice:function w(){return this.exactly(2)},thrice:function g(){return this.exactly(3)},exactly:function l(B){if(typeof B!="number"){throw new TypeError("'"+B+"' is not a number")}this.atLeast(B);return this.atMost(B)},met:function m(){return !this.failed&&x(this)},verifyCallAllowed:function t(C,D){if(n(this)){this.failed=true;b.expectation.fail(this.method+" already called "+d(this.maxCalls))}if("expectedThis" in this&&this.expectedThis!==C){b.expectation.fail(this.method+" called with "+C+" as thisValue, expected "+this.expectedThis)}if(!("expectedArguments" in this)){return}if(!D||D.length===0){b.expectation.fail(this.method+" received no arguments, expected "+this.expectedArguments.join())}if(D.length<this.expectedArguments.length){b.expectation.fail(this.method+" received too few arguments ("+D.join()+"), expected "+this.expectedArguments.join())}if(this.expectsExactArgCount&&D.length!=this.expectedArguments.length){b.expectation.fail(this.method+" received too many arguments ("+D.join()+"), expected "+this.expectedArguments.join())}for(var E=0,B=this.expectedArguments.length;E<B;E+=1){if(!b.deepEqual(this.expectedArguments[E],D[E])){b.expectation.fail(this.method+" received wrong arguments ("+D.join()+"), expected "+this.expectedArguments.join())}}},allowsCall:function h(C,D){if(this.met()){return false}if("expectedThis" in this&&this.expectedThis!==C){return false}if(!("expectedArguments" in this)){return true}D=D||[];if(D.length<this.expectedArguments.length){return false}if(this.expectsExactArgCount&&D.length!=this.expectedArguments.length){return false}for(var E=0,B=this.expectedArguments.length;E<B;E+=1){if(!b.deepEqual(this.expectedArguments[E],D[E])){return false}}return true},withArgs:function v(){this.expectedArguments=u.call(arguments);return this},withExactArgs:function o(){this.withArgs.apply(this,arguments);this.expectsExactArgCount=true;return this},on:function r(B){this.expectedThis=B;return this},toString:function(){var B=(this.expectedArguments||[]).slice();if(!this.expectsExactArgCount){c.call(B,"[...]")}var D=b.spyCall.toString.call({proxy:this.method,args:B});var C=D.replace(", [...","[, ...")+" "+j(this);if(this.met()){return"Expectation met: "+C}return"Expected "+C+" ("+i(this.callCount)+")"},verify:function f(){if(!this.met()){b.expectation.fail(this.toString())}return true},fail:function(C){var B=new Error(C);B.name="ExpectationError";throw B}}}());if(e){module.exports=a}else{b.mock=a}}(typeof sinon=="object"&&sinon||null));(function(b){var k=typeof module=="object"&&typeof require=="function";var j=[].push;if(!b&&k){b=require("../sinon")}if(!b){return}function f(p){if(!p.fakes){p.fakes=[]}return p.fakes}function m(t,s){var q=f(t);for(var r=0,p=q.length;r<p;r+=1){if(typeof q[r][s]=="function"){q[r][s]()}}}function i(r){var p=f(r);var q=0;while(q<p.length){p.splice(q,1)}}var e={verify:function n(){m(this,"verify")},restore:function h(){m(this,"restore");i(this)},verifyAndRestore:function a(){var p;try{this.verify()}catch(q){p=q}this.restore();if(p){throw p}},add:function o(p){j.call(f(this),p);return p},spy:function l(){return this.add(b.spy.apply(b,arguments))},stub:function c(p,s,r){if(s){var q=p[s];if(typeof q!="function"){if(!p.hasOwnProperty(s)){throw new TypeError("Cannot stub non-existent own property "+s)}p[s]=r;return this.add({restore:function(){p[s]=q}})}}return this.add(b.stub.apply(b,arguments))},mock:function g(){return this.add(b.mock.apply(b,arguments))},inject:function d(q){var p=this;q.spy=function(){return p.spy.apply(p,arguments)};q.stub=function(){return p.stub.apply(p,arguments)};q.mock=function(){return p.mock.apply(p,arguments)};return q}};if(k){module.exports=e}else{b.collection=e}}(typeof sinon=="object"&&sinon||null));if(typeof sinon=="undefined"){var sinon={}}sinon.clock=(function(){var id=0;function addTimer(args,recurring){if(args.length===0){throw new Error("Function requires at least 1 parameter")}var toId=id++;var delay=args[1]||0;if(!this.timeouts){this.timeouts={}}this.timeouts[toId]={id:toId,func:args[0],callAt:this.now+delay};if(recurring===true){this.timeouts[toId].interval=delay}return toId}function parseTime(str){if(!str){return 0}var strings=str.split(":");var l=strings.length,i=l;var ms=0,parsed;if(l>3||!/^(\d\d:){0,2}\d\d?$/.test(str)){throw new Error("tick only understands numbers and 'h:m:s'")}while(i--){parsed=parseInt(strings[i],10);if(parsed>=60){throw new Error("Invalid time "+str)}ms+=parsed*Math.pow(60,(l-i-1))}return ms*1000}function createObject(object){var newObject;if(Object.create){newObject=Object.create(object)}else{var F=function(){};F.prototype=object;newObject=new F()}newObject.Date.clock=newObject;return newObject}return{now:0,create:function create(now){var clock=createObject(this);if(typeof now=="number"){this.now=now}return clock},setTimeout:function setTimeout(callback,timeout){return addTimer.call(this,arguments,false)},clearTimeout:function clearTimeout(timerId){if(!this.timeouts){this.timeouts=[]}delete this.timeouts[timerId]},setInterval:function setInterval(callback,timeout){return addTimer.call(this,arguments,true)},clearInterval:function clearInterval(timerId){this.clearTimeout(timerId)},tick:function tick(ms){ms=typeof ms=="number"?ms:parseTime(ms);var tickFrom=this.now,tickTo=this.now+ms,previous=this.now;var timer=this.firstTimerInRange(tickFrom,tickTo);while(timer&&tickFrom<=tickTo){if(this.timeouts[timer.id]){tickFrom=this.now=timer.callAt;this.callTimer(timer)}timer=this.firstTimerInRange(previous,tickTo);previous=tickFrom}this.now=tickTo},firstTimerInRange:function(from,to){var timer,smallest,originalTimer;for(var id in this.timeouts){if(this.timeouts.hasOwnProperty(id)){if(this.timeouts[id].callAt<from||this.timeouts[id].callAt>to){continue}if(!smallest||this.timeouts[id].callAt<smallest){originalTimer=this.timeouts[id];smallest=this.timeouts[id].callAt;timer={func:this.timeouts[id].func,callAt:this.timeouts[id].callAt,interval:this.timeouts[id].interval,id:this.timeouts[id].id}}}}return timer||null},callTimer:function(timer){try{if(typeof timer.func=="function"){timer.func.call(null)}else{eval(timer.func)}}catch(e){}if(!this.timeouts[timer.id]){return}if(typeof timer.interval=="number"){this.timeouts[timer.id].callAt+=timer.interval}else{delete this.timeouts[timer.id]}},reset:function reset(){this.timeouts={}},Date:(function(){var NativeDate=Date;function ClockDate(year,month,date,hour,minute,second,ms){switch(arguments.length){case 0:return new NativeDate(ClockDate.clock.now);case 1:return new NativeDate(year);case 2:return new NativeDate(year,month);case 3:return new NativeDate(year,month,date);case 4:return new NativeDate(year,month,date,hour);case 5:return new NativeDate(year,month,date,hour,minute);case 6:return new NativeDate(year,month,date,hour,minute,second);default:return new NativeDate(year,month,date,hour,minute,second,ms)}}if(NativeDate.now){ClockDate.now=function now(){return ClockDate.clock.now}}if(NativeDate.toSource){ClockDate.toSource=function toSource(){return NativeDate.toSource()}}ClockDate.toString=function toString(){return NativeDate.toString()};ClockDate.prototype=NativeDate.prototype;ClockDate.parse=NativeDate.parse;ClockDate.UTC=NativeDate.UTC;return ClockDate}())}}());sinon.timers={setTimeout:setTimeout,clearTimeout:clearTimeout,setInterval:setInterval,clearInterval:clearInterval,Date:Date};sinon.useFakeTimers=(function(d){var b=["Date","setTimeout","setInterval","clearTimeout","clearInterval"];function c(){var h;for(var g=0,f=this.methods.length;g<f;g++){h=this.methods[g];d[h]=this["_"+h]}}function e(h,f){f["_"+h]=d[h];d[h]=function(){return f[h].apply(f,arguments)};for(var g in f[h]){if(f[h].hasOwnProperty(g)){d[h][g]=f[h][g]}}d[h].clock=f}return function a(g){var j=sinon.clock.create(g);j.restore=c;j.methods=Array.prototype.slice.call(arguments,typeof g=="number"?1:0);if(j.methods.length===0){j.methods=b}for(var h=0,f=j.methods.length;h<f;h++){e(j.methods[h],j)}return j}}(typeof global!="undefined"?global:this));if(typeof module=="object"&&typeof require=="function"){module.exports=sinon}if(typeof sinon=="undefined"){this.sinon={}}(function(){var b=[].push;sinon.Event=function a(h,g,f){this.initEvent(h,g,f)};sinon.Event.prototype={initEvent:function(h,g,f){this.type=h;this.bubbles=g;this.cancelable=f},stopPropagation:function(){},preventDefault:function(){this.defaultPrevented=true}};sinon.EventTarget={addEventListener:function d(g,h,f){this.eventListeners=this.eventListeners||{};this.eventListeners[g]=this.eventListeners[g]||[];b.call(this.eventListeners[g],h)},removeEventListener:function c(k,m,f){var j=this.eventListeners&&this.eventListeners[k]||[];for(var h=0,g=j.length;h<g;++h){if(j[h]==m){return j.splice(h,1)}}},dispatchEvent:function e(j){var h=j.type;var g=this.eventListeners&&this.eventListeners[h]||[];for(var f=0;f<g.length;f++){if(typeof g[f]=="function"){g[f].call(this,j)}else{g[f].handleEvent(j)}}return !!j.defaultPrevented}}}());if(typeof sinon=="undefined"){this.sinon={}}sinon.xhr={XMLHttpRequest:this.XMLHttpRequest};sinon.FakeXMLHttpRequest=(function(){var k={"Accept-Charset":true,"Accept-Encoding":true,Connection:true,"Content-Length":true,Cookie:true,Cookie2:true,"Content-Transfer-Encoding":true,Date:true,Expect:true,Host:true,"Keep-Alive":true,Referer:true,TE:true,Trailer:true,"Transfer-Encoding":true,Upgrade:true,"User-Agent":true,Via:true};function f(){this.readyState=f.UNSENT;this.requestHeaders={};this.requestBody=null;this.status=0;this.statusText="";if(typeof f.onCreate=="function"){f.onCreate(this)}}function j(o){if(o.readyState!==f.OPENED){throw new Error("INVALID_STATE_ERR")}if(o.sendFlag){throw new Error("INVALID_STATE_ERR")}}sinon.extend(f.prototype,sinon.EventTarget,{async:true,open:function i(s,p,q,r,o){this.method=s;this.url=p;this.async=typeof q=="boolean"?q:true;this.username=r;this.password=o;this.responseText=null;this.responseXML=null;this.requestHeaders={};this.sendFlag=false;this.readyStateChange(f.OPENED)},readyStateChange:function m(o){this.readyState=o;if(typeof this.onreadystatechange=="function"){this.onreadystatechange()}this.dispatchEvent(new sinon.Event("readystatechange"))},setRequestHeader:function h(p,o){j(this);if(k[p]||/^(Sec-|Proxy-)/.test(p)){throw new Error('Refused to set unsafe header "'+p+'"')}if(this.requestHeaders[p]){this.requestHeaders[p]+=","+o}else{this.requestHeaders[p]=o}},setResponseHeaders:function l(o){this.responseHeaders={};for(var p in o){if(o.hasOwnProperty(p)){this.responseHeaders[p]=o[p]}}if(this.async){this.readyStateChange(f.HEADERS_RECEIVED)}},send:function e(p){j(this);if(!/^(get|head)$/i.test(this.method)){if(this.requestHeaders["Content-Type"]){var o=this.requestHeaders["Content-Type"].split(";");this.requestHeaders["Content-Type"]=o[0]+";charset=utf-8"}else{this.requestHeaders["Content-Type"]="text/plain;charset=utf-8"}this.requestBody=p}this.errorFlag=false;this.sendFlag=this.async;this.readyStateChange(f.OPENED);if(typeof this.onSend=="function"){this.onSend(this)}},abort:function g(){this.aborted=true;this.responseText=null;this.errorFlag=true;this.requestHeaders={};if(this.readyState>sinon.FakeXMLHttpRequest.UNSENT&&this.sendFlag){this.readyStateChange(sinon.FakeXMLHttpRequest.DONE);this.sendFlag=false}this.readyState=sinon.FakeXMLHttpRequest.UNSENT},getResponseHeader:function n(p){if(this.readyState<f.HEADERS_RECEIVED){return null}if(/^Set-Cookie2?$/i.test(p)){return null}p=p.toLowerCase();for(var o in this.responseHeaders){if(o.toLowerCase()==p){return this.responseHeaders[o]}}return null},getAllResponseHeaders:function c(){if(this.readyState<f.HEADERS_RECEIVED){return""}var o="";for(var p in this.responseHeaders){if(this.responseHeaders.hasOwnProperty(p)&&!/^Set-Cookie2?$/i.test(p)){o+=p+": "+this.responseHeaders[p]+"\r\n"}}return o},setResponseBody:function b(o){if(this.readyState==f.DONE){throw new Error("Request done")}if(this.async&&this.readyState!=f.HEADERS_RECEIVED){throw new Error("No headers received")}var s=this.chunkSize||10;var p=0;this.responseText="";do{if(this.async){this.readyStateChange(f.LOADING)}this.responseText+=o.substring(p,p+s);p+=s}while(p<o.length);var q=this.getResponseHeader("Content-Type");if(this.responseText&&(!q||/(text\/xml)|(application\/xml)|(\+xml)/.test(q))){try{this.responseXML=f.parseXML(this.responseText)}catch(r){}}if(this.async){this.readyStateChange(f.DONE)}else{this.readyState=f.DONE}},respond:function a(p,q,o){this.setResponseHeaders(q||{});this.status=typeof p=="number"?p:200;this.statusText=f.statusCodes[this.status];this.setResponseBody(o||"")}});sinon.extend(f,{UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4});f.parseXML=function d(p){var o;if(typeof DOMParser!="undefined"){var q=new DOMParser();o=q.parseFromString(p,"text/xml")}else{o=new ActiveXObject("Microsoft.XMLDOM");o.async="false";o.loadXML(p)}return o};f.statusCodes={100:"Continue",101:"Switching Protocols",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",300:"Multiple Choice",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported"};return f}());(function(d){var a=d.XMLHttpRequest;var b=d.ActiveXObject;var e=typeof ActiveXObject!="undefined";var c=typeof XMLHttpRequest!="undefined";sinon.useFakeXMLHttpRequest=function(){sinon.FakeXMLHttpRequest.restore=function f(h){if(c){d.XMLHttpRequest=a}if(e){d.ActiveXObject=b}delete sinon.FakeXMLHttpRequest.restore;if(h!==true){delete sinon.FakeXMLHttpRequest.onCreate}};if(c){d.XMLHttpRequest=sinon.FakeXMLHttpRequest}if(e){d.ActiveXObject=function g(h){if(h=="Microsoft.XMLHTTP"||/^Msxml2\.XMLHTTP/i.test(h)){return new sinon.FakeXMLHttpRequest()}return new b(h)}}return sinon.FakeXMLHttpRequest}}(this));if(typeof module=="object"&&typeof require=="function"){module.exports=sinon}if(typeof sinon=="undefined"){var sinon={}}sinon.fakeServer=(function(){var j=[].push;function o(){}function d(p){o.prototype=p;return new o()}function m(q){var p=q;if(Object.prototype.toString.call(q)!="[object Array]"){p=[200,{},q]}if(typeof p[2]!="string"){throw new TypeError("Fake server response body should be string, but was "+typeof p[2])}return p}var g=window.location;var i=new RegExp("^"+g.protocol+"//"+g.host);function f(s,r,q){var u=s.method;var p=!u||u.toLowerCase()==r.toLowerCase();var t=s.url;var v=!t||t==q||(typeof t.test=="function"&&t.test(q));return p&&v}function e(p,s){var t=this.getHTTPMethod(s);var r=s.url;if(!/^https?:\/\//.test(r)||i.test(r)){r=r.replace(i,"")}if(f(p,this.getHTTPMethod(s),r)){if(typeof p.response=="function"){var q=[s].concat(r.match(p.url).slice(1));return p.response.apply(p,q)}return true}return false}return{create:function(){var p=d(this);this.xhr=sinon.useFakeXMLHttpRequest();p.requests=[];this.xhr.onCreate=function(q){p.addRequest(q)};return p},addRequest:function c(p){var q=this;j.call(this.requests,p);p.onSend=function(){q.handleRequest(this)};if(this.autoRespond&&!this.responding){setTimeout(function(){q.responding=false;q.respond()},this.autoRespondAfter||10);this.responding=true}},getHTTPMethod:function n(p){if(this.fakeHTTPMethods&&/post/i.test(p.method)){var q=(p.requestBody||"").match(/_method=([^\b;]+)/);return !!q?q[1]:p.method}return p.method},handleRequest:function l(p){if(p.async){if(!this.queue){this.queue=[]}j.call(this.queue,p)}else{this.processRequest(p)}},respondWith:function k(r,q,p){if(arguments.length==1){this.response=m(r)}else{if(!this.responses){this.responses=[]}if(arguments.length==2){p=q;q=r;r=null}j.call(this.responses,{method:r,url:q,response:typeof p=="function"?p:m(p)})}},respond:function a(){var p=this.queue||[];var q;while(q=p.shift()){this.processRequest(q)}},processRequest:function b(s){try{if(s.aborted){return}var q=this.response||[404,{},""];if(this.responses){for(var r=0,p=this.responses.length;r<p;r++){if(e.call(this,this.responses[r],s)){q=this.responses[r].response;break}}}if(s.readyState!=4){s.respond(q[0],q[1],q[2])}}catch(t){}},restore:function h(){return this.xhr.restore&&this.xhr.restore.apply(this.xhr,arguments)}}}());if(typeof module=="object"&&typeof require=="function"){module.exports=sinon}(function(){function b(){}b.prototype=sinon.fakeServer;sinon.fakeServerWithClock=new b();sinon.fakeServerWithClock.addRequest=function d(h){if(h.async){if(typeof setTimeout.clock=="object"){this.clock=setTimeout.clock}else{this.clock=sinon.useFakeTimers();this.resetClock=true}if(!this.longestTimeout){var g=this.clock.setTimeout;var e=this.clock.setInterval;var f=this;this.clock.setTimeout=function(i,j){f.longestTimeout=Math.max(j,f.longestTimeout||0);return g.apply(this,arguments)};this.clock.setInterval=function(i,j){f.longestTimeout=Math.max(j,f.longestTimeout||0);return e.apply(this,arguments)}}}return sinon.fakeServer.addRequest.call(this,h)};sinon.fakeServerWithClock.respond=function c(){var e=sinon.fakeServer.respond.apply(this,arguments);if(this.clock){this.clock.tick(this.longestTimeout||0);this.longestTimeout=0;if(this.resetClock){this.clock.restore();this.resetClock=false}}return e};sinon.fakeServerWithClock.restore=function a(){if(this.clock){this.clock.restore()}return sinon.fakeServer.restore.apply(this,arguments)}}());if(typeof module=="object"&&typeof require=="function"){var sinon=require("../sinon");sinon.extend(sinon,require("./util/fake_timers"))}(function(){var d=[].push;function e(f,g,h,i){if(!i){return}if(g.injectInto){g.injectInto[h]=i}else{d.call(f.args,i)}}function a(g){var f=sinon.create(sinon.sandbox);if(g.useFakeServer){if(typeof g.useFakeServer=="object"){f.serverPrototype=g.useFakeServer}f.useFakeServer()}if(g.useFakeTimers){if(typeof g.useFakeTimers=="object"){f.useFakeTimers.apply(f,g.useFakeTimers)}else{f.useFakeTimers()}}return f}sinon.sandbox=sinon.extend(sinon.create(sinon.collection),{useFakeTimers:function b(){this.clock=sinon.useFakeTimers.apply(sinon,arguments);return this.add(this.clock)},serverPrototype:sinon.fakeServer,useFakeServer:function c(){var f=this.serverPrototype||sinon.fakeServer;if(!f||!f.create){return null}this.server=f.create();return this.add(this.server)},inject:function(f){sinon.collection.inject.call(this,f);if(this.clock){f.clock=this.clock}if(this.server){f.server=this.server;f.requests=this.server.requests}return f},create:function(h){if(!h){return sinon.create(sinon.sandbox)}var g=a(h);g.args=g.args||[];var n,m,k=g.inject({});if(h.properties){for(var j=0,f=h.properties.length;j<f;j++){n=h.properties[j];m=k[n]||n=="sandbox"&&g;e(g,h,n,m)}}else{e(g,h,"sandbox",m)}return g}});sinon.sandbox.useFakeXMLHttpRequest=sinon.sandbox.useFakeServer;if(typeof module!="undefined"){module.exports=sinon.sandbox}}());(function(a){var b=typeof module=="object"&&typeof require=="function";if(!a&&b){a=require("../sinon")}if(!a){return}function c(e){var d=typeof e;if(d!="function"){throw new TypeError("sinon.test needs to wrap a test function, got "+d)}return function(){var i=a.getConfig(a.config);i.injectInto=i.injectIntoThis&&this||i.injectInto;var g=a.sandbox.create(i);var j,f;var h=Array.prototype.slice.call(arguments).concat(g.args);try{f=e.apply(this,h)}catch(k){j=k}g.verifyAndRestore();if(j){throw j}return f}}c.config={injectIntoThis:true,injectInto:null,properties:["spy","stub","mock","clock","server","requests"],useFakeTimers:true,useFakeServer:true};if(b){module.exports=c}else{a.test=c}}(typeof sinon=="object"&&sinon||null));(function(c){var d=typeof module=="object"&&typeof require=="function";if(!c&&d){c=require("../sinon")}if(!c||!Object.prototype.hasOwnProperty){return}function b(g,f,e){return function(){if(f){f.apply(this,arguments)}var i,h;try{h=g.apply(this,arguments)}catch(j){i=j}if(e){e.apply(this,arguments)}if(i){throw i}return h}}function a(g,j){if(!g||typeof g!="object"){throw new TypeError("sinon.testCase needs an object with test functions")}j=j||"test";var k=new RegExp("^"+j);var h={},l,m,e;var i=g.setUp;var f=g.tearDown;for(l in g){if(g.hasOwnProperty(l)){m=g[l];if(/^(setUp|tearDown)$/.test(l)){continue}if(typeof m=="function"&&k.test(l)){e=m;if(i||f){e=b(m,i,f)}h[l]=c.test(e)}else{h[l]=g[l]}}}return h}if(d){module.exports=a}else{c.testCase=a}}(typeof sinon=="object"&&sinon||null));(function(c){var i=typeof module=="object"&&typeof require=="function";var j=Array.prototype.slice;var a;if(!c&&i){c=require("../sinon")}if(!c){return}function g(){var p;for(var o=0,n=arguments.length;o<n;++o){p=arguments[o];if(!p){a.fail("fake is not a spy")}if(typeof p!="function"){a.fail(p+" is not a function")}if(typeof p.getCall!="function"){a.fail(p+" is not stubbed")}}}function m(n,p){var o=n.fail||a.fail;o.call(n,p)}function f(n,p,o){if(arguments.length==2){o=p;p=n}a[n]=function(r){g(r);var s=j.call(arguments,1);var q=false;if(typeof p=="function"){q=!p(r)}else{q=typeof r[p]=="function"?!r[p].apply(r,s):!r[p]}if(q){m(this,r.printf.apply(r,[o].concat(s)))}else{a.pass(n)}}}function h(n,o){return !n||/^fail/.test(o)?o:n+o.slice(0,1).toUpperCase()+o.slice(1)}a={failException:"AssertError",fail:function e(o){var n=new Error(o);n.name=this.failException||a.failException;throw n},pass:function k(n){},callOrder:function l(){g.apply(null,arguments);var n="",p="";if(!c.calledInOrder(arguments)){try{n=[].join.call(arguments,", ");p=c.orderByFirstCall(j.call(arguments)).join(", ")}catch(o){}m(this,"expected "+n+" to be called in order but were called as "+p)}else{a.pass("callOrder")}},callCount:function d(p,n){g(p);if(p.callCount!=n){var o="expected %n to be called "+c.timesInWords(n)+" but was called %c%C";m(this,p.printf(o))}else{a.pass("callCount")}},expose:function b(r,p){if(!r){throw new TypeError("target is null or undefined")}var s=p||{};var q=typeof s.prefix=="undefined"&&"assert"||s.prefix;var n=typeof s.includeFail=="undefined"||!!s.includeFail;for(var t in this){if(t!="export"&&(n||!/^(fail)/.test(t))){r[h(q,t)]=this[t]}}return r}};f("called","expected %n to have been called at least once but was never called");f("notCalled",function(n){return !n.called},"expected %n to not have been called but was called %c%C");f("calledOnce","expected %n to be called once but was called %c%C");f("calledTwice","expected %n to be called twice but was called %c%C");f("calledThrice","expected %n to be called thrice but was called %c%C");f("calledOn","expected %n to be called with %1 as this but was called with %t");f("alwaysCalledOn","expected %n to always be called with %1 as this but was called with %t");f("calledWith","expected %n to be called with arguments %*%C");f("alwaysCalledWith","expected %n to always be called with arguments %*%C");f("calledWithExactly","expected %n to be called with exact arguments %*%C");f("alwaysCalledWithExactly","expected %n to always be called with exact arguments %*%C");f("neverCalledWith","expected %n to never be called with arguments %*%C");f("threw","%n did not throw exception%C");f("alwaysThrew","%n did not always throw exception%C");if(i){module.exports=a}else{c.assert=a}}(typeof sinon=="object"&&sinon||null));