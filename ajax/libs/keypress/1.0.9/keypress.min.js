(function(){var v,aa,i,A,x,T,M,G,C,z,Q,s,P,D,q,J,S,y,B,ab,a,g,H,L,W,U,I,m,N,e,K,V,X,b,Y,l,r,o,F,n,E,w,h,d,O,f,R,u,k,c,j,t,p=[].indexOf||function(ae){for(var ad=0,ac=this.length;ad<ac;ad++){if(ad in this&&this[ad]===ae){return ad}}return -1},Z={}.hasOwnProperty;O=[];u=[];k=null;b=[];i=[];E=false;o="ctrl";n=["meta","alt","option","ctrl","shift","cmd"];j=[];Q={keys:[],count:0};S=function(ae,ad){var ac;if(ae.filter){return ae.filter(ad)}else{return(function(){var ah,ag,af;af=[];for(ah=0,ag=ae.length;ah<ag;ah++){ac=ae[ah];if(ad(ac)){af.push(ac)}}return af})()}};l=function(){return console.log.apply(console,arguments)};s=function(ae,ac){var af,ag,ad;if(ae.length!==ac.length){return false}for(ag=0,ad=ae.length;ag<ad;ag++){af=ae[ag];if(p.call(ac,af)>=0){continue}return false}return true};P=function(ad,ac){var ae,ag,af;if(ad.length!==ac.length){return false}for(ae=ag=0,af=ad.length;0<=af?ag<af:ag>af;ae=0<=af?++ag:--ag){if(ad[ae]!==ac[ae]){return false}}return true};I=function(ae,ac){var af,ag,ad;for(ag=0,ad=ae.length;ag<ad;ag++){af=ae[ag];if(p.call(ac,af)<0){return false}}return true};m=function(ae,ac){var af,ah,ag,ai,ad;ag=0;for(ai=0,ad=ae.length;ai<ad;ai++){ah=ae[ai];af=ac.indexOf(ah);if(af>=ag){ag=af}else{return false}}return true};w=function(ad,ac){if((ac||keypress.suppress_event_defaults)&&!keypress.force_event_defaults){if(ad.preventDefault){ad.preventDefault()}else{ad.returnValue=false}if(ad.stopPropagation){return ad.stopPropagation()}}};T=function(ac){if(ac.prevent_repeat){return false}if(typeof ac.on_keydown==="function"){return true}};Y=function(ah){var ad,ag,af,ac,ae;ae=ah.keys;for(af=0,ac=ae.length;af<ac;af++){ad=ae[af];if(p.call(b,ad)>=0){ag=true;break}}return ag};y=function(ad,ae,ac){if(typeof ae["on_"+ad]==="function"){w(ac,ae["on_"+ad].call(ae["this"],ac,ae.count)===false)}if(ad==="release"){ae.count=0}if(ad==="keyup"){return ae.keyup_fired=true}};r=function(ad,af){var ac,ag,ae;for(ag=0,ae=O.length;ag<ae;ag++){ac=O[ag];if((ac.is_ordered&&P(ad,ac.keys))||(!ac.is_ordered&&s(ad,ac.keys))){af(ac)}}};B=function(ad,af){var ac,ag,ae;for(ag=0,ae=O.length;ag<ae;ag++){ac=O[ag];if((ac.is_ordered&&m(ac.keys,ad))||(!ac.is_ordered&&I(ac.keys,ad))){af(ac)}}};z=function(ac){if(p.call(b,"cmd")>=0&&p.call(ac,"cmd")<0){return false}return true};ab=function(ac){var ae,ad;ae=[];ad=S(b,function(af){return af!==ac});ad.push(ac);r(ad,function(af){if(z(af.keys)){return ae.push(af)}});B(ad,function(af){if(p.call(ae,af)>=0){return}if(!(af.is_solitary||!z(af.keys))){return ae.push(af)}});return ae};g=function(ae){var ag,ac,af,ad;ac=[];for(af=0,ad=O.length;af<ad;af++){ag=O[af];if(ag.is_sequence){continue}if(p.call(ag.keys,ae)>=0&&z(ag.keys)){ac.push(ag)}}return ac};x=function(ad){var ar,ae,ag,aq,ao,am,ah,an,ak,aj,af,ap,ac,al,ai;an=false;ah=true;aq=false;if(p.call(i,ad)>=0){return true}else{if(i.length){for(am=ak=0,al=i.length;0<=al?ak<al:ak>al;am=0<=al?++ak:--ak){ar=i[am];if(!(ar&&ar.is_exclusive&&ad.is_exclusive)){continue}ag=ar.keys;if(!an){for(aj=0,ap=ag.length;aj<ap;aj++){ae=ag[aj];an=true;if(p.call(ad.keys,ae)<0){an=false;break}}}if(ah&&!an){ai=ad.keys;for(af=0,ac=ai.length;af<ac;af++){ao=ai[af];ah=false;if(p.call(ag,ao)<0){ah=true;break}}}if(an){if(aq){R(i.splice(am,1))}else{R(i.splice(am,1,ad));aq=true}ah=false}}}}if(ah){i.unshift(ad)}return an||ah};f=function(ag){var ad,ac,af,ae;for(ac=af=0,ae=i.length;0<=ae?af<ae:af>ae;ac=0<=ae?++af:--af){ad=i[ac];if(ad===ag){R(i.splice(ac,1));break}}};R=function(ac){if(!ac){return}ac.count=null;return ac.keyup_fired=null};A=function(ad,ah){var ag,ae,af,ac;u.push(ad);ae=a();if(ae.length){for(af=0,ac=ae.length;af<ac;af++){ag=ae[af];w(ah,ag.prevent_default)}if(k){clearTimeout(k)}if(keypress.sequence_delay>-1){k=setTimeout(function(){return u=[]},keypress.sequence_delay)}}else{u=[]}};a=function(){var ac,ak,ai,am,al,af,ah,ag,ad,an,aj,ae;al=[];for(ah=0,an=O.length;ah<an;ah++){ac=O[ah];for(ai=ag=1,aj=u.length;1<=aj?ag<=aj:ag>=aj;ai=1<=aj?++ag:--ag){af=u.slice(-ai);if(!ac.is_sequence){continue}if(p.call(ac.keys,"shift")<0){af=S(af,function(ao){return ao!=="shift"});if(!af.length){continue}}for(ak=ad=0,ae=af.length;0<=ae?ad<ae:ad>ae;ak=0<=ae?++ad:--ad){if(ac.keys[ak]===af[ak]){am=true}else{am=false;break}}if(am){al.push(ac)}}}return al};H=function(ao){var ac,ak,ai,al,am,ag,ah,af,ad,an,aj,ae;for(ah=0,an=O.length;ah<an;ah++){ac=O[ah];if(!ac.is_sequence){continue}for(ai=af=1,aj=u.length;1<=aj?af<=aj:af>=aj;ai=1<=aj?++af:--af){ag=(S(u,function(ap){if(p.call(ac.keys,"shift")>=0){return true}return ap!=="shift"})).slice(-ai);if(ac.keys.length!==ag.length){continue}for(ak=ad=0,ae=ag.length;0<=ae?ad<ae:ad>ae;ak=0<=ae?++ad:--ad){am=ag[ak];if(p.call(ac.keys,"shift")<0?am==="shift":void 0){continue}if(ao==="shift"&&p.call(ac.keys,"shift")<0){continue}if(ac.keys[ak]===am){al=true}else{al=false;break}}}if(al){return ac}}return false};q=function(ad,ae){var ac;if(!ae.shiftKey){return false}ac=X[ad];if(ac!=null){return ac}return false};L=function(af,ad,ae){var ac;if(p.call(af.keys,ad)<0){return false}w(ae,af&&af.prevent_default);if(p.call(b,ad)>=0){if(!T(af)){return false}}ac=x(af,ad);af.keyup_fired=false;if(af.is_counting&&typeof af.on_keydown==="function"){af.count+=1}if(ac){return y("keydown",af,ae)}};N=function(aq,am){var af,at,ac,ak,an,ad,ap,al,ar,ai,ah,ag,ao,ae,aj;ar=q(aq,am);if(ar){aq=ar}A(aq,am);al=H(aq);if(al){y("keydown",al,am)}for(an in F){ac=F[an];if(!am[ac]){continue}if(an===aq||p.call(b,an)>=0){continue}b.push(an)}for(an in F){ac=F[an];if(an===aq){continue}if(p.call(b,an)>=0&&!am[ac]){for(ak=ai=0,aj=b.length;0<=aj?ai<aj:ai>aj;ak=0<=aj?++ai:--ai){if(b[ak]===an){b.splice(ak,1)}}}}at=ab(aq);for(ah=0,ao=at.length;ah<ao;ah++){af=at[ah];L(af,aq,am)}ap=g(aq);if(ap.length){for(ag=0,ae=ap.length;ag<ae;ag++){ad=ap[ag];w(am,ad.prevent_default)}}if(p.call(b,aq)<0){b.push(aq)}};W=function(ag,af,ac){var ad,ae;ae=Y(ag);if(!ag.keyup_fired){ad=b.slice();ad.push(ac);if(!ag.is_solitary||s(ad,ag.keys)){y("keyup",ag,af);if(ag.is_counting&&typeof ag.on_keyup==="function"&&typeof ag.on_keydown!=="function"){ag.count+=1}}}if(!ae){y("release",ag,af);f(ag)}};e=function(av,ap){var am,al,aq,ah,ao,ak,an,ai,af,ae,ad,ac,ar,au,at,aj,ag;ai=av;an=q(av,ap);if(an){av=an}an=X[ai];if(ap.shiftKey){if(!(an&&p.call(b,an)>=0)){av=ai}}else{if(!(ai&&p.call(b,ai)>=0)){av=an}}ak=H(av);if(ak){y("keyup",ak,ap)}if(p.call(b,av)<0){return false}for(ao=af=0,aj=b.length;0<=aj?af<aj:af>aj;ao=0<=aj?++af:--af){if((ag=b[ao])===av||ag===an||ag===ai){b.splice(ao,1);break}}al=i.length;ah=[];for(ae=0,ar=i.length;ae<ar;ae++){am=i[ae];if(p.call(am.keys,av)>=0){ah.push(am)}}for(ad=0,au=ah.length;ad<au;ad++){aq=ah[ad];W(aq,ap,av)}if(al>1){for(ac=0,at=i.length;ac<at;ac++){am=i[ac];if(am===void 0||p.call(ah,am)>=0){continue}if(!Y(am)){f(am)}}}};d=function(ad,ae){var ac;if(E){if(b.length){b=[]}return}if(!ae&&!b.length){return}ac=D(ad.keyCode);if(!ac){return}if(ae){return N(ac,ad)}else{return e(ac,ad)}};c=function(ag){var ad,af,ae,ac;ac=[];for(ad=af=0,ae=O.length;0<=ae?af<ae:af>ae;ad=0<=ae?++af:--af){if(ag===O[ad]){O.splice(ad,1);break}else{ac.push(void 0)}}return ac};t=function(ad){var ak,aj,ao,al,an,ah,ag,ae,am,ac,ai,af;if(!ad.keys.length){l("You're trying to bind a combo with no keys.")}for(aj=ah=0,ai=ad.keys.length;0<=ai?ah<ai:ah>ai;aj=0<=ai?++ah:--ah){ao=ad.keys[aj];ak=K[ao];if(ak){ao=ad.keys[aj]=ak}if(ao==="meta"){ad.keys.splice(aj,1,o)}if(ao==="cmd"){l('Warning: use the "meta" key rather than "cmd" for Windows compatibility')}}af=ad.keys;for(ag=0,am=af.length;ag<am;ag++){ao=af[ag];if(p.call(j,ao)<0){l('Do not recognize the key "'+ao+'"');return false}}if(p.call(ad.keys,"meta")>=0||p.call(ad.keys,"cmd")>=0){an=ad.keys.slice();for(ae=0,ac=n.length;ae<ac;ae++){al=n[ae];if((aj=an.indexOf(al))>-1){an.splice(aj,1)}}if(an.length>1){l("META and CMD key combos cannot have more than 1 non-modifier keys",ad,an);return true}}return true};J=function(){if(navigator.userAgent.indexOf("Mac OS X")!==-1){o="cmd"}};G=function(ad){var ac;if(p.call(b,"cmd")>=0&&((ac=D(ad.keyCode))!=="cmd"&&ac!=="shift"&&ac!=="alt"&&ac!=="caps"&&ac!=="tab")){return d(ad,false)}};C=function(){if(navigator.userAgent.indexOf("Opera")!==-1){V["17"]="cmd"}};M=function(){var ac;ac=function(af,ae,ad){if(af.addEventListener){return af.addEventListener(ae,ad)}else{if(af.attachEvent){return af.attachEvent("on"+ae,ad)}}};ac(document.body,"keydown",function(ad){ad=ad||window.event;d(ad,true);return G(ad)});ac(document.body,"keyup",function(ad){ad=ad||window.event;return d(ad,false)});return ac(window,"blur",function(){var af,ag,ae,ad;for(ag=0,ae=b.length;ag<ae;ag++){af=b[ag];e(af,{})}b=[];return ad=[]})};U=function(){J();return C()};window.keypress={};keypress.force_event_defaults=false;keypress.suppress_event_defaults=false;keypress.sequence_delay=800;keypress.get_registered_combos=function(){return O};keypress.reset=function(){O=[]};keypress.combo=function(ad,ae,ac){if(ac==null){ac=false}return keypress.register_combo({keys:ad,on_keydown:ae,prevent_default:ac})};keypress.counting_combo=function(ae,ad,ac){if(ac==null){ac=false}return keypress.register_combo({keys:ae,is_counting:true,is_ordered:true,on_keydown:ad,prevent_default:ac})};keypress.sequence_combo=function(ad,ae,ac){if(ac==null){ac=false}return keypress.register_combo({keys:ad,on_keydown:ae,is_sequence:true,prevent_default:ac})};keypress.register_combo=function(ae){var ad,ac;if(typeof ae.keys==="string"){ae.keys=ae.keys.split(" ")}for(ad in Q){if(!Z.call(Q,ad)){continue}ac=Q[ad];if(ae[ad]==null){ae[ad]=ac}}if(t(ae)){O.push(ae);return true}};keypress.register_many=function(ag){var af,ae,ad,ac;ac=[];for(ae=0,ad=ag.length;ae<ad;ae++){af=ag[ae];ac.push(keypress.register_combo(af))}return ac};keypress.unregister_combo=function(ae){var ag,af,ad,ac;if(!ae){return false}if(ae.keys){return c(ae)}else{ac=[];for(af=0,ad=O.length;af<ad;af++){ag=O[af];if(!ag){continue}if(typeof ae==="string"){ae=ae.split(" ")}if((!ag.is_ordered&&s(ae,ag.keys))||(ag.is_ordered&&P(ae,ag.keys))){ac.push(c(ag))}else{ac.push(void 0)}}return ac}};keypress.unregister_many=function(ag){var af,ae,ad,ac;ac=[];for(ae=0,ad=ag.length;ae<ad;ae++){af=ag[ae];ac.push(keypress.unregister_combo(af))}return ac};keypress.listen=function(){return E=false};keypress.stop_listening=function(){return E=true};D=function(ac){return V[ac]};F={cmd:"metaKey",ctrl:"ctrlKey",shift:"shiftKey",alt:"altKey"};K={escape:"esc",control:"ctrl",command:"cmd","break":"pause",windows:"cmd",option:"alt",caps_lock:"caps",apostrophe:"'",semicolon:";",tilde:"~",accent:"`",scroll_lock:"scroll",num_lock:"num"};X={"/":"?",".":">",",":"<","'":'"',";":":","[":"{","]":"}","\\":"|","`":"~","=":"+","-":"_","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")"};V={0:"\\",8:"backspace",9:"tab",12:"num",13:"enter",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"caps",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",44:"print",45:"insert",46:"delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",91:"cmd",92:"cmd",93:"cmd",96:"num_0",97:"num_1",98:"num_2",99:"num_3",100:"num_4",101:"num_5",102:"num_6",103:"num_7",104:"num_8",105:"num_9",106:"num_multiply",107:"num_add",108:"num_enter",109:"num_subtract",110:"num_decimal",111:"num_divide",124:"print",144:"num",145:"scroll",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",223:"`",224:"cmd",57392:"ctrl",63289:"num"};for(aa in V){v=V[aa];j.push(v)}for(aa in X){v=X[aa];j.push(v)}U();h=function(ac){if((document.attachEvent?document.readyState==="complete":document.readyState!=="loading")){return ac()}else{return setTimeout(function(){return h(ac)},9)}};h(M)}).call(this);