steal(function(){var opts=window.Syn?window.Syn:{};var extend=function(d,s){var p;for(p in s){d[p]=s[p]}return d},browser={msie:!!(window.attachEvent&&!window.opera),opera:!!window.opera,webkit:navigator.userAgent.indexOf("AppleWebKit/")>-1,safari:navigator.userAgent.indexOf("AppleWebKit/")>-1&&navigator.userAgent.indexOf("Chrome/")===-1,gecko:navigator.userAgent.indexOf("Gecko")>-1,mobilesafari:!!navigator.userAgent.match(/Apple.*Mobile.*Safari/),rhino:navigator.userAgent.match(/Rhino/)&&true},createEventObject=function(type,options,element){var event=element.ownerDocument.createEventObject();return extend(event,options)},data={},id=1,expando="_synthetic"+(new Date).getTime(),bind,unbind,key=/keypress|keyup|keydown/,page=/load|unload|abort|error|select|change|submit|reset|focus|blur|resize|scroll/,activeElement,Syn=function(type,options,element,callback){return new Syn.init(type,options,element,callback)};Syn.config=opts;bind=function(el,ev,f){return el.addEventListener?el.addEventListener(ev,f,false):el.attachEvent("on"+ev,f)};unbind=function(el,ev,f){return el.addEventListener?el.removeEventListener(ev,f,false):el.detachEvent("on"+ev,f)};extend(Syn,{init:function(type,options,element,callback){var args=Syn.args(options,element,callback),self=this;this.queue=[];this.element=args.element;if(typeof this[type]==="function"){this[type](args.options,args.element,function(defaults,el){args.callback&&args.callback.apply(self,arguments);self.done.apply(self,arguments)})}else{this.result=Syn.trigger(type,args.options,args.element);args.callback&&args.callback.call(this,args.element,this.result)}},jquery:function(el,fast){if(window.FuncUnit&&window.FuncUnit.jQuery){return window.FuncUnit.jQuery}if(el){return Syn.helpers.getWindow(el).jQuery||window.jQuery}else{return window.jQuery}},args:function(){var res={},i=0;for(;i<arguments.length;i++){if(typeof arguments[i]==="function"){res.callback=arguments[i]}else if(arguments[i]&&arguments[i].jquery){res.element=arguments[i][0]}else if(arguments[i]&&arguments[i].nodeName){res.element=arguments[i]}else if(res.options&&typeof arguments[i]==="string"){res.element=document.getElementById(arguments[i])}else if(arguments[i]){res.options=arguments[i]}}return res},click:function(options,element,callback){Syn("click!",options,element,callback)},defaults:{focus:function(){if(!Syn.support.focusChanges){var element=this,nodeName=element.nodeName.toLowerCase();Syn.data(element,"syntheticvalue",element.value);if(nodeName==="input"||nodeName==="textarea"){bind(element,"blur",function(){if(Syn.data(element,"syntheticvalue")!=element.value){Syn.trigger("change",{},element)}unbind(element,"blur",arguments.callee)})}}},submit:function(){Syn.onParents(this,function(el){if(el.nodeName.toLowerCase()==="form"){el.submit();return false}})}},changeOnBlur:function(element,prop,value){bind(element,"blur",function(){if(value!==element[prop]){Syn.trigger("change",{},element)}unbind(element,"blur",arguments.callee)})},closest:function(el,type){while(el&&el.nodeName.toLowerCase()!==type.toLowerCase()){el=el.parentNode}return el},data:function(el,key,value){var d;if(!el[expando]){el[expando]=id++}if(!data[el[expando]]){data[el[expando]]={}}d=data[el[expando]];if(value){data[el[expando]][key]=value}else{return data[el[expando]][key]}},onParents:function(el,func){var res;while(el&&res!==false){res=func(el);el=el.parentNode}return el},focusable:/^(a|area|frame|iframe|label|input|select|textarea|button|html|object)$/i,isFocusable:function(elem){var attributeNode;if(elem.getAttributeNode){attributeNode=elem.getAttributeNode("tabIndex")}return this.focusable.test(elem.nodeName)||attributeNode&&attributeNode.specified&&Syn.isVisible(elem)},isVisible:function(elem){return elem.offsetWidth&&elem.offsetHeight||elem.clientWidth&&elem.clientHeight},tabIndex:function(elem){var attributeNode=elem.getAttributeNode("tabIndex");return attributeNode&&attributeNode.specified&&(parseInt(elem.getAttribute("tabIndex"))||0)},bind:bind,unbind:unbind,browser:browser,helpers:{createEventObject:createEventObject,createBasicStandardEvent:function(type,defaults,doc){var event;try{event=doc.createEvent("Events")}catch(e2){event=doc.createEvent("UIEvents")}finally{event.initEvent(type,true,true);extend(event,defaults)}return event},inArray:function(item,array){var i=0;for(;i<array.length;i++){if(array[i]===item){return i}}return-1},getWindow:function(element){if(element.ownerDocument){return element.ownerDocument.defaultView||element.ownerDocument.parentWindow}},extend:extend,scrollOffset:function(win,set){var doc=win.document.documentElement,body=win.document.body;if(set){window.scrollTo(set.left,set.top)}else{return{left:(doc&&doc.scrollLeft||body&&body.scrollLeft||0)+(doc.clientLeft||0),top:(doc&&doc.scrollTop||body&&body.scrollTop||0)+(doc.clientTop||0)}}},scrollDimensions:function(win){var doc=win.document.documentElement,body=win.document.body,docWidth=doc.clientWidth,docHeight=doc.clientHeight,compat=win.document.compatMode==="CSS1Compat";return{height:compat&&docHeight||body.clientHeight||docHeight,width:compat&&docWidth||body.clientWidth||docWidth}},addOffset:function(options,el){var jq=Syn.jquery(el),off;if(typeof options==="object"&&options.clientX===undefined&&options.clientY===undefined&&options.pageX===undefined&&options.pageY===undefined&&jq){el=jq(el);off=el.offset();options.pageX=off.left+el.width()/2;options.pageY=off.top+el.height()/2}}},key:{ctrlKey:null,altKey:null,shiftKey:null,metaKey:null},dispatch:function(event,element,type,autoPrevent){if(element.dispatchEvent&&event){var preventDefault=event.preventDefault,prevents=autoPrevent?-1:0;if(autoPrevent){bind(element,type,function(ev){ev.preventDefault();unbind(this,type,arguments.callee)})}event.preventDefault=function(){prevents++;if(++prevents>0){preventDefault.apply(this,[])}};element.dispatchEvent(event);return prevents<=0}else{try{window.event=event}catch(e){}return element.sourceIndex<=0||element.fireEvent&&element.fireEvent("on"+type,event)}},create:{page:{event:function(type,options,element){var doc=Syn.helpers.getWindow(element).document||document,event;if(doc.createEvent){event=doc.createEvent("Events");event.initEvent(type,true,true);return event}else{try{event=createEventObject(type,options,element)}catch(e){}return event}}},focus:{event:function(type,options,element){Syn.onParents(element,function(el){if(Syn.isFocusable(el)){if(el.nodeName.toLowerCase()!=="html"){el.focus();activeElement=el}else if(activeElement){var doc=Syn.helpers.getWindow(element).document;if(doc!==window.document){return false}else if(doc.activeElement){doc.activeElement.blur();activeElement=null}else{activeElement.blur();activeElement=null}}return false}});return true}}},support:{clickChanges:false,clickSubmits:false,keypressSubmits:false,mouseupSubmits:false,radioClickChanges:false,focusChanges:false,linkHrefJS:false,keyCharacters:false,backspaceWorks:false,mouseDownUpClicks:false,tabKeyTabs:false,keypressOnAnchorClicks:false,optionClickBubbles:false,ready:0},trigger:function(type,options,element){options||(options={});var create=Syn.create,setup=create[type]&&create[type].setup,kind=key.test(type)?"key":page.test(type)?"page":"mouse",createType=create[type]||{},createKind=create[kind],event,ret,autoPrevent,dispatchEl=element;Syn.support.ready===2&&setup&&setup(type,options,element);autoPrevent=options._autoPrevent;delete options._autoPrevent;if(createType.event){ret=createType.event(type,options,element)}else{options=createKind.options?createKind.options(type,options,element):options;if(!Syn.support.changeBubbles&&/option/i.test(element.nodeName)){dispatchEl=element.parentNode}event=createKind.event(type,options,dispatchEl);ret=Syn.dispatch(event,dispatchEl,type,autoPrevent)}ret&&Syn.support.ready===2&&Syn.defaults[type]&&Syn.defaults[type].call(element,options,autoPrevent);return ret},eventSupported:function(eventName){var el=document.createElement("div");eventName="on"+eventName;var isSupported=eventName in el;if(!isSupported){el.setAttribute(eventName,"return;");isSupported=typeof el[eventName]==="function"}el=null;return isSupported}});extend(Syn.init.prototype,{then:function(type,options,element,callback){if(Syn.autoDelay){this.delay()}var args=Syn.args(options,element,callback),self=this;this.queue.unshift(function(el,prevented){if(typeof this[type]==="function"){this.element=args.element||el;this[type](args.options,this.element,function(defaults,el){args.callback&&args.callback.apply(self,arguments);self.done.apply(self,arguments)})}else{this.result=Syn.trigger(type,args.options,args.element);args.callback&&args.callback.call(this,args.element,this.result);return this}});return this},delay:function(timeout,callback){if(typeof timeout==="function"){callback=timeout;timeout=null}timeout=timeout||600;var self=this;this.queue.unshift(function(){setTimeout(function(){callback&&callback.apply(self,[]);self.done.apply(self,arguments)},timeout)});return this},done:function(defaults,el){el&&(this.element=el);if(this.queue.length){this.queue.pop().call(this,this.element,defaults)}},_click:function(options,element,callback,force){Syn.helpers.addOffset(options,element);Syn.trigger("mousedown",options,element);setTimeout(function(){Syn.trigger("mouseup",options,element);if(!Syn.support.mouseDownUpClicks||force){Syn.trigger("click",options,element);callback(true)}else{Syn.create.click.setup("click",options,element);Syn.defaults.click.call(element);setTimeout(function(){callback(true)},1)}},1)},_rightClick:function(options,element,callback){Syn.helpers.addOffset(options,element);var mouseopts=extend(extend({},Syn.mouse.browser.right.mouseup),options);Syn.trigger("mousedown",mouseopts,element);setTimeout(function(){Syn.trigger("mouseup",mouseopts,element);if(Syn.mouse.browser.right.contextmenu){Syn.trigger("contextmenu",extend(extend({},Syn.mouse.browser.right.contextmenu),options),element)}callback(true)},1)},_dblclick:function(options,element,callback){Syn.helpers.addOffset(options,element);var self=this;this._click(options,element,function(){setTimeout(function(){self._click(options,element,function(){Syn.trigger("dblclick",options,element);callback(true)},true)},2)})}});var actions=["click","dblclick","move","drag","key","type","rightClick"],makeAction=function(name){Syn[name]=function(options,element,callback){return Syn("_"+name,options,element,callback)};Syn.init.prototype[name]=function(options,element,callback){return this.then("_"+name,options,element,callback)}},i=0;for(;i<actions.length;i++){makeAction(actions[i])}return Syn});
