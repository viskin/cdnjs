/*! p5.dom.js v0.2.0 February 2, 2015 */
(function(root,factory){if(typeof define==="function"&&define.amd)define("p5.dom",["p5"],function(p5){factory(p5)});else if(typeof exports==="object")factory(require("../p5"));else factory(root["p5"])})(this,function(p5){p5.prototype.getElement=function(e){var res=document.getElementById(e);if(res){return wrapElement(res)}else{return null}};p5.prototype.getElements=function(e){var arr=[];var res=document.getElementsByClassName(e);if(res){for(var j=0;j<res.length;j++){var obj=wrapElement(res[j]);arr.push(obj)}}return arr};function wrapElement(elt){if(elt.tagName==="VIDEO"||elt.tagName==="AUDIO"){return new p5.MediaElement(elt)}else{return new p5.Element(elt)}}p5.prototype.removeElements=function(e){for(var i=0;i<this._elements.length;i++){if(!(this._elements[i].elt instanceof HTMLCanvasElement)){this._elements[i].remove()}}};function addElement(elt,pInst,media){var node=pInst._userNode?pInst._userNode:document.body;node.appendChild(elt);var c=media?new p5.MediaElement(elt):new p5.Element(elt);pInst._elements.push(c);return c}var tags=["div","p","span"];tags.forEach(function(tag){var method="create"+tag.charAt(0).toUpperCase()+tag.slice(1);p5.prototype[method]=function(html){var elt=document.createElement(tag);elt.innerHTML=typeof html===undefined?"":html;return addElement(elt,this)}});p5.prototype.createImg=function(src,alt){var elt=document.createElement("img");elt.src=src;if(typeof alt!=="undefined"){elt.alt=alt}return addElement(elt,this)};p5.prototype.createA=function(href,html,target){var elt=document.createElement("a");elt.href=href;elt.innerHTML=html;if(target)elt.target=target;return addElement(elt,this)};p5.prototype.createSlider=function(min,max,value,step){var elt=document.createElement("input");elt.type="range";elt.min=min;elt.max=max;if(step)elt.step=step;if(value)elt.value=value;return addElement(elt,this)};p5.prototype.createButton=function(label,value){var elt=document.createElement("button");elt.innerHTML=label;elt.value=value;if(value)elt.value=value;return addElement(elt,this)};p5.prototype.createInput=function(value){var elt=document.createElement("input");elt.type="text";if(value)elt.value=value;return addElement(elt,this)};p5.prototype.createFileInput=function(callback,multiple){if(window.File&&window.FileReader&&window.FileList&&window.Blob){var elt=document.createElement("input");elt.type="file";if(multiple){elt.multiple="multiple"}elt.addEventListener("change",handleFileSelect,false);function handleFileSelect(evt){var files=evt.target.files;for(var i=0;i<files.length;i++){var f=files[i];var reader=new FileReader;reader.onload=makeLoader(f);function makeLoader(theFile){var p5file=new p5.File(theFile);return function(e){p5file.data=e.target.result;callback(p5file)}}if(f.type==="text"){reader.readAsText(f)}else{reader.readAsDataURL(f)}}}return addElement(elt,this)}else{console.log("The File APIs are not fully supported in this browser. Cannot create element.")}};function createMedia(pInst,type,src,callback){var elt=document.createElement(type);if(typeof src==="string"){src=[src]}for(var i=0;i<src.length;i++){var source=document.createElement("source");source.src=src[i];elt.appendChild(source)}if(typeof callback!=="undefined"){elt.addEventListener("canplaythrough",function(){callback()})}var c=addElement(elt,pInst,true);c.loadedmetadata=false;elt.addEventListener("loadedmetadata",function(){c.width=elt.videoWidth;c.height=elt.videoHeight;c.loadedmetadata=true});return c}p5.prototype.createVideo=function(src,callback){return createMedia(this,"video",src,callback)};p5.prototype.createAudio=function(src,callback){return createMedia(this,"audio",src,callback)};p5.prototype.VIDEO="video";p5.prototype.AUDIO="audio";navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;p5.prototype.createCapture=function(){var useVideo=true;var useAudio=true;var constraints;var cb;for(var i=0;i<arguments.length;i++){if(arguments[i]===p5.prototype.VIDEO){useAudio=false}else if(arguments[i]===p5.prototype.AUDIO){useVideo=false}else if(typeof arguments[i]==="object"){constraints=arguments[i]}else if(typeof arguments[i]==="function"){cb=arguments[i]}}if(navigator.getUserMedia){var elt=document.createElement("video");if(!constraints){constraints={video:useVideo,audio:useAudio}}navigator.getUserMedia(constraints,function(stream){elt.src=window.URL.createObjectURL(stream);elt.play();if(cb){cb(stream)}},function(e){console.log(e)})}else{throw"getUserMedia not supported in this browser"}var c=addElement(elt,this,true);c.loadedmetadata=false;elt.addEventListener("loadedmetadata",function(){c.width=elt.videoWidth;c.height=elt.videoHeight;c.loadedmetadata=true});return c};p5.prototype.createElement=function(tag,content){var elt=document.createElement(tag);if(typeof content!=="undefined"){elt.innerHTML=content}return addElement(elt,this)};p5.Element.prototype.addClass=function(c){if(this.elt.className){this.elt.className=this.elt.className+" "+c}else{this.elt.className=c}return this};p5.Element.prototype.removeClass=function(c){var regex=new RegExp("(?:^|\\s)"+c+"(?!\\S)");this.elt.className=this.elt.className.replace(regex,"");this.elt.className=this.elt.className.replace(/^\s+|\s+$/g,"");return this};p5.Element.prototype.child=function(c){if(typeof c==="string"){c=document.getElementById(c)}else if(c instanceof p5.Element){c=c.elt}this.elt.appendChild(c);return this};p5.Element.prototype.html=function(html){if(typeof html!=="undefined"){this.elt.innerHTML=html;return this}else{return this.elt.innerHTML}};p5.Element.prototype.position=function(x,y){this.elt.style.position="absolute";this.elt.style.left=x+"px";this.elt.style.top=y+"px";return this};p5.Element.prototype.style=function(prop,val){if(typeof val==="undefined"){var attrs=prop.split(";");for(var i=0;i<attrs.length;i++){var parts=attrs[i].split(":");if(parts[0]&&parts[1]){this.elt.style[parts[0].trim()]=parts[1].trim()}}}else{this.elt.style[prop]=val}return this};p5.Element.prototype.attribute=function(attr,value){if(typeof value==="undefined"){return this.elt.getAttribute(attr)}else{this.elt.setAttribute(attr,value);return this}};p5.Element.prototype.value=function(){if(arguments.length>0){this.elt.value=arguments[0];return this}else{if(this.elt.type==="range"){return parseFloat(this.elt.value)}else return this.elt.value}};p5.Element.prototype.show=function(){this.elt.style.display="block";return this};p5.Element.prototype.hide=function(){this.elt.style.display="none";return this};p5.Element.prototype.size=function(w,h){var aW=w;var aH=h;var AUTO=p5.prototype.AUTO;if(aW!==AUTO||aH!==AUTO){if(aW===AUTO){aW=h*this.width/this.height}else if(aH===AUTO){aH=w*this.height/this.width}if(this.elt instanceof HTMLCanvasElement){var j={};var k=this.elt.getContext("2d");for(var prop in k){j[prop]=k[prop]}this.elt.setAttribute("width",aW*this._pInst._pixelDensity);this.elt.setAttribute("height",aH*this._pInst._pixelDensity);this.elt.setAttribute("style","width:"+aW+"px !important; height:"+aH+"px !important;");this._pInst.scale(this._pInst._pixelDensity,this._pInst._pixelDensity);for(var prop in j){this.elt.getContext("2d")[prop]=j[prop]}}else{this.elt.style.width=aW+"px !important";this.elt.style.height=aH+"px !important";this.elt.width=aW;this.elt.height=aH}this.elt.style.overflow="hidden";this.width=this.elt.offsetWidth;this.height=this.elt.offsetHeight;if(this._pInst){if(this._pInst._curElement.elt===this.elt){this._pInst._setProperty("width",this.elt.offsetWidth);this._pInst._setProperty("height",this.elt.offsetHeight)}}}return this};p5.Element.prototype.remove=function(){for(var ev in this._events){this.elt.removeEventListener(ev,this._events[ev])}if(this.elt.parentNode){this.elt.parentNode.removeChild(this.elt)}delete this};p5.MediaElement=function(elt,pInst){p5.Element.call(this,elt,pInst)};p5.MediaElement.prototype=Object.create(p5.Element.prototype);p5.MediaElement.prototype.play=function(){if(this.elt.currentTime===this.elt.duration){this.elt.currentTime=0}this.elt.play();return this};p5.MediaElement.prototype.stop=function(){this.elt.pause();this.elt.currentTime=0;return this};p5.MediaElement.prototype.pause=function(){this.elt.pause();return this};p5.MediaElement.prototype.loop=function(){this.elt.setAttribute("loop",true);this.play();return this};p5.MediaElement.prototype.noLoop=function(){this.elt.setAttribute("loop",false);return this};p5.MediaElement.prototype.autoplay=function(val){this.elt.setAttribute("autoplay",val);return this};p5.MediaElement.prototype.volume=function(val){if(typeof val==="undefined"){return this.elt.volume}else{this.elt.volume=val}};p5.MediaElement.prototype.time=function(val){if(typeof val==="undefined"){return this.elt.currentTime}else{this.elt.currentTime=val}};p5.MediaElement.prototype.duration=function(){return this.elt.duration};p5.MediaElement.prototype.pixels=[];p5.MediaElement.prototype.loadPixels=function(){if(this.loadedmetadata){if(!this.canvas){this.canvas=document.createElement("canvas");this.canvas.width=this.width;this.canvas.height=this.height;this.drawingContext=this.canvas.getContext("2d")}this.drawingContext.drawImage(this.elt,0,0,this.width,this.height);p5.prototype.loadPixels.call(this)}return this};p5.MediaElement.prototype.updatePixels=function(x,y,w,h){if(this.loadedmetadata){p5.prototype.updatePixels.call(this,x,y,w,h)}return this};p5.MediaElement.prototype.get=function(x,y,w,h){if(this.loadedmetadata){return p5.prototype.get.call(this,x,y,w,h)}else return[0,0,0,255]};p5.MediaElement.prototype.set=function(x,y,imgOrCol){if(this.loadedmetadata){p5.prototype.set.call(this,x,y,imgOrCol)}}});
