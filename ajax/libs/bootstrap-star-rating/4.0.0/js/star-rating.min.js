/*!
 * @copyright &copy; Kartik Visweswaran, Krajee.com, 2013 - 2016
 * @version 4.0.0
 *
 * A simple yet powerful JQuery star rating plugin that allows rendering fractional star ratings and supports
 * Right to Left (RTL) input.
 * 
 * For more JQuery plugins visit http://plugins.krajee.com
 * For more Yii related demos visit http://demos.krajee.com
 */!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery")):e(window.jQuery)}(function(e){"use strict";e.fn.ratingLocales={};var t,a,n,r,i,l,o,s,c,u,h,d;t=".rating",a=0,n=5,r=.5,i=function(t,a){return null===t||void 0===t||0===t.length||a&&""===e.trim(t)},l=function(e,t){return e?" "+t:""},o=function(e,t){e.removeClass(t).addClass(t)},s=function(e,t,a){return a.vattr||e.data(t)||e.attr(t)},c=function(e){var t=(""+e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0},u=function(e,t){return parseFloat(e.toFixed(t))},h=function(e,a,n,r){var i=r?a:a.split(" ").join(t+" ")+t;e.off(i).on(i,n)},d=function(t,a){this.$element=e(t),this.init(a)},d.prototype={constructor:d,_parseAttr:function(e,t){var l,o,c,u=this,h=u.$element,d=h.attr("type");if("range"===d||"number"===d){switch(o=s(h,e,t),e){case"min":c=a;break;case"max":c=n;break;default:c=r}return l=i(o)?c:o,parseFloat(l)}return parseFloat(t[e])},setDefault:function(e,t){var a=this;i(a[e])&&(a[e]=t)},getPosition:function(e){var t=i(e.pageX)?e.originalEvent.touches[0].pageX:e.pageX;return t-this.$rating.offset().left},listenClick:function(e,t){return e.stopPropagation(),e.preventDefault(),e.handled===!0?!1:(t(e),void(e.handled=!0))},starClick:function(e){var t,a=this;a.listenClick(e,function(e){return a.inactive?!1:(t=a.getPosition(e),a.setStars(t),a.$element.trigger("change").trigger("rating.change",[a.$element.val(),a.$caption.html()]),void(a.starClicked=!0))})},starMouseMove:function(e){var t,a,n=this;!n.hoverEnabled||n.inactive||e&&e.isDefaultPrevented()||(n.starClicked=!1,t=n.getPosition(e),a=n.calculate(t),n.toggleHover(a),n.$element.trigger("rating.hover",[a.val,a.caption,"stars"]))},starMouseLeave:function(e){var t,a=this;!a.hoverEnabled||a.inactive||a.starClicked||e&&e.isDefaultPrevented()||(t=a.cache,a.toggleHover(t),a.$element.trigger("rating.hoverleave",["stars"]))},clearClick:function(e){var t=this;t.listenClick(e,function(){t.inactive||(t.clear(),t.clearClicked=!0)})},clearMouseMove:function(e){var t,a,n,r,i=this;!i.hoverEnabled||i.inactive||!i.hoverOnClear||e&&e.isDefaultPrevented()||(i.clearClicked=!1,t='<span class="'+i.clearCaptionClass+'">'+i.clearCaption+"</span>",a=i.clearValue,n=i.getWidthFromValue(a)||0,r={caption:t,width:n,val:a},i.toggleHover(r),i.$element.trigger("rating.hover",[a,t,"clear"]))},clearMouseLeave:function(e){var t,a=this;!a.hoverEnabled||a.inactive||a.clearClicked||!a.hoverOnClear||e&&e.isDefaultPrevented()||(t=a.cache,a.toggleHover(t),a.$element.trigger("rating.hoverleave",["clear"]))},resetForm:function(e){var t=this;e&&e.isDefaultPrevented()||t.inactive||t.reset()},initTouch:function(e){var t=this,a="touchend"===e.type;t.setTouch(e,a)},listen:function(){var t=this,a=t.$element.closest("form"),n=t.$rating,r=t.$clear;h(n,"touchstart touchmove touchend",e.proxy(t.initTouch,t)),h(n,"click touchstart",e.proxy(t.starClick,t)),h(n,"mousemove",e.proxy(t.starMouseMove,t)),h(n,"mouseleave",e.proxy(t.starMouseLeave,t)),t.showClear&&(h(r,"click touchstart",e.proxy(t.clearClick,t)),h(r,"mousemove",e.proxy(t.clearMouseMove,t)),h(r,"mouseleave",e.proxy(t.clearMouseLeave,t))),a.length&&h(a,"reset",e.proxy(t.resetForm,t))},destroy:function(){var t=this,a=t.$element;i(t.$container)||t.$container.before(a).remove(),e.removeData(a.get(0)),a.off("rating").removeClass("hide")},create:function(e){var t=this,a=t.$element;e=e||t.options||{},t.destroy(),a.rating(e)},setTouch:function(e,t){var a,n,r,l,o,s,c,u=this,h="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch;h&&!u.inactive&&(a=e.originalEvent,n=i(a.touches)?a.changedTouches:a.touches,r=u.getPosition(n[0]),t?(u.setStars(r),u.$element.trigger("change").trigger("rating.change",[u.$element.val(),u.$caption.html()]),u.starClicked=!0):(l=u.calculate(r),o=l.val<=u.clearValue?u.fetchCaption(u.clearValue):l.caption,s=u.getWidthFromValue(u.clearValue),c=l.val<=u.clearValue?s+"%":l.width,u.$caption.html(o),u.$filledStars.css("width",c)))},initSlider:function(e){var t=this;i(t.$element.val())&&t.$element.val(0),t.initialValue=t.$element.val(),t.setDefault("min",t._parseAttr("min",e)),t.setDefault("max",t._parseAttr("max",e)),t.setDefault("step",t._parseAttr("step",e)),(isNaN(t.min)||i(t.min))&&(t.min=a),(isNaN(t.max)||i(t.max))&&(t.max=n),(isNaN(t.step)||i(t.step)||0===t.step)&&(t.step=r),t.diff=t.max-t.min},init:function(t){var a=this,n=a.$element.addClass("hide");a.options=t,e.each(t,function(e,t){a[e]=t}),a.starClicked=!1,a.clearClicked=!1,a.initSlider(t),a.checkDisabled(),a.displayOnly&&(a.inactive=!0,a.showClear=!1,a.showCaption=!1),a.generateRating(),a.listen(),n.removeClass("rating-loading")},initHighlight:function(e){var t,a=this,n=a.$caption?a.$caption.html():a.defaultCaption;e||(e=a.$element.val()),t=a.getWidthFromValue(e)+"%",a.$filledStars.width(t),a.cache={caption:n,width:t,val:e}},getContainerCss:function(){var e=this;return"rating-container"+l(e.theme,"theme-"+e.theme)+l(e.rtl,"rating-rtl")+l(e.size,"rating-"+e.size)+l(e.animate,"rating-animate")+l(e.disabled||e.readonly,"rating-disabled")+l(e.containerClass,e.containerClass)},checkDisabled:function(){var e=this,t=e.$element,a=e.options;e.disabled=void 0===a.disabled?t.attr("disabled")||!1:a.disabled,e.readonly=void 0===a.readonly?t.attr("readonly")||!1:a.readonly,e.inactive=e.disabled||e.readonly,t.attr({disabled:e.disabled,readonly:e.readonly})},addContent:function(e,t){var a=this,n=a.$container,r="clear"===e?a.$clear:a.$caption;return i(r)?a.rtl?"clear"===e?n.append(t):n.prepend(t):"clear"===e?n.prepend(t):n.append(t):null},generateRating:function(){var t,a,n,r=this,i=r.$element;void 0!==r.$container&&r.$container.before(r.$element).remove(),a=r.$container=e(document.createElement("div")).insertBefore(i),(r.rtl||"rtl"===i.attr("dir"))&&(r.rtl=!0,i.attr("dir","rtl")),o(a,r.getContainerCss()),r.$rating=t=e(document.createElement("div")).attr("class","rating").appendTo(a).append(r.getStars("empty")).append(r.getStars("filled")),r.$emptyStars=t.find(".empty-stars"),r.$filledStars=t.find(".filled-stars"),r.renderCaption(),r.renderClear(),r.initHighlight(),a.append(i),r.rtl&&(n=Math.max(r.$emptyStars.outerWidth(),r.$filledStars.outerWidth()),r.$emptyStars.width(n))},getStars:function(e){var t,a=this,n='<span class="'+e+'-stars">';for(t=1;t<=a.stars;t++)n+='<span class="star">'+a[e+"Star"]+"</span>";return n+"</span>"},getClearClass:function(){return this.clearButtonBaseClass+" "+(this.inactive?"":this.clearButtonActiveClass)},renderClear:function(){var t,a=this,n=a.clearElement?e(a.clearElement):"";return a.showClear?(t=a.getClearClass(),n.length?(o(n,t),n.attr({title:a.clearButtonTitle}).html(a.clearButton),a.$clear=n,""):(a.addContent("clear",'<div class="'+t+'" title="'+a.clearButtonTitle+'">'+a.clearButton+"</div>"),void(a.$clear=a.$container.find("."+a.clearButtonBaseClass)))):""},renderCaption:function(){var t,a=this,n=a.$element.val(),r=a.captionElement?e(a.captionElement):"";return a.showCaption?(t=a.fetchCaption(n),r.length?(o(r,"caption"),r.html(t),void(a.$caption=r)):(a.addContent("caption",'<div class="caption">'+t+"</div>"),void(a.$caption=a.$container.find(".caption")))):""},fetchCaption:function(e){var t,a,n,r,l,o=this,s=parseFloat(e)||o.clearValue,h=o.starCaptions,d=o.starCaptionClasses;return s&&s!==o.clearValue&&(s=u(s,c(o.step))),r="function"==typeof d?d(s):d[s],n="function"==typeof h?h(s):h[s],a=i(n)?o.defaultCaption.replace(/\{rating}/g,s):n,t=i(r)?o.clearCaptionClass:r,l=s===o.clearValue?o.clearCaption:a,'<span class="'+t+'">'+l+"</span>"},getWidthFromValue:function(e){var t,a=this,n=a.min,r=a.max,i=a.$emptyStars,l=i.outerWidth(),o=i.width();return e||(e=0),n>=e||n===r?0:(t=l?o/l:1,e>=r?100:(e-n)*t*100/(r-n))},getValueFromPosition:function(e){var t,a,n=this,r=c(n.step),i=n.$rating.width();return a=n.diff*e/(i*n.step),a=n.rtl?Math.floor(a):Math.ceil(a),t=u(parseFloat(n.min+a*n.step),r),t=Math.max(Math.min(t,n.max),n.min),n.rtl?n.max-t:t},toggleHover:function(e){var t,a,n,r=this;e&&(r.hoverChangeStars&&(t=r.getWidthFromValue(r.clearValue),a=e.val<=r.clearValue?t+"%":e.width,r.$filledStars.css("width",a)),r.hoverChangeCaption&&(n=e.val<=r.clearValue?r.fetchCaption(r.clearValue):e.caption,n&&r.$caption.html(n+"")))},calculate:function(e){var t=this,a=i(t.$element.val())?0:t.$element.val(),n=arguments.length?t.getValueFromPosition(e):a,r=t.fetchCaption(n),l=t.getWidthFromValue(n);return l+="%",{caption:r,width:l,val:n}},setStars:function(e){var t=this,a=arguments.length?t.calculate(e):t.calculate();t.$element.val(a.val),t.$filledStars.css("width",a.width),t.$caption.html(a.caption),t.cache=a},clear:function(){var e=this,t=e.$element,a='<span class="'+e.clearCaptionClass+'">'+e.clearCaption+"</span>";e.inactive||e.$caption.html(a),t.val(e.clearValue),e.setStars(),t.trigger("change").trigger("rating.clear")},reset:function(){var e=this,t=e.$element;t.val(e.initialValue),e.setStars(),t.trigger("rating.reset")},update:function(e){var t=this;arguments.length&&(t.$element.val(e),t.setStars())},refresh:function(t){var a=this;arguments.length&&(a.$rating.off("rating"),void 0!==a.$clear&&a.$clear.off(),a.init(e.extend(!0,a.options,t)),a.showClear?a.$clear.show():a.$clear.hide(),a.showCaption?a.$caption.show():a.$caption.hide(),a.$element.trigger("rating.refresh"))}},e.fn.rating=function(t){var a=Array.apply(null,arguments),n=[];switch(a.shift(),this.each(function(){var r,l=e(this),o=l.data("rating"),s="object"==typeof t&&t,c=s.language||l.data("language")||"en",u={};o||("en"===c||i(e.fn.ratingLocales[c])||(u=e.fn.ratingLocales[c]),r=e.extend(!0,{},e.fn.rating.defaults,e.fn.ratingLocales.en,u,s,l.data()),o=new d(this,r),l.data("rating",o)),"string"==typeof t&&n.push(o[t].apply(o,a))}),n.length){case 0:return this;case 1:return n[0];default:return n}},e.fn.rating.defaults={theme:"",language:"en",stars:5,filledStar:'<i class="glyphicon glyphicon-star"></i>',emptyStar:'<i class="glyphicon glyphicon-star-empty"></i>',containerClass:"",size:"md",animate:!0,displayOnly:!1,rtl:!1,showClear:!0,showCaption:!0,starCaptionClasses:{.5:"label label-danger",1:"label label-danger",1.5:"label label-warning",2:"label label-warning",2.5:"label label-info",3:"label label-info",3.5:"label label-primary",4:"label label-primary",4.5:"label label-success",5:"label label-success"},clearButton:'<i class="glyphicon glyphicon-minus-sign"></i>',clearButtonBaseClass:"clear-rating",clearButtonActiveClass:"clear-rating-active",clearCaptionClass:"label label-default",clearValue:null,captionElement:null,clearElement:null,hoverEnabled:!0,hoverChangeCaption:!0,hoverChangeStars:!0,hoverOnClear:!0},e.fn.ratingLocales.en={defaultCaption:"{rating} Stars",starCaptions:{.5:"Half Star",1:"One Star",1.5:"One & Half Star",2:"Two Stars",2.5:"Two & Half Stars",3:"Three Stars",3.5:"Three & Half Stars",4:"Four Stars",4.5:"Four & Half Stars",5:"Five Stars"},clearButtonTitle:"Clear",clearCaption:"Not Rated"},e.fn.rating.Constructor=d,e(document).ready(function(){var t=e("input.rating");t.length&&t.removeClass("rating-loading").addClass("rating-loading").rating()})});