(function(){var g={};
(function(window){var l,aa=this;function n(a,b){var c=a.split("."),d=aa;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d[e]?d=d[e]:d=d[e]={}:d[e]=b}function q(a,b){function c(){}c.prototype=b.prototype;a.Ob=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Mb=function(a,c,f){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2))}};/*

 Copyright 2015 Google Inc.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
function ba(a,b){this.id=a;this.lang=b||"unknown";this.enabled=this.active=!1}n("shaka.player.TextTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:0});function ca(a,b,c,d){this.id=a;this.bandwidth=b||0;this.width=c||0;this.height=d||0;this.active=!1}function da(a,b){var c=a.width*a.height,d=b.width*b.height;return c<d?-1:c>d?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0}n("shaka.player.VideoTrack.compare",da);function ea(){this.minBandwidth=this.maxBandwidth=this.maxWidth=this.maxHeight=null}ea.prototype.clone=function(){var a=new ea;a.maxHeight=this.maxHeight;a.maxWidth=this.maxWidth;a.maxBandwidth=this.maxBandwidth;a.minBandwidth=this.minBandwidth;return a};function fa(a,b,c){this.id=a;this.bandwidth=b||0;this.lang=c||"unknown";this.active=!1}n("shaka.player.AudioTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0});function ga(){}function ha(a){var b=console[a];b?b.bind||(console[a]=function(){b.apply(console,arguments)}):console[a]=function(){}}ha("error");ha("warn");ha("info");ha("log");ha("debug");function ia(){};function r(){this.fontSize="100%";this.fontColor=ja;this.fontOpacity=ka;this.backgroundColor=la;this.backgroundOpacity=ka;this.fontEdge=ma}n("shaka.player.TextStyle",r);r.prototype.a=function(){var a=window.localStorage.getItem("ShakaPlayerTextStyle");if(a){var b;try{b=JSON.parse(a)}catch(c){return}if(b&&"object"==typeof b){var a=b,d;for(d in a)d in this&&(this[d]=a[d])}}};r.prototype.load=r.prototype.a;r.prototype.b=function(){window.localStorage.setItem("ShakaPlayerTextStyle",JSON.stringify(this))};
r.prototype.store=r.prototype.b;function na(a){var b=[];b.push("font-size: "+a.fontSize);b.push("color: "+oa(a.fontColor,a.fontOpacity));b.push("background-color: "+oa(a.backgroundColor,a.backgroundOpacity));for(var c=[],d=0;d<a.fontEdge.length;++d){var e=a.fontEdge[d].slice(3,6);c.push(oa(a.fontEdge[d].slice(0,3),a.fontOpacity)+" "+e.join("px ")+"px")}b.push("text-shadow: "+c.join(","));return b.join("; ")}function oa(a,b){return"rgba("+a.concat(b).join(",")+")"}var ja=[255,255,255],la=[0,0,0];
r.StandardColors={WHITE:ja,BLACK:la,RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,255,0],MAGENTA:[255,0,255],CYAN:[0,255,255]};var ka=1;r.StandardOpacities={OPAQUE:ka,SEMI_HIGH:.75,SEMI_LOW:.25,TRANSPARENT:0};var ma=[];
r.EdgeStyles={NONE:ma,RAISED:[[34,34,34,1,1,0],[34,34,34,2,2,0],[34,34,34,3,3,0]],DEPRESSED:[[204,204,204,1,1,0],[204,204,204,0,1,0],[34,34,34,-1,-1,0],[34,34,34,0,-1,0]],UNIFORM:[[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4]],DROP:[[34,34,34,2,2,3],[34,34,34,2,2,4],[34,34,34,2,2,5]]};function pa(a){qa[a]={na:ra(),end:NaN}}function sa(a){if(a=qa[a])a.end=ra()}function ua(a){return(a=qa[a])&&a.end?a.end-a.na:NaN}var ra=window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now,qa={};var va={"output-restricted":"The required output protection is not available.","output-not-allowed":"The required output protection is not available.",expired:"The decryption key has expired.","internal-error":"The key system has encountered an unspecified error."};function w(a){var b=new CustomEvent(a.type,{detail:a.detail,bubbles:!!a.bubbles}),c;for(c in a)c in b||(b[c]=a[c]);return b}function x(a){return new CustomEvent("error",{detail:a,bubbles:!0})};function wa(a){this.b=a;this.c=0==xa;this.a=0}var xa=1;function ya(a){return a.a<a.b.byteLength}function za(a){var b=a.b.getUint8(a.a);a.a+=1;return b}function z(a){var b=a.b.getUint32(a.a,a.c);a.a+=4;return b}function Aa(a){var b,c;a.c?(b=a.b.getUint32(a.a,!0),c=a.b.getUint32(a.a+4,!0)):(c=a.b.getUint32(a.a,!1),b=a.b.getUint32(a.a+4,!1));if(2097151<c)throw new RangeError("DataViewReader: Overflow reading 64-bit value.");a.a+=8;return c*Math.pow(2,32)+b}
function Ba(a){if(a.a+16>a.b.byteLength)throw new RangeError("DataViewReader: Read past end of DataView.");var b=new Uint8Array(a.b.buffer,a.a,16);a.a+=16;return b}function A(a,b){if(a.a+b>a.b.byteLength)throw new RangeError("DataViewReader: Skip past end of DataView.");a.a+=b};function Ca(a){return Object.keys(a).map(function(b){return a[b]})}function Da(a,b){var c=Ea(a,b,"number");if(null==c)return null;if(isNaN(c)||c==Number.NEGATIVE_INFINITY||c==Number.POSITIVE_INFINITY)throw new RangeError("'"+b+"' must be finite.");if(0>c)throw new RangeError("'"+b+"' must be >= 0");return c}function Fa(a,b){return Ea(a,b,"string")}function Ea(a,b,c){a=a[b];if(null==a)return null;if(typeof a!=c)throw new TypeError("'"+b+"' must be a "+c+".");return a}
function Ha(a,b,c){a=a[b];if(null==a)return null;if(!(a instanceof c))throw new TypeError("'"+b+"' must be an instance of "+c.name+".");return a};function B(){this.a={}}B.prototype.push=function(a,b){this.a.hasOwnProperty(a)?this.a[a].push(b):this.a[a]=[b]};B.prototype.get=function(a){return(a=this.a[a])?a.slice():null};function Ia(a){var b=[],c;for(c in a.a)b.push.apply(b,a.a[c]);return b}function Ja(a,b,c){if(a=a.a[b])for(b=0;b<a.length;++b)a[b]==c&&(a.splice(b,1),--b)}function Ka(a){var b=[],c;for(c in a.a)b.push(c);return b};function La(a,b){for(var c={},d=0;d<a.length;++d){var e=b?b(a[d]):a[d].toString();c[e]=a[d]}var d=[],f;for(f in c)d.push(c[f]);return d};function C(){var a,b,c=new Promise(function(c,e){a=c;b=e});c.resolve=a;c.reject=b;c.destroy=C.prototype.destroy;return c}C.prototype.destroy=function(){this.catch(function(){});var a=Error("Destroyed!");a.type="destroy";this.reject(a)};function Ma(a,b,c){Na(b);Na(c);return c==b||a>=Oa&&c==b.split("-")[0]||a>=Pa&&c.split("-")[0]==b.split("-")[0]?!0:!1}var Oa=1,Pa=2;function Na(a){a=a.toLowerCase().split("-");var b=Qa[a[0]];b&&(a[0]=b);return a.join("-")}
var Qa={aar:"aa",abk:"ab",afr:"af",aka:"ak",alb:"sq",amh:"am",ara:"ar",arg:"an",arm:"hy",asm:"as",ava:"av",ave:"ae",aym:"ay",aze:"az",bak:"ba",bam:"bm",baq:"eu",bel:"be",ben:"bn",bih:"bh",bis:"bi",bod:"bo",bos:"bs",bre:"br",bul:"bg",bur:"my",cat:"ca",ces:"cs",cha:"ch",che:"ce",chi:"zh",chu:"cu",chv:"cv",cor:"kw",cos:"co",cre:"cr",cym:"cy",cze:"cs",dan:"da",deu:"de",div:"dv",dut:"nl",dzo:"dz",ell:"el",eng:"en",epo:"eo",est:"et",eus:"eu",ewe:"ee",fao:"fo",fas:"fa",fij:"fj",fin:"fi",fra:"fr",fre:"fr",
fry:"fy",ful:"ff",geo:"ka",ger:"de",gla:"gd",gle:"ga",glg:"gl",glv:"gv",gre:"el",grn:"gn",guj:"gu",hat:"ht",hau:"ha",heb:"he",her:"hz",hin:"hi",hmo:"ho",hrv:"hr",hun:"hu",hye:"hy",ibo:"ig",ice:"is",ido:"io",iii:"ii",iku:"iu",ile:"ie",ina:"ia",ind:"id",ipk:"ik",isl:"is",ita:"it",jav:"jv",jpn:"ja",kal:"kl",kan:"kn",kas:"ks",kat:"ka",kau:"kr",kaz:"kk",khm:"km",kik:"ki",kin:"rw",kir:"ky",kom:"kv",kon:"kg",kor:"ko",kua:"kj",kur:"ku",lao:"lo",lat:"la",lav:"lv",lim:"li",lin:"ln",lit:"lt",ltz:"lb",lub:"lu",
lug:"lg",mac:"mk",mah:"mh",mal:"ml",mao:"mi",mar:"mr",may:"ms",mkd:"mk",mlg:"mg",mlt:"mt",mon:"mn",mri:"mi",msa:"ms",mya:"my",nau:"na",nav:"nv",nbl:"nr",nde:"nd",ndo:"ng",nep:"ne",nld:"nl",nno:"nn",nob:"nb",nor:"no",nya:"ny",oci:"oc",oji:"oj",ori:"or",orm:"om",oss:"os",pan:"pa",per:"fa",pli:"pi",pol:"pl",por:"pt",pus:"ps",que:"qu",roh:"rm",ron:"ro",rum:"ro",run:"rn",rus:"ru",sag:"sg",san:"sa",sin:"si",slk:"sk",slo:"sk",slv:"sl",sme:"se",smo:"sm",sna:"sn",snd:"sd",som:"so",sot:"st",spa:"es",sqi:"sq",
srd:"sc",srp:"sr",ssw:"ss",sun:"su",swa:"sw",swe:"sv",tah:"ty",tam:"ta",tat:"tt",tel:"te",tgk:"tg",tgl:"tl",tha:"th",tib:"bo",tir:"ti",ton:"to",tsn:"tn",tso:"ts",tuk:"tk",tur:"tr",twi:"tw",uig:"ug",ukr:"uk",urd:"ur",uzb:"uz",ven:"ve",vie:"vi",vol:"vo",wel:"cy",wln:"wa",wol:"wo",xho:"xh",yid:"yi",yor:"yo",zha:"za",zho:"zh",zul:"zu"};function Ra(a){this.c=Math.exp(Math.log(.5)/a);this.a=this.b=0}Ra.prototype.sample=function(a,b){var c=Math.pow(this.c,a);this.b=b*(1-c)+c*this.b;this.a+=a};function Sa(a){return a.b/(1-Math.pow(a.c,a.a))};function Ta(){this.g=new C;this.f=!1;this.a=null;this.b=[];this.c=null}function Ua(a,b){if(a.f)throw Error("Cannot append to a running task!");a.b.push(b)}Ta.prototype.start=function(){if(this.f)throw Error("Task already started!");this.f=!0;this.b.unshift(function(){});Va(this,void 0)};Ta.prototype.end=function(){this.b.splice(1)};
function Va(a,b){var c=a.b[0](b),d;c?(d=c[0],a.c=c[1]):(d=Promise.resolve(),a.c=null);d.then(D(a,function(a){this.a?(this.b=[],this.c=null,Wa(this)):(this.b.shift(),this.b.length?Va(this,a):(this.g.resolve(a),this.c=null))})).catch(D(a,function(a){this.b=[];this.c=null;this.a?Wa(this):this.g.reject(a)}))}function Wa(a){var b=Error("Task aborted.");b.type="aborted";a.g.reject(b);window.setTimeout(function(){this.a.resolve();this.a=null}.bind(a),5)};function E(a){this.xa=new B;this.i=a}n("shaka.util.FakeEventTarget",E);E.prototype.addEventListener=function(a,b,c){c||this.xa.push(a,b)};E.prototype.removeEventListener=function(a,b,c){c||Ja(this.xa,a,b)};E.prototype.dispatchEvent=function(a){delete a.srcElement;delete a.target;delete a.currentTarget;Object.defineProperties(a,{srcElement:{value:null,writable:!0},target:{value:this,writable:!0},currentTarget:{value:null,writable:!0}});return Xa(this,a)};
function Xa(a,b){b.currentTarget=a;for(var c=a.xa.get(b.type)||[],d=0;d<c.length;++d){var e=c[d];try{e.handleEvent?e.handleEvent(b):e.call(a,b)}catch(f){}}a.i&&b.bubbles&&Xa(a.i,b);return b.defaultPrevented};function Ya(){return Date.now()+Za}var Za=0;function $a(a){this.b=a;this.a=new wa(a);ab||(ab=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}var ab;
function bb(a){var b;b=cb(a);if(7<b.length)throw new RangeError("EbmlParser: EBML ID must be at most 7 bytes.");for(var c=0,d=0;d<b.length;d++)c=256*c+b[d];b=c;c=cb(a);a:{for(d=0;d<ab.length;d++)if(db(c,ab[d])){d=!0;break a}d=!1}if(d)throw new RangeError("EbmlParser: Element cannot contain dynamically sized data.");if(8==c.length&&c[1]&224)throw new RangeError("EbmlParser: Variable sized integer value must be at most 53 bits.");for(var d=c[0]&(1<<8-c.length)-1,e=1;e<c.length;e++)d=256*d+c[e];c=d;
c=a.a.a+c<=a.b.byteLength?c:a.b.byteLength-a.a.a;d=new DataView(a.b.buffer,a.b.byteOffset+a.a.a,c);A(a.a,c);return new eb(b,d)}function cb(a){var b=za(a.a),c;for(c=1;8>=c&&!(b&1<<8-c);c++);if(8<c)throw new RangeError("EbmlParser: Variable sized integer must fit within 8 bytes.");var d=new Uint8Array(c);d[0]=b;for(b=1;b<c;b++)d[b]=za(a.a);return d}function eb(a,b){this.id=a;this.a=b}
function fb(a){if(8<a.a.byteLength)throw new RangeError("EbmlElement: Unsigned integer has too many bytes.");if(8==a.a.byteLength&&a.a.getUint8(0)&224)throw new RangeError("EbmlParser: Unsigned integer must be at most 53 bits.");for(var b=0,c=0;c<a.a.byteLength;c++)var d=a.a.getUint8(c),b=256*b+d;return b};function gb(){this.a=new B}gb.prototype.destroy=function(){hb(this);this.a=null};function F(a,b,c,d){b=new ib(b,c,d);a.a.push(c,b)}gb.prototype.sa=function(a,b){for(var c=this.a.get(b)||[],d=0;d<c.length;++d){var e=c[d];e.target==a&&(e.sa(),Ja(this.a,b,e))}};function hb(a){for(var b=Ia(a.a),c=0;c<b.length;++c)b[c].sa();a.a.a={}}function ib(a,b,c){this.target=a;this.type=b;this.a=c;this.target.addEventListener(b,c,!1)}
ib.prototype.sa=function(){this.target&&(this.target.removeEventListener(this.type,this.a,!1),this.a=this.target=null)};function D(a,b){return b.bind(a)};function jb(a,b,c){MediaSource.isTypeSupported(b);b=a.addSourceBuffer(b);this.j=a;this.c=b;this.l=c;this.h=new gb;this.b=[];this.u=0;this.f=this.a=null;this.o=0;F(this.h,this.c,"updateend",this.w.bind(this))}var kb=1/60;jb.prototype.destroy=function(){lb(this).catch(function(){});this.f&&this.f.destroy();this.b=this.a=this.f=null;this.h.destroy();this.j=this.c=this.h=null};
function mb(a,b){for(var c=a.c.buffered,d=0;d<c.length;++d){var e=c.start(d)-kb,f=c.end(d)+kb;if(b>=e&&b<=f)return c.end(d)-b}return 0}
function nb(a,b,c,d){if(a.a)return a=Error("Cannot fetch ("+a.i+"): previous operation not complete."),a.type="stream",Promise.reject(a);a.a=new Ta;c!=a.c.timestampOffset&&(a.c.timestampOffset=c);d&&Ua(a.a,function(){return[ob(this,d),this.g.bind(this)]}.bind(a));Ua(a.a,function(){var a=b.a?b.a-b.b:1,c=new pb;c.a=3;c.g=1E3*a;c.c=1E3*this.o;return[qb(b.url,c,this.l),G.prototype.g.bind(b.url)]}.bind(a));Ua(a.a,D(a,function(a){this.l.getBandwidth();return[ob(this,a),this.g.bind(this)]}));var e=0==a.c.buffered.length&&
0==a.b.length,f=null;Ua(a.a,function(){if(0==this.c.buffered.length){var a=Error("Failed to buffer segment ("+this.i+").");a.type="stream";return[Promise.reject(a)]}e&&(a=b.b,f=this.c.buffered.start(0)-a);a=rb(this.b,b.b);0<=a?this.b.splice(a+1,0,b):this.b.push(b)}.bind(a));return sb(a).then(function(){return Promise.resolve(f)}.bind(a))}
function tb(a){if(a.a)return a=Error("Cannot clear ("+a.i+"): previous operation not complete."),a.type="stream",Promise.reject(a);a.a=new Ta;Ua(a.a,function(){var a;a:if(0==this.c.buffered.length)a=Promise.resolve();else{try{this.c.remove(0,Number.POSITIVE_INFINITY)}catch(c){a=Promise.reject(c);break a}this.b=[];a=this.f=new C}return[a,this.g.bind(this)]}.bind(a));return sb(a)}
function ub(a,b){if(a.a){var c=Error("Cannot clearAfter ("+a.i+"): previous operation not complete.");c.type="stream";return Promise.reject(c)}a.a=new Ta;Ua(a.a,function(){return[vb(this,b),this.g.bind(this)]}.bind(a));return sb(a)}function lb(a){a.a?(a=a.a,a.a?a=a.a:a.f?(a.c&&a.c(),a.a=new C,a=a.a):(a.f=!0,a=Promise.resolve())):a=Promise.resolve();return a}function sb(a){a.a.start();return a.a.g.then(D(a,function(){this.a=null})).catch(D(a,function(a){this.a=null;return Promise.reject(a)}))}
function ob(a,b){try{a.c.appendBuffer(b)}catch(c){return Promise.reject(c)}a.f=new C;return a.f}function vb(a,b){if(0==a.c.buffered.length)return Promise.resolve();var c=rb(a.b,b);if(-1==c||c==a.b.length-1)return Promise.resolve();try{a.c.remove(a.b[c+1].b,Number.POSITIVE_INFINITY)}catch(d){return Promise.reject(d)}a.b=a.b.slice(0,c+1);a.f=new C;return a.f}jb.prototype.g=function(){"open"==this.j.readyState&&this.c.abort()};jb.prototype.w=function(){this.f.resolve();this.f=null};function wb(a,b){E.call(this,b);this.a=null;this.h=a}q(wb,E);
function xb(a){if(!window.indexedDB)return a=Error("Persistant storage requires IndexedDB support."),Promise.reject(a);if(a.a)return a=Error("A database connection is already open."),Promise.reject(a);var b=new C,c=window.indexedDB.open("content_database",1);c.onupgradeneeded=D(a,function(a){this.a=a.target.result;yb(this,"group_store",{keyPath:"group_id"});yb(this,"stream_index_store",{keyPath:"stream_id"});a=yb(this,"content_store",{autoIncrement:"true"});a.createIndex("segment",["stream_id","segment_id"],
{unique:!0});a.createIndex("stream","stream_id",{unique:!1})});c.onsuccess=D(a,function(a){this.a=a.target.result;b.resolve()});c.onerror=function(){b.reject(c.error)};return b}function H(a){a.a&&(a.a.close(),a.a=null)}function yb(a,b,c){a.a.objectStoreNames.contains(b)&&a.a.deleteObjectStore(b);return a.a.createObjectStore(b,c)}function zb(a){return Ab(a,"content_store")}function Bb(a){return Ab(a,"stream_index_store")}function Cb(a){return Ab(a,"group_store")}
function Ab(a,b){return a.a.transaction([b],a.h).objectStore(b)}function Db(a,b){var c=new C,d=a.get(b);d.onerror=function(){c.reject(d.error)};d.onsuccess=function(){if(d.result)c.resolve(d.result);else{var a=Error("Item not found.");a.type="storage";c.reject(a)}};return c};function Fb(){wb.call(this,"readonly",null)}q(Fb,wb);function Gb(a){var b=new C,c=[],d=Cb(a).openCursor();d.onerror=function(){b.reject(d.error)};d.onsuccess=function(a){(a=a.target.result)?(c.push(a.key),a.continue()):b.resolve(c)};return b}
function Hb(a,b){return Db(Cb(a),b).then(D(a,function(a){a.session_ids=La(a.session_ids);return a.hasOwnProperty("duration")||a.hasOwnProperty("key_system")?Promise.resolve(a):Ib(this,a.stream_ids[0]).then(function(b){a.duration=b.duration;a.key_system=b.key_system;return Promise.resolve(a)})}))}function Ib(a,b){return Db(Bb(a),b)}function Jb(a,b,c){return Db(zb(a).index("segment"),[b,c]).then(function(a){return Promise.resolve(a.content)})};function Kb(){E.call(this,null);this.a=new Ra(3);this.c=new Ra(10);this.b=0}q(Kb,E);n("shaka.util.EWMABandwidthEstimator",Kb);Kb.prototype.sample=function(a,b){if(!(65536>b)){a=Math.max(a,50);var c=8E3*b/a,d=a/1E3;this.a.sample(d,c);this.c.sample(d,c);this.dispatchEvent(w({type:"bandwidth"}));this.b=Date.now()}};Kb.prototype.getBandwidth=function(){return.5>this.a.a?5E5:Math.min(Sa(this.a),Sa(this.c))};Kb.prototype.getDataAge=function(){return(Date.now()-this.b)/1E3};
Kb.prototype.supportsCaching=function(){return!1};function Lb(a){return a.split("").reduce(function(a,c,d){return a+(d&&0==d%4?" "+c:c)})};function Mb(a){return String.fromCharCode.apply(null,a)}n("shaka.util.Uint8ArrayUtils.toString",Mb);function Nb(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;++c)b[c]=a.charCodeAt(c);return b}n("shaka.util.Uint8ArrayUtils.fromString",Nb);function Ob(a,b){var c=void 0==b?!0:b,d=window.btoa(Mb(a)).replace(/\+/g,"-").replace(/\//g,"_");return c?d:d.replace(/=*$/,"")}n("shaka.util.Uint8ArrayUtils.toBase64",Ob);function Pb(a){return Nb(window.atob(a.replace(/-/g,"+").replace(/_/g,"/")))}
n("shaka.util.Uint8ArrayUtils.fromBase64",Pb);n("shaka.util.Uint8ArrayUtils.fromHex",function(a){for(var b=new Uint8Array(a.length/2),c=0;c<a.length;c+=2)b[c/2]=window.parseInt(a.substr(c,2),16);return b});function Qb(a){for(var b="",c=0;c<a.length;++c){var d=a[c].toString(16);1==d.length&&(d="0"+d);b+=d}return b}n("shaka.util.Uint8ArrayUtils.toHex",Qb);function db(a,b){if(!a&&!b)return!0;if(!a||!b||a.length!=b.length)return!1;for(var c=0;c<a.length;++c)if(a[c]!=b[c])return!1;return!0};function Rb(){this.j=this.a="";this.u=!1;this.g=this.f=null;this.l=this.i=!1;this.o=this.h="";this.c=null;this.b=[]}
function Sb(a){var b=new Rb;if(!a)return b;var c=Fa(a,"keySystem");if(null!=c)b.a=c;else throw Error("'keySystem' cannot be null.");var d=Fa(a,"licenseServerUrl");if(null!=d)b.j=d;else if(c)throw Error("For encrypted streaming content, 'licenseServerUrl' cannot be null or empty.");c=Ea(a,"withCredentials","boolean");null!=c&&(b.u=c);c=Ha(a,"licensePostProcessor",Function);null!=c&&(b.f=c);c=Ha(a,"licensePreProcessor",Function);null!=c&&(b.g=c);c=Ea(a,"distinctiveIdentifierRequired","boolean");null!=
c&&(b.i=c);c=Ea(a,"persistentStateRequired","boolean");null!=c&&(b.l=c);c=Fa(a,"audioRobustness");null!=c&&(b.h=c);c=Fa(a,"videoRobustness");null!=c&&(b.o=c);c=Ha(a,"serverCertificate",Uint8Array);null!=c&&(b.c=c);if(c=Ha(a,"initData",Object)){a=Ha(c,"initData",Uint8Array);if(null==a)throw Error("'initData.initData' cannot be null.");c=Fa(c,"initDataType");if(null==c)throw Error("'initData.initDataType' cannot be null.");b.b.push({initData:new Uint8Array(a.buffer),initDataType:c})}return b}
function Tb(a,b){var c=a.b.concat(b.map(function(a){return{initData:new Uint8Array(a.initData.buffer),initDataType:a.initDataType}}));a.b=La(c,function(a){return Array.prototype.join.apply(a.initData)+","+a.initDataType})};function Ub(a,b,c,d,e,f,g,h,k,m,p){this.g=a;this.j=b;this.u=c;this.a=[];this.h=e||null;this.i=f||null;this.f=g==Vb;this.l=h==Wb;this.c=k||"";this.o=m||"";this.b=p||null;d&&this.a.push(d)}n("shaka.player.DrmSchemeInfo",Ub);var Vb=1;Ub.DistinctiveIdentifier={OPTIONAL:0,REQUIRED:Vb};var Wb=1;Ub.PersistentState={OPTIONAL:0,REQUIRED:Wb};Ub.createUnencrypted=function(){return new Ub("","",!1,null)};function Xb(a){this.systemIds=[];this.cencKeyIds=[];a=new wa(new DataView(a.buffer));try{for(;ya(a);){var b=a.a,c=z(a),d=z(a);1==c?c=Aa(a):0==c&&(c=a.b.byteLength-b);if(1886614376!=d)A(a,c-(a.a-b));else{var e=za(a);if(1<e)A(a,c-(a.a-b));else{A(a,3);var f=Qb(Ba(a)),g=[];if(0<e)for(var h=z(a),k=0;k<h;++k){var m=Qb(Ba(a));g.push(m)}var p=z(a);A(a,p);this.cencKeyIds.push.apply(this.cencKeyIds,g);this.systemIds.push(f);a.a!=b+c&&A(a,c-(a.a-b))}}}}catch(t){}};function Yb(){return Promise.reject(Error("The key system specified is not supported."))}function Zb(a){return null==a?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function $b(){throw new TypeError("Illegal constructor.");}$b.prototype.createSession=function(){};$b.prototype.setServerCertificate=function(){};function ac(){throw new TypeError("Illegal constructor.");}ac.prototype.getConfiguration=function(){};ac.prototype.createMediaKeys=function(){};function bc(){var a="CustomEvent"in window;if(a)try{new CustomEvent("")}catch(b){a=!1}a||(window.CustomEvent=cc)}n("shaka.polyfill.CustomEvent.install",bc);function cc(a,b){var c=document.createEvent("CustomEvent"),d=b||{bubbles:!1,cancelable:!1,detail:null};c.initCustomEvent(a,!!d.bubbles,!!d.cancelable,d.detail);return c};function dc(){var a=HTMLVideoElement.prototype;!a.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in a&&(a.getVideoPlaybackQuality=ec)}n("shaka.polyfill.VideoPlaybackQuality.install",dc);function ec(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}};function fc(a,b){try{var c=new gc(a,b);return Promise.resolve(c)}catch(d){return Promise.reject(d)}}function hc(a){var b=this.mediaKeys;b&&b!=a&&ic(b,null);delete this.mediaKeys;(this.mediaKeys=a)&&ic(a,this);return Promise.resolve()}
function gc(a,b){this.a=this.keySystem=a;var c=!0;"org.w3.clearkey"==a&&(this.a="webkit-org.w3.clearkey",c=!1);var d=!1,e;e=document.getElementsByTagName("video");e=e.length?e[0]:document.createElement("video");for(var f=0;f<b.length;++f){var g=b[f],h={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:g.initDataTypes,sessionTypes:["temporary"]},k=!1;if(g.audioCapabilities)for(var m=0;m<g.audioCapabilities.length;++m){var p=g.audioCapabilities[m];
p.contentType&&(k=!0,e.canPlayType(p.contentType.split(";")[0],this.a)&&(h.audioCapabilities.push(p),d=!0))}if(g.videoCapabilities)for(m=0;m<g.videoCapabilities.length;++m)p=g.videoCapabilities[m],p.contentType&&(k=!0,e.canPlayType(p.contentType,this.a)&&(h.videoCapabilities.push(p),d=!0));k||(d=e.canPlayType("video/mp4",this.a)||e.canPlayType("video/webm",this.a));"required"==g.persistentState&&(c?(h.persistentState="required",h.sessionTypes=["persistent-license"]):d=!1);if(d){this.b=h;return}}throw Error("None of the requested configurations were supported.");
}gc.prototype.createMediaKeys=function(){var a=new jc(this.a);return Promise.resolve(a)};gc.prototype.getConfiguration=function(){return this.b};function jc(a){this.g=a;this.b=null;this.a=new gb;this.c=[];this.f={}}function ic(a,b){a.b=b;hb(a.a);b&&(F(a.a,b,"webkitneedkey",a.Bb.bind(a)),F(a.a,b,"webkitkeymessage",a.Ab.bind(a)),F(a.a,b,"webkitkeyadded",a.yb.bind(a)),F(a.a,b,"webkitkeyerror",a.zb.bind(a)))}l=jc.prototype;
l.createSession=function(a){var b=a||"temporary";if("temporary"!=b&&"persistent-license"!=b)throw new TypeError("Session type "+a+" is unsupported on this platform.");a=this.b||document.createElement("video");a.src||(a.src="about:blank");b=new kc(a,this.g,b);this.c.push(b);return b};l.setServerCertificate=function(){return Promise.reject(Error("setServerCertificate not supported on this platform."))};l.Bb=function(a){a=w({type:"encrypted",initDataType:"webm",initData:a.initData});this.b.dispatchEvent(a)};
l.Ab=function(a){var b=lc(this,a.sessionId);b&&(a=w({type:"message",messageType:void 0==b.keyStatuses.a?"licenserequest":"licenserenewal",message:a.message}),b.b&&(b.b.resolve(),b.b=null),b.dispatchEvent(a))};l.yb=function(a){if(a=lc(this,a.sessionId))mc(a,"usable"),a.a&&a.a.resolve(),a.a=null};
l.zb=function(a){var b=lc(this,a.sessionId);if(b){var c=Error("EME v0.1b key error");c.errorCode=a.errorCode;c.errorCode.systemCode=a.systemCode;!a.sessionId&&b.b?(c.method="generateRequest",45==a.systemCode&&(c.message="Unsupported session type."),b.b.reject(c),b.b=null):a.sessionId&&b.a?(c.method="update",b.a.reject(c),b.a=null):(c=a.systemCode,a.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?mc(b,"output-restricted"):1==c?mc(b,"expired"):mc(b,"internal-error"))}};
function lc(a,b){var c=a.f[b];return c?c:(c=a.c.shift())?(c.sessionId=b,a.f[b]=c):null}function kc(a,b,c){E.call(this,null);this.f=a;this.h=!1;this.a=this.b=null;this.c=b;this.g=c;this.sessionId="";this.expiration=NaN;this.closed=new C;this.keyStatuses=new nc}q(kc,E);
function oc(a,b,c){if(a.h)return Promise.reject(Error("The session is already initialized."));a.h=!0;var d;try{if("persistent-license"==a.g)if(c)d=Nb("LOAD_SESSION|"+c);else{var e=new Uint8Array(b);d=Nb("PERSISTENT|"+Mb(e))}else d=new Uint8Array(b)}catch(f){return Promise.reject(f)}a.b=new C;try{a.f.webkitGenerateKeyRequest(a.c,d)}catch(g){if("InvalidStateError"!=g.name)return a.b=null,Promise.reject(g);setTimeout(function(){try{this.f.webkitGenerateKeyRequest(this.c,d)}catch(a){this.b.reject(a),
this.b=null}}.bind(a),10)}return a.b}l=kc.prototype;l.Ia=function(a,b){if(this.a)this.a.then(this.Ia.bind(this,a,b)).catch(this.Ia.bind(this,a,b));else{this.a=a;var c,d;"webkit-org.w3.clearkey"==this.c?(c=Mb(new Uint8Array(b)),d=JSON.parse(c),"oct"!=d.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null),c=Pb(d.keys[0].k),d=Pb(d.keys[0].kid)):(c=new Uint8Array(b),d=null);try{this.f.webkitAddKey(this.c,c,d,this.sessionId)}catch(e){this.a.reject(e),this.a=null}}};
function mc(a,b){var c=a.keyStatuses;c.size=void 0==b?0:1;c.a=b;c=w({type:"keystatuseschange"});a.dispatchEvent(c)}l.generateRequest=function(a,b){return oc(this,b,null)};l.load=function(a){return"persistent-license"==this.g?oc(this,null,a):Promise.reject(Error("Not a persistent session."))};l.update=function(a){var b=new C;this.Ia(b,a);return b};
l.close=function(){if("persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;this.f.webkitCancelKeyRequest(this.c,this.sessionId)}this.closed.resolve();return this.closed};l.remove=function(){return"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()};function pc(a){this.b=a;this.a=0}
pc.prototype.next=function(){return this.a>=this.b.length?{value:void 0,done:!0}:{value:this.b[this.a++],done:!1}};function nc(){this.size=0;this.a=void 0}var qc;l=nc.prototype;l.entries=function(){var a=qc,b=[];this.a&&b.push([a,this.a]);return new pc(b)};l.forEach=function(a){this.a&&a(this.a)};l.get=function(a){if(this.has(a))return this.a};l.has=function(a){var b=qc;return this.a&&db(new Uint8Array(a),b)?!0:!1};l.keys=function(){var a=qc,b=[];this.a&&b.push(a);return new pc(b)};
l.values=function(){var a=[];this.a&&a.push(this.a);return new pc(a)};function rc(){Navigator.prototype.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(HTMLMediaElement.prototype.webkitGenerateKeyRequest?(qc=new Uint8Array([0]),Navigator.prototype.requestMediaKeySystemAccess=fc,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=hc,window.MediaKeys=jc,window.MediaKeySystemAccess=gc):(Navigator.prototype.requestMediaKeySystemAccess=Yb,delete HTMLMediaElement.prototype.mediaKeys,
HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Zb,window.MediaKeys=$b,window.MediaKeySystemAccess=ac))}n("shaka.polyfill.MediaKeys.install",rc);function sc(){var a=Element.prototype;a.requestFullscreen=a.requestFullscreen||a.mozRequestFullScreen||a.msRequestFullscreen||a.webkitRequestFullscreen;a=Document.prototype;a.exitFullscreen=a.exitFullscreen||a.mozCancelFullScreen||a.msExitFullscreen||a.webkitExitFullscreen;"fullscreenElement"in document||Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}});document.addEventListener("webkitfullscreenchange",
tc);document.addEventListener("webkitfullscreenerror",tc);document.addEventListener("mozfullscreenchange",tc);document.addEventListener("mozfullscreenerror",tc);document.addEventListener("MSFullscreenChange",tc);document.addEventListener("MSFullscreenError",tc)}n("shaka.polyfill.Fullscreen.install",sc);function tc(a){var b=a.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),b=new Event(b,a);a.target.dispatchEvent(b)};n("shaka.polyfill.installAll",function(){bc();sc();rc();dc()});var uc=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function I(a){var b;a instanceof I?(vc(this,a.R),this.$=a.$,this.P=a.P,wc(this,a.fa),this.O=a.O,yc(this,a.a.clone()),this.Y=a.Y):a&&(b=String(a).match(uc))?(vc(this,b[1]||"",!0),this.$=zc(b[2]||""),this.P=zc(b[3]||"",!0),wc(this,b[4]),this.O=zc(b[5]||"",!0),yc(this,b[6]||"",!0),this.Y=zc(b[7]||"")):this.a=new Ac(null)}l=I.prototype;l.R="";l.$="";l.P="";l.fa=null;l.O="";l.Y="";
l.toString=function(){var a=[],b=this.R;b&&a.push(Bc(b,Cc,!0),":");if(b=this.P){a.push("//");var c=this.$;c&&a.push(Bc(c,Cc,!0),"@");a.push(encodeURIComponent(b).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));b=this.fa;null!=b&&a.push(":",String(b))}if(b=this.O)this.P&&"/"!=b.charAt(0)&&a.push("/"),a.push(Bc(b,"/"==b.charAt(0)?Dc:Ec,!0));(b=this.a.toString())&&a.push("?",b);(b=this.Y)&&a.push("#",Bc(b,Fc));return a.join("")};
l.resolve=function(a){var b=this.clone();"data"===b.R&&(b=new I);var c=!!a.R;c?vc(b,a.R):c=!!a.$;c?b.$=a.$:c=!!a.P;c?b.P=a.P:c=null!=a.fa;var d=a.O;if(c)wc(b,a.fa);else if(c=!!a.O){if("/"!=d.charAt(0))if(this.P&&!this.O)d="/"+d;else{var e=b.O.lastIndexOf("/");-1!=e&&(d=b.O.substr(0,e+1)+d)}if(".."==d||"."==d)d="";else if(-1!=d.indexOf("./")||-1!=d.indexOf("/.")){for(var e=0==d.lastIndexOf("/",0),d=d.split("/"),f=[],g=0;g<d.length;){var h=d[g++];"."==h?e&&g==d.length&&f.push(""):".."==h?((1<f.length||
1==f.length&&""!=f[0])&&f.pop(),e&&g==d.length&&f.push("")):(f.push(h),e=!0)}d=f.join("/")}}c?b.O=d:c=""!==a.a.toString();c?yc(b,a.a.clone()):c=!!a.Y;c&&(b.Y=a.Y);return b};l.clone=function(){return new I(this)};function vc(a,b,c){a.R=c?zc(b,!0):b;a.R&&(a.R=a.R.replace(/:$/,""))}function wc(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.fa=b}else a.fa=null}function yc(a,b,c){b instanceof Ac?a.a=b:(c||(b=Bc(b,Gc)),a.a=new Ac(b))}
function zc(a,b){return a?b?decodeURI(a):decodeURIComponent(a):""}function Bc(a,b,c){return"string"==typeof a?(a=encodeURI(a).replace(b,Hc),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Hc(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Cc=/[#\/\?@]/g,Ec=/[\#\?:]/g,Dc=/[\#\?]/g,Gc=/[\#\?@]/g,Fc=/#/g;function Ac(a){this.b=a||null}Ac.prototype.a=null;Ac.prototype.c=null;
function Ic(a,b,c){if(!a.a&&(a.a={},a.c=0,a.b))for(var d=a.b.split("&"),e=0;e<d.length;e++){var f=d[e].indexOf("="),g=null,h=null;0<=f?(g=d[e].substring(0,f),h=d[e].substring(f+1)):g=d[e];g=decodeURIComponent(g.replace(/\+/g," "));h=h||"";Ic(a,g,decodeURIComponent(h.replace(/\+/g," ")))}a.b=null;(d=a.a.hasOwnProperty(b)&&a.a[b])||(a.a[b]=d=[]);d.push(c);a.c++}
Ac.prototype.toString=function(){if(this.b)return this.b;if(!this.a)return"";var a=[],b;for(b in this.a)for(var c=encodeURIComponent(b),d=this.a[b],e=0;e<d.length;e++){var f=c;""!==d[e]&&(f+="="+encodeURIComponent(d[e]));a.push(f)}return this.b=a.join("&")};Ac.prototype.clone=function(){var a=new Ac;a.b=this.b;if(this.a){var b={},c;for(c in this.a)b[c]=this.a[c].concat();a.a=b;a.c=this.c}return a};function Jc(){this.id=this.url=null;this.type="static";this.c=this.j=this.s=null;this.h=5;this.f=this.b=this.g=null;this.i=1;this.a=[]}function Kc(){this.g=this.f=this.c=this.s=this.a=this.start=this.id=null;this.b=[]}function Lc(){this.i=this.b=this.height=this.width=this.contentType=this.lang=this.group=this.id=null;this.c=!1;this.h=this.g=this.f=this.s=null;this.j=[];this.a=[]}function Mc(){this.value=null}function Nc(){this.contentType=this.lang=this.id=null}
function Oc(){this.a=this.b=this.g=this.s=this.h=this.f=this.height=this.width=this.bandwidth=this.lang=this.id=null;this.c=[]}function Pc(){this.value=this.schemeIdUri=this.b=null;this.children=[];this.a=this.pssh=null}function Qc(){this.parsedPssh=this.psshBox=null}function Rc(){this.url=null}function Sc(){this.url=null}function Tc(){this.s=null;this.g=1;this.c=this.b=this.a=this.f=null}
Tc.prototype.clone=function(){var a=new Tc;a.s=Uc(this.s);a.g=this.g;a.f=this.f;a.a=J(this.a);a.b=J(this.b);a.c=J(this.c);return a};function Vc(){this.a=this.url=null}Vc.prototype.clone=function(){var a=new Vc;a.url=Uc(this.url);a.a=J(this.a);return a};function Wc(){this.a=this.url=null}Wc.prototype.clone=function(){var a=new Wc;a.url=Uc(this.url);a.a=J(this.a);return a};function Xc(){this.s=null;this.f=1;this.b=this.g=null;this.i=1;this.h=null;this.a=[];this.c=null}
Xc.prototype.clone=function(){var a=new Xc;a.s=Uc(this.s);a.f=this.f;a.g=this.g;a.b=this.b;a.i=this.i;a.h=J(this.h);a.a=Uc(this.a)||[];a.c=J(this.c);return a};function Yc(){this.a=this.b=null}Yc.prototype.clone=function(){var a=new Yc;a.b=Uc(this.b);a.a=J(this.a);return a};function Zc(){this.b=1;this.a=this.i=null;this.j=1;this.c=this.g=this.f=this.h=null}Zc.prototype.clone=function(){var a=new Zc;a.b=this.b;a.i=this.i;a.a=this.a;a.j=this.j;a.h=this.h;a.f=this.f;a.g=this.g;a.c=J(this.c);return a};
function $c(){this.a=[]}$c.prototype.clone=function(){var a=new $c;a.a=Uc(this.a)||[];return a};function ad(){this.c=this.a=this.b=null}ad.prototype.clone=function(){var a=new ad;a.b=this.b;a.a=this.a;a.c=this.c;return a};function bd(a,b){this.na=a;this.end=b}bd.prototype.clone=function(){return new bd(this.na,this.end)};Jc.TAG_NAME="MPD";Kc.TAG_NAME="Period";Lc.TAG_NAME="AdaptationSet";Mc.TAG_NAME="Role";Nc.TAG_NAME="ContentComponent";Oc.TAG_NAME="Representation";Pc.TAG_NAME="ContentProtection";
Qc.TAG_NAME="cenc:pssh";Rc.TAG_NAME="BaseURL";Sc.TAG_NAME="Location";Tc.TAG_NAME="SegmentBase";Vc.TAG_NAME="RepresentationIndex";Wc.TAG_NAME="Initialization";Xc.TAG_NAME="SegmentList";Yc.TAG_NAME="SegmentURL";Zc.TAG_NAME="SegmentTemplate";$c.TAG_NAME="SegmentTimeline";ad.TAG_NAME="S";
Jc.prototype.parse=function(a,b){this.url=a.s;this.id=K(b,"id",L);this.type=K(b,"type",L)||"static";this.c=K(b,"mediaPresentationDuration",cd);this.h=K(b,"minBufferTime",cd,this.h);this.g=K(b,"minimumUpdatePeriod",cd,this.g);this.b=K(b,"availabilityStartTime",dd,this.b);this.f=K(b,"timeShiftBufferDepth",cd,this.f);this.i=K(b,"suggestedPresentationDelay",cd,this.i);var c=a.s,d=M(this,b,Rc);this.s=ed(c,d);if(d=N(this,b,Sc))this.j=fd(c,d.url);this.a=M(this,b,Kc)};
Kc.prototype.parse=function(a,b){this.id=K(b,"id",L);this.start=K(b,"start",cd);this.a=K(b,"duration",cd);var c=M(this,b,Rc);this.s=ed(a.s,c);this.c=N(this,b,Tc);this.f=N(this,b,Xc);this.g=N(this,b,Zc);this.b=M(this,b,Lc);gd(this)};function gd(a){for(var b=[],c=0;c<a.b.length;++c){var d=a.b[c];null!=d.group&&(b[d.group]=!0)}for(c=0;c<a.b.length;++c)if(d=a.b[c],null==d.group){for(var e=1;1==b[e];)++e;b[e]=!0;d.group=e}}
Lc.prototype.parse=function(a,b){var c=N(this,b,Nc)||{},d=N(this,b,Mc);this.id=K(b,"id",L);this.group=K(b,"group",O);this.lang=K(b,"lang",L,c.lang);this.contentType=K(b,"contentType",L,c.contentType);this.width=K(b,"width",P);this.height=K(b,"height",P);this.b=K(b,"mimeType",L);this.i=K(b,"codecs",L);this.c=d&&"main"==d.value;this.lang&&(this.lang=Na(this.lang));c=M(this,b,Rc);this.s=ed(a.s,c);this.j=M(this,b,Pc);!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]);this.f=a.c?hd(this,
b,a.c):N(this,b,Tc);this.g=a.f?hd(this,b,a.f):N(this,b,Xc);this.h=a.g?hd(this,b,a.g):N(this,b,Zc);this.a=M(this,b,Oc);!this.b&&this.a.length&&(this.b=this.a[0].f,!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]))};Mc.prototype.parse=function(a,b){this.value=K(b,"value",L)};Nc.prototype.parse=function(a,b){this.id=K(b,"id",L);this.lang=K(b,"lang",L);this.contentType=K(b,"contentType",L);this.lang&&(this.lang=Na(this.lang))};
Oc.prototype.parse=function(a,b){this.id=K(b,"id",L);this.bandwidth=K(b,"bandwidth",P);this.width=K(b,"width",P,a.width);this.height=K(b,"height",P,a.height);this.f=K(b,"mimeType",L,a.b);this.h=K(b,"codecs",L,a.i);this.lang=a.lang;var c=M(this,b,Rc);this.s=ed(a.s,c);this.c=M(this,b,Pc);this.g=a.f?hd(this,b,a.f):N(this,b,Tc);this.b=a.g?hd(this,b,a.g):N(this,b,Xc);this.a=a.h?hd(this,b,a.h):N(this,b,Zc);0==this.c.length&&(this.c=a.j)};
Pc.prototype.parse=function(a,b){this.b=b;this.schemeIdUri=K(b,"schemeIdUri",L);this.value=K(b,"value",L);var c=K(b,"cenc:default_KID",L);c&&(this.a=c.replace(/[-]/g,""));this.pssh=N(this,b,Qc);this.children=Array.prototype.slice.call(b.childNodes)};Qc.prototype.parse=function(a,b){var c=id(b);if(c){this.psshBox=Pb(c);try{this.parsedPssh=new Xb(this.psshBox)}catch(d){if(!(d instanceof RangeError))throw d;}}};Rc.prototype.parse=function(a,b){this.url=id(b)};
Sc.prototype.parse=function(a,b){this.url=id(b)};Tc.prototype.parse=function(a,b){this.s=a.s||this.s;this.g=K(b,"timescale",P,this.g);this.f=K(b,"presentationTimeOffset",O,this.f);this.a=K(b,"indexRange",jd,this.a);this.b=N(this,b,Vc)||this.b;this.c=N(this,b,Wc)||this.c};Vc.prototype.parse=function(a,b){var c=K(b,"sourceURL",L);this.url=fd(a.s,c);this.a=K(b,"range",jd,J(a.a))};Wc.prototype.parse=function(a,b){var c=K(b,"sourceURL",L);this.url=fd(a.s,c);this.a=K(b,"range",jd)};
Xc.prototype.parse=function(a,b){this.s=a.s||this.s;this.f=K(b,"timescale",P,this.f);this.g=K(b,"presentationTimeOffset",O,this.g);this.b=K(b,"duration",P,this.b);this.i=K(b,"startNumber",O,this.i);this.h=N(this,b,Wc)||this.h;var c=M(this,b,Yc);this.a=c&&0<c.length?c:this.a;this.c=N(this,b,$c)||this.c};Yc.prototype.parse=function(a,b){var c=K(b,"media",L);this.b=fd(a.s,c);this.a=K(b,"mediaRange",jd)};
Zc.prototype.parse=function(a,b){this.b=K(b,"timescale",P,this.b);this.i=K(b,"presentationTimeOffset",O,this.i);this.a=K(b,"duration",P,this.a);this.j=K(b,"startNumber",O,this.j);this.h=K(b,"media",L,this.h);this.f=K(b,"index",L,this.f);this.g=K(b,"initialization",L,this.g);this.c=N(this,b,$c)||this.c};$c.prototype.parse=function(a,b){this.a=M(this,b,ad)};ad.prototype.parse=function(a,b){this.b=K(b,"t",O);this.a=K(b,"d",O);this.c=K(b,"r",kd)};
function ed(a,b){if(!b||0===b.length)return a;for(var c=[],d=0;d<b.length;d++){var e=b[d].url;null==a||0===a.length?c.push(new I(e)):(e=fd(a.slice(0,1),e),c.push(e[0]))}return c}function fd(a,b){if(!b)return a;var c=new I(b);return a?a.map(function(a){return a.resolve(c)}):[c]}function hd(a,b,c){var d=J(c);(b=ld(b,c.constructor.TAG_NAME))&&d.parse(a,b);return d}function N(a,b,c){var d=null;if(b=ld(b,c.TAG_NAME))d=new c,d.parse(a,b);return d}
function ld(a,b){for(var c=null,d=0;d<a.childNodes.length;d++)if(a.childNodes[d].tagName==b){if(c)return null;c=a.childNodes[d]}return c}function M(a,b,c){for(var d=[],e=0;e<b.childNodes.length;e++)if(b.childNodes[e].tagName==c.TAG_NAME){var f=new c;f.parse.call(f,a,b.childNodes[e]);d.push(f)}return d}function id(a){a=a.firstChild;return a.nodeType!=Node.TEXT_NODE?null:a.nodeValue}function Uc(a){return a?a.map(function(a){return a.clone()}):null}function J(a){return a?a.clone():null}
function K(a,b,c,d){a=c(a.getAttribute(b));return null!=a?a:void 0!==d?d:null}function dd(a){if(!a)return null;a=Date.parse(a);return isNaN(a)?null:Math.floor(a/1E3)}
function cd(a){if(!a)return null;var b=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(a);if(!b)return null;a=0;var c=O(b[1]);c&&(a+=31536E3*c);(c=O(b[2]))&&(a+=2592E3*c);(c=O(b[3]))&&(a+=86400*c);(c=O(b[4]))&&(a+=3600*c);(c=O(b[5]))&&(a+=60*c);b=window.parseFloat(b[6]);(b=isNaN(b)?null:b)&&(a+=b);return a}
function jd(a){var b=/([0-9]+)-([0-9]+)/.exec(a);if(!b)return null;a=O(b[1]);if(null==a)return null;b=O(b[2]);return null==b?null:new bd(a,b)}function kd(a){a=window.parseInt(a,10);return isNaN(a)?null:a}function P(a){a=window.parseInt(a,10);return 0<a?a:null}function O(a){a=window.parseInt(a,10);return 0<=a?a:null}function L(a){return a};function md(a,b){this.url=a;this.b=b||new pb;this.g=this.i=this.h=0;this.a=null;this.c=new C;this.f=null}function pb(){this.body=null;this.a=1;this.g=1E3;this.c=0;this.method="GET";this.f="arraybuffer";this.b={};this.i=this.h=!1}function nd(a){od(a);a.b.body=null;a.c.destroy();a.c=null;a.f=null}function od(a){a.a&&(a.a.onload=null,a.a.onreadystatechange=null,a.a.onerror=null,a.a.ontimeout=null);a.a=null}l=md.prototype;
l.ab=function(){if(this.a)return this.c;if(0==this.url.lastIndexOf("data:",0)){var a=this.url.split(":")[1].split(";").pop().split(","),b=a.pop(),b="base64"==a.pop()?window.atob(b.replace(/-/g,"+").replace(/_/g,"/")):window.decodeURIComponent(b);"arraybuffer"==this.b.f&&(b=Nb(b).buffer);a=JSON.parse(JSON.stringify(new XMLHttpRequest));a.response=b;a.responseText=b.toString();b=this.c;b.resolve(a);nd(this);return b}if(0==this.url.lastIndexOf("idb:",0))return pd(this);this.h++;this.i=Date.now();this.g||
(this.g=this.b.g);this.a=new XMLHttpRequest;a=this.url;this.f&&!this.f.supportsCaching()&&(a=new I(a),Ic(a.a,"_",Date.now()),a=a.toString());this.a.open(this.b.method,a,!0);this.a.responseType=this.b.f;this.a.timeout=this.b.c;this.a.withCredentials=this.b.h;this.a.onload=this.lb.bind(this);this.b.i&&(this.a.onreadystatechange=this.pb.bind(this));this.a.onerror=this.Hb.bind(this);this.a.ontimeout=this.ub.bind(this);for(b in this.b.b)this.a.setRequestHeader(b,this.b.b[b]);this.a.send(this.b.body);return this.c};
function pd(a){var b=a.url.split("/"),c=parseInt(b[2],10),d=parseInt(b[3],10),e=new Fb;return xb(e).then(function(){return Jb(e,c,d)}).then(D(a,function(a){var b=JSON.parse(JSON.stringify(new XMLHttpRequest));b.response=a;a=this.c;a.resolve(b);H(e);nd(this);return a})).catch(D(a,function(a){H(e);nd(this);return Promise.reject(a)}))}function qd(a,b,c){b=Error(b);b.type=c;b.status=a.a.status;b.url=a.url;b.method=a.b.method;b.body=a.b.body;b.Lb=a.a;return b}
l.lb=function(a){this.f&&this.f.sample(Date.now()-this.i,a.loaded);200<=this.a.status&&299>=this.a.status?(this.c.resolve(this.a),nd(this)):this.h<this.b.a?rd(this):(a=qd(this,"HTTP error.","net"),this.c.reject(a),nd(this))};l.pb=function(){if(this.a.readyState==XMLHttpRequest.HEADERS_RECEIVED){var a=Date.parse(this.a.getResponseHeader("Date"));a&&(Za=a-Date.now())}};l.Hb=function(){var a=qd(this,"Network failure.","net");this.c.reject(a);nd(this)};
l.ub=function(){if(this.h<this.b.a)rd(this);else{var a=qd(this,"Request timed out.","net");this.c.reject(a);nd(this)}};function rd(a){od(a);window.setTimeout(a.ab.bind(a),a.g*(1+.5*(2*Math.random()-1)));a.g*=2};function G(a,b,c,d){this.c=b;this.f=c||0;this.h=null!=d?d:null;this.b=this.a=null;this.i=a}function sd(a,b){return a&&0!==a.length?a.map(function(a){return a.resolve(b)}):[b]}function qb(a,b,c){if(a.a)return a.a;b=b||new pb;if(a.f||a.h)b.b.Range="bytes="+(a.f+"-"+(null!=a.h?a.h:""));a.a=td(a,0,b,c);return a.a}G.prototype.g=function(){if(this.b){this.a=null;var a=this.b;if(a.a&&a.a.readyState!=XMLHttpRequest.DONE){a.a.abort();var b=qd(a,"Request aborted.","aborted");a.c.reject(b);nd(a)}this.b=null}};
function td(a,b,c,d){var e=a.c[b].toString();a.i&&(e=a.i(e,c.b)||e);a.b=new md(e,c);d&&(a.b.f=d);e=a.b.ab().then(D(a,function(a){this.b=null;return Promise.resolve(a.response)}));return e=e.catch(D(a,function(a){if(this.a&&b+1<this.c.length)return this.a=td(this,b+1,c,d);this.a=this.b=null;return Promise.reject(a)}))}G.prototype.clone=function(){return new G(this.i,this.c.map(function(a){return a.clone()}),this.f,this.h)};G.prototype.toString=function(){return this.c[0].toString()};function ud(a,b,c,d){for(var e=b.a,f=[],g=0;g<d;++g){var h=g+c,k=(h-1)*e.a,m=k/e.b,k=(k+e.a)/e.b,h=vd(a,b,h-1+e.j,(h-1)*e.a);if(!h)return null;f.push(new Q(m,k,h))}return f}function vd(a,b,c,d){if(!b.a)return null;var e=b.a.h;if(!e)return b.s?new G(a,b.s,0,null):null;c=wd(e,b.id,c,b.bandwidth,d);if(!c)return null;b=sd(b.s,c);return new G(a,b,0,null)}
function wd(a,b,c,d,e){var f={RepresentationID:b,Number:c,Bandwidth:d,Time:e};a=a.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)d)?\$/g,function(a,b,c){if("$$"==a)return"$";var d=f[b];if(null==d)return a;"RepresentationID"==b&&c&&(c=void 0);a=d.toString();c=window.parseInt(c,10)||1;c=Math.max(0,c-a.length);return Array(c+1).join("0")+a});try{return new I(a)}catch(g){if(g instanceof URIError)return null;throw g;}}
function xd(a,b,c){var d=0;b*=c;a=a.a;c=[];for(var e=0;e<a.length&&a[e].a;++e){var f=a[e].b,f=null!=f?f:d,g=a[e].c||0;0>g&&(g=a[e].a,g=e+1===a.length?Math.ceil((a[0].b+b-f)/g)-1:Math.ceil((a[e+1].b-f)/g)-1);0<c.length&&f!=d&&(c[c.length-1].end=f);for(var h=0;h<=g;++h)d=f+a[e].a,c.push({start:f,end:d}),f=d}return c};function yd(a,b){this.a=new pb;this.a.f="text";this.a.a=3;this.a.c=1E3*(null!=b?b:0);this.a.i=!0;this.b=a}function zd(a){var b=a.b;return qb(b,a.a).then(function(a){var d;d=b.c;d=(a=(new DOMParser).parseFromString(a,"text/xml"))?N({s:d},a,Jc):null;if(d)return Promise.resolve(d);d=Error("MPD parse failure.");d.type="mpd";return Promise.reject(d)})};function Q(a,b,c){this.b=a;this.a=b;this.url=c}function rb(a,b){for(var c=a.length-1;0<=c;--c){var d=a[c];if(b>=d.b&&(null==d.a||b<d.a))return c}return-1}function Ad(a,b){return a.map(function(a){return new Q(a.b+b,null!=a.a?a.a+b:null,a.url)})};function Bd(){}
Bd.prototype.parse=function(a,b,c,d){var e=null;try{a:{var f=[],g=new wa(a),h=z(g);if(1936286840!=z(g))e=null;else{1==h&&(h=Aa(g));var k=za(g);A(g,3);A(g,4);var m=z(g);if(0==m)e=null;else{var p,t;0==k?(p=z(g),t=z(g)):(p=Aa(g),t=Aa(g));A(g,2);var y=g.b.getUint16(g.a,g.c);g.a+=2;a=p;b=b+h+t;for(h=0;h<y;h++){var u=z(g);t=(u&2147483648)>>>31;var k=u&2147483647,v=z(g);z(g);if(1==t){e=null;break a}var ta=new G(d,c,b,b+k-1);f.push(new Q(a/m,(a+v)/m,ta));a+=v;b+=k}e=f}}}}catch(Eb){if(!(Eb instanceof RangeError))throw Eb;
}return e};function R(a){this.v=a;this.g=0}R.prototype.destroy=function(){this.v=null};l=R.prototype;l.length=function(){return this.v.length};function S(a){if(0==a.v.length)throw new RangeError("SegmentIndex: There is no first SegmentReference.");return a.v[0]}function T(a){if(0==a.v.length)throw new RangeError("SegmentIndex: There is no last SegmentReference.");return a.v[a.v.length-1]}l.get=function(a){if(0>a||a>=this.v.length)throw new RangeError("SegmentIndex: The specified index is out of range.");return this.v[a]};
l.ia=function(a){a=rb(this.v,a);return 0<=a?this.v[a]:null};l.Ba=function(a){Cd(this,a);return!0};
function Cd(a,b){a.g!=b.g&&(b=new R(Ad(b.v,a.g-b.g)));if(0==a.length())a.v=b.v.slice(0);else if(0!=b.length()&&null!=T(a).a&&!(null!=T(b).a&&T(b).a<T(a).a)){if(T(a).a<=S(b).b){var c,d=T(a);c=T(a).b;var e=S(b).b;c=new Q(c,e,d.url);d=a.v.slice(0,-1).concat([c])}else{for(d=0;d<a.v.length&&!(a.v[d].a>=S(b).b);++d);a.v[d].b<S(b).b?(c=S(b).b,c=new Q(a.v[d].b,c,a.v[d].url),d=a.v.slice(0,d).concat([c])):(S(a).b>S(b).b||S(b),d=a.v.slice(0,d))}a.v=d.concat(b.v)}}
l.ha=function(a){var b=a-this.g;if(0==b)return 0;this.v=Ad(this.v,b);this.g=a;return b};l.Aa=function(){return 0<this.length()?{start:S(this).b,end:T(this).a}:{start:0,end:0}};function U(a,b,c,d){R.call(this,a);this.f=b;this.u=c;this.l=d;this.c=this.j=this.a=null;Dd(this)}q(U,R);U.prototype.destroy=function(){this.u=this.f=null;R.prototype.destroy.call(this)};U.prototype.ia=function(a){Ed(this,Ya()/1E3);return R.prototype.ia.call(this,a)};U.prototype.Ba=function(a){Cd(this,a);null==this.a&&Dd(this);return!0};
function Dd(a){if(0!=a.length()){a.length();var b=null!=T(a).a?T(a).a:T(a).b;if(a.f.b>a.l)a.a=b;else{var c=a.l-(a.f.b+a.u.start);0>c?a.a=b:c<Math.max(T(a).b,T(a).a||0)?(T(a),a.a=b):a.a=c}a.j=T(a).b;a.c=S(a).b}}U.prototype.ha=function(a){a=R.prototype.ha.call(this,a);null!=this.a&&(this.j+=a,this.c+=a,this.j>this.a&&(this.a+=a));return a};U.prototype.Aa=function(){return Fd(this,Ya()/1E3)};
function Fd(a,b){Ed(a,b);if(null==a.a||null==a.j||null==a.c)return{start:0,end:0};var c=b-a.l,d=a.a+c;null!=a.f.f&&(d=d-a.c-a.f.f,0<d&&(a.c+=d));c=a.j+c;c=0<a.length()?null!=T(a).a?Math.min(c,T(a).a):c:a.c;c=Math.max(c,a.c);return{start:a.c,end:c}}function Ed(a,b){if(null!=a.f.f)if(null==a.a)a.length();else{for(var c=a.a+(b-a.l),d=0,e=0;e<a.v.length;++e){var f=null;e<a.v.length-1?f=a.v[e+1].a:(f=a.v[e],f=null!=f.a?f.a+(f.a-f.b):null);if(null!=f&&f<c-a.f.f)++d;else break}0<d&&a.v.splice(0,d)}};function Gd(a,b,c,d,e){var f=1,g=0,h;if(a.b>d)h=null;else{var k=a.i||0,m=a.f||0;h=c.a;h=h.a/h.b;var p=d-(a.b+b.start);0>p?h=null:(m=p-2*h-m,0>m&&(m=0),m=Math.ceil(m/h)*h,p-=h,0>p?h=null:(k=Math.floor(p/h)*h-k,0>k&&(k=0),k=Math.floor(k/h)*h,h={Ma:m/h+1,current:(k>=m?k:m)/h+1}))}h&&(f=h.Ma,g=h.current-h.Ma+1);f=ud(e,c,f,g);if(null==f)throw a=Error("Failed to generate SegmentReferences."),a.type="stream",a;U.call(this,f,a,b,d);this.o=c;this.i=this.b=0<this.length()?a.b+b.start+T(this).a:null;this.h=
h?h.current+1:null;this.w=e}q(Gd,U);Gd.prototype.destroy=function(){this.w=this.o=null;U.prototype.destroy.call(this)};Gd.prototype.ia=function(a){var b=Ya()/1E3;Hd(this,b);Ed(this,b);return R.prototype.ia.call(this,a)};Gd.prototype.Ba=function(a){if(null!=this.b||!(a instanceof Gd)||null==a.b)return!1;this.b=a.b;this.i=a.i;this.h=a.h;Cd(this,a);Hd(this,Ya()/1E3);Dd(this);return!0};Gd.prototype.ha=function(a){a=U.prototype.ha.call(this,a);null!=this.b&&(this.b+=a,this.i+=a);return a};
Gd.prototype.Aa=function(){var a=Ya()/1E3;Hd(this,a);return Fd(this,a)};function Hd(a,b){if(null!=a.b&&null!=a.i&&null!=a.h){var c=a.o.a,c=c.a/c.b,d=Math.floor((a.i+(b-a.l)-a.b)/c);if(0!=d){var e=ud(a.w,a.o,a.h,d);Array.prototype.push.apply(a.v,Ad(e,a.g));a.b+=d*c;a.h+=d}}};function Id(){}
Id.prototype.parse=function(a,b,c,d){var e=null;try{var f;var g=new $a(b);if(440786851!=bb(g).id)f=null;else{var h=bb(g);if(408125543!=h.id)f=null;else{var k=h.a.byteOffset,m;var p=new $a(h.a);for(b=null;ya(p.a);){var t=bb(p);if(357149030==t.id){b=t;break}}if(b){for(var y=new $a(b.a),p=1E6;ya(y.a);){var u=bb(y);if(2807729==u.id){p=fb(u);break}}m=p/1E9}else m=null;f=m?{Db:k,Ib:m}:null}}if(f){var v=bb(new $a(a));if(475249515!=v.id)e=null;else{var ta=f.Db,Eb=f.Ib;a=[];var Md=new $a(v.a);for(f=v=-1;ya(Md.a);){var Nd=
bb(Md);if(187==Nd.id){var Ga;var Od=new $a(Nd.a),Pd=bb(Od);if(179!=Pd.id)Ga=null;else{var Xe=fb(Pd),Qd=bb(Od);if(183!=Qd.id)Ga=null;else{for(var Rd=new $a(Qd.a),k=0;ya(Rd.a);){var Sd=bb(Rd);if(241==Sd.id){k=fb(Sd);break}}Ga={Kb:Xe,Cb:k}}}if(Ga){var Td=Eb*Ga.Kb,Ud=ta+Ga.Cb;if(0<=v){var xc=new G(d,c,f,Ud-1);a.push(new Q(v,Td,xc))}v=Td;f=Ud}}}0<=v&&(xc=new G(d,c,f,null),a.push(new Q(v,null,xc)));e=a}}else e=null}catch(Vd){if(!(Vd instanceof RangeError))throw Vd;}return e};function Jd(a,b,c,d,e){this.c=a;this.g=b;this.b=c;this.h=d;this.a=null;this.f=e}Jd.prototype.destroy=function(){this.f=this.b=this.g=this.c=null;this.a&&(this.a.destroy(),this.a=null)};
Jd.prototype.create=function(){if(this.a)return Promise.resolve(this.a);if("dynamic"==this.c.type)try{this.a=new Gd(this.c,this.g,this.b,this.h,this.f)}catch(a){return Promise.reject(a)}else{var b=this.b.a,b=ud(this.f,this.b,1,Math.ceil(this.g.a/(b.a/b.b)));if(!b)return b=Error("Failed to generate SegmentReferences"),b.type="stream",Promise.reject(b);this.a=new R(b)}return Promise.resolve(this.a)};function Kd(a,b,c,d,e){this.c=a;this.b=b;this.g=c;this.a=null;this.h=d;this.f=e}Kd.prototype.destroy=function(){this.f=this.g=this.b=this.c=null;this.a&&(this.a.destroy(),this.a=null)};
Kd.prototype.create=function(){if(this.a)return Promise.resolve(this.a);var a=this.g.b,b=[];a.c&&(b=xd(a.c,a.f||1,this.b.a||0));var c=0;a.b&&a.i?c=a.b*a.i:0<b.length&&(c=b[0].start-(a.g||0));var d=a.a.length;0<b.length&&b.length!=a.a.length&&(d=Math.min(b.length,a.a.length));for(var e=[],f=0;f<d;++f){var g=a.a[f],h=c/a.f,k=null,m=null;a.b?(k=c+a.b,m=k/a.f):0<b.length?(k=b[f].end-(a.g||0),m=k/a.f):(m=h+this.b.a,k=m*a.f);var c=k,k=0,p=null;g.a&&(k=g.a.na,p=g.a.end);e.push(new Q(h,m,new G(this.f,g.b,
k,p)))}"dynamic"==this.c.type?this.a=new U(e,this.c,this.b,this.h):this.a=new R(e);return Promise.resolve(this.a)};function Ld(a,b,c,d,e){this.b=a;this.c=b;this.f=c;this.h=d;this.a=null;this.g=e}Ld.prototype.destroy=function(){this.g=this.f=this.c=this.b=null;this.a&&(this.a.destroy(),this.a=null)};
Ld.prototype.create=function(){if(this.a)return Promise.resolve(this.a);for(var a=this.f.a,b=xd(a.c,a.b||1,this.c.a||0),c=[],d=0;d<b.length;++d){var e=b[d].start,f=e/a.b,g=b[d].end/a.b,e=vd(this.g,this.f,d+a.j,e);if(!e)return a=Error("Failed to generate media URL."),a.type="dash",Promise.reject(a);var h=(a.i||0)/a.b;c.push(new Q(f-h,g-h,e))}"dynamic"==this.b.type?this.a=new U(c,this.b,this.c,this.h):this.a=new R(c);return Promise.resolve(this.a)};function Wd(a,b,c,d,e,f,g){this.g=a;this.j=b;this.f=c;this.a=d;this.c=e;this.l=f;this.i=this.b=null;this.h=g}Wd.prototype.destroy=function(){this.h=this.j=this.g=null;this.a.g();this.a=null;this.c&&(this.c.g(),this.c=null);this.i&&(this.i.destroy(),this.i=null);this.b=null};
Wd.prototype.create=function(){if(this.b)return this.b;var a=[qb(this.a)];"webm"==this.f&&a.push(qb(this.c));return this.b=Promise.all(a).then(D(this,function(a){var c=a[0];a=a[1]||null;var d=null;"mp4"==this.f?(d=new Bd,d=d.parse(new DataView(c),this.a.f,this.a.c,this.h)):"webm"==this.f&&(d=new Id,d=d.parse(new DataView(c),new DataView(a),this.a.c,this.h));if(!d)return c=Error("Failed to parse SegmentReferences from "+this.a.toString()+" (or one of its fallbacks)."),c.type="stream",Promise.reject(c);
var e;"dynamic"==this.g.type?e=new U(d,this.g,this.j,this.l):e=new R(d);return Promise.resolve(e)}))};function Xd(a){this.b=a;this.a=null}Xd.prototype.destroy=function(){this.b=null;this.a&&(this.a.destroy(),this.a=null)};Xd.prototype.create=function(){if(this.a)return Promise.resolve(this.a);for(var a=[],b=0;b<this.b.length;++b){var c=this.b[b];a.push(new Q(c.start_time,c.end_time,new G(null,[new I(c.url)],c.start_byte,null)))}this.b=null;this.a=new R(a);return Promise.resolve(this.a)};function Yd(a){this.b=a;this.a=null}Yd.prototype.destroy=function(){this.a&&(this.a.destroy(),this.a=null)};Yd.prototype.create=function(){if(this.a)return Promise.resolve(this.a);var a=new Q(0,null,this.b);this.a=new R([a]);return Promise.resolve(this.a)};function Zd(a){this.a=a}Zd.prototype.destroy=function(){this.a&&(this.a.g(),this.a=null)};Zd.prototype.create=function(){return this.a?qb(this.a):Promise.resolve(null)};function $d(){this.B=ae++;this.id=this.C=this.F=null;this.c=0;this.height=this.width=this.bandwidth=null;this.b=this.a="";this.f=[];this.L=!1;this.J=!0}var ae=0;$d.prototype.destroy=function(){this.F&&(this.F.destroy(),this.F=null);this.C&&(this.C.destroy(),this.C=null)};function be(a){var b=a.a||"";a.b&&(b+='; codecs="'+a.b+'"');return b}function ce(){this.B=de++;this.id=null;this.contentType=this.lang="";this.b=!1;this.m=[];this.a=[]}var de=0;
ce.prototype.destroy=function(){for(var a=0;a<this.m.length;++a)this.m[a].destroy();this.a=this.m=null};function ee(a){for(var b=[],c=0;c<a.a.length;++c){var d=new fe;d.id=a.B;d.a=a.a[c];d.contentType=a.contentType;d.b=a.m.length?be(a.m[0]):"";b.push(d)}return b}function ge(){this.id=null;this.start=0;this.b=null;this.a=[]}ge.prototype.destroy=function(){for(var a=0;a<this.a.length;++a)this.a[a].destroy();this.a=null};function he(){this.b=!1;this.g=this.f=null;this.c=0;this.a=[]}
he.prototype.destroy=function(){for(var a=0;a<this.a.length;++a)this.a[a].destroy();this.a=null};function fe(){this.id=0;this.a=null;this.b=this.contentType=""};function ie(a){this.a=a}
function je(a,b,c){for(var d=Ya()/1E3,e=0;e<b.a.length;++e)for(var f=b.a[e],g=0;g<f.b.length;++g){var h=f.b[g];if("text"!=h.contentType)for(var k=0;k<h.a.length;++k){var m=h.a[k],p=0,p=p+(m.g?1:0),p=p+(m.b?1:0),p=p+(m.a?1:0);0==p?(h.a.splice(k,1),--k):1!=p&&(m.g?(m.b=null,m.a=null):m.b&&(m.a=null))}}ke(b);for(e=0;e<b.a.length;++e)for(f=b.a[e],g=0;g<f.b.length;++g){k=h=f.b[g];m=null;for(p=0;p<k.a.length;++p){var t=k.a[p].f||"";m?t!=m&&(k.a.splice(p,1),--p):m=t}0==h.a.length&&(f.b.splice(g,1),--g)}"dynamic"==
b.type&&null==b.b&&(b.b=d);e=new he;"dynamic"==b.type&&(e.b=!0,e.f=b.g,e.g=new G(c,b.j||b.url));e.c=b.h||5;for(f=0;f<b.a.length;++f){g=b.a[f];if(null==g.start)break;g=le(a,b,g,d,c);e.a.push(g)}return e}
function ke(a){if(a.a.length){null==a.a[0].start&&(a.a[0].start=0);var b=function(a){return 0==a||!!a};"dynamic"==a.type&&(a.c=null);b(a.c)&&1==a.a.length&&!b(a.a[0].a)&&(a.a[0].a=a.c);for(var c=0,d=!0,e=0;e<a.a.length;++e){var f=a.a[e-1],g=a.a[e],h=a.a[e+1]||{start:a.c};!b(g.start)&&f&&b(f.start)&&b(f.a)&&(g.start=f.start+f.a);!b(g.a)&&b(h.start)&&(g.a=h.start-g.start);null!=g.start&&null!=g.a?c+=g.a:d=!1}b(a.c)||(e=a.a[a.a.length-1],d?a.c=c:b(e.start)&&b(e.a)?a.c=e.start+e.a:"dynamic"!=a.type&&
(a.c=c))}}function le(a,b,c,d,e){var f=new ge;f.id=c.id;f.start=c.start;f.b=c.a;var g=new B;c.b.forEach(function(a){g.push(a.contentType||"",a)});for(var h=Ka(g),k=0;k<h.length;++k){var m=new B;g.get(h[k]).forEach(function(a){m.push(a.group,a)});for(var p=Ka(m),t=0;t<p.length;++t){var y=new B;m.get(p[t]).forEach(function(a){y.push(a.lang,a)});for(var u=Ka(y),v=0;v<u.length;++v){var ta=y.get(u[v]),ta=me(a,b,c,ta,d,e);f.a.push(ta)}}}return f}
function me(a,b,c,d,e,f){ia(d.every(function(a){return a.group==d[0].group&&(a.lang||"")==(d[0].lang||"")&&(a.contentType||"")==(d[0].contentType||"")}));var g=new ce,h=d.filter(function(a){return null!=a.id});h.length==d.length&&(g.id=h.map(function(a){return a.id}).sort().reduce(function(a,b){return a+","+b}));g.lang=d[0].lang||"";g.contentType=d[0].contentType||"";g.b=d.some(function(a){return a.c});for(var h={},k=0;k<d.length;++k)for(var m=d[k],p=0;p<m.a.length;++p){var t=m.a[p],y=ne(a,t),u=g.a.slice(0);
oe(y,u);0==u.length&&0<g.a.length||!(t=pe(b,c,t,e,f))||(g.m.push(t),g.a=u,h[t.B]=m)}if(g.a.some(function(a){return""==a.a}))return g.m.forEach(function(a){a.L=!0}),g;a=qe(d);for(k=0;k<g.m.length;++k)t=g.m[k],m=h[t.B],m==a&&(t.L=!0);return g}function qe(a){for(var b=null,c=null,d=0;d<a.length;++d)for(var e=a[d],f=0;f<e.a.length;++f){var g=e.a[f],g=(g.width||1)*(g.height||1)*(g.bandwidth||1);if(null==b||g<b)b=g,c=e}return c}
function oe(a,b){if(0==b.length)Array.prototype.push.apply(b,a);else for(var c=0;c<b.length;++c){for(var d=!1,e=0;e<a.length;++e){var f=b[c],g=a[e];if(f.a==g.a&&f.j==g.j&&f.u==g.u&&f.f==g.f&&f.g==g.g&&f.i==g.i&&f.l==g.l&&f.h==g.h&&f.o==g.o&&db(f.c,g.c)){d=!0;break}}d||(b.splice(c,1),--c)}}function ne(a,b){var c=[];if(0==b.c.length)c.push(new Rb);else if(a.a)for(var d=0;d<b.c.length;++d)c.push.apply(c,re(a,b.c[d]));return c}
function re(a,b){var c=[];if(2==a.a.length){var d=a.a(b.schemeIdUri,b.b);if(!(d&&d instanceof Array))return[];for(var e=0;e<d.length;++e){var f=Sb(d[e]);0==f.b.length&&b.pssh&&b.pssh.psshBox&&Tb(f,[{initData:b.pssh.psshBox,initDataType:"cenc"}]);c.push(f)}}else{d=a.a(b);if(!(d&&d instanceof Ub))return[];e=new Rb;e.a=d.g;e.j=d.j;e.u=d.u;e.f=d.h;e.g=d.i;e.i=d.f;e.l=d.l;e.h=d.c;e.o=d.o;e.c=d.b?new Uint8Array(d.b.buffer):null;Tb(e,d.a);c.push(e)}return c}
function pe(a,b,c,d,e){if(!c.s||0===c.s.length)return null;var f=null,g=1,h=0;if(c.g)f=c.f.split("/")[1],"mp4"!=f&&"webm"!=f?f=null:(g=c.g,"webm"!=f||g.c?g.a||g.b&&g.b.a?(h=g.b,h||(h=new Vc,h.url=c.s,h.a=g.a?g.a.clone():null),h=se(h,e),g=g.c?se(g.c,e):null,a=new Wd(a,b,f,h,g,d,e),b=new Zd(g),d=new $d,d.F=a,d.C=b,f=d):f=null:f=null),g=c.g.g,h=c.g.f;else if(c.b)f=c.b,!f.b&&!f.c&&1<f.a.length?f=null:f.b||b.a||f.c||1!=f.a.length?f.c&&0===f.c.a.length?f=null:(f=f.h?se(f.h,e):null,a=new Kd(a,b,c,d,e),b=
new Zd(f),d=new $d,d.F=a,d.C=b,f=d):f=null,g=c.b.f,h=c.b.g;else if(c.a){a:if(f=c.a,g=0+(f.f?1:0),g+=f.c?1:0,g+=f.a?1:0,0==g?g=!1:(1!=g&&(f.f?(f.c=null,f.a=null):f.c&&(f.a=null)),g=!0),g){g=null;if(f.g&&(g=(f=c.a.g)?te(c,f,Wc):null,!g)){f=null;break a}f=g?se(g,e):null;g=c.a;g.f?(g=c.f.split("/")[1],"mp4"!=g&&"webm"!=g?a=null:"webm"!=g||f?vd(e,c,1,0)?(h=(h=c.a.f)?te(c,h,Vc):null)?(h=se(h,e),a=new Wd(a,b,g,h,f,d,e)):a=null:a=null:a=null):a=g.h?g.c?new Ld(a,b,c,d,e):g.a?"dynamic"!=a.type&&null==b.a?null:
new Jd(a,b,c,d,e):null:null;a?(b=new Zd(f),d=new $d,d.F=a,d.C=b,f=d):f=null}else f=null;g=c.a.b;h=c.a.i}else"text"==c.f.split("/")[0]&&(f=new $d,f.F=new Yd(new G(e,c.s)));if(!f)return null;f.id=c.id;h&&(f.c=-1*h/g);f.bandwidth=c.bandwidth;f.width=c.width;f.height=c.height;f.a=c.f||"";f.b=c.h||"";for(a=0;a<c.c.length;++a)b=c.c[a],b.a&&f.f.push(b.a);return f}function te(a,b,c){b=wd(b,a.id,null,a.bandwidth,null);if(!b)return null;c=new c;c.url=sd(a.s,b);return c}
function se(a,b){var c=a.url,d=0,e=null;a.a&&(d=a.a.na,e=a.a.end);return new G(b,c,d,e)};function ue(a,b){E.call(this,a);this.b=b;this.h=!0;this.g=this.f=null;this.c=new C;this.a=null}q(ue,E);ue.prototype.H=function(){};ue.prototype.destroy=function(){this.a&&this.b.removeChild(this.a);this.c.destroy();this.i=this.b=this.f=this.g=this.a=this.c=null};l=ue.prototype;l.oa=function(){return this.f};l.Oa=function(){return this.g};l.bb=function(){return this.c};l.Pa=function(){return!0};
l.ra=function(a){a.F.create().then(D(this,function(b){if(this.b){if(0==b.length())return Promise.reject(Error("No subtitles URL available."));var c=this.f;this.f=a;this.g=b;b=S(b).url.c[0].toString();var d=this.za();this.a&&(this.wa(!1),this.b.removeChild(this.a));this.a=document.createElement("track");this.b.appendChild(this.a);this.a.src=b;this.wa(d);b=w({type:"adaptation",bubbles:!0,contentType:"text",size:null,bandwidth:a.bandwidth});this.dispatchEvent(b);c||this.c.resolve(0)}}))};l.Ua=function(){};
l.wa=function(a){this.h=a;this.a&&(this.a.track.mode=a?"showing":"disabled")};l.za=function(){return this.h};l.Ea=function(){return 0};function ve(a,b,c,d,e){E.call(this,a);this.c=b;this.a=new jb(c,d,e);this.A=this.D=this.b=null;this.I=!1;this.g=null;this.o=!1;this.j=null;this.u=!1;this.h=new C;this.l=this.f=!1;this.K=0;this.w=15;this.G=!1}q(ve,E);ve.prototype.H=function(a){null!=a.initialStreamBufferSize&&(this.K=Number(a.initialStreamBufferSize));null!=a.streamBufferSize&&(this.w=Number(a.streamBufferSize));null!=a.segmentRequestTimeout&&(this.a.o=Number(a.segmentRequestTimeout))};
ve.prototype.destroy=function(){we(this);this.h.destroy();this.b=this.h=null;this.a.destroy();this.i=this.c=this.a=null};l=ve.prototype;l.oa=function(){return this.b};l.Oa=function(){return this.D};l.bb=function(a){this.f||a.then(function(){this.f=!0;this.g||xe(this,0)}.bind(this)).catch(function(){});return this.h};l.Pa=function(){return this.l};
l.ra=function(a,b,c){if(a!=this.b){var d=[a.F.create(),a.C.create()];Promise.all(d).then(D(this,function(d){if(this.c){var f=this.b;this.b=a;this.D=d[0];this.A=d[1];this.I=!0;this.o||(f?b&&ye(this,!0,c):xe(this,0))}})).catch(D(this,function(a){"aborted"!=a.type&&(this.f?(a=x(a),this.dispatchEvent(a)):this.h.reject(a))}))}};l.Ua=function(){return ye(this,!1)};
function ye(a,b,c){a.b&&!a.o&&(a.o=!0,we(a),lb(a.a).then(D(a,function(){var a=this.c.currentTime;if(!b&&0<mb(this.a,a)&&0<=rb(this.a.b,a))return Promise.resolve();if(c)return ub(this.a,this.c.currentTime+c);this.G=!0;return tb(this.a)})).then(D(a,function(){this.o=!1;xe(this,0)})).catch(D(a,function(a){this.o=!1;this.f?(a=x(a),this.dispatchEvent(a)):this.h.reject(a)})))}l.wa=function(){};l.za=function(){return!0};l.Ea=function(){return this.u?this.w:Math.min(this.K,this.w)};
l.xb=function(){if(this.u&&!this.f)this.g=null;else{var a;if(a=this.f&&!this.l)a=1<this.a.c.buffered.length?!0:!1;if(a)ye(this,!0);else{this.g=null;a=this.b;var b=this.D,c=this.c.currentTime;mb(this.a,this.u?c:c+(this.j||0))>=this.Ea()?(ze(this),xe(this,1E3/(Math.abs(this.c.playbackRate)||1))):(b=Ae(this,c,b))?(b=nb(this.a,b,a.c,this.A),this.A=null,this.I&&(this.I=!1,Be(this,a)),this.l=!1,b.then(D(this,function(a){null==this.j&&(this.j=a);this.G&&0<mb(this.a,c)&&(this.G=!1,this.c.currentTime+=.001);
xe(this,0)})).catch(D(this,function(a){if("aborted"!=a.type){var b=[0,404,410];"net"==a.type&&-1!=b.indexOf(a.Lb.status)&&this.b&&xe(this,5E3);a=x(a);this.dispatchEvent(a)}}))):(ze(this),this.f&&!this.l&&(this.l=!0,Ce(this)),xe(this,1E3))}}};function Ae(a,b,c){a=a.a;var d=a.b.length;a=0<d?a.b[d-1]:null;return null!=a?null!=a.a?c.ia(a.a):null:c.ia(b)||(c.length()?T(c):null)}function ze(a){if(!a.u&&null!=a.j){a.u=!0;var b=a.a,c=a.j,d=c-b.u;0!=d&&(b.b=Ad(b.b,d),b.u=c);a.h.resolve(a.j)}}
function Be(a,b){var c;c=b.a.split("/")[0];c=w({type:"adaptation",bubbles:!0,contentType:c,size:"video"!=c?null:{width:b.width,height:b.height},bandwidth:b.bandwidth});a.dispatchEvent(c)}function Ce(a){var b=w({type:"ended"});a.dispatchEvent(b)}function xe(a,b){a.g=window.setTimeout(a.xb.bind(a),b)}function we(a){null!=a.g&&(window.clearTimeout(a.g),a.g=null)};function De(){this.streamStats=null;this.droppedFrames=this.decodedFrames=NaN;this.bufferingTime=this.playTime=this.estimatedBandwidth=0;this.playbackLatency=NaN;this.bufferingHistory=[];this.bandwidthHistory=[];this.streamHistory=[]}function Ee(a,b){var c=new Fe(b);a.streamHistory.push(new Ge(c));if(c.videoHeight||!a.streamStats)a.streamStats=c}function Fe(a){this.videoWidth=a.width;this.videoHeight=a.height;this.videoMimeType=a.a;this.videoBandwidth=a.bandwidth}
function Ge(a){this.timestamp=Ya()/1E3;this.value=a};function He(a,b,c,d,e,f){this.b=new G(null,[new I(a)]);this.a=new pb;this.a.body=b;this.a.method=c;this.a.a=3;this.a.h=d;this.a.c=1E3*(null!=f?f:0);a=e||{};for(var g in a)this.a.b[g]=a[g]}function Ie(a){return qb(a.b,a.a).then(function(a){return Promise.resolve(new Uint8Array(a))})};function Je(a,b,c){E.call(this,a);this.f=b;this.b=c;this.a=this.g=null;this.l=new gb;this.j={};this.h=[];this.w=0;this.c=new C;this.o=null;this.u=0}q(Je,E);Je.prototype.destroy=function(){this.i=null;for(var a=0;a<this.h.length;++a)this.h[a].close().catch(function(){});this.h=[];this.j=this.a=this.g=null;this.c.destroy();this.c=null;this.l.destroy();this.f=this.b=this.l=null};
Je.prototype.initialize=function(){for(var a=new B,b=this.b.Na(),c=0;c<b.length;++c){var d=b[c];d.a.a||d.b&&!Ke(d.b)||a.push(d.contentType,d)}for(var c={},d=!1,e=0;e<b.length;++e){var f=b[e];if(f.a.a&&!a.a.hasOwnProperty(f.contentType)){var g=f.a.a,h=c[g];h||(h=f.a,h={audioCapabilities:void 0,videoCapabilities:void 0,initDataTypes:void 0,distinctiveIdentifier:h.i?"required":"optional",persistentState:h.l||this.b.ea()?"required":"optional",sessionTypes:[this.b.ea()?"persistent-license":"temporary"]},
c[g]=h);if(f.b&&(g=f.contentType+"Capabilities",g in h)){d=!0;h[g]||(h[g]=[]);var k;"audio"==f.contentType?k=f.a.h:"video"==f.contentType&&(k=f.a.o);h[g].push({contentType:f.b,robustness:k})}}}if(!d)if(b.length)this.a=b[0].a;else throw a=Error("No DrmInfo exists!"),a.type="drm",a;if(0==Object.keys(c).length)return this.b.Da(a),this.c.resolve(),Promise.resolve();k=new C;c=Le(this,c,k);c=c.then(this.hb.bind(this,b,a));c=c.then(this.Eb.bind(this));k.reject(null);return c};
function Me(a,b){null==a.o&&(a.o=window.setTimeout(function(){var a=Error("Timeout waiting for sessions.");a.type="storage";this.c.reject(a)}.bind(a),b));return a.c}function Le(a,b,c){for(var d in b)c=c.catch(function(a,b){return navigator.requestMediaKeySystemAccess(a,[b])}.bind(null,d,b[d]));a.b.ea()&&(c=c.catch(function(){throw Error("Either none of the requested key systems are supported or none of the requested key systems support persistent state.");}));return c}l=Je.prototype;
l.hb=function(a,b,c){if(!this.f)return Ne();for(var d=c.keySystem,e=c.getConfiguration(),f=["audio","video"],g=0;g<f.length;++g){var h=f[g];if(!b.a.hasOwnProperty(h)){var k=e[h+"Capabilities"];if(k&&k.length){for(var k=k[0],m=[],p={},t=0;t<a.length;++t){var y=a[t];if(y.a.a==d&&y.b==k.contentType&&!(y.id in p)){m.push(y);p[y.id]=!0;var u;if(this.a){u=this.a;var y=y.a,v=new Rb;v.a=u.a;v.j=u.j;v.u=u.u;v.f=u.f;v.g=u.g;v.i=u.i;v.l=u.l;v.h=u.h;v.o=u.o;v.c=u.c?new Uint8Array(u.c.buffer):null;Tb(v,u.b);Tb(v,
y.b);u=v}else u=y.a;this.a=u}}b.a[h]=m}}}this.b.Da(b);return c.createMediaKeys()};
l.Eb=function(a){if(!this.f)return Ne();this.g=a;return this.f.setMediaKeys(this.g).then(D(this,function(){return this.f?this.a.c?this.g.setServerCertificate(this.a.c):Promise.resolve():Ne()})).then(D(this,function(){if(!this.f)return Ne();if(0<this.b.va().length)Oe(this);else{for(var a=0;a<this.a.b.length;++a){var c=this.a.b[a];this.Qa({type:"encrypted",initDataType:c.initDataType,initData:c.initData})}0==this.a.b.length&&F(this.l,this.f,"encrypted",this.Qa.bind(this))}}))};
function Ne(){var a=Error("EmeManager destroyed");a.type="destroy";return Promise.reject(a)}l.Qa=function(a){var b=new Uint8Array(a.initData),c=Array.prototype.join.apply(b);if(!this.j[c]){try{var d=Pe(this)}catch(e){d=x(e);this.dispatchEvent(d);this.c.reject(e);return}a=d.generateRequest(a.initDataType,a.initData);this.j[c]=!0;a.catch(D(this,function(a){if(this.j){this.j[c]=!1;var b=x(a);this.dispatchEvent(b);this.c.reject(a)}}));this.h.push(d)}};
function Oe(a){for(var b=a.b.va(),c=0;c<b.length;++c){var d=Pe(a),e=d.load(b[c]);a.h.push(d);e.catch(D(a,function(a){a=x(a);this.dispatchEvent(a)}))}}function Pe(a){var b=null;if(a.b.ea())try{b=a.g.createSession("persistent-license")}catch(c){throw Error("Persistent licenses are not supported by this key system or platform.");}else b=a.g.createSession();F(a.l,b,"message",a.sb.bind(a));F(a.l,b,"keystatuseschange",a.kb.bind(a));return b}l.sb=function(a){Qe(this,a.target,this.a,a.message)};
l.kb=function(a){a=a.target.keyStatuses;for(var b={},c=a.keys(),d=c.next();!d.done;d=c.next()){var e=Qb(new Uint8Array(d.value)),d=a.get(d.value);b[e]=d}this.b.Ra(b)};
function Qe(a,b,c,d){d=Re(c,d);Ie(new He(d.url,d.body,d.method,c.u,d.headers,a.u)).then(D(a,function(a){c.f&&(a=c.f(a));return b.update(a)})).then(D(a,function(){var a=w({type:"sessionReady",detail:b});this.dispatchEvent(a);this.w++;this.w>=this.h.length&&this.c.resolve()})).catch(D(a,function(a){a.Nb=b;a=x(a);this.dispatchEvent(a)}))}
function Re(a,b){var c={url:a.j,body:b.slice(0),method:"POST",headers:{}};if(!a.g)return c;a.g(c);c.url=Fa(c,"url");if(null==c.url)throw Error("'url' cannot be null.");if(!(c.body instanceof ArrayBuffer||"string"==typeof c.body||null==c.body))throw new TypeError("'body' must be an ArrayBuffer, a string, or null.");c.method=Fa(c,"method");if("GET"!=c.method&&"POST"!=c.method)throw Error("'method' must be either 'GET' or 'POST'.");c.headers=Ha(c,"headers",Object);if(null==c.headers)throw Error("'headers' cannot be null.");
return c};function V(a){E.call(this,null);this.a=a;this.b=null;this.f=new gb;this.l=this.o=null;this.H=0;this.A=null;this.j=!1;this.g=new De;this.c={enableAdaptation:!0,streamBufferSize:15,licenseRequestTimeout:0,mpdRequestTimeout:0,segmentRequestTimeout:0,preferredLanguage:"en",restrictions:new ea};this.u=1;this.D=null}q(V,E);n("shaka.player.Player",V);V.version="v1.5.0";
V.isBrowserSupported=function(){return!!window.MediaSource&&!!window.MediaKeys&&!!window.navigator&&!!window.navigator.requestMediaKeySystemAccess&&!!window.MediaKeySystemAccess&&!!window.MediaKeySystemAccess.prototype.getConfiguration&&!!window.Promise&&!!Element.prototype.requestFullscreen&&!!document.exitFullscreen&&"fullscreenElement"in document&&!!window.Uint8Array};function Ke(a){return"text/vtt"==a?!!window.VTTCue:MediaSource.isTypeSupported(a)}V.isTypeSupported=Ke;
V.setTextStyle=function(a){var b=document.getElementById("ShakaPlayerTextStyle");b||(b=document.createElement("style"),b.id="ShakaPlayerTextStyle",document.head.appendChild(b));for(b=b.sheet;b.cssRules.length;)b.deleteRule(0);b.insertRule("::cue { "+na(a)+" }",0)};V.prototype.destroy=function(){return this.w().then(D(this,function(){this.f.destroy();this.a=this.f=null})).catch(function(){})};V.prototype.destroy=V.prototype.destroy;
V.prototype.w=function(){if(!this.b)return Promise.resolve();this.j&&Se(this);this.a.pause();hb(this.f);Te(this);Ue(this);this.o&&(this.o.destroy(),this.o=null);this.a.src="";var a=this.a.setMediaKeys(null);this.b&&(this.b.destroy(),this.b=null);this.j=!1;this.g=new De;return a};V.prototype.unload=V.prototype.w;
V.prototype.ma=function(a){var b=this.w();this.a.autoplay&&(pa("load"),F(this.f,this.a,"timeupdate",this.jb.bind(this)));a.D(this.c);a.Za(this.D);this.D=null;b=b.then(D(this,function(){return a.Z()}));b.catch(D(this,function(b){a.destroy();return Promise.reject(b)}));return b.then(D(this,function(){if(!this.a)return Ve();this.b=a;F(this.f,this.b,"seekrangechanged",this.qb.bind(this));this.o=new Je(this,this.a,this.b);return this.o.initialize()})).then(D(this,function(){if(!this.a)return Ve();F(this.f,
this.a,"error",this.Fb.bind(this));F(this.f,this.a,"playing",this.ob.bind(this));F(this.f,this.a,"pause",this.nb.bind(this));return this.b.Ja(this,this.a)})).then(D(this,function(){if(!this.a)return Ve();We(this)})).catch(D(this,function(a){if(!this.a)return Ve();if("destroy"!=a.type){var b=x(a);this.dispatchEvent(b)}return this.w().then(function(){return Promise.reject(a)})}))};V.prototype.load=V.prototype.ma;
function Ve(){var a=Error("Player destroyed");a.type="destroy";return Promise.reject(a)}l=V.prototype;l.jb=function(){sa("load");this.g.playbackLatency=ua("load")/1E3;this.f.sa(this.a,"timeupdate")};l.Fb=function(){if(this.a.error){var a=this.a.error.code;a!=MediaError.MEDIA_ERR_ABORTED&&(a=Error(Ye[a]||"Unknown playback error."),a.type="playback",a=x(a),this.dispatchEvent(a))}};
l.ob=function(){pa("playing");!this.l&&0>this.u&&(this.a.playbackRate=0,this.G(this.a.currentTime,Date.now(),this.u));this.j&&Se(this)};l.nb=function(){sa("playing");var a=ua("playing");if(!isNaN(a)){var b=this.g;b.playTime+=a/1E3}Ue(this)};l.qb=function(a){this.H=a.start};
l.$a=function(){if(!this.a.paused){sa("playing");var a=ua("playing");if(!isNaN(a)){var b=this.g;b.playTime+=a/1E3;pa("playing")}}a=this.g;b=this.a;b.getVideoPlaybackQuality&&(b=b.getVideoPlaybackQuality(),a.decodedFrames=b.totalVideoFrames,a.droppedFrames=b.droppedVideoFrames);return this.g};V.prototype.getStats=V.prototype.$a;V.prototype.la=function(){return this.b?this.b.ja():[]};V.prototype.getVideoTracks=V.prototype.la;V.prototype.da=function(){return this.b?this.b.pa():[]};
V.prototype.getAudioTracks=V.prototype.da;V.prototype.ka=function(){return this.b?this.b.Ga():[]};V.prototype.getTextTracks=V.prototype.ka;V.prototype.selectVideoTrack=function(a,b){return this.b?this.b.selectVideoTrack(a,void 0==b?!0:b):!1};V.prototype.selectVideoTrack=V.prototype.selectVideoTrack;V.prototype.eb=function(a,b){return this.b?this.b.Xa(a,void 0==b?!0:b):!1};V.prototype.selectAudioTrack=V.prototype.eb;V.prototype.fb=function(a){return this.b?this.b.Ya(a,!1):!1};
V.prototype.selectTextTrack=V.prototype.fb;V.prototype.X=function(a){this.b&&this.b.Fa(a)};V.prototype.enableTextTrack=V.prototype.X;V.prototype.K=function(a){this.h({enableAdaptation:a})};V.prototype.enableAdaptation=V.prototype.K;V.prototype.S=function(){return this.c.enableAdaptation};V.prototype.getAdaptationEnabled=V.prototype.S;V.prototype.ta=function(a){this.h({streamBufferSize:a})};V.prototype.setStreamBufferSize=V.prototype.ta;V.prototype.V=function(){return Number(this.c.streamBufferSize)};
V.prototype.getStreamBufferSize=V.prototype.V;V.prototype.gb=function(a){this.h({licenseRequestTimeout:a/1E3})};V.prototype.setLicenseRequestTimeout=V.prototype.gb;V.prototype.aa=function(a){this.h({mpdRequestTimeout:a/1E3})};V.prototype.setMpdRequestTimeout=V.prototype.aa;V.prototype.N=function(a){this.h({segmentRequestTimeout:a/1E3})};V.prototype.setRangeRequestTimeout=V.prototype.N;V.prototype.M=function(a){this.h({preferredLanguage:a})};V.prototype.setPreferredLanguage=V.prototype.M;
V.prototype.ba=function(a){Ue(this);0<=a?this.a.playbackRate=a:this.a.paused||(this.a.playbackRate=0,this.G(this.a.currentTime,Date.now(),a));this.u=a};V.prototype.setPlaybackRate=V.prototype.ba;V.prototype.T=function(){return this.u};V.prototype.getPlaybackRate=V.prototype.T;V.prototype.ca=function(a){this.h({restrictions:a})};V.prototype.setRestrictions=V.prototype.ca;V.prototype.U=function(){return this.c.restrictions.clone()};V.prototype.getRestrictions=V.prototype.U;
V.prototype.cb=function(a){this.D=a};V.prototype.setPlaybackStartTime=V.prototype.cb;V.prototype.I=function(){return this.b?this.b.Wa():!1};V.prototype.isLive=V.prototype.I;
V.prototype.h=function(a){if(a){var b=Ea(a,"enableAdaptation","boolean");null!=b&&(this.c.enableAdaptation=b);b=Da(a,"streamBufferSize");null!=b&&(this.c.streamBufferSize=b);b=Da(a,"licenseRequestTimeout");null!=b&&(this.c.licenseRequestTimeout=b);b=Da(a,"mpdRequestTimeout");null!=b&&(this.c.mpdRequestTimeout=b);b=Da(a,"segmentRequestTimeout");null!=b&&(this.c.segmentRequestTimeout=b);b=Fa(a,"preferredLanguage");null!=b&&(this.c.preferredLanguage=b);a=Ha(a,"restrictions",ea);null!=a&&(this.c.restrictions=
a.clone());this.b&&this.b.D(this.c)}};V.prototype.configure=V.prototype.h;V.prototype.ua=function(){return this.c};V.prototype.getConfiguration=V.prototype.ua;function Ue(a){a.l&&(window.clearTimeout(a.l),a.l=null)}function We(a){Te(a);a.A=window.setTimeout(a.W.bind(a),100)}function Te(a){a.A&&(window.clearTimeout(a.A),a.A=null)}
V.prototype.G=function(a,b,c){this.l=null;var d=(Date.now()-b)/1E3*c;this.a.currentTime<this.H+(this.I()?1:.05)?this.a.pause():(d=Math.max(this.H,a+d),this.a.currentTime=d,this.l=window.setTimeout(this.G.bind(this,a,b,c),250))};function Se(a){sa("buffering");var b=a.g;b.bufferingTime+=ua("buffering")/1E3;a.j=!1;a.dispatchEvent(w({type:"bufferingEnd"}))}
V.prototype.W=function(){We(this);if(!this.a.ended&&!this.a.seeking){var a=this.a.buffered,b=a.length?a.end(a.length-1):0,a=Math.max(b-this.a.currentTime,0);if(this.j)b=this.b.Va(),a>b&&(Se(this),this.a.play());else{var c=this.a.duration,c=isNaN(c)?0:Math.max(c-.05,0),b=b>=c||this.a.currentTime>=c;!this.a.paused&&!b&&.2>a&&(this.j=!0,this.a.pause(),this.g.bufferingHistory.push(Ya()/1E3),pa("buffering"),this.dispatchEvent(w({type:"bufferingStart"})))}}};
var Ye={2:"A network failure occured while loading media content.",3:"The browser failed to decode the media content.",4:"The browser does not support the media content."};function Ze(a){for(var b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.a.length;++d){for(var e=c.a[d],f=e,g=0;g<f.m.length;++g)Ke(be(f.m[g]))||(f.m.splice(g,1),--g);0==e.m.length&&(c.a.splice(d,1),--d)}}function $e(a){for(var b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.a.length;++d)c.a[d].m.sort(af)}function af(a,b){var c=a.bandwidth||Number.MAX_VALUE,d=b.bandwidth||Number.MAX_VALUE;return c<d?-1:c>d?1:0};function bf(a){this.a=a}bf.prototype.destroy=function(){this.a.destroy();this.a=null};function cf(a,b){var c=df(b),d=df(a.a);return Promise.all([c,d]).then(D(a,function(a){var c=a[0];a=a[1];var d=this.a.a;Ze(d);$e(d);b.f=this.a.f;b.g=this.a.g?this.a.g.clone():null;b.c=this.a.c;d=[];ef(b,this.a,c,a,d);c=b.a;Ze(c);$e(c);return Promise.resolve(d)}))}
function df(a){function b(a,b){return a.concat(b)}var c=a.a.map(function(a){return a.a}).reduce(b,[]).map(function(a){return a.m}).reduce(b,[]);a=c.map(function(a){return a.F.create()});return Promise.all(a).then(function(a){for(var b={},f=0;f<c.length;++f)b[c[f].B]=a[f];return Promise.resolve(b)})}
function ef(a,b,c,d,e){var f=new B;a.a.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new B;b.a.forEach(function(a,b){g.push(a.id||""+b,a)});a=Ka(f);for(b=0;b<a.length;++b){var h=a[b],k=f.get(h);1<k.length||(h=g.get(h))&&0!=h.length&&1==h.length&&(ff(k[0],h[0],c,d,e),k[0].b=h[0].b)}}
function ff(a,b,c,d,e){var f=new B;a.a.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new B;b.a.forEach(function(a,b){g.push(a.id||""+b,a)});a=Ka(f);for(b=0;b<a.length;++b){var h=a[b],k=f.get(h);1<k.length||(h=g.get(h))&&0!=h.length&&1==h.length&&gf(k[0],h[0],c,d,e)}}
function gf(a,b,c,d,e){var f=new B;a.m.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new B;b.m.forEach(function(a,b){g.push(a.id||""+b,a)});b={};for(var h=Ka(f),k=0;k<h.length;++k){var m=h[k];b[m]=m;var p=f.get(m);1<p.length||((m=g.get(m))&&0!=m.length?1==m.length&&(hf(p[0],m[0],c,d),p[0].C=m[0].C,m[0].C=null,p[0].c=m[0].c):(e.push(p[0]),a.m.splice(a.m.indexOf(p[0]),1)))}h=Ka(g);for(k=0;k<h.length;++k)m=h[k],b[m]||(b[m]=m,m=g.get(m),a.m.push(m[0]))}
function hf(a,b,c,d){a=c[a.B];b=d[b.B];a.length();a.Ba(b)&&a.length()};function W(){this.a=this.b=null;this.f=new gb;this.c=Number.POSITIVE_INFINITY;this.i=!0;this.g=!1}n("shaka.media.SimpleAbrManager",W);W.prototype.destroy=function(){this.f.destroy();this.a=this.b=this.f=null};W.prototype.initialize=function(a,b){this.b||this.a||(this.b=a,this.a=b)};
W.prototype.start=function(){this.b&&this.a&&!this.g&&(this.c=Date.now()+4E3,F(this.f,this.b,"bandwidth",this.l.bind(this)),F(this.f,this.a,"adaptation",this.j.bind(this)),F(this.f,this.a,"trackschanged",this.h.bind(this)),this.g=!0)};W.prototype.enable=function(a){this.i=a};W.prototype.getInitialVideoTrackId=function(){if(!this.b||!this.a)return null;var a=jf(this);return a?a.id:null};W.prototype.selectVideoTrack=function(a,b,c){this.g&&this.a.selectVideoTrack(a.id,b,c)};
W.prototype.l=function(){Date.now()<this.c||this.h()};W.prototype.h=function(){if(this.i){var a=jf(this);if(a){if(a.active){this.c=Date.now()+3E3;return}this.selectVideoTrack(a,!1)}this.c=Number.POSITIVE_INFINITY}};W.prototype.j=function(){this.c==Number.POSITIVE_INFINITY&&(this.c=Date.now()+3E4)};
function jf(a){var b=a.a.ja();if(0==b.length)return null;b.sort(da);var c;a:{c=a.a.pa();for(var d=0;d<c.length;++d)if(c[d].active){c=c[d];break a}c=null}c=c?c.bandwidth:0;a=a.b.getBandwidth();for(var d=b[0],e=0;e<b.length;++e){var f=b[e],g=e+1<b.length?b[e+1]:{bandwidth:Number.POSITIVE_INFINITY};if(f.bandwidth&&(g=(g.bandwidth+c)/.85,a>=(f.bandwidth+c)/.95&&a<=g&&(d=f,d.active)))break}return d};function kf(a,b,c){E.call(this,null);this.f=a;this.c=b;this.b=Sb(c);this.a=null}q(kf,E);n("shaka.player.HttpVideoSource",kf);kf.prototype.D=function(){};kf.prototype.destroy=function(){this.a&&(this.a.parentElement.removeChild(this.a),this.a=null);this.i=this.b=null};l=kf.prototype;l.Ja=function(a,b){this.i=a;var c=b.mediaKeys;b.src=this.f;c=b.setMediaKeys(c);this.c&&(this.a=document.createElement("track"),this.a.src=this.c,b.appendChild(this.a),this.a.track.mode="showing");return c};l.Z=function(){return Promise.resolve()};
l.ja=function(){return[]};l.pa=function(){return[]};l.Ga=function(){return[]};l.Va=function(){return 5};l.Na=function(){var a=new fe;a.a=this.b;return[a]};l.Da=function(){};kf.prototype.selectVideoTrack=function(){return!1};l=kf.prototype;l.Xa=function(){return!1};l.Ya=function(){return!1};l.Fa=function(a){this.a&&(this.a.track.mode=a?"showing":"disabled")};l.Za=function(){};l.va=function(){return[]};l.ea=function(){return!1};l.Wa=function(){return!1};
l.Ra=function(a){for(var b in a){var c=va[a[b]]||null;c&&(c=Error("Key"+b+"is not usable. "+c),c.type="drm",c=x(c),this.dispatchEvent(c))}};function X(a,b,c){E.call(this,null);this.a=a;this.U=b;this.l=new gb;this.g=new MediaSource;this.f=null;this.aa=0;this.b=new B;this.w=c;this.w.initialize(b,this);this.H=!1;this.G="en";this.ca=!1;this.I=null;this.o=new C;this.h=new ea;this.u=null;this.ua=1;this.c={};this.ba=new C;this.S=0;this.ta=!1;this.j={};this.V=this.T=this.W=null;this.K={}}q(X,E);n("shaka.player.StreamVideoSource",X);
X.prototype.D=function(a){null!=a.streamBufferSize&&(this.K.streamBufferSize=a.streamBufferSize);null!=a.segmentRequestTimeout&&(this.K.segmentRequestTimeout=a.segmentRequestTimeout);lf(this);null!=a.enableAdaptation&&this.w.enable(Boolean(a.enableAdaptation));null!=a.mpdRequestTimeout&&(this.aa=Number(a.mpdRequestTimeout));null!=a.preferredLanguage&&(this.G=Na(String(a.preferredLanguage)));null!=a.restrictions&&(this.h=a.restrictions,this.H&&mf(this))};
X.prototype.destroy=function(){this.o.destroy();this.ba.destroy();this.ba=this.o=null;this.T&&(window.clearTimeout(this.T),this.T=null);this.W&&(window.clearTimeout(this.W),this.W=null);this.j=null;this.l.destroy();this.l=null;Ca(this.c).forEach(function(a){a.destroy()});this.b=this.c=null;this.a&&(this.a.destroy(),this.a=null);this.w.destroy();this.i=this.h=this.I=this.f=this.g=this.U=this.w=null};l=X.prototype;
l.Ja=function(a,b){if(!this.H){var c=Error("Cannot call attach() right now.");c.type="stream";return Promise.reject(c)}this.i=a;this.f=b;this.I=a.$a();F(this.l,this.g,"sourceopen",this.mb.bind(this));F(this.l,this.U,"bandwidth",this.Gb.bind(this));c=this.f.mediaKeys;this.f.src=window.URL.createObjectURL(this.g);c=this.f.setMediaKeys(c);return Promise.all([this.o,c])};
l.Z=function(){if(this.H){var a=Error("Cannot call load() right now.");a.type="stream";return Promise.reject(a)}if(!this.a||0==this.a.a.length)return a=Error("The manifest does not specify any content."),a.type="stream",Promise.reject(a);a=this.a.a;Ze(a);$e(a);if(0==this.a.a.length||0==this.a.a[0].a.length)return a=Error("The manifest specifies content that cannot be displayed on this browser/platform."),a.type="stream",Promise.reject(a);this.H=!0;this.K.initialStreamBufferSize=this.a.c;lf(this);
mf(this);return Promise.resolve()};l.vb=function(){var a=Date.now(),b=this.W=null;this.Sa(this.a.g).then(D(this,function(a){b=new bf(a);return cf(b,this.a)})).then(D(this,function(c){b.destroy();b=null;for(var d=0;d<c.length;++d)nf(this,c[d]);this.K.initialStreamBufferSize=this.a.c;lf(this);mf(this);0==Object.keys(this.c).length?of(this):pf(this,(Date.now()-a)/1E3)})).catch(D(this,function(a){b&&(b.destroy(),b=null);"aborted"!=a.type&&(a=x(a),this.dispatchEvent(a),this.a&&pf(this,0))}))};l.Sa=function(){return Promise.reject("Cannot update manifest with this VideoSource implementation.")};
function nf(a,b){var c=b.a.split("/")[0],d=a.c[c];if(d&&d.oa()==b){var e=a.b.get(b.a.split("/")[0]),f=e.map(function(a){return a.m}).reduce(function(a,b){return a.concat(b)},[]).filter(function(a){return a.L&&a.J});if(0==f.length){e.push(b);return}a.j[c].Ha==b&&delete a.j[c];d.ra(f[0],!0);b.destroy()}b.destroy()}
l.ja=function(){if(!this.b.a.hasOwnProperty("video"))return[];for(var a=this.c.video,a=(a=a?a.oa():null)?a.B:0,b=[],c=this.b.get("video"),d=0;d<c.length;++d)for(var e=c[d],f=0;f<e.m.length;++f){var g=e.m[f];if(g.L&&g.J){var h=g.B,g=new ca(h,g.bandwidth,g.width,g.height);h==a&&(g.active=!0);b.push(g)}}return b};X.prototype.getVideoTracks=X.prototype.ja;
X.prototype.pa=function(){if(!this.b.a.hasOwnProperty("audio"))return[];for(var a=this.c.audio,a=(a=a?a.oa():null)?a.B:0,b=[],c=this.b.get("audio"),d=0;d<c.length;++d)for(var e=c[d],f=e.lang,g=0;g<e.m.length;++g){var h=e.m[g];if(h.L&&h.J){var k=h.B,h=new fa(k,h.bandwidth,f);k==a&&(h.active=!0);b.push(h)}}return b};X.prototype.getAudioTracks=X.prototype.pa;
X.prototype.Ga=function(){if(!this.b.a.hasOwnProperty("text"))return[];for(var a=this.c.text,b=a?a.oa():null,b=b?b.B:0,c=[],d=this.b.get("text"),e=0;e<d.length;++e)for(var f=d[e],g=f.lang,h=0;h<f.m.length;++h){var k=f.m[h].B,m=new ba(k,g);k==b&&(m.active=!0,m.enabled=a.za());c.push(m)}return c};X.prototype.getTextTracks=X.prototype.Ga;X.prototype.Va=function(){var a=null,b;for(b in this.c){var c=this.c[b].Ea();0<c&&(a=null!=a?Math.min(a,c):c)}return a||0};
X.prototype.Na=function(){var a;if(this.H){a=this.a.a[0];for(var b=[],c=0;c<a.a.length;++c)b.push.apply(b,ee(a.a[c]));a=b}else a=[];return a};
X.prototype.Da=function(a){if(this.H){for(var b={},c=this.a.a[0],d=0;d<c.a.length;++d){var e=c.a[d];b[e.B]=e}this.b.a={};c=Ka(a);for(d=0;d<c.length;++d){var e=c[d],f=a.get(e);if("video"==e){var g=f[0].id;this.b.push(e,b[g])}else if("audio"==e)for(var g=f[0].b.split(";")[0],h=0;h<f.length;++h){var k=f[h];k.b.split(";")[0]==g&&this.b.push(e,b[k.id])}else for(h=0;h<f.length;++h)g=f[h].id,this.b.push(e,b[g])}this.ca=!0;if(a=this.b.get("audio"))qf(this,a),this.b.a.audio=a,a=a[0].lang||this.G,Ma(2,this.G,
a)&&(this.ca=!1);if(a=this.b.get("text"))qf(this,a),this.b.a.text=a,a=a[0].lang||this.G,Ma(2,this.G,a)||(this.ca=!1)}};X.prototype.selectVideoTrack=function(a,b,c){return rf(this,"video",a,b,c)};l=X.prototype;l.Xa=function(a,b){return rf(this,"audio",a,b)};l.Ya=function(a,b){return rf(this,"text",a,b)};l.Fa=function(a){var b=this.c.text;b&&b.wa(a)};l.Za=function(a){this.V=a};
function mf(a){if(a.h){for(var b=!1,c=0;c<a.a.a.length;++c)for(var d=a.a.a[c],e=0;e<d.a.length;++e){var f=d.a[e];if("video"==f.contentType)for(var g=0;g<f.m.length;++g){var h=f.m[g],k=h.J;h.J=!0;a.h.maxWidth&&h.width>a.h.maxWidth&&(h.J=!1);a.h.maxHeight&&h.height>a.h.maxHeight&&(h.J=!1);a.h.maxBandwidth&&h.bandwidth>a.h.maxBandwidth&&(h.J=!1);a.h.minBandwidth&&h.bandwidth<a.h.minBandwidth&&(h.J=!1);k!=h.J&&(b=!0)}}0!=Ia(a.b).length&&b&&(sf(a),0<a.ja().length||(b=Error("The applicaion has restricted all video tracks!"),
b.type="stream",b=x(b),a.dispatchEvent(b)))}}l.va=function(){return[]};l.ea=function(){return!1};l.Wa=function(){return this.a?this.a.b:!1};
l.Ra=function(a){for(var b,c=!1,d=new B,e=Ia(this.b),f=0;f<e.length;++f)for(var g=e[f],h=0;h<g.m.length;++h){var k=g.m[h];k.f.forEach(function(a){d.push(a,k)})}for(b in a)if(e=d.get(b))for(g=va[a[b]]||null,f=0;f<e.length;++f)k=e[f],h=k.L,k.L=!g,h!=k.L&&(c=!0);else ga(Lb(b));c&&(sf(this),b=this.pa(),a=this.ja(),b=this.b.a.hasOwnProperty("audio")&&0==b.length,a=this.b.a.hasOwnProperty("video")&&0==a.length,b||a)&&(a=Error("The key system has restricted all "+(b&&a?"audio and video tracks.":b?"audio tracks.":
"video tracks.")),a.type="stream",a=x(a),this.dispatchEvent(a))};function sf(a){var b=w({type:"trackschanged",bubbles:!0});a.dispatchEvent(b)}function rf(a,b,c,d,e){if(!a.b.a.hasOwnProperty(b)||!a.c[b])return!1;for(var f=a.b.get(b),g=0;g<f.length;++g)for(var h=f[g],k=0;k<h.m.length;++k){var m=h.m[k];if(m.B==c){if(!m.L||!m.J)return!1;if("text"!=b&&!a.ta)return c=a.j[b],a.j[b]={Ha:m,Ka:null!=c&&c.Ka||d,La:null!=c&&c.La||e},!0;Ee(a.I,m);a.c[b].ra(m,d,e);return!0}}return!1}
function qf(a,b){for(var c=0;2>=c;++c)for(var d=0;d<b.length;++d){var e=b[d];if(Ma(c,a.G,e.lang)){b.splice(d,1);b.splice(0,0,e);return}}for(d=0;d<b.length;++d)if(e=b[d],e.b){b.splice(d,1);b.splice(0,0,e);break}}l.mb=function(){this.l.sa(this.g,"sourceopen");of(this).then(D(this,function(){this.o&&this.o.resolve()})).catch(D(this,function(a){this.o&&this.o.reject(a)}))};
function of(a){for(var b=[],c=["audio","video","text"],d=0;d<c.length;++d){var e=c[d];a.b.a.hasOwnProperty(e)&&b.push(a.b.get(e)[0])}for(var f=tf(a,b),d=0;d<c.length;++d)if(e=c[d],a.b.a.hasOwnProperty(e)&&!f[e])return a=Error("Unable to select an initial "+e+" stream: all "+e+" streams have been restricted (by the application or by the key system)."),a.type="stream",Promise.reject(a);b=Ca(f).map(function(a){return a.F.create()});return Promise.all(b).then(D(a,function(a){if(!a.every(function(a){return a.length()}))return a=
Error("Some streams are not available."),a.type="stream",Promise.reject(a);a=uf(this,a);if(!a)return a=Error("Some streams are not available."),a.type="stream",Promise.reject(a);if(!vf(this,f))return a=Error("Failed to create Stream objects."),a.type="stream",Promise.reject(a);this.w.start();wf(this,f,a);return Promise.resolve()})).catch(D(a,function(a){if("aborted"!=a.type)return Object.keys(this.c),this.a.b?(pf(this,0),Promise.resolve()):Promise.reject(a)}))}
function tf(a,b){for(var c={},d=0;d<b.length;++d){var e=b[d],f=null;if("video"==e.contentType){var g=a.w.getInitialVideoTrackId();if(null==g)continue;f=e.m.filter(function(a){return a.B==g});if(0==f.length)continue;f=f[0]}else if("audio"==e.contentType){f=e.m.filter(function(a){return a.L&&a.J});if(0==f.length)continue;f=e.m[Math.floor(f.length/2)]}else 0<e.m.length&&(f=e.m[0]);c[e.contentType]=f}return c}
function vf(a,b){var c={},d;for(d in b){var e=b[d],e="text"==d?new ue(a,a.f):xf(a,e);if(!e)return Ca(c).forEach(function(a){a.destroy()}),!1;c[d]=e}a.c=c;return!0}function xf(a,b){var c=new ve(a,a.f,a.g,be(b),a.U);c.H(a.K);return c}
function wf(a,b,c){a.ua=a.f.playbackRate;a.f.playbackRate=0;yf(a,c);var d;d=a.a.b?c.end:a.V&&a.V<=c.end&&a.V>=c.start?a.V:c.start;F(a.l,a.f,"seeking",a.rb.bind(a));a.f.currentTime!=d&&(a.f.currentTime=d,a.u=d);zf(a,c.start,c.end);c=[];for(var e in a.c){d=a.c[e];c.push(d.bb(a.ba));F(a.l,d,"ended",a.tb.bind(a));var f=b[e];Ee(a.I,f);d.ra(f,!1)}Promise.all(c).then(a.ib.bind(a)).catch(D(a,function(a){"destroy"!=a.type&&(a=x(a),this.dispatchEvent(a))}));a.Fa(a.ca)}
l.ib=function(a){ia(a&&a.length==Object.keys(this.c).length);for(var b=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,d=0;d<a.length;++d)var e=a[d],b=Math.min(b,e),c=Math.max(c,e);a=Af(this);for(d=0;d<a.length;++d)a[d].ha(c);Bf(this,a,c);d=Ia(this.b).map(function(a){return a.m}).reduce(function(a,b){return a.concat(b)},[]).map(function(a){var b=[a.F.create()];a.C&&b.push(a.C.create());return Promise.all(b)});Promise.all(d).then(D(this,function(a){for(var b=0;b<a.length;++b)a[b][0].ha(c);this.ta=
!0;for(var d in this.j)a=this.j[d],b=this.c[d],Ee(this.I,a.Ha),b.ra(a.Ha,a.Ka,a.La);this.j={}})).catch(D(this,function(a){"aborted"!=a.type&&(a=x(a),this.dispatchEvent(a))}))};function Bf(a,b,c){if(b=uf(a,b))yf(a,b),zf(a,b.start,b.end);0!=c?(c=a.f.currentTime+c,a.f.currentTime=c,a.u=c):c=a.f.currentTime;a.a.b&&b&&(a.S=b.end-c,a.S=Math.max(a.S,0));a.f.playbackRate=a.ua;a.a.b&&null!=a.a.f&&pf(a,a.S);Cf(a);a.ba.resolve()}
function yf(a,b){if(a.a.b)isNaN(a.g.duration)&&(a.g.duration=b.end+2592E3);else if(isNaN(a.g.duration)||b.end>a.g.duration){a.g.duration=b.end;for(var c=0;c<a.g.sourceBuffers.length;++c)a.g.sourceBuffers[c].appendWindowEnd=b.end}}l.wb=function(){this.T=null;Cf(this);var a=uf(this,Af(this));a&&(zf(this,a.start,a.end),this.f.paused||Df(this,this.f.currentTime,a.start,a.end))};function zf(a,b,c){b=w({type:"seekrangechanged",bubbles:!0,start:b,end:c});a.dispatchEvent(b)}
l.rb=function(){var a=this.f.currentTime;if(null!=this.u){if(a>=this.u-.01&&a<=this.u+.01){this.u=null;return}this.u=null}var b=uf(this,Af(this));if(b){var c=b.end;(b=Df(this,a,b.start,c))||(a<=c+.01?b=!1:(this.f.currentTime=c,b=!0));if(!b)for(var d in this.c)this.c[d].Ua()}};function Df(a,b,c,d){if(b>=c-.01)return!1;a.f.currentTime=Math.min(c+(a.a.b?a.a.c:0),d);return!0}l.tb=function(){if(!this.a.b){for(var a in this.c)if(!this.c[a].Pa())return;this.g.endOfStream()}};
l.Gb=function(){var a=this.I,b=this.U.getBandwidth();a.estimatedBandwidth=b;a.bandwidthHistory.push(new Ge(b))};function Af(a){return Ca(a.c).map(function(a){return a.Oa()}).filter(function(a){return null!=a})}
function uf(a,b){for(var c=0,d=Number.POSITIVE_INFINITY,e=0;e<b.length;++e){var f=b[e].Aa(),c=Math.max(c,f.start);null!=f.end&&(d=Math.min(d,f.end))}if(d==Number.POSITIVE_INFINITY)if(d=a.a.a[0],d.b)d=(d.start||0)+d.b;else return null;a.a.b&&(d=Math.max(d-(a.a.c+a.S),c));return c>d?null:{start:c,end:d}}function pf(a,b){if(null!=a.a.f){var c=Math.max(a.a.f,3),c=Math.max(c-b,0);a.W=window.setTimeout(a.vb.bind(a),1E3*c)}}function Cf(a){a.a.b&&(a.T=window.setTimeout(a.wb.bind(a),1E3))}
function lf(a){for(var b in a.c)a.c[b].H(a.K)};function Y(a,b,c,d){c||(c=new Kb);d||(d=new W);X.call(this,null,c,d);this.ka=a;this.N=b;this.M=[];this.X=[];this.da=[];this.A=null}q(Y,X);n("shaka.player.DashVideoSource",Y);Y.prototype.la=function(a,b,c){this.M.push(a);this.X.push(b||"");this.da.push(c||"")};Y.prototype.addExternalCaptions=Y.prototype.la;Y.prototype.ma=function(a){this.A=a};Y.prototype.setNetworkCallback=Y.prototype.ma;Y.prototype.destroy=function(){this.A=this.N=null;X.prototype.destroy.call(this)};
Y.prototype.Z=function(){var a=new G(this.A,[new I(this.ka)]);return zd(new yd(a,this.aa)).then(D(this,function(a){for(var c=0;c<this.M.length;c++){var d=a,e=this.M[c],f=this.X[c],g=this.da[c];if(0!==d.a.length){var h=new Lc;h.contentType="text";h.lang=f||"en";h.c=!0;f=new Oc;f.bandwidth=0;f.f=g||"text/vtt";f.s=[new I(e)];h.a.push(f);d.a[0].b.push(h);gd(d.a[0])}}this.a=je(new ie(this.N),a,this.A);return X.prototype.Z.call(this)}))};
Y.prototype.Sa=function(a){return zd(new yd(a,this.aa)).then(D(this,function(a){a=je(new ie(this.N),a,this.A);return Promise.resolve(a)}))};function Ef(a,b){wb.call(this,"readwrite",b);this.l=a;this.b=0}q(Ef,wb);
function Ff(a,b,c,d,e){for(var f=[],g=[],h=0,k=0,m=[],p=b.map(function(a){return a.F.create()}),p=Promise.all(p),t=b.map(function(a){return a.C.create()}),t=Promise.all(t),p=Promise.all([p,t]).then(function(a){f=a[0];g=a[1];h=f.reduce(function(a,b){return a+b.length()},0)}),t=0;t<b.length;++t)p=p.then(function(a){return Gf(this,b[a],f[a],g[a],h,k)}.bind(a,t)),p=p.then(function(a,b){k+=f[a].length();m.push(b)}.bind(a,t));return p.then(D(a,function(){return Hf(Cb(this))})).then(D(a,function(a){var b=
new C;c=La(c);var f={group_id:a,stream_ids:m,session_ids:c,duration:d,key_system:e.a},g=Cb(this).put(f);g.onsuccess=function(){b.resolve(a)};g.onerror=function(){b.reject(g.error)};return b}))}function If(a,b){return Db(Cb(a),b).then(D(a,function(a){var d=[],e;for(e in a.stream_ids)d.push(Jf(this,a.stream_ids[e]));a=Cb(this);d.push(a.delete(b));return Promise.all(d)}))}
function Gf(a,b,c,d,e,f){var g=[Hf(Bb(a)),Hf(zb(a).index("stream"))],g=Promise.all(g).then(D(a,function(a){return{qa:Math.max(a[0],a[1]),ga:new ArrayBuffer(0),Ca:0,v:[],ya:null,Jb:e,Ta:f}})),g=g.then(a.f.bind(a,c));return g=g.then(a.g.bind(a,b,d))}function Hf(a){var b=new C,c=a.openCursor(null,"prev");c.onsuccess=function(a){a.target.result?b.resolve(a.target.result.key+1):b.resolve(0)};c.onerror=function(){b.reject(c.error)};return b}
Ef.prototype.g=function(a,b,c){var d=new C;a={stream_id:c.qa,mime_type:a.a,codecs:a.b,init_segment:b,references:c.v};var e=Bb(this).put(a);e.onsuccess=function(){d.resolve(c.qa)};e.onerror=function(){d.reject(e.error)};return d};Ef.prototype.f=function(a,b){for(var c=Promise.resolve(),d=0;d<a.length();++d)var e=a.get(d),f=d==a.length()-1,f=this.c.bind(this,e,b,f),c=c.then(this.j.bind(this,e)),c=c.then(f);return c.then(function(){return Promise.resolve(b)}).catch(D(this,function(a){Jf(this,b.qa);return Promise.reject(a)}))};
Ef.prototype.c=function(a,b,c,d){var e=new C;0==b.ga.byteLength&&(b.ya=a);b.ga=Kf(b.ga,d);b.Ta++;var f=w({type:"progress",detail:b.Ta/b.Jb*100,bubbles:!0});if(1048576<=b.ga.byteLength||c){c={stream_id:b.qa,segment_id:b.Ca,content:b.ga};var g=zb(this).put(c);b.v.push({start_time:b.ya.b,start_byte:b.ya.url.f,end_time:a.a,url:"idb://"+b.qa+"/"+b.Ca});b.Ca++;b.ga=new ArrayBuffer(0);g.onerror=function(){e.reject(g.error)};g.onsuccess=D(this,function(){this.dispatchEvent(f);e.resolve()})}else this.dispatchEvent(f),
e.resolve();return e};function Kf(a,b){var c=new Uint8Array(a.byteLength+b.byteLength);c.set(new Uint8Array(a),0);c.set(new Uint8Array(b),a.byteLength);return c.buffer}Ef.prototype.j=function(a){var b=new pb;b.c=1E3*this.b;return qb(a.url,b,this.l)};
function Jf(a,b){var c=new C,d=Bb(a).delete(b);d.onerror=function(){c.reject(d.error)};var e=zb(a);e.index("stream").openKeyCursor(IDBKeyRange.only(b)).onsuccess=function(a){if(a=a.target.result)e.delete(a.primaryKey),a.continue()};e.transaction.oncomplete=function(){c.resolve()};return c};function Z(a,b,c){b||(b=new Kb);c||(c=new W);X.call(this,null,b,c);this.X=a;this.M=[];this.timeoutMs=3E4;this.A={};this.N=null}q(Z,X);n("shaka.player.OfflineVideoSource",Z);Z.prototype.D=function(a){null!=a.licenseRequestTimeout&&(this.A.licenseRequestTimeout=a.licenseRequestTimeout);null!=a.segmentRequestTimeout&&(this.A.segmentRequestTimeout=a.segmentRequestTimeout);X.prototype.D.call(this,a)};
n("shaka.player.OfflineVideoSource.retrieveGroupIds",function(){var a=new Fb,b=xb(a).then(function(){return Gb(a)});b.then(function(){H(a)}).catch(function(){H(a)});return b});
Z.prototype.ma=function(a,b,c,d){var e,f={},g=[];a=new G(this.N,[new I(a)]);return zd(new yd(a,this.aa)).then(D(this,function(a){this.a=je(new ie(c),a,this.N);if(this.a.b)return Promise.reject(Error("Unable to store live streams offline."));this.D({preferredLanguage:b});return X.prototype.Z.call(this)})).then(D(this,function(){var a=document.createElement("video");a.src=window.URL.createObjectURL(this.g);e=new Je(null,a,this);null!=this.A.licenseRequestTimeout&&(e.u=Number(this.A.licenseRequestTimeout));
F(this.l,e,"sessionReady",this.da.bind(this));return e.initialize()})).then(D(this,function(){for(var a=Ia(this.b),b=0;b<a.length;++b)for(var c=a[b],e=0;e<c.m.length;++e){var g=c.m[e];f[g.B]=g}return d()})).then(D(this,function(a){for(var b=0;b<a.length;++b){var c=a[b],d=f[c];if(d)g.push(d);else return Promise.reject(Error("Invalid stream ID chosen: "+c))}var e=["audio","video"];g=g.filter(function(a){return 0>e.indexOf(a.a.split("/")[0])?!1:!0});a=g.map(function(a){return a.C.create()});return Promise.all(a)})).then(D(this,
function(a){for(var b=g,c=[],d=0;d<b.length;++d)try{c[d]=this.g.addSourceBuffer(be(b[d]))}catch(e){}if(b.length!=c.length)a=Error("Error initializing streams."),a.type="storage",a=Promise.reject(a);else{for(d=0;d<a.length;++d)(b=a[d])&&c[d].appendBuffer(b);a=Promise.resolve()}return a})).then(D(this,function(){return Me(e,this.timeoutMs)})).then(D(this,function(){return Lf(this,g,e.a,this.a.a[0].b)}))};n("shaka.player.OfflineVideoSource.prototype.store",Z.prototype.ma);
Z.prototype.la=function(a){this.N=a};Z.prototype.setNetworkCallback=Z.prototype.la;Z.prototype.da=function(a){this.M.push(a.detail.sessionId)};function Lf(a,b,c,d){var e=new Ef(a.U,a);null!=a.A.segmentRequestTimeout&&(e.b=Number(a.A.segmentRequestTimeout));return xb(e).then(D(a,function(){return Ff(e,b,this.M,d,c)})).then(function(a){H(e);return Promise.resolve(a)}).catch(function(a){H(e);return Promise.reject(a)})}
Z.prototype.Z=function(){var a=new Fb,b,c;return xb(a).then(D(this,function(){return Hb(a,this.X)})).then(D(this,function(d){var e=[];this.M=d.session_ids;b=d.duration;c=d.key_system;for(var f=0;f<d.stream_ids.length;++f)e.push(Ib(a,d.stream_ids[f]));return Promise.all(e)})).then(D(this,function(a){var e=b,f=c,g=new he;g.c=5;for(var h=new ge,k=0;k<a.length;++k){var m=a[k],p=new $d,t=new Xd(m.references),y=new Uint8Array(m.init_segment),y=new I("data:application/octet-stream;base64,"+Ob(y)),y=new Zd(new G(this.N,
[y],0,null));p.F=t;p.C=y;p.a=m.mime_type;p.b=m.codecs;p.L=!0;m=Sb({keySystem:f,licenseServerUrl:""});t=new ce;t.m.push(p);t.a.push(m);t.contentType=p.a.split("/")[0];h.a.push(t);h.b=e}g.a.push(h);this.a=g;return X.prototype.Z.call(this)})).then(function(){H(a);return Promise.resolve()}).catch(function(b){H(a);return Promise.reject(b)})};
Z.prototype.ka=function(){var a=new Ef(null,null);return xb(a).then(D(this,function(){return If(a,this.X)})).then(function(){H(a);return Promise.resolve()}).catch(function(b){H(a);return Promise.reject(b)})};Z.prototype.deleteGroup=Z.prototype.ka;Z.prototype.va=function(){return this.M};Z.prototype.ea=function(){return!0};}.bind(g,this))();
if (typeof(module)!="undefined"&&module.exports)module.exports=g.shaka;
else if (typeof(define)!="undefined" && define.amd)define(function(){return g.shaka});
else this.shaka=g.shaka;
})();

