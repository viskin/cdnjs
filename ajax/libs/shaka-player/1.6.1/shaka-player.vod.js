(function(){var g={};
(function(window){var k,aa=this;function m(a,b){var c=a.split("."),d=aa;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d[e]?d=d[e]:d=d[e]={}:d[e]=b}function p(a,b){function c(){}c.prototype=b.prototype;a.sb=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.qb=function(a,c,f){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2))}};/*

 Copyright 2015 Google Inc.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
function ba(a,b){this.id=a;this.lang=b||"unknown";this.enabled=this.active=!1}m("shaka.player.TextTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:0});function ca(){this.minBandwidth=this.maxBandwidth=this.maxWidth=this.minHeight=this.maxHeight=null}ca.prototype.clone=function(){var a=new ca;a.maxHeight=this.maxHeight;a.minHeight=this.minHeight;a.maxWidth=this.maxWidth;a.maxBandwidth=this.maxBandwidth;a.minBandwidth=this.minBandwidth;return a};function da(a,b,c,d){this.id=a;this.bandwidth=b||0;this.width=c||0;this.height=d||0;this.active=!1}function ea(a,b){var c=a.width*a.height,d=b.width*b.height;return c<d?-1:c>d?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0}m("shaka.player.VideoTrack.compare",ea);function fa(a,b,c){this.id=a;this.bandwidth=b||0;this.lang=c||"unknown";this.active=!1}m("shaka.player.AudioTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0});function q(){var a,b,c=new Promise(function(c,e){a=c;b=e});c.resolve=a;c.reject=b;c.destroy=q.prototype.destroy;return c}q.prototype.destroy=function(){this.catch(function(){});var a=Error("Destroyed!");a.type="destroy";this.reject(a)};function u(a,b){return b.bind(a)};function ga(a){return Object.keys(a).map(function(b){return a[b]})}function ha(a,b){var c=ia(a,b,"number");if(null==c)return null;if(isNaN(c)||c==Number.NEGATIVE_INFINITY||c==Number.POSITIVE_INFINITY)throw new RangeError("'"+b+"' must be finite.");if(0>c)throw new RangeError("'"+b+"' must be >= 0");return c}function v(a,b){return ia(a,b,"string")}function ia(a,b,c){a=a[b];if(null==a)return null;if(typeof a!=c)throw new TypeError("'"+b+"' must be a "+c+".");return a}
function w(a,b,c){a=a[b];if(null==a)return null;if(!(a instanceof c))throw new TypeError("'"+b+"' must be an instance of "+c.name+".");return a};function ja(a){a.split("").reduce(function(a,c,d){return a+(d&&0==d%4?" "+c:c)})};function ka(a,b){for(var c=[],d=0;d<a.length;++d){for(var e=!1,f=0;f<c.length&&!(e=b?b(a[d],c[f]):a[d]===c[f]);++f);e||c.push(a[d])}return c};var la={"output-restricted":"The required output protection is not available.","output-not-allowed":"The required output protection is not available.",expired:"The decryption key has expired.","internal-error":"The key system has encountered an unspecified error."};function ma(a){return String.fromCharCode.apply(null,a)}m("shaka.util.Uint8ArrayUtils.toString",ma);function na(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;++c)b[c]=a.charCodeAt(c);return b}m("shaka.util.Uint8ArrayUtils.fromString",na);m("shaka.util.Uint8ArrayUtils.toBase64",function(a,b){var c=void 0==b?!0:b,d=window.btoa(ma(a)).replace(/\+/g,"-").replace(/\//g,"_");return c?d:d.replace(/=*$/,"")});function oa(a){return na(window.atob(a.replace(/-/g,"+").replace(/_/g,"/")))}
m("shaka.util.Uint8ArrayUtils.fromBase64",oa);m("shaka.util.Uint8ArrayUtils.fromHex",function(a){for(var b=new Uint8Array(a.length/2),c=0;c<a.length;c+=2)b[c/2]=window.parseInt(a.substr(c,2),16);return b});function pa(a){for(var b="",c=0;c<a.length;++c){var d=a[c].toString(16);1==d.length&&(d="0"+d);b+=d}return b}m("shaka.util.Uint8ArrayUtils.toHex",pa);function qa(a,b){if(!a&&!b)return!0;if(!a||!b||a.length!=b.length)return!1;for(var c=0;c<a.length;++c)if(a[c]!=b[c])return!1;return!0};function x(){this.a={}}x.prototype.push=function(a,b){this.a.hasOwnProperty(a)?this.a[a].push(b):this.a[a]=[b]};x.prototype.set=function(a,b){this.a[a]=b};x.prototype.get=function(a){return(a=this.a[a])?a.slice():null};function ra(a){var b=[],c;for(c in a.a)b.push.apply(b,a.a[c]);return b}function sa(a,b,c){if(a=a.a[b])for(b=0;b<a.length;++b)a[b]==c&&(a.splice(b,1),--b)}function ta(a){var b=[],c;for(c in a.a)b.push(c);return b};var ua=0;function va(){};function wa(){this.h=this.a="";this.j=!1;this.o=this.u=null;this.i=this.g=!1;this.l=this.f="";this.c=null;this.b=[]}function xa(a,b){var c=a.b.concat(b.map(function(a){return{initData:new Uint8Array(a.initData.buffer),initDataType:a.initDataType}}));a.b=ka(c,ya)}function ya(a,b){return a.initDataType==b.initDataType&&qa(a.initData,b.initData)};function za(a){this.c=Math.exp(Math.log(.5)/a);this.a=this.b=0}za.prototype.sample=function(a,b){var c=Math.pow(this.c,a);this.b=b*(1-c)+c*this.b;this.a+=a};function Aa(a){return a.b/(1-Math.pow(a.c,a.a))};function y(a){var b=new CustomEvent(a.type,{detail:a.detail,bubbles:!!a.bubbles}),c;for(c in a)c in b||(b[c]=a[c]);return b}function z(a){return new CustomEvent("error",{detail:a,bubbles:!0})};function Ba(a,b,c){Ca(b);Ca(c);return c==b||a>=Da&&c==b.split("-")[0]||a>=Ea&&c.split("-")[0]==b.split("-")[0]?!0:!1}var Da=1,Ea=2;function Ca(a){a=a.toLowerCase().split("-");var b=Fa[a[0]];b&&(a[0]=b);return a.join("-")}
var Fa={aar:"aa",abk:"ab",afr:"af",aka:"ak",alb:"sq",amh:"am",ara:"ar",arg:"an",arm:"hy",asm:"as",ava:"av",ave:"ae",aym:"ay",aze:"az",bak:"ba",bam:"bm",baq:"eu",bel:"be",ben:"bn",bih:"bh",bis:"bi",bod:"bo",bos:"bs",bre:"br",bul:"bg",bur:"my",cat:"ca",ces:"cs",cha:"ch",che:"ce",chi:"zh",chu:"cu",chv:"cv",cor:"kw",cos:"co",cre:"cr",cym:"cy",cze:"cs",dan:"da",deu:"de",div:"dv",dut:"nl",dzo:"dz",ell:"el",eng:"en",epo:"eo",est:"et",eus:"eu",ewe:"ee",fao:"fo",fas:"fa",fij:"fj",fin:"fi",fra:"fr",fre:"fr",
fry:"fy",ful:"ff",geo:"ka",ger:"de",gla:"gd",gle:"ga",glg:"gl",glv:"gv",gre:"el",grn:"gn",guj:"gu",hat:"ht",hau:"ha",heb:"he",her:"hz",hin:"hi",hmo:"ho",hrv:"hr",hun:"hu",hye:"hy",ibo:"ig",ice:"is",ido:"io",iii:"ii",iku:"iu",ile:"ie",ina:"ia",ind:"id",ipk:"ik",isl:"is",ita:"it",jav:"jv",jpn:"ja",kal:"kl",kan:"kn",kas:"ks",kat:"ka",kau:"kr",kaz:"kk",khm:"km",kik:"ki",kin:"rw",kir:"ky",kom:"kv",kon:"kg",kor:"ko",kua:"kj",kur:"ku",lao:"lo",lat:"la",lav:"lv",lim:"li",lin:"ln",lit:"lt",ltz:"lb",lub:"lu",
lug:"lg",mac:"mk",mah:"mh",mal:"ml",mao:"mi",mar:"mr",may:"ms",mkd:"mk",mlg:"mg",mlt:"mt",mon:"mn",mri:"mi",msa:"ms",mya:"my",nau:"na",nav:"nv",nbl:"nr",nde:"nd",ndo:"ng",nep:"ne",nld:"nl",nno:"nn",nob:"nb",nor:"no",nya:"ny",oci:"oc",oji:"oj",ori:"or",orm:"om",oss:"os",pan:"pa",per:"fa",pli:"pi",pol:"pl",por:"pt",pus:"ps",que:"qu",roh:"rm",ron:"ro",rum:"ro",run:"rn",rus:"ru",sag:"sg",san:"sa",sin:"si",slk:"sk",slo:"sk",slv:"sl",sme:"se",smo:"sm",sna:"sn",snd:"sd",som:"so",sot:"st",spa:"es",sqi:"sq",
srd:"sc",srp:"sr",ssw:"ss",sun:"su",swa:"sw",swe:"sv",tah:"ty",tam:"ta",tat:"tt",tel:"te",tgk:"tg",tgl:"tl",tha:"th",tib:"bo",tir:"ti",ton:"to",tsn:"tn",tso:"ts",tuk:"tk",tur:"tr",twi:"tw",uig:"ug",ukr:"uk",urd:"ur",uzb:"uz",ven:"ve",vie:"vi",vol:"vo",wel:"cy",wln:"wa",wol:"wo",xho:"xh",yid:"yi",yor:"yo",zha:"za",zho:"zh",zul:"zu"};function B(a){this.ia=new x;this.u=a}m("shaka.util.FakeEventTarget",B);B.prototype.addEventListener=function(a,b,c){c||this.ia.push(a,b)};B.prototype.removeEventListener=function(a,b,c){c||sa(this.ia,a,b)};
B.prototype.dispatchEvent=function(a){a.hasOwnProperty("srcElement")||(delete a.srcElement,Object.defineProperty(a,"srcElement",{get:function(){return null}}));if(a.hasOwnProperty("target"))a.target=this;else{delete a.target;var b=this;Object.defineProperty(a,"target",{get:function(){return b},set:function(a){b=a}})}if(a.hasOwnProperty("currentTarget"))a.currentTarget=null;else{delete a.currentTarget;var c=null;Object.defineProperty(a,"currentTarget",{get:function(){return c},set:function(a){c=a}})}return Ga(this,
a)};function Ga(a,b){b.currentTarget=a;for(var c=a.ia.get(b.type)||[],d=0;d<c.length;++d){var e=c[d];try{e.handleEvent?e.handleEvent(b):e.call(a,b)}catch(f){}}a.u&&b.bubbles&&Ga(a.u,b);return b.defaultPrevented};function E(){B.call(this,null);this.a=new za(3);this.c=new za(10);this.b=0}p(E,B);m("shaka.util.EWMABandwidthEstimator",E);E.prototype.sample=function(a,b){if(!(65536>b)){a=Math.max(a,50);var c=8E3*b/a,d=a/1E3;this.a.sample(d,c);this.c.sample(d,c);this.dispatchEvent(y({type:"bandwidth"}));this.b=Date.now()}};E.prototype.getBandwidth=function(){return.5>this.a.a?5E5:Math.min(Aa(this.a),Aa(this.c))};E.prototype.getDataAge=function(){return(Date.now()-this.b)/1E3};E.prototype.supportsCaching=function(){return!1};function Ha(a){var b=Ia;this.b=a;this.c=b==Ja;this.a=0}var Ia=0,Ja=1;function Ka(a){var b=a.b.getUint8(a.a);a.a+=1;return b}function F(a){var b=a.b.getUint32(a.a,a.c);a.a+=4;return b}function La(a){var b,c;a.c?(b=a.b.getUint32(a.a,!0),c=a.b.getUint32(a.a+4,!0)):(c=a.b.getUint32(a.a,!1),b=a.b.getUint32(a.a+4,!1));if(2097151<c)throw new RangeError("DataViewReader: Overflow reading 64-bit value.");a.a+=8;return c*Math.pow(2,32)+b}
function Ma(a){if(a.a+16>a.b.byteLength)throw new RangeError("DataViewReader: Read past end of DataView.");var b=new Uint8Array(a.b.buffer,a.a,16);a.a+=16;return b}function G(a,b){if(a.a+b>a.b.byteLength)throw new RangeError("DataViewReader: Skip past end of DataView.");a.a+=b};function Na(){this.g=new q;this.f=!1;this.a=null;this.b=[];this.c=null}function Oa(a,b){if(a.f)throw Error("Cannot append to a running task!");a.b.push(b)}Na.prototype.start=function(){if(this.f)throw Error("Task already started!");this.f=!0;this.b.unshift(function(){});Pa(this,void 0)};Na.prototype.end=function(){this.b.splice(1)};
function Pa(a,b){var c=a.b[0](b),d;c?(d=c[0],a.c=c[1]):(d=Promise.resolve(),a.c=null);d.then(u(a,function(a){this.a?(this.b=[],this.c=null,Qa(this)):(this.b.shift(),this.b.length?Pa(this,a):(this.g.resolve(a),this.c=null))})).catch(u(a,function(a){this.b=[];this.c=null;this.a?Qa(this):this.g.reject(a)}))}function Qa(a){var b=Error("Task aborted.");b.type="aborted";a.g.reject(b);window.setTimeout(function(){this.a.resolve();this.a=null}.bind(a),5)};function H(){this.a=new x}H.prototype.destroy=function(){Ra(this);this.a=null};function I(a,b,c,d){b=new Sa(b,c,d);a.a.push(c,b)}H.prototype.ba=function(a,b){for(var c=this.a.get(b)||[],d=0;d<c.length;++d){var e=c[d];e.target==a&&(e.ba(),sa(this.a,b,e))}};function Ra(a){for(var b=ra(a.a),c=0;c<b.length;++c)b[c].ba();a.a.a={}}function Sa(a,b,c){this.target=a;this.type=b;this.a=c;this.target.addEventListener(b,c,!1)}
Sa.prototype.ba=function(){this.target&&(this.target.removeEventListener(this.type,this.a,!1),this.a=this.target=null)};function Ta(a,b,c){MediaSource.isTypeSupported(b);b=a.addSourceBuffer(b);this.j=a;this.c=b;this.l=c;this.h=new H;this.s=null;this.b=[];this.o=0;this.f=this.a=null;this.u=0;I(this.h,this.c,"updateend",this.v.bind(this))}var Ua=1/60;Ta.prototype.destroy=function(){Va(this).catch(function(){});this.f&&this.f.destroy();this.b=this.a=this.f=null;this.h.destroy();this.j=this.c=this.h=null};
function Wa(a,b){for(var c=a.c.buffered,d=0;d<c.length;++d){var e=c.start(d)-Ua,f=c.end(d)+Ua;if(b>=e&&b<=f)return c.end(d)-b}return 0}
function Xa(a,b,c,d){if(a.a)return a=Error("Cannot fetch ("+a.i+"): previous operation not complete."),a.type="stream",Promise.reject(a);a.a=new Na;c!=a.c.timestampOffset&&(a.c.timestampOffset=c);d&&Oa(a.a,function(){return[Ya(this,d),this.g.bind(this)]}.bind(a));Oa(a.a,function(){var a=b.a?b.a-b.b:1,c=new Za;c.a=3;c.h=1E3*a;c.c=1E3*this.u;c.j=this.s;return[$a(b.url,c,this.l),J.prototype.f.bind(b.url)]}.bind(a));Oa(a.a,u(a,function(a){this.l.getBandwidth();return[Ya(this,a),this.g.bind(this)]}));
var e=0==a.c.buffered.length&&0==a.b.length,f=null;Oa(a.a,function(){if(0==this.c.buffered.length){var a=Error("Failed to buffer segment ("+this.i+").");a.type="stream";return[Promise.reject(a)]}e&&(a=b.b,f=this.c.buffered.start(0)-a);a=ab(this.b,b.b);0<=a?this.b.splice(a+1,0,b):this.b.push(b)}.bind(a));return bb(a).then(function(){return Promise.resolve(f)}.bind(a))}
function cb(a){if(a.a)return a=Error("Cannot clear ("+a.i+"): previous operation not complete."),a.type="stream",Promise.reject(a);a.a=new Na;Oa(a.a,function(){var a;a:if(0==this.c.buffered.length)a=Promise.resolve();else{try{this.c.remove(0,Number.POSITIVE_INFINITY)}catch(c){a=Promise.reject(c);break a}this.b=[];a=this.f=new q}return[a,this.g.bind(this)]}.bind(a));return bb(a)}
function db(a,b){if(a.a){var c=Error("Cannot clearAfter ("+a.i+"): previous operation not complete.");c.type="stream";return Promise.reject(c)}a.a=new Na;Oa(a.a,function(){return[eb(this,b),this.g.bind(this)]}.bind(a));return bb(a)}function Va(a){a.a?(a=a.a,a.a?a=a.a:a.f?(a.c&&a.c(),a.a=new q,a=a.a):(a.f=!0,a=Promise.resolve())):a=Promise.resolve();return a}function bb(a){a.a.start();return a.a.g.then(u(a,function(){this.a=null})).catch(u(a,function(a){this.a=null;return Promise.reject(a)}))}
function Ya(a,b){try{a.c.appendBuffer(b)}catch(c){return Promise.reject(c)}a.f=new q;return a.f}function eb(a,b){if(0==a.c.buffered.length)return Promise.resolve();var c=ab(a.b,b);if(-1==c||c==a.b.length-1)return Promise.resolve();try{a.c.remove(a.b[c+1].b,Number.POSITIVE_INFINITY)}catch(d){return Promise.reject(d)}a.b=a.b.slice(0,c+1);a.f=new q;return a.f}Ta.prototype.g=function(){"open"==this.j.readyState&&this.c.abort()};Ta.prototype.v=function(){this.f.resolve();this.f=null};function fb(a){var b=console[a];b?b.bind||(console[a]=function(){b.apply(console,arguments)}):console[a]=function(){}}fb("error");fb("warn");fb("info");fb("log");fb("debug");function K(){this.fontSize="100%";this.fontColor=gb;this.fontOpacity=hb;this.backgroundColor=ib;this.backgroundOpacity=hb;this.fontEdge=jb}m("shaka.player.TextStyle",K);K.prototype.a=function(){var a=window.localStorage.getItem("ShakaPlayerTextStyle");if(a){var b;try{b=JSON.parse(a)}catch(c){return}if(b&&"object"==typeof b){var a=b,d;for(d in a)d in this&&(this[d]=a[d])}}};K.prototype.load=K.prototype.a;K.prototype.b=function(){window.localStorage.setItem("ShakaPlayerTextStyle",JSON.stringify(this))};
K.prototype.store=K.prototype.b;function kb(a){var b=[];b.push("font-size: "+a.fontSize);b.push("color: "+lb(a.fontColor,a.fontOpacity));b.push("background-color: "+lb(a.backgroundColor,a.backgroundOpacity));for(var c=[],d=0;d<a.fontEdge.length;++d){var e=a.fontEdge[d].slice(3,6);c.push(lb(a.fontEdge[d].slice(0,3),a.fontOpacity)+" "+e.join("px ")+"px")}b.push("text-shadow: "+c.join(","));return b.join("; ")}function lb(a,b){return"rgba("+a.concat(b).join(",")+")"}var gb=[255,255,255],ib=[0,0,0];
K.StandardColors={WHITE:gb,BLACK:ib,RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,255,0],MAGENTA:[255,0,255],CYAN:[0,255,255]};var hb=1;K.StandardOpacities={OPAQUE:hb,SEMI_HIGH:.75,SEMI_LOW:.25,TRANSPARENT:0};var jb=[];
K.EdgeStyles={NONE:jb,RAISED:[[34,34,34,1,1,0],[34,34,34,2,2,0],[34,34,34,3,3,0]],DEPRESSED:[[204,204,204,1,1,0],[204,204,204,0,1,0],[34,34,34,-1,-1,0],[34,34,34,0,-1,0]],UNIFORM:[[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4]],DROP:[[34,34,34,2,2,3],[34,34,34,2,2,4],[34,34,34,2,2,5]]};function mb(a){this.systemIds=[];this.cencKeyIds=[];this.a=[];a=new Ha(new DataView(a.buffer));try{for(;a.a<a.b.byteLength;){var b=a.a,c=F(a),d=F(a);1==c?c=La(a):0==c&&(c=a.b.byteLength-b);if(1886614376!=d)G(a,c-(a.a-b));else{var e=Ka(a);if(1<e)G(a,c-(a.a-b));else{G(a,3);var f=pa(Ma(a)),g=[];if(0<e)for(var h=F(a),l=0;l<h;++l){var n=pa(Ma(a));g.push(n)}var r=F(a);G(a,r);this.cencKeyIds.push.apply(this.cencKeyIds,g);this.systemIds.push(f);this.a.push({start:b,end:a.a-1});a.a!=b+c&&G(a,c-(a.a-b))}}}}catch(t){}}
;function nb(a){ob[a]={da:pb(),end:NaN}}function qb(a){if(a=ob[a])a.end=pb()}function rb(a){return(a=ob[a])&&a.end?a.end-a.da:NaN}var pb=window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now,ob={};function L(a){this.c=[];this.b=[];this.O=sb;if(a)try{a(this.K.bind(this),this.a.bind(this))}catch(b){this.a(b)}}var sb=0;function tb(){window.Promise||(window.Promise=L,window.Promise.resolve=ub,window.Promise.reject=vb,window.Promise.all=wb,window.Promise.race=xb,yb=window.setImmediate?function(a){window.setImmediate(a)}:function(a){window.setTimeout(a,0)})}m("shaka.polyfill.Promise.install",tb);function ub(a){var b=new L;b.K(a);return b}function vb(a){var b=new L;b.a(a);return b}
function wb(a){function b(a,b,c){a.O==sb&&(e[b]=c,d++,d==e.length&&a.K(e))}var c=new L;if(!a.length)return c.K([]),c;for(var d=0,e=Array(a.length),f=c.a.bind(c),g=0;g<a.length;++g)a[g].then?a[g].then(b.bind(null,c,g),f):b(c,g,a[g]);return c}function xb(a){for(var b=new L,c=b.K.bind(b),d=b.a.bind(b),e=0;e<a.length;++e)a[e].then?a[e].then(c,d):c(a[e]);return b}
L.prototype.then=function(a,b){var c=new L;switch(this.O){case 1:zb(this,c,a);break;case 2:zb(this,c,b);break;case sb:this.c.push({ma:c,ja:a}),this.b.push({ma:c,ja:b})}return c};L.prototype.then=L.prototype.then;L.prototype.catch=function(a){return this.then(void 0,a)};L.prototype["catch"]=L.prototype.catch;L.prototype.K=function(a){if(this.O==sb){this.ha=a;this.O=1;for(a=0;a<this.c.length;++a)zb(this,this.c[a].ma,this.c[a].ja);this.c=[];this.b=[]}};
L.prototype.a=function(a){if(this.O==sb){this.ha=a;this.O=2;for(a=0;a<this.b.length;++a)zb(this,this.b[a].ma,this.b[a].ja);this.c=[];this.b=[]}};function zb(a,b,c){yb(function(){if(c&&"function"==typeof c){try{var a=c(this.ha)}catch(e){b.a(e);return}a instanceof L?a==b?b.a(new TypeError("Chaining cycle detected")):a.then(b.K.bind(b),b.a.bind(b)):b.K(a)}else 1==this.O?b.K(this.ha):b.a(this.ha)}.bind(a))}function yb(){};function Ab(a,b){try{var c=new Bb(a,b);return Promise.resolve(c)}catch(d){return Promise.reject(d)}}
function Bb(a,b){this.keySystem=a;for(var c=!1,d=0;d<b.length;++d){var e=b[d],f={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:e.initDataTypes,sessionTypes:["temporary"]},g=!1;if(e.audioCapabilities)for(var h=0;h<e.audioCapabilities.length;++h){var l=e.audioCapabilities[h];if(l.contentType){var g=!0,n=l.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,n)&&(f.audioCapabilities.push(l),c=!0)}}if(e.videoCapabilities)for(h=
0;h<e.videoCapabilities.length;++h)l=e.videoCapabilities[h],l.contentType&&(g=!0,n=l.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,n)&&(f.videoCapabilities.push(l),c=!0));g||(c=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4"));"required"==e.persistentState&&(f.persistentState="required",f.sessionTypes=["persistent-license"]);if(c){this.a=f;return}}c=Error("Unsupported keySystem");c.name="NotSupportedError";c.code=DOMException.NOT_SUPPORTED_ERR;throw c;}
Bb.prototype.createMediaKeys=function(){var a=new Cb(this.keySystem);return Promise.resolve(a)};Bb.prototype.getConfiguration=function(){return this.a};function Db(a){var b=this.mediaKeys;b&&b!=a&&Eb(b,null);delete this.mediaKeys;return(this.mediaKeys=a)?Eb(a,this):Promise.resolve()}function Cb(a){this.a=new MSMediaKeys(a);this.b=new H}Cb.prototype.createSession=function(a){if("temporary"!=(a||"temporary"))throw new TypeError("Session type "+a+" is unsupported on this platform.");return new Fb(this.a)};
Cb.prototype.setServerCertificate=function(){return Promise.reject(Error("setServerCertificate not supported on this platform."))};function Eb(a,b){function c(){b.msSetMediaKeys(d.a);b.removeEventListener("loadedmetadata",c)}Ra(a.b);if(!b)return Promise.resolve();I(a.b,b,"msneedkey",Gb);var d=a;try{return 1<=b.readyState?b.msSetMediaKeys(a.a):b.addEventListener("loadedmetadata",c),Promise.resolve()}catch(e){return Promise.reject(e)}}
function Fb(a){B.call(this,null);this.c=null;this.g=a;this.b=this.a=null;this.f=new H;this.sessionId="";this.expiration=NaN;this.closed=new q;this.keyStatuses=new Hb}p(Fb,B);k=Fb.prototype;k.generateRequest=function(a,b){this.a=new q;try{this.c=this.g.createSession("video/mp4",b),I(this.f,this.c,"mskeymessage",this.Wa.bind(this)),I(this.f,this.c,"mskeyadded",this.Ua.bind(this)),I(this.f,this.c,"mskeyerror",this.Va.bind(this)),Ib(this,"status-pending")}catch(c){this.a.reject(c)}return this.a};
k.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))};k.update=function(a){this.b=new q;try{this.c.update(a)}catch(b){this.b.reject(b)}return this.b};k.close=function(){try{this.c.close(),this.closed.resolve(),Ra(this.f)}catch(a){this.closed.reject(a)}return this.closed};k.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))};
function Gb(a){var b=a.initData;if(b){var c=new mb(b);if(1>=c.a.length)a=b;else{var d=[];for(a=0;a<c.a.length;a++)d.push(b.subarray(c.a[a].start,c.a[a].end+1));b=ka(d,Jb);for(a=c=0;a<b.length;a++)c+=b[a].length;c=new Uint8Array(c);for(a=d=0;a<b.length;a++)c.set(b[a],d),d+=b[a].length;a=c}}else a=b;a=y({type:"encrypted",initDataType:"cenc",initData:a});this.dispatchEvent(a)}function Jb(a,b){return qa(a,b)}
k.Wa=function(a){this.a&&(this.a.resolve(),this.a=null);a=y({type:"message",messageType:void 0==this.keyStatuses.la()?"licenserequest":"licenserenewal",message:a.message.buffer});this.dispatchEvent(a)};k.Ua=function(){this.a?(this.a.resolve(),this.a=null):this.b&&(Ib(this,"usable"),this.b.resolve(),this.b=null)};
k.Va=function(){var a=Error("EME v20140218 key error");a.errorCode=this.c.error;if(null!=this.a)this.a.reject(a),this.a=null;else if(null!=this.b)this.b.reject(a),this.b=null;else switch(this.c.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:Ib(this,"output-not-allowed");default:Ib(this,"internal-error")}};function Ib(a,b){a.keyStatuses.oa(b);var c=y({type:"keystatuseschange"});a.dispatchEvent(c)}function Kb(a){this.b=a;this.a=0}
Kb.prototype.next=function(){return this.a>=this.b.length?{value:void 0,done:!0}:{value:this.b[this.a++],done:!1}};function Hb(){this.size=0;this.a=void 0}var Lb;k=Hb.prototype;k.oa=function(a){this.size=void 0==a?0:1;this.a=a};k.la=function(){return this.a};k.entries=function(){var a=Lb,b=[];this.a&&b.push([a,this.a]);return new Kb(b)};k.forEach=function(a){this.a&&a(this.a,Lb)};k.get=function(a){if(this.has(a))return this.a};k.has=function(a){var b=Lb;return this.a&&qa(new Uint8Array(a),b)?!0:!1};
k.keys=function(){var a=Lb,b=[];this.a&&b.push(a);return new Kb(b)};k.values=function(){var a=[];this.a&&a.push(this.a);return new Kb(a)};function Mb(){var a="CustomEvent"in window;if(a)try{new CustomEvent("")}catch(b){a=!1}a||(window.CustomEvent=Nb)}m("shaka.polyfill.CustomEvent.install",Mb);function Nb(a,b){var c=document.createEvent("CustomEvent"),d=b||{bubbles:!1,cancelable:!1,detail:null};c.initCustomEvent(a,!!d.bubbles,!!d.cancelable,d.detail);return c};function Ob(){var a=HTMLVideoElement.prototype;!a.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in a&&(a.getVideoPlaybackQuality=Pb)}m("shaka.polyfill.VideoPlaybackQuality.install",Ob);function Pb(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}};function Qb(){var a=Element.prototype;a.requestFullscreen=a.requestFullscreen||a.mozRequestFullScreen||a.msRequestFullscreen||a.webkitRequestFullscreen;a=Document.prototype;a.exitFullscreen=a.exitFullscreen||a.mozCancelFullScreen||a.msExitFullscreen||a.webkitExitFullscreen;"fullscreenElement"in document||Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}});document.addEventListener("webkitfullscreenchange",
Rb);document.addEventListener("webkitfullscreenerror",Rb);document.addEventListener("mozfullscreenchange",Rb);document.addEventListener("mozfullscreenerror",Rb);document.addEventListener("MSFullscreenChange",Rb);document.addEventListener("MSFullscreenError",Rb)}m("shaka.polyfill.Fullscreen.install",Qb);function Rb(a){var b=a.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),b=new Event(b,a);a.target.dispatchEvent(b)};function Sb(){return Promise.reject(Error("The key system specified is not supported."))}function Tb(a){return null==a?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function Ub(){throw new TypeError("Illegal constructor.");}Ub.prototype.createSession=function(){};Ub.prototype.setServerCertificate=function(){};function Vb(){throw new TypeError("Illegal constructor.");}Vb.prototype.getConfiguration=function(){};Vb.prototype.createMediaKeys=function(){};function Wb(a,b){try{var c=new Xb(a,b);return Promise.resolve(c)}catch(d){return Promise.reject(d)}}function Yb(a){var b=this.mediaKeys;b&&b!=a&&Zb(b,null);delete this.mediaKeys;(this.mediaKeys=a)&&Zb(a,this);return Promise.resolve()}
function Xb(a,b){this.a=this.keySystem=a;var c=!0;"org.w3.clearkey"==a&&(this.a="webkit-org.w3.clearkey",c=!1);var d=!1,e;e=document.getElementsByTagName("video");e=e.length?e[0]:document.createElement("video");for(var f=0;f<b.length;++f){var g=b[f],h={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:g.initDataTypes,sessionTypes:["temporary"]},l=!1;if(g.audioCapabilities)for(var n=0;n<g.audioCapabilities.length;++n){var r=g.audioCapabilities[n];
r.contentType&&(l=!0,e.canPlayType(r.contentType.split(";")[0],this.a)&&(h.audioCapabilities.push(r),d=!0))}if(g.videoCapabilities)for(n=0;n<g.videoCapabilities.length;++n)r=g.videoCapabilities[n],r.contentType&&(l=!0,e.canPlayType(r.contentType,this.a)&&(h.videoCapabilities.push(r),d=!0));l||(d=e.canPlayType("video/mp4",this.a)||e.canPlayType("video/webm",this.a));"required"==g.persistentState&&(c?(h.persistentState="required",h.sessionTypes=["persistent-license"]):d=!1);if(d){this.b=h;return}}c=
"Unsupported keySystem";if("org.w3.clearkey"==a||"com.widevine.alpha"==a)c="None of the requested configurations were supported.";c=Error(c);c.name="NotSupportedError";c.code=DOMException.NOT_SUPPORTED_ERR;throw c;}Xb.prototype.createMediaKeys=function(){var a=new $b(this.a);return Promise.resolve(a)};Xb.prototype.getConfiguration=function(){return this.b};function $b(a){this.g=a;this.b=null;this.a=new H;this.c=[];this.f={}}
function Zb(a,b){a.b=b;Ra(a.a);b&&(I(a.a,b,"webkitneedkey",a.kb.bind(a)),I(a.a,b,"webkitkeymessage",a.jb.bind(a)),I(a.a,b,"webkitkeyadded",a.hb.bind(a)),I(a.a,b,"webkitkeyerror",a.ib.bind(a)))}k=$b.prototype;k.createSession=function(a){var b=a||"temporary";if("temporary"!=b&&"persistent-license"!=b)throw new TypeError("Session type "+a+" is unsupported on this platform.");a=this.b||document.createElement("video");a.src||(a.src="about:blank");b=new ac(a,this.g,b);this.c.push(b);return b};
k.setServerCertificate=function(){return Promise.reject(Error("setServerCertificate not supported on this platform."))};k.kb=function(a){a=y({type:"encrypted",initDataType:"webm",initData:a.initData});this.b.dispatchEvent(a)};k.jb=function(a){var b=bc(this,a.sessionId);b&&(a=y({type:"message",messageType:void 0==b.keyStatuses.la()?"licenserequest":"licenserenewal",message:a.message}),b.b&&(b.b.resolve(),b.b=null),b.dispatchEvent(a))};
k.hb=function(a){if(a=bc(this,a.sessionId))cc(a,"usable"),a.a&&a.a.resolve(),a.a=null};
k.ib=function(a){var b=bc(this,a.sessionId);if(b){var c=Error("EME v0.1b key error");c.errorCode=a.errorCode;c.errorCode.systemCode=a.systemCode;!a.sessionId&&b.b?(c.method="generateRequest",45==a.systemCode&&(c.message="Unsupported session type."),b.b.reject(c),b.b=null):a.sessionId&&b.a?(c.method="update",b.a.reject(c),b.a=null):(c=a.systemCode,a.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?cc(b,"output-restricted"):1==c?cc(b,"expired"):cc(b,"internal-error"))}};
function bc(a,b){var c=a.f[b];return c?c:(c=a.c.shift())?(c.sessionId=b,a.f[b]=c):null}function ac(a,b,c){B.call(this,null);this.f=a;this.h=!1;this.a=this.b=null;this.c=b;this.g=c;this.sessionId="";this.expiration=NaN;this.closed=new q;this.keyStatuses=new dc}p(ac,B);
function ec(a,b,c){if(a.h)return Promise.reject(Error("The session is already initialized."));a.h=!0;var d;try{if("persistent-license"==a.g)if(c)d=na("LOAD_SESSION|"+c);else{var e=new Uint8Array(b);d=na("PERSISTENT|"+ma(e))}else d=new Uint8Array(b)}catch(f){return Promise.reject(f)}a.b=new q;try{a.f.webkitGenerateKeyRequest(a.c,d)}catch(g){if("InvalidStateError"!=g.name)return a.b=null,Promise.reject(g);setTimeout(function(){try{this.f.webkitGenerateKeyRequest(this.c,d)}catch(a){this.b.reject(a),
this.b=null}}.bind(a),10)}return a.b}k=ac.prototype;k.pa=function(a,b){if(this.a)this.a.then(this.pa.bind(this,a,b)).catch(this.pa.bind(this,a,b));else{this.a=a;var c,d;"webkit-org.w3.clearkey"==this.c?(c=ma(new Uint8Array(b)),d=JSON.parse(c),"oct"!=d.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null),c=oa(d.keys[0].k),d=oa(d.keys[0].kid)):(c=new Uint8Array(b),d=null);try{this.f.webkitAddKey(this.c,c,d,this.sessionId)}catch(e){this.a.reject(e),this.a=null}}};
function cc(a,b){a.keyStatuses.oa(b);var c=y({type:"keystatuseschange"});a.dispatchEvent(c)}k.generateRequest=function(a,b){return ec(this,b,null)};k.load=function(a){return"persistent-license"==this.g?ec(this,null,a):Promise.reject(Error("Not a persistent session."))};k.update=function(a){var b=new q;this.pa(b,a);return b};
k.close=function(){if("persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;this.f.webkitCancelKeyRequest(this.c,this.sessionId)}this.closed.resolve();return this.closed};k.remove=function(){return"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()};function fc(a){this.b=a;this.a=0}
fc.prototype.next=function(){return this.a>=this.b.length?{value:void 0,done:!0}:{value:this.b[this.a++],done:!1}};function dc(){this.size=0;this.a=void 0}var gc;k=dc.prototype;k.oa=function(a){this.size=void 0==a?0:1;this.a=a};k.la=function(){return this.a};k.entries=function(){var a=gc,b=[];this.a&&b.push([a,this.a]);return new fc(b)};k.forEach=function(a){this.a&&a(this.a,gc)};k.get=function(a){if(this.has(a))return this.a};k.has=function(a){var b=gc;return this.a&&qa(new Uint8Array(a),b)?!0:!1};
k.keys=function(){var a=gc,b=[];this.a&&b.push(a);return new fc(b)};k.values=function(){var a=[];this.a&&a.push(this.a);return new fc(a)};function hc(){Navigator.prototype.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(HTMLMediaElement.prototype.webkitGenerateKeyRequest?(gc=new Uint8Array([0]),Navigator.prototype.requestMediaKeySystemAccess=Wb,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Yb,window.MediaKeys=$b,window.MediaKeySystemAccess=Xb):window.MSMediaKeys?(Lb=new Uint8Array([0]),delete HTMLMediaElement.prototype.mediaKeys,
HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Db,window.MediaKeys=Cb,window.MediaKeySystemAccess=Bb,Navigator.prototype.requestMediaKeySystemAccess=Ab):(Navigator.prototype.requestMediaKeySystemAccess=Sb,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Tb,window.MediaKeys=Ub,window.MediaKeySystemAccess=Vb))}m("shaka.polyfill.MediaKeys.install",hc);m("shaka.polyfill.installAll",function(){Mb();Qb();Ob();tb();hc()});var ic=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function M(a){var b;a instanceof M?(jc(this,a.I),this.P=a.P,this.H=a.H,kc(this,a.Y),this.F=a.F,lc(this,a.a.clone()),this.M=a.M):a&&(b=String(a).match(ic))?(jc(this,b[1]||"",!0),this.P=mc(b[2]||""),this.H=mc(b[3]||"",!0),kc(this,b[4]),this.F=mc(b[5]||"",!0),lc(this,b[6]||"",!0),this.M=mc(b[7]||"")):this.a=new N(null)}k=M.prototype;k.I="";k.P="";k.H="";k.Y=null;k.F="";k.M="";
k.toString=function(){var a=[],b=this.I;b&&a.push(nc(b,oc,!0),":");if(b=this.H){a.push("//");var c=this.P;c&&a.push(nc(c,oc,!0),"@");a.push(encodeURIComponent(b).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));b=this.Y;null!=b&&a.push(":",String(b))}if(b=this.F)this.H&&"/"!=b.charAt(0)&&a.push("/"),a.push(nc(b,"/"==b.charAt(0)?pc:qc,!0));(b=this.a.toString())&&a.push("?",b);(b=this.M)&&a.push("#",nc(b,rc));return a.join("")};
k.resolve=function(a){var b=this.clone();"data"===b.I&&(b=new M);var c=!!a.I;c?jc(b,a.I):c=!!a.P;c?b.P=a.P:c=!!a.H;c?b.H=a.H:c=null!=a.Y;var d=a.F;if(c)kc(b,a.Y);else if(c=!!a.F){if("/"!=d.charAt(0))if(this.H&&!this.F)d="/"+d;else{var e=b.F.lastIndexOf("/");-1!=e&&(d=b.F.substr(0,e+1)+d)}if(".."==d||"."==d)d="";else if(-1!=d.indexOf("./")||-1!=d.indexOf("/.")){for(var e=0==d.lastIndexOf("/",0),d=d.split("/"),f=[],g=0;g<d.length;){var h=d[g++];"."==h?e&&g==d.length&&f.push(""):".."==h?((1<f.length||
1==f.length&&""!=f[0])&&f.pop(),e&&g==d.length&&f.push("")):(f.push(h),e=!0)}d=f.join("/")}}c?b.F=d:c=""!==a.a.toString();c?lc(b,a.a.clone()):c=!!a.M;c&&(b.M=a.M);return b};k.clone=function(){return new M(this)};function jc(a,b,c){a.I=c?mc(b,!0):b;a.I&&(a.I=a.I.replace(/:$/,""))}function kc(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.Y=b}else a.Y=null}function lc(a,b,c){b instanceof N?a.a=b:(c||(b=nc(b,sc)),a.a=new N(b))}
function mc(a,b){return a?b?decodeURI(a):decodeURIComponent(a):""}function nc(a,b,c){return"string"==typeof a?(a=encodeURI(a).replace(b,tc),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function tc(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var oc=/[#\/\?@]/g,qc=/[\#\?:]/g,pc=/[\#\?]/g,sc=/[\#\?@]/g,rc=/#/g;function N(a){this.b=a||null}N.prototype.a=null;N.prototype.c=null;
function uc(a,b,c){if(!a.a&&(a.a={},a.c=0,a.b))for(var d=a.b.split("&"),e=0;e<d.length;e++){var f=d[e].indexOf("="),g=null,h=null;0<=f?(g=d[e].substring(0,f),h=d[e].substring(f+1)):g=d[e];g=decodeURIComponent(g.replace(/\+/g," "));h=h||"";uc(a,g,decodeURIComponent(h.replace(/\+/g," ")))}a.b=null;(d=a.a.hasOwnProperty(b)&&a.a[b])||(a.a[b]=d=[]);d.push(c);a.c++}
N.prototype.toString=function(){if(this.b)return this.b;if(!this.a)return"";var a=[],b;for(b in this.a)for(var c=encodeURIComponent(b),d=this.a[b],e=0;e<d.length;e++){var f=c;""!==d[e]&&(f+="="+encodeURIComponent(d[e]));a.push(f)}return this.b=a.join("&")};N.prototype.clone=function(){var a=new N;a.b=this.b;if(this.a){var b={},c;for(c in this.a)b[c]=this.a[c].concat();a.a=b;a.c=this.c}return a};function vc(a,b){this.url=a;this.b=b||new Za;this.g=this.i=this.h=0;this.a=null;this.c=new q;this.f=null}function Za(){this.body=null;this.a=1;this.h=1E3;this.c=0;this.method="GET";this.f="arraybuffer";this.b={};this.g=this.i=!1;this.j=null}function wc(a){xc(a);a.b.body=null;a.c.destroy();a.c=null;a.f=null}function xc(a){a.a&&(a.a.onload=null,a.a.onreadystatechange=null,a.a.onerror=null,a.a.ontimeout=null);a.a=null}k=vc.prototype;
k.Ha=function(){if(this.a)return this.c;if(0==this.url.lastIndexOf("data:",0)){var a=this.url.split(":")[1].split(";").pop().split(","),b=a.pop(),b="base64"==a.pop()?window.atob(b.replace(/-/g,"+").replace(/_/g,"/")):window.decodeURIComponent(b);"arraybuffer"==this.b.f&&(b=na(b).buffer);a=JSON.parse(JSON.stringify(new XMLHttpRequest));a.response=b;a.responseText=b.toString();b=this.c;b.resolve(a);wc(this);return b}if(0==this.url.lastIndexOf("idb:",0))return this.j();this.h++;this.i=Date.now();this.g||
(this.g=this.b.h);this.a=new XMLHttpRequest;a=this.url;if(this.f&&!this.f.supportsCaching()||this.b.g)a=new M(a),uc(a.a,"_",Date.now()),a=a.toString();this.a.open(this.b.method,a,!0);this.a.responseType=this.b.f;this.a.timeout=this.b.c;this.a.withCredentials=this.b.i;this.a.onload=this.Sa.bind(this);this.b.g&&(this.a.onreadystatechange=this.Za.bind(this));this.a.onerror=this.ob.bind(this);this.a.ontimeout=this.eb.bind(this);for(b in this.b.b)this.a.setRequestHeader(b,this.b.b[b]);this.a.send(this.b.body);
return this.c};function yc(a,b,c){b=Error(b);b.type=c;b.status=a.a.status;b.url=a.url;b.method=a.b.method;b.body=a.b.body;b.pb=a.a;return b}k.Sa=function(a){this.f&&this.f.sample(Date.now()-this.i,a.loaded);200<=this.a.status&&299>=this.a.status?(this.c.resolve(this.a),wc(this)):this.h<this.b.a?zc(this):(a=yc(this,"HTTP error.","net"),this.c.reject(a),wc(this))};k.Za=function(){if(this.a.readyState==XMLHttpRequest.HEADERS_RECEIVED){var a=Date.parse(this.a.getResponseHeader("Date"));a&&(ua=a-Date.now())}};
k.ob=function(){var a=yc(this,"Network failure.","net");this.c.reject(a);wc(this)};k.eb=function(){if(this.h<this.b.a)zc(this);else{var a=yc(this,"Request timed out.","net");this.c.reject(a);wc(this)}};function zc(a){xc(a);window.setTimeout(a.Ha.bind(a),a.g*(1+.5*(2*Math.random()-1)));a.g*=2};function J(a,b,c,d){this.c=b;this.h=c||0;this.g=null!=d?d:null;this.b=this.a=null;this.i=a}function $a(a,b,c){if(a.a)return a.a;b=b||new Za;if(a.h||a.g)b.b.Range="bytes="+(a.h+"-"+(null!=a.g?a.g:""));a.a=Ac(a,0,b,c);return a.a}J.prototype.f=function(){if(this.b){this.a=null;var a=this.b;if(a.a&&a.a.readyState!=XMLHttpRequest.DONE){a.a.abort();var b=yc(a,"Request aborted.","aborted");a.c.reject(b);wc(a)}this.b=null}};
function Ac(a,b,c,d){var e=a.c[b].toString();a.i&&(e=a.i(e,c.b)||e);a.b=new vc(e,c);d&&(a.b.f=d);e=a.b.Ha().then(u(a,function(a){this.b=this.a=null;return Promise.resolve(a.response)}));return e=e.catch(u(a,function(a){if(this.a&&b+1<this.c.length)return this.a=Ac(this,b+1,c,d);this.a=this.b=null;return Promise.reject(a)}))}J.prototype.clone=function(){return new J(this.i,this.c.map(function(a){return a.clone()}),this.h,this.g)};J.prototype.toString=function(){return this.c[0].toString()};function Bc(a,b){this.a=a;this.b=b||null}Bc.prototype.destroy=function(){this.a&&(this.a.f(),this.a=null);this.b=null};Bc.prototype.create=function(){return this.a?$a(this.a):Promise.resolve(this.b)};function Cc(a,b,c){this.b=a;this.a=b;this.url=c}function ab(a,b){for(var c=a.length-1;0<=c;--c){var d=a[c];if(b>=d.b&&(null==d.a||b<d.a))return c}return-1}function Dc(a,b){return a.map(function(a){return new Cc(a.b+b,null!=a.a?a.a+b:null,a.url)})};function Ec(){}
Ec.prototype.parse=function(a,b,c,d){var e=null;try{a:{var f=[],g=new Ha(a),h=F(g);if(1936286840!=F(g))e=null;else{1==h&&(h=La(g));var l=Ka(g);G(g,3);G(g,4);var n=F(g);if(0==n)e=null;else{var r,t;0==l?(r=F(g),t=F(g)):(r=La(g),t=La(g));G(g,2);var C=g.b.getUint16(g.a,g.c);g.a+=2;a=r;b=b+h+t;for(h=0;h<C;h++){var A=F(g);t=(A&2147483648)>>>31;var l=A&2147483647,D=F(g);F(g);if(1==t){e=null;break a}var Xd=new J(d,c,b,b+l-1);f.push(new Cc(a/n,(a+D)/n,Xd));a+=D;b+=l}e=f}}}}catch(Nc){if(!(Nc instanceof RangeError))throw Nc;
}return e};function Fc(a){this.a=a;this.b=0}Fc.prototype.destroy=function(){this.a=null};Fc.prototype.length=function(){return this.a.length};function Gc(a){if(0==a.a.length)throw new RangeError("SegmentIndex: There is no first SegmentReference.");return a.a[0]}Fc.prototype.X=function(){if(0==this.a.length)throw new RangeError("SegmentIndex: There is no last SegmentReference.");return this.a[this.a.length-1]};
Fc.prototype.get=function(a){if(0>a||a>=this.a.length)throw new RangeError("SegmentIndex: The specified index is out of range.");return this.a[a]};function Hc(a,b){var c=ab(a.a,b);return 0<=c?a.a[c]:null}function Ic(a,b){var c=b-a.b;0!=c&&(a.a=Dc(a.a,c),a.b=b)};function Jc(a){this.b=a;this.a=null}Jc.prototype.destroy=function(){this.a&&(this.a.destroy(),this.a=null)};Jc.prototype.create=function(){if(this.a)return Promise.resolve(this.a);var a=new Cc(0,null,this.b);this.a=new Fc([a]);return Promise.resolve(this.a)};function Kc(){this.b=Lc++;this.id=this.N=this.J=null;this.h=0;this.height=this.width=this.bandwidth=null;this.f=this.c="";this.g=[];this.G=!1;this.a=!0}var Lc=0;Kc.prototype.destroy=function(){this.J&&(this.J.destroy(),this.J=null);this.N&&(this.N.destroy(),this.N=null)};function Mc(a){var b=a.c||"";a.f&&(b+='; codecs="'+a.f+'"');return b}function Oc(){this.b=Pc++;this.id=null;this.contentType=this.lang="";this.f=!1;this.a=[];this.c=[]}var Pc=0;
Oc.prototype.destroy=function(){for(var a=0;a<this.a.length;++a)this.a[a].destroy();this.c=this.a=null};function Qc(a){for(var b=[],c=0;c<a.c.length;++c){var d=new Rc;d.id=a.b;d.a=a.c[c];d.contentType=a.contentType;d.b=a.a.length?Mc(a.a[0]):"";b.push(d)}return b}function Sc(){this.id=null;this.start=0;this.b=null;this.a=[]}Sc.prototype.destroy=function(){for(var a=0;a<this.a.length;++a)this.a[a].destroy();this.a=null};function Tc(){this.b=!1;this.f=this.h=this.g=null;this.c=0;this.a=[]}
Tc.prototype.destroy=function(){for(var a=0;a<this.a.length;++a)this.a[a].destroy();this.a=null};function Rc(){this.id=0;this.a=null;this.b=this.contentType=""};function Uc(a,b){B.call(this,a);this.b=b;this.g=!0;this.h=this.f=null;this.c=new q;this.a=null}p(Uc,B);Uc.prototype.A=function(){};Uc.prototype.destroy=function(){this.a&&this.b.removeChild(this.a);this.c.destroy();this.u=this.b=this.f=this.h=this.a=this.c=null};k=Uc.prototype;k.ea=function(){return this.f};k.Ba=function(){return this.h};k.Ia=function(){return this.c};k.Ca=function(){return!0};
k.ga=function(a){a.J.create().then(u(this,function(b){if(this.b){if(0==b.length())return Promise.reject(Error("No subtitles URL available."));var c=this.f;this.f=a;this.h=b;b=Gc(b).url.c[0].toString();var d=this.ka();this.a&&(this.fa(!1),this.b.removeChild(this.a));this.a=document.createElement("track");this.b.appendChild(this.a);this.a.src=b;this.fa(d);b=y({type:"adaptation",bubbles:!0,contentType:"text",size:null,bandwidth:a.bandwidth});this.dispatchEvent(b);c||this.c.resolve(0)}}))};k.Ea=function(){};
k.Fa=function(){return!0};k.fa=function(a){this.g=a;this.a&&(this.a.track.mode=a?"showing":"disabled")};k.ka=function(){this.a&&(this.g="showing"==this.a.track.mode);return this.g};function Vc(a,b,c,d,e){B.call(this,a);this.c=b;this.a=new Ta(c,d,e);this.s=this.B=this.b=null;this.C=!1;this.g=null;this.l=!1;this.i=null;this.o=!1;this.h=new q;this.j=this.f=!1;this.v=0;this.D=15;this.w=!1}p(Vc,B);Vc.prototype.A=function(a){null!=a.initialStreamBufferSize&&(this.v=Number(a.initialStreamBufferSize));null!=a.streamBufferSize&&(this.D=Number(a.streamBufferSize));null!=a.segmentRequestTimeout&&(this.a.u=Number(a.segmentRequestTimeout))};
Vc.prototype.destroy=function(){Wc(this);this.h.destroy();this.b=this.h=null;this.a.destroy();this.u=this.c=this.a=null};k=Vc.prototype;k.ea=function(){return this.b};k.Ba=function(){return this.B};k.Ia=function(a){this.f||a.then(function(){this.f=!0;this.g||O(this,0)}.bind(this)).catch(function(){});return this.h};k.Ca=function(){return this.j};
k.ga=function(a,b,c){if(a!=this.b){var d=[a.J.create(),a.N.create()];Promise.all(d).then(u(this,function(d){if(this.c){var f=this.b;this.b=a;this.B=d[0];this.s=d[1];this.C=!0;this.l||(f?b&&Xc(this,!0,c):O(this,0))}})).catch(u(this,function(a){"aborted"!=a.type&&(this.f?(a=z(a),this.dispatchEvent(a)):this.h.reject(a))}))}};k.Ea=function(){return Xc(this,!1)};
function Xc(a,b,c){a.b&&!a.l&&(a.l=!0,Wc(a),Va(a.a).then(u(a,function(){var a=this.c.currentTime;if(!b&&0<Wa(this.a,a)&&0<=ab(this.a.b,a))return Promise.resolve();if(c)return db(this.a,this.c.currentTime+c);this.w=!0;return cb(this.a)})).then(u(a,function(){this.l=!1;O(this,0)})).catch(u(a,function(a){this.l=!1;this.f?(a=z(a),this.dispatchEvent(a)):this.h.reject(a)})))}k.Fa=function(a){return 0<Wa(this.a,a)&&0<=ab(this.a.b,a)};k.fa=function(){};k.ka=function(){return!0};
k.gb=function(){if(this.o&&!this.f)this.g=null;else{var a;if(a=this.f&&!this.j)a=1<this.a.c.buffered.length?!0:!1;if(a)Xc(this,!0);else{this.g=null;a=this.b;var b=this.B,c=this.c.currentTime;Wa(this.a,this.o?c:c+(this.i||0))>=(this.o?Math.max(this.v,this.D):this.v)?(Yc(this),O(this,1E3/(Math.abs(this.c.playbackRate)||1))):(b=Zc(this,c,b))?(b=Xa(this.a,b,a.h,this.s),this.s=null,this.C&&(this.C=!1,$c(this,a)),this.j=!1,b.then(u(this,function(a){null==this.i&&(this.i=a);this.w&&0<Wa(this.a,c)&&(this.w=
!1,this.c.currentTime+=.001);O(this,0)})).catch(u(this,function(a){if("aborted"!=a.type){var b=[0,404,410];"net"==a.type&&-1!=b.indexOf(a.pb.status)&&this.b&&O(this,5E3);a=z(a);this.dispatchEvent(a)}}))):(Yc(this),this.f&&!this.j&&(this.j=!0,ad(this)),O(this,1E3))}}};function Zc(a,b,c){a=a.a;var d=a.b.length;a=0<d?a.b[d-1]:null;return null!=a?null!=a.a?Hc(c,a.a):null:Hc(c,b)||(c.length()?c.X():null)}
function Yc(a){if(!a.o&&null!=a.i){a.o=!0;var b=a.a,c=a.i,d=c-b.o;0!=d&&(b.b=Dc(b.b,d),b.o=c);a.h.resolve(a.i)}}function $c(a,b){var c;c=b.c.split("/")[0];c=y({type:"adaptation",bubbles:!0,contentType:c,size:"video"!=c?null:{width:b.width,height:b.height},bandwidth:b.bandwidth});a.dispatchEvent(c)}function ad(a){var b=y({type:"ended"});a.dispatchEvent(b)}function O(a,b){a.g=window.setTimeout(a.gb.bind(a),b)}function Wc(a){null!=a.g&&(window.clearTimeout(a.g),a.g=null)};function bd(){this.streamStats=null;this.droppedFrames=this.decodedFrames=NaN;this.bufferingTime=this.playTime=this.estimatedBandwidth=0;this.playbackLatency=NaN;this.bufferingHistory=[];this.bandwidthHistory=[];this.streamHistory=[]}function cd(a,b){var c=new dd(b);a.streamHistory.push(new ed(c));if(c.videoHeight||!a.streamStats)a.streamStats=c}function dd(a){this.videoWidth=a.width;this.videoHeight=a.height;this.videoMimeType=a.c;this.videoBandwidth=a.bandwidth}
function ed(a){this.timestamp=(Date.now()+ua)/1E3;this.value=a};function fd(a,b,c,d,e){this.b=new J(null,[new M(a)]);this.a=new Za;this.a.body=b;this.a.method=c;this.a.a=3;this.a.i=d;this.a.c=0;a=e||{};for(var f in a)this.a.b[f]=a[f]}function gd(a){return $a(a.b,a.a).then(function(a){return Promise.resolve(new Uint8Array(a))})};function hd(a,b,c){B.call(this,a);this.c=b;this.j=c;this.a=this.h=null;this.i=new H;this.b=[];this.f=[];this.o=0;this.g=new q;this.l=null}p(hd,B);hd.prototype.destroy=function(){this.u=null;for(var a=0;a<this.f.length;++a)this.f[a].close().catch(function(){});this.f=[];this.b=this.a=this.h=null;this.g.destroy();this.g=null;this.i.destroy();this.i=null;this.l&&(window.clearTimeout(this.l),this.l=null);this.c=this.j=null};
hd.prototype.initialize=function(){var a=new x,b;b=this.j;if(b.w){b=b.a.a[0];for(var c=[],d=0;d<b.a.length;++d)c.push.apply(c,Qc(b.a[d]));b=c}else b=[];for(c=0;c<b.length;++c)d=b[c],d.a.a||d.b&&!id(d.b)||a.push(d.contentType,d);for(var c={},d=!1,e=0;e<b.length;++e){var f=b[e];if(f.a.a&&!a.a.hasOwnProperty(f.contentType)){var g=f.a.a,h=c[g];h||(h=f.a,h={audioCapabilities:void 0,videoCapabilities:void 0,initDataTypes:void 0,distinctiveIdentifier:h.g?"required":"optional",persistentState:h.i?"required":
"optional",sessionTypes:["temporary"]},c[g]=h);if(f.b&&(g=f.contentType+"Capabilities",g in h)){d=!0;h[g]||(h[g]=[]);var l;"audio"==f.contentType?l=f.a.f:"video"==f.contentType&&(l=f.a.l);h[g].push({contentType:f.b,robustness:l})}}}if(!d)if(b.length)this.a=b[0].a;else throw a=Error("No DrmInfo exists!"),a.type="drm",a;if(0==Object.keys(c).length)return jd(this.j,a),this.g.resolve(),Promise.resolve();l=new q;c=kd(c,l);c=c.then(this.Oa.bind(this,b,a));c=c.then(this.lb.bind(this));l.reject(null);return c};
function kd(a,b){for(var c in a)b=b.catch(function(a,b){return navigator.requestMediaKeySystemAccess(a,[b])}.bind(null,c,a[c]));return b}k=hd.prototype;
k.Oa=function(a,b,c){if(!this.c)return ld();for(var d=c.keySystem,e=c.getConfiguration(),f=["audio","video"],g=0;g<f.length;++g){var h=f[g];if(!b.a.hasOwnProperty(h)){var l=e[h+"Capabilities"];if(l&&l.length){for(var l=l[0],n=[],r={},t=0;t<a.length;++t){var C=a[t];if(C.a.a==d&&C.b==l.contentType&&!(C.id in r)){n.push(C);r[C.id]=!0;var A;if(this.a){A=this.a;var C=C.a,D=new wa;D.a=A.a;D.h=A.h;D.j=A.j;D.u=A.u;D.o=A.o;D.g=A.g;D.i=A.i;D.f=A.f;D.l=A.l;D.c=A.c?new Uint8Array(A.c.buffer):null;xa(D,A.b);xa(D,
C.b);A=D}else A=C.a;this.a=A}}b.set(h,n)}}}jd(this.j,b);return c.createMediaKeys()};
k.lb=function(a){if(!this.c)return ld();this.h=a;return this.c.setMediaKeys(this.h).then(u(this,function(){return this.c?this.a.c?this.h.setServerCertificate(this.a.c):Promise.resolve():ld()})).then(u(this,function(){if(!this.c)return ld();for(var a=0;a<this.a.b.length;++a){var c=this.a.b[a];this.Da({type:"encrypted",initDataType:c.initDataType,initData:c.initData})}0==this.a.b.length&&I(this.i,this.c,"encrypted",this.Da.bind(this))}))};
function ld(){var a=Error("EmeManager destroyed");a.type="destroy";return Promise.reject(a)}
k.Da=function(a){for(var b=new Uint8Array(a.initData),c=0;c<this.b.length;++c)if(qa(b,this.b[c].data))return;try{var d=md(this)}catch(e){b=z(e);this.dispatchEvent(b);this.g.reject(e);return}a=d.generateRequest(a.initDataType,a.initData);this.b.push({data:b,na:d});a.catch(u(this,function(a){if(this.c){for(var b=0;b<this.b.length;++b)if(this.b[b].na==d){this.b.splice(b,1);break}b=z(a);this.dispatchEvent(b);this.g.reject(a)}}));this.f.push(d)};
function md(a){var b=null,b=a.h.createSession();I(a.i,b,"message",a.bb.bind(a));I(a.i,b,"keystatuseschange",a.Ra.bind(a));return b}k.bb=function(a){nd(this,a.target,this.a,a.message)};k.Ra=function(a){a=a.target;for(var b=a.keyStatuses,c={},d=b.keys(),e=d.next();!e.done;e=d.next()){var f=pa(new Uint8Array(e.value)),e=b.get(e.value);c[f]=e}if(a.expiration<Date.now()){for(b=0;b<this.b.length;++b)if(this.b[b].na==a){this.b.splice(b,1);break}a.close();this.f.splice(this.f.indexOf(a),1)}od(this.j,c)};
function nd(a,b,c,d){d=pd(c,d);gd(new fd(d.url,d.body,d.method,c.j,d.headers)).then(u(a,function(a){c.u&&(a=c.u(a));return b.update(a)})).then(u(a,function(){var a=y({type:"sessionReady",detail:b});this.dispatchEvent(a);this.o++;this.o>=this.f.length&&this.g.resolve()})).catch(u(a,function(a){a.na=b;a=z(a);this.dispatchEvent(a)}))}
function pd(a,b){var c={url:a.h,body:b.slice(0),method:"POST",headers:{}};if("com.microsoft.playready"===a.a){for(var d=String.fromCharCode.apply(null,new Uint16Array(c.body)),d=(new DOMParser).parseFromString(d,"application/xml"),e=d.getElementsByTagName("name"),f=d.getElementsByTagName("value"),g=0;g<e.length;g++)c.headers[e[g].childNodes[0].nodeValue]=f[g].childNodes[0].nodeValue;c.body=window.atob(d.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue)}if(!a.o)return c;a.o(c);c.url=v(c,
"url");if(null==c.url)throw Error("'url' cannot be null.");if(!(c.body instanceof ArrayBuffer||"string"==typeof c.body||null==c.body))throw new TypeError("'body' must be an ArrayBuffer, a string, or null.");c.method=v(c,"method");if("GET"!=c.method&&"POST"!=c.method)throw Error("'method' must be either 'GET' or 'POST'.");c.headers=w(c,"headers",Object);if(null==c.headers)throw Error("'headers' cannot be null.");return c};function P(a){B.call(this,null);this.a=a;this.b=null;this.f=new H;this.i=this.j=null;this.w=0;this.s=null;this.h=!1;this.g=new bd;this.c={enableAdaptation:!0,streamBufferSize:15,liveStreamEndTimeout:15,licenseRequestTimeout:0,mpdRequestTimeout:0,segmentRequestTimeout:0,preferredLanguage:"en",restrictions:new ca};this.l=1;this.A=null}p(P,B);m("shaka.player.Player",P);P.version="v1.6.1";
P.isBrowserSupported=function(){return!!window.MediaSource&&!!window.MediaKeys&&!!window.navigator&&!!window.navigator.requestMediaKeySystemAccess&&!!window.MediaKeySystemAccess&&!!window.MediaKeySystemAccess.prototype.getConfiguration&&!!window.Promise&&!!Element.prototype.requestFullscreen&&!!document.exitFullscreen&&"fullscreenElement"in document&&!!window.Uint8Array};function id(a){return"text/vtt"==a?!!window.VTTCue:MediaSource.isTypeSupported(a)}P.isTypeSupported=id;
P.setTextStyle=function(a){var b=document.getElementById("ShakaPlayerTextStyle");b||(b=document.createElement("style"),b.id="ShakaPlayerTextStyle",document.head.appendChild(b));for(b=b.sheet;b.cssRules.length;)b.deleteRule(0);b.insertRule("::cue { "+kb(a)+" }",0)};P.prototype.destroy=function(){return this.o().then(u(this,function(){this.f.destroy();this.a=this.f=null})).catch(function(){})};P.prototype.destroy=P.prototype.destroy;
P.prototype.o=function(){if(!this.b)return Promise.resolve();this.h&&qd(this);this.a.pause();Ra(this.f);rd(this);sd(this);this.j&&(this.j.destroy(),this.j=null);this.a.src="";var a=this.a.setMediaKeys(null);this.b&&(this.b.destroy(),this.b=null);this.h=!1;this.g=new bd;return a};P.prototype.unload=P.prototype.o;
P.prototype.Z=function(a){var b=this.o();this.a.autoplay&&(nb("load"),I(this.f,this.a,"timeupdate",this.Qa.bind(this)));a.xa(this.c);a.L=this.A;this.A=null;b=b.then(u(this,function(){return a.$()}));b.catch(u(this,function(b){a.destroy();return Promise.reject(b)}));return b.then(u(this,function(){if(!this.a)return td();this.b=a;I(this.f,this.b,"seekrangechanged",this.$a.bind(this));this.j=new hd(this,this.a,this.b);return this.j.initialize()})).then(u(this,function(){if(!this.a)return td();I(this.f,
this.a,"error",this.mb.bind(this));I(this.f,this.a,"playing",this.Ya.bind(this));I(this.f,this.a,"pause",this.Xa.bind(this));var a;a=this.b;var b=this.a;a.w?(a.u=this,a.f=b,a.A=this.Ga(),I(a.j,a.g,"sourceopen",a.Ta.bind(a)),I(a.j,a.V,"bandwidth",a.nb.bind(a)),b=a.f.mediaKeys,a.f.src=window.URL.createObjectURL(a.g),b=a.f.setMediaKeys(b),a=Promise.all([a.i,b])):(a=Error("Cannot call attach() right now."),a.type="app",a=Promise.reject(a));return a})).then(u(this,function(){if(!this.a)return td();ud(this)})).catch(u(this,
function(a){if(!this.a)return td();if("destroy"!=a.type){var b=z(a);this.dispatchEvent(b)}return this.o().then(function(){return Promise.reject(a)})}))};P.prototype.load=P.prototype.Z;function td(){var a=Error("Player destroyed");a.type="destroy";return Promise.reject(a)}k=P.prototype;k.Qa=function(){qb("load");this.g.playbackLatency=rb("load")/1E3;this.f.ba(this.a,"timeupdate")};
k.mb=function(){if(this.a.error){var a=this.a.error.code;a!=MediaError.MEDIA_ERR_ABORTED&&(a=Error(vd[a]||"Unknown playback error."),a.type="playback",a=z(a),this.dispatchEvent(a))}};k.Ya=function(){nb("playing");!this.i&&0>this.l&&(this.a.playbackRate=0,this.v(this.a.currentTime,Date.now(),this.l));this.h&&qd(this)};k.Xa=function(){qb("playing");var a=rb("playing");if(!isNaN(a)){var b=this.g;b.playTime+=a/1E3}sd(this)};k.$a=function(a){this.w=a.start};
k.Ga=function(){if(!this.a.paused){qb("playing");var a=rb("playing");if(!isNaN(a)){var b=this.g;b.playTime+=a/1E3;nb("playing")}}a=this.g;b=this.a;b.getVideoPlaybackQuality&&(b=b.getVideoPlaybackQuality(),a.decodedFrames=b.totalVideoFrames,a.droppedFrames=b.droppedVideoFrames);return this.g};P.prototype.getStats=P.prototype.Ga;P.prototype.W=function(){return this.b?this.b.D():[]};P.prototype.getVideoTracks=P.prototype.W;P.prototype.T=function(){return this.b?this.b.U():[]};
P.prototype.getAudioTracks=P.prototype.T;P.prototype.V=function(){return this.b?this.b.ya():[]};P.prototype.getTextTracks=P.prototype.V;P.prototype.selectVideoTrack=function(a,b){return this.b?this.b.selectVideoTrack(a,void 0==b?!0:b):!1};P.prototype.selectVideoTrack=P.prototype.selectVideoTrack;P.prototype.$=function(a,b){return this.b?wd(this.b,"audio",a,void 0==b?!0:b):!1};P.prototype.selectAudioTrack=P.prototype.$;P.prototype.aa=function(a){return this.b?wd(this.b,"text",a,!1):!1};
P.prototype.selectTextTrack=P.prototype.aa;P.prototype.S=function(a){this.b&&xd(this.b,a)};P.prototype.enableTextTrack=P.prototype.S;P.prototype.L=function(a){sd(this);0<=a?this.a.playbackRate=a:this.a.paused||(this.a.playbackRate=0,this.v(this.a.currentTime,Date.now(),a));this.l=a};P.prototype.setPlaybackRate=P.prototype.L;P.prototype.C=function(){return this.l};P.prototype.getPlaybackRate=P.prototype.C;P.prototype.ca=function(a){this.A=a};P.prototype.setPlaybackStartTime=P.prototype.ca;
P.prototype.B=function(){var a;this.b?(a=this.b,a=a.a?a.a.b:!1):a=!1;return a};P.prototype.isLive=P.prototype.B;
P.prototype.R=function(a){if(a){var b=ia(a,"enableAdaptation","boolean");null!=b&&(this.c.enableAdaptation=b);b=ha(a,"streamBufferSize");null!=b&&(this.c.streamBufferSize=b);b=ha(a,"liveStreamEndTimeout");null!=b&&(this.c.liveStreamEndTimeout=b);b=ha(a,"licenseRequestTimeout");null!=b&&(this.c.licenseRequestTimeout=b);b=ha(a,"mpdRequestTimeout");null!=b&&(this.c.mpdRequestTimeout=b);b=ha(a,"segmentRequestTimeout");null!=b&&(this.c.segmentRequestTimeout=b);b=v(a,"preferredLanguage");null!=b&&(this.c.preferredLanguage=
b);a=w(a,"restrictions",ca);null!=a&&(this.c.restrictions=a.clone());this.b&&this.b.xa(this.c)}};P.prototype.configure=P.prototype.R;P.prototype.U=function(){return this.c};P.prototype.getConfiguration=P.prototype.U;function sd(a){a.i&&(window.clearTimeout(a.i),a.i=null)}function ud(a){rd(a);a.s=window.setTimeout(a.D.bind(a),100)}function rd(a){a.s&&(window.clearTimeout(a.s),a.s=null)}
P.prototype.v=function(a,b,c){this.i=null;var d=(Date.now()-b)/1E3*c;this.a.currentTime<this.w+(this.B()?1:.05)?this.a.pause():(d=Math.max(this.w,a+d),this.a.currentTime=d,this.i=window.setTimeout(this.v.bind(this,a,b,c),250))};function qd(a){qb("buffering");var b=a.g;b.bufferingTime+=rb("buffering")/1E3;a.h=!1;a.dispatchEvent(y({type:"bufferingEnd"}))}
P.prototype.D=function(){ud(this);if(!this.a.ended&&!this.a.seeking){var a=this.a.buffered,b=a.length?a.end(a.length-1):0,a=Math.max(b-this.a.currentTime,0),c=this.a.duration,c=isNaN(c)?0:Math.max(c-.05,0),b=b>=c||this.a.currentTime>=c;if(this.h){if(c=Number(this.b.B.initialStreamBufferSize),b||a>c)qd(this),this.a.play()}else!this.a.paused&&!b&&.5>a&&(this.h=!0,this.a.pause(),this.g.bufferingHistory.push((Date.now()+ua)/1E3),nb("buffering"),this.dispatchEvent(y({type:"bufferingStart"})))}};
var vd={2:"A network failure occured while loading media content.",3:"The browser failed to decode the media content.",4:"The browser does not support the media content."};function yd(a,b){var c=a.bandwidth||Number.MAX_VALUE,d=b.bandwidth||Number.MAX_VALUE;return c<d?-1:c>d?1:0};function Q(){this.a=this.b=null;this.f=new H;this.c=Number.POSITIVE_INFINITY;this.i=!0;this.g=!1}m("shaka.media.SimpleAbrManager",Q);Q.prototype.destroy=function(){this.f.destroy();this.a=this.b=this.f=null};Q.prototype.initialize=function(a,b){this.b||this.a||(this.b=a,this.a=b)};
Q.prototype.start=function(){this.b&&this.a&&!this.g&&(this.c=Date.now()+4E3,I(this.f,this.b,"bandwidth",this.l.bind(this)),I(this.f,this.a,"adaptation",this.j.bind(this)),I(this.f,this.a,"trackschanged",this.h.bind(this)),this.g=!0)};Q.prototype.enable=function(a){this.i=a};Q.prototype.getInitialVideoTrackId=function(){if(!this.b||!this.a)return null;var a=zd(this);return a?a.id:null};Q.prototype.selectVideoTrack=function(a,b,c){this.g&&this.a.selectVideoTrack(a.id,b,c)};
Q.prototype.l=function(){Date.now()<this.c||this.h()};Q.prototype.h=function(){if(this.i){var a=zd(this);if(a){if(a.active){this.c=Date.now()+3E3;return}this.selectVideoTrack(a,!1)}this.c=Number.POSITIVE_INFINITY}};Q.prototype.j=function(){this.c==Number.POSITIVE_INFINITY&&(this.c=Date.now()+3E4)};
function zd(a){var b=a.a.D();if(0==b.length)return null;b.sort(ea);var c;a:{c=a.a.U();for(var d=0;d<c.length;++d)if(c[d].active){c=c[d];break a}c=null}c=c?c.bandwidth:0;a=a.b.getBandwidth();for(var d=b[0],e=0;e<b.length;++e){var f=b[e],g=e+1<b.length?b[e+1]:{bandwidth:Number.POSITIVE_INFINITY};if(f.bandwidth&&(g=(g.bandwidth+c)/.85,a>=(f.bandwidth+c)/.95&&a<=g&&(d=f,d.active)))break}return d};function R(a,b,c){B.call(this,null);this.a=a;this.V=b;this.j=new H;this.g=new MediaSource;this.f=null;this.ua=0;this.b=new x;this.o=c;this.o.initialize(b,this);this.w=!1;this.v="en";this.W=!1;this.A=null;this.i=new q;this.h=new ca;this.l=null;this.va=1;this.c={};this.S=new q;this.ta=0;this.R=null;this.ca=this.sa=!1;this.s={};this.L=this.C=this.aa=null;this.B={}}p(R,B);m("shaka.player.StreamVideoSource",R);
R.prototype.xa=function(a){null!=a.streamBufferSize&&(this.B.streamBufferSize=a.streamBufferSize);null!=a.segmentRequestTimeout&&(this.B.segmentRequestTimeout=a.segmentRequestTimeout);Ad(this);null!=a.enableAdaptation&&this.o.enable(Boolean(a.enableAdaptation));null!=a.mpdRequestTimeout&&(this.ua=Number(a.mpdRequestTimeout));null!=a.preferredLanguage&&(this.v=Ca(String(a.preferredLanguage)));null!=a.restrictions&&(this.h=a.restrictions,this.w&&Bd(this))};
R.prototype.destroy=function(){this.i.destroy();this.S.destroy();this.S=this.i=null;this.C&&(window.clearTimeout(this.C),this.C=null);this.aa&&(window.clearTimeout(this.aa),this.aa=null);this.s=null;this.j.destroy();this.j=null;ga(this.c).forEach(function(a){a.destroy()});this.b=this.c=null;this.a&&(this.a.destroy(),this.a=null);this.o.destroy();this.u=this.h=this.A=this.f=this.g=this.V=this.o=null};
R.prototype.$=function(){if(this.w){var a=Error("Cannot call load() right now.");a.type="app";return Promise.reject(a)}if(!this.a||0==this.a.a.length)return a=Error("The manifest does not specify any content."),a.type="stream",Promise.reject(a);if(this.a.b)return a=Error("Live manifest support not enabled."),a.type="app",Promise.reject(a);for(var a=this.a.a,b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.a.length;++d){for(var e=c.a[d],f=e,g=0;g<f.a.length;++g)id(Mc(f.a[g]))||(f.a.splice(g,1),--g);0==e.a.length&&
(c.a.splice(d,1),--d)}for(b=0;b<a.length;++b)for(c=a[b],d=0;d<c.a.length;++d)c.a[d].a.sort(yd);if(0==this.a.a.length||0==this.a.a[0].a.length)return a=Error("The manifest specifies content that cannot be displayed on this browser/platform."),a.type="stream",Promise.reject(a);this.w=!0;this.B.initialStreamBufferSize=this.a.c;Ad(this);Bd(this);return Promise.resolve()};
R.prototype.D=function(){if(!this.b.a.hasOwnProperty("video"))return[];for(var a=this.c.video,a=(a=a?a.ea():null)?a.b:0,b=[],c=this.b.get("video"),d=0;d<c.length;++d)for(var e=c[d],f=0;f<e.a.length;++f){var g=e.a[f];if(g.G&&g.a){var h=g.b,g=new da(h,g.bandwidth,g.width,g.height);h==a&&(g.active=!0);b.push(g)}}return b};R.prototype.getVideoTracks=R.prototype.D;
R.prototype.U=function(){if(!this.b.a.hasOwnProperty("audio"))return[];for(var a=this.c.audio,a=(a=a?a.ea():null)?a.b:0,b=[],c=this.b.get("audio"),d=0;d<c.length;++d)for(var e=c[d],f=e.lang,g=0;g<e.a.length;++g){var h=e.a[g];if(h.G&&h.a){var l=h.b,h=new fa(l,h.bandwidth,f);l==a&&(h.active=!0);b.push(h)}}return b};R.prototype.getAudioTracks=R.prototype.U;
R.prototype.ya=function(){if(!this.b.a.hasOwnProperty("text"))return[];for(var a=this.c.text,b=a?a.ea():null,b=b?b.b:0,c=[],d=this.b.get("text"),e=0;e<d.length;++e)for(var f=d[e],g=f.lang,h=0;h<f.a.length;++h){var l=f.a[h].b,n=new ba(l,g);l==b&&(n.active=!0,n.enabled=a.ka());c.push(n)}return c};R.prototype.getTextTracks=R.prototype.ya;
function jd(a,b){if(a.w){for(var c={},d=a.a.a[0],e=0;e<d.a.length;++e){var f=d.a[e];c[f.b]=f}a.b.a={};d=ta(b);for(e=0;e<d.length;++e){var f=d[e],g=b.get(f);if("video"==f){var h=g[0].id;a.b.push(f,c[h])}else if("audio"==f)for(var h=g[0].b.split(";")[0],l=0;l<g.length;++l){var n=g[l];n.b.split(";")[0]==h&&a.b.push(f,c[n.id])}else for(l=0;l<g.length;++l)h=g[l].id,a.b.push(f,c[h])}a.W=!0;if(c=a.b.get("audio"))Cd(a,c),a.b.set("audio",c),c=c[0].lang||a.v,Ba(2,a.v,c)&&(a.W=!1);if(c=a.b.get("text"))Cd(a,
c),a.b.set("text",c),c=c[0].lang||a.v,Ba(2,a.v,c)||(a.W=!1)}}R.prototype.selectVideoTrack=function(a,b,c){return wd(this,"video",a,b,c)};function xd(a,b){var c=a.c.text;c&&c.fa(b)}
function Bd(a){if(a.h){for(var b=!1,c=0;c<a.a.a.length;++c)for(var d=a.a.a[c],e=0;e<d.a.length;++e){var f=d.a[e];if("video"==f.contentType)for(var g=0;g<f.a.length;++g){var h=f.a[g],l=h.a;h.a=!0;a.h.maxWidth&&h.width>a.h.maxWidth&&(h.a=!1);a.h.maxHeight&&h.height>a.h.maxHeight&&(h.a=!1);a.h.minHeight&&h.height<a.h.minHeight&&(h.a=!1);a.h.maxBandwidth&&h.bandwidth>a.h.maxBandwidth&&(h.a=!1);a.h.minBandwidth&&h.bandwidth<a.h.minBandwidth&&(h.a=!1);l!=h.a&&(b=!0)}}0!=ra(a.b).length&&b&&(Dd(a),0<a.D().length||
(b=Error("The application has restricted all video tracks!"),b.type="app",b=z(b),a.dispatchEvent(b)))}}
function od(a,b){for(var c,d=!1,e=new x,f=ra(a.b),g=0;g<f.length;++g)for(var h=f[g],l=0;l<h.a.length;++l){var n=h.a[l];n.g.forEach(function(a){e.push(a,n)})}for(c in b)if(f=la[b[c]]||null,h=e.get(c))for(g=0;g<h.length;++g)n=h[g],l=n.G,n.G=!f,l!=n.G&&(d=!0);else ja(c);d&&(Dd(a),d=a.U(),c=a.D(),d=a.b.a.hasOwnProperty("audio")&&0==d.length,c=a.b.a.hasOwnProperty("video")&&0==c.length,d||c)&&(c=Error("The key system has restricted all "+(d&&c?"audio and video tracks.":d?"audio tracks.":"video tracks.")),
c.type="drm",c=z(c),a.dispatchEvent(c))}function Dd(a){var b=y({type:"trackschanged",bubbles:!0});a.dispatchEvent(b)}function wd(a,b,c,d,e){if(!a.b.a.hasOwnProperty(b)||!a.c[b])return!1;for(var f=a.b.get(b),g=0;g<f.length;++g)for(var h=f[g],l=0;l<h.a.length;++l){var n=h.a[l];if(n.b==c){if(!n.G||!n.a)return!1;if("text"!=b&&!a.ca)return c=a.s[b],a.s[b]={Ja:n,za:null!=c&&c.za||d,Aa:null!=c&&c.Aa||e},!0;cd(a.A,n);a.c[b].ga(n,d,e);return!0}}return!1}
function Cd(a,b){for(var c=0;2>=c;++c)for(var d=0;d<b.length;++d){var e=b[d];if(Ba(c,a.v,e.lang)){b.splice(d,1);b.splice(0,0,e);return}}for(d=0;d<b.length;++d)if(e=b[d],e.f){b.splice(d,1);b.splice(0,0,e);break}}k=R.prototype;k.Ta=function(){this.j.ba(this.g,"sourceopen");Ed(this).then(u(this,function(){this.i&&this.i.resolve()})).catch(u(this,function(a){this.i&&this.i.reject(a)}))};
function Ed(a){for(var b=[],c=["audio","video","text"],d=0;d<c.length;++d){var e=c[d];a.b.a.hasOwnProperty(e)&&b.push(a.b.get(e)[0])}for(var f=Fd(a,b),d=0;d<c.length;++d)if(e=c[d],a.b.a.hasOwnProperty(e)&&!f[e])return a=Error("Unable to select an initial "+e+" stream: all "+e+" streams have been restricted (by the application or by the key system)."),a.type="stream",Promise.reject(a);b=ga(f).map(function(a){return a.J.create()});return Promise.all(b).then(u(a,function(a){if(!a.every(function(a){return a.length()}))return a=
Error("Some streams are not available."),a.type="stream",Promise.reject(a);a=Gd(this,a);if(!a)return a=Error("Some streams are not available."),a.type="stream",Promise.reject(a);if(!Hd(this,f))return a=Error("Failed to create Stream objects."),a.type="stream",Promise.reject(a);this.o.start();Id(this,f,a);return Promise.resolve()})).catch(u(a,function(a){if("aborted"!=a.type)return Object.keys(this.c),this.a.b?(Date.now()+ua<this.a.f?this.rb():this.Na(0),Promise.resolve()):Promise.reject(a)}))}
function Fd(a,b){for(var c={},d=0;d<b.length;++d){var e=b[d],f=null;if("video"==e.contentType){var g=a.o.getInitialVideoTrackId();if(null==g)continue;f=e.a.filter(function(a){return a.b==g});if(0==f.length)continue;f=f[0]}else if("audio"==e.contentType){f=e.a.filter(function(a){return a.G&&a.a});if(0==f.length)continue;f=e.a[Math.floor(f.length/2)]}else 0<e.a.length&&(f=e.a[0]);c[e.contentType]=f}return c}
function Hd(a,b){var c={},d;for(d in b){var e=b[d],e="text"==d?new Uc(a,a.f):Jd(a,e);if(!e)return ga(c).forEach(function(a){a.destroy()}),!1;c[d]=e}a.c=c;return!0}function Jd(a,b){var c=new Vc(a,a.f,a.g,Mc(b),a.V);c.A(a.B);return c}
function Id(a,b,c){a.va=a.f.playbackRate;a.f.playbackRate=0;Kd(a,c);var d;a.L&&a.L<=c.end&&a.L>=c.start?d=a.L:a.a.b?(d=c.end,a.sa=!0):d=c.start;I(a.j,a.f,"seeking",a.ab.bind(a));a.f.currentTime!=d&&(a.f.currentTime=d,a.l=d);Ld(a,c.start,c.end);c=[];for(var e in a.c){d=a.c[e];c.push(d.Ia(a.S));I(a.j,d,"ended",a.cb.bind(a));var f=b[e];cd(a.A,f);d.ga(f,!1)}Promise.all(c).then(a.Pa.bind(a)).catch(u(a,function(a){"destroy"!=a.type&&(a=z(a),this.dispatchEvent(a))}));xd(a,a.W)}
k.Pa=function(a){va(a&&a.length==Object.keys(this.c).length);for(var b=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,d=0;d<a.length;++d)var e=a[d],b=Math.min(b,e),c=Math.max(c,e);a=Md(this);for(d=0;d<a.length;++d)Ic(a[d],c);Nd(this,a,c);d=ra(this.b).map(function(a){return a.a}).reduce(function(a,b){return a.concat(b)},[]).map(function(a){var b=[a.J.create()];a.N&&b.push(a.N.create());return Promise.all(b)});Promise.all(d).then(u(this,function(a){for(var b=0;b<a.length;++b)Ic(a[b][0],c);this.ca=
!0;for(var d in this.s)a=this.s[d],b=this.c[d],cd(this.A,a.Ja),b.ga(a.Ja,a.za,a.Aa);this.s={}})).catch(u(this,function(a){"aborted"!=a.type&&(a=z(a),this.dispatchEvent(a))}))};function Nd(a,b,c){if(b=Gd(a,b))Kd(a,b),Ld(a,b.start,b.end);0!=c&&(c=a.f.currentTime+c,a.f.currentTime=c,a.l=c);a.sa&&b&&(a.f.currentTime=b.end);a.f.playbackRate=a.va;a.a.b&&null!=a.a.g&&a.Na(0);Od(a);a.S.resolve()}
function Kd(a,b){if(a.a.b)isNaN(a.g.duration)&&(a.g.duration=b.end+2592E3);else if(isNaN(a.g.duration)||b.end>a.g.duration){a.g.duration=b.end;for(var c=0;c<a.g.sourceBuffers.length;++c)a.g.sourceBuffers[c].appendWindowEnd=b.end}}k.fb=function(){this.C=null;Od(this);var a=Gd(this,Md(this));a&&(this.a.b&&this.ta!=a.X&&(this.ta=a.X,null!=this.R&&(window.clearTimeout(this.R),this.R=null)),Ld(this,a.start,a.end),this.f.paused||Pd(this,this.f.currentTime,a.start,a.end))};
function Ld(a,b,c){b=y({type:"seekrangechanged",bubbles:!0,start:b,end:c});a.dispatchEvent(b)}k.ab=function(){var a=this.f.currentTime;if(null!=this.l){if(a>=this.l-.01&&a<=this.l+.01){this.l=null;return}this.l=null}var b=Gd(this,Md(this));if(b){var c=b.end;(b=Pd(this,a,b.start,c))||(a<=c+.01?b=!1:(this.f.currentTime=c,b=!0));if(!b)for(var d in this.c)this.c[d].Ea()}};
function Pd(a,b,c,d){if(b>=c-.01)return!1;b=0;if(a.a.b){b=.5;for(var e in a.c)if(!a.c[e].Fa(c+b)){b=a.a.c;break}}a.f.currentTime=Math.min(c+b,d);return!0}k.cb=function(){if(!this.a.b){for(var a in this.c)if(!this.c[a].Ca())return;this.R=null;this.g.endOfStream()}};k.nb=function(){var a=this.A,b=this.V.getBandwidth();a.estimatedBandwidth=b;a.bandwidthHistory.push(new ed(b))};function Md(a){return ga(a.c).map(function(a){return a.Ba()}).filter(function(a){return null!=a})}
function Gd(a,b){for(var c=0,d=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,f=0;f<b.length;++f){var g;g=b[f];g=0<g.length()?{start:Gc(g).b,end:g.X().a}:{start:0,end:0};c=Math.max(c,g.start);null!=g.end&&(d=Math.min(d,g.end));b[f].length()&&(e=Math.min(e,b[f].X().a))}if(d==Number.POSITIVE_INFINITY)if(d=a.a.a[0],d.b)d=(d.start||0)+d.b;else return null;a.a.b&&(d=Math.max(d-a.a.c,c));return c>d?null:{start:c,end:d,X:e}}function Od(a){a.a.b&&(a.C=window.setTimeout(a.fb.bind(a),1E3))}
function Ad(a){for(var b in a.c)a.c[b].A(a.B)};function Qd(a,b,c,d,e,f,g){this.f=c;this.a=d;this.c=e;this.b=null;this.g=g}Qd.prototype.destroy=function(){this.g=null;this.a.f();this.a=null;this.c&&(this.c.f(),this.c=null);this.b=null};
Qd.prototype.create=function(){if("webm"==this.f){var a=Error("WebM is not supported in this build configuration.");a.type="app";return Promise.reject(a)}if(this.b)return this.b;a=[$a(this.a)];"webm"==this.f&&a.push($a(this.c));return this.b=Promise.all(a).then(u(this,function(a){a=a[0];var c=null;"mp4"==this.f&&(c=(new Ec).parse(new DataView(a),this.a.h,this.a.c,this.g));return c?Promise.resolve(new Fc(c)):(a=Error("Failed to parse SegmentReferences from "+this.a.toString()+" (or one of its fallbacks)."),
a.type="stream",Promise.reject(a))}))};function Rd(){this.id=this.url=null;this.type="static";this.b=this.j=this.m=null;this.g=5;this.i=this.c=this.f=null;this.h=1;this.a=[]}function Sd(){this.g=this.f=this.c=this.m=this.b=this.start=this.id=null;this.a=[]}function Td(){this.i=this.b=this.height=this.width=this.contentType=this.lang=this.group=this.id=null;this.c=!1;this.h=this.g=this.f=this.m=null;this.j=[];this.a=[]}function Ud(){this.value=null}function Vd(){this.contentType=this.lang=this.id=null}
function Wd(){this.g=this.f=this.c=this.m=this.h=this.b=this.height=this.width=this.bandwidth=this.lang=this.id=null;this.a=[]}function Yd(){this.b=this.a=this.c=this.f=null}function Zd(){this.parsedPssh=this.psshBox=null}function $d(){this.url=null}function ae(){this.url=null}function be(){this.m=null;this.g=1;this.c=this.b=this.a=this.f=null}be.prototype.clone=function(){var a=new be;a.m=ce(this.m);a.g=this.g;a.f=this.f;a.a=S(this.a);a.b=S(this.b);a.c=S(this.c);return a};
function de(){this.a=this.url=null}de.prototype.clone=function(){var a=new de;a.url=ce(this.url);a.a=S(this.a);return a};function ee(){this.a=this.url=null}ee.prototype.clone=function(){var a=new ee;a.url=ce(this.url);a.a=S(this.a);return a};function fe(){this.m=null;this.b=1;this.g=this.a=null;this.h=1;this.f=null;this.c=[];this.i=null}fe.prototype.clone=function(){var a=new fe;a.m=ce(this.m);a.b=this.b;a.a=this.a;a.g=this.g;a.h=this.h;a.f=S(this.f);a.c=ce(this.c)||[];a.i=S(this.i);return a};
function ge(){this.a=this.b=null}ge.prototype.clone=function(){var a=new ge;a.b=ce(this.b);a.a=S(this.a);return a};function he(){this.c=1;this.i=this.a=null;this.b=1;this.l=!1;this.j=this.g=this.f=this.h=null}he.prototype.clone=function(){var a=new he;a.c=this.c;a.a=this.a;a.i=this.i;a.b=this.b;a.l=this.l;a.h=this.h;a.f=this.f;a.g=this.g;a.j=S(this.j);return a};function ie(){this.a=[]}ie.prototype.clone=function(){var a=new ie;a.a=ce(this.a)||[];return a};function je(){this.b=this.a=this.c=null}
je.prototype.clone=function(){var a=new je;a.c=this.c;a.a=this.a;a.b=this.b;return a};function ke(a,b){this.da=a;this.end=b}ke.prototype.clone=function(){return new ke(this.da,this.end)};Rd.TAG_NAME="MPD";Sd.TAG_NAME="Period";Td.TAG_NAME="AdaptationSet";Ud.TAG_NAME="Role";Vd.TAG_NAME="ContentComponent";Wd.TAG_NAME="Representation";Yd.TAG_NAME="ContentProtection";Zd.TAG_NAME="cenc:pssh";$d.TAG_NAME="BaseURL";ae.TAG_NAME="Location";be.TAG_NAME="SegmentBase";de.TAG_NAME="RepresentationIndex";
ee.TAG_NAME="Initialization";fe.TAG_NAME="SegmentList";ge.TAG_NAME="SegmentURL";he.TAG_NAME="SegmentTemplate";ie.TAG_NAME="SegmentTimeline";je.TAG_NAME="S";
Rd.prototype.parse=function(a,b){this.url=a.m;this.id=T(b,"id",U);this.type=T(b,"type",U)||"static";this.b=T(b,"mediaPresentationDuration",le);this.g=T(b,"minBufferTime",le,this.g);this.f=T(b,"minimumUpdatePeriod",le,this.f);this.c=T(b,"availabilityStartTime",me,this.c);this.i=T(b,"timeShiftBufferDepth",le,this.i);this.h=T(b,"suggestedPresentationDelay",le,this.h);var c=a.m,d=V(this,b,$d);this.m=ne(c,d);if(d=W(this,b,ae))this.j=oe(c,d.url);this.a=V(this,b,Sd)};
Sd.prototype.parse=function(a,b){this.id=T(b,"id",U);this.start=T(b,"start",le);this.b=T(b,"duration",le);var c=V(this,b,$d);this.m=ne(a.m,c);this.c=W(this,b,be);this.f=W(this,b,fe);this.g=W(this,b,he);this.a=V(this,b,Td);pe(this)};function pe(a){for(var b=[],c=0;c<a.a.length;++c){var d=a.a[c];null!=d.group&&(b[d.group]=!0)}for(c=0;c<a.a.length;++c)if(d=a.a[c],null==d.group){for(var e=1;1==b[e];)++e;b[e]=!0;d.group=e}}
Td.prototype.parse=function(a,b){var c=W(this,b,Vd)||{},d=W(this,b,Ud);this.id=T(b,"id",U);this.group=T(b,"group",X);this.lang=T(b,"lang",U,c.lang);this.contentType=T(b,"contentType",U,c.contentType);this.width=T(b,"width",Y);this.height=T(b,"height",Y);this.b=T(b,"mimeType",U);this.i=T(b,"codecs",U);this.c=d&&"main"==d.value;this.lang&&(this.lang=Ca(this.lang));c=V(this,b,$d);this.m=ne(a.m,c);this.j=V(this,b,Yd);!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]);this.f=a.c?qe(this,
b,a.c):W(this,b,be);this.g=a.f?qe(this,b,a.f):W(this,b,fe);this.h=a.g?qe(this,b,a.g):W(this,b,he);this.a=V(this,b,Wd);!this.b&&this.a.length&&(this.b=this.a[0].b,!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]))};Ud.prototype.parse=function(a,b){this.value=T(b,"value",U)};Vd.prototype.parse=function(a,b){this.id=T(b,"id",U);this.lang=T(b,"lang",U);this.contentType=T(b,"contentType",U);this.lang&&(this.lang=Ca(this.lang))};
Wd.prototype.parse=function(a,b){this.id=T(b,"id",U);this.bandwidth=T(b,"bandwidth",Y);this.width=T(b,"width",Y,a.width);this.height=T(b,"height",Y,a.height);this.b=T(b,"mimeType",U,a.b);this.h=T(b,"codecs",U,a.i);this.lang=a.lang;var c=V(this,b,$d);this.m=ne(a.m,c);this.a=V(this,b,Yd);this.c=a.f?qe(this,b,a.f):W(this,b,be);this.f=a.g?qe(this,b,a.g):W(this,b,fe);this.g=a.h?qe(this,b,a.h):W(this,b,he);this.a=this.a.concat(a.j)};
Yd.prototype.parse=function(a,b){this.f=b;this.c=T(b,"schemeIdUri",U);var c=T(b,"cenc:default_KID",U);c&&(this.b=c.replace(/[-]/g,""));this.a=W(this,b,Zd)};Zd.prototype.parse=function(a,b){var c=re(b);if(c){this.psshBox=oa(c);try{this.parsedPssh=new mb(this.psshBox)}catch(d){if(!(d instanceof RangeError))throw d;}}};$d.prototype.parse=function(a,b){this.url=re(b)};ae.prototype.parse=function(a,b){this.url=re(b)};
be.prototype.parse=function(a,b){this.m=a.m||this.m;this.g=T(b,"timescale",Y,this.g);this.f=T(b,"presentationTimeOffset",X,this.f);this.a=T(b,"indexRange",se,this.a);this.b=W(this,b,de)||this.b;this.c=W(this,b,ee)||this.c};de.prototype.parse=function(a,b){var c=T(b,"sourceURL",U);this.url=oe(a.m,c);this.a=T(b,"range",se,S(a.a))};ee.prototype.parse=function(a,b){var c=T(b,"sourceURL",U);this.url=oe(a.m,c);this.a=T(b,"range",se)};
fe.prototype.parse=function(a,b){this.m=a.m||this.m;this.b=T(b,"timescale",Y,this.b);this.a=T(b,"presentationTimeOffset",X,this.a);this.g=T(b,"duration",Y,this.g);var c=T(b,"startNumber",X,this.h);null!=c&&(this.h=0<c?c:1);this.f=W(this,b,ee)||this.f;this.c=(c=V(this,b,ge))&&0<c.length?c:this.c;this.i=W(this,b,ie)||this.i};ge.prototype.parse=function(a,b){var c=T(b,"media",U);this.b=oe(a.m,c);this.a=T(b,"mediaRange",se)};
he.prototype.parse=function(a,b){this.c=T(b,"timescale",Y,this.c);this.a=T(b,"presentationTimeOffset",X,this.a);this.i=T(b,"duration",Y,this.i);var c=T(b,"startNumber",X,this.b);null!=c&&(0<c?this.b=c:(this.b=1,this.l=!0));this.h=T(b,"media",U,this.h);this.f=T(b,"index",U,this.f);this.g=T(b,"initialization",U,this.g);this.j=W(this,b,ie)||this.j};ie.prototype.parse=function(a,b){this.a=V(this,b,je)};je.prototype.parse=function(a,b){this.c=T(b,"t",X);this.a=T(b,"d",X);this.b=T(b,"r",te)};
function ne(a,b){if(!b||0===b.length)return a;for(var c=[],d=0;d<b.length;d++){var e=b[d].url;null==a||0===a.length?c.push(new M(e)):(e=oe(a.slice(0,1),e),c.push(e[0]))}return c}function oe(a,b){if(!b)return a;var c=new M(b);return a?a.map(function(a){return a.resolve(c)}):[c]}function qe(a,b,c){var d=S(c);(b=ue(b,c.constructor.TAG_NAME))&&d.parse(a,b);return d}function W(a,b,c){var d=null;if(b=ue(b,c.TAG_NAME))d=new c,d.parse(a,b);return d}
function ue(a,b){for(var c=null,d=0;d<a.childNodes.length;d++)if(a.childNodes[d].tagName==b){if(c)return null;c=a.childNodes[d]}return c}function V(a,b,c){for(var d=[],e=0;e<b.childNodes.length;e++)if(b.childNodes[e].tagName==c.TAG_NAME){var f=new c;f.parse.call(f,a,b.childNodes[e]);d.push(f)}return d}function re(a){a=a.firstChild;return a.nodeType!=Node.TEXT_NODE?null:a.nodeValue}function ce(a){return a?a.map(function(a){return a.clone()}):null}function S(a){return a?a.clone():null}
function T(a,b,c,d){a=c(a.getAttribute(b));return null!=a?a:void 0!==d?d:null}function me(a){if(!a)return null;a=Date.parse(a);return isNaN(a)?null:Math.floor(a/1E3)}
function le(a){if(!a)return null;var b=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(a);if(!b)return null;a=0;var c=X(b[1]);c&&(a+=31536E3*c);(c=X(b[2]))&&(a+=2592E3*c);(c=X(b[3]))&&(a+=86400*c);(c=X(b[4]))&&(a+=3600*c);(c=X(b[5]))&&(a+=60*c);b=window.parseFloat(b[6]);(b=isNaN(b)?null:b)&&(a+=b);return a}
function se(a){var b=/([0-9]+)-([0-9]+)/.exec(a);if(!b)return null;a=X(b[1]);if(null==a)return null;b=X(b[2]);return null==b?null:new ke(a,b)}function te(a){a=window.parseInt(a,10);return isNaN(a)?null:a}function Y(a){a=window.parseInt(a,10);return 0<a?a:null}function X(a){a=window.parseInt(a,10);return 0<=a?a:null}function U(a){return a};function ve(a,b){this.a=new Za;this.a.f="text";this.a.a=3;this.a.c=1E3*(null!=b?b:0);this.a.g=!0;this.b=a}function we(a){var b=a.b;return $a(b,a.a).then(function(a){var d;d=b.c;d=(a=(new DOMParser).parseFromString(a,"text/xml"))?W({m:d},a,Rd):null;if(d)return Promise.resolve(d);d=Error("MPD parse failure.");d.type="dash";return Promise.reject(d)})};function xe(a){this.a=a}
function ye(a){if(a.a.length){null==a.a[0].start&&(a.a[0].start=0);var b=function(a){return 0==a||!!a};"dynamic"==a.type&&(a.b=null);b(a.b)&&1==a.a.length&&!b(a.a[0].b)&&(a.a[0].b=a.b);for(var c=0,d=!0,e=0;e<a.a.length;++e){var f=a.a[e-1],g=a.a[e],h=a.a[e+1]||{start:a.b};!b(g.start)&&f&&b(f.start)&&b(f.b)&&(g.start=f.start+f.b);!b(g.b)&&b(h.start)&&(g.b=h.start-g.start);null!=g.start&&null!=g.b?c+=g.b:d=!1}b(a.b)||(e=a.a[a.a.length-1],d?a.b=c:b(e.start)&&b(e.b)?a.b=e.start+e.b:"dynamic"!=a.type&&
(a.b=c))}}function ze(a,b,c){var d=new Sc;d.id=b.id;d.start=b.start;d.b=b.b;var e=new x;b.a.forEach(function(a){e.push(a.contentType||"",a)});b=ta(e);for(var f=0;f<b.length;++f){var g=new x;e.get(b[f]).forEach(function(a){g.push(a.group,a)});for(var h=ta(g),l=0;l<h.length;++l){var n=new x;g.get(h[l]).forEach(function(a){n.push(a.lang,a)});for(var r=ta(n),t=0;t<r.length;++t){var C=n.get(r[t]),C=Ae(a,C,c);d.a.push(C)}}}return d}
function Ae(a,b,c){va(b.every(function(a){return a.group==b[0].group&&(a.lang||"")==(b[0].lang||"")&&(a.contentType||"")==(b[0].contentType||"")}));var d=new Oc,e=b.filter(function(a){return null!=a.id});e.length==b.length&&(d.id=e.map(function(a){return a.id}).sort().reduce(function(a,b){return a+","+b}));d.lang=b[0].lang||"";d.contentType=b[0].contentType||"";d.f=b.some(function(a){return a.c});for(var e={},f=0;f<b.length;++f)for(var g=b[f],h=0;h<g.a.length;++h){var l=g.a[h],n=Be(a,l),r=d.c.slice(0);
Ce(n,r);0==r.length&&0<d.c.length||!(l=De(l,c))||(d.a.push(l),d.c=r,e[l.b]=g)}if(d.c.some(function(a){return""==a.a}))return d.a.forEach(function(a){a.G=!0}),d;a=Ee(b);for(f=0;f<d.a.length;++f)l=d.a[f],g=e[l.b],g==a&&(l.G=!0);return d}function Ee(a){for(var b=null,c=null,d=0;d<a.length;++d)for(var e=a[d],f=0;f<e.a.length;++f){var g=e.a[f],g=(g.width||1)*(g.height||1)*(g.bandwidth||1);if(null==b||g<b)b=g,c=e}return c}
function Ce(a,b){if(0==b.length)Array.prototype.push.apply(b,a);else for(var c=0;c<b.length;++c){for(var d=!1,e=0;e<a.length;++e){var f=b[c],g=a[e];if(f.a==g.a&&f.h==g.h&&f.j==g.j&&f.g==g.g&&f.i==g.i&&f.f==g.f&&f.l==g.l&&qa(f.c,g.c)){d=!0;xa(b[c],a[e].b);break}}d||(b.splice(c,1),--c)}}function Be(a,b){var c=[];if(0==b.a.length)c.push(new wa);else if(a.a)for(var d=0;d<b.a.length;++d)c.push.apply(c,Fe(a,b.a[d]));return c}
function Fe(a,b){var c=[];if(2!=a.a.length)return[];var d=a.a(b.c||"",b.f);if(!(d&&d instanceof Array))return[];for(var e=0;e<d.length;++e){var f;var g=d[e];f=new wa;if(g){var h=v(g,"keySystem");if(null!=h)f.a=h;else throw Error("'keySystem' cannot be null.");var l=v(g,"licenseServerUrl");if(null!=l)f.h=l;else if(h)throw Error("For encrypted streaming content, 'licenseServerUrl' cannot be null or empty.");h=ia(g,"withCredentials","boolean");null!=h&&(f.j=h);h=w(g,"licensePostProcessor",Function);
null!=h&&(f.u=h);h=w(g,"licensePreProcessor",Function);null!=h&&(f.o=h);h=ia(g,"distinctiveIdentifierRequired","boolean");null!=h&&(f.g=h);h=ia(g,"persistentStateRequired","boolean");null!=h&&(f.i=h);h=v(g,"audioRobustness");null!=h&&(f.f=h);h=v(g,"videoRobustness");null!=h&&(f.l=h);h=w(g,"serverCertificate",Uint8Array);null!=h&&(f.c=h);if(h=w(g,"initData",Object)){g=w(h,"initData",Uint8Array);if(null==g)throw Error("'initData.initData' cannot be null.");h=v(h,"initDataType");if(null==h)throw Error("'initData.initDataType' cannot be null.");
f.b.push({initData:new Uint8Array(g.buffer),initDataType:h})}}0==f.b.length&&b.a&&b.a.psshBox&&xa(f,[{initData:b.a.psshBox,initDataType:"cenc"}]);c.push(f)}return c}
function De(a,b){if(!a.m||0===a.m.length)return null;var c=null,d=1,e=0;a.c?(c=a.b.split("/")[1],"mp4"!=c&&"webm"!=c?c=null:(d=a.c,"webm"!=c||d.c?d.a||d.b&&d.b.a?(e=d.b,e||(e=new de,e.url=a.m,e.a=d.a?d.a.clone():null),e=Ge(e,b),d=d.c?Ge(d.c,b):null,c=new Qd(0,0,c,e,d,0,b),d=new Bc(d),e=new Kc,e.J=c,e.N=d,c=e):c=null:c=null),d=a.c.g,e=a.c.f):a.f?(c=null,d=a.f.b,e=a.f.a):a.g?(c=null,d=a.g.c,e=a.g.a):"text"==a.b.split("/")[0]&&(c=new Kc,c.J=new Jc(new J(b,a.m)));if(!c)return null;c.id=a.id;e&&(c.h=-1*
e/d);c.bandwidth=a.bandwidth;c.width=a.width;c.height=a.height;c.c=a.b||"";c.f=a.h||"";for(d=0;d<a.a.length;++d)e=a.a[d],e.b&&c.g.push(e.b);return c}function Ge(a,b){var c=a.url,d=0,e=null;a.a&&(d=a.a.da,e=a.a.end);return new J(b,c,d,e)};function Z(a,b,c,d){c||(c=new E);d||(d=new Q);R.call(this,null,c,d);this.Ka=a;this.wa=b;this.Z=[];this.qa=[];this.ra=[];this.T=null}p(Z,R);m("shaka.player.DashVideoSource",Z);Z.prototype.La=function(a,b,c){this.Z.push(a);this.qa.push(b||"");this.ra.push(c||"")};Z.prototype.addExternalCaptions=Z.prototype.La;Z.prototype.Ma=function(a){this.T=a};Z.prototype.setNetworkCallback=Z.prototype.Ma;Z.prototype.destroy=function(){this.T=this.wa=null;R.prototype.destroy.call(this)};
Z.prototype.$=function(){var a=new J(this.T,[new M(this.Ka)]);return we(new ve(a,this.ua)).then(u(this,function(a){for(var c=0;c<this.Z.length;c++){var d=a,e=this.Z[c],f=this.qa[c],g=this.ra[c];if(0!==d.a.length){var h=new Td;h.contentType="text";h.lang=f||"en";h.c=!0;f=new Wd;f.bandwidth=0;f.b=g||"text/vtt";f.m=[new M(e)];h.a.push(f);d.a[0].a.push(h);pe(d.a[0])}}if("dynamic"==a.type)return a=Error("Live manifest support not enabled."),a.type="app",Promise.reject(a);c=new xe(this.wa);d=this.T;e=(Date.now()+
ua)/1E3;for(g=0;g<a.a.length;++g)for(h=a.a[g],f=0;f<h.a.length;++f){var l=h.a[f];if("text"!=l.contentType)for(var n=0;n<l.a.length;++n){var r=l.a[n],t=0,t=t+(r.c?1:0),t=t+(r.f?1:0),t=t+(r.g?1:0);0==t?(l.a.splice(n,1),--n):1!=t&&(r.c?(r.f=null,r.g=null):r.f&&(r.g=null))}}ye(a);for(g=0;g<a.a.length;++g)for(h=a.a[g],f=0;f<h.a.length;++f){n=l=h.a[f];r=null;for(t=0;t<n.a.length;++t){var C=n.a[t].b||"";r?C!=r&&(n.a.splice(t,1),--t):r=C}0==l.a.length&&(h.a.splice(f,1),--f)}"dynamic"==a.type&&null==a.c&&
(a.c=e);e=new Tc;"dynamic"==a.type&&(e.b=!0,e.g=a.f,e.h=new J(d,a.j||a.url),e.f=a.c);e.c=a.g||5;for(g=0;g<a.a.length;++g){h=a.a[g];if(null==h.start)break;h=ze(c,h,d);e.a.push(h)}this.a=e;return R.prototype.$.call(this)}))};}.bind(g,this))();
if (typeof(module)!="undefined"&&module.exports)module.exports=g.shaka;
else if (typeof(define)!="undefined" && define.amd)define(function(){return g.shaka});
else this.shaka=g.shaka;
})();

