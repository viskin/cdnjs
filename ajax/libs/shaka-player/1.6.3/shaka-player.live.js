(function(){var g={};
(function(window){var k,aa=this;function n(a,b){var c=a.split("."),d=aa;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d[e]?d=d[e]:d=d[e]={}:d[e]=b}function p(a,b){function c(){}c.prototype=b.prototype;a.Hb=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Gb=function(a,c,f){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2))}};/*

 Copyright 2015 Google Inc.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
function ba(a,b){this.id=a;this.lang=b||"unknown";this.enabled=this.active=!1}n("shaka.player.TextTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:0});function ca(){this.minBandwidth=this.maxBandwidth=this.maxWidth=this.minHeight=this.maxHeight=null}ca.prototype.clone=function(){var a=new ca;a.maxHeight=this.maxHeight;a.minHeight=this.minHeight;a.maxWidth=this.maxWidth;a.maxBandwidth=this.maxBandwidth;a.minBandwidth=this.minBandwidth;return a};function da(a,b,c,d){this.id=a;this.bandwidth=b||0;this.width=c||0;this.height=d||0;this.active=!1}function ea(a,b){var c=a.width*a.height,d=b.width*b.height;return c<d?-1:c>d?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0}n("shaka.player.VideoTrack.compare",ea);function fa(a,b,c){this.id=a;this.bandwidth=b||0;this.lang=c||"unknown";this.active=!1}n("shaka.player.AudioTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0});function r(){var a,b,c=new Promise(function(c,e){a=c;b=e});c.resolve=a;c.reject=b;c.destroy=r.prototype.destroy;return c}r.prototype.destroy=function(){this.catch(function(){});var a=Error("Destroyed!");a.type="destroy";this.reject(a)};function t(a,b){return b.bind(a)};function ga(a){return Object.keys(a).map(function(b){return a[b]})}function ha(a,b){return ia(a,b,"boolean")}function ja(a,b){var c=ia(a,b,"number");if(null==c)return null;if(isNaN(c)||c==Number.NEGATIVE_INFINITY||c==Number.POSITIVE_INFINITY)throw new RangeError("'"+b+"' must be finite.");if(0>c)throw new RangeError("'"+b+"' must be >= 0");return c}function v(a,b){return ia(a,b,"string")}
function ia(a,b,c){a=a[b];if(null==a)return null;if(typeof a!=c)throw new TypeError("'"+b+"' must be a "+c+".");return a}function ka(a,b,c){a=a[b];if(null==a)return null;if(!(a instanceof c))throw new TypeError("'"+b+"' must be an instance of "+c.name+".");return a};function la(a){a.split("").reduce(function(a,c,d){return a+(d&&0==d%4?" "+c:c)})};function ma(a,b){for(var c=[],d=0;d<a.length;++d){for(var e=!1,f=0;f<c.length&&!(e=b?b(a[d],c[f]):a[d]===c[f]);++f);e||c.push(a[d])}return c};var na={"output-restricted":"The required output protection is not available.","output-not-allowed":"The required output protection is not available.",expired:"The decryption key has expired.","internal-error":"The key system has encountered an unspecified error."};function oa(a){return String.fromCharCode.apply(null,a)}n("shaka.util.Uint8ArrayUtils.toString",oa);function pa(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;++c)b[c]=a.charCodeAt(c);return b}n("shaka.util.Uint8ArrayUtils.fromString",pa);n("shaka.util.Uint8ArrayUtils.toBase64",function(a,b){var c=void 0==b?!0:b,d=window.btoa(oa(a)).replace(/\+/g,"-").replace(/\//g,"_");return c?d:d.replace(/=*$/,"")});function qa(a){return pa(window.atob(a.replace(/-/g,"+").replace(/_/g,"/")))}
n("shaka.util.Uint8ArrayUtils.fromBase64",qa);n("shaka.util.Uint8ArrayUtils.fromHex",function(a){for(var b=new Uint8Array(a.length/2),c=0;c<a.length;c+=2)b[c/2]=window.parseInt(a.substr(c,2),16);return b});function ra(a){for(var b="",c=0;c<a.length;++c){var d=a[c].toString(16);1==d.length&&(d="0"+d);b+=d}return b}n("shaka.util.Uint8ArrayUtils.toHex",ra);function sa(a,b){if(!a&&!b)return!0;if(!a||!b||a.length!=b.length)return!1;for(var c=0;c<a.length;++c)if(a[c]!=b[c])return!1;return!0};function w(){this.a={}}w.prototype.push=function(a,b){this.a.hasOwnProperty(a)?this.a[a].push(b):this.a[a]=[b]};w.prototype.set=function(a,b){this.a[a]=b};w.prototype.get=function(a){return(a=this.a[a])?a.slice():null};function ta(a){var b=[],c;for(c in a.a)b.push.apply(b,a.a[c]);return b}function ua(a,b,c){if(a=a.a[b])for(b=0;b<a.length;++b)a[b]==c&&(a.splice(b,1),--b)}function y(a){var b=[],c;for(c in a.a)b.push(c);return b};function z(){return Date.now()+va}var va=0;function wa(){};function xa(){this.h=this.a="";this.j=!1;this.u=this.o=null;this.i=this.g=!1;this.l=this.f="";this.c=null;this.b=[]}function ya(a,b){var c=a.b.concat(b.map(function(a){return{initData:new Uint8Array(a.initData.buffer),initDataType:a.initDataType}}));a.b=ma(c,za)}function za(a,b){return a.initDataType==b.initDataType&&sa(a.initData,b.initData)};function Aa(a){this.c=Math.exp(Math.log(.5)/a);this.a=this.b=0}Aa.prototype.sample=function(a,b){var c=Math.pow(this.c,a);this.b=b*(1-c)+c*this.b;this.a+=a};function Ba(a){return a.b/(1-Math.pow(a.c,a.a))};function A(a){var b=new CustomEvent(a.type,{detail:a.detail,bubbles:!!a.bubbles}),c;for(c in a)c in b||(b[c]=a[c]);return b}function B(a){return new CustomEvent("error",{detail:a,bubbles:!0})};function Ca(a,b,c){Da(b);Da(c);return c==b||a>=Ea&&c==b.split("-")[0]||a>=Fa&&c.split("-")[0]==b.split("-")[0]?!0:!1}var Ea=1,Fa=2;function Da(a){a=a.toLowerCase().split("-");var b=Ga[a[0]];b&&(a[0]=b);return a.join("-")}
var Ga={aar:"aa",abk:"ab",afr:"af",aka:"ak",alb:"sq",amh:"am",ara:"ar",arg:"an",arm:"hy",asm:"as",ava:"av",ave:"ae",aym:"ay",aze:"az",bak:"ba",bam:"bm",baq:"eu",bel:"be",ben:"bn",bih:"bh",bis:"bi",bod:"bo",bos:"bs",bre:"br",bul:"bg",bur:"my",cat:"ca",ces:"cs",cha:"ch",che:"ce",chi:"zh",chu:"cu",chv:"cv",cor:"kw",cos:"co",cre:"cr",cym:"cy",cze:"cs",dan:"da",deu:"de",div:"dv",dut:"nl",dzo:"dz",ell:"el",eng:"en",epo:"eo",est:"et",eus:"eu",ewe:"ee",fao:"fo",fas:"fa",fij:"fj",fin:"fi",fra:"fr",fre:"fr",
fry:"fy",ful:"ff",geo:"ka",ger:"de",gla:"gd",gle:"ga",glg:"gl",glv:"gv",gre:"el",grn:"gn",guj:"gu",hat:"ht",hau:"ha",heb:"he",her:"hz",hin:"hi",hmo:"ho",hrv:"hr",hun:"hu",hye:"hy",ibo:"ig",ice:"is",ido:"io",iii:"ii",iku:"iu",ile:"ie",ina:"ia",ind:"id",ipk:"ik",isl:"is",ita:"it",jav:"jv",jpn:"ja",kal:"kl",kan:"kn",kas:"ks",kat:"ka",kau:"kr",kaz:"kk",khm:"km",kik:"ki",kin:"rw",kir:"ky",kom:"kv",kon:"kg",kor:"ko",kua:"kj",kur:"ku",lao:"lo",lat:"la",lav:"lv",lim:"li",lin:"ln",lit:"lt",ltz:"lb",lub:"lu",
lug:"lg",mac:"mk",mah:"mh",mal:"ml",mao:"mi",mar:"mr",may:"ms",mkd:"mk",mlg:"mg",mlt:"mt",mon:"mn",mri:"mi",msa:"ms",mya:"my",nau:"na",nav:"nv",nbl:"nr",nde:"nd",ndo:"ng",nep:"ne",nld:"nl",nno:"nn",nob:"nb",nor:"no",nya:"ny",oci:"oc",oji:"oj",ori:"or",orm:"om",oss:"os",pan:"pa",per:"fa",pli:"pi",pol:"pl",por:"pt",pus:"ps",que:"qu",roh:"rm",ron:"ro",rum:"ro",run:"rn",rus:"ru",sag:"sg",san:"sa",sin:"si",slk:"sk",slo:"sk",slv:"sl",sme:"se",smo:"sm",sna:"sn",snd:"sd",som:"so",sot:"st",spa:"es",sqi:"sq",
srd:"sc",srp:"sr",ssw:"ss",sun:"su",swa:"sw",swe:"sv",tah:"ty",tam:"ta",tat:"tt",tel:"te",tgk:"tg",tgl:"tl",tha:"th",tib:"bo",tir:"ti",ton:"to",tsn:"tn",tso:"ts",tuk:"tk",tur:"tr",twi:"tw",uig:"ug",ukr:"uk",urd:"ur",uzb:"uz",ven:"ve",vie:"vi",vol:"vo",wel:"cy",wln:"wa",wol:"wo",xho:"xh",yid:"yi",yor:"yo",zha:"za",zho:"zh",zul:"zu"};function C(a){this.oa=new w;this.G=a}n("shaka.util.FakeEventTarget",C);C.prototype.addEventListener=function(a,b,c){c||this.oa.push(a,b)};C.prototype.removeEventListener=function(a,b,c){c||ua(this.oa,a,b)};
C.prototype.dispatchEvent=function(a){a.hasOwnProperty("srcElement")||(delete a.srcElement,Object.defineProperty(a,"srcElement",{get:function(){return null}}));if(a.hasOwnProperty("target"))a.target=this;else{delete a.target;var b=this;Object.defineProperty(a,"target",{get:function(){return b},set:function(a){b=a}})}if(a.hasOwnProperty("currentTarget"))a.currentTarget=null;else{delete a.currentTarget;var c=null;Object.defineProperty(a,"currentTarget",{get:function(){return c},set:function(a){c=a}})}return Ha(this,
a)};function Ha(a,b){b.currentTarget=a;for(var c=a.oa.get(b.type)||[],d=0;d<c.length;++d){var e=c[d];try{e.handleEvent?e.handleEvent(b):e.call(a,b)}catch(f){}}a.G&&b.bubbles&&Ha(a.G,b);return b.defaultPrevented};function Ia(){C.call(this,null);this.a=new Aa(3);this.c=new Aa(10);this.b=0}p(Ia,C);n("shaka.util.EWMABandwidthEstimator",Ia);Ia.prototype.sample=function(a,b){if(!(65536>b)){a=Math.max(a,50);var c=8E3*b/a,d=a/1E3;this.a.sample(d,c);this.c.sample(d,c);this.dispatchEvent(A({type:"bandwidth"}));this.b=Date.now()}};Ia.prototype.getBandwidth=function(){return.5>this.a.a?5E5:Math.min(Ba(this.a),Ba(this.c))};Ia.prototype.getDataAge=function(){return(Date.now()-this.b)/1E3};
Ia.prototype.supportsCaching=function(){return!1};function Ja(a){var b=Ka;this.b=a;this.c=b==La;this.a=0}var Ka=0,La=1;function Ma(a){var b=a.b.getUint32(a.a,a.c);a.a+=4;return b}function Na(a){if(a.a+16>a.b.byteLength)throw new RangeError("DataViewReader: Read past end of DataView.");var b=new Uint8Array(a.b.buffer,a.a,16);a.a+=16;return b}function Oa(a,b){if(a.a+b>a.b.byteLength)throw new RangeError("DataViewReader: Skip past end of DataView.");a.a+=b};function Pa(){this.g=new r;this.f=!1;this.a=null;this.b=[];this.c=null}function Qa(a,b){if(a.f)throw Error("Cannot append to a running task!");a.b.push(b)}Pa.prototype.start=function(){if(this.f)throw Error("Task already started!");this.f=!0;this.b.unshift(function(){});Ra(this,void 0)};Pa.prototype.end=function(){this.b.splice(1)};
function Ra(a,b){var c=a.b[0](b),d;c?(d=c[0],a.c=c[1]):(d=Promise.resolve(),a.c=null);d.then(t(a,function(a){this.a?(this.b=[],this.c=null,Sa(this)):(this.b.shift(),this.b.length?Ra(this,a):(this.g.resolve(a),this.c=null))})).catch(t(a,function(a){this.b=[];this.c=null;this.a?Sa(this):this.g.reject(a)}))}function Sa(a){var b=Error("Task aborted.");b.type="aborted";a.g.reject(b);window.setTimeout(function(){this.a.resolve();this.a=null}.bind(a),5)};function F(){this.a=new w}F.prototype.destroy=function(){Ta(this);this.a=null};function G(a,b,c,d){b=new Ua(b,c,d);a.a.push(c,b)}F.prototype.la=function(a,b){for(var c=this.a.get(b)||[],d=0;d<c.length;++d){var e=c[d];e.target==a&&(e.la(),ua(this.a,b,e))}};function Ta(a){for(var b=ta(a.a),c=0;c<b.length;++c)b[c].la();a.a.a={}}function Ua(a,b,c){this.target=a;this.type=b;this.a=c;this.target.addEventListener(b,c,!1)}
Ua.prototype.la=function(){this.target&&(this.target.removeEventListener(this.type,this.a,!1),this.a=this.target=null)};function Va(a,b,c){MediaSource.isTypeSupported(b);b=a.addSourceBuffer(b);this.h=a;this.c=b;this.l=c;this.i=new F;this.G=null;this.b=[];this.u=0;this.f=this.a=null;this.o=0;G(this.i,this.c,"updateend",this.w.bind(this))}var Wa=1/60;Va.prototype.destroy=function(){Xa(this).catch(function(){});this.f&&this.f.destroy();this.b=this.a=this.f=null;this.i.destroy();this.h=this.c=this.i=null};
function Ya(a,b){for(var c=a.c.buffered,d=0;d<c.length;++d){var e=c.start(d)-Wa,f=c.end(d)+Wa;if(b>=e&&b<=f)return c.end(d)-b}return 0}
function Za(a,b,c,d){if(a.a)return a=Error("Cannot fetch ("+a.j+"): previous operation not complete."),a.type="stream",Promise.reject(a);a.a=new Pa;c!=a.c.timestampOffset&&(a.c.timestampOffset=c);d&&Qa(a.a,function(){return[$a(this,d),this.g.bind(this)]}.bind(a));Qa(a.a,function(){var a=b.a?b.a-b.b:1,c=new ab;c.a=3;c.h=1E3*a;c.c=1E3*this.o;c.j=this.G;return[bb(b.url,c,this.l),H.prototype.j.bind(b.url)]}.bind(a));Qa(a.a,t(a,function(a){this.l.getBandwidth();return[$a(this,a),this.g.bind(this)]}));
var e=0==a.c.buffered.length&&0==a.b.length,f=null;Qa(a.a,function(){if(0==this.c.buffered.length){var a=Error("Failed to buffer segment ("+this.j+").");a.type="stream";return[Promise.reject(a)]}e&&(a=b.b,f=this.c.buffered.start(0)-a);a=cb(this.b,b.b);0<=a?this.b.splice(a+1,0,b):this.b.push(b)}.bind(a));return db(a).then(function(){return Promise.resolve(f)}.bind(a))}
function eb(a){if(a.a)return a=Error("Cannot clear ("+a.j+"): previous operation not complete."),a.type="stream",Promise.reject(a);a.a=new Pa;Qa(a.a,function(){var a;a:if(0==this.c.buffered.length)a=Promise.resolve();else{try{this.c.remove(0,this.h.duration)}catch(c){a=Promise.reject(c);break a}this.b=[];a=this.f=new r}return[a,this.g.bind(this)]}.bind(a));return db(a)}
function fb(a,b){if(a.a){var c=Error("Cannot clearAfter ("+a.j+"): previous operation not complete.");c.type="stream";return Promise.reject(c)}a.a=new Pa;Qa(a.a,function(){return[gb(this,b),this.g.bind(this)]}.bind(a));return db(a)}function Xa(a){a.a?(a=a.a,a.a?a=a.a:a.f?(a.c&&a.c(),a.a=new r,a=a.a):(a.f=!0,a=Promise.resolve())):a=Promise.resolve();return a}function db(a){a.a.start();return a.a.g.then(t(a,function(){this.a=null})).catch(t(a,function(a){this.a=null;return Promise.reject(a)}))}
function $a(a,b){try{a.c.appendBuffer(b)}catch(c){return Promise.reject(c)}a.f=new r;return a.f}function gb(a,b){if(0==a.c.buffered.length)return Promise.resolve();var c=cb(a.b,b);if(-1==c||c==a.b.length-1)return Promise.resolve();try{a.c.remove(a.b[c+1].b,a.h.duration)}catch(d){return Promise.reject(d)}a.b=a.b.slice(0,c+1);a.f=new r;return a.f}Va.prototype.g=function(){this.f&&"open"==this.h.readyState&&this.c.abort()};Va.prototype.w=function(){this.f&&(this.f.resolve(),this.f=null)};function hb(a){var b=console[a];b?b.bind||(console[a]=function(){b.apply(console,arguments)}):console[a]=function(){}}hb("error");hb("warn");hb("info");hb("log");hb("debug");function I(){this.fontSize="100%";this.fontColor=ib;this.fontOpacity=jb;this.backgroundColor=kb;this.backgroundOpacity=jb;this.fontEdge=lb}n("shaka.player.TextStyle",I);I.prototype.a=function(){var a=window.localStorage.getItem("ShakaPlayerTextStyle");if(a){var b;try{b=JSON.parse(a)}catch(c){return}if(b&&"object"==typeof b){var a=b,d;for(d in a)d in this&&(this[d]=a[d])}}};I.prototype.load=I.prototype.a;I.prototype.b=function(){window.localStorage.setItem("ShakaPlayerTextStyle",JSON.stringify(this))};
I.prototype.store=I.prototype.b;function mb(a){var b=[];b.push("font-size: "+a.fontSize);b.push("color: "+nb(a.fontColor,a.fontOpacity));b.push("background-color: "+nb(a.backgroundColor,a.backgroundOpacity));for(var c=[],d=0;d<a.fontEdge.length;++d){var e=a.fontEdge[d].slice(3,6);c.push(nb(a.fontEdge[d].slice(0,3),a.fontOpacity)+" "+e.join("px ")+"px")}b.push("text-shadow: "+c.join(","));return b.join("; ")}function nb(a,b){return"rgba("+a.concat(b).join(",")+")"}var ib=[255,255,255],kb=[0,0,0];
I.StandardColors={WHITE:ib,BLACK:kb,RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,255,0],MAGENTA:[255,0,255],CYAN:[0,255,255]};var jb=1;I.StandardOpacities={OPAQUE:jb,SEMI_HIGH:.75,SEMI_LOW:.25,TRANSPARENT:0};var lb=[];
I.EdgeStyles={NONE:lb,RAISED:[[34,34,34,1,1,0],[34,34,34,2,2,0],[34,34,34,3,3,0]],DEPRESSED:[[204,204,204,1,1,0],[204,204,204,0,1,0],[34,34,34,-1,-1,0],[34,34,34,0,-1,0]],UNIFORM:[[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4]],DROP:[[34,34,34,2,2,3],[34,34,34,2,2,4],[34,34,34,2,2,5]]};function ob(a){this.systemIds=[];this.cencKeyIds=[];this.a=[];a=new Ja(new DataView(a.buffer));try{for(;a.a<a.b.byteLength;){var b=a.a,c=Ma(a),d=Ma(a);if(1==c){var e=a,f=void 0,g=void 0;e.c?(f=e.b.getUint32(e.a,!0),g=e.b.getUint32(e.a+4,!0)):(g=e.b.getUint32(e.a,!1),f=e.b.getUint32(e.a+4,!1));if(2097151<g)throw new RangeError("DataViewReader: Overflow reading 64-bit value.");e.a+=8;c=g*Math.pow(2,32)+f}else 0==c&&(c=a.b.byteLength-b);if(1886614376!=d)Oa(a,c-(a.a-b));else{var h,e=a,l=e.b.getUint8(e.a);
e.a+=1;h=l;if(1<h)Oa(a,c-(a.a-b));else{Oa(a,3);var m=ra(Na(a)),e=[];if(0<h)for(var q=Ma(a),f=0;f<q;++f){var x=ra(Na(a));e.push(x)}var D=Ma(a);Oa(a,D);this.cencKeyIds.push.apply(this.cencKeyIds,e);this.systemIds.push(m);this.a.push({start:b,end:a.a-1});a.a!=b+c&&Oa(a,c-(a.a-b))}}}}catch(u){}};function pb(a){qb[a]={ha:rb(),end:NaN}}function sb(a){if(a=qb[a])a.end=rb()}function tb(a){return(a=qb[a])&&a.end?a.end-a.ha:NaN}var rb=window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now,qb={};function J(a){this.c=[];this.b=[];this.V=ub;if(a)try{a(this.R.bind(this),this.a.bind(this))}catch(b){this.a(b)}}var ub=0;function vb(){window.Promise||(window.Promise=J,window.Promise.resolve=wb,window.Promise.reject=xb,window.Promise.all=yb,window.Promise.race=zb,window.setImmediate?(Ab=function(a){return window.setImmediate(a)},Bb=function(a){return window.clearImmediate(a)}):(Ab=function(a){return window.setTimeout(a,0)},Bb=function(a){return window.clearTimeout(a)}))}
n("shaka.polyfill.Promise.install",vb);function wb(a){var b=new J;b.R(a);return b}function xb(a){var b=new J;b.a(a);return b}function yb(a){function b(a,b,c){a.V==ub&&(e[b]=c,d++,d==e.length&&a.R(e))}var c=new J;if(!a.length)return c.R([]),c;for(var d=0,e=Array(a.length),f=c.a.bind(c),g=0;g<a.length;++g)a[g].then?a[g].then(b.bind(null,c,g),f):b(c,g,a[g]);return c}function zb(a){for(var b=new J,c=b.R.bind(b),d=b.a.bind(b),e=0;e<a.length;++e)a[e].then?a[e].then(c,d):c(a[e]);return b}
J.prototype.then=function(a,b){var c=new J;switch(this.V){case 1:Cb(this,c,a);break;case 2:Cb(this,c,b);break;case ub:this.c.push({va:c,pa:a}),this.b.push({va:c,pa:b})}return c};J.prototype.then=J.prototype.then;J.prototype.catch=function(a){return this.then(void 0,a)};J.prototype["catch"]=J.prototype.catch;J.prototype.R=function(a){if(this.V==ub){this.na=a;this.V=1;for(a=0;a<this.c.length;++a)Cb(this,this.c[a].va,this.c[a].pa);this.c=[];this.b=[]}};
J.prototype.a=function(a){if(this.V==ub){this.na=a;this.V=2;for(a=0;a<this.b.length;++a)Cb(this,this.b[a].va,this.b[a].pa);this.c=[];this.b=[]}};function Cb(a,b,c){Db.push(function(){if(c&&"function"==typeof c){try{var a=c(this.na)}catch(e){b.a(e);return}a instanceof J?a==b?b.a(new TypeError("Chaining cycle detected")):a.then(b.R.bind(b),b.a.bind(b)):b.R(a)}else 1==this.V?b.R(this.na):b.a(this.na)}.bind(a));null==Eb&&(Eb=Ab(Fb))}
function Fb(){for(;Db.length;){null!=Eb&&(Bb(Eb),Eb=null);var a=Db;Db=[];for(var b=0;b<a.length;++b)a[b]()}}function Ab(){return 0}function Bb(){}var Eb=null,Db=[];function Gb(a,b){try{var c=new Hb(a,b);return Promise.resolve(c)}catch(d){return Promise.reject(d)}}
function Hb(a,b){this.keySystem=a;for(var c=!1,d=0;d<b.length;++d){var e=b[d],f={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:e.initDataTypes,sessionTypes:["temporary"]},g=!1;if(e.audioCapabilities)for(var h=0;h<e.audioCapabilities.length;++h){var l=e.audioCapabilities[h];if(l.contentType){var g=!0,m=l.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,m)&&(f.audioCapabilities.push(l),c=!0)}}if(e.videoCapabilities)for(h=
0;h<e.videoCapabilities.length;++h)l=e.videoCapabilities[h],l.contentType&&(g=!0,m=l.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,m)&&(f.videoCapabilities.push(l),c=!0));g||(c=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4"));"required"==e.persistentState&&(f.persistentState="required",f.sessionTypes=["persistent-license"]);if(c){this.a=f;return}}c=Error("Unsupported keySystem");c.name="NotSupportedError";c.code=DOMException.NOT_SUPPORTED_ERR;throw c;}
Hb.prototype.createMediaKeys=function(){var a=new Ib(this.keySystem);return Promise.resolve(a)};Hb.prototype.getConfiguration=function(){return this.a};function Jb(a){var b=this.mediaKeys;b&&b!=a&&Kb(b,null);delete this.mediaKeys;return(this.mediaKeys=a)?Kb(a,this):Promise.resolve()}function Ib(a){this.a=new MSMediaKeys(a);this.b=new F}Ib.prototype.createSession=function(a){if("temporary"!=(a||"temporary"))throw new TypeError("Session type "+a+" is unsupported on this platform.");return new Lb(this.a)};
Ib.prototype.setServerCertificate=function(){return Promise.reject(Error("setServerCertificate not supported on this platform."))};function Kb(a,b){function c(){b.msSetMediaKeys(d.a);b.removeEventListener("loadedmetadata",c)}Ta(a.b);if(!b)return Promise.resolve();G(a.b,b,"msneedkey",Mb);var d=a;try{return 1<=b.readyState?b.msSetMediaKeys(a.a):b.addEventListener("loadedmetadata",c),Promise.resolve()}catch(e){return Promise.reject(e)}}
function Lb(a){C.call(this,null);this.c=null;this.g=a;this.b=this.a=null;this.f=new F;this.sessionId="";this.expiration=NaN;this.closed=new r;this.keyStatuses=new Nb}p(Lb,C);k=Lb.prototype;k.generateRequest=function(a,b){this.a=new r;try{this.c=this.g.createSession("video/mp4",b),G(this.f,this.c,"mskeymessage",this.mb.bind(this)),G(this.f,this.c,"mskeyadded",this.kb.bind(this)),G(this.f,this.c,"mskeyerror",this.lb.bind(this)),Ob(this,"status-pending")}catch(c){this.a.reject(c)}return this.a};
k.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))};k.update=function(a){this.b=new r;try{this.c.update(a)}catch(b){this.b.reject(b)}return this.b};k.close=function(){try{this.c.close(),this.closed.resolve(),Ta(this.f)}catch(a){this.closed.reject(a)}return this.closed};k.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))};
function Mb(a){var b=a.initData;if(b){var c=new ob(b);if(1>=c.a.length)a=b;else{var d=[];for(a=0;a<c.a.length;a++)d.push(b.subarray(c.a[a].start,c.a[a].end+1));b=ma(d,Pb);for(a=c=0;a<b.length;a++)c+=b[a].length;c=new Uint8Array(c);for(a=d=0;a<b.length;a++)c.set(b[a],d),d+=b[a].length;a=c}}else a=b;a=A({type:"encrypted",initDataType:"cenc",initData:a});this.dispatchEvent(a)}function Pb(a,b){return sa(a,b)}
k.mb=function(a){this.a&&(this.a.resolve(),this.a=null);a=A({type:"message",messageType:void 0==this.keyStatuses.sa()?"licenserequest":"licenserenewal",message:a.message.buffer});this.dispatchEvent(a)};k.kb=function(){this.a?(this.a.resolve(),this.a=null):this.b&&(Ob(this,"usable"),this.b.resolve(),this.b=null)};
k.lb=function(){var a=Error("EME v20140218 key error");a.errorCode=this.c.error;if(null!=this.a)this.a.reject(a),this.a=null;else if(null!=this.b)this.b.reject(a),this.b=null;else switch(this.c.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:Ob(this,"output-not-allowed");default:Ob(this,"internal-error")}};function Ob(a,b){a.keyStatuses.xa(b);var c=A({type:"keystatuseschange"});a.dispatchEvent(c)}function Qb(a){this.b=a;this.a=0}
Qb.prototype.next=function(){return this.a>=this.b.length?{value:void 0,done:!0}:{value:this.b[this.a++],done:!1}};function Nb(){this.size=0;this.a=void 0}var Rb;k=Nb.prototype;k.xa=function(a){this.size=void 0==a?0:1;this.a=a};k.sa=function(){return this.a};k.entries=function(){var a=Rb,b=[];this.a&&b.push([a,this.a]);return new Qb(b)};k.forEach=function(a){this.a&&a(this.a,Rb)};k.get=function(a){if(this.has(a))return this.a};k.has=function(a){var b=Rb;return this.a&&sa(new Uint8Array(a),b)?!0:!1};
k.keys=function(){var a=Rb,b=[];this.a&&b.push(a);return new Qb(b)};k.values=function(){var a=[];this.a&&a.push(this.a);return new Qb(a)};function Sb(){var a="CustomEvent"in window;if(a)try{new CustomEvent("")}catch(b){a=!1}a||(window.CustomEvent=Tb)}n("shaka.polyfill.CustomEvent.install",Sb);function Tb(a,b){var c=document.createEvent("CustomEvent"),d=b||{bubbles:!1,cancelable:!1,detail:null};c.initCustomEvent(a,!!d.bubbles,!!d.cancelable,d.detail);return c};function Ub(){var a=HTMLVideoElement.prototype;!a.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in a&&(a.getVideoPlaybackQuality=Vb)}n("shaka.polyfill.VideoPlaybackQuality.install",Ub);function Vb(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}};function Wb(){var a=Element.prototype;a.requestFullscreen=a.requestFullscreen||a.mozRequestFullScreen||a.msRequestFullscreen||a.webkitRequestFullscreen;a=Document.prototype;a.exitFullscreen=a.exitFullscreen||a.mozCancelFullScreen||a.msExitFullscreen||a.webkitExitFullscreen;"fullscreenElement"in document||Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}});document.addEventListener("webkitfullscreenchange",
Xb);document.addEventListener("webkitfullscreenerror",Xb);document.addEventListener("mozfullscreenchange",Xb);document.addEventListener("mozfullscreenerror",Xb);document.addEventListener("MSFullscreenChange",Xb);document.addEventListener("MSFullscreenError",Xb)}n("shaka.polyfill.Fullscreen.install",Wb);function Xb(a){var b=a.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),b=new Event(b,a);a.target.dispatchEvent(b)};function Yb(){return Promise.reject(Error("The key system specified is not supported."))}function Zb(a){return null==a?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function $b(){throw new TypeError("Illegal constructor.");}$b.prototype.createSession=function(){};$b.prototype.setServerCertificate=function(){};function ac(){throw new TypeError("Illegal constructor.");}ac.prototype.getConfiguration=function(){};ac.prototype.createMediaKeys=function(){};function bc(a,b){try{var c=new cc(a,b);return Promise.resolve(c)}catch(d){return Promise.reject(d)}}function dc(a){var b=this.mediaKeys;b&&b!=a&&ec(b,null);delete this.mediaKeys;(this.mediaKeys=a)&&ec(a,this);return Promise.resolve()}
function cc(a,b){this.a=this.keySystem=a;var c=!0;"org.w3.clearkey"==a&&(this.a="webkit-org.w3.clearkey",c=!1);var d=!1,e;e=document.getElementsByTagName("video");e=e.length?e[0]:document.createElement("video");for(var f=0;f<b.length;++f){var g=b[f],h={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:g.initDataTypes,sessionTypes:["temporary"]},l=!1;if(g.audioCapabilities)for(var m=0;m<g.audioCapabilities.length;++m){var q=g.audioCapabilities[m];
q.contentType&&(l=!0,e.canPlayType(q.contentType.split(";")[0],this.a)&&(h.audioCapabilities.push(q),d=!0))}if(g.videoCapabilities)for(m=0;m<g.videoCapabilities.length;++m)q=g.videoCapabilities[m],q.contentType&&(l=!0,e.canPlayType(q.contentType,this.a)&&(h.videoCapabilities.push(q),d=!0));l||(d=e.canPlayType("video/mp4",this.a)||e.canPlayType("video/webm",this.a));"required"==g.persistentState&&(c?(h.persistentState="required",h.sessionTypes=["persistent-license"]):d=!1);if(d){this.b=h;return}}c=
"Unsupported keySystem";if("org.w3.clearkey"==a||"com.widevine.alpha"==a)c="None of the requested configurations were supported.";c=Error(c);c.name="NotSupportedError";c.code=DOMException.NOT_SUPPORTED_ERR;throw c;}cc.prototype.createMediaKeys=function(){var a=new fc(this.a);return Promise.resolve(a)};cc.prototype.getConfiguration=function(){return this.b};function fc(a){this.g=a;this.b=null;this.a=new F;this.c=[];this.f={}}
function ec(a,b){a.b=b;Ta(a.a);b&&(G(a.a,b,"webkitneedkey",a.Ab.bind(a)),G(a.a,b,"webkitkeymessage",a.zb.bind(a)),G(a.a,b,"webkitkeyadded",a.xb.bind(a)),G(a.a,b,"webkitkeyerror",a.yb.bind(a)))}k=fc.prototype;k.createSession=function(a){var b=a||"temporary";if("temporary"!=b&&"persistent-license"!=b)throw new TypeError("Session type "+a+" is unsupported on this platform.");a=this.b||document.createElement("video");a.src||(a.src="about:blank");b=new gc(a,this.g,b);this.c.push(b);return b};
k.setServerCertificate=function(){return Promise.reject(Error("setServerCertificate not supported on this platform."))};k.Ab=function(a){a=A({type:"encrypted",initDataType:"webm",initData:a.initData});this.b.dispatchEvent(a)};k.zb=function(a){var b=hc(this,a.sessionId);b&&(a=A({type:"message",messageType:void 0==b.keyStatuses.sa()?"licenserequest":"licenserenewal",message:a.message}),b.b&&(b.b.resolve(),b.b=null),b.dispatchEvent(a))};
k.xb=function(a){if(a=hc(this,a.sessionId))ic(a,"usable"),a.a&&a.a.resolve(),a.a=null};
k.yb=function(a){var b=hc(this,a.sessionId);if(b){var c=Error("EME v0.1b key error");c.errorCode=a.errorCode;c.errorCode.systemCode=a.systemCode;!a.sessionId&&b.b?(c.method="generateRequest",45==a.systemCode&&(c.message="Unsupported session type."),b.b.reject(c),b.b=null):a.sessionId&&b.a?(c.method="update",b.a.reject(c),b.a=null):(c=a.systemCode,a.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?ic(b,"output-restricted"):1==c?ic(b,"expired"):ic(b,"internal-error"))}};
function hc(a,b){var c=a.f[b];return c?c:(c=a.c.shift())?(c.sessionId=b,a.f[b]=c):null}function gc(a,b,c){C.call(this,null);this.f=a;this.h=!1;this.a=this.b=null;this.c=b;this.g=c;this.sessionId="";this.expiration=NaN;this.closed=new r;this.keyStatuses=new jc}p(gc,C);
function kc(a,b,c){if(a.h)return Promise.reject(Error("The session is already initialized."));a.h=!0;var d;try{if("persistent-license"==a.g)if(c)d=pa("LOAD_SESSION|"+c);else{var e=new Uint8Array(b);d=pa("PERSISTENT|"+oa(e))}else d=new Uint8Array(b)}catch(f){return Promise.reject(f)}a.b=new r;try{a.f.webkitGenerateKeyRequest(a.c,d)}catch(g){if("InvalidStateError"!=g.name)return a.b=null,Promise.reject(g);setTimeout(function(){try{this.f.webkitGenerateKeyRequest(this.c,d)}catch(a){this.b.reject(a),
this.b=null}}.bind(a),10)}return a.b}k=gc.prototype;k.Aa=function(a,b){if(this.a)this.a.then(this.Aa.bind(this,a,b)).catch(this.Aa.bind(this,a,b));else{this.a=a;var c,d;"webkit-org.w3.clearkey"==this.c?(c=oa(new Uint8Array(b)),d=JSON.parse(c),"oct"!=d.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null),c=qa(d.keys[0].k),d=qa(d.keys[0].kid)):(c=new Uint8Array(b),d=null);try{this.f.webkitAddKey(this.c,c,d,this.sessionId)}catch(e){this.a.reject(e),this.a=null}}};
function ic(a,b){a.keyStatuses.xa(b);var c=A({type:"keystatuseschange"});a.dispatchEvent(c)}k.generateRequest=function(a,b){return kc(this,b,null)};k.load=function(a){return"persistent-license"==this.g?kc(this,null,a):Promise.reject(Error("Not a persistent session."))};k.update=function(a){var b=new r;this.Aa(b,a);return b};
k.close=function(){if("persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;this.f.webkitCancelKeyRequest(this.c,this.sessionId)}this.closed.resolve();return this.closed};k.remove=function(){return"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()};function lc(a){this.b=a;this.a=0}
lc.prototype.next=function(){return this.a>=this.b.length?{value:void 0,done:!0}:{value:this.b[this.a++],done:!1}};function jc(){this.size=0;this.a=void 0}var mc;k=jc.prototype;k.xa=function(a){this.size=void 0==a?0:1;this.a=a};k.sa=function(){return this.a};k.entries=function(){var a=mc,b=[];this.a&&b.push([a,this.a]);return new lc(b)};k.forEach=function(a){this.a&&a(this.a,mc)};k.get=function(a){if(this.has(a))return this.a};k.has=function(a){var b=mc;return this.a&&sa(new Uint8Array(a),b)?!0:!1};
k.keys=function(){var a=mc,b=[];this.a&&b.push(a);return new lc(b)};k.values=function(){var a=[];this.a&&a.push(this.a);return new lc(a)};function nc(){Navigator.prototype.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(HTMLMediaElement.prototype.webkitGenerateKeyRequest?(mc=new Uint8Array([0]),Navigator.prototype.requestMediaKeySystemAccess=bc,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=dc,window.MediaKeys=fc,window.MediaKeySystemAccess=cc):window.MSMediaKeys?(Rb=new Uint8Array([0]),delete HTMLMediaElement.prototype.mediaKeys,
HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Jb,window.MediaKeys=Ib,window.MediaKeySystemAccess=Hb,Navigator.prototype.requestMediaKeySystemAccess=Gb):(Navigator.prototype.requestMediaKeySystemAccess=Yb,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Zb,window.MediaKeys=$b,window.MediaKeySystemAccess=ac))}n("shaka.polyfill.MediaKeys.install",nc);n("shaka.polyfill.installAll",function(){Sb();Wb();Ub();vb();nc()});var oc=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function K(a){var b;a instanceof K?(pc(this,a.O),this.W=a.W,this.N=a.N,qc(this,a.ca),this.M=a.M,rc(this,a.a.clone()),this.U=a.U):a&&(b=String(a).match(oc))?(pc(this,b[1]||"",!0),this.W=sc(b[2]||""),this.N=sc(b[3]||"",!0),qc(this,b[4]),this.M=sc(b[5]||"",!0),rc(this,b[6]||"",!0),this.U=sc(b[7]||"")):this.a=new L(null)}k=K.prototype;k.O="";k.W="";k.N="";k.ca=null;k.M="";k.U="";
k.toString=function(){var a=[],b=this.O;b&&a.push(tc(b,uc,!0),":");if(b=this.N){a.push("//");var c=this.W;c&&a.push(tc(c,uc,!0),"@");a.push(encodeURIComponent(b).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));b=this.ca;null!=b&&a.push(":",String(b))}if(b=this.M)this.N&&"/"!=b.charAt(0)&&a.push("/"),a.push(tc(b,"/"==b.charAt(0)?vc:wc,!0));(b=this.a.toString())&&a.push("?",b);(b=this.U)&&a.push("#",tc(b,xc));return a.join("")};
k.resolve=function(a){var b=this.clone();"data"===b.O&&(b=new K);var c=!!a.O;c?pc(b,a.O):c=!!a.W;c?b.W=a.W:c=!!a.N;c?b.N=a.N:c=null!=a.ca;var d=a.M;if(c)qc(b,a.ca);else if(c=!!a.M){if("/"!=d.charAt(0))if(this.N&&!this.M)d="/"+d;else{var e=b.M.lastIndexOf("/");-1!=e&&(d=b.M.substr(0,e+1)+d)}if(".."==d||"."==d)d="";else if(-1!=d.indexOf("./")||-1!=d.indexOf("/.")){for(var e=0==d.lastIndexOf("/",0),d=d.split("/"),f=[],g=0;g<d.length;){var h=d[g++];"."==h?e&&g==d.length&&f.push(""):".."==h?((1<f.length||
1==f.length&&""!=f[0])&&f.pop(),e&&g==d.length&&f.push("")):(f.push(h),e=!0)}d=f.join("/")}}c?b.M=d:c=""!==a.a.toString();c?rc(b,a.a.clone()):c=!!a.U;c&&(b.U=a.U);return b};k.clone=function(){return new K(this)};function pc(a,b,c){a.O=c?sc(b,!0):b;a.O&&(a.O=a.O.replace(/:$/,""))}function qc(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.ca=b}else a.ca=null}function rc(a,b,c){b instanceof L?a.a=b:(c||(b=tc(b,yc)),a.a=new L(b))}
function sc(a,b){return a?b?decodeURI(a):decodeURIComponent(a):""}function tc(a,b,c){return"string"==typeof a?(a=encodeURI(a).replace(b,Ac),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Ac(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var uc=/[#\/\?@]/g,wc=/[\#\?:]/g,vc=/[\#\?]/g,yc=/[\#\?@]/g,xc=/#/g;function L(a){this.b=a||null}L.prototype.a=null;L.prototype.c=null;
function Bc(a,b,c){if(!a.a&&(a.a={},a.c=0,a.b))for(var d=a.b.split("&"),e=0;e<d.length;e++){var f=d[e].indexOf("="),g=null,h=null;0<=f?(g=d[e].substring(0,f),h=d[e].substring(f+1)):g=d[e];g=decodeURIComponent(g.replace(/\+/g," "));h=h||"";Bc(a,g,decodeURIComponent(h.replace(/\+/g," ")))}a.b=null;(d=a.a.hasOwnProperty(b)&&a.a[b])||(a.a[b]=d=[]);d.push(c);a.c++}
L.prototype.toString=function(){if(this.b)return this.b;if(!this.a)return"";var a=[],b;for(b in this.a)for(var c=encodeURIComponent(b),d=this.a[b],e=0;e<d.length;e++){var f=c;""!==d[e]&&(f+="="+encodeURIComponent(d[e]));a.push(f)}return this.b=a.join("&")};L.prototype.clone=function(){var a=new L;a.b=this.b;if(this.a){var b={},c;for(c in this.a)b[c]=this.a[c].concat();a.a=b;a.c=this.c}return a};function Cc(a,b){this.url=a;this.b=b||new ab;this.g=this.i=this.h=0;this.a=null;this.c=new r;this.f=null}function ab(){this.body=null;this.a=1;this.h=1E3;this.c=0;this.method="GET";this.f="arraybuffer";this.b={};this.g=this.i=!1;this.j=null}var Dc=!0;function Ec(a){Fc(a);a.b.body=null;a.c.destroy();a.c=null;a.f=null}function Fc(a){a.a&&(a.a.onload=null,a.a.onreadystatechange=null,a.a.onerror=null,a.a.ontimeout=null);a.a=null}k=Cc.prototype;
k.Xa=function(){if(this.a)return this.c;if(0==this.url.lastIndexOf("data:",0)){var a=this.url.split(":")[1].split(";").pop().split(","),b=a.pop(),b="base64"==a.pop()?window.atob(b.replace(/-/g,"+").replace(/_/g,"/")):window.decodeURIComponent(b);"arraybuffer"==this.b.f&&(b=pa(b).buffer);a=JSON.parse(JSON.stringify(new XMLHttpRequest));a.response=b;a.responseText=b.toString();b=this.c;b.resolve(a);Ec(this);return b}if(0==this.url.lastIndexOf("idb:",0))return this.j();this.h++;this.i=Date.now();this.g||
(this.g=this.b.h);this.a=new XMLHttpRequest;a=this.url;Dc&&(this.f&&!this.f.supportsCaching()||this.b.g)&&(a=new K(a),Bc(a.a,"_",Date.now()),a=a.toString());this.a.open(this.b.method,a,!0);this.a.responseType=this.b.f;this.a.timeout=this.b.c;this.a.withCredentials=this.b.i;this.a.onload=this.ib.bind(this);this.b.g&&(this.a.onreadystatechange=this.pb.bind(this));this.a.onerror=this.Eb.bind(this);this.a.ontimeout=this.ub.bind(this);for(b in this.b.b)this.a.setRequestHeader(b,this.b.b[b]);this.a.send(this.b.body);
return this.c};function Gc(a,b,c){b=Error(b);b.type=c;b.status=a.a.status;b.url=a.url;b.method=a.b.method;b.body=a.b.body;b.Fb=a.a;return b}k.ib=function(a){this.f&&this.f.sample(Date.now()-this.i,a.loaded);200<=this.a.status&&299>=this.a.status?(this.c.resolve(this.a),Ec(this)):this.h<this.b.a?Hc(this):(a=Gc(this,"HTTP error.","net"),this.c.reject(a),Ec(this))};k.pb=function(){if(this.a.readyState==XMLHttpRequest.HEADERS_RECEIVED){var a=Date.parse(this.a.getResponseHeader("Date"));a&&(va=a-Date.now())}};
k.Eb=function(){var a=Gc(this,"Network failure.","net");this.c.reject(a);Ec(this)};k.ub=function(){if(this.h<this.b.a)Hc(this);else{var a=Gc(this,"Request timed out.","net");this.c.reject(a);Ec(this)}};function Hc(a){Fc(a);window.setTimeout(a.Xa.bind(a),a.g*(1+.5*(2*Math.random()-1)));a.g*=2};function H(a,b,c,d){this.c=b;this.i=c||0;this.g=null!=d?d:null;this.b=this.a=null;this.h=a;this.f=null}function Ic(a,b){return a&&0!==a.length?a.map(function(a){return a.resolve(b)}):[b]}function bb(a,b,c){if(a.a)return a.a;b=b||new ab;if(a.i||a.g)b.b.Range="bytes="+(a.i+"-"+(null!=a.g?a.g:""));a.a=Jc(a,0,b,c);return a.a}
H.prototype.j=function(){if(this.b){this.a=null;var a=this.b;if(a.a&&a.a.readyState!=XMLHttpRequest.DONE){a.a.abort();var b=Gc(a,"Request aborted.","aborted");a.c.reject(b);Ec(a)}this.f=this.b=null}};
function Jc(a,b,c,d){var e=a.c[b].toString();a.h&&(e=a.h(e,c.b)||e);a.b=new Cc(e,c);d&&(a.b.f=d);e=a.b.Xa().then(t(a,function(a){this.f=this.b=this.a=null;this.f=a.a?new K(a.a):this.c[b];return Promise.resolve(a.response)}));return e=e.catch(t(a,function(a){if(this.a&&b+1<this.c.length)return this.a=Jc(this,b+1,c,d);this.a=this.b=null;return Promise.reject(a)}))}H.prototype.clone=function(){return new H(this.h,this.c.map(function(a){return a.clone()}),this.i,this.g)};H.prototype.toString=function(){return this.c[0].toString()};function Kc(a,b){this.a=a;this.b=b||null}Kc.prototype.destroy=function(){this.a&&(this.a.j(),this.a=null);this.b=null};Kc.prototype.create=function(){return this.a?bb(this.a):Promise.resolve(this.b)};function Lc(a,b,c){this.b=a;this.a=b;this.url=c}function Mc(a,b,c){return new Lc(b,c,a.url)}function cb(a,b){for(var c=a.length-1;0<=c;--c){var d=a[c];if(b>=d.b&&(null==d.a||b<d.a))return c}return-1}function Nc(a,b){return a.map(function(a){return Mc(a,a.b+b,null!=a.a?a.a+b:null)})};function M(a){this.a=a;this.j=0}M.prototype.destroy=function(){this.a=null};k=M.prototype;k.length=function(){return this.a.length};function N(a){if(0==a.a.length)throw new RangeError("SegmentIndex: There is no first SegmentReference.");return a.a[0]}k.v=function(){if(0==this.a.length)throw new RangeError("SegmentIndex: There is no last SegmentReference.");return this.a[this.a.length-1]};
k.get=function(a){if(0>a||a>=this.a.length)throw new RangeError("SegmentIndex: The specified index is out of range.");return this.a[a]};k.ea=function(a){a=cb(this.a,a);return 0<=a?this.a[a]:null};k.ua=function(a){Oc(this,a);return!0};
function Oc(a,b){a.j!=b.j&&(b=new M(Nc(b.a,a.j-b.j)));if(0==a.length())a.a=b.a.slice(0);else if(0!=b.length()&&null!=a.v().a&&!(null!=b.v().a&&b.v().a<a.v().a)){if(a.v().a<=N(b).b)var c=Mc(a.v(),a.v().b,N(b).b),c=a.a.slice(0,-1).concat([c]);else{var d;for(d=0;d<a.a.length&&!(a.a[d].a>=N(b).b);++d);a.a[d].b<N(b).b?(c=Mc(a.a[d],a.a[d].b,N(b).b),c=a.a.slice(0,d).concat([c])):(N(a).b>N(b).b||N(b),c=a.a.slice(0,d))}a.a=c.concat(b.a)}}
k.da=function(a){var b=a-this.j;if(0==b)return 0;this.a=Nc(this.a,b);this.j=a;return b};k.ra=function(){return 0<this.length()?{start:N(this).b,end:this.v().a}:{start:0,end:0}};function Pc(a){this.b=a;this.a=null}Pc.prototype.destroy=function(){this.a&&(this.a.destroy(),this.a=null)};Pc.prototype.create=function(){if(this.a)return Promise.resolve(this.a);var a=new Lc(0,null,this.b);this.a=new M([a]);return Promise.resolve(this.a)};function Qc(){this.B=Rc++;this.id=this.K=this.J=null;this.b=0;this.height=this.width=this.bandwidth=null;this.c=this.a="";this.f=[];this.L=!1;this.F=!0}var Rc=0;Qc.prototype.destroy=function(){this.J&&(this.J.destroy(),this.J=null);this.K&&(this.K.destroy(),this.K=null)};function Sc(a){var b=a.a||"";a.c&&(b+='; codecs="'+a.c+'"');return b}function Tc(){this.B=Uc++;this.id=null;this.contentType=this.lang="";this.b=!1;this.m=[];this.a=[]}var Uc=0;
Tc.prototype.destroy=function(){for(var a=0;a<this.m.length;++a)this.m[a].destroy();this.a=this.m=null};function Vc(a){for(var b=[],c=0;c<a.a.length;++c){var d=new Wc;d.id=a.B;d.a=a.a[c];d.contentType=a.contentType;d.b=a.m.length?Sc(a.m[0]):"";b.push(d)}return b}function Xc(){this.id=null;this.start=0;this.b=null;this.a=[]}Xc.prototype.destroy=function(){for(var a=0;a<this.a.length;++a)this.a[a].destroy();this.a=null};function Yc(){this.b=!1;this.h=this.g=this.f=null;this.c=0;this.a=[]}
Yc.prototype.destroy=function(){for(var a=0;a<this.a.length;++a)this.a[a].destroy();this.a=null};function Wc(){this.id=0;this.a=null;this.b=this.contentType=""};function Zc(a,b){C.call(this,a);this.b=b;this.g=!0;this.h=this.f=null;this.c=new r;this.a=null}p(Zc,C);Zc.prototype.C=function(){};Zc.prototype.destroy=function(){this.a&&this.b.removeChild(this.a);this.c.destroy();this.G=this.b=this.f=this.h=this.a=this.c=null};k=Zc.prototype;k.ia=function(){return this.f};k.Oa=function(){return this.h};k.Ya=function(){return this.c};k.ta=function(){return!0};
k.ka=function(a){a.J.create().then(t(this,function(b){if(this.b){if(0==b.length())return Promise.reject(Error("No subtitles URL available."));var c=this.f;this.f=a;this.h=b;b=N(b).url.c[0].toString();var d=this.qa();this.a&&(this.ma(!1),this.b.removeChild(this.a));this.a=document.createElement("track");this.b.appendChild(this.a);this.a.src=b;this.ma(d);b=A({type:"adaptation",bubbles:!0,contentType:"text",size:null,bandwidth:a.bandwidth});this.dispatchEvent(b);c||this.c.resolve(0)}}))};k.Ua=function(){};
k.Va=function(){return!0};k.ma=function(a){this.g=a;this.a&&(this.a.track.mode=a?"showing":"disabled")};k.qa=function(){this.a&&(this.g="showing"==this.a.track.mode);return this.g};function $c(a,b,c,d,e){C.call(this,a);this.c=b;this.a=new Va(c,d,e);this.u=this.D=this.b=null;this.H=!1;this.g=null;this.l=!1;this.i=null;this.o=!1;this.h=new r;this.j=this.f=!1;this.w=0;this.I=15;this.A=!1}p($c,C);$c.prototype.C=function(a){null!=a.initialStreamBufferSize&&(this.w=Number(a.initialStreamBufferSize));null!=a.streamBufferSize&&(this.I=Number(a.streamBufferSize));null!=a.segmentRequestTimeout&&(this.a.o=Number(a.segmentRequestTimeout))};
$c.prototype.destroy=function(){ad(this);this.h.destroy();this.b=this.h=null;this.a.destroy();this.G=this.c=this.a=null};k=$c.prototype;k.ia=function(){return this.b};k.Oa=function(){return this.D};k.Ya=function(a){this.f||a.then(function(){this.f=!0;this.g||bd(this,0)}.bind(this)).catch(function(){});return this.h};k.ta=function(){return this.j};
k.ka=function(a,b,c){if(a!=this.b){var d=[a.J.create(),a.K.create()];Promise.all(d).then(t(this,function(d){if(this.c){var f=this.b;this.b=a;this.D=d[0];this.u=d[1];this.H=!0;this.l||(f?b&&cd(this,!0,c):bd(this,0))}})).catch(t(this,function(a){"aborted"!=a.type&&(this.f?(a=B(a),this.dispatchEvent(a)):this.h.reject(a))}))}};k.Ua=function(){return cd(this,!1)};
function cd(a,b,c){a.b&&!a.l&&(a.l=!0,ad(a),Xa(a.a).then(t(a,function(){var a=this.c.currentTime;if(!b&&0<Ya(this.a,a)&&0<=cb(this.a.b,a))return Promise.resolve();if(c)return fb(this.a,this.c.currentTime+c);this.A=!0;return eb(this.a)})).then(t(a,function(){this.l=!1;bd(this,0)})).catch(t(a,function(a){this.l=!1;this.f?(a=B(a),this.dispatchEvent(a)):this.h.reject(a)})))}k.Va=function(a){return 0<Ya(this.a,a)&&0<=cb(this.a.b,a)};k.ma=function(){};k.qa=function(){return!0};
k.wb=function(){if(this.o&&!this.f)this.g=null;else{var a;if(a=this.f&&!this.j)a=1<this.a.c.buffered.length?!0:!1;if(a)cd(this,!0);else{this.g=null;a=this.b;var b=this.D,c=this.c.currentTime;Ya(this.a,this.o?c:c+(this.i||0))>=(this.o?Math.max(this.w,this.I):this.w)?(dd(this),bd(this,1E3/(Math.abs(this.c.playbackRate)||1))):(b=ed(this,c,b))?(b=Za(this.a,b,a.b,this.u),this.u=null,this.H&&(this.H=!1,fd(this,a)),this.j=!1,b.then(t(this,function(a){null==this.i&&(this.i=a);this.A&&0<Ya(this.a,c)&&(this.A=
!1,this.c.currentTime+=.001);bd(this,0)})).catch(t(this,function(a){if("aborted"!=a.type){var b=[0,404,410];"net"==a.type&&-1!=b.indexOf(a.Fb.status)&&this.b&&bd(this,5E3);a=B(a);this.dispatchEvent(a)}}))):(dd(this),this.f&&!this.j&&(this.j=!0,gd(this)),bd(this,1E3))}}};function ed(a,b,c){a=a.a;var d=a.b.length;a=0<d?a.b[d-1]:null;return null!=a?null!=a.a?c.ea(a.a):null:c.ea(b)||(c.length()?c.v():null)}
function dd(a){if(!a.o&&null!=a.i){a.o=!0;var b=a.a,c=a.i,d=c-b.u;0!=d&&(b.b=Nc(b.b,d),b.u=c);a.h.resolve(a.i)}}function fd(a,b){var c;c=b.a.split("/")[0];c=A({type:"adaptation",bubbles:!0,contentType:c,size:"video"!=c?null:{width:b.width,height:b.height},bandwidth:b.bandwidth});a.dispatchEvent(c)}function gd(a){var b=A({type:"ended"});a.dispatchEvent(b)}function bd(a,b){a.g=window.setTimeout(a.wb.bind(a),b)}function ad(a){null!=a.g&&(window.clearTimeout(a.g),a.g=null)};function hd(){this.streamStats=null;this.droppedFrames=this.decodedFrames=NaN;this.bufferingTime=this.playTime=this.estimatedBandwidth=0;this.playbackLatency=NaN;this.bufferingHistory=[];this.bandwidthHistory=[];this.streamHistory=[]}function id(a,b){var c=new jd(b);a.streamHistory.push(new kd(c));if(c.videoHeight||!a.streamStats)a.streamStats=c}function jd(a){this.videoWidth=a.width;this.videoHeight=a.height;this.videoMimeType=a.a;this.videoBandwidth=a.bandwidth}
function kd(a){this.timestamp=z()/1E3;this.value=a};function ld(a,b,c,d,e){this.b=new H(null,[new K(a)]);this.a=new ab;this.a.body=b;this.a.method=c;this.a.a=3;this.a.i=d;this.a.c=0;a=e||{};for(var f in a)this.a.b[f]=a[f]}function md(a){return bb(a.b,a.a).then(function(a){return Promise.resolve(new Uint8Array(a))})};function nd(a,b,c){C.call(this,a);this.c=b;this.j=c;this.a=this.h=null;this.i=new F;this.b=[];this.f=[];this.o=0;this.g=new r;this.l=null}p(nd,C);nd.prototype.destroy=function(){this.G=null;for(var a=0;a<this.f.length;++a)this.f[a].close().catch(function(){});this.f=[];this.b=this.a=this.h=null;this.g.destroy();this.g=null;this.i.destroy();this.i=null;this.l&&(window.clearTimeout(this.l),this.l=null);this.c=this.j=null};
nd.prototype.initialize=function(){var a=new w,b;b=this.j;if(b.D){b=b.a.a[0];for(var c=[],d=0;d<b.a.length;++d)c.push.apply(c,Vc(b.a[d]));b=c}else b=[];for(c=0;c<b.length;++c)d=b[c],d.a.a||d.b&&!od(d.b)||a.push(d.contentType,d);for(var c={},d=!1,e=0;e<b.length;++e){var f=b[e];if(f.a.a&&!a.a.hasOwnProperty(f.contentType)){var g=f.a.a,h=c[g];h||(h=f.a,h={audioCapabilities:void 0,videoCapabilities:void 0,initDataTypes:void 0,distinctiveIdentifier:h.g?"required":"optional",persistentState:h.i?"required":
"optional",sessionTypes:["temporary"]},c[g]=h);if(f.b&&(g=f.contentType+"Capabilities",g in h)){d=!0;h[g]||(h[g]=[]);var l;"audio"==f.contentType?l=f.a.f:"video"==f.contentType&&(l=f.a.l);h[g].push({contentType:f.b,robustness:l})}}}if(!d)if(b.length)this.a=b[0].a;else throw a=Error("No DrmInfo exists!"),a.type="drm",a;if(0==Object.keys(c).length)return pd(this.j,a),this.g.resolve(),Promise.resolve();l=new r;c=qd(c,l);c=c.then(this.bb.bind(this,b,a));c=c.then(this.Bb.bind(this));l.reject(null);return c};
function qd(a,b){for(var c in a)b=b.catch(function(a,b){return navigator.requestMediaKeySystemAccess(a,[b])}.bind(null,c,a[c]));return b}k=nd.prototype;
k.bb=function(a,b,c){if(!this.c)return rd();for(var d=c.keySystem,e=c.getConfiguration(),f=["audio","video"],g=0;g<f.length;++g){var h=f[g];if(!b.a.hasOwnProperty(h)){var l=e[h+"Capabilities"];if(l&&l.length){for(var l=l[0],m=[],q={},x=0;x<a.length;++x){var D=a[x];if(D.a.a==d&&D.b==l.contentType&&!(D.id in q)){m.push(D);q[D.id]=!0;var u;if(this.a){u=this.a;var D=D.a,E=new xa;E.a=u.a;E.h=u.h;E.j=u.j;E.o=u.o;E.u=u.u;E.g=u.g;E.i=u.i;E.f=u.f;E.l=u.l;E.c=u.c?new Uint8Array(u.c.buffer):null;ya(E,u.b);ya(E,
D.b);u=E}else u=D.a;this.a=u}}b.set(h,m)}}}pd(this.j,b);return c.createMediaKeys()};
k.Bb=function(a){if(!this.c)return rd();this.h=a;return this.c.setMediaKeys(this.h).then(t(this,function(){return this.c?this.a.c?this.h.setServerCertificate(this.a.c):Promise.resolve():rd()})).then(t(this,function(){if(!this.c)return rd();for(var a=0;a<this.a.b.length;++a){var c=this.a.b[a];this.Pa({type:"encrypted",initDataType:c.initDataType,initData:c.initData})}0==this.a.b.length&&G(this.i,this.c,"encrypted",this.Pa.bind(this))}))};
function rd(){var a=Error("EmeManager destroyed");a.type="destroy";return Promise.reject(a)}
k.Pa=function(a){for(var b=new Uint8Array(a.initData),c=0;c<this.b.length;++c)if(sa(b,this.b[c].data))return;try{var d=sd(this)}catch(e){b=B(e);this.dispatchEvent(b);this.g.reject(e);return}a=d.generateRequest(a.initDataType,a.initData);this.b.push({data:b,wa:d});a.catch(t(this,function(a){if(this.c){for(var b=0;b<this.b.length;++b)if(this.b[b].wa==d){this.b.splice(b,1);break}b=B(a);this.dispatchEvent(b);this.g.reject(a)}}));this.f.push(d)};
function sd(a){var b=null,b=a.h.createSession();G(a.i,b,"message",a.sb.bind(a));G(a.i,b,"keystatuseschange",a.hb.bind(a));return b}k.sb=function(a){td(this,a.target,this.a,a.message)};k.hb=function(a){a=a.target;for(var b=a.keyStatuses,c={},d=b.keys(),e=d.next();!e.done;e=d.next()){var f=ra(new Uint8Array(e.value)),e=b.get(e.value);c[f]=e}if(a.expiration<Date.now()){for(b=0;b<this.b.length;++b)if(this.b[b].wa==a){this.b.splice(b,1);break}a.close();this.f.splice(this.f.indexOf(a),1)}ud(this.j,c)};
function td(a,b,c,d){d=vd(c,d);md(new ld(d.url,d.body,d.method,c.j,d.headers)).then(t(a,function(a){c.o&&(a=c.o(a));return b.update(a)})).then(t(a,function(){var a=A({type:"sessionReady",detail:b});this.dispatchEvent(a);this.o++;this.o>=this.f.length&&this.g.resolve()})).catch(t(a,function(a){a.wa=b;a=B(a);this.dispatchEvent(a)}))}
function vd(a,b){var c={url:a.h,body:b.slice(0),method:"POST",headers:{}};if("com.microsoft.playready"===a.a){for(var d=String.fromCharCode.apply(null,new Uint16Array(c.body)),d=(new DOMParser).parseFromString(d,"application/xml"),e=d.getElementsByTagName("name"),f=d.getElementsByTagName("value"),g=0;g<e.length;g++)c.headers[e[g].childNodes[0].nodeValue]=f[g].childNodes[0].nodeValue;c.body=window.atob(d.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue)}if(!a.u)return c;a.u(c);c.url=v(c,
"url");if(null==c.url)throw Error("'url' cannot be null.");if(!(c.body instanceof ArrayBuffer||"string"==typeof c.body||null==c.body))throw new TypeError("'body' must be an ArrayBuffer, a string, or null.");c.method=v(c,"method");if("GET"!=c.method&&"POST"!=c.method)throw Error("'method' must be either 'GET' or 'POST'.");c.headers=ka(c,"headers",Object);if(null==c.headers)throw Error("'headers' cannot be null.");return c};function O(a){C.call(this,null);this.a=a;this.b=null;this.f=new F;this.i=this.j=null;this.A=0;this.u=null;this.h=!1;this.g=new hd;this.c={enableAdaptation:!0,streamBufferSize:15,liveStreamEndTimeout:15,licenseRequestTimeout:0,mpdRequestTimeout:0,segmentRequestTimeout:0,preferredLanguage:"en",restrictions:new ca};this.l=1;this.C=null}p(O,C);n("shaka.player.Player",O);O.version="v1.6.3";
O.isBrowserSupported=function(){return!!window.MediaSource&&!!window.MediaKeys&&!!window.navigator&&!!window.navigator.requestMediaKeySystemAccess&&!!window.MediaKeySystemAccess&&!!window.MediaKeySystemAccess.prototype.getConfiguration&&!!window.Promise&&!!Element.prototype.requestFullscreen&&!!document.exitFullscreen&&"fullscreenElement"in document&&!!window.Uint8Array};function od(a){return"text/vtt"==a?!!window.VTTCue:MediaSource.isTypeSupported(a)}O.isTypeSupported=od;
O.setTextStyle=function(a){var b=document.getElementById("ShakaPlayerTextStyle");b||(b=document.createElement("style"),b.id="ShakaPlayerTextStyle",document.head.appendChild(b));for(b=b.sheet;b.cssRules.length;)b.deleteRule(0);b.insertRule("::cue { "+mb(a)+" }",0)};O.prototype.destroy=function(){return this.o().then(t(this,function(){this.f.destroy();this.a=this.f=null})).catch(function(){})};O.prototype.destroy=O.prototype.destroy;
O.prototype.o=function(){if(!this.b)return Promise.resolve();this.h&&wd(this);this.a.pause();Ta(this.f);xd(this);yd(this);this.j&&(this.j.destroy(),this.j=null);this.a.src="";var a=this.a.setMediaKeys(null);this.b&&(this.b.destroy(),this.b=null);this.h=!1;this.g=new hd;return a};O.prototype.unload=O.prototype.o;
O.prototype.aa=function(a){var b=this.o();this.a.autoplay&&(pb("load"),G(this.f,this.a,"timeupdate",this.gb.bind(this)));a.Ia(this.c);a.T=this.C;this.C=null;b=b.then(t(this,function(){return a.ya()}));b.catch(t(this,function(b){a.destroy();return Promise.reject(b)}));return b.then(t(this,function(){if(!this.a)return zd();this.b=a;G(this.f,this.b,"seekrangechanged",this.qb.bind(this));this.j=new nd(this,this.a,this.b);return this.j.initialize()})).then(t(this,function(){if(!this.a)return zd();G(this.f,
this.a,"error",this.Cb.bind(this));G(this.f,this.a,"playing",this.ob.bind(this));G(this.f,this.a,"pause",this.nb.bind(this));var a;a=this.b;var b=this.a;a.D?(a.G=this,a.f=b,a.I=this.Wa(),G(a.i,a.g,"sourceopen",a.jb.bind(a)),G(a.i,a.aa,"bandwidth",a.Db.bind(a)),a.a.b&&(G(a.i,this,"bufferingStart",a.fb.bind(a)),G(a.i,this,"bufferingEnd",a.eb.bind(a))),b=a.f.mediaKeys,a.f.src=window.URL.createObjectURL(a.g),b=a.f.setMediaKeys(b),a=Promise.all([a.o,b])):(a=Error("Cannot call attach() right now."),a.type=
"app",a=Promise.reject(a));return a})).then(t(this,function(){if(!this.a)return zd();Ad(this)})).catch(t(this,function(a){if(!this.a)return zd();if("destroy"!=a.type){var b=B(a);this.dispatchEvent(b)}return this.o().then(function(){return Promise.reject(a)})}))};O.prototype.load=O.prototype.aa;function zd(){var a=Error("Player destroyed");a.type="destroy";return Promise.reject(a)}k=O.prototype;k.gb=function(){sb("load");this.g.playbackLatency=tb("load")/1E3;this.f.la(this.a,"timeupdate")};
k.Cb=function(){if(this.a.error){var a=this.a.error.code;a!=MediaError.MEDIA_ERR_ABORTED&&(a=Error(Bd[a]||"Unknown playback error."),a.type="playback",a=B(a),this.dispatchEvent(a))}};k.ob=function(){pb("playing");!this.i&&0>this.l&&(this.a.playbackRate=0,this.w(this.a.currentTime,Date.now(),this.l));this.h&&wd(this)};k.nb=function(){sb("playing");var a=tb("playing");if(!isNaN(a)){var b=this.g;b.playTime+=a/1E3}yd(this)};k.qb=function(a){this.A=a.start};
k.Wa=function(){if(!this.a.paused){sb("playing");var a=tb("playing");if(!isNaN(a)){var b=this.g;b.playTime+=a/1E3;pb("playing")}}a=this.g;b=this.a;b.getVideoPlaybackQuality&&(b=b.getVideoPlaybackQuality(),a.decodedFrames=b.totalVideoFrames,a.droppedFrames=b.droppedVideoFrames);return this.g};O.prototype.getStats=O.prototype.Wa;O.prototype.$=function(){return this.b?this.b.ja():[]};O.prototype.getVideoTracks=O.prototype.$;O.prototype.X=function(){return this.b?this.b.$():[]};
O.prototype.getAudioTracks=O.prototype.X;O.prototype.Z=function(){return this.b?this.b.Ja():[]};O.prototype.getTextTracks=O.prototype.Z;O.prototype.selectVideoTrack=function(a,b){return this.b?this.b.selectVideoTrack(a,void 0==b?!0:b):!1};O.prototype.selectVideoTrack=O.prototype.selectVideoTrack;O.prototype.ba=function(a,b,c){return this.b?Cd(this.b,"audio",a,void 0==b?!0:b,c):!1};O.prototype.selectAudioTrack=O.prototype.ba;O.prototype.fa=function(a){return this.b?Cd(this.b,"text",a,!1):!1};
O.prototype.selectTextTrack=O.prototype.fa;O.prototype.T=function(a){this.b&&Dd(this.b,a)};O.prototype.enableTextTrack=O.prototype.T;O.prototype.P=function(a){yd(this);0<=a?this.a.playbackRate=a:this.a.paused||(this.a.playbackRate=0,this.w(this.a.currentTime,Date.now(),a));this.l=a};O.prototype.setPlaybackRate=O.prototype.P;O.prototype.H=function(){return this.l};O.prototype.getPlaybackRate=O.prototype.H;O.prototype.ga=function(a){this.C=a};O.prototype.setPlaybackStartTime=O.prototype.ga;
O.prototype.D=function(){var a;this.b?(a=this.b,a=a.a?a.a.b:!1):a=!1;return a};O.prototype.isLive=O.prototype.D;
O.prototype.S=function(a){if(a){var b=ha(a,"enableAdaptation");null!=b&&(this.c.enableAdaptation=b);b=ja(a,"streamBufferSize");null!=b&&(this.c.streamBufferSize=b);b=ja(a,"liveStreamEndTimeout");null!=b&&(this.c.liveStreamEndTimeout=b);b=ja(a,"licenseRequestTimeout");null!=b&&(this.c.licenseRequestTimeout=b);b=ja(a,"mpdRequestTimeout");null!=b&&(this.c.mpdRequestTimeout=b);b=ja(a,"segmentRequestTimeout");null!=b&&(this.c.segmentRequestTimeout=b);b=v(a,"preferredLanguage");null!=b&&(this.c.preferredLanguage=
b);b=ka(a,"restrictions",ca);null!=b&&(this.c.restrictions=b.clone());a=ha(a,"disableCacheBustingEvenThoughItMayAffectBandwidthEstimation");null!=a&&(Dc=!a);this.b&&this.b.Ia(this.c)}};O.prototype.configure=O.prototype.S;O.prototype.Y=function(){return this.c};O.prototype.getConfiguration=O.prototype.Y;function yd(a){a.i&&(window.clearTimeout(a.i),a.i=null)}function Ad(a){xd(a);a.u=window.setTimeout(a.I.bind(a),100)}function xd(a){a.u&&(window.clearTimeout(a.u),a.u=null)}
O.prototype.w=function(a,b,c){this.i=null;var d=(Date.now()-b)/1E3*c;this.a.currentTime<this.A+(this.D()?1:.05)?this.a.pause():(d=Math.max(this.A,a+d),this.a.currentTime=d,this.i=window.setTimeout(this.w.bind(this,a,b,c),250))};function wd(a){sb("buffering");var b=a.g;b.bufferingTime+=tb("buffering")/1E3;a.h=!1;a.dispatchEvent(A({type:"bufferingEnd"}))}
O.prototype.I=function(){Ad(this);if(!this.a.ended&&!this.a.seeking){var a=this.a.buffered,b=a.length?a.end(a.length-1):0,a=Math.max(b-this.a.currentTime,0),c=this.a.duration,c=isNaN(c)?0:Math.max(c-.05,0),b=b>=c||this.a.currentTime>=c;if(this.h){if(c=Number(this.b.w.initialStreamBufferSize),b||a>c)wd(this),this.a.play()}else!this.a.paused&&!b&&.5>a&&(this.h=!0,this.a.pause(),this.g.bufferingHistory.push(z()/1E3),pb("buffering"),this.dispatchEvent(A({type:"bufferingStart"})))}};
var Bd={2:"A network failure occured while loading media content.",3:"The browser failed to decode the media content.",4:"The browser does not support the media content."};function Ed(a){for(var b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.a.length;++d){for(var e=c.a[d],f=e,g=0;g<f.m.length;++g)od(Sc(f.m[g]))||(f.m.splice(g,1),--g);0==e.m.length&&(c.a.splice(d,1),--d)}}function Fd(a){for(var b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.a.length;++d)c.a[d].m.sort(Gd)}function Gd(a,b){var c=a.bandwidth||Number.MAX_VALUE,d=b.bandwidth||Number.MAX_VALUE;return c<d?-1:c>d?1:0};function Hd(a){this.a=a}Hd.prototype.destroy=function(){this.a.destroy();this.a=null};Hd.prototype.update=function(a){var b=Id(a),c=Id(this.a);return Promise.all([b,c]).then(t(this,function(b){var c=b[0];b=b[1];var f=this.a.a;Ed(f);Fd(f);a.f=this.a.f;a.g=this.a.g?this.a.g.clone():null;a.c=this.a.c;f=[];Jd(a,this.a,c,b,f);c=a.a;Ed(c);Fd(c);return Promise.resolve(f)}))};
function Id(a){function b(a,b){return a.concat(b)}var c=a.a.map(function(a){return a.a}).reduce(b,[]).map(function(a){return a.m}).reduce(b,[]);a=c.map(function(a){return a.J.create()});return Promise.all(a).then(function(a){for(var b={},f=0;f<c.length;++f)b[c[f].B]=a[f];return Promise.resolve(b)})}
function Jd(a,b,c,d,e){var f=new w;a.a.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new w;b.a.forEach(function(a,b){g.push(a.id||""+b,a)});a=y(f);for(b=0;b<a.length;++b){var h=a[b],l=f.get(h);1<l.length||(h=g.get(h))&&0!=h.length&&1==h.length&&(Kd(l[0],h[0],c,d,e),l[0].b=h[0].b)}}
function Kd(a,b,c,d,e){var f=new w;a.a.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new w;b.a.forEach(function(a,b){g.push(a.id||""+b,a)});a=y(f);for(b=0;b<a.length;++b){var h=a[b],l=f.get(h);1<l.length||(h=g.get(h))&&0!=h.length&&1==h.length&&Ld(l[0],h[0],c,d,e)}}
function Ld(a,b,c,d,e){var f=new w;a.m.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new w;b.m.forEach(function(a,b){g.push(a.id||""+b,a)});b={};for(var h=y(f),l=0;l<h.length;++l){var m=h[l];b[m]=m;var q=f.get(m);1<q.length||((m=g.get(m))&&0!=m.length?1==m.length&&(Md(q[0],m[0],c,d),q[0].K=m[0].K,m[0].K=null,q[0].b=m[0].b):(e.push(q[0]),a.m.splice(a.m.indexOf(q[0]),1)))}h=y(g);for(l=0;l<h.length;++l)m=h[l],b[m]||(b[m]=m,m=g.get(m),a.m.push(m[0]))}
function Md(a,b,c,d){a=c[a.B];b=d[b.B];a.length();a.ua(b)&&a.length()};function P(){this.a=this.b=null;this.f=new F;this.c=Number.POSITIVE_INFINITY;this.i=!0;this.g=!1}n("shaka.media.SimpleAbrManager",P);P.prototype.destroy=function(){this.f.destroy();this.a=this.b=this.f=null};P.prototype.initialize=function(a,b){this.b||this.a||(this.b=a,this.a=b)};
P.prototype.start=function(){this.b&&this.a&&!this.g&&(this.c=Date.now()+4E3,G(this.f,this.b,"bandwidth",this.l.bind(this)),G(this.f,this.a,"adaptation",this.j.bind(this)),G(this.f,this.a,"trackschanged",this.h.bind(this)),this.g=!0)};P.prototype.enable=function(a){this.i=a};P.prototype.getInitialVideoTrackId=function(){if(!this.b||!this.a)return null;var a=Nd(this);return a?a.id:null};P.prototype.selectVideoTrack=function(a,b,c){this.g&&this.a.selectVideoTrack(a.id,b,c)};
P.prototype.l=function(){Date.now()<this.c||this.h()};P.prototype.h=function(){if(this.i){var a=Nd(this);if(a){if(a.active){this.c=Date.now()+3E3;return}this.selectVideoTrack(a,!1)}this.c=Number.POSITIVE_INFINITY}};P.prototype.j=function(){this.c==Number.POSITIVE_INFINITY&&(this.c=Date.now()+3E4)};
function Nd(a){var b=a.a.ja();if(0==b.length)return null;b.sort(ea);var c;a:{c=a.a.$();for(var d=0;d<c.length;++d)if(c[d].active){c=c[d];break a}c=null}c=c?c.bandwidth:0;a=a.b.getBandwidth();for(var d=b[0],e=0;e<b.length;++e){var f=b[e],g=e+1<b.length?b[e+1]:{bandwidth:Number.POSITIVE_INFINITY};if(f.bandwidth&&(g=(g.bandwidth+c)/.85,a>=(f.bandwidth+c)/.95&&a<=g&&(d=f,d.active)))break}return d};function Q(a,b,c){C.call(this,null);this.a=a;this.aa=b;this.i=new F;this.g=new MediaSource;this.f=null;this.ga=0;this.b=new w;this.A=c;this.A.initialize(b,this);this.D=!1;this.C="en";this.ba=!1;this.I=null;this.o=new r;this.h=new ca;this.u=null;this.Ha=1;this.c={};this.Y=new r;this.Fa=0;this.Ga=15;this.l=null;this.Ba=this.Ea=!1;this.j={};this.T=this.S=this.P=null;this.w={}}p(Q,C);n("shaka.player.StreamVideoSource",Q);
Q.prototype.Ia=function(a){null!=a.streamBufferSize&&(this.w.streamBufferSize=a.streamBufferSize);null!=a.segmentRequestTimeout&&(this.w.segmentRequestTimeout=a.segmentRequestTimeout);Od(this);null!=a.enableAdaptation&&this.A.enable(Boolean(a.enableAdaptation));null!=a.mpdRequestTimeout&&(this.ga=Number(a.mpdRequestTimeout));null!=a.liveStreamEndTimeout&&(this.Ga=Number(a.liveStreamEndTimeout));null!=a.preferredLanguage&&(this.C=Da(String(a.preferredLanguage)));null!=a.restrictions&&(this.h=a.restrictions,
this.D&&Pd(this))};Q.prototype.destroy=function(){this.o.destroy();this.Y.destroy();this.Y=this.o=null;this.S&&(window.clearTimeout(this.S),this.S=null);this.P&&(window.clearTimeout(this.P),this.P=null);this.j=null;this.i.destroy();this.i=null;ga(this.c).forEach(function(a){a.destroy()});this.b=this.c=null;this.a&&(this.a.destroy(),this.a=null);this.A.destroy();this.G=this.h=this.I=this.f=this.g=this.aa=this.A=null};k=Q.prototype;
k.ya=function(){if(this.D){var a=Error("Cannot call load() right now.");a.type="app";return Promise.reject(a)}if(!this.a||0==this.a.a.length)return a=Error("The manifest does not specify any content."),a.type="stream",Promise.reject(a);a=this.a.a;Ed(a);Fd(a);if(0==this.a.a.length||0==this.a.a[0].a.length)return a=Error("The manifest specifies content that cannot be displayed on this browser/platform."),a.type="stream",Promise.reject(a);this.D=!0;this.w.initialStreamBufferSize=this.a.c;Od(this);Pd(this);
return Promise.resolve()};k.Sa=function(a){var b=Date.now(),c=this.P=null,d=this.a.g;(a?this.Qa():this.Ra(d)).then(t(this,function(a){c=new Hd(a);return c.update(this.a)})).then(t(this,function(a){c.destroy();c=null;for(var d=0;d<a.length;++d)Qd(this,a[d]);this.w.initialStreamBufferSize=this.a.c;Od(this);Pd(this);0==Object.keys(this.c).length?Rd(this):Sd(this,(Date.now()-b)/1E3)})).catch(t(this,function(a){c&&(c.destroy(),c=null);"aborted"!=a.type&&(a=B(a),this.dispatchEvent(a),this.a&&Sd(this,0))}))};
k.Ra=function(){return Promise.reject("Cannot update manifest with this VideoSource implementation.")};k.Qa=function(){return Promise.reject("Cannot update manifest with this VideoSource implementation.")};function Sd(a,b){if(null!=a.a.f){var c=Math.max(a.a.f,3),c=Math.max(c-b,0);a.P=window.setTimeout(a.Sa.bind(a,!1),1E3*c)}}
function Qd(a,b){var c=b.a.split("/")[0],d=a.c[c];if(d&&d.ia()==b){var e=a.b.get(b.a.split("/")[0]).map(function(a){return a.m}).reduce(function(a,b){return a.concat(b)},[]).filter(function(a){return a.L&&a.F});if(0==e.length){c=Error("All usable streams have been removed from the manifest.");c.type="app";c=B(c);a.dispatchEvent(c);return}a.j[c].za==b&&delete a.j[c];d.ka(e[0],!0);b.destroy()}b.destroy()}
k.ja=function(){if(!this.b.a.hasOwnProperty("video"))return[];for(var a=this.c.video,a=(a=a?a.ia():null)?a.B:0,b=[],c=this.b.get("video"),d=0;d<c.length;++d)for(var e=c[d],f=0;f<e.m.length;++f){var g=e.m[f];if(g.L&&g.F){var h=g.B,g=new da(h,g.bandwidth,g.width,g.height);h==a&&(g.active=!0);b.push(g)}}return b};Q.prototype.getVideoTracks=Q.prototype.ja;
Q.prototype.$=function(){if(!this.b.a.hasOwnProperty("audio"))return[];for(var a=this.c.audio,a=(a=a?a.ia():null)?a.B:0,b=[],c=this.b.get("audio"),d=0;d<c.length;++d)for(var e=c[d],f=e.lang,g=0;g<e.m.length;++g){var h=e.m[g];if(h.L&&h.F){var l=h.B,h=new fa(l,h.bandwidth,f);l==a&&(h.active=!0);b.push(h)}}return b};Q.prototype.getAudioTracks=Q.prototype.$;
Q.prototype.Ja=function(){if(!this.b.a.hasOwnProperty("text"))return[];for(var a=this.c.text,b=a?a.ia():null,b=b?b.B:0,c=[],d=this.b.get("text"),e=0;e<d.length;++e)for(var f=d[e],g=f.lang,h=0;h<f.m.length;++h){var l=f.m[h].B,m=new ba(l,g);l==b&&(m.active=!0,m.enabled=a.qa());c.push(m)}return c};Q.prototype.getTextTracks=Q.prototype.Ja;
function pd(a,b){if(a.D){for(var c={},d=a.a.a[0],e=0;e<d.a.length;++e){var f=d.a[e];c[f.B]=f}a.b.a={};d=y(b);for(e=0;e<d.length;++e){var f=d[e],g=b.get(f);if("video"==f){var h=g[0].id;a.b.push(f,c[h])}else if("audio"==f)for(var h=g[0].b.split(";")[0],l=0;l<g.length;++l){var m=g[l];m.b.split(";")[0]==h&&a.b.push(f,c[m.id])}else for(l=0;l<g.length;++l)h=g[l].id,a.b.push(f,c[h])}a.ba=!0;if(c=a.b.get("audio"))Td(a,c),a.b.set("audio",c),c=c[0].lang||a.C,Ca(2,a.C,c)&&(a.ba=!1);if(c=a.b.get("text"))Td(a,
c),a.b.set("text",c),c=c[0].lang||a.C,Ca(2,a.C,c)||(a.ba=!1)}}Q.prototype.selectVideoTrack=function(a,b,c){return Cd(this,"video",a,b,c)};function Dd(a,b){var c=a.c.text;c&&c.ma(b)}
function Pd(a){if(a.h){for(var b=!1,c=0;c<a.a.a.length;++c)for(var d=a.a.a[c],e=0;e<d.a.length;++e){var f=d.a[e];if("video"==f.contentType)for(var g=0;g<f.m.length;++g){var h=f.m[g],l=h.F;h.F=!0;a.h.maxWidth&&h.width>a.h.maxWidth&&(h.F=!1);a.h.maxHeight&&h.height>a.h.maxHeight&&(h.F=!1);a.h.minHeight&&h.height<a.h.minHeight&&(h.F=!1);a.h.maxBandwidth&&h.bandwidth>a.h.maxBandwidth&&(h.F=!1);a.h.minBandwidth&&h.bandwidth<a.h.minBandwidth&&(h.F=!1);l!=h.F&&(b=!0)}}0!=ta(a.b).length&&b&&(Ud(a),0<a.ja().length||
(b=Error("The application has restricted all video tracks!"),b.type="app",b=B(b),a.dispatchEvent(b)))}}
function ud(a,b){for(var c,d=!1,e=new w,f=ta(a.b),g=0;g<f.length;++g)for(var h=f[g],l=0;l<h.m.length;++l){var m=h.m[l];m.f.forEach(function(a){e.push(a,m)})}for(c in b)if(f=na[b[c]]||null,h=e.get(c))for(g=0;g<h.length;++g)m=h[g],l=m.L,m.L=!f,l!=m.L&&(d=!0);else la(c);d&&(Ud(a),d=a.$(),c=a.ja(),d=a.b.a.hasOwnProperty("audio")&&0==d.length,c=a.b.a.hasOwnProperty("video")&&0==c.length,d||c)&&(c=Error("The key system has restricted all "+(d&&c?"audio and video tracks.":d?"audio tracks.":"video tracks.")),
c.type="drm",c=B(c),a.dispatchEvent(c))}function Ud(a){var b=A({type:"trackschanged",bubbles:!0});a.dispatchEvent(b)}function Cd(a,b,c,d,e){if(!a.b.a.hasOwnProperty(b)||!a.c[b])return!1;for(var f=a.b.get(b),g=0;g<f.length;++g)for(var h=f[g],l=0;l<h.m.length;++l){var m=h.m[l];if(m.B==c){if(!m.L||!m.F)return!1;if("text"!=b&&!a.Ba)return c=a.j[b],a.j[b]={za:m,Ka:null!=c&&c.Ka||d,La:null!=c&&c.La||e},!0;id(a.I,m);a.c[b].ka(m,d,e);return!0}}return!1}
function Td(a,b){for(var c=0;2>=c;++c)for(var d=0;d<b.length;++d){var e=b[d];if(Ca(c,a.C,e.lang)){b.splice(d,1);b.splice(0,0,e);return}}for(d=0;d<b.length;++d)if(e=b[d],e.b){b.splice(d,1);b.splice(0,0,e);break}}k=Q.prototype;k.jb=function(){this.i.la(this.g,"sourceopen");Rd(this).then(t(this,function(){this.o&&this.o.resolve()})).catch(t(this,function(a){this.o&&this.o.reject(a)}))};
function Rd(a){for(var b=[],c=["audio","video","text"],d=0;d<c.length;++d){var e=c[d];a.b.a.hasOwnProperty(e)&&b.push(a.b.get(e)[0])}for(var f=Vd(a,b),d=0;d<c.length;++d)if(e=c[d],a.b.a.hasOwnProperty(e)&&!f[e])return a=Error("Unable to select an initial "+e+" stream: all "+e+" streams have been restricted (by the application or by the key system)."),a.type="stream",Promise.reject(a);b=ga(f).map(function(a){return a.J.create()});return Promise.all(b).then(t(a,function(a){if(!a.every(function(a){return a.length()}))return a=
Error("Some streams are not available."),a.type="stream",Promise.reject(a);a=Wd(this,a);if(!a)return a=Error("Some streams are not available."),a.type="stream",Promise.reject(a);if(!Xd(this,f))return a=Error("Failed to create Stream objects."),a.type="stream",Promise.reject(a);this.A.start();Yd(this,f,a);return Promise.resolve()})).catch(t(a,function(a){if("aborted"!=a.type)return Object.keys(this.c),this.a.b?(z()<this.a.h?(a=Math.max(this.a.h-Date.now()/1E3,3),this.P=window.setTimeout(this.Sa.bind(this,
!0),1E3*a)):Sd(this,0),Promise.resolve()):Promise.reject(a)}))}function Vd(a,b){for(var c={},d=0;d<b.length;++d){var e=b[d],f=null;if("video"==e.contentType){var g=a.A.getInitialVideoTrackId();if(null==g)continue;f=e.m.filter(function(a){return a.B==g});if(0==f.length)continue;f=f[0]}else if("audio"==e.contentType){f=e.m.filter(function(a){return a.L&&a.F});if(0==f.length)continue;f=e.m[Math.floor(f.length/2)]}else 0<e.m.length&&(f=e.m[0]);c[e.contentType]=f}return c}
function Xd(a,b){var c={},d;for(d in b){var e=b[d],e="text"==d?new Zc(a,a.f):Zd(a,e);if(!e)return ga(c).forEach(function(a){a.destroy()}),!1;c[d]=e}a.c=c;return!0}function Zd(a,b){var c=new $c(a,a.f,a.g,Sc(b),a.aa);c.C(a.w);return c}
function Yd(a,b,c){a.Ha=a.f.playbackRate;a.f.playbackRate=0;$d(a,c);var d;a.T&&a.T<=c.end&&a.T>=c.start?d=a.T:a.a.b?(d=c.end,a.Ea=!0):d=c.start;G(a.i,a.f,"seeking",a.rb.bind(a));a.f.currentTime!=d&&(a.f.currentTime=d,a.u=d);ae(a,c.start,c.end);c=[];for(var e in a.c){d=a.c[e];c.push(d.Ya(a.Y));G(a.i,d,"ended",a.tb.bind(a));var f=b[e];id(a.I,f);d.ka(f,!1)}Promise.all(c).then(a.cb.bind(a)).catch(t(a,function(a){"destroy"!=a.type&&(a=B(a),this.dispatchEvent(a))}));Dd(a,a.ba)}
k.cb=function(a){wa(a&&a.length==Object.keys(this.c).length);for(var b=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,d=0;d<a.length;++d)var e=a[d],b=Math.min(b,e),c=Math.max(c,e);a=be(this);for(d=0;d<a.length;++d)a[d].da(c);ce(this,a,c);d=ta(this.b).map(function(a){return a.m}).reduce(function(a,b){return a.concat(b)},[]).map(function(a){var b=[a.J.create()];a.K&&b.push(a.K.create());return Promise.all(b)});Promise.all(d).then(t(this,function(a){for(var b=0;b<a.length;++b)a[b][0].da(c);this.Ba=
!0;for(var d in this.j)a=this.j[d],b=this.c[d],id(this.I,a.za),b.ka(a.za,a.Ka,a.La);this.j={}})).catch(t(this,function(a){"aborted"!=a.type&&(a=B(a),this.dispatchEvent(a))}))};function ce(a,b,c){if(b=Wd(a,b))$d(a,b),ae(a,b.start,b.end);0!=c&&(c=a.f.currentTime+c,a.f.currentTime=c,a.u=c);a.Ea&&b&&(a.f.currentTime=b.end);a.f.playbackRate=a.Ha;a.a.b&&null!=a.a.f&&Sd(a,0);de(a);a.Y.resolve()}
function $d(a,b){if(a.a.b)isNaN(a.g.duration)&&(a.g.duration=b.end+2592E3);else if(isNaN(a.g.duration)||b.end>a.g.duration){a.g.duration=b.end;for(var c=0;c<a.g.sourceBuffers.length;++c)a.g.sourceBuffers[c].appendWindowEnd=b.end}}k.vb=function(){this.S=null;de(this);var a=Wd(this,be(this));a&&(this.a.b&&this.Fa!=a.v&&(this.Fa=a.v,null!=this.l&&(window.clearTimeout(this.l),this.l=null)),ae(this,a.start,a.end),this.f.paused||ee(this,this.f.currentTime,a.start,a.end))};
function ae(a,b,c){b=A({type:"seekrangechanged",bubbles:!0,start:b,end:c});a.dispatchEvent(b)}k.rb=function(){var a=this.f.currentTime;if(null!=this.u){if(a>=this.u-.01&&a<=this.u+.01){this.u=null;return}this.u=null}var b=Wd(this,be(this));if(b){var c=b.end;(b=ee(this,a,b.start,c))||(a<=c+.01?b=!1:(this.f.currentTime=c,b=!0));if(!b)for(var d in this.c)this.c[d].Ua()}};
function ee(a,b,c,d){if(b>=c-.01)return!1;b=0;if(a.a.b){b=.5;for(var e in a.c)if(!a.c[e].Va(c+b)){b=a.a.c;break}}a.f.currentTime=Math.min(c+b,d);return!0}k.tb=function(){if(!this.a.b){for(var a in this.c)if(!this.c[a].ta())return;this.Na()}};k.fb=function(){ga(this.c).every(function(a){return a.ta()})&&(this.l=window.setTimeout(this.Na.bind(this),1E3*this.Ga))};k.eb=function(){null!=this.l&&(window.clearTimeout(this.l),this.l=null)};
k.Db=function(){var a=this.I,b=this.aa.getBandwidth();a.estimatedBandwidth=b;a.bandwidthHistory.push(new kd(b))};k.Na=function(){this.l=null;this.g.endOfStream()};function be(a){return ga(a.c).map(function(a){return a.Oa()}).filter(function(a){return null!=a})}
function Wd(a,b){for(var c=0,d=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,f=0;f<b.length;++f){var g=b[f].ra(),c=Math.max(c,g.start);null!=g.end&&(d=Math.min(d,g.end));b[f].length()&&(e=Math.min(e,b[f].v().a))}if(d==Number.POSITIVE_INFINITY)if(d=a.a.a[0],d.b)d=(d.start||0)+d.b;else return null;a.a.b&&(d=Math.max(d-a.a.c,c));return c>d?null:{start:c,end:d,v:e}}function de(a){a.a.b&&(a.S=window.setTimeout(a.vb.bind(a),1E3))}function Od(a){for(var b in a.c)a.c[b].C(a.w)};function R(a,b,c,d){M.call(this,a);this.h=b;this.w=c;this.g=d;this.i=this.h.b||this.h.a.reduce(function(a,b){return null==b.a?NaN:a+b.a},0)||0;this.b=this.u=this.f=null;fe(this)}p(R,M);R.prototype.destroy=function(){this.w=this.h=null;M.prototype.destroy.call(this)};R.prototype.ea=function(a){ge(this,z()/1E3);return M.prototype.ea.call(this,a)};R.prototype.ua=function(a){if(!(a instanceof R))return!1;Oc(this,a);this.i=Math.max(this.i,a.i);null==this.f?(this.g=a.g,fe(this)):he(this);return!0};
function fe(a){he(a);if(0!=a.length()){a.length();var b=null!=a.v().a?a.v().a:a.v().b;if(a.h.c>a.g)a.f=b;else{var c=a.g-(a.h.c+a.w.start);0>c?a.f=b:c<Math.max(a.v().b,a.v().a||0)?(a.v(),a.f=b):a.f=c}a.u=a.v().b;a.b=N(a).b}}R.prototype.da=function(a){a=M.prototype.da.call(this,a);Math.min.apply(null,this.a.filter(function(a){return null!=a.a}).map(function(a){return a.a-a.b}));null!=this.f&&(this.u+=a,this.b+=a,this.f+=a);return a};R.prototype.ra=function(){return ie(this,z()/1E3)};
function ie(a,b){ge(a,b);if(null==a.f||null==a.u||null==a.b)return{start:0,end:0};var c=Number.POSITIVE_INFINITY;a.i&&(c=a.i);var d=b-a.g,e=a.f+d;null!=a.h.f&&(e=e-a.b-a.h.f,0<e&&(a.b+=e));a.b=Math.min(a.b,c);d=a.u+d;if(d<a.b)return{start:a.b,end:a.b};d=0<a.length()?null!=a.v().a?Math.min(d,a.v().a):d:a.b;d=Math.max(d,a.b);d=Math.min(d,c);return{start:a.b,end:d}}
function ge(a,b){he(a);if(null!=a.h.f)if(null==a.f)a.length();else{for(var c=a.f+(b-a.g),d=0,e=0;e<a.a.length;++e){var f=null;e<a.a.length-1?f=a.a[e+1].a:(f=a.a[e],f=null!=f.a?f.a+(f.a-f.b):null);if(null!=f&&f<c-a.h.f)++d;else break}0<d&&a.a.splice(0,d)}}function he(a){if(a.i){for(var b=0,c=a.a.length-1;0<=c;--c)if(a.a[c].b>a.i)++b;else break;0<b&&a.a.splice(-b)}};function je(a,b,c,d,e){this.b=a;this.c=b;this.f=c;this.h=d;this.a=null;this.g=e}je.prototype.destroy=function(){this.g=this.f=this.c=this.b=null;this.a&&(this.a.destroy(),this.a=null)};
je.prototype.create=function(){if(this.a)return Promise.resolve(this.a);for(var a=this.f.a,b=ke(a.c,a.a||1,this.c.a||0),c=[],d=0;d<b.length;++d){var e=b[d].start,f=e/a.a,g=b[d].end/a.a,e=le(this.g,this.f,d+a.j,e);if(!e)return a=Error("Failed to generate media URL."),a.type="dash",Promise.reject(a);var h=(a.i||0)/a.a;c.push(new Lc(f-h,g-h,e))}"dynamic"==this.b.type?this.a=new R(c,this.b,this.c,this.h):this.a=new M(c);return Promise.resolve(this.a)};function me(){this.id=this.url=null;this.type="static";this.b=this.j=this.s=this.Ta=null;this.h=5;this.f=this.c=this.g=null;this.i=1;this.a=[]}function ne(){this.g=this.f=this.c=this.s=this.a=this.start=this.id=null;this.b=[]}function oe(){this.i=this.b=this.height=this.width=this.contentType=this.lang=this.group=this.id=null;this.c=!1;this.h=this.g=this.f=this.s=null;this.j=[];this.a=[]}function pe(){this.value=null}function qe(){this.contentType=this.lang=this.id=null}
function re(){this.a=this.b=this.g=this.s=this.h=this.f=this.height=this.width=this.bandwidth=this.lang=this.id=null;this.c=[]}function se(){this.b=this.a=this.c=this.f=null}function te(){this.parsedPssh=this.psshBox=null}function ue(){this.url=null}function ve(){this.url=null}function we(){this.s=null;this.c=1;this.g=this.f=this.a=this.b=null}we.prototype.clone=function(){var a=new we;a.s=xe(this.s);a.c=this.c;a.b=this.b;a.a=S(this.a);a.f=S(this.f);a.g=S(this.g);return a};
function ye(){this.a=this.url=null}ye.prototype.clone=function(){var a=new ye;a.url=xe(this.url);a.a=S(this.a);return a};function ze(){this.a=this.url=null}ze.prototype.clone=function(){var a=new ze;a.url=xe(this.url);a.a=S(this.a);return a};function Ae(){this.s=null;this.f=1;this.b=this.g=null;this.i=1;this.h=null;this.a=[];this.c=null}Ae.prototype.clone=function(){var a=new Ae;a.s=xe(this.s);a.f=this.f;a.g=this.g;a.b=this.b;a.i=this.i;a.h=S(this.h);a.a=xe(this.a)||[];a.c=S(this.c);return a};
function Be(){this.a=this.b=null}Be.prototype.clone=function(){var a=new Be;a.b=xe(this.b);a.a=S(this.a);return a};function Ce(){this.a=1;this.b=this.i=null;this.j=1;this.c=this.g=this.f=this.h=null}Ce.prototype.clone=function(){var a=new Ce;a.a=this.a;a.i=this.i;a.b=this.b;a.j=this.j;a.h=this.h;a.f=this.f;a.g=this.g;a.c=S(this.c);return a};function De(){this.a=[]}De.prototype.clone=function(){var a=new De;a.a=xe(this.a)||[];return a};function Ee(){this.c=this.a=this.b=null}
Ee.prototype.clone=function(){var a=new Ee;a.b=this.b;a.a=this.a;a.c=this.c;return a};function Fe(a,b){this.ha=a;this.end=b}Fe.prototype.clone=function(){return new Fe(this.ha,this.end)};me.TAG_NAME="MPD";ne.TAG_NAME="Period";oe.TAG_NAME="AdaptationSet";pe.TAG_NAME="Role";qe.TAG_NAME="ContentComponent";re.TAG_NAME="Representation";se.TAG_NAME="ContentProtection";te.TAG_NAME="cenc:pssh";ue.TAG_NAME="BaseURL";ve.TAG_NAME="Location";we.TAG_NAME="SegmentBase";ye.TAG_NAME="RepresentationIndex";
ze.TAG_NAME="Initialization";Ae.TAG_NAME="SegmentList";Be.TAG_NAME="SegmentURL";Ce.TAG_NAME="SegmentTemplate";De.TAG_NAME="SegmentTimeline";Ee.TAG_NAME="S";
me.prototype.parse=function(a,b){this.url=a.Ta;this.id=T(b,"id",U);this.type=T(b,"type",U)||"static";this.b=T(b,"mediaPresentationDuration",Ge);this.h=T(b,"minBufferTime",Ge,this.h);this.g=T(b,"minimumUpdatePeriod",Ge,this.g);this.c=T(b,"availabilityStartTime",He,this.c);this.f=T(b,"timeShiftBufferDepth",Ge,this.f);this.i=T(b,"suggestedPresentationDelay",Ge,this.i);var c=a.s,d=V(this,b,ue);this.s=Ie(c,d);if(d=W(this,b,ve))this.j=Je(c,d.url);this.a=V(this,b,ne)};
ne.prototype.parse=function(a,b){this.id=T(b,"id",U);this.start=T(b,"start",Ge);this.a=T(b,"duration",Ge);var c=V(this,b,ue);this.s=Ie(a.s,c);this.c=W(this,b,we);this.f=W(this,b,Ae);this.g=W(this,b,Ce);this.b=V(this,b,oe);Ke(this)};function Ke(a){for(var b=[],c=0;c<a.b.length;++c){var d=a.b[c];null!=d.group&&(b[d.group]=!0)}for(c=0;c<a.b.length;++c)if(d=a.b[c],null==d.group){for(var e=1;1==b[e];)++e;b[e]=!0;d.group=e}}
oe.prototype.parse=function(a,b){var c=W(this,b,qe)||{},d=W(this,b,pe);this.id=T(b,"id",U);this.group=T(b,"group",X);this.lang=T(b,"lang",U,c.lang);this.contentType=T(b,"contentType",U,c.contentType);this.width=T(b,"width",Y);this.height=T(b,"height",Y);this.b=T(b,"mimeType",U);this.i=T(b,"codecs",U);this.c=d&&"main"==d.value;this.lang&&(this.lang=Da(this.lang));c=V(this,b,ue);this.s=Ie(a.s,c);this.j=V(this,b,se);!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]);this.f=a.c?Le(this,
b,a.c):W(this,b,we);this.g=a.f?Le(this,b,a.f):W(this,b,Ae);this.h=a.g?Le(this,b,a.g):W(this,b,Ce);this.a=V(this,b,re);!this.b&&this.a.length&&(this.b=this.a[0].f,!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]))};pe.prototype.parse=function(a,b){this.value=T(b,"value",U)};qe.prototype.parse=function(a,b){this.id=T(b,"id",U);this.lang=T(b,"lang",U);this.contentType=T(b,"contentType",U);this.lang&&(this.lang=Da(this.lang))};
re.prototype.parse=function(a,b){this.id=T(b,"id",U);this.bandwidth=T(b,"bandwidth",Y);this.width=T(b,"width",Y,a.width);this.height=T(b,"height",Y,a.height);this.f=T(b,"mimeType",U,a.b);this.h=T(b,"codecs",U,a.i);this.lang=a.lang;var c=V(this,b,ue);this.s=Ie(a.s,c);this.c=V(this,b,se);this.g=a.f?Le(this,b,a.f):W(this,b,we);this.b=a.g?Le(this,b,a.g):W(this,b,Ae);this.a=a.h?Le(this,b,a.h):W(this,b,Ce);this.c=this.c.concat(a.j)};
se.prototype.parse=function(a,b){this.f=b;this.c=T(b,"schemeIdUri",U);var c=T(b,"cenc:default_KID",U);c&&(this.b=c.replace(/[-]/g,""));this.a=W(this,b,te)};te.prototype.parse=function(a,b){var c=Me(b);if(c){this.psshBox=qa(c);try{this.parsedPssh=new ob(this.psshBox)}catch(d){if(!(d instanceof RangeError))throw d;}}};ue.prototype.parse=function(a,b){this.url=Me(b)};ve.prototype.parse=function(a,b){this.url=Me(b)};
we.prototype.parse=function(a,b){this.s=a.s||this.s;this.c=T(b,"timescale",Y,this.c);this.b=T(b,"presentationTimeOffset",X,this.b);this.a=T(b,"indexRange",Ne,this.a);this.f=W(this,b,ye)||this.f;this.g=W(this,b,ze)||this.g};ye.prototype.parse=function(a,b){var c=T(b,"sourceURL",U);this.url=Je(a.s,c);this.a=T(b,"range",Ne,S(a.a))};ze.prototype.parse=function(a,b){var c=T(b,"sourceURL",U);this.url=Je(a.s,c);this.a=T(b,"range",Ne)};
Ae.prototype.parse=function(a,b){this.s=a.s||this.s;this.f=T(b,"timescale",Y,this.f);this.g=T(b,"presentationTimeOffset",X,this.g);this.b=T(b,"duration",Y,this.b);var c=T(b,"startNumber",Y);null!=c&&(this.i=c);this.h=W(this,b,ze)||this.h;this.a=(c=V(this,b,Be))&&0<c.length?c:this.a;this.c=W(this,b,De)||this.c};Be.prototype.parse=function(a,b){var c=T(b,"media",U);this.b=Je(a.s,c);this.a=T(b,"mediaRange",Ne)};
Ce.prototype.parse=function(a,b){this.a=T(b,"timescale",Y,this.a);this.i=T(b,"presentationTimeOffset",X,this.i);this.b=T(b,"duration",Y,this.b);var c=T(b,"startNumber",X);null!=c&&(this.j=c);this.h=T(b,"media",U,this.h);this.f=T(b,"index",U,this.f);this.g=T(b,"initialization",U,this.g);this.c=W(this,b,De)||this.c};De.prototype.parse=function(a,b){this.a=V(this,b,Ee)};Ee.prototype.parse=function(a,b){this.b=T(b,"t",X);this.a=T(b,"d",X);this.c=T(b,"r",Oe)};
function Ie(a,b){if(!b||0===b.length)return a;for(var c=[],d=0;d<b.length;d++){var e=b[d].url;null==a||0===a.length?c.push(new K(e)):(e=Je(a.slice(0,1),e),c.push(e[0]))}return c}function Je(a,b){if(!b)return a;var c=new K(b);return a?a.map(function(a){return a.resolve(c)}):[c]}function Le(a,b,c){var d=S(c);(b=Pe(b,c.constructor.TAG_NAME))&&d.parse(a,b);return d}function W(a,b,c){var d=null;if(b=Pe(b,c.TAG_NAME))d=new c,d.parse(a,b);return d}
function Pe(a,b){for(var c=null,d=0;d<a.childNodes.length;d++)if(a.childNodes[d].tagName==b){if(c)return null;c=a.childNodes[d]}return c}function V(a,b,c){for(var d=[],e=0;e<b.childNodes.length;e++)if(b.childNodes[e].tagName==c.TAG_NAME){var f=new c;f.parse.call(f,a,b.childNodes[e]);d.push(f)}return d}function Me(a){a=a.firstChild;return a.nodeType!=Node.TEXT_NODE?null:a.nodeValue}function xe(a){return a?a.map(function(a){return a.clone()}):null}function S(a){return a?a.clone():null}
function T(a,b,c,d){a=c(a.getAttribute(b));return null!=a?a:void 0!==d?d:null}function He(a){if(!a)return null;a=Date.parse(a);return isNaN(a)?null:Math.floor(a/1E3)}
function Ge(a){if(!a)return null;var b=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(a);if(!b)return null;a=0;var c=X(b[1]);c&&(a+=31536E3*c);(c=X(b[2]))&&(a+=2592E3*c);(c=X(b[3]))&&(a+=86400*c);(c=X(b[4]))&&(a+=3600*c);(c=X(b[5]))&&(a+=60*c);b=window.parseFloat(b[6]);(b=isNaN(b)?null:b)&&(a+=b);return a}
function Ne(a){var b=/([0-9]+)-([0-9]+)/.exec(a);if(!b)return null;a=X(b[1]);if(null==a)return null;b=X(b[2]);return null==b?null:new Fe(a,b)}function Oe(a){a=window.parseInt(a,10);return isNaN(a)?null:a}function Y(a){a=window.parseInt(a,10);return 0<a?a:null}function X(a){a=window.parseInt(a,10);return 0<=a?a:null}function U(a){return a};function Qe(a,b,c,d){for(var e=b.a,f=[],g=0;g<d;++g){var h=g+c,l=(h-1)*e.b,m=l/e.a,q=(l+e.b)/e.a,h=le(a,b,e.j+h-1,l);if(!h)return null;f.push(new Lc(m,q,h))}return f}function le(a,b,c,d){if(!b.a)return null;var e=b.a.h;if(!e)return b.s?new H(a,b.s,0,null):null;c=Re(e,b.id,c,b.bandwidth,d);if(!c)return null;b=Ic(b.s,c);return new H(a,b,0,null)}
function Re(a,b,c,d,e){var f={RepresentationID:b,Number:c,Bandwidth:d,Time:e};a=a.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)d)?\$/g,function(a,b,c){if("$$"==a)return"$";var d=f[b];if(null==d)return a;"RepresentationID"==b&&c&&(c=void 0);a=d.toString();c=window.parseInt(c,10)||1;c=Math.max(0,c-a.length);return Array(c+1).join("0")+a});try{return new K(a)}catch(g){if(g instanceof URIError)return null;throw g;}}
function ke(a,b,c){var d=0;b*=c;a=a.a;c=[];for(var e=0;e<a.length&&a[e].a;++e){var f=a[e].b,f=null!=f?f:d,g=a[e].c||0;0>g&&(g=a[e].a,g=e+1===a.length?Math.ceil((a[0].b+b-f)/g)-1:Math.ceil((a[e+1].b-f)/g)-1);0<c.length&&f!=d&&(c[c.length-1].end=f);for(var h=0;h<=g;++h)d=f+a[e].a,c.push({start:f,end:d}),f=d}return c};function Se(a,b){this.a=new ab;this.a.f="text";this.a.a=3;this.a.c=1E3*(null!=b?b:0);this.a.g=!0;this.b=a}function Te(a){var b=a.b;return bb(b,a.a).then(function(a){var d;d=b.c;var e=[b.f];d=(a=(new DOMParser).parseFromString(a,"text/xml"))?W({Ta:d,s:e},a,me):null;if(d)return Promise.resolve(d);d=Error("MPD parse failure.");d.type="dash";return Promise.reject(d)})};function Ue(a,b,c,d,e){this.c=a;this.b=b;this.g=c;this.a=null;this.h=d;this.f=e}Ue.prototype.destroy=function(){this.f=this.g=this.b=this.c=null;this.a&&(this.a.destroy(),this.a=null)};
Ue.prototype.create=function(){if(this.a)return Promise.resolve(this.a);var a=this.g.b,b=[];a.c&&(b=ke(a.c,a.f||1,this.b.a||0));var c=0;a.b&&a.i?c=(a.i-1)*a.b:0<b.length&&(c=b[0].start-(a.g||0));var d=a.a.length;0<b.length&&b.length!=a.a.length&&(d=Math.min(b.length,a.a.length));for(var e=[],f=0;f<d;++f){var g=a.a[f],h=c/a.f,l=null,m=null;a.b?(l=c+a.b,m=l/a.f):0<b.length?(l=b[f].end-(a.g||0),m=l/a.f):(m=h+this.b.a,l=m*a.f);var c=l,l=0,q=null;g.a&&(l=g.a.ha,q=g.a.end);e.push(new Lc(h,m,new H(this.f,
g.b,l,q)))}"dynamic"==this.c.type?this.a=new R(e,this.c,this.b,this.h):this.a=new M(e);return Promise.resolve(this.a)};function Ve(a,b,c,d,e){var f=1,g=0,h;if(a.c>d)h=null;else{var l=a.i||0,m=a.f||0;h=c.a;h=h.b/h.a;var q=d-(a.c+b.start);0>q?h=null:(m=q-2*h-m,0>m&&(m=0),m=Math.ceil(m/h)*h,q-=h,0>q?h=null:(l=Math.floor(q/h)*h-l,0>l&&(l=0),l=Math.floor(l/h)*h,h={Ma:m/h+1,current:(l>=m?l:m)/h+1}))}h&&(f=h.Ma,g=h.current-h.Ma+1);f=Qe(e,c,f,g);if(null==f)throw a=Error("Failed to generate SegmentReferences."),a.type="stream",a;R.call(this,f,a,b,d);this.G=c;this.o=this.c=0<this.length()?a.c+b.start+this.v().a:null;this.l=
h?h.current+1:null;this.A=e}p(Ve,R);Ve.prototype.destroy=function(){this.A=this.G=null;R.prototype.destroy.call(this)};Ve.prototype.ea=function(a){var b=z()/1E3;We(this,b);ge(this,b);return M.prototype.ea.call(this,a)};Ve.prototype.ua=function(a){if(null!=this.c||!(a instanceof Ve)||null==a.c)return!1;this.c=a.c;this.o=a.o;this.l=a.l;this.g=a.g;this.i=a.i;Oc(this,a);We(this,z()/1E3);fe(this);return!0};Ve.prototype.da=function(a){a=R.prototype.da.call(this,a);null!=this.c&&(this.c+=a,this.o+=a);return a};
Ve.prototype.ra=function(){var a=z()/1E3;We(this,a);return ie(this,a)};function We(a,b){if(null!=a.c&&null!=a.o&&null!=a.l){var c=a.G.a,c=c.b/c.a,d=Math.floor((a.o+(b-a.g)-a.c)/c);if(0!=d){var e=Qe(a.A,a.G,a.l,d);Array.prototype.push.apply(a.a,Nc(e,a.j));a.c+=d*c;a.l+=d}}};function Xe(a,b,c,d,e){this.f=a;this.b=b;this.c=c;this.h=d;this.a=null;this.g=e}Xe.prototype.destroy=function(){this.g=this.c=this.b=this.f=null;this.a&&(this.a.destroy(),this.a=null)};
Xe.prototype.create=function(){if(this.a)return Promise.resolve(this.a);if("dynamic"==this.f.type)try{this.a=new Ve(this.f,this.b,this.c,this.h,this.g)}catch(a){return Promise.reject(a)}else{var b;b=this.c.a;if(b=Qe(this.g,this.c,1,Math.ceil(this.b.a/(b.b/b.a)))){if(0<b.length){var c=b[b.length-1];b[b.length-1]=Mc(c,c.b,this.b.a)}b=new M(b)}else b=null;this.a=b;if(!this.a)return b=Error("Failed to generate SegmentReferences"),b.type="stream",Promise.reject(b)}return Promise.resolve(this.a)};function Ye(a){this.a=a}
function Ze(a,b,c){for(var d=z()/1E3,e=0;e<b.a.length;++e)for(var f=b.a[e],g=0;g<f.b.length;++g){var h=f.b[g];if("text"!=h.contentType)for(var l=0;l<h.a.length;++l){var m=h.a[l],q=0,q=q+(m.g?1:0),q=q+(m.b?1:0),q=q+(m.a?1:0);0==q?(h.a.splice(l,1),--l):1!=q&&(m.g?(m.b=null,m.a=null):m.b&&(m.a=null))}}$e(b);for(e=0;e<b.a.length;++e)for(f=b.a[e],g=0;g<f.b.length;++g){l=h=f.b[g];m=null;for(q=0;q<l.a.length;++q){var x=l.a[q].f||"";m?x!=m&&(l.a.splice(q,1),--q):m=x}0==h.a.length&&(f.b.splice(g,1),--g)}"dynamic"==
b.type&&null==b.c&&(b.c=d);e=new Yc;"dynamic"==b.type&&(e.b=!0,e.f=b.g,e.g=new H(c,b.j||b.url),e.h=b.c);e.c=b.h||5;for(f=0;f<b.a.length;++f){g=b.a[f];if(null==g.start)break;g=af(a,b,g,d,c);e.a.push(g)}return e}
function $e(a){if(a.a.length){null==a.a[0].start&&(a.a[0].start=0);var b=function(a){return 0==a||!!a};"dynamic"==a.type&&(a.b=null);b(a.b)&&1==a.a.length&&!b(a.a[0].a)&&(a.a[0].a=a.b);for(var c=0,d=!0,e=0;e<a.a.length;++e){var f=a.a[e-1],g=a.a[e],h=a.a[e+1]||{start:a.b};!b(g.start)&&f&&b(f.start)&&b(f.a)&&(g.start=f.start+f.a);!b(g.a)&&b(h.start)&&(g.a=h.start-g.start);null!=g.start&&null!=g.a?c+=g.a:d=!1}b(a.b)||(e=a.a[a.a.length-1],d?a.b=c:b(e.start)&&b(e.a)?a.b=e.start+e.a:"dynamic"!=a.type&&
(a.b=c))}}function af(a,b,c,d,e){var f=new Xc;f.id=c.id;f.start=c.start;f.b=c.a;var g=new w;c.b.forEach(function(a){g.push(a.contentType||"",a)});for(var h=y(g),l=0;l<h.length;++l){var m=new w;g.get(h[l]).forEach(function(a){m.push(a.group,a)});for(var q=y(m),x=0;x<q.length;++x){var D=new w;m.get(q[x]).forEach(function(a){D.push(a.lang,a)});for(var u=y(D),E=0;E<u.length;++E){var zc=D.get(u[E]),zc=bf(a,b,c,zc,d,e);f.a.push(zc)}}}return f}
function bf(a,b,c,d,e,f){wa(d.every(function(a){return a.group==d[0].group&&(a.lang||"")==(d[0].lang||"")&&(a.contentType||"")==(d[0].contentType||"")}));var g=new Tc,h=d.filter(function(a){return null!=a.id});h.length==d.length&&(g.id=h.map(function(a){return a.id}).sort().reduce(function(a,b){return a+","+b}));g.lang=d[0].lang||"";g.contentType=d[0].contentType||"";g.b=d.some(function(a){return a.c});for(var h={},l=0;l<d.length;++l)for(var m=d[l],q=0;q<m.a.length;++q){var x=m.a[q],D=cf(a,x),u=g.a.slice(0);
df(D,u);0==u.length&&0<g.a.length||!(x=ef(b,c,x,e,f))||(g.m.push(x),g.a=u,h[x.B]=m)}if(g.a.some(function(a){return""==a.a}))return g.m.forEach(function(a){a.L=!0}),g;a=ff(d);for(l=0;l<g.m.length;++l)x=g.m[l],m=h[x.B],m==a&&(x.L=!0);return g}function ff(a){for(var b=null,c=null,d=0;d<a.length;++d)for(var e=a[d],f=0;f<e.a.length;++f){var g=e.a[f],g=(g.width||1)*(g.height||1)*(g.bandwidth||1);if(null==b||g<b)b=g,c=e}return c}
function df(a,b){if(0==b.length)Array.prototype.push.apply(b,a);else for(var c=0;c<b.length;++c){for(var d=!1,e=0;e<a.length;++e){var f=b[c],g=a[e];if(f.a==g.a&&f.h==g.h&&f.j==g.j&&f.g==g.g&&f.i==g.i&&f.f==g.f&&f.l==g.l&&sa(f.c,g.c)){d=!0;ya(b[c],a[e].b);break}}d||(b.splice(c,1),--c)}}function cf(a,b){var c=[];if(0==b.c.length)c.push(new xa);else if(a.a)for(var d=0;d<b.c.length;++d)c.push.apply(c,gf(a,b.c[d]));return c}
function gf(a,b){var c=[];if(2!=a.a.length)return[];var d=a.a(b.c||"",b.f);if(!(d&&d instanceof Array))return[];for(var e=0;e<d.length;++e){var f;var g=d[e];f=new xa;if(g){var h=v(g,"keySystem");if(null!=h)f.a=h;else throw Error("'keySystem' cannot be null.");var l=v(g,"licenseServerUrl");if(null!=l)f.h=l;else if(h)throw Error("For encrypted streaming content, 'licenseServerUrl' cannot be null or empty.");h=ha(g,"withCredentials");null!=h&&(f.j=h);h=ka(g,"licensePostProcessor",Function);null!=h&&
(f.o=h);h=ka(g,"licensePreProcessor",Function);null!=h&&(f.u=h);h=ha(g,"distinctiveIdentifierRequired");null!=h&&(f.g=h);h=ha(g,"persistentStateRequired");null!=h&&(f.i=h);h=v(g,"audioRobustness");null!=h&&(f.f=h);h=v(g,"videoRobustness");null!=h&&(f.l=h);h=ka(g,"serverCertificate",Uint8Array);null!=h&&(f.c=h);if(h=ka(g,"initData",Object)){g=ka(h,"initData",Uint8Array);if(null==g)throw Error("'initData.initData' cannot be null.");h=v(h,"initDataType");if(null==h)throw Error("'initData.initDataType' cannot be null.");
f.b.push({initData:new Uint8Array(g.buffer),initDataType:h})}}0==f.b.length&&b.a&&b.a.psshBox&&ya(f,[{initData:b.a.psshBox,initDataType:"cenc"}]);c.push(f)}return c}
function ef(a,b,c,d,e){if(!c.s||0===c.s.length)return null;var f=null,g=1,h=0;if(c.g)f=null,g=c.g.c,h=c.g.b;else if(c.b)f=c.b,!f.b&&!f.c&&1<f.a.length?f=null:f.b||b.a||f.c||1!=f.a.length?f.c&&0===f.c.a.length?f=null:(f=f.h?hf(f.h,e):null,a=new Ue(a,b,c,d,e),b=new Kc(f),d=new Qc,d.J=a,d.K=b,f=d):f=null,g=c.b.f,h=c.b.g;else if(c.a){a:if(f=c.a,g=0+(f.f?1:0),g+=f.c?1:0,g+=f.b?1:0,0==g?g=!1:(1!=g&&(f.f?(f.c=null,f.b=null):f.c&&(f.b=null)),g=!0),g){g=null;if(f.g&&((f=c.a.g)?(f=Re(f,c.id,null,c.bandwidth,
null))?(g=new ze,g.url=Ic(c.s,f),f=g):f=null:f=null,g=f,!g)){f=null;break a}f=g?hf(g,e):null;g=c.a;a=g.f?null:g.h?g.c?new je(a,b,c,d,e):g.b?"dynamic"!=a.type&&null==b.a?null:new Xe(a,b,c,d,e):null:null;a?(b=new Kc(f),d=new Qc,d.J=a,d.K=b,f=d):f=null}else f=null;g=c.a.a;h=c.a.i}else"text"==c.f.split("/")[0]&&(f=new Qc,f.J=new Pc(new H(e,c.s)));if(!f)return null;f.id=c.id;h&&(f.b=-1*h/g);f.bandwidth=c.bandwidth;f.width=c.width;f.height=c.height;f.a=c.f||"";f.c=c.h||"";for(a=0;a<c.c.length;++a)b=c.c[a],
b.b&&f.f.push(b.b);return f}function hf(a,b){var c=a.url,d=0,e=null;a.a&&(d=a.a.ha,e=a.a.end);return new H(b,c,d,e)};function Z(a,b,c,d){c||(c=new Ia);d||(d=new P);Q.call(this,null,c,d);this.Za=a;this.X=null;this.Z=b;this.fa=[];this.Ca=[];this.Da=[];this.H=null}p(Z,Q);n("shaka.player.DashVideoSource",Z);Z.prototype.$a=function(a,b,c){this.fa.push(a);this.Ca.push(b||"");this.Da.push(c||"")};Z.prototype.addExternalCaptions=Z.prototype.$a;Z.prototype.ab=function(a){this.H=a};Z.prototype.setNetworkCallback=Z.prototype.ab;Z.prototype.destroy=function(){this.X=this.H=this.Z=null;Q.prototype.destroy.call(this)};
Z.prototype.ya=function(){var a=new H(this.H,[new K(this.Za)]);return Te(new Se(a,this.ga)).then(t(this,function(a){this.X=a;for(var c=0;c<this.fa.length;c++){var d=a,e=this.fa[c],f=this.Ca[c],g=this.Da[c];if(0!==d.a.length){var h=new oe;h.contentType="text";h.lang=f||"en";h.c=!0;f=new re;f.bandwidth=0;f.f=g||"text/vtt";f.s=[new K(e)];h.a.push(f);d.a[0].b.push(h);Ke(d.a[0])}}this.a=Ze(new Ye(this.Z),a,this.H);return Q.prototype.ya.call(this)}))};
Z.prototype.Ra=function(a){return Te(new Se(a,this.ga)).then(t(this,function(a){this.X=a;a=Ze(new Ye(this.Z),a,this.H);return Promise.resolve(a)}))};Z.prototype.Qa=function(){var a=Ze(new Ye(this.Z),this.X,this.H);return Promise.resolve(a)};}.bind(g,this))();
if (typeof(module)!="undefined"&&module.exports)module.exports=g.shaka;
else if (typeof(define)!="undefined" && define.amd)define(function(){return g.shaka});
else this.shaka=g.shaka;
})();

