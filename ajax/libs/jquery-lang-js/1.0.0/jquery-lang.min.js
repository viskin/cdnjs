var IgeEventsLite=function(){};IgeEventsLite.prototype.on=function(evtName,fn){if(evtName&&fn){this.eventList[evtName]=this.eventList[evtName]||[];this.eventList[evtName].push(fn)}};IgeEventsLite.prototype.emit=function(evtName){if(evtName){this.eventList=this.eventList||[];var args=[];for(var i=1;i<arguments.length;i++){args.push(arguments[i])}if(evtName){var fnList=this.eventList[evtName];for(var i in fnList){if(typeof fnList[i]=="function"){fnList[i].apply(this,args)}}}}};var jquery_lang_js=function(){this.events=new IgeEventsLite;this.on=this.events.on;this.emit=this.events.emit;return this};jquery_lang_js.prototype.lang={};jquery_lang_js.prototype.defaultLang="en";jquery_lang_js.prototype.currentLang="en";jquery_lang_js.prototype.run=function(){var langElems=$("[lang]");var elemsLength=langElems.length;while(elemsLength--){var elem=langElems[elemsLength];var elemType=elem.tagName;if(elemType!="HTML"){var langElem=$(elem);if(langElem.attr("lang")==this.defaultLang){var titleText=langElem.attr("title");if(titleText||langElem.is("input")){if(titleText){langElem.data("deftexttitle",titleText)}if(langElem.is("input")){switch(langElem.attr("type")){case"button":case"submit":case"reset":langElem.data("deftext",langElem.val());break;case"email":case"password":case"text":var plText=langElem.attr("placeholder");if(plText){langElem.data("deftext",plText)}break}}}else{langElem.data("deftext",langElem.html())}}}}if(localStorage){var lsLang=localStorage.getItem("langJs_currentLang");if(lsLang){this.change(lsLang)}else this.change(this.currentLang)}};jquery_lang_js.prototype.loadPack=function(packPath){$('<script type="text/javascript" charset="utf-8" src="'+packPath+'" />').appendTo("head")};jquery_lang_js.prototype.change=function(lang){if(this.currentLang!=lang){this.update(lang)}this.currentLang=lang;var langElems=$("[lang]");if(lang!=this.defaultLang){if(this.lang[lang]){var elemsLength=langElems.length;while(elemsLength--){var elem=langElems[elemsLength];var langElem=$(elem);if(langElem.data("deftexttitle")){if(langElem.attr("title")){var currentText=langElem.attr("title");var defaultLangText=langElem.data("deftexttitle");var newText=this.lang[lang][defaultLangText]||currentText;var newHtml=currentText.replace(currentText,newText);langElem.attr("title",newHtml);if(currentText!=newHtml){langElem.attr("lang",lang)}}}if(langElem.data("deftext")){if(langElem.is("input")){switch(langElem.attr("type")){case"button":case"submit":case"reset":var currentText=langElem.val();var defaultLangText=langElem.data("deftext");var newText=this.lang[lang][defaultLangText]||currentText;var newHtml=currentText.replace(currentText,newText);langElem.val(newHtml);if(currentText!=newHtml){langElem.attr("lang",lang)}break;case"email":case"password":case"text":var currentText=langElem.attr("placeholder");var defaultLangText=langElem.data("deftext");var newText=this.lang[lang][defaultLangText]||currentText;var newHtml=currentText.replace(currentText,newText);langElem.attr("placeholder",newHtml);if(currentText!=newHtml){langElem.attr("lang",lang)}break}}else{var currentText=langElem.html();var defaultLangText=langElem.data("deftext");var newText=this.lang[lang][defaultLangText]||currentText;var newHtml=currentText.replace(currentText,newText);langElem.html(newHtml);if(currentText!=newHtml){langElem.attr("lang",lang)}}}else{}}}else{console.log('Cannot switch language, no language pack defined for "'+lang+'"')}}else{langElems.each(function(){var langElem=$(this);if(langElem.data("deftexttitle")){if(langElem.attr("title")){langElem.attr("title",langElem.data("deftexttitle"))}}if(langElem.data("deftext")){if(langElem.is("input")){switch(langElem.attr("type")){case"button":case"submit":case"reset":langElem.val(langElem.data("deftext"));break;case"email":case"password":case"text":langElem.attr("placeholder",langElem.data("deftext"));break}}else{langElem.html(langElem.data("deftext"))}}})}};jquery_lang_js.prototype.convert=function(text,lang){if(lang){if(lang!=this.defaultLang){return this.lang[lang][text]||text}else{return text}}else{if(this.currentLang!=this.defaultLang){return this.lang[this.currentLang][text]||text}else{return text}}};jquery_lang_js.prototype.update=function(lang){if(localStorage){localStorage.setItem("langJs_currentLang",lang)}this.emit("update",lang)};
