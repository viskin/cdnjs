var __extends=this.__extends||function(b,c){function h(){this.constructor=b}for(var e in c)c.hasOwnProperty(e)&&(b[e]=c[e]);h.prototype=c.prototype;b.prototype=new h};function JL(b){if(!b)return JL.__;var c="";return("."+b).split(".").reduce(function(b,e,k,f){c=c?c+("."+e):e;e=b["__"+c];void 0===e&&(JL.Logger.prototype=b,e=new JL.Logger(c),b["__"+c]=e);return e},JL.__)}
(function(b){function c(b,a,g){void 0!==a[b]&&(null===a[b]?delete g[b]:g[b]=a[b])}function h(d){if(null!=b.enabled&&!b.enabled||null!=b.maxMessages&&1>b.maxMessages)return!1;try{if(d.userAgentRegex&&!RegExp(d.userAgentRegex).test(navigator.userAgent))return!1}catch(a){}try{if(d.ipRegex&&b.clientIP&&!RegExp(d.ipRegex).test(b.clientIP))return!1}catch(g){}return!0}function e(b,a){try{if(b.disallow&&RegExp(b.disallow).test(a))return!1}catch(g){}return!0}b.enabled;b.maxMessages;b.clientIP;b.requestId;
b.setOptions=function(b){c("enabled",b,this);c("maxMessages",b,this);c("clientIP",b,this);c("requestId",b,this);return this};b.getAllLevel=function(){return-2147483648};b.getTraceLevel=function(){return 1E3};b.getDebugLevel=function(){return 2E3};b.getInfoLevel=function(){return 3E3};b.getWarnLevel=function(){return 4E3};b.getErrorLevel=function(){return 5E3};b.getFatalLevel=function(){return 6E3};b.getOffLevel=function(){return 2147483647};var k=function(){return function(b,a,g,c){this.l=b;this.m=
a;this.n=g;this.t=c}}();b.LogItem=k;var f=function(){function d(a,g){this.appenderName=a;this.sendLogItems=g;this.level=b.getTraceLevel();this.sendWithBufferLevel=2147483647;this.storeInBufferLevel=-2147483648;this.bufferSize=0;this.batchSize=1;this.buffer=[];this.batchBuffer=[]}d.prototype.setOptions=function(a){c("level",a,this);c("ipRegex",a,this);c("userAgentRegex",a,this);c("disallow",a,this);c("sendWithBufferLevel",a,this);c("storeInBufferLevel",a,this);c("bufferSize",a,this);c("batchSize",
a,this);this.bufferSize<this.buffer.length&&(this.buffer.length=this.bufferSize);return this};d.prototype.log=function(a,b,c){!h(this)||!e(this,b)||a<this.storeInBufferLevel||(b=new k(a,b,c,(new Date).getTime()),a<this.level?0<this.bufferSize&&(this.buffer.push(b),this.buffer.length>this.bufferSize&&this.buffer.shift()):(a<this.sendWithBufferLevel||!this.buffer.length||(this.batchBuffer=this.batchBuffer.concat(this.buffer),this.buffer.length=0),this.batchBuffer.push(b),this.batchBuffer.length>=this.batchSize&&
this.sendBatch()))};d.prototype.sendBatch=function(){0==this.batchBuffer.length||null!=b.maxMessages&&1>b.maxMessages||(null!=b.maxMessages&&(b.maxMessages-=this.batchBuffer.length),this.sendLogItems(this.batchBuffer),this.batchBuffer.length=0)};return d}();b.Appender=f;var l=function(d){function a(b){d.call(this,b,a.prototype.sendLogItemsAjax);this.url="/jsnlog.logger"}__extends(a,d);a.prototype.setOptions=function(a){c("url",a,this);d.prototype.setOptions.call(this,a);return this};a.prototype.sendLogItemsAjax=
function(a){try{var c=JSON.stringify({r:b.requestId,lg:a}),d=new XMLHttpRequest;d.open("POST",this.url);d.setRequestHeader("Content-Type","application/json");d.send(c)}catch(e){}};return a}(f);b.AjaxAppender=l;var m=function(c){function a(b){c.call(this,b,a.prototype.sendLogItemsConsole)}__extends(a,c);a.prototype.clog=function(a){console.log(a)};a.prototype.cerror=function(a){console.error?console.error(a):this.clog(a)};a.prototype.cwarn=function(a){console.warn?console.warn(a):this.clog(a)};a.prototype.cinfo=
function(a){console.info?console.info(a):this.clog(a)};a.prototype.cdebug=function(a){console.debug?console.debug(a):this.cinfo(a)};a.prototype.sendLogItemsConsole=function(a){try{if(console){var c;for(c=0;c<a.length;++c){var d=a[c],e=d.n+": "+d.m;d.l<=b.getDebugLevel()?this.cdebug(e):d.l<=b.getInfoLevel()?this.cinfo(e):d.l<=b.getWarnLevel()?this.cwarn(e):this.cerror(e)}}}catch(f){}};return a}(f);b.ConsoleAppender=m;f=function(){function b(a){this.loggerName=a;this.seenRegexes=[]}b.prototype.stringifyLogObject=
function(a){switch(typeof a){case "string":return a;case "number":return a.toString();case "boolean":return a.toString();case "undefined":return"undefined";case "function":return a instanceof RegExp?a.toString():this.stringifyLogObject(a());case "object":return a instanceof RegExp||a instanceof String||a instanceof Number||a instanceof Boolean?a.toString():JSON.stringify(a);default:return"unknown"}};b.prototype.setOptions=function(a){c("level",a,this);c("userAgentRegex",a,this);c("disallow",a,this);
c("ipRegex",a,this);c("appenders",a,this);c("onceOnly",a,this);this.seenRegexes=[];return this};b.prototype.log=function(a,b){var c=0,d;if(!this.appenders)return this;if(a>=this.level&&h(this)&&(d=this.stringifyLogObject(b),e(this,d))){if(this.onceOnly)for(c=this.onceOnly.length-1;0<=c;){if(RegExp(this.onceOnly[c]).test(d)){if(this.seenRegexes[c])return this;this.seenRegexes[c]=!0}c--}for(c=this.appenders.length-1;0<=c;)this.appenders[c].log(a,d,this.loggerName),c--}return this};b.prototype.trace=
function(a){return this.log(1E3,a)};b.prototype.debug=function(a){return this.log(2E3,a)};b.prototype.info=function(a){return this.log(3E3,a)};b.prototype.warn=function(a){return this.log(4E3,a)};b.prototype.error=function(a){return this.log(5E3,a)};b.prototype.fatal=function(a){return this.log(6E3,a)};return b}();b.Logger=f;f=new l("");b.__=new b.Logger("");b.__.setOptions({level:b.getDebugLevel(),appenders:[f]});b.createAjaxAppender=function(b){return new l(b)};b.createConsoleAppender=function(b){return new m(b)}})(JL||
(JL={}));var exports;"undefined"!==typeof exports&&(exports.JL=JL);var define;"function"==typeof define&&define.amd&&define(function(){return JL});
