!function(e){function t(e){e=e||{},e.resetBoundsInterval=e.resetBoundsInterval||3e3,e.resetBounds=void 0===e.resetBounds?!0:e.resetBounds,this.options=e,this.data=[],this.maxValue=Number.NaN,this.minValue=Number.NaN}function i(e){e=e||{},e.grid=e.grid||{},e.grid.fillStyle=e.grid.fillStyle||"#000000",e.grid.strokeStyle=e.grid.strokeStyle||"#777777",e.grid.lineWidth="undefined"==typeof e.grid.lineWidth?1:e.grid.lineWidth,e.grid.sharpLines=!!e.grid.sharpLines,e.grid.millisPerLine=e.grid.millisPerLine||1e3,e.grid.verticalSections="undefined"==typeof e.grid.verticalSections?2:e.grid.verticalSections,e.millisPerPixel=e.millisPerPixel||20,e.maxValueScale=e.maxValueScale||1,e.labels=e.labels||{fillStyle:"#ffffff"},e.interpolation=e.interpolation||"bezier",e.scaleSmoothing=e.scaleSmoothing||.125,e.maxDataSetLength=e.maxDataSetLength||2,e.timestampFormatter=e.timestampFormatter||null,e.horizontalLines=e.horizontalLines||[],this.options=e,this.seriesSet=[],this.currentValueRange=1,this.currentVisMinValue=0}t.prototype.resetBounds=function(){this.maxValue=Number.NaN,this.minValue=Number.NaN;for(var e=0;e<this.data.length;e++)this.maxValue=isNaN(this.maxValue)?this.data[e][1]:Math.max(this.maxValue,this.data[e][1]),this.minValue=isNaN(this.minValue)?this.data[e][1]:Math.min(this.minValue,this.data[e][1])},t.prototype.append=function(e,t){this.data.push([e,t]),this.maxValue=isNaN(this.maxValue)?t:Math.max(this.maxValue,t),this.minValue=isNaN(this.minValue)?t:Math.min(this.minValue,t)},t.prototype.dropOldData=function(e,t){for(var i=0;this.data.length-i>=t&&this.data[i+1][0]<e;)i++;0!==i&&this.data.splice(0,i)},i.AnimateCompatibility=function(){var e=0,t=function(t,i){var a=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){var i=(new Date).getTime(),a=Math.max(0,16-(i-e)),n=window.setTimeout(function(){t(i+a)},a);return e=i+a,n};return a.call(window,t,i)},i=function(e){var t=window.cancelAnimationFrame||function(e){clearTimeout(e)};return t.call(window,e)};return{requestAnimationFrame:t,cancelAnimationFrame:i}}(),i.prototype.addTimeSeries=function(e,t){if(this.seriesSet.push({timeSeries:e,options:t||{}}),this.options.resetBounds&&1===this.seriesSet.length){var i=this;this.boundsTimerId=setInterval(function(){i.resetBounds()},t.resetBoundsInterval)}},i.prototype.removeTimeSeries=function(e){for(var t=this.seriesSet.length,i=0;t>i;i++)if(this.seriesSet[i].timeSeries===e){this.seriesSet.splice(i,1);break}this.options.resetBounds&&0===this.seriesSet.length&&clearInterval(this.boundsTimerId)},i.prototype.streamTo=function(e,t){this.canvas=e,this.delay=t,this.start()},i.prototype.start=function(){this.frame||this.animate()},i.prototype.animate=function(){this.frame=i.AnimateCompatibility.requestAnimationFrame(this.animate.bind(this)),this.render(this.canvas,(new Date).getTime()-(this.delay||0))},i.prototype.stop=function(){this.frame&&(i.AnimateCompatibility.cancelAnimationFrame(this.frame),delete this.frame)},i.timeFormatter=function(e){function t(e){return(10>e?"0":"")+e}return t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())},i.prototype.updateValueRange=function(){for(var e=this.options,t=Number.NaN,i=Number.NaN,a=0;a<this.seriesSet.length;a++){var n=this.seriesSet[a].timeSeries;isNaN(n.maxValue)||(t=isNaN(t)?n.maxValue:Math.max(t,n.maxValue)),isNaN(n.minValue)||(i=isNaN(i)?n.minValue:Math.min(i,n.minValue))}if(null!=e.maxValue?t=e.maxValue:t*=e.maxValueScale,null!=e.minValue&&(i=e.minValue),this.yRangeFunction){var r=this.yRangeFunction({min:i,max:t});i=r.min,t=r.max}if(!isNaN(t)&&!isNaN(i)){var s=t-i;this.currentValueRange+=e.scaleSmoothing*(s-this.currentValueRange),this.currentVisMinValue+=e.scaleSmoothing*(i-this.currentVisMinValue)}this.valueRange={min:i,max:t}},i.prototype.render=function(e,t){t-=t%this.options.millisPerPixel;var i=this,a=e.getContext("2d"),n=this.options,r={top:0,left:0,width:e.clientWidth,height:e.clientHeight},s=t-r.width*n.millisPerPixel,l=function(e){var t=e-i.currentVisMinValue;return 0===i.currentValueRange?r.height:r.height-Math.round(t/i.currentValueRange*r.height)},o=function(e){return Math.round(r.width-(t-e)/n.millisPerPixel)};if(this.updateValueRange(),a.save(),a.translate(r.left,r.top),a.beginPath(),a.rect(0,0,r.width,r.height),a.clip(),a.save(),a.fillStyle=n.grid.fillStyle,a.clearRect(0,0,r.width,r.height),a.fillRect(0,0,r.width,r.height),a.restore(),a.save(),a.lineWidth=n.grid.lineWidth,a.strokeStyle=n.grid.strokeStyle,n.grid.millisPerLine>0)for(var h=t-t%n.grid.millisPerLine;h>=s;h-=n.grid.millisPerLine){var m=o(h);if(n.grid.sharpLines&&(m-=.5),a.beginPath(),a.moveTo(m,0),a.lineTo(m,r.height),a.stroke(),a.closePath(),n.timestampFormatter){var u=new Date(h),d=n.timestampFormatter(u),f=a.measureText(d).width/2+a.measureText(M).width+4;m<r.width-f&&(a.fillStyle=n.labels.fillStyle,a.fillText(d,m-a.measureText(d).width/2,r.height-2))}}for(var g=1;g<n.grid.verticalSections;g++){var c=Math.round(g*r.height/n.grid.verticalSections);n.grid.sharpLines&&(c-=.5),a.beginPath(),a.moveTo(0,c),a.lineTo(r.width,c),a.stroke(),a.closePath()}if(a.beginPath(),a.strokeRect(0,0,r.width,r.height),a.closePath(),a.restore(),n.horizontalLines&&n.horizontalLines.length)for(var p=0;p<n.horizontalLines.length;p++){var v=n.horizontalLines[p],S=Math.round(l(v.value))-.5;a.strokeStyle=v.color||"#ffffff",a.lineWidth=v.lineWidth||1,a.beginPath(),a.moveTo(0,S),a.lineTo(r.width,S),a.stroke(),a.closePath()}for(var x=0;x<this.seriesSet.length;x++){a.save();var V=this.seriesSet[x].timeSeries,w=V.data,N=this.seriesSet[x].options;V.dropOldData(s,n.maxDataSetLength),a.lineWidth=N.lineWidth||1,a.strokeStyle=N.strokeStyle||"#ffffff",a.beginPath();for(var y=0,b=0,T=0,P=0;P<w.length&&1!==w.length;P++){var F=o(w[P][0]),R=l(w[P][1]);if(0===P)y=F,a.moveTo(F,R);else switch(n.interpolation){case"line":a.lineTo(F,R);break;case"bezier":default:a.bezierCurveTo(Math.round((b+F)/2),T,Math.round(b+F)/2,R,F,R)}b=F,T=R}w.length>1&&(N.fillStyle&&(a.lineTo(r.width+N.lineWidth+1,T),a.lineTo(r.width+N.lineWidth+1,r.height+N.lineWidth+1),a.lineTo(y,r.height+N.lineWidth),a.fillStyle=N.fillStyle,a.fill()),a.stroke(),a.closePath()),a.restore()}if(!n.labels.disabled&&!isNaN(this.valueRange.min)&&!isNaN(this.valueRange.max)){a.fillStyle=n.labels.fillStyle;var L=parseFloat(this.valueRange.max).toFixed(2),M=parseFloat(this.valueRange.min).toFixed(2);a.fillText(L,r.width-a.measureText(L).width-2,10),a.fillText(M,r.width-a.measureText(M).width-2,r.height-2)}a.restore()},e.TimeSeries=t,e.SmoothieChart=i}("undefined"==typeof exports?this:exports);