function TimeSeries(e){e=e||{},e.resetBoundsInterval=e.resetBoundsInterval||3e3,e.resetBounds=e.resetBounds||!0,this.options=e,this.data=[],this.maxValue=Number.NaN,this.minValue=Number.NaN,e.resetBounds&&(this.boundsTimer=setInterval(function(e){e.resetBounds()},e.resetBoundsInterval,this))}function SmoothieChart(e){e=e||{},e.grid=e.grid||{fillStyle:"#000000",strokeStyle:"#777777",lineWidth:1,millisPerLine:1e3,verticalSections:2},e.millisPerPixel=e.millisPerPixel||20,e.fps=e.fps||50,e.maxValueScale=e.maxValueScale||1,e.minValue=e.minValue,e.maxValue=e.maxValue,e.labels=e.labels||{fillStyle:"#ffffff"},e.interpolation=e.interpolation||"bezier",e.scaleSmoothing=e.scaleSmoothing||.125,e.maxDataSetLength=e.maxDataSetLength||2,e.timestampFormatter=e.timestampFormatter||null,this.options=e,this.seriesSet=[],this.currentValueRange=1,this.currentVisMinValue=0}TimeSeries.prototype.resetBounds=function(){this.maxValue=Number.NaN,this.minValue=Number.NaN;for(var e=0;e<this.data.length;e++)this.maxValue=isNaN(this.maxValue)?this.data[e][1]:Math.max(this.maxValue,this.data[e][1]),this.minValue=isNaN(this.minValue)?this.data[e][1]:Math.min(this.minValue,this.data[e][1])},TimeSeries.prototype.append=function(e,t){this.data.push([e,t]),this.maxValue=isNaN(this.maxValue)?t:Math.max(this.maxValue,t),this.minValue=isNaN(this.minValue)?t:Math.min(this.minValue,t)},SmoothieChart.prototype.addTimeSeries=function(e,t){this.seriesSet.push({timeSeries:e,options:t||{}})},SmoothieChart.prototype.removeTimeSeries=function(e){this.seriesSet.splice(this.seriesSet.indexOf(e),1)},SmoothieChart.prototype.streamTo=function(e,t){var i=this;this.render_on_tick=function(){i.render(e,(new Date).getTime()-(t||0))},this.start()},SmoothieChart.prototype.start=function(){this.timer||(this.timer=setInterval(this.render_on_tick,1e3/this.options.fps))},SmoothieChart.prototype.stop=function(){this.timer&&(clearInterval(this.timer),this.timer=void 0)},SmoothieChart.timeFormatter=function(e){function t(e){return(10>e?"0":"")+e}return t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())},SmoothieChart.prototype.render=function(e,t){var i=e.getContext("2d"),a=this.options,s={top:0,left:0,width:e.clientWidth,height:e.clientHeight};if(i.save(),t-=t%a.millisPerPixel,i.translate(s.left,s.top),i.beginPath(),i.rect(0,0,s.width,s.height),i.clip(),i.save(),i.fillStyle=a.grid.fillStyle,i.clearRect(0,0,s.width,s.height),i.fillRect(0,0,s.width,s.height),i.restore(),i.save(),i.lineWidth=a.grid.lineWidth||1,i.strokeStyle=a.grid.strokeStyle||"#ffffff",a.grid.millisPerLine>0)for(var l=t-t%a.grid.millisPerLine;l>=t-s.width*a.millisPerPixel;l-=a.grid.millisPerLine){i.beginPath();var r=Math.round(s.width-(t-l)/a.millisPerPixel);if(i.moveTo(r,0),i.lineTo(r,s.height),i.stroke(),a.timestampFormatter){var h=new Date(l),n=a.timestampFormatter(h),o=i.measureText(n).width/2+i.measureText(F).width+4;r<s.width-o&&(i.fillStyle=a.labels.fillStyle,i.fillText(n,r-i.measureText(n).width/2,s.height-2))}i.closePath()}for(var m=1;m<a.grid.verticalSections;m++){var u=Math.round(m*s.height/a.grid.verticalSections);i.beginPath(),i.moveTo(0,u),i.lineTo(s.width,u),i.stroke(),i.closePath()}i.beginPath(),i.strokeRect(0,0,s.width,s.height),i.closePath(),i.restore();for(var d=Number.NaN,f=Number.NaN,c=0;c<this.seriesSet.length;c++){var S=this.seriesSet[c].timeSeries;isNaN(S.maxValue)||(d=isNaN(d)?S.maxValue:Math.max(d,S.maxValue)),isNaN(S.minValue)||(f=isNaN(f)?S.minValue:Math.min(f,S.minValue))}if(!isNaN(d)||!isNaN(f)){null!=a.maxValue?d=a.maxValue:d*=a.maxValueScale,null!=a.minValue&&(f=a.minValue);var g=d-f;this.currentValueRange+=a.scaleSmoothing*(g-this.currentValueRange),this.currentVisMinValue+=a.scaleSmoothing*(f-this.currentVisMinValue);for(var V=this.currentValueRange,p=this.currentVisMinValue,c=0;c<this.seriesSet.length;c++){i.save();for(var S=this.seriesSet[c].timeSeries,x=S.data,N=this.seriesSet[c].options;x.length>=a.maxDataSetLength&&x[1][0]<t-s.width*a.millisPerPixel;)x.splice(0,1);i.lineWidth=N.lineWidth||1,i.fillStyle=N.fillStyle,i.strokeStyle=N.strokeStyle||"#ffffff",i.beginPath();for(var v=0,P=0,T=0,y=0;y<x.length;y++){var w=Math.round(s.width-(t-x[y][0])/a.millisPerPixel),b=x[y][1],M=b-p,k=s.height-(V?Math.round(M/V*s.height):0),C=Math.max(Math.min(k,s.height-1),1);if(0==y)v=w,i.moveTo(w,C);else switch(a.interpolation){case"line":i.lineTo(w,C);break;case"bezier":default:i.bezierCurveTo(Math.round((P+w)/2),T,Math.round(P+w)/2,C,w,C)}P=w,T=C}x.length>0&&N.fillStyle&&(i.lineTo(s.width+N.lineWidth+1,T),i.lineTo(s.width+N.lineWidth+1,s.height+N.lineWidth+1),i.lineTo(v,s.height+N.lineWidth),i.fill()),i.stroke(),i.closePath(),i.restore()}if(!a.labels.disabled){i.fillStyle=a.labels.fillStyle;var W=parseFloat(d).toFixed(2),F=parseFloat(f).toFixed(2);i.fillText(W,s.width-i.measureText(W).width-2,10),i.fillText(F,s.width-i.measureText(F).width-2,s.height-2)}i.restore()}};