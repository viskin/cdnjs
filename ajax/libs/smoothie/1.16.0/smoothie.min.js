!function(e){function t(e){e=e||{},e.resetBoundsInterval=e.resetBoundsInterval||3e3,e.resetBounds=void 0===e.resetBounds?!0:e.resetBounds,this.options=e,this.data=[],this.maxValue=Number.NaN,this.minValue=Number.NaN}function i(e){e=e||{},e.grid=e.grid||{},e.grid.fillStyle=e.grid.fillStyle||"#000000",e.grid.strokeStyle=e.grid.strokeStyle||"#777777",e.grid.lineWidth="undefined"==typeof e.grid.lineWidth?1:e.grid.lineWidth,e.grid.sharpLines=!!e.grid.sharpLines,e.grid.millisPerLine=e.grid.millisPerLine||1e3,e.grid.verticalSections="undefined"==typeof e.grid.verticalSections?2:e.grid.verticalSections,e.millisPerPixel=e.millisPerPixel||20,e.maxValueScale=e.maxValueScale||1,e.labels=e.labels||{fillStyle:"#ffffff",disabled:!1},e.interpolation=e.interpolation||"bezier",e.scaleSmoothing=e.scaleSmoothing||.125,e.maxDataSetLength=e.maxDataSetLength||2,e.timestampFormatter=e.timestampFormatter||null,e.horizontalLines=e.horizontalLines||[],this.options=e,this.seriesSet=[],this.currentValueRange=1,this.currentVisMinValue=0}t.prototype.resetBounds=function(){if(this.data.length){this.maxValue=this.data[0][1],this.minValue=this.data[0][1];for(var e=1;e<this.data.length;e++){var t=this.data[e][1];t>this.maxValue&&(this.maxValue=t),t<this.minValue&&(this.minValue=t)}}else this.maxValue=Number.NaN,this.minValue=Number.NaN},t.prototype.append=function(e,t,i){for(var a=this.data.length-1;a>0&&this.data[a][0]>e;)a--;this.data.length>0&&this.data[a][0]===e?i?(this.data[a][1]+=t,t=this.data[a][1]):this.data[a][1]=t:a<this.data.length-1?this.data.splice(a+1,0,[e,t]):this.data.push([e,t]),this.maxValue=isNaN(this.maxValue)?t:Math.max(this.maxValue,t),this.minValue=isNaN(this.minValue)?t:Math.min(this.minValue,t)},t.prototype.dropOldData=function(e,t){for(var i=0;this.data.length-i>=t&&this.data[i+1][0]<e;)i++;0!==i&&this.data.splice(0,i)},i.AnimateCompatibility=function(){var e=0,t=function(t,i){var a=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){var i=(new Date).getTime(),a=Math.max(0,16-(i-e)),n=window.setTimeout(function(){t(i+a)},a);return e=i+a,n};return a.call(window,t,i)},i=function(e){var t=window.cancelAnimationFrame||function(e){clearTimeout(e)};return t.call(window,e)};return{requestAnimationFrame:t,cancelAnimationFrame:i}}(),i.prototype.addTimeSeries=function(e,t){this.seriesSet.push({timeSeries:e,options:t||{}}),e.options.resetBounds&&e.options.resetBoundsInterval>0&&(e.resetBoundsTimerId=setInterval(function(){e.resetBounds()},e.options.resetBoundsInterval))},i.prototype.removeTimeSeries=function(e){for(var t=this.seriesSet.length,i=0;t>i;i++)if(this.seriesSet[i].timeSeries===e){this.seriesSet.splice(i,1);break}e.resetBoundsTimerId&&clearInterval(e.resetBoundsTimerId)},i.prototype.streamTo=function(e,t){this.canvas=e,this.delay=t,this.start()},i.prototype.start=function(){this.frame||this.animate()},i.prototype.animate=function(){this.frame=i.AnimateCompatibility.requestAnimationFrame(this.animate.bind(this)),this.render(this.canvas,(new Date).getTime()-(this.delay||0))},i.prototype.stop=function(){this.frame&&(i.AnimateCompatibility.cancelAnimationFrame(this.frame),delete this.frame)},i.timeFormatter=function(e){function t(e){return(10>e?"0":"")+e}return t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())},i.prototype.updateValueRange=function(){for(var e=this.options,t=Number.NaN,i=Number.NaN,a=0;a<this.seriesSet.length;a++){var n=this.seriesSet[a].timeSeries;isNaN(n.maxValue)||(t=isNaN(t)?n.maxValue:Math.max(t,n.maxValue)),isNaN(n.minValue)||(i=isNaN(i)?n.minValue:Math.min(i,n.minValue))}if(null!=e.maxValue?t=e.maxValue:t*=e.maxValueScale,null!=e.minValue&&(i=e.minValue),this.options.yRangeFunction){var s=this.options.yRangeFunction({min:i,max:t});i=s.min,t=s.max}if(!isNaN(t)&&!isNaN(i)){var r=t-i;this.currentValueRange+=e.scaleSmoothing*(r-this.currentValueRange),this.currentVisMinValue+=e.scaleSmoothing*(i-this.currentVisMinValue)}this.valueRange={min:i,max:t}},i.prototype.render=function(e,t){t-=t%this.options.millisPerPixel;var i=e.getContext("2d"),a=this.options,n={top:0,left:0,width:e.clientWidth,height:e.clientHeight},s=t-n.width*a.millisPerPixel,r=function(e){var t=e-this.currentVisMinValue;return 0===this.currentValueRange?n.height:n.height-Math.round(t/this.currentValueRange*n.height)}.bind(this),l=function(e){return Math.round(n.width-(t-e)/a.millisPerPixel)};if(this.updateValueRange(),i.save(),i.translate(n.left,n.top),i.beginPath(),i.rect(0,0,n.width,n.height),i.clip(),i.save(),i.fillStyle=a.grid.fillStyle,i.clearRect(0,0,n.width,n.height),i.fillRect(0,0,n.width,n.height),i.restore(),i.save(),i.lineWidth=a.grid.lineWidth,i.strokeStyle=a.grid.strokeStyle,a.grid.millisPerLine>0)for(var o=t-t%a.grid.millisPerLine;o>=s;o-=a.grid.millisPerLine){var h=l(o);if(a.grid.sharpLines&&(h-=.5),i.beginPath(),i.moveTo(h,0),i.lineTo(h,n.height),i.stroke(),i.closePath(),a.timestampFormatter){var m=new Date(o),u=a.timestampFormatter(m),d=i.measureText(u).width/2+i.measureText(L).width+4;h<n.width-d&&(i.fillStyle=a.labels.fillStyle,i.fillText(u,h-i.measureText(u).width/2,n.height-2))}}for(var f=1;f<a.grid.verticalSections;f++){var g=Math.round(f*n.height/a.grid.verticalSections);a.grid.sharpLines&&(g-=.5),i.beginPath(),i.moveTo(0,g),i.lineTo(n.width,g),i.stroke(),i.closePath()}if(i.beginPath(),i.strokeRect(0,0,n.width,n.height),i.closePath(),i.restore(),a.horizontalLines&&a.horizontalLines.length)for(var c=0;c<a.horizontalLines.length;c++){var p=a.horizontalLines[c],v=Math.round(r(p.value))-.5;i.strokeStyle=p.color||"#ffffff",i.lineWidth=p.lineWidth||1,i.beginPath(),i.moveTo(0,v),i.lineTo(n.width,v),i.stroke(),i.closePath()}for(var S=0;S<this.seriesSet.length;S++){i.save();var x=this.seriesSet[S].timeSeries,V=x.data,w=this.seriesSet[S].options;x.dropOldData(s,a.maxDataSetLength),i.lineWidth=w.lineWidth||1,i.strokeStyle=w.strokeStyle||"#ffffff",i.beginPath();for(var y=0,N=0,T=0,b=0;b<V.length&&1!==V.length;b++){var P=l(V[b][0]),F=r(V[b][1]);if(0===b)y=P,i.moveTo(P,F);else switch(a.interpolation){case"line":i.lineTo(P,F);break;case"bezier":default:i.bezierCurveTo(Math.round((N+P)/2),T,Math.round(N+P)/2,F,P,F)}N=P,T=F}V.length>1&&(w.fillStyle&&(i.lineTo(n.width+w.lineWidth+1,T),i.lineTo(n.width+w.lineWidth+1,n.height+w.lineWidth+1),i.lineTo(y,n.height+w.lineWidth),i.fillStyle=w.fillStyle,i.fill()),i.stroke(),i.closePath()),i.restore()}if(!a.labels.disabled&&!isNaN(this.valueRange.min)&&!isNaN(this.valueRange.max)){i.fillStyle=a.labels.fillStyle;var R=parseFloat(this.valueRange.max).toFixed(2),L=parseFloat(this.valueRange.min).toFixed(2);i.fillText(R,n.width-i.measureText(R).width-2,10),i.fillText(L,n.width-i.measureText(L).width-2,n.height-2)}i.restore()},e.TimeSeries=t,e.SmoothieChart=i}("undefined"==typeof exports?this:exports);