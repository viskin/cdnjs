/*! taucharts - v0.4.1 - 2015-04-22
* https://github.com/TargetProcess/tauCharts
* Copyright (c) 2015 Taucraft Limited; Licensed Apache License 2.0 */
!function(a,b){if("function"==typeof define&&define.amd)define(["underscore","d3"],function(a,c){return b(a,c)});else if("object"==typeof module&&module.exports){var c=require("underscore"),d=require("d3");module.exports=b(c,d)}else a.tauCharts=b(a._,a.d3)}(this,function(a,b){var c,d,e;return function(a){function b(a,b){return u.call(a,b)}function f(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=b&&b.split("/"),o=s.map,p=o&&o["*"]||{};if(a&&"."===a.charAt(0))if(b){for(a=a.split("/"),g=a.length-1,s.nodeIdCompat&&w.test(a[g])&&(a[g]=a[g].replace(w,"")),a=n.slice(0,n.length-1).concat(a),k=0;k<a.length;k+=1)if(m=a[k],"."===m)a.splice(k,1),k-=1;else if(".."===m){if(1===k&&(".."===a[2]||".."===a[0]))break;k>0&&(a.splice(k-1,2),k-=2)}a=a.join("/")}else 0===a.indexOf("./")&&(a=a.substring(2));if((n||p)&&o){for(c=a.split("/"),k=c.length;k>0;k-=1){if(d=c.slice(0,k).join("/"),n)for(l=n.length;l>0;l-=1)if(e=o[n.slice(0,l).join("/")],e&&(e=e[d])){f=e,h=k;break}if(f)break;!i&&p&&p[d]&&(i=p[d],j=k)}!f&&i&&(f=i,h=j),f&&(c.splice(0,h,f),a=c.join("/"))}return a}function g(b,c){return function(){var d=v.call(arguments,0);return"string"!=typeof d[0]&&1===d.length&&d.push(null),n.apply(a,d.concat([b,c]))}}function h(a){return function(b){return f(b,a)}}function i(a){return function(b){q[a]=b}}function j(c){if(b(r,c)){var d=r[c];delete r[c],t[c]=!0,m.apply(a,d)}if(!b(q,c)&&!b(t,c))throw new Error("No "+c);return q[c]}function k(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function l(a){return function(){return s&&s.config&&s.config[a]||{}}}var m,n,o,p,q={},r={},s={},t={},u=Object.prototype.hasOwnProperty,v=[].slice,w=/\.js$/;o=function(a,b){var c,d=k(a),e=d[0];return a=d[1],e&&(e=f(e,b),c=j(e)),e?a=c&&c.normalize?c.normalize(a,h(b)):f(a,b):(a=f(a,b),d=k(a),e=d[0],a=d[1],e&&(c=j(e))),{f:e?e+"!"+a:a,n:a,pr:e,p:c}},p={require:function(a){return g(a)},exports:function(a){var b=q[a];return"undefined"!=typeof b?b:q[a]={}},module:function(a){return{id:a,uri:"",exports:q[a],config:l(a)}}},m=function(c,d,e,f){var h,k,l,m,n,s,u=[],v=typeof e;if(f=f||c,"undefined"===v||"function"===v){for(d=!d.length&&e.length?["require","exports","module"]:d,n=0;n<d.length;n+=1)if(m=o(d[n],f),k=m.f,"require"===k)u[n]=p.require(c);else if("exports"===k)u[n]=p.exports(c),s=!0;else if("module"===k)h=u[n]=p.module(c);else if(b(q,k)||b(r,k)||b(t,k))u[n]=j(k);else{if(!m.p)throw new Error(c+" missing "+k);m.p.load(m.n,g(f,!0),i(k),{}),u[n]=q[k]}l=e?e.apply(q[c],u):void 0,c&&(h&&h.exports!==a&&h.exports!==q[c]?q[c]=h.exports:l===a&&s||(q[c]=l))}else c&&(q[c]=e)},c=d=n=function(b,c,d,e,f){if("string"==typeof b)return p[b]?p[b](c):j(o(b,c).f);if(!b.splice){if(s=b,s.deps&&n(s.deps,s.callback),!c)return;c.splice?(b=c,c=d,d=null):b=a}return c=c||function(){},"function"==typeof d&&(d=e,e=f),e?m(a,b,c,d):setTimeout(function(){m(a,b,c,d)},4),n},n.config=function(a){return n(a)},c._defined=q,e=function(a,c,d){if("string"!=typeof a)throw new Error("See almond README: incorrect module build, no module name");c.splice||(d=c,c=[]),b(q,a)||b(r,a)||(r[a]=[a,c,d])},e.amd={jQuery:!0}}(),e("../node_modules/almond/almond",function(){}),e("utils/utils-dom",["exports"],function(c){Object.defineProperty(c,"__esModule",{value:!0});var d=document.createElement("div"),e={appendTo:function(a,b){var c;return a instanceof Node?c=a:(d.insertAdjacentHTML("afterbegin",a),c=d.childNodes[0]),b.appendChild(c),c},getScrollbarWidth:function(){var a=document.createElement("div");a.style.overflow="scroll",a.style.visibility="hidden",a.style.position="absolute",a.style.width="100px",a.style.height="100px",document.body.appendChild(a);var b=a.offsetWidth-a.clientWidth;return document.body.removeChild(a),b},getStyle:function(a,b){return window.getComputedStyle(a,void 0).getPropertyValue(b)},getStyleAsNum:function(a,b){return parseInt(this.getStyle(a,b)||0,10)},getContainerSize:function(a){var b=this.getStyleAsNum(a,"padding-left"),c=this.getStyleAsNum(a,"padding-right"),d=this.getStyleAsNum(a,"padding-bottom"),e=this.getStyleAsNum(a,"padding-top"),f=this.getStyleAsNum(a,"border-top-width"),g=this.getStyleAsNum(a,"border-left-width"),h=this.getStyleAsNum(a,"border-right-width"),i=this.getStyleAsNum(a,"border-bottom-width"),j=f+g+h+i,k=a.getBoundingClientRect();return{width:k.width-b-c-2*j,height:k.height-d-e-2*j}},getAxisTickLabelSize:function(c){var d=['<svg class="graphical-report__svg">','<g class="graphical-report__cell cell">','<g class="x axis">','<g class="tick"><text><%= xTick %></text></g>',"</g>","</g>","</svg>"].join(""),e=a.template(d),f=document.createElement("div");f.style.position="absolute",f.style.visibility="hidden",f.style.width="100px",f.style.height="100px",f.style.border="1px solid green",document.body.appendChild(f),f.innerHTML=e({xTick:c});var g=b.select(f).selectAll(".x.axis .tick text")[0][0],h={width:0,height:0},i=g.getBoundingClientRect();h.width=i.right-i.left,h.height=i.bottom-i.top;var j=0!==c.length?h.width/c.length:0;return h.width=h.width+1.5*j,document.body.removeChild(f),h}};c.utilsDom=e}),e("const",["exports"],function(a){Object.defineProperty(a,"__esModule",{value:!0});var b="graphical-report__";a.CSS_PREFIX=b}),e("elements/element.point",["exports","../const"],function(b,c){var d=function(){function a(a,b){for(var c in b){var d=b[c];d.configurable=!0,d.value&&(d.writable=!0)}Object.defineProperties(a,b)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),e=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(b,"__esModule",{value:!0});{var f=c.CSS_PREFIX;b.Point=function(){function b(c){e(this,b),this.config=c,this.config.guide=this.config.guide||{},this.config.guide.x=this.config.guide.x||{},this.config.guide.x=a.defaults(this.config.guide.x,{tickFontHeight:0,density:20}),this.config.guide.y=this.config.guide.y||{},this.config.guide.y=a.defaults(this.config.guide.y,{tickFontHeight:0,density:20})}return d(b,{drawLayout:{value:function(b){var c=this.config;this.xScale=b("pos",c.x,[0,c.options.width]),this.yScale=b("pos",c.y,[c.options.height,0]),this.color=b("color",c.color,{});var d=function(a,b,c,d,e){var f=Math.min(a,b),g=f*c;return Math.max(e,Math.min(d,g))},e=c.options.width,f=c.options.height,g=c.guide,h=1,i=.035,j=function(a){return 0!==a},k=.5*a.min([g.x.tickFontHeight,g.y.tickFontHeight].filter(j)),l=.5*a.min([g.x.density,g.y.density].filter(j));return this.size=b("size",c.size,{min:d(e,f,i,2,h),max:d(e,f,i,l,h),mid:d(e,f,i,k,h)}),this}},drawFrames:{value:function(a){var b=this.config.options,c=""+f+"dot dot i-role-element i-role-datum",d=this.xScale,e=this.yScale,g=this.color,h=this.size,i=function(){return this.attr({r:function(a){var b=a.data;return h(b[h.dim])},cx:function(a){var b=a.data;return d(b[d.dim])},cy:function(a){var b=a.data;return e(b[e.dim])},"class":function(a){var b=a.data;return""+c+" "+g(b[g.dim])}}).transition().duration(500).attr("r",function(a){var b=a.data;return h(b[h.dim])})},j=function(){return this.attr({r:function(a){var b=a.data;return h(b[h.dim])},cx:function(a){var b=a.data;return d(b[d.dim])},cy:function(a){var b=a.data;return e(b[e.dim])},"class":function(a){var b=a.data;return""+c+" "+g(b[g.dim])}})},k=function(){this.attr("class",function(a){return"frame-id-"+b.uid+" frame-"+a.hash}).call(function(){var a=this.selectAll("circle").data(function(a){return a.data.map(function(a){return{data:a,uid:b.uid}})});a.exit().remove(),a.call(j),a.enter().append("circle").call(i)})},l=function(a){return{tags:a.key||{},hash:a.hash(),data:a.take()}},m=b.container.selectAll(".frame-id-"+b.uid).data(a.map(l),function(a){return a.hash});return m.exit().remove(),m.call(k),m.enter().append("g").call(k),[]}}}),b}()}}),e("utils/css-class-map",["exports","../const"],function(a,b){function c(a){return g[a-1]||g[4]}function d(a){var b=0;return a>=160&&320>a?b=1:a>=320&&480>a?b=2:a>=480&&640>a?b=3:a>=640&&(b=4),h[b]}Object.defineProperty(a,"__esModule",{value:!0});var e=b.CSS_PREFIX,f=[1,2,3,4,5],g=f.map(function(a){return e+"line-opacity-"+a}),h=f.map(function(a){return e+"line-width-"+a});a.getLineClassesByWidth=d,a.getLineClassesByCount=c}),e("elements/element.line",["exports","../const","../utils/css-class-map"],function(c,d,e){var f=function(){function a(a,b){for(var c in b){var d=b[c];d.configurable=!0,d.value&&(d.writable=!0)}Object.defineProperties(a,b)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(c,"__esModule",{value:!0});{var h=d.CSS_PREFIX,i=e.getLineClassesByWidth,j=e.getLineClassesByCount;c.Line=function(){function c(b){g(this,c),this.config=b,this.config.guide=this.config.guide||{},this.config.guide=a.defaults(this.config.guide,{cssClass:"i-role-datum",widthCssClass:"",anchors:!1})}return f(c,{drawLayout:{value:function(a){var b=this.config;return this.xScale=a("pos",b.x,[0,b.options.width]),this.yScale=a("pos",b.y,[b.options.height,0]),this.color=a("color",b.color,{}),this.size=a("size",b.size,{}),this}},drawFrames:{value:function(a){var c=this.config.guide,d=this.config.options,e=this.xScale,f=this.yScale,g=this.color,k=this.size,l=c.widthCssClass||i(d.width),m=j(a.length),n=b.svg.line().x(function(a){return e(a[e.dim])}).y(function(a){return f(a[f.dim])});c.interpolate&&n.interpolate(c.interpolate);var o=""+h+"line i-role-element line "+l+" "+m+" "+c.cssClass,p=function(){var a=this.selectAll("path").data(function(a){var b=a.data;return[b.data]});a.exit().remove(),a.attr("d",n),a.enter().append("path").attr("d",n)},q=""+h+"dot-line dot-line i-role-element "+h+"dot ",r=function(){var a=this.selectAll("circle").data(function(a){return a.data.data.map(function(a){return{data:a,uid:d.uid}})}),b={r:function(a){var b=a.data;return k(b[k.dim])},cx:function(a){var b=a.data;return e(b[e.dim])},cy:function(a){var b=a.data;return f(b[f.dim])},"class":function(a){var b=a.data;return""+q+" "+g(b[g.dim])}};a.exit().remove(),a.attr(b),a.enter().append("circle").attr(b)},s=function(a,b,c){return function(){this.attr("class",function(b){var c=b.data;return""+o+" "+g(c.tags[g.dim])+" "+a+" frame-"+c.hash}).call(function(){b&&p.call(this),c&&r.call(this)})}},t=function(a){return{data:{tags:a.key||{},hash:a.hash(),data:a.take()},uid:d.uid}},u=function(b,e,f){var g="line"===b,h=!g||c.anchors,i=d.container.selectAll(".frame-"+e).data(a.map(t).filter(f),function(a){var b=a.data;return b.hash});i.exit().remove(),i.call(s("frame-"+e,g,h)),i.enter().append("g").call(s("frame-"+e,g,h))};u("line","line-"+d.uid,function(a){var b=a.data;return b.data.length>1}),u("anch","anch-"+d.uid,function(a){var b=a.data;return b.data.length<2})}}}),c}()}}),e("utils/utils-draw",["exports"],function(a){Object.defineProperty(a,"__esModule",{value:!0});var b={translate:function(a,b){return"translate("+a+","+b+")"},rotate:function(a){return"rotate("+a+")"},getOrientation:function(a){return["bottom","top"].indexOf(a.toLowerCase())>=0?"h":"v"}};a.utilsDraw=b}),e("elements/element.interval.fn",["exports","../utils/utils-draw","../const"],function(a,b,c){function d(a,b,c){var d=a.calculateX,e=a.calculateY,f=a.colorScale,i=a.calculateWidth,j=a.calculateHeight,k=a.calculateTranslate,l=function(){return this.attr("height",j).attr("width",i).attr("class",function(a){var b=a.data;return"i-role-element i-role-datum bar "+g+"bar "+f(b[f.scaleDim])}).attr("x",d).attr("y",e)},m=function(){this.attr("class",h).attr("transform",k);var a=this.selectAll(".bar").data(function(a){return a.values.map(function(b){return{data:b,uid:a.uid}})});a.call(l),a.enter().append("rect").call(l),a.exit().remove()},n=b.selectAll("."+h).data(c);n.call(m),n.enter().append("g").call(m),n.exit().remove()}var e=function(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)};Object.defineProperty(a,"__esModule",{value:!0});var f=b.utilsDraw,g=c.CSS_PREFIX,h="i-role-bar-group",i=1,j=function(a){var b=a.domain().length,c=a.categoryLength,d=a.size/b,e=d/(c+1);return{tickWidth:d,intervalWidth:e,offsetCategory:e}},k=function(a){return"linear"===a.scaleType||"time"===a.scaleType},l={NORM:function(a){var b=a.colorScale,c=a.node,d=a.xScale,g=a.yScale,h=a.colorIndexScale,l=a.width,m=a.height,n=a.defaultSizeParams,o=1,p=Math.min.apply(Math,e(g.domain())),q=!isNaN(p),r=!q||0>=p?0:p,s=k(c.x),t=s?n:j({domain:d.domain,categoryLength:h.count(),size:l}),u=t.tickWidth,v=t.intervalWidth,w=t.offsetCategory,x=v>2*i?i:0,y=function(a){var b=a.data;return d(b[c.x.scaleDim])-u/2+x},z=q?function(a){var b=a.data,d=b[c.y.scaleDim],e=g(Math.max(r,d)),f=Math.abs(g(d)-g(r)),h=o>f;return h&&d>0?e-o:e}:function(a){var b=a.data;return g(b[c.y.scaleDim])},A=function(a){a.data;return v-2*x},B=q?function(a){var b=a.data,d=b[c.y.scaleDim],e=Math.abs(g(d)-g(r));return 0===d?e:Math.max(o,e)}:function(a){var b=a.data;return m-g(b[c.y.scaleDim])},C=function(a){var b=a.key;return f.translate(h({key:b})*w+w/2,0)};return{colorScale:b,calculateX:y,calculateY:z,calculateWidth:A,calculateHeight:B,calculateTranslate:C}},FLIP:function(a){var b=a.colorScale,c=a.node,d=a.xScale,g=a.yScale,h=a.colorIndexScale,l=(a.width,a.height),m=a.defaultSizeParams,n=1,o=Math.min.apply(Math,e(d.domain())),p=!isNaN(o),q=!p||0>=o?0:o,r=k(c.y),s=r?m:j({domain:g.domain,categoryLength:h.count(),size:l}),t=s.tickWidth,u=s.intervalWidth,v=s.offsetCategory,w=u>2*i?i:0,x=p?function(a){var b=a.data,e=b[c.x.scaleDim],f=Math.abs(d(e)-d(q)),g=d(Math.min(q,e)),h=f-n,i=e>0?n+h:0>e?0-n:0,j=0>h;return j?g+i:g}:0,y=function(a){var b=a.data;return g(b[c.y.scaleDim])-t/2+w},z=p?function(a){var b=a.data,e=b[c.x.scaleDim],f=Math.abs(d(e)-d(q));return 0===e?f:Math.max(n,f)}:function(a){var b=a.data;return d(b[c.x.scaleDim])},A=function(a){a.data;return u-2*w},B=function(a){var b=a.key;return f.translate(0,h({key:b})*v+v/2)};return{colorScale:b,calculateX:x,calculateY:y,calculateWidth:z,calculateHeight:A,calculateTranslate:B}}};a.flipHub=l,a.drawInterval=d}),e("elements/element.interval",["exports","../const","./element.interval.fn"],function(b,c,d){var e=function(){function a(a,b){for(var c in b){var d=b[c];d.configurable=!0,d.value&&(d.writable=!0)}Object.defineProperties(a,b)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(b,"__esModule",{value:!0});{var g=(c.CSS_PREFIX,d.flipHub),h=d.drawInterval;b.Interval=function(){function b(a){f(this,b),this.config=a}return e(b,{drawLayout:{value:function(a){var b=this.config;return this.xScale=a("pos",b.x,[0,b.options.width]),this.yScale=a("pos",b.y,[b.options.height,0]),this.color=a("color",b.color,{}),this.size=a("size",b.size,{}),this}},drawFrames:{value:function(b){var c=this,d=this.config.options.container,e=this.config,f=this.xScale,i=this.yScale,j=this.color,k={options:{container:d,xScale:f,yScale:i,color:j,width:e.options.width,height:e.options.height},x:f,y:i,color:j},l=g[this.config.flip?"FLIP":"NORM"],m=function(b){var c=(b.key||{})[j.scaleDim],d=a.findIndex(n,function(a){return a===c});return-1===d?0:d},n=j.domain();m.count=function(){return n.length||1};var o=l({node:k,xScale:f,yScale:i,colorScale:j,colorIndexScale:m,width:e.options.width,height:e.options.height,defaultSizeParams:{tickWidth:5,intervalWidth:5,offsetCategory:0}});h(o,d,b.map(function(a){return{key:a.key,values:a.data,uid:c.config.options.uid}}))}}}),b}()}}),e("utils/utils",["exports","../elements/element.point","../elements/element.line","../elements/element.interval"],function(b,c,d,e){Object.defineProperty(b,"__esModule",{value:!0});var f=c.Point,g=d.Line,h=e.Interval,i=function(a,b,c,d){var e=d(c(a),a);return(e[b]||[]).forEach(function(a){return i(a,b,c,d)}),e},j=0,k={},l=function(){function a(a){return"object"==typeof a?JSON.parse(JSON.stringify(a)):a}function b(a){for(var b in a)this[b]=a[b]}function c(){this.copiedObjects=[];var a=this;this.recursiveDeepCopy=function(b){return a.deepCopy(b)},this.depth=0}function d(a,b){var d=new c;return b&&(d.maxDepth=b),d.deepCopy(a)}var e=[];return b.prototype={constructor:b,canCopy:function(){return!1},create:function(){},populate:function(){}},c.prototype={constructor:c,maxDepth:256,cacheResult:function(a,b){this.copiedObjects.push([a,b])},getCachedResult:function(a){for(var b=this.copiedObjects,c=b.length,d=0;c>d;d++)if(b[d][0]===a)return b[d][1];return void 0},deepCopy:function(a){if(null===a)return null;if("object"!=typeof a)return a;var b=this.getCachedResult(a);if(b)return b;for(var c=0;c<e.length;c++){var d=e[c];if(d.canCopy(a))return this.applyDeepCopier(d,a)}throw new Error("no DeepCopier is able to copy "+a)},applyDeepCopier:function(a,b){var c=a.create(b);if(this.cacheResult(b,c),this.depth++,this.depth>this.maxDepth)throw new Error("Exceeded max recursion depth in deep copy.");return a.populate(this.recursiveDeepCopy,b,c),this.depth--,c}},d.DeepCopier=b,d.deepCopiers=e,d.register=function(a){a instanceof b||(a=new b(a)),e.unshift(a)},d.register({canCopy:function(){return!0},create:function(b){return b instanceof b.constructor?a(b.constructor.prototype):{}},populate:function(a,b,c){for(var d in b)b.hasOwnProperty(d)&&(c[d]=a(b[d]));return c}}),d.register({canCopy:function(a){return a instanceof Array},create:function(a){return new a.constructor},populate:function(a,b,c){for(var d=0;d<b.length;d++)c.push(a(b[d]));return c}}),d.register({canCopy:function(a){return a instanceof Date},create:function(a){return new Date(a)}}),d}(),m={clone:function(a){return l(a)},isArray:function(a){return Array.isArray(a)},isChartElement:function(a){return a instanceof h||a instanceof f||a instanceof g},isLineElement:function(a){return a instanceof g},autoScale:function(a){var b=10,c=Math.min.apply(null,a),d=Math.max.apply(null,a);if(c===d){var e=d>=0?-1:1,f=d||1;d-=e*f/b}for(var g=[c,d],h=g[1]-g[0],i=Math.pow(10,Math.floor(Math.log(h/b)/Math.LN10)),j=b/h*i,k=[[.15,10],[.35,5],[.75,2],[1,1],[2,1]],l=-1;j>k[++l][0];);i*=k[l][1],g[0]=Math.floor(g[0]/i)*i,g[1]=Math.ceil(g[1]/i)*i;var m=c-g[0],n=g[1]-d,o=i/2;if(c>=0)g[0]=0;else{var p=o>=m?i:0;g[0]=g[0]-p}if(0>=d)g[1]=0;else{var q=o>=n?i:0;g[1]=g[1]+q}return[parseFloat(g[0].toFixed(15)),parseFloat(g[1].toFixed(15))]},traverseJSON:i,generateHash:function(a){var b=btoa(encodeURIComponent(a)).replace(/=/g,"_");return k.hasOwnProperty(b)||(k[b]="H"+ ++j),k[b]},generateRatioFunction:function(b,c,d){return function(e,f,g){var h=g.length,i=d.getSpec(),j=i.sources["/"].data,k=i.unit.units[0].guide||{};k.padding=k.padding||{l:0,r:0,t:0,b:0};var l=0;"x"===b?l=k.padding.l+k.padding.r:"y"===b&&(l=k.padding.t+k.padding.b);var m=function(b){return a(j).chain().map(function(a){return b.reduce(function(b,c){return b.concat(a[c])},[])}).uniq(function(a){return JSON.stringify(a)}).reduce(function(a,b){var c=b[0];return a[c]=a[c]||0,a[c]+=1,a},{}).value()},n=function(b){return a.values(m(b)).reduce(function(a,b){return a+b},0)},o=function(a,b){return m(a)[b]},p=n(c),q=(f-h*l)/p,r=o(c,e);return(r*q+l)/f}}};b.utils=m}),e("event",["exports"],function(a){function b(a){var b=f[a];return b||(b=function(){for(var b,c,d=this,e=0;d=d.handler;){if(c=d.callbacks[a],"function"==typeof c){if(!b)for(b=[this],e=0;e<arguments.length;e++)b.push(arguments[e]);c.apply(d.context,b)}if(c=d.callbacks["*"],"function"==typeof c){if(!b)for(b=[this],e=0;e<arguments.length;e++)b.push(arguments[e]);c.call(d.context,{sender:this,type:a,args:b})}}},f[a]=b),b}var c=function(){function a(a,b){for(var c in b){var d=b[c];d.configurable=!0,d.value&&(d.writable=!0)}Object.defineProperties(a,b)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),d=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(a,"__esModule",{value:!0});var e={},f={},g=function(){function a(){d(this,a),this.handler=null,this.emit_destroy=b("destroy")}return c(a,{addHandler:{value:function(a,b){b=b||this,this.handler={callbacks:a,context:b,handler:this.handler}}},on:{value:function(a,b,c){var d={};return d[a]=b,this.addHandler(d,c),d}},fire:{value:function(a,c){b.call(this,a).call(this,c)}},removeHandler:{value:function(a,b){var c,d=this;for(b=b||this;c=d,d=d.handler;)if(d.callbacks===a&&d.context===b)return d.callbacks=e,void(c.handler=d.handler)}},destroy:{value:function(){this.emit_destroy(),this.handler=null}}}),a}();a.Emitter=g}),e("units-registry",["exports"],function(a){Object.defineProperty(a,"__esModule",{value:!0});var b={},c={reg:function(a,c){return b[a]=c,this},get:function(a){if(!b.hasOwnProperty(a))throw new Error("Unknown unit type: "+a);return b[a]}};a.unitsRegistry=c}),e("utils/layuot-template",["exports","../const"],function(a,b){Object.defineProperty(a,"__esModule",{value:!0});var c=b.CSS_PREFIX,d=function(a,b){var d="div",e=document.createElement(d);return e.classList.add(c+a),b&&b.appendChild(e),e},e=function(){var a=d("layout"),b=d("layout__header",a),c=d("layout__container",a),e=d("layout__sidebar",c),f=d("layout__content",c),g=d("layout__content__wrap",f),h=d("layout__sidebar-right",c),i=d("layout__sidebar-right__wrap",h),j=d("layout__footer",a);return{layout:a,header:b,content:g,leftSidebar:e,rightSidebar:i,footer:j}};a.getLayout=e}),e("scales-registry",["exports"],function(a){Object.defineProperty(a,"__esModule",{value:!0});var b={},c={reg:function(a,c){return b[a]=c,this},get:function(a){return b[a]}};a.scalesRegistry=c}),e("scales-factory",["exports","./scales-registry"],function(a,b){var c=function(){function a(a,b){for(var c in b){var d=b[c];d.configurable=!0,d.value&&(d.writable=!0)}Object.defineProperties(a,b)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),d=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(a,"__esModule",{value:!0});{var e=b.scalesRegistry;a.ScalesFactory=function(){function a(b){d(this,a),this.sources=b}return c(a,{create:{value:function(a,b,c){var d=e.get(a.type),f=a.dim,g=a.source,h=(this.sources[g].dims[f]||{}).type,i=this.sources[g].data,j={part:function(){return b?b.take():i},full:function(){return i}};return a.dimType=h,new d(j,a).create(c)}}}),a}()}}),e("unit-domain-period-generator",["exports"],function(a){Object.defineProperty(a,"__esModule",{value:!0});var b={day:{cast:function(a){return new Date(a.setHours(0,0,0,0))},next:function(a){return new Date(a.setDate(a.getDate()+1))}},week:{cast:function(a){return a=new Date(a.setHours(0,0,0,0)),a=new Date(a.setDate(a.getDate()-a.getDay()))},next:function(a){return new Date(a.setDate(a.getDate()+7))}},month:{cast:function(a){return a=new Date(a.setHours(0,0,0,0)),a=new Date(a.setDate(1))},next:function(a){return new Date(a.setMonth(a.getMonth()+1))}},quarter:{cast:function(a){a=new Date(a.setHours(0,0,0,0)),a=new Date(a.setDate(1));var b=a.getMonth(),c=b-b%3;return new Date(a.setMonth(c))},next:function(a){return new Date(a.setMonth(a.getMonth()+3))}},year:{cast:function(a){return a=new Date(a.setHours(0,0,0,0)),a=new Date(a.setDate(1)),a=new Date(a.setMonth(0))},next:function(a){return new Date(a.setFullYear(a.getFullYear()+1))}}},c={add:function(a,c){return b[a.toLowerCase()]=c,this},get:function(a){return b[a.toLowerCase()]},generate:function(a,c,d){var e=[],f=b[d.toLowerCase()];if(f){var g=f.cast(new Date(c)),h=f.cast(new Date(a));for(e.push(h);(h=f.next(new Date(h)))<=g;)e.push(h)}return e}};a.UnitDomainPeriodGenerator=c}),e("algebra",["exports","underscore","./unit-domain-period-generator"],function(a,b,c){var d=function(a){return a&&a.__esModule?a["default"]:a},e=function(a,b,c){return Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0})};Object.defineProperty(a,"__esModule",{value:!0});var f=d(b),g=c.UnitDomainPeriodGenerator,h=function(a){return a instanceof Date?a.getTime():a},i={cross:function(a,b,c){var d=a(),e=f(d).chain().pluck(b).unique(h).value(),g=f(d).chain().pluck(c).unique(h).value(),i=0===e.length?[null]:e,j=0===g.length?[null]:g;return f(j).reduce(function(a,d){return a.concat(f(i).map(function(a){var e={};return b&&(e[b]=h(a)),c&&(e[c]=h(d)),e}))},[])},cross_period:function(a,b,c,d,e){var i=a(),j=f(i).chain().pluck(b).unique(h).value(),k=f(i).chain().pluck(c).unique(h).value(),l=0===j.length?[null]:j,m=0===k.length?[null]:k;return d&&(l=g.generate(f.min(j),f.max(j),d)),e&&(m=g.generate(f.min(k),f.max(k),e)),f(m).reduce(function(a,d){return a.concat(f(l).map(function(a){var e={};return b&&(e[b]=h(a)),c&&(e[c]=h(d)),e}))},[])},groupBy:function(a,b){var c=a(),d=f(c).chain().pluck(b).unique(h).value();return d.map(function(a){return e({},b,h(a))})},none:function(){return[null]}};a.FramesAlgebra=i}),e("charts/tau.gpl",["exports","../event","../utils/utils","../utils/utils-dom","../units-registry","../utils/layuot-template","../scales-factory","../const","../algebra"],function(c,d,e,f,g,h,i,j,k){var l=function(){function a(a,b){for(var c in b){var d=b[c];d.configurable=!0,d.value&&(d.writable=!0)}Object.defineProperties(a,b)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),m=function x(a,b,c){var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){var e=Object.getPrototypeOf(a);return null===e?void 0:x(e,b,c)}if("value"in d&&d.writable)return d.value;var f=d.get;return void 0===f?void 0:f.call(c)},n=function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(a.__proto__=b)},o=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(c,"__esModule",{value:!0});{var p=d.Emitter,q=e.utils,r=f.utilsDom,s=g.unitsRegistry,t=(h.getLayout,i.ScalesFactory),u=j.CSS_PREFIX,v=k.FramesAlgebra,w=function(b){return a.isDate(b)?b.getTime():b};c.GPL=function(c){function d(b){o(this,d),m(Object.getPrototypeOf(d.prototype),"constructor",this).call(this),this.config=b,this.config.settings=this.config.settings||{},this.unitSet=b.unitsRegistry||s,this.sources=b.sources,this.scalesCreator=new t(b.sources),this.scales=b.scales,this.transformations=a.extend(b.transformations||{},{where:function(b,c){var d=a.map(c,function(a,b){return function(c){return w(c[b])===a}});return a(b).filter(function(b){return a.every(d,function(a){return a(b)})})}}),this.onUnitDraw=b.onUnitDraw,this.onUnitsStructureExpanded=b.onUnitsStructureExpanded||function(a){return a}}return n(d,c),l(d,{renderTo:{value:function(c,d){var e=b.select(c);this.config.settings.size=d||a.defaults(r.getContainerSize(e.node())),this.root=this._expandUnitsStructure(this.config.unit),this.onUnitsStructureExpanded(this.config);var f=e.selectAll("svg").data([1]),g=this.config.settings.size,h={"class":""+u+"svg",width:g.width,height:g.height};f.attr(h),f.enter().append("svg").attr(h).append("g").attr("class",""+u+"cell cell frame-root"),this.root.options={container:e.select(".frame-root"),frameId:"root",left:0,top:0,width:g.width,height:g.height},this._drawUnitsStructure(this.root,this._datify({source:this.root.expression.source,pipe:[]}))}},_expandUnitsStructure:{value:function(a){var b=this,c=void 0===arguments[1]?[]:arguments[1],d=this;if(a.expression.operator!==!1){var e=this._parseExpression(a.expression,c);a.transformation=a.transformation||[],a.frames=e.exec().map(function(b){var f=e.inherit?c:[],g=f.concat([{type:"where",args:b}]).concat(a.transformation),h={source:e.source,pipe:g};return b&&(h.key=b),h.units=a.units?a.units.map(function(a){var b=q.clone(a);return b.guide=a.guide,b}):[],d._datify(h)})}return a.frames.forEach(function(a){return a.units.forEach(function(c){return b._expandUnitsStructure(c,a.pipe)})}),a}},_drawUnitsStructure:{value:function(a,b){var c=void 0===arguments[2]?null:arguments[2],d=this,e=d.unitSet.get(a.type),f=new e(a);return f.parentUnit=c,f.drawLayout(function(a,c,e){var f=c?c:""+a+":default";return d.scalesCreator.create(d.scales[f],b,e)}).drawFrames(a.frames,function(a){return function(b,c){d._drawUnitsStructure.bind(d)(b,c,a)}}(f)),d.onUnitDraw&&d.onUnitDraw(f),a}},_datify:{value:function(a){var b=this.sources[a.source].data,c=this.transformations;return a.hash=function(){return q.generateHash([a.pipe,a.key,a.source].map(JSON.stringify).join(""))},a.take=function(){return a.pipe.reduce(function(a,b){return c[b.type](a,b.args)},b)},a.data=a.take(),a}},_parseExpression:{value:function(a,b){var c=this,d=a.operator||"none",e=a.source,f=a.inherit!==!1,g=a.params,h=this.sources[e],i=f?function(){return b.reduce(function(a,b){return c.transformations[b.type](a,b.args)},h.data)}:function(){return h.data},j=v[d];if(!j)throw new Error(""+d+" operator is not supported");return{source:e,inherit:f,func:j,args:g,exec:function(){return j.apply(null,[i].concat(g))}}}}}),d}(p)}}),e("api/balloon",["exports","../const"],function(a,b){function c(a,b){for(var c in b)a[c]=b[c];return a}function d(a){return a&&null!=a.setInterval}function e(a){var b=l.pageYOffset||o.scrollTop,e=l.pageXOffset||o.scrollLeft,f={left:0,right:0,top:0,bottom:0,width:0,height:0};if(d(a))f.width=l.innerWidth||o.clientWidth,f.height=l.innerHeight||o.clientHeight;else{if(!o.contains(a)||null==a.getBoundingClientRect)return f;c(f,a.getBoundingClientRect()),f.width=f.right-f.left,f.height=f.bottom-f.top}return f.top=f.top+b-o.clientTop,f.left=f.left+e-o.clientLeft,f.right=f.left+f.width,f.bottom=f.top+f.height,f}function f(a){return 0|Math.round(String(a).replace(/[^\-0-9.]/g,""))}function g(a){var b=String(q(a,g.propName)),c=b.match(/([0-9.]+)([ms]{1,2})/);return c&&(b=Number(c[1]),"s"===c[2]&&(b*=1e3)),0|b}function h(a,b){return this instanceof h?(this.hidden=1,this.options=c(r(h.defaults),b),this._createElement(),void(a&&this.content(a))):new h(a,b)}Object.defineProperty(a,"__esModule",{value:!0});var i=b.CSS_PREFIX,j=function(a){return{add:function(b){a.classList.add(b)},remove:function(b){a.classList.remove(b)}}},k=function(a,b){return a.indexOf(b)},l=window,m=l.document,n=m.body,o=m.documentElement,p=["top","bottom"],q=l.getComputedStyle;g.propName=function(){for(var a=m.createElement("div"),b=["transitionDuration","webkitTransitionDuration"],c="1s",d=0;d<b.length;d++)if(a.style[b[d]]=c,a.style[b[d]]===c)return b[d]}();var r=Object.create;h.prototype._createElement=function(){this.element=m.createElement("div"),this.classes=j(this.element),this.classes.add(this.options.baseClass);for(var a,b=0;b<h.classTypes.length;b++)a=h.classTypes[b]+"Class",this.options[a]&&this.classes.add(this.options[a])},h.prototype.type=function(a){return this.changeClassType("type",a)},h.prototype.effect=function(a){return this.changeClassType("effect",a)},h.prototype.changeClassType=function(a,b){return a+="Class",this.options[a]&&this.classes.remove(this.options[a]),this.options[a]=b,b&&this.classes.add(b),this},h.prototype.updateSize=function(){return this.hidden&&(this.element.style.visibility="hidden",n.appendChild(this.element)),this.width=this.element.offsetWidth,this.height=this.element.offsetHeight,null==this.spacing&&(this.spacing=null!=this.options.spacing?this.options.spacing:f(q(this.element,"top"))),this.hidden?(n.removeChild(this.element),this.element.style.visibility=""):this.position(),this},h.prototype.content=function(a){return"object"==typeof a?(this.element.innerHTML="",this.element.appendChild(a)):this.element.innerHTML=a,this.updateSize(),this},h.prototype.place=function(a){return this.options.place=a,this.hidden||this.position(),this},h.prototype.attach=function(a){return this.attachedTo=a,this.hidden||this.position(),this},h.prototype.detach=function(){return this.hide(),this.attachedTo=null,this},h.prototype._pickPlace=function(a){if(!this.options.auto)return this.options.place;var b=e(l),c=this.options.place.split("-"),d=this.spacing;if(-1!==k(p,c[0]))switch(a.top-this.height-d<=b.top?c[0]="bottom":a.bottom+this.height+d>=b.bottom&&(c[0]="top"),
c[1]){case"left":a.right-this.width<=b.left&&(c[1]="right");break;case"right":a.left+this.width>=b.right&&(c[1]="left");break;default:a.left+a.width/2+this.width/2>=b.right?c[1]="left":a.right-a.width/2-this.width/2<=b.left&&(c[1]="right")}else switch(a.left-this.width-d<=b.left?c[0]="right":a.right+this.width+d>=b.right&&(c[0]="left"),c[1]){case"top":a.bottom-this.height<=b.top&&(c[1]="bottom");break;case"bottom":a.top+this.height>=b.bottom&&(c[1]="top");break;default:a.top+a.height/2+this.height/2>=b.bottom?c[1]="top":a.bottom-a.height/2-this.height/2<=b.top&&(c[1]="bottom")}return c.join("-")},h.prototype.position=function(a,b){this.attachedTo&&(a=this.attachedTo),null==a&&this._p?(a=this._p[0],b=this._p[1]):this._p=arguments;var c="number"==typeof a?{left:0|a,right:0|a,top:0|b,bottom:0|b,width:0,height:0}:e(a),d=this.spacing,f=this._pickPlace(c);f!==this.curPlace&&(this.curPlace&&this.classes.remove(this.curPlace),this.classes.add(f),this.curPlace=f);var g,h;switch(this.curPlace){case"top":g=c.top-this.height-d,h=c.left+c.width/2-this.width/2;break;case"top-left":g=c.top-this.height-d,h=c.right-this.width;break;case"top-right":g=c.top-this.height-d,h=c.left;break;case"bottom":g=c.bottom+d,h=c.left+c.width/2-this.width/2;break;case"bottom-left":g=c.bottom+d,h=c.right-this.width;break;case"bottom-right":g=c.bottom+d,h=c.left;break;case"left":g=c.top+c.height/2-this.height/2,h=c.left-this.width-d;break;case"left-top":g=c.bottom-this.height,h=c.left-this.width-d;break;case"left-bottom":g=c.top,h=c.left-this.width-d;break;case"right":g=c.top+c.height/2-this.height/2,h=c.right+d;break;case"right-top":g=c.bottom-this.height,h=c.right+d;break;case"right-bottom":g=c.top,h=c.right+d}return this.element.style.top=Math.round(g)+"px",this.element.style.left=Math.round(h)+"px",this},h.prototype.show=function(a,b){return a=this.attachedTo?this.attachedTo:a,clearTimeout(this.aIndex),null!=a&&this.position(a,b),this.hidden&&(this.hidden=0,n.appendChild(this.element)),this.attachedTo&&this._aware(),this.options.inClass&&(this.options.effectClass&&void this.element.clientHeight,this.classes.add(this.options.inClass)),this},h.prototype.getElement=function(){return this.element},h.prototype.hide=function(){if(!this.hidden){var a=this,b=0;return this.options.inClass&&(this.classes.remove(this.options.inClass),this.options.effectClass&&(b=g(this.element))),this.attachedTo&&this._unaware(),clearTimeout(this.aIndex),this.aIndex=setTimeout(function(){a.aIndex=0,n.removeChild(a.element),a.hidden=1},b),this}},h.prototype.toggle=function(a,b){return this[this.hidden?"show":"hide"](a,b)},h.prototype.destroy=function(){clearTimeout(this.aIndex),this._unaware(),this.hidden||n.removeChild(this.element),this.element=this.options=null},h.prototype._aware=function(){var a=k(h.winAware,this);-1===a&&h.winAware.push(this)},h.prototype._unaware=function(){var a=k(h.winAware,this);-1!==a&&h.winAware.splice(a,1)},h.reposition=function(){function a(){!c&&h.winAware.length&&(c=d(b))}function b(){c=0;for(var a,b=0,d=h.winAware.length;d>b;b++)a=h.winAware[b],a.position()}var c,d=window.requestAnimationFrame||window.webkitRequestAnimationFrame||function(a){return setTimeout(a,17)};return a}(),h.winAware=[],window.addEventListener("resize",h.reposition),window.addEventListener("scroll",h.reposition),h.classTypes=["type","effect"],h.defaults={baseClass:i+"tooltip",typeClass:null,effectClass:null,inClass:"in",place:"top",spacing:null,auto:0},a.Tooltip=h}),e("plugins",["exports","d3","./utils/utils"],function(a,b,c){var d=function(a){return a&&a.__esModule?a["default"]:a},e=function(){function a(a,b){for(var c in b){var d=b[c];d.configurable=!0,d.value&&(d.writable=!0)}Object.defineProperties(a,b)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(a,"__esModule",{value:!0});var g=d(b),h=(c.utils,["click","mouseover","mouseout","mousemove"]),i=function(){function a(b,c){var d=this;f(this,a),this.chart=c,this._unitMap={},this._plugins=b.map(this.initPlugin,this),c.on("render",function(a,b){g.select(b).selectAll(".i-role-datum").call(this._propagateDatumEvents(c))},this),c.on("unitdraw",function(a,b){d._unitMap[b.config.options.uid]=b},this)}return e(a,{initPlugin:{value:function(a){var b=this;a.init&&a.init(this.chart);var c=function(){};this.chart.on("destroy",a.destroy&&a.destroy.bind(a)||c),Object.keys(a).forEach(function(c){if(0===c.indexOf("on")){var d=c.substr(2);b.chart.on(d.toLowerCase(),a[c].bind(a))}})}},_getUnitByHash:{value:function(a){return this._unitMap[a]}},_propagateDatumEvents:{value:function(a){var b=this;return function(){h.forEach(function(c){this.on(c,function(d){var e=g.select(this.parentNode.parentNode).datum(),f=b._getUnitByHash(d.uid),h=d.data;a.fire("element"+c,{elementData:h,element:this,cellData:e,unit:f})})},this)}}}}),a}();a.Plugins=i}),e("data-processor",["exports","./utils/utils"],function(b,c){Object.defineProperty(b,"__esModule",{value:!0});var d=c.utils,e=function(a){return a===Object(a)},f={isYFunctionOfX:function(a,b,c){var d=!0,f=null;try{a.reduce(function(a,d){var g=function(a,b){var c=d[b],f=e(c)?JSON.stringify(c):c;return a.push(f),a},h=b.reduce(g,[]).join("/"),i=c.reduce(g,[]).join("/");if(a.hasOwnProperty(h)){var j=a[h];if(j!==i)throw f={type:"RelationIsNotAFunction",keyX:b.join("/"),keyY:c.join("/"),valX:h,errY:[j,i]},new Error("RelationIsNotAFunction")}else a[h]=i;return a},{})}catch(g){if("RelationIsNotAFunction"!==g.message)throw g;d=!1}return{result:d,error:f}},excludeNullValues:function(a,b){var c=Object.keys(a).reduce(function(b,c){var d=a[c];return d.hasOwnProperty("hasNull")&&!d.hasNull||"measure"!==d.type&&"period"!==d.scale||b.push(c),b},[]);return function(a){var d=!c.some(function(b){return!(b in a)||null===a[b]});return d||b(a),d}},autoAssignScales:function(b){var c="category",d={category:"ordinal",order:"ordinal",measure:"linear"},e={};return Object.keys(b).forEach(function(f){var g=b[f],h=(g.type||c).toLowerCase();e[f]=a.extend({},g,{type:h,scale:g.scale||d[h],value:g.value})}),e},autoDetectDimTypes:function(b){var c={type:"category",scale:"ordinal"},e=function(b,c){var d=c;return a.isDate(b)?(d.type="measure",d.scale="time"):a.isObject(b)?(d.type="order",d.scale="ordinal"):a.isNumber(b)&&(d.type="measure",d.scale="linear"),d},f=function(a,b){return Object.keys(b).forEach(function(f){var g=b.hasOwnProperty(f)?b[f]:null;if(a[f]=a[f]||{type:null,hasNull:!1},null===g)a[f].hasNull=!0;else{var h=e(g,d.clone(c)),i=h.type,j=h.scale,k=null!==a[f].type&&a[f].type!==i;a[f].type=k?c.type:i,a[f].scale=k?c.scale:j}}),a};return a.reduce(b,f,{})}};b.DataProcessor=f}),e("spec-converter",["exports","underscore","./utils/utils"],function(a,b,c){var d=function(a){return a&&a.__esModule?a["default"]:a},e=function(){function a(a,b){for(var c in b){var d=b[c];d.configurable=!0,d.value&&(d.writable=!0)}Object.defineProperties(a,b)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(a,"__esModule",{value:!0});{var g=d(b),h=c.utils;a.SpecConverter=function(){function a(b){f(this,a),this.spec=b,this.dist={sources:{"?":{dims:{},data:[{}]},"/":{dims:{},data:[]}},scales:{x_null:{type:"ordinal",source:"?"},y_null:{type:"ordinal",source:"?"},size_null:{type:"size",source:"?",mid:5},color_null:{type:"color",source:"?",brewer:null},"pos:default":{type:"ordinal",source:"?"},"size:default":{type:"size",source:"?",mid:5},"color:default":{type:"color",source:"?",brewer:null}},settings:b.settings}}return e(a,{convert:{value:function(){var a=this.spec,b=this.dist;return this.ruleAssignSourceDims(a,b),this.ruleAssignStructure(a,b),this.ruleAssignSourceData(a,b),this.ruleApplyDefaults(b),b}},ruleApplyDefaults:{value:function(a){var b=function(a,c,d){c(a,d),(a.units||[]).map(function(d){return b(d,c,a)})},c=function(a,b){if(b&&!a.hasOwnProperty("units")){a=g.defaults(a,g.pick(b,"x","y"));var c=h.clone(b.guide||{});a.guide=a.guide||{},a.guide.x=g.defaults(a.guide.x||{},c.x),a.guide.y=g.defaults(a.guide.y||{},c.y),a.expression.inherit=b.expression.inherit}return a};b(a.unit,c,null)}},ruleAssignSourceData:{value:function(a,b){var c=b.sources["/"].dims,d=function(a,b){return g.isObject(a[b])&&!g.isDate(a[b])&&g.each(a[b],function(c,d){return a[b+"."+d]=c}),a};b.sources["/"].data=a.data.map(function(a){var b=Object.keys(a).reduce(d,a);return Object.keys(c).reduce(function(a,b){return a.hasOwnProperty(b)||(a[b]=null),a},b)})}},ruleAssignSourceDims:{value:function(a,b){var c=a.spec.dimensions;b.sources["/"].dims=Object.keys(c).reduce(function(a,b){return a[b]={type:c[b].type},a},{})}},ruleAssignStructure:{value:function(a,b){var c=this,d=function(a){var b=h.clone(g.omit(a,"unit"));return b.expression=c.ruleInferExpression(a),c.ruleCreateScales(a,b),a.unit&&(b.units=a.unit.map(d)),b},e=d(a.spec.unit);e.expression.inherit=!1,b.unit=e}},ruleCreateScales:{value:function(a,b){var c=this,d=a.guide||{};["color","size","x","y"].forEach(function(e){a.hasOwnProperty(e)&&(b[e]=c.scalesPool(e,a[e],d[e]||{}))})}},ruleInferDim:{value:function(a,b){var c=a,d=this.spec.spec.dimensions;if(!d.hasOwnProperty(c))return c;b.hasOwnProperty("tickLabel")?c=""+a+"."+b.tickLabel:d[a].value&&(c=""+a+"."+d[a].value);var e=this.dist.sources["/"].dims;return e.hasOwnProperty(c)||(e[c]={type:e[a].type}),c}},scalesPool:{value:function(a,b,c){var d=""+a+"_"+b;if(this.dist.scales.hasOwnProperty(d))return d;var e=this.spec.spec.dimensions,f={};return"color"===a&&null!==b&&(f={type:"color",source:"/",dim:this.ruleInferDim(b,c)},c.hasOwnProperty("brewer")&&(f.brewer=c.brewer)),"size"===a&&null!==b&&(f={type:"size",source:"/",dim:this.ruleInferDim(b,c),min:2,max:10,mid:5}),!e.hasOwnProperty(b)||"x"!==a&&"y"!==a||(f={type:e[b].scale,source:"/",dim:this.ruleInferDim(b,c)},e[b].hasOwnProperty("order")&&(f.order=e[b].order),c.hasOwnProperty("min")&&(f.min=c.min),c.hasOwnProperty("max")&&(f.max=c.max),f.autoScale=c.hasOwnProperty("autoScale")?c.autoScale:!0,c.hasOwnProperty("tickPeriod")&&(f.period=c.tickPeriod),f.fitToFrame=c.fitToFrame,f.ratio=c.ratio),this.dist.scales[d]=f,d}},ruleInferExpression:{value:function(a){var b={operator:"none",params:[]},c=a.guide||{},d=c.x||{},e=c.y||{};return 0===a.type.indexOf("ELEMENT.")?a.color&&(b={operator:"groupBy",params:[this.ruleInferDim(a.color,c.color||{})]}):"COORDS.RECT"===a.type&&1===a.unit.length&&"COORDS.RECT"===a.unit[0].type&&(b=d.tickPeriod||e.tickPeriod?{operator:"cross_period",params:[this.ruleInferDim(a.x,d),this.ruleInferDim(a.y,e),d.tickPeriod,e.tickPeriod]}:{operator:"cross",params:[this.ruleInferDim(a.x,d),this.ruleInferDim(a.y,e)]}),g.extend({inherit:!0,source:"/"},b)}}}),a}()}}),e("formatter-registry",["exports","d3"],function(b,c){var d=function(a){return a&&a.__esModule?a["default"]:a};Object.defineProperty(b,"__esModule",{value:!0});var e=d(c),f={"x-num-auto":function(a){var b=parseFloat(a.toFixed(2));return Math.abs(b)<1?b.toString():e.format("s")(b)},percent:function(a){var b=parseFloat((100*a).toFixed(2));return b.toString()+"%"},day:e.time.format("%d-%b-%Y"),"day-short":e.time.format("%d-%b"),week:e.time.format("%d-%b-%Y"),"week-short":e.time.format("%d-%b"),month:function(a){var b=new Date(a),c=b.getMonth(),d=0===c?"%B, %Y":"%B";return e.time.format(d)(a)},"month-short":function(a){var b=new Date(a),c=b.getMonth(),d=0===c?"%b '%y":"%b";return e.time.format(d)(a)},"month-year":e.time.format("%B, %Y"),quarter:function(a){var b=new Date(a),c=b.getMonth(),d=(c-c%3)/3;return"Q"+(d+1)+" "+b.getFullYear()},year:e.time.format("%Y"),"x-time-auto":null},g={get:function(b,c){var d=c||"",g=function(a){return(null===a||"undefined"==typeof a?d:a).toString()},h=f.hasOwnProperty(b),i=h?f[b]:g;return h&&(i=f[b]),!h&&b&&(i=function(c){var d=a.isDate(c)?e.time.format(b):e.format(b);return d(c)}),h||b||(i=g),i},add:function(a,b){f[a]=b}};b.FormatterRegistry=g}),e("spec-transform-auto-layout",["exports","underscore","./utils/utils","./utils/utils-draw","./formatter-registry","./utils/utils-dom","./scales-factory"],function(a,b,c,d,e,f,g){function h(a,b,c,d){var e=a.hasOwnProperty(c)?a[c]:{};e=e||{},l.each(d,function(a){l.extend(b.guide[c][a],e[a])}),l.extend(b.guide[c],l.omit.apply(l,[e].concat[d]))}var i=function(a){return a&&a.__esModule?a["default"]:a},j=function(){function a(a,b){for(var c in b){var d=b[c];d.configurable=!0,d.value&&(d.writable=!0)}Object.defineProperties(a,b)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),k=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(a,"__esModule",{value:!0});var l=i(b),m=c.utils,n=(d.utilsDraw,e.FormatterRegistry),o=(f.utilsDom,g.ScalesFactory),p=function(a,b){var c=b.guide||{},d={x:["label"],y:["label"],size:["label"],color:["label"],padding:[]};return l.each(d,function(b,d){h(c,a,d,b)}),l.extend(a.guide,l.omit.apply(l,[c].concat(l.keys(d)))),a},q=function(a,b,c){return a[b]=l.defaults(a[b]||{},{label:""}),a[b].label=l.isObject(a[b].label)?a[b].label:{text:a[b].label},a[b].label=l.defaults(a[b].label,c||{},{padding:32,rotate:0,textAnchor:"middle",cssClass:"label",dock:null}),a[b]},r=function(a,b,c){return a[b]=l.defaults(a[b],c||{},{padding:0,density:30,rotate:0,tickPeriod:null,tickFormat:null,autoScale:!0}),a[b].tickFormat=a[b].tickFormat||a[b].tickPeriod,a[b]},s=function(a){return a.options=a.options||{},a.guide=a.guide||{},a.guide.padding=l.defaults(a.guide.padding||{},{l:0,b:0,r:0,t:0}),a.guide.x=q(a.guide,"x"),a.guide.x=r(a.guide,"x",{cssClass:"x axis",scaleOrient:"bottom",textAnchor:"middle"}),a.guide.y=q(a.guide,"y",{rotate:-90}),a.guide.y=r(a.guide,"y",{cssClass:"y axis",scaleOrient:"left",textAnchor:"end"}),a.guide.size=q(a.guide,"size"),a.guide.color=q(a.guide,"color"),a},t=function(a,b){return a.guide=a.guide||{},a.guide.padding=a.guide.padding||{l:0,t:0,r:0,b:0},a.hasOwnProperty("units")||(a=l.defaults(a,b),a.guide=l.defaults(a.guide,m.clone(b.guide)),a.guide.x=l.defaults(a.guide.x,m.clone(b.guide.x)),a.guide.y=l.defaults(a.guide.y,m.clone(b.guide.y))),a},u=function(a){var b=a.units||[],c=!a.hasOwnProperty("units"),d=!b.some(function(a){return a.hasOwnProperty("units")});return{type:a.type,isLeaf:c,isLeafParent:!c&&d}},v=function(a,b,c,d){if(0===a.length)return{width:0,height:0};if(null===b){var e=c("TauChart Library");return e.width=.625*d,e}var f=l.max(a,function(a){return b(a).toString().length}),g=l.isNumber(f)?".00":"";return c(b(f)+g)},w=function(a,b){var c=a.dimType,d=a.scaleType,e="*",f=[c,d,e].join(":"),g=[c,d].join(":");return b[f]||b[g]||b[c]||null},x=function(a,b,c,d,e,f){var g=b.dimension(a.x),h=b.dimension(a.y),i="measure"===g.dimType,j="measure"===h.dimType,k=c.hasOwnProperty("xDensityPadding:"+g.dimType)?c["xDensityPadding:"+g.dimType]:c.xDensityPadding,l=c.hasOwnProperty("yDensityPadding:"+h.dimType)?c["yDensityPadding:"+h.dimType]:c.yDensityPadding,m=b.scaleMeta(a.x,a.guide.x),o=m.values,p=b.scaleMeta(a.y,a.guide.y),q=p.values;a.guide.x.tickFormat=a.guide.x.tickFormat||w(g,c.defaultFormats),a.guide.y.tickFormat=a.guide.y.tickFormat||w(h,c.defaultFormats),["day","week","month"].indexOf(a.guide.x.tickFormat)>=0&&(a.guide.x.tickFormat+="-short"),["day","week","month"].indexOf(a.guide.y.tickFormat)>=0&&(a.guide.y.tickFormat+="-short");var r=0===o.length,s=0===q.length,t=v(o,n.get(a.guide.x.tickFormat,a.guide.x.tickFormatNullAlias),c.getAxisTickLabelSize,c.xAxisTickLabelLimit),u=v(q,n.get(a.guide.y.tickFormat,a.guide.y.tickFormatNullAlias),c.getAxisTickLabelSize,c.yAxisTickLabelLimit),x=c.xAxisPadding,y=c.yAxisPadding,z=d?!i:!1,A=e?!j:!1;a.guide.x.padding=r?0:x,a.guide.y.padding=s?0:y,a.guide.x.rotate=z?90:0,a.guide.x.textAnchor=z?"start":a.guide.x.textAnchor,a.guide.y.rotate=A?-90:0,a.guide.y.textAnchor=A?"middle":a.guide.y.textAnchor;var B=r?0:c.xTickWidth,C=s?0:c.yTickWidth;a.guide.x.tickFormatWordWrapLimit=c.xAxisTickLabelLimit,a.guide.y.tickFormatWordWrapLimit=c.yAxisTickLabelLimit;var D=z?{w:t.height,h:t.width}:{h:t.height,w:t.width};if(t.width>c.xAxisTickLabelLimit){a.guide.x.tickFormatWordWrap=!0,a.guide.x.tickFormatWordWrapLines=c.xTickWordWrapLinesLimit;var E=Math.ceil(t.width/c.xAxisTickLabelLimit),F=Math.min(E,c.xTickWordWrapLinesLimit),G=F*t.height;z?(D.h=c.xAxisTickLabelLimit,D.w=G):(D.h=G,D.w=c.xAxisTickLabelLimit)}var H=A?{w:u.height,h:u.width}:{h:u.height,w:u.width};if(u.width>c.yAxisTickLabelLimit){a.guide.y.tickFormatWordWrap=!0,a.guide.y.tickFormatWordWrapLines=c.yTickWordWrapLinesLimit;var E=Math.ceil(u.width/c.yAxisTickLabelLimit),F=Math.min(E,c.yTickWordWrapLinesLimit),G=F*u.height;A?(H.w=G,H.h=c.yAxisTickLabelLimit):(H.w=c.yAxisTickLabelLimit,H.h=G)}var I=B+D.h,J=C+H.w,K=c.xFontLabelHeight,L=c.yFontLabelHeight,M=c.distToXAxisLabel,N=c.distToYAxisLabel;if(a.guide.x.density=D.w+2*k,a.guide.y.density=H.h+2*l,f){var O=(x-K)/2;a.guide.x.label.padding=0+K-M+O,a.guide.y.label.padding=0-N+O,a.guide.x.label.cssClass+=" inline",a.guide.x.label.dock="right",a.guide.x.label.textAnchor="end",a.guide.y.label.cssClass+=" inline",a.guide.y.label.dock="right",a.guide.y.label.textAnchor="end",a.guide.padding.b=x+I,a.guide.padding.l=y+J,a.guide.padding.b=a.guide.x.hide?0:a.guide.padding.b,a.guide.padding.l=a.guide.y.hide?0:a.guide.padding.l}else{a.guide.x.label.padding=K+(a.guide.x.label.text?I+M:0),a.guide.y.label.padding=-K+(a.guide.y.label.text?J+N:0);var P=a.guide.x.label.text?a.guide.x.label.padding+K:I,Q=a.guide.y.label.text?a.guide.y.label.padding+L:J;a.guide.padding.b=x+P-B,a.guide.padding.l=y+Q,a.guide.padding.b=a.guide.x.hide?0:a.guide.padding.b,a.guide.padding.l=a.guide.y.hide?0:a.guide.padding.l}return a.guide.x.tickFontHeight=t.height,a.guide.y.tickFontHeight=u.height,a.guide.x.$minimalDomain=o.length,a.guide.y.$minimalDomain=q.length,a.guide.x.$maxTickTextW=t.width,a.guide.x.$maxTickTextH=t.height,a.guide.y.$maxTickTextW=u.width,a.guide.y.$maxTickTextH=u.height,a},y={NONE:function(a,b,c){var d=m.clone(a);return z(m.clone(d.unit),d.unit,function(a,b){return b.guide.x.tickFontHeight=c.getAxisTickLabelSize("X").height,b.guide.y.tickFontHeight=c.getAxisTickLabelSize("Y").height,b.guide.x.tickFormatWordWrapLimit=c.xAxisTickLabelLimit,b.guide.y.tickFormatWordWrapLimit=c.yAxisTickLabelLimit,b}),d},"BUILD-LABELS":function(a,b){var c=m.clone(a),d=[],e=[],f=null,g=null;return m.traverseJSON(c.unit,"units",u,function(a,c){if(a.isLeaf)return c;!f&&c.x&&(f=c),!g&&c.y&&(g=c),c.guide=c.guide||{},c.guide.x=c.guide.x||{label:""},c.guide.y=c.guide.y||{label:""},c.guide.x.label=l.isObject(c.guide.x.label)?c.guide.x.label:{text:c.guide.x.label},c.guide.y.label=l.isObject(c.guide.y.label)?c.guide.y.label:{text:c.guide.y.label},c.x&&(c.guide.x.label.text=c.guide.x.label.text||b.dimension(c.x).dimName),c.y&&(c.guide.y.label.text=c.guide.y.label.text||b.dimension(c.y).dimName);var h=c.guide.x.label.text;h&&(d.push(h),c.guide.x.tickFormatNullAlias=c.guide.x.hasOwnProperty("tickFormatNullAlias")?c.guide.x.tickFormatNullAlias:"No "+h,c.guide.x.label.text="");var i=c.guide.y.label.text;return i&&(e.push(i),c.guide.y.tickFormatNullAlias=c.guide.y.hasOwnProperty("tickFormatNullAlias")?c.guide.y.tickFormatNullAlias:"No "+i,c.guide.y.label.text=""),c}),f&&(f.guide.x.label.text=d.join(" > ")),g&&(g.guide.y.label.text=e.join(" > ")),c},"BUILD-GUIDE":function(a,b,c){var d=m.clone(a);return z(m.clone(d.unit),d.unit,function(a,d){if(a.isLeaf)return d;d.guide.hasOwnProperty("showGridLines")||(d.guide.showGridLines=a.isLeafParent?"xy":"");var e=!a.isLeaf&&!a.isLeafParent;e&&(d.guide.x.cssClass+=" facet-axis",d.guide.y.cssClass+=" facet-axis");var f=b.dimension(d.x),g=b.dimension(d.y),h="measure"===f.dimType,i="measure"===g.dimType,j=c.hasOwnProperty("xDensityPadding:"+f.dimType)?c["xDensityPadding:"+f.dimType]:c.xDensityPadding,k=c.hasOwnProperty("yDensityPadding:"+g.dimType)?c["yDensityPadding:"+g.dimType]:c.yDensityPadding,l=b.scaleMeta(d.x,d.guide.x),m=l.values,o=b.scaleMeta(d.y,d.guide.y),p=o.values;d.guide.x.tickFormat=d.guide.x.tickFormat||w(f,c.defaultFormats),d.guide.y.tickFormat=d.guide.y.tickFormat||w(g,c.defaultFormats);var q=0===m.length,r=0===p.length,s=v(m,n.get(d.guide.x.tickFormat,d.guide.x.tickFormatNullAlias),c.getAxisTickLabelSize,c.xAxisTickLabelLimit),t=v(p,n.get(d.guide.y.tickFormat,d.guide.y.tickFormatNullAlias),c.getAxisTickLabelSize,c.yAxisTickLabelLimit),u=a.isLeafParent?c.xAxisPadding:0,x=a.isLeafParent?c.yAxisPadding:0,y=!e&&Boolean(f.dimType)&&"measure"!==f.dimType;d.guide.x.padding=q?0:u,d.guide.y.padding=r?0:x,d.guide.x.rotate=y?90:0,d.guide.x.textAnchor=y?"start":d.guide.x.textAnchor;var z=q?0:c.xTickWidth,A=r?0:c.yTickWidth;d.guide.x.tickFormatWordWrapLimit=c.xAxisTickLabelLimit,d.guide.y.tickFormatWordWrapLimit=c.yAxisTickLabelLimit;var B=y?s.width:s.height;!h&&B>c.xAxisTickLabelLimit&&(B=c.xAxisTickLabelLimit),!y&&s.width>c.xAxisTickLabelLimit&&(d.guide.x.tickFormatWordWrap=!0,d.guide.x.tickFormatWordWrapLines=c.xTickWordWrapLinesLimit,B=c.xTickWordWrapLinesLimit*s.height);var C=t.width;!i&&C>c.yAxisTickLabelLimit&&(C=c.yAxisTickLabelLimit,d.guide.y.tickFormatWordWrap=!0,d.guide.y.tickFormatWordWrapLines=c.yTickWordWrapLinesLimit);var D=z+B,E=A+C,F=c.xFontLabelHeight,G=c.yFontLabelHeight,H=c.distToXAxisLabel,I=c.distToYAxisLabel,J=Math.min(c.xAxisTickLabelLimit,y?s.height:s.width);d.guide.x.density=J+2*j;var K=Math.ceil(t.width/c.yAxisTickLabelLimit),L=Math.min(K,c.yTickWordWrapLinesLimit),M=Math.min(c.yAxisTickLabelLimit,L*t.height);d.guide.y.density=M+2*k,d.guide.x.label.padding=d.guide.x.label.text?D+H:0,d.guide.y.label.padding=d.guide.y.label.text?E+I:0;var N=d.guide.x.label.text?d.guide.x.label.padding+F:D,O=d.guide.y.label.text?d.guide.y.label.padding+G:E;return d.guide.padding.b=u+N,d.guide.padding.l=x+O,d.guide.padding.b=d.guide.x.hide?0:d.guide.padding.b,d.guide.padding.l=d.guide.y.hide?0:d.guide.padding.l,d.guide.x.tickFontHeight=s.height,d.guide.y.tickFontHeight=t.height,d.guide.x.$minimalDomain=m.length,d.guide.y.$minimalDomain=p.length,d.guide.x.$maxTickTextW=s.width,d.guide.x.$maxTickTextH=s.height,d.guide.y.$maxTickTextW=t.width,d.guide.y.$maxTickTextH=t.height,d}),d},"BUILD-COMPACT":function(a,b,c){var d=m.clone(a);return z(m.clone(d.unit),d.unit,function(a,d){return a.isLeaf?d:(d.guide.hasOwnProperty("showGridLines")||(d.guide.showGridLines=a.isLeafParent?"xy":""),a.isLeafParent?x(d,b,l.defaults({xTickWordWrapLinesLimit:1,yTickWordWrapLinesLimit:1},c),!0,!1,!0):(d.guide.x.cssClass+=" facet-axis compact",d.guide.y.cssClass+=" facet-axis compact",x(d,b,l.defaults({xAxisPadding:0,yAxisPadding:0,distToXAxisLabel:0,distToYAxisLabel:0,xTickWordWrapLinesLimit:1,yTickWordWrapLinesLimit:1},c),!1,!0,!1)))}),d}};y.AUTO=function(a,b,c){return["BUILD-LABELS","BUILD-GUIDE"].reduce(function(a,d){return y[d](a,b,c)},a)},y.COMPACT=function(a,b,c){return["BUILD-LABELS","BUILD-COMPACT"].reduce(function(a,d){return y[d](a,b,c)},a)};{var z=function(a,b,c){var d=s(b);d=c(u(d),d),d=p(d,a);var e=l.omit(d,"units");return(d.units||[]).forEach(function(a){return z(m.clone(a),t(a,e),c)}),d},A={get:function(a,b,c,d){var e=y[a]||y.NONE,f={dimension:function(a){var b=c.scales[a],d=c.sources[b.source].dims[b.dim]||{};return{dimName:b.dim,dimType:d.type,scaleType:b.type}},scaleMeta:function(a){var b=d("pos",a);return{values:b.domain()}}},g={unit:m.clone(c.unit)},h=e(g,f,b);return c.unit=h.unit,c}};a.SpecTransformAutoLayout=function(){function a(b){k(this,a),this.spec=b,this.scalesCreator=new o(b.sources)}return j(a,{transform:{value:function(){var a=this,b=this.spec,c=b.settings.size,d=l.find(b.settings.specEngine,function(a){return c.width<=a.width}),e=A.get(d.name,b.settings,b,function(c,d){var e=d?d:""+c+":default";return a.scalesCreator.create(b.scales[e],null,[0,100])});return e}}}),a}()}}),e("spec-transform-calc-size",["exports","./scales-factory"],function(a,b){var c=function(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)},d=function(){function a(a,b){for(var c in b){var d=b[c];d.configurable=!0,d.value&&(d.writable=!0)}Object.defineProperties(a,b)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),e=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(a,"__esModule",{value:!0});{var f=b.ScalesFactory;a.SpecTransformCalcSize=function(){function a(b){e(this,a),this.spec=b}return d(a,{transform:{value:function(){var a=this.spec,b=a.settings.fitModel;if(!b)return a;var d=a.scales,e=new f(a.sources),g=function(a,b){return a.reduce(function(a,c){var d=c.key||{},e=d[b];return a[e]=a[e]||[],a[e].push(c),a},{})},h=function(a,b){var c=0;if(["ordinal","period"].indexOf(a.scaleType)>=0){var d=a.domain();c=b*d.length}else c=4*b;return c},i=function(a,b){var f=void 0===arguments[2]?null:arguments[2],j="x"===a?d[b.x]:d[b.y],k="x"===a?d[b.y]:d[b.x],l=b.guide,m="x"===a?Math.max(l.x.density,l.x.$maxTickTextW):l.y.density,n="x"===a?l.padding.l+l.padding.r:l.padding.b+l.padding.t;if("COORDS.RECT"!==b.units[0].type){var o=e.create(j,f,[0,100]);return n+h(o,m)}var p=g(b.frames,k.dim),q=Object.keys(p).map(function(b){return p[b].map(function(b){return i(a,b.units[0],b)}).reduce(function(a,b){return a+b},0)}),r=Math.max.apply(Math,c(q));return n+r},j=a.settings.size,k=j.width,l=j.height;"entire-view"===b?(k=j.width,l=j.height):"minimal"===b?(k=i("x",a.unit),l=i("y",a.unit)):"normal"===b?(k=Math.max(j.width,i("x",a.unit)),l=Math.max(j.height,i("y",a.unit))):"fit-width"===b?(k=j.width,l=i("y",a.unit)):"fit-height"===b&&(k=i("x",a.unit),l=j.height);var m=function(b,c){var d=a.settings.getScrollBarWidth(),e=c.width,f=c.height,g=b.width-e,h=b.height-f,i=h>=0?0:d,j=g>=0?0:d;return{height:f-j,width:e-i}};return a.settings.size=m(j,{width:k,height:l}),a}}}),a}()}}),e("spec-transform-apply-ratio",["exports","underscore","./utils/utils"],function(a,b,c){var d=function(a){return a&&a.__esModule?a["default"]:a},e=function(){function a(a,b){for(var c in b){var d=b[c];d.configurable=!0,d.value&&(d.writable=!0)}Object.defineProperties(a,b)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(a,"__esModule",{value:!0});{var g=(d(b),c.utils);a.SpecTransformApplyRatio=function(){function a(b){f(this,a),this.spec=b}return e(a,{transform:{value:function(a){var b=this.spec;try{this.ruleApplyRatio(b,a)}catch(c){if("Not applicable"!==c.message)throw c}return b}},ruleApplyRatio:{value:function(a,b){var c=function(a){return"COORDS.RECT"===a.type||"RECT"===a.type},d=function(a){return 0===a.type.indexOf("ELEMENT.")},e=function(a,b,c){var d=void 0===arguments[3]?0:arguments[3],f=b(a,d);f&&(a.units||[]).map(function(a){return e(a,b,c,d+1)}),c(a,d)},f=[],h=[],i=function(a,b){if(b>1||!c(a))throw new Error("Not applicable");f.push(a.x),h.push(a.y);var e=a.units||[],g=e.map(function(a){if(!c(a)&&!d(a))throw new Error("Not applicable");return a}).filter(c);return 1===g.length};e(a.unit,i,function(){return 0});var j=function(b){return a.scales[b]},k=function(a){return"/"===a.source&&!a.ratio&&!a.fitToFrame},l=function(a){return"ordinal"===a.type},m=f.map(j).filter(k),n=h.map(j).filter(k),o=2;if(m.length*n.length!==o)throw new Error("Not applicable");m.filter(l).length===o&&(m.forEach(function(a){return a.fitToFrame=!0}),m[0].ratio=g.generateRatioFunction("x",m.map(function(a){return a.dim}),b)),n.filter(l).length===o&&(n.forEach(function(a){return a.fitToFrame=!0}),n[0].ratio=g.generateRatioFunction("y",n.map(function(a){return a.dim}),b))}}}),a}()}}),e("spec-transform-extract-axes",["exports","underscore","./utils/utils"],function(a,b,c){var d=function(a){return a&&a.__esModule?a["default"]:a},e=function(){function a(a,b){for(var c in b){var d=b[c];d.configurable=!0,d.value&&(d.writable=!0)}Object.defineProperties(a,b)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(a,"__esModule",{value:!0});d(b),c.utils,a.SpecTransformExtractAxes=function(){function a(b){f(this,a),this.spec=b}return e(a,{transform:{value:function(){var a=this.spec;try{this.ruleExtractAxes(a)}catch(b){if("Not applicable"!==b.message)throw b;console.log("[TauCharts]: can't extract axes for the given chart specification",a)}return a}},ruleExtractAxes:{value:function(a){var b=function(a){return"COORDS.RECT"===a.type||"RECT"===a.type},c=function(a){return 0===a.type.indexOf("ELEMENT.")},d=function(a,b,c){var e=void 0===arguments[3]?0:arguments[3],f=b(a,e);f&&(a.units||[]).map(function(a){return d(a,b,c,e+1)}),c(a,e)},e={l:0,r:10,t:10,b:0},f=[],g=function(a,d){if(d>1||!b(a))throw new Error("Not applicable");a.guide=a.guide||{};var g=a.guide,h=g.padding||{l:0,r:0,t:0,b:0};e.l+=h.l,e.r+=h.r,e.t+=h.t,e.b+=h.b,f.push({l:e.l,r:e.r,t:e.t,b:e.b});var i=a.units||[],j=i.map(function(a){if(!b(a)&&!c(a))throw new Error("Not applicable");return a}).filter(b);return 1===j.length},h=function(a){return a?10:0},i=function(a){var b=f.pop(),c=a.guide||{};c.x=c.x||{},c.x.padding=c.x.padding||0,c.y=c.y||{},c.y.padding=c.y.padding||0,c.padding={l:h(a.y),r:h(1),t:h(1),b:h(a.x)},c.autoLayout="extract-axes",c.x.padding+=e.b-b.b,c.y.padding+=e.l-b.l};d(a.unit,g,i),a.unit.guide.padding=e,a.unit.guide.autoLayout=""}}}),a}()}),e("spec-transform-optimize-guide",["exports"],function(a){var b=function(){function a(a,b){for(var c in b){var d=b[c];d.configurable=!0,d.value&&(d.writable=!0)}Object.defineProperties(a,b)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),c=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(a,"__esModule",{value:!0});{var d=function(a,b,c,e){var f=b.guide.x.$minimalDomain||1,g=b.guide.y.$minimalDomain||1,h=c.width/f,i=c.height/g,j=a(b.x),k=a(b.y),l=e.hasOwnProperty("xDensityPadding:"+j)?e["xDensityPadding:"+j]:e.xDensityPadding,m=e.hasOwnProperty("yDensityPadding:"+k)?e["yDensityPadding:"+k]:e.yDensityPadding;if(b.guide.x.hide!==!0&&0!==b.guide.x.rotate&&h>b.guide.x.$maxTickTextW+2*l){b.guide.x.rotate=0,b.guide.x.textAnchor="middle",b.guide.x.tickFormatWordWrapLimit=h;var n=Math.min(e.xAxisTickLabelLimit,b.guide.x.$maxTickTextW),o=0-n+b.guide.x.$maxTickTextH;b.guide.padding.b+=b.guide.padding.b>0?o:0,b.guide.x.label.padding>n+e.xAxisPadding&&(b.guide.x.label.padding+=o)}b.guide.y.hide!==!0&&0!==b.guide.y.rotate&&1===b.guide.y.tickFormatWordWrapLines&&i>b.guide.y.$maxTickTextW+2*m&&(b.guide.y.tickFormatWordWrapLimit=i-2*m);var p={width:h,height:i};(b.units||[]).filter(function(a){return"COORDS.RECT"===a.type}).forEach(function(b){return d(a,b,p,e)})};a.SpecTransformOptimizeGuide=function(){function a(b){c(this,a),this.spec=b}return b(a,{transform:{value:function(){var a=this.spec;return d(function(b){var c=a.scales[b].dim,d=a.scales[b].source,e=a.sources[d].dims;return(e[c]||{}).type},a.unit,{width:a.settings.size.width,height:a.settings.size.height},a.settings),a}}}),a}()}}),e("charts/tau.plot",["exports","../api/balloon","../event","../plugins","../utils/utils","../utils/utils-dom","../const","../units-registry","../data-processor","../utils/layuot-template","../spec-converter","../spec-transform-auto-layout","../spec-transform-calc-size","../spec-transform-apply-ratio","../spec-transform-extract-axes","../spec-transform-optimize-guide","./tau.gpl"],function(c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){var t=function(){function a(a,b){for(var c in b){var d=b[c];d.configurable=!0,d.value&&(d.writable=!0)}Object.defineProperties(a,b)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),u=function L(a,b,c){var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){var e=Object.getPrototypeOf(a);return null===e?void 0:L(e,b,c)}if("value"in d&&d.writable)return d.value;var f=d.get;return void 0===f?void 0:f.call(c)},v=function(a,b){
if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(a.__proto__=b)},w=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(c,"__esModule",{value:!0});{var x=d.Tooltip,y=e.Emitter,z=f.Plugins,A=(f.propagateDatumEvents,g.utils),B=h.utilsDom,C=(i.CSS_PREFIX,j.unitsRegistry,k.DataProcessor),D=l.getLayout,E=m.SpecConverter,F=n.SpecTransformAutoLayout,G=o.SpecTransformCalcSize,H=p.SpecTransformApplyRatio,I=q.SpecTransformExtractAxes,J=r.SpecTransformOptimizeGuide,K=s.GPL;c.Plot=function(c){function d(b){w(this,d),u(Object.getPrototypeOf(d.prototype),"constructor",this).call(this),this._nodes=[],this._liveSpec=null,this._svg=null,this._filtersStore={filters:{},tick:0},this._layout=D(),2===["sources","scales"].filter(function(a){return b.hasOwnProperty(a)}).length?(this.config=b,this.configGPL=b):(this.config=this.setupConfig(b),this.configGPL=new E(this.config).convert()),this.config.plugins=this.config.plugins||[],this.configGPL.settings=d.setupSettings(this.configGPL.settings),this.transformers=[this.configGPL.settings.autoRatio&&H,F].filter(function(a){return a}),this._originData=a.clone(this.configGPL.sources),this._plugins=new z(this.config.plugins,this)}return v(d,c),t(d,{setupConfig:{value:function(b){if(!b.spec||!b.spec.unit)throw new Error("Provide spec for plot");this.config=a.defaults(b,{spec:{},data:[],plugins:[],settings:{}}),this._emptyContainer=b.emptyContainer||"",this.config.settings.specEngine=b.specEngine||b.settings.specEngine,this.config.settings.layoutEngine=b.layoutEngine||b.settings.layoutEngine,this.config.settings=d.setupSettings(this.config.settings),this.config.spec.dimensions=d.setupMetaInfo(this.config.spec.dimensions,this.config.data);var c=this.config.settings.log;return this.config.settings.excludeNull&&this.addFilter({tag:"default",src:"/",predicate:C.excludeNullValues(this.config.spec.dimensions,function(a){return c([a,"point was excluded, because it has undefined values."],"WARN")})}),this.config}},getConfig:{value:function(a){return a?this.config:this.configGPL||this.config}},insertToRightSidebar:{value:function(a){return B.appendTo(a,this._layout.rightSidebar)}},insertToHeader:{value:function(a){return B.appendTo(a,this._layout.header)}},addBalloon:{value:function(a){return new x("",a||{})}},renderTo:{value:function(c,d){var e=this;this._svg=null,this._target=c,this._defaultSize=a.clone(d);var f=b.select(c).node();if(null===f)throw new Error("Target element not found");f.appendChild(this._layout.layout);var g=this._layout.content,h=a.clone(d)||{};h.width&&h.height||(g.style.display="none",h=a.defaults(h,B.getContainerSize(g.parentNode)),g.style.display="",h.height||(h.height=B.getContainerSize(this._layout.layout).height)),this.configGPL.settings.size=h;var i=A.clone(this.configGPL);if(i.sources=this.getData({isNew:!0}),i.settings=this.configGPL.settings,this.isEmptySources(i.sources))return void(g.innerHTML=this._emptyContainer);i=this.transformers.reduce(function(a,b){return new b(a).transform(e)},i),this._nodes=[],i.onUnitDraw=function(a){e._nodes.push(a),e.fire("unitdraw",a)},i.onUnitsStructureExpanded=function(a){[G,a.settings.optimizeGuideBySize&&J,"EXTRACT"===a.settings.layoutEngine&&I].filter(function(a){return a}).forEach(function(b){return new b(a).transform()}),e.fire(["units","structure","expanded"].join(""),a)},this._liveSpec=i,this.fire("specready",i),new K(i).renderTo(g,i.settings.size);var j=b.select(g).select("svg");this._svg=j.node(),this._layout.rightSidebar.style.maxHeight=""+i.settings.size.height+"px",this.fire("render",this._svg)}},getData:{value:function(){var b=this,c=void 0===arguments[0]?{}:arguments[0],d=function(d,e){var f=a(b._filtersStore.filters).chain().values().flatten().reject(function(b){return a.contains(c.excludeFilter,b.tag)||!e(b)}).pluck("predicate").value();return d.filter(function(a){return f.reduce(function(b,c){return b&&c(a)},!0)})};if(c.isNew){var e={};return e["?"]=this._originData["?"],Object.keys(this._originData).filter(function(a){return"?"!==a}).reduce(function(a,c){var e=b._originData[c];return a[c]={dims:e.dims,data:d(e.data,function(a){return a.src===c})},a},e)}return d(this.config.data,function(){return!0})}},isEmptySources:{value:function(a){return!Object.keys(a).filter(function(a){return"?"!==a}).filter(function(b){return a[b].data.length>0}).length}},setData:{value:function(b){this.config.data=b,this.configGPL.sources["/"].data=b,this._originData=a.clone(this.configGPL.sources),this.refresh()}},getSVG:{value:function(){return this._svg}},addFilter:{value:function(a){a.src=a.src||"/";var b=a.tag,c=this._filtersStore.filters[b]=this._filtersStore.filters[b]||[],d=this._filtersStore.tick++;return a.id=d,c.push(a),this.refresh(),d}},removeFilter:{value:function(b){var c=this;a.each(this._filtersStore.filters,function(d,e){c._filtersStore.filters[e]=a.reject(d,function(a){return a.id===b})}),this.refresh()}},refresh:{value:function(){this._target&&this.renderTo(this._target,this._defaultSize)}},resize:{value:function(){var a=void 0===arguments[0]?{}:arguments[0];this.renderTo(this._target,a)}},select:{value:function(a){return this._nodes.filter(a)}},traverseSpec:{value:function(a,b){var c=function(a,b,d){b(a,d),(a.units||[]).map(function(d){return c(d,b,a)})};c(a.unit,b,null)}},getSpec:{value:function(){return this._liveSpec}}},{setupMetaInfo:{value:function(a,b){var c=a?a:C.autoDetectDimTypes(b);return C.autoAssignScales(c)}},setupSettings:{value:function(b){var c=d.globalSettings,e={};Object.keys(c).forEach(function(b){e[b]=a.isFunction(c[b])?c[b]:A.clone(c[b])});var f=a.defaults(b||{},e);return A.isArray(f.specEngine)||(f.specEngine=[{width:Number.MAX_VALUE,name:f.specEngine}]),f}}}),d}(y)}}),e("charts/tau.chart",["exports","./tau.plot","../utils/utils","../data-processor"],function(b,c,d,e){function f(a,b,c){return b.reduce(function(b,d,e){var f=a[d];return f?b.status!=t.FAIL&&("measure"===f.type&&(b.countMeasureAxis++,b.indexMeasureAxis.push(e)),"measure"!==f.type&&1===b.countMeasureAxis?b.status=t.WARNING:b.countMeasureAxis>1&&(b.status=t.FAIL,b.messages.push('There is more than one measure dimension for "'+c+'" axis'))):(b.status=t.FAIL,b.messages.push(d?'"'+d+'" dimension is undefined for "'+c+'" axis':'"'+c+'" axis should be specified')),b},{status:t.SUCCESS,countMeasureAxis:0,indexMeasureAxis:[],messages:[],axis:c})}function g(b){var c=r(b.x),d=r(b.y),e=Math.max(c.length,d.length),g=r(b.guide,{});a.times(e-g.length,function(){return g.push({})}),g=g.slice(0,e);var h=f(b.dimensions,c,"x"),i=f(b.dimensions,d,"y");return c=u[h.status](c,h,g),d=u[i.status](d,i,g),a.extend({},b,{x:c,y:d,guide:g})}function h(b,c){for(var d=c.x,e=c.y,f=c.guide,g=Math.max(d.length,e.length),h={type:"COORDS.RECT",unit:[]},i=[].concat(d),j=[].concat(e),k=[].concat(f),l=g;l>0;l--){var m=i.pop(),n=j.pop(),o=k.pop()||{};l===g?(h.x=m,h.y=n,h.unit.push(s(b,{x:q(m),y:q(n),color:c.color,size:c.size,flip:c.flip,colorGuide:o.color,sizeGuide:o.size})),h.guide=a.defaults(o,{x:{label:m},y:{label:n}})):h={type:"COORDS.RECT",x:q(m),y:q(n),unit:[h],guide:a.defaults(o,{x:{label:m},y:{label:n}})}}return c.spec={dimensions:c.dimensions,unit:h},c}var i=function(a,b,c){return Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0})},j=function(){function a(a,b){for(var c in b){var d=b[c];d.configurable=!0,d.value&&(d.writable=!0)}Object.defineProperties(a,b)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),k=function x(a,b,c){var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){var e=Object.getPrototypeOf(a);return null===e?void 0:x(e,b,c)}if("value"in d&&d.writable)return d.value;var f=d.get;return void 0===f?void 0:f.call(c)},l=function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(a.__proto__=b)},m=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(b,"__esModule",{value:!0});var n=c.Plot,o=d.utils,p=e.DataProcessor,q=function(a){return a?a:null},r=function(a){var b=void 0===arguments[1]?null:arguments[1];return o.isArray(a)?0===a.length?[b]:a:[a]},s=function(a,b){return{type:a,x:b.x,y:b.y,color:b.color,guide:{color:b.colorGuide,size:b.sizeGuide},flip:b.flip,size:b.size}},t={SUCCESS:"SUCCESS",WARNING:"WARNING",FAIL:"FAIL"},u=function(){var b={};return i(b,t.SUCCESS,function(a){return a}),i(b,t.FAIL,function(a,b){throw new Error((b.messages||[]).join("\n")||"This configuration is not supported, See http://api.taucharts.com/basic/facet.html#easy-approach-for-creating-facet-chart")}),i(b,t.WARNING,function(b,c,d){var e=c.axis,f=c.indexMeasureAxis[0],g=b[f],h=a.without(b,g);h.push(g);var i=d[f][e]||{},j=d[d.length-1][e]||{};return d[d.length-1][e]=i,d[f][e]=j,h}),b}(),v={scatterplot:function(a){return h("ELEMENT.POINT",a)},line:function(b){var c=b.data,d=b.settings.log,e={none:function(){return null},horizontal:function(a){var b=o.isArray(a.x)?a.x:[a.x];return b[b.length-1]},vertical:function(a){var b=o.isArray(a.y)?a.y:[a.y];return b[b.length-1]},auto:function(a){var b,e=o.isArray(a.x)?a.x:[a.x],f=o.isArray(a.y)?a.y:[a.y],g=e[e.length-1],h=e.slice(0,e.length-1),i=f[f.length-1],j=f.slice(0,f.length-1),k=a.color,l=h.concat(j).concat([k]).filter(function(a){return null!==a}),m=-1,n=[[[g].concat(l),i],[[i].concat(l),g]],q=n.some(function(a,b){var e=a[0],f=a[1],g=p.isYFunctionOfX(c,e,[f]);return g.result?m=b:d(["Attempt to find a functional relation between",a[0]+" and "+a[1]+" is failed.","There are several "+g.error.keyY+" values (e.g. "+g.error.errY.join(",")+")","for ("+g.error.keyX+" = "+g.error.valX+")."].join(" ")),g.result});return q?b=n[m][0][0]:(d(["All attempts are failed.","Will orient line horizontally by default.","NOTE: the [scatterplot] chart is more convenient for that data."].join(" ")),b=g),b}},f=(b.lineOrientation||"auto").toLowerCase(),g=e.hasOwnProperty(f)?e[f]:e.auto,i=g(b);return null!==i&&(b.data=a(c).sortBy(i)),h("ELEMENT.LINE",b)},bar:function(a){return a.flip=!1,h("ELEMENT.INTERVAL",a)},horizontalBar:function(a){return a.flip=!0,h("ELEMENT.INTERVAL",a)}},w=function(b){function c(b){m(this,c);var d=v[b.type];if(!a.isFunction(d))throw new Error("Chart type "+b.type+" is not supported. Use one of "+a.keys(v).join(", ")+".");b=a.defaults(b,{autoResize:!0}),b.settings=n.setupSettings(b.settings),b.dimensions=n.setupMetaInfo(b.dimensions,b.data);var e=g(b);k(Object.getPrototypeOf(c.prototype),"constructor",this).call(this,d(e)),b.autoResize&&c.winAware.push(this)}return l(c,b),j(c,{destroy:{value:function(){var a=c.winAware.indexOf(this);-1!==a&&c.winAware.splice(a,1),k(Object.getPrototypeOf(c.prototype),"destroy",this).call(this)}}}),c}(n);w.resizeOnWindowEvent=function(){function a(){!c&&w.winAware.length&&(c=d(b))}function b(){c=0;for(var a,b=0,d=w.winAware.length;d>b;b++)a=w.winAware[b],a.resize()}var c,d=window.requestAnimationFrame||window.webkitRequestAnimationFrame||function(a){return setTimeout(a,17)};return a}(),w.winAware=[],window.addEventListener("resize",w.resizeOnWindowEvent),b.Chart=w}),e("utils/d3-decorators",["exports","../utils/utils-draw","underscore","d3"],function(a,b,c,d){var e=function(a){return a&&a.__esModule?a["default"]:a};Object.defineProperty(a,"__esModule",{value:!0});var f=b.utilsDraw,g=e(c),h=e(d),i=g.memoize(function(a){return a.node().getComputedTextLength()},function(a){return a.node().textContent.length}),j=function(a,b,c){c=c||i,a.each(function(){var a=h.select(this),d=a.text().split(/\s+/),e=!1,f=d.reduce(function(d,f,g){if(e)return d;var h=g>0?[d,f].join(" "):f,i=c(a.text(h));if(b>i)d=h;else{var j=Math.floor(b/i*h.length);d=h.substr(0,j-4)+"...",e=!0}return d},"");a.text(f)})},k=function(a,b,c,d,e,f){f=f||i;var g=function(a,b,c,d,e,f,g){var h=g*c+f;return a.append("tspan").attr("x",d).attr("y",e).attr("dy",h+"em").text(b)};a.each(function(){var a=h.select(this),i=a.text().split(/\s+/),j=1.1,k=a.attr("x"),l=a.attr("y"),m=parseFloat(a.attr("dy"));a.text(null);var n=g(a,null,j,k,l,m,0),o=!1,p=i.length-1,q=i.reduce(function(a,d,e){if(o)return a;var g=a.length===c||e===p,h=a[a.length-1],i=""!==h?h+" "+d:d,j=f(n.text(i)),k=j>b;if(k&&g){var l=Math.floor(b/j*i.length);a[a.length-1]=i.substr(0,l-4)+"...",o=!0}return k&&!g&&a.push(d),k||(a[a.length-1]=i),a},[""]).filter(function(a){return a.length>0});l=e?-1*(q.length-1)*Math.floor(.5*d):l,q.forEach(function(b,c){return g(a,b,j,k,l,m,c)}),n.remove()})},l=function(a,b,c){a.selectAll(".tick line").empty()||a.selectAll(".tick")[0].forEach(function(a){var d=h.select(a),e=d.data()[0],f=b(e),g=c?f:0,i=c?0:f;d.attr("transform","translate("+g+","+i+")");var j=.5*b.stepSize(e),k=c?"x":"y",l=c?j:-j;d.select("line").attr(k+"1",l).attr(k+"2",l)})},m=function(a){var b=a.selectAll(".tick")[0];if(!(b.length<2)){var c=parseFloat(b[0].attributes.transform.value.replace("translate(","")),d=parseFloat(b[1].attributes.transform.value.replace("translate(","")),e=d-c,f=0,g=-1,h=a.selectAll(".tick text")[0];if(h.forEach(function(a,b){var c=a.textContent||"",d=c.length;d>f&&(f=d,g=b)}),g>=0){var i=h[g].getBoundingClientRect();e-i.width<8&&a.classed({"graphical-report__d3-time-overflown":!0})}}},n=function(a,b,c){var d=a.selectAll(".tick line");if(!d.empty()){var e=-1;if(c)e=0;else{var g=b/d[0].length,h=g/2;e=-h}var i=a.select(".tick").node().cloneNode(!0);a.append(function(){return i}).attr("transform",f.translate(0,b-e))}},o=function(a,b,c){var d=c?1:-1,e=a.append("text").attr("transform",f.rotate(b.rotate)).attr("class",b.cssClass).attr("x",d*b.size*.5).attr("y",d*b.padding).style("text-anchor",b.textAnchor),g=" > ",h=b.text.split(g),i=h.length;if(h.forEach(function(a,b){e.append("tspan").attr("class","label-token label-token-"+b).text(a),i-1>b&&e.append("tspan").attr("class","label-token-delimiter label-token-delimiter-"+b).text(g)}),"right"===b.dock){var j=a.selectAll("path.domain").node().getBBox();e.attr("x",c?j.width:0)}else if("left"===b.dock){var j=a.selectAll("path.domain").node().getBBox();e.attr("x",c?0:-j.height)}},p=function(a,b,c){var d=b.rotate,e=a.selectAll(".tick text");if(e.attr("transform",f.rotate(d)).style("text-anchor",b.textAnchor),90===d){var g=parseFloat(e.attr("dy"))/2;e.attr("x",9).attr("y",0).attr("dy",""+g+"em")}b.tickFormatWordWrap?e.call(k,b.tickFormatWordWrapLimit,b.tickFormatWordWrapLines,b.$maxTickTextH,!c):e.call(j,b.tickFormatWordWrapLimit)};a.d3_decorator_wrap_tick_label=p,a.d3_decorator_prettify_axis_label=o,a.d3_decorator_fix_axis_bottom_line=n,a.d3_decorator_fix_horizontal_axis_ticks_overflow=m,a.d3_decorator_prettify_categorical_axis_ticks=l,a.wrapText=k,a.cutText=j}),e("elements/coords.cartesian",["exports","d3","underscore","../utils/utils-draw","../const","../formatter-registry","../utils/d3-decorators"],function(a,b,c,d,e,f,g){var h=function(a){return a&&a.__esModule?a["default"]:a},i=function(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)},j=function(){function a(a,b){for(var c in b){var d=b[c];d.configurable=!0,d.value&&(d.writable=!0)}Object.defineProperties(a,b)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),k=function w(a,b,c){var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){var e=Object.getPrototypeOf(a);return null===e?void 0:w(e,b,c)}if("value"in d&&d.writable)return d.value;var f=d.get;return void 0===f?void 0:f.call(c)},l=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(a,"__esModule",{value:!0});{var m=h(b),n=h(c),o=d.utilsDraw,p=e.CSS_PREFIX,q=f.FormatterRegistry,r=g.d3_decorator_wrap_tick_label,s=g.d3_decorator_prettify_axis_label,t=g.d3_decorator_fix_axis_bottom_line,u=g.d3_decorator_fix_horizontal_axis_ticks_overflow,v=g.d3_decorator_prettify_categorical_axis_ticks;a.Cartesian=function(){function a(b){l(this,a),k(Object.getPrototypeOf(a.prototype),"constructor",this).call(this),this.config=b,this.config.guide=n.defaults(this.config.guide||{},{showGridLines:"xy",padding:{l:50,r:0,t:0,b:50}}),this.config.guide.x=this.config.guide.x||{},this.config.guide.x=n.defaults(this.config.guide.x,{cssClass:"x axis",textAnchor:"middle",padding:10,hide:!1,scaleOrient:"bottom",rotate:0,density:20,label:{},tickFormatWordWrapLimit:100}),n.isString(this.config.guide.x.label)&&(this.config.guide.x.label={text:this.config.guide.x.label}),this.config.guide.x.label=n.defaults(this.config.guide.x.label,{text:"X",rotate:0,padding:40,textAnchor:"middle"}),this.config.guide.y=this.config.guide.y||{},this.config.guide.y=n.defaults(this.config.guide.y,{cssClass:"y axis",textAnchor:"start",padding:10,hide:!1,scaleOrient:"left",rotate:0,density:20,label:{},tickFormatWordWrapLimit:100}),n.isString(this.config.guide.y.label)&&(this.config.guide.y.label={text:this.config.guide.y.label}),this.config.guide.y.label=n.defaults(this.config.guide.y.label,{text:"Y",rotate:-90,padding:20,textAnchor:"middle"});var c=this.config,d=c.guide;if("extract-axes"===d.autoLayout){var e=c.options.containerHeight,f=e-(c.options.top+c.options.height);d.x.hide=Math.floor(f)>0,d.y.hide=Math.floor(c.options.left)>0}}return j(a,{drawLayout:{value:function(a){var b=this.config,c=b.options,d=b.guide.padding,e=c.width-(d.l+d.r),f=c.height-(d.t+d.b);return this.xScale=a("pos",b.x,[0,e]),this.yScale=a("pos",b.y,[f,0]),this.W=e,this.H=f,this}},drawFrames:{value:function(a,b){var c=n.extend({},this.config),d=c.options,e=c.guide.padding,f=d.left+e.l,g=d.top+e.t,h=this.W,i=this.H;c.x=this.xScale,c.y=this.yScale,c.x.scaleObj=this.xScale,c.y.scaleObj=this.yScale,c.x.guide=c.guide.x,c.y.guide=c.guide.y,c.x.guide.label.size=h,c.y.guide.label.size=i,d.container.attr("transform",o.translate(f,g));var j=c.x.getHash()+i,k=c.y.getHash()+h;c.x.guide.hide||this._fnDrawDimAxis(d.container,c.x,[0,i+c.guide.x.padding],h,""+d.frameId+"x",j),c.y.guide.hide||this._fnDrawDimAxis(d.container,c.y,[0-c.guide.y.padding,0],i,""+d.frameId+"y",k);var l=function(a,d,e){var f,g=e.hash();if(e.key){var j=e.key[c.x.dim],k=e.key[c.y.dim],l=c.x(j),n=c.y(k),o=c.x.stepSize(j),p=c.y.stepSize(k);f=function(a,b){return a.options={uid:g+b,frameId:g,container:d,containerWidth:h,containerHeight:i,left:l-o/2,top:n-p/2,width:o,height:p},a}}else f=function(a,b){return a.options={uid:g+b,frameId:g,container:d,containerWidth:h,containerHeight:i,left:0,top:0,width:h,height:i},a};var q=function(a){a.options.container=m.select(this),b(a,e)},r=d.selectAll(".layer_"+a).data(e.units.map(f),function(a){return a.options.uid+a.type});r.exit().remove(),r.each(q),r.enter().append("g").attr("class","layer_"+a).each(q)},q=function(a){l(d.frameId,m.select(this),a)},r=this._fnDrawGrid(d.container,c,i,h,d.frameId,j+k).selectAll(".parent-frame-"+d.frameId).data(a,function(a){return a.hash()});r.exit().remove(),r.each(q),r.enter().append("g").attr("class",function(a){return""+p+"cell cell parent-frame-"+d.frameId+" frame-"+a.hash()}).each(q)}},_fnDrawDimAxis:{value:function(a,b,c,d,e,f){var g=m.svg.axis().scale(b.scaleObj).orient(b.guide.scaleOrient),h=q.get(b.guide.tickFormat,b.guide.tickFormatNullAlias);null!==h&&(g.ticks(Math.round(d/b.guide.density)),g.tickFormat(h));var j=a.selectAll(".axis_"+e).data([f],function(a){return a});j.exit().remove(),j.enter().append("g").attr("class",b.guide.cssClass+" axis_"+e).attr("transform",o.translate.apply(o,i(c))).call(function(a){if(!a.empty()){g.call(this,a);var c="h"===o.getOrientation(b.guide.scaleOrient),d="ordinal"===b.scaleType||"period"===b.scaleType;d&&v(a,b,c),r(a,b.guide,c),s(a,b.guide.label,c),c&&"time"===b.scaleType&&u(a)}})}},_fnDrawGrid:{value:function(a,b,c,d,e,f){var g=a.selectAll(".grid_"+e).data([f],function(a){return a});return g.exit().remove(),g.enter().append("g").attr("class","grid grid_"+e).attr("transform",o.translate(0,0)).call(function(a){if(!a.empty()){var e=a,f=(b.guide.showGridLines||"").toLowerCase();if(f.length>0){var g=e.append("g").attr("class","grid-lines");if(f.indexOf("x")>-1){var h=b.x,i=m.svg.axis().scale(h.scaleObj).orient(h.guide.scaleOrient).tickSize(c),j=q.get(h.guide.tickFormat);null!==j&&(i.ticks(Math.round(d/h.guide.density)),i.tickFormat(j));var k=g.append("g").attr("class","grid-lines-x").call(i),l="h"===o.getOrientation(h.guide.scaleOrient),p="ordinal"===h.scaleType||"period"===h.scaleType;p&&v(k,h,l);var r=k.select("g.tick");if(r.node()&&"translate(0,0)"!==r.attr("transform")){var s=r.node().cloneNode(!0);g.node().appendChild(s),m.select(s).attr("class","border").attr("transform",o.translate(0,0)).select("line").attr("x1",0).attr("x2",0)}}if(f.indexOf("y")>-1){var u=b.y,w=m.svg.axis().scale(u.scaleObj).orient(u.guide.scaleOrient).tickSize(-d),j=q.get(u.guide.tickFormat);null!==j&&(w.ticks(Math.round(c/u.guide.density)),w.tickFormat(j));var x=g.append("g").attr("class","grid-lines-y").call(w),l="h"===o.getOrientation(u.guide.scaleOrient),p="ordinal"===u.scaleType||"period"===u.scaleType;p&&v(x,u,l);var y=["time","ordinal","period"],z=n.contains(y,u.scaleType);z&&t(x,c,"time"===u.scaleType)}g.selectAll("text").remove()}}}),g}}}),a}()}}),e("elements/element.pie",["exports","../const","../utils/css-class-map"],function(c,d,e){var f=function(){function a(a,b){for(var c in b){var d=b[c];d.configurable=!0,d.value&&(d.writable=!0)}Object.defineProperties(a,b)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(c,"__esModule",{value:!0});d.CSS_PREFIX,e.getLineClassesByWidth,e.getLineClassesByCount,c.Pie=function(){function c(b){g(this,c),this.config=b,this.config.guide=this.config.guide||{},this.config.guide=a.defaults(this.config.guide,{cssClass:""})}return f(c,{drawLayout:{value:function(a){var b=this.config;return this.proportionScale=a("value",b.proportion),this.labelScale=a("value",b.label),this.colorScale=a("color",b.color,{}),this}},drawFrames:{value:function(a){var c=this.config,d=c.options,e=this.proportionScale,f=this.labelScale,g=this.colorScale,h=d.width,i=d.height,j=i/2,k=a[0].take(),l=d.container.append("svg:svg").data([k]).attr("width",h).attr("height",i).append("svg:g").attr("transform","translate("+j+","+j+")"),m=b.layout.pie().value(function(a){return a[e.dim]}),n=b.svg.arc().outerRadius(j),o=l.selectAll(".slice").data(m).enter().append("g").attr("class","slice");o.append("path").attr("class",function(a){var b=a.data||{};return g(b[g.dim])}).attr("d",function(a){return n(a)}),o.append("text").attr("transform",function(a){return a.innerRadius=0,a.outerRadius=j,"translate("+n.centroid(a)+")"}).attr("text-anchor","middle").text(function(a){var b=a.data||{};return f(b[f.dim])})}}}),c}()}),e("scales/base",["exports","../utils/utils","underscore"],function(a,b,c){var d=function(a){return a&&a.__esModule?a["default"]:a},e=function(){function a(a,b){for(var c in b){var d=b[c];d.configurable=!0,d.value&&(d.writable=!0)}Object.defineProperties(a,b)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(a,"__esModule",{value:!0});{var g=b.utils,h=d(c),i=function(a){return"date"===a?function(a){return new Date(a).getTime()}:function(a){return a}},j=function(a,b){return g.generateHash([a,b].map(JSON.stringify).join(""))};a.BaseScale=function(){function a(b,c){f(this,a);var d=c.fitToFrame?b.part():b.full(),e=this.getVarSet(d,c);c.order&&(e=h.union(c.order,e)),this.vars=e,this.scaleConfig=c}return e(a,{toBaseScale:{value:function(a){var b=this,c=void 0===arguments[1]?null:arguments[1];return a.dim=this.scaleConfig.dim,a.scaleDim=this.scaleConfig.dim,a.source=this.scaleConfig.source,a.domain=function(){return b.vars},a.getHash=function(){return j(b.vars,c)},a}},getVarSet:{value:function(a,b){return h(a).chain().pluck(b.dim).uniq(i(b.dimType)).value()}}}),a}()}}),e("scales/color",["exports","./base","underscore","d3"],function(a,b,c,d){var e=function(a){return a&&a.__esModule?a["default"]:a},f=function(){function a(a,b){for(var c in b){var d=b[c];d.configurable=!0,d.value&&(d.writable=!0)}Object.defineProperties(a,b)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(a.__proto__=b)},h=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(a,"__esModule",{value:!0});{var i=b.BaseScale,j=e(c),k=e(d);a.ColorScale=function(a){function b(){h(this,b),null!=a&&a.apply(this,arguments)}return g(b,a),f(b,{create:{value:function(){var a,b=this.scaleConfig,c=this.vars,d=b.brewer,e=j.constant("color-default"),f=j.times(20,function(a){return"color20-"+(1+a)}),g=function(a,b){if(0===a.length||1===a.length&&null===a[0])return e;var c=a.map(function(a){return String(a).toString()});return k.scale.ordinal().range(b).domain(c)},h=function(a,b){var c=j.keys(a),d=j.values(a),e=k.scale.ordinal().range(d).domain(c);return function(c){return a.hasOwnProperty(c)?e(c):b(c)}},i=function(a){return function(b){return a(String(b).toString())}};if(d)if(j.isArray(d))a=i(g(c,d));else if(j.isFunction(d))a=function(a){return d(a,i(g(c,f)))};else{if(!j.isObject(d))throw new Error("This brewer is not supported");a=h(d,e)}else a=i(g(c,f));return a.scaleType="color",this.toBaseScale(a)}}}),b}(i)}}),e("scales/size",["exports","./base","underscore","d3"],function(a,b,c,d){var e=function(a){return a&&a.__esModule?a["default"]:a},f=function(){function a(a,b){for(var c in b){var d=b[c];d.configurable=!0,d.value&&(d.writable=!0)}Object.defineProperties(a,b)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(a.__proto__=b)},h=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(a,"__esModule",{value:!0});{var i=b.BaseScale,j=e(c);e(d),a.SizeScale=function(a){function b(){h(this,b),null!=a&&a.apply(this,arguments)}return g(b,a),f(b,{create:{value:function(){var a,b=void 0===arguments[0]?{}:arguments[0],c=this.scaleConfig,d=this.vars,e=b.min||c.min,f=b.max||c.max,g=b.mid||c.mid,h=function(a){return Math.sqrt(a)},i=j.filter(d,j.isFinite);if(0===i.length)a=function(){return g};else{var k=1,l=0,m=Math.min.apply(null,i),n=Math.max.apply(null,i),o=h(Math.max.apply(null,[Math.abs(m),Math.abs(n),n-m]));l=0>m?m:0,k=0===o?1:(f-e)/o,a=function(a){var b=null!==a?parseFloat(a):0;if(!j.isFinite(b))return f;var c=b-l;return e+h(c)*k}}return a.scaleType="size",this.toBaseScale(a,b)}}}),b}(i)}}),e("scales/ordinal",["exports","./base","underscore","d3"],function(a,b,c,d){var e=function(a){return a&&a.__esModule?a["default"]:a},f=function(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)},g=function(){function a(a,b){for(var c in b){var d=b[c];d.configurable=!0,d.value&&(d.writable=!0)}Object.defineProperties(a,b)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(a.__proto__=b)},i=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(a,"__esModule",{value:!0});{var j=b.BaseScale,k=(e(c),e(d));a.OrdinalScale=function(a){function b(){i(this,b),null!=a&&a.apply(this,arguments)}return h(b,a),g(b,{create:{value:function(a){var b=this.scaleConfig,c=this.vars,d=k.scale.ordinal().domain(c),e=d.rangePoints(a,1),g=Math.max.apply(Math,f(a)),h=function(a){var d=typeof b.ratio;return"function"===d?b.ratio(a,g,c):"object"===d?b.ratio[a]:1/c.length},i=function(a){var d;return d=b.ratio?g-c.slice(c.indexOf(a)+1).reduce(function(a,b){return a+g*h(b)},g*h(a)*.5):e(a)};return Object.keys(e).forEach(function(a){return i[a]=e[a]}),i.scaleType="ordinal",i.stepSize=function(a){return h(a)*g},this.toBaseScale(i,a)}}}),b}(j)}}),e("scales/period",["exports","./base","../unit-domain-period-generator","underscore","d3"],function(a,b,c,d,e){var f=function(a){return a&&a.__esModule?a["default"]:a},g=function(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)},h=function(){function a(a,b){for(var c in b){var d=b[c];d.configurable=!0,d.value&&(d.writable=!0)}Object.defineProperties(a,b)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=function p(a,b,c){var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){var e=Object.getPrototypeOf(a);return null===e?void 0:p(e,b,c)}if("value"in d&&d.writable)return d.value;var f=d.get;return void 0===f?void 0:f.call(c)},j=function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(a.__proto__=b)},k=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(a,"__esModule",{value:!0});{var l=b.BaseScale,m=c.UnitDomainPeriodGenerator,n=f(d),o=f(e);a.PeriodScale=function(a){function b(a,c){k(this,b),i(Object.getPrototypeOf(b.prototype),"constructor",this).call(this,a,c);var d=this.scaleConfig,e=this.vars,f=o.extent(e),g=n.isNull(d.min)||n.isUndefined(d.min)?f[0]:new Date(d.min).getTime(),h=n.isNull(d.max)||n.isUndefined(d.max)?f[1]:new Date(d.max).getTime(),j=[new Date(Math.min(g,f[0])),new Date(Math.max(h,f[1]))];this.vars=m.generate(j[0],j[1],d.period)}return j(b,a),h(b,{create:{value:function(a){var b=this.vars,c=o.scale.ordinal().domain(b),d=c.rangePoints(a,1),e=Math.max.apply(Math,g(a)),f=function(a){return d(new Date(a))};return Object.keys(d).forEach(function(a){return f[a]=d[a]}),f.scaleType="period",f.stepSize=function(){return e/b.length},this.toBaseScale(f,a)}}}),b}(l)}}),e("scales/time",["exports","./base","underscore","d3"],function(a,b,c,d){var e=function(a){return a&&a.__esModule?a["default"]:a},f=function(){function a(a,b){for(var c in b){var d=b[c];d.configurable=!0,d.value&&(d.writable=!0)}Object.defineProperties(a,b)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=function m(a,b,c){var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){var e=Object.getPrototypeOf(a);return null===e?void 0:m(e,b,c)}if("value"in d&&d.writable)return d.value;var f=d.get;return void 0===f?void 0:f.call(c)},h=function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(a.__proto__=b)},i=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(a,"__esModule",{value:!0});{var j=b.BaseScale,k=e(c),l=e(d);a.TimeScale=function(a){function b(a,c){i(this,b),g(Object.getPrototypeOf(b.prototype),"constructor",this).call(this,a,c);var d=this.scaleConfig,e=this.vars,f=l.extent(e).map(function(a){return new Date(a)}),h=k.isNull(d.min)||k.isUndefined(d.min)?f[0]:new Date(d.min).getTime(),j=k.isNull(d.max)||k.isUndefined(d.max)?f[1]:new Date(d.max).getTime();

this.vars=[new Date(Math.min(h,f[0])),new Date(Math.max(j,f[1]))]}return h(b,a),f(b,{create:{value:function(a){var b=this.vars,c=l.time.scale().domain(b),d=c.range(a),e=function(a){var c=b[0],e=b[1];return a>e&&(a=e),c>a&&(a=c),d(new Date(a))};return Object.keys(d).forEach(function(a){return e[a]=d[a]}),e.scaleType="time",this.toBaseScale(e,a)}}}),b}(j)}}),e("scales/linear",["exports","./base","../utils/utils","underscore","d3"],function(a,b,c,d,e){var f=function(a){return a&&a.__esModule?a["default"]:a},g=function(){function a(a,b){for(var c in b){var d=b[c];d.configurable=!0,d.value&&(d.writable=!0)}Object.defineProperties(a,b)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=function o(a,b,c){var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){var e=Object.getPrototypeOf(a);return null===e?void 0:o(e,b,c)}if("value"in d&&d.writable)return d.value;var f=d.get;return void 0===f?void 0:f.call(c)},i=function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(a.__proto__=b)},j=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(a,"__esModule",{value:!0});{var k=b.BaseScale,l=c.utils,m=f(d),n=f(e);a.LinearScale=function(a){function b(a,c){j(this,b),h(Object.getPrototypeOf(b.prototype),"constructor",this).call(this,a,c);var d=this.scaleConfig,e=this.vars,f=d.autoScale?l.autoScale(e):n.extent(e),g=m.isNumber(d.min)?d.min:f[0],i=m.isNumber(d.max)?d.max:f[1];this.vars=[Math.min(g,f[0]),Math.max(i,f[1])]}return i(b,a),g(b,{create:{value:function(a){var b=this.vars,c=n.scale.linear().domain(b),d=c.rangeRound(a,1),e=function(a){var c=b[0],e=b[1],f=a;return f>e&&(f=e),c>f&&(f=c),d(f)};return Object.keys(d).forEach(function(a){return e[a]=d[a]}),e.scaleType="linear",this.toBaseScale(e,a)}}}),b}(k)}}),e("scales/value",["exports","./base","underscore","d3"],function(a,b,c,d){var e=function(a){return a&&a.__esModule?a["default"]:a},f=function(){function a(a,b){for(var c in b){var d=b[c];d.configurable=!0,d.value&&(d.writable=!0)}Object.defineProperties(a,b)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(a.__proto__=b)},h=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")};Object.defineProperty(a,"__esModule",{value:!0});{var i=b.BaseScale;e(c),e(d),a.ValueScale=function(a){function b(){h(this,b),null!=a&&a.apply(this,arguments)}return g(b,a),f(b,{create:{value:function(){var a=function(a){return a};return a.scaleType="value",this.toBaseScale(a)}}}),b}(i)}}),e("tau.charts",["exports","./utils/utils-dom","./utils/utils","./charts/tau.gpl","./charts/tau.plot","./charts/tau.chart","./unit-domain-period-generator","./formatter-registry","./units-registry","./scales-registry","./elements/coords.cartesian","./elements/element.point","./elements/element.line","./elements/element.pie","./elements/element.interval","./scales/color","./scales/size","./scales/ordinal","./scales/period","./scales/time","./scales/linear","./scales/value"],function(c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){Object.defineProperty(c,"__esModule",{value:!0});var y=d.utilsDom,z=e.utils,A=f.GPL,B=g.Plot,C=h.Chart,D=i.UnitDomainPeriodGenerator,E=j.FormatterRegistry,F=k.unitsRegistry,G=l.scalesRegistry,H=m.Cartesian,I=n.Point,J=o.Line,K=p.Pie,L=q.Interval,M=r.ColorScale,N=s.SizeScale,O=t.OrdinalScale,P=u.PeriodScale,Q=v.TimeScale,R=w.LinearScale,S=x.ValueScale,T={},U={},V={UnitDomainPeriodGenerator:D},W={unitsRegistry:F,scalesRegistry:G,tickFormat:E,isChartElement:z.isChartElement,isLineElement:z.isLineElement,d3:b,_:a,tickPeriod:D,colorBrewers:{add:function(a,b){a in T||(T[a]=b)},get:function(a){return T[a]}},plugins:{add:function(a,b){if(a in U)throw new Error("Plugin is already registered.");U[a]=b},get:function(a){return U[a]||function(a){throw new Error(""+a+" plugin is not defined")}}},globalSettings:{log:function(a,b){b=b||"INFO",Array.isArray(a)||(a=[a]),console[b.toLowerCase()].apply(console,a)},excludeNull:!0,specEngine:[{name:"COMPACT",width:600},{name:"AUTO",width:Number.MAX_VALUE}],fitModel:"normal",optimizeGuideBySize:!0,layoutEngine:"EXTRACT",autoRatio:!0,getAxisTickLabelSize:a.memoize(y.getAxisTickLabelSize,function(a){return(a||"").length}),getScrollBarWidth:a.memoize(y.getScrollbarWidth),xAxisTickLabelLimit:100,yAxisTickLabelLimit:100,xTickWordWrapLinesLimit:2,yTickWordWrapLinesLimit:2,xTickWidth:9,yTickWidth:9,distToXAxisLabel:20,distToYAxisLabel:20,xAxisPadding:20,yAxisPadding:20,xFontLabelHeight:10,yFontLabelHeight:10,xDensityPadding:4,yDensityPadding:4,"xDensityPadding:measure":8,"yDensityPadding:measure":8,defaultFormats:{measure:"x-num-auto","measure:time":"x-time-auto"}}};B.globalSettings=W.globalSettings,W.unitsRegistry.reg("COORDS.RECT",H).reg("ELEMENT.POINT",I).reg("ELEMENT.LINE",J).reg("ELEMENT.INTERVAL",L).reg("RECT",H).reg("POINT",I).reg("INTERVAL",L).reg("LINE",J).reg("PIE",K),W.scalesRegistry.reg("color",M).reg("size",N).reg("ordinal",O).reg("period",P).reg("time",Q).reg("linear",R).reg("value",S),c.GPL=A,c.Plot=B,c.Chart=C,c.__api__=V,c.api=W}),e("underscore",function(){return a}),e("d3",function(){return b}),d("tau.charts")}),function(a){if("function"==typeof define&&define.amd)define(["tauCharts"],function(b){return a(b)});else if("object"==typeof module&&module.exports){var b=require("tauCharts");module.exports=a(b)}else a(this.tauCharts)}(function(a){var b={YlGn:{3:["#f7fcb9","#addd8e","#31a354"],4:["#ffffcc","#c2e699","#78c679","#238443"],5:["#ffffcc","#c2e699","#78c679","#31a354","#006837"],6:["#ffffcc","#d9f0a3","#addd8e","#78c679","#31a354","#006837"],7:["#ffffcc","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],8:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],9:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"]},YlGnBu:{3:["#edf8b1","#7fcdbb","#2c7fb8"],4:["#ffffcc","#a1dab4","#41b6c4","#225ea8"],5:["#ffffcc","#a1dab4","#41b6c4","#2c7fb8","#253494"],6:["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#2c7fb8","#253494"],7:["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],8:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],9:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"]},GnBu:{3:["#e0f3db","#a8ddb5","#43a2ca"],4:["#f0f9e8","#bae4bc","#7bccc4","#2b8cbe"],5:["#f0f9e8","#bae4bc","#7bccc4","#43a2ca","#0868ac"],6:["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#43a2ca","#0868ac"],7:["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],8:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],9:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"]},BuGn:{3:["#e5f5f9","#99d8c9","#2ca25f"],4:["#edf8fb","#b2e2e2","#66c2a4","#238b45"],5:["#edf8fb","#b2e2e2","#66c2a4","#2ca25f","#006d2c"],6:["#edf8fb","#ccece6","#99d8c9","#66c2a4","#2ca25f","#006d2c"],7:["#edf8fb","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],8:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],9:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"]},PuBuGn:{3:["#ece2f0","#a6bddb","#1c9099"],4:["#f6eff7","#bdc9e1","#67a9cf","#02818a"],5:["#f6eff7","#bdc9e1","#67a9cf","#1c9099","#016c59"],6:["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#1c9099","#016c59"],7:["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],8:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],9:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"]},PuBu:{3:["#ece7f2","#a6bddb","#2b8cbe"],4:["#f1eef6","#bdc9e1","#74a9cf","#0570b0"],5:["#f1eef6","#bdc9e1","#74a9cf","#2b8cbe","#045a8d"],6:["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#2b8cbe","#045a8d"],7:["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],8:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],9:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"]},BuPu:{3:["#e0ecf4","#9ebcda","#8856a7"],4:["#edf8fb","#b3cde3","#8c96c6","#88419d"],5:["#edf8fb","#b3cde3","#8c96c6","#8856a7","#810f7c"],6:["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8856a7","#810f7c"],7:["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],8:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],9:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"]},RdPu:{3:["#fde0dd","#fa9fb5","#c51b8a"],4:["#feebe2","#fbb4b9","#f768a1","#ae017e"],5:["#feebe2","#fbb4b9","#f768a1","#c51b8a","#7a0177"],6:["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#c51b8a","#7a0177"],7:["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],8:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],9:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"]},PuRd:{3:["#e7e1ef","#c994c7","#dd1c77"],4:["#f1eef6","#d7b5d8","#df65b0","#ce1256"],5:["#f1eef6","#d7b5d8","#df65b0","#dd1c77","#980043"],6:["#f1eef6","#d4b9da","#c994c7","#df65b0","#dd1c77","#980043"],7:["#f1eef6","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],8:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],9:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"]},OrRd:{3:["#fee8c8","#fdbb84","#e34a33"],4:["#fef0d9","#fdcc8a","#fc8d59","#d7301f"],5:["#fef0d9","#fdcc8a","#fc8d59","#e34a33","#b30000"],6:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#e34a33","#b30000"],7:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],8:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],9:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"]},YlOrRd:{3:["#ffeda0","#feb24c","#f03b20"],4:["#ffffb2","#fecc5c","#fd8d3c","#e31a1c"],5:["#ffffb2","#fecc5c","#fd8d3c","#f03b20","#bd0026"],6:["#ffffb2","#fed976","#feb24c","#fd8d3c","#f03b20","#bd0026"],7:["#ffffb2","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],8:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],9:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"]},YlOrBr:{3:["#fff7bc","#fec44f","#d95f0e"],4:["#ffffd4","#fed98e","#fe9929","#cc4c02"],5:["#ffffd4","#fed98e","#fe9929","#d95f0e","#993404"],6:["#ffffd4","#fee391","#fec44f","#fe9929","#d95f0e","#993404"],7:["#ffffd4","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],8:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],9:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"]},Purples:{3:["#efedf5","#bcbddc","#756bb1"],4:["#f2f0f7","#cbc9e2","#9e9ac8","#6a51a3"],5:["#f2f0f7","#cbc9e2","#9e9ac8","#756bb1","#54278f"],6:["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#756bb1","#54278f"],7:["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],8:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],9:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"]},Blues:{3:["#deebf7","#9ecae1","#3182bd"],4:["#eff3ff","#bdd7e7","#6baed6","#2171b5"],5:["#eff3ff","#bdd7e7","#6baed6","#3182bd","#08519c"],6:["#eff3ff","#c6dbef","#9ecae1","#6baed6","#3182bd","#08519c"],7:["#eff3ff","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],8:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],9:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"]},Greens:{3:["#e5f5e0","#a1d99b","#31a354"],4:["#edf8e9","#bae4b3","#74c476","#238b45"],5:["#edf8e9","#bae4b3","#74c476","#31a354","#006d2c"],6:["#edf8e9","#c7e9c0","#a1d99b","#74c476","#31a354","#006d2c"],7:["#edf8e9","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],8:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],9:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"]},Oranges:{3:["#fee6ce","#fdae6b","#e6550d"],4:["#feedde","#fdbe85","#fd8d3c","#d94701"],5:["#feedde","#fdbe85","#fd8d3c","#e6550d","#a63603"],6:["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#e6550d","#a63603"],7:["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],8:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],9:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"]},Reds:{3:["#fee0d2","#fc9272","#de2d26"],4:["#fee5d9","#fcae91","#fb6a4a","#cb181d"],5:["#fee5d9","#fcae91","#fb6a4a","#de2d26","#a50f15"],6:["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#de2d26","#a50f15"],7:["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],8:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],9:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"]},Greys:{3:["#f0f0f0","#bdbdbd","#636363"],4:["#f7f7f7","#cccccc","#969696","#525252"],5:["#f7f7f7","#cccccc","#969696","#636363","#252525"],6:["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#636363","#252525"],7:["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],8:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],9:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"]},PuOr:{3:["#f1a340","#f7f7f7","#998ec3"],4:["#e66101","#fdb863","#b2abd2","#5e3c99"],5:["#e66101","#fdb863","#f7f7f7","#b2abd2","#5e3c99"],6:["#b35806","#f1a340","#fee0b6","#d8daeb","#998ec3","#542788"],7:["#b35806","#f1a340","#fee0b6","#f7f7f7","#d8daeb","#998ec3","#542788"],8:["#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788"],9:["#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788"],10:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],11:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"]},BrBG:{3:["#d8b365","#f5f5f5","#5ab4ac"],4:["#a6611a","#dfc27d","#80cdc1","#018571"],5:["#a6611a","#dfc27d","#f5f5f5","#80cdc1","#018571"],6:["#8c510a","#d8b365","#f6e8c3","#c7eae5","#5ab4ac","#01665e"],7:["#8c510a","#d8b365","#f6e8c3","#f5f5f5","#c7eae5","#5ab4ac","#01665e"],8:["#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e"],9:["#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e"],10:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],11:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"]},PRGn:{3:["#af8dc3","#f7f7f7","#7fbf7b"],4:["#7b3294","#c2a5cf","#a6dba0","#008837"],5:["#7b3294","#c2a5cf","#f7f7f7","#a6dba0","#008837"],6:["#762a83","#af8dc3","#e7d4e8","#d9f0d3","#7fbf7b","#1b7837"],7:["#762a83","#af8dc3","#e7d4e8","#f7f7f7","#d9f0d3","#7fbf7b","#1b7837"],8:["#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837"],9:["#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837"],10:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],11:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"]},PiYG:{3:["#e9a3c9","#f7f7f7","#a1d76a"],4:["#d01c8b","#f1b6da","#b8e186","#4dac26"],5:["#d01c8b","#f1b6da","#f7f7f7","#b8e186","#4dac26"],6:["#c51b7d","#e9a3c9","#fde0ef","#e6f5d0","#a1d76a","#4d9221"],7:["#c51b7d","#e9a3c9","#fde0ef","#f7f7f7","#e6f5d0","#a1d76a","#4d9221"],8:["#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221"],9:["#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221"],10:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],11:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"]},RdBu:{3:["#ef8a62","#f7f7f7","#67a9cf"],4:["#ca0020","#f4a582","#92c5de","#0571b0"],5:["#ca0020","#f4a582","#f7f7f7","#92c5de","#0571b0"],6:["#b2182b","#ef8a62","#fddbc7","#d1e5f0","#67a9cf","#2166ac"],7:["#b2182b","#ef8a62","#fddbc7","#f7f7f7","#d1e5f0","#67a9cf","#2166ac"],8:["#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac"],9:["#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac"],10:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],11:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"]},RdGy:{3:["#ef8a62","#ffffff","#999999"],4:["#ca0020","#f4a582","#bababa","#404040"],5:["#ca0020","#f4a582","#ffffff","#bababa","#404040"],6:["#b2182b","#ef8a62","#fddbc7","#e0e0e0","#999999","#4d4d4d"],7:["#b2182b","#ef8a62","#fddbc7","#ffffff","#e0e0e0","#999999","#4d4d4d"],8:["#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d"],9:["#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d"],10:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],11:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"]},RdYlBu:{3:["#fc8d59","#ffffbf","#91bfdb"],4:["#d7191c","#fdae61","#abd9e9","#2c7bb6"],5:["#d7191c","#fdae61","#ffffbf","#abd9e9","#2c7bb6"],6:["#d73027","#fc8d59","#fee090","#e0f3f8","#91bfdb","#4575b4"],7:["#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4"],8:["#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4"],9:["#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4"],10:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],11:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"]},Spectral:{3:["#fc8d59","#ffffbf","#99d594"],4:["#d7191c","#fdae61","#abdda4","#2b83ba"],5:["#d7191c","#fdae61","#ffffbf","#abdda4","#2b83ba"],6:["#d53e4f","#fc8d59","#fee08b","#e6f598","#99d594","#3288bd"],7:["#d53e4f","#fc8d59","#fee08b","#ffffbf","#e6f598","#99d594","#3288bd"],8:["#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd"],9:["#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd"],10:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],11:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"]},RdYlGn:{3:["#fc8d59","#ffffbf","#91cf60"],4:["#d7191c","#fdae61","#a6d96a","#1a9641"],5:["#d7191c","#fdae61","#ffffbf","#a6d96a","#1a9641"],6:["#d73027","#fc8d59","#fee08b","#d9ef8b","#91cf60","#1a9850"],7:["#d73027","#fc8d59","#fee08b","#ffffbf","#d9ef8b","#91cf60","#1a9850"],8:["#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850"],9:["#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850"],10:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],11:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"]},Accent:{3:["#7fc97f","#beaed4","#fdc086"],4:["#7fc97f","#beaed4","#fdc086","#ffff99"],5:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0"],6:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f"],7:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17"],8:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"]},Dark2:{3:["#1b9e77","#d95f02","#7570b3"],4:["#1b9e77","#d95f02","#7570b3","#e7298a"],5:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e"],6:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02"],7:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d"],8:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"]},Paired:{3:["#a6cee3","#1f78b4","#b2df8a"],4:["#a6cee3","#1f78b4","#b2df8a","#33a02c"],5:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99"],6:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c"],7:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f"],8:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00"],9:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6"],10:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a"],11:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99"],12:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"]},Pastel1:{3:["#fbb4ae","#b3cde3","#ccebc5"],4:["#fbb4ae","#b3cde3","#ccebc5","#decbe4"],5:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6"],6:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc"],7:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd"],8:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec"],9:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},Pastel2:{3:["#b3e2cd","#fdcdac","#cbd5e8"],4:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4"],5:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9"],6:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae"],7:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc"],8:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"]},Set1:{3:["#e41a1c","#377eb8","#4daf4a"],4:["#e41a1c","#377eb8","#4daf4a","#984ea3"],5:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00"],6:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33"],7:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628"],8:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf"],9:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"]},Set2:{3:["#66c2a5","#fc8d62","#8da0cb"],4:["#66c2a5","#fc8d62","#8da0cb","#e78ac3"],5:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854"],6:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f"],7:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494"],8:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"]},Set3:{3:["#8dd3c7","#ffffb3","#bebada"],4:["#8dd3c7","#ffffb3","#bebada","#fb8072"],5:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3"],6:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462"],7:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69"],8:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5"],9:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9"],10:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd"],11:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5"],12:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"]}},c=function(a,c){return b[a][c].map(function(b,d){return a+" q"+d+"-"+c})};return a.api.colorBrewers.add("tauBrewer",c),c}),function(a,b){if("function"==typeof define&&define.amd)define(["tauCharts"],function(a){return b(a)});else if("object"==typeof module&&module.exports){{require("tauCharts")}module.exports=b(tauCharts)}else b(a.tauCharts)}(this,function(a){var b,c,d;return function(a){function e(a,b){return u.call(a,b)}function f(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=b&&b.split("/"),o=s.map,p=o&&o["*"]||{};if(a&&"."===a.charAt(0))if(b){for(a=a.split("/"),g=a.length-1,s.nodeIdCompat&&w.test(a[g])&&(a[g]=a[g].replace(w,"")),a=n.slice(0,n.length-1).concat(a),k=0;k<a.length;k+=1)if(m=a[k],"."===m)a.splice(k,1),k-=1;else if(".."===m){if(1===k&&(".."===a[2]||".."===a[0]))break;k>0&&(a.splice(k-1,2),k-=2)}a=a.join("/")}else 0===a.indexOf("./")&&(a=a.substring(2));if((n||p)&&o){for(c=a.split("/"),k=c.length;k>0;k-=1){if(d=c.slice(0,k).join("/"),n)for(l=n.length;l>0;l-=1)if(e=o[n.slice(0,l).join("/")],e&&(e=e[d])){f=e,h=k;break}if(f)break;!i&&p&&p[d]&&(i=p[d],j=k)}!f&&i&&(f=i,h=j),f&&(c.splice(0,h,f),a=c.join("/"))}return a}function g(b,c){return function(){var d=v.call(arguments,0);return"string"!=typeof d[0]&&1===d.length&&d.push(null),n.apply(a,d.concat([b,c]))}}function h(a){return function(b){return f(b,a)}}function i(a){return function(b){q[a]=b}}function j(b){if(e(r,b)){var c=r[b];delete r[b],t[b]=!0,m.apply(a,c)}if(!e(q,b)&&!e(t,b))throw new Error("No "+b);return q[b]}function k(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function l(a){return function(){return s&&s.config&&s.config[a]||{}}}var m,n,o,p,q={},r={},s={},t={},u=Object.prototype.hasOwnProperty,v=[].slice,w=/\.js$/;o=function(a,b){var c,d=k(a),e=d[0];return a=d[1],e&&(e=f(e,b),c=j(e)),e?a=c&&c.normalize?c.normalize(a,h(b)):f(a,b):(a=f(a,b),d=k(a),e=d[0],a=d[1],e&&(c=j(e))),{f:e?e+"!"+a:a,n:a,pr:e,p:c}},p={require:function(a){return g(a)},exports:function(a){var b=q[a];return"undefined"!=typeof b?b:q[a]={}},module:function(a){return{id:a,uri:"",exports:q[a],config:l(a)}}},m=function(b,c,d,f){var h,k,l,m,n,s,u=[],v=typeof d;if(f=f||b,"undefined"===v||"function"===v){for(c=!c.length&&d.length?["require","exports","module"]:c,n=0;n<c.length;n+=1)if(m=o(c[n],f),k=m.f,"require"===k)u[n]=p.require(b);else if("exports"===k)u[n]=p.exports(b),s=!0;else if("module"===k)h=u[n]=p.module(b);else if(e(q,k)||e(r,k)||e(t,k))u[n]=j(k);else{if(!m.p)throw new Error(b+" missing "+k);m.p.load(m.n,g(f,!0),i(k),{}),u[n]=q[k]}l=d?d.apply(q[b],u):void 0,b&&(h&&h.exports!==a&&h.exports!==q[b]?q[b]=h.exports:l===a&&s||(q[b]=l))}else b&&(q[b]=d)},b=c=n=function(b,c,d,e,f){if("string"==typeof b)return p[b]?p[b](c):j(o(b,c).f);if(!b.splice){if(s=b,s.deps&&n(s.deps,s.callback),!c)return;c.splice?(b=c,c=d,d=null):b=a}return c=c||function(){},"function"==typeof d&&(d=e,e=f),e?m(a,b,c,d):setTimeout(function(){m(a,b,c,d)},4),n},n.config=function(a){return n(a)},b._defined=q,d=function(a,b,c){if("string"!=typeof a)throw new Error("See almond README: incorrect module build, no module name");b.splice||(c=b,b=[]),e(q,a)||e(r,a)||(r[a]=[a,b,c])},d.amd={jQuery:!0}}(),d("../node_modules/almond/almond",function(){}),function(a){function b(a){this.ok=!1,"#"==a.charAt(0)&&(a=a.substr(1,6)),a=a.replace(/ /g,""),a=a.toLowerCase();var c={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var d in c)a==d&&(a=c[d]);for(var e=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}],f=0;f<e.length;f++){var g=e[f].re,h=e[f].process,i=g.exec(a);i&&(channels=h(i),this.r=channels[0],this.g=channels[1],this.b=channels[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var a=this.r.toString(16),b=this.g.toString(16),c=this.b.toString(16);return 1==a.length&&(a="0"+a),1==b.length&&(b="0"+b),1==c.length&&(c="0"+c),"#"+a+b+c},this.getHelpXML=function(){for(var a=new Array,d=0;d<e.length;d++)for(var f=e[d].example,g=0;g<f.length;g++)a[a.length]=f[g];for(var h in c)a[a.length]=h;var i=document.createElement("ul");i.setAttribute("id","rgbcolor-examples");for(var d=0;d<a.length;d++)try{var j=document.createElement("li"),k=new b(a[d]),l=document.createElement("div");l.style.cssText="margin: 3px; border: 1px solid black; background:"+k.toHex()+"; color:"+k.toHex(),l.appendChild(document.createTextNode("test"));var m=document.createTextNode(" "+a[d]+" -> "+k.toRGB()+" -> "+k.toHex());j.appendChild(l),j.appendChild(m),i.appendChild(j)}catch(n){}return i}}"undefined"!=typeof d&&d.amd?d("../bower_components/canvg/rgbcolor",[],function(){return b}):"undefined"!=typeof module&&module.exports&&(module.exports=b),
a.RGBColor=b}("undefined"!=typeof window?window:this),function(a){function b(a,b,d,f){var g=document.getElementById(a),h=g.naturalWidth,i=g.naturalHeight,j=document.getElementById(b);j.style.width=h+"px",j.style.height=i+"px",j.width=h,j.height=i;var k=j.getContext("2d");k.clearRect(0,0,h,i),k.drawImage(g,0,0),isNaN(d)||1>d||(f?c(b,0,0,h,i,d):e(b,0,0,h,i,d))}function c(a,b,c,d,e,i){if(!(isNaN(i)||1>i)){i|=0;var j,k=document.getElementById(a),l=k.getContext("2d");try{try{j=l.getImageData(b,c,d,e)}catch(m){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),j=l.getImageData(b,c,d,e)}catch(m){throw alert("Cannot access local image"),new Error("unable to access local image data: "+m)}}}catch(m){throw alert("Cannot access image"),new Error("unable to access image data: "+m)}var n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L=j.data,M=i+i+1,N=d-1,O=e-1,P=i+1,Q=P*(P+1)/2,R=new f,S=R;for(p=1;M>p;p++)if(S=S.next=new f,p==P)var T=S;S.next=R;var U=null,V=null;t=s=0;var W=g[i],X=h[i];for(o=0;e>o;o++){for(C=D=E=F=u=v=w=x=0,y=P*(G=L[s]),z=P*(H=L[s+1]),A=P*(I=L[s+2]),B=P*(J=L[s+3]),u+=Q*G,v+=Q*H,w+=Q*I,x+=Q*J,S=R,p=0;P>p;p++)S.r=G,S.g=H,S.b=I,S.a=J,S=S.next;for(p=1;P>p;p++)q=s+((p>N?N:p)<<2),u+=(S.r=G=L[q])*(K=P-p),v+=(S.g=H=L[q+1])*K,w+=(S.b=I=L[q+2])*K,x+=(S.a=J=L[q+3])*K,C+=G,D+=H,E+=I,F+=J,S=S.next;for(U=R,V=T,n=0;d>n;n++)L[s+3]=J=x*W>>X,0!=J?(J=255/J,L[s]=(u*W>>X)*J,L[s+1]=(v*W>>X)*J,L[s+2]=(w*W>>X)*J):L[s]=L[s+1]=L[s+2]=0,u-=y,v-=z,w-=A,x-=B,y-=U.r,z-=U.g,A-=U.b,B-=U.a,q=t+((q=n+i+1)<N?q:N)<<2,C+=U.r=L[q],D+=U.g=L[q+1],E+=U.b=L[q+2],F+=U.a=L[q+3],u+=C,v+=D,w+=E,x+=F,U=U.next,y+=G=V.r,z+=H=V.g,A+=I=V.b,B+=J=V.a,C-=G,D-=H,E-=I,F-=J,V=V.next,s+=4;t+=d}for(n=0;d>n;n++){for(D=E=F=C=v=w=x=u=0,s=n<<2,y=P*(G=L[s]),z=P*(H=L[s+1]),A=P*(I=L[s+2]),B=P*(J=L[s+3]),u+=Q*G,v+=Q*H,w+=Q*I,x+=Q*J,S=R,p=0;P>p;p++)S.r=G,S.g=H,S.b=I,S.a=J,S=S.next;for(r=d,p=1;i>=p;p++)s=r+n<<2,u+=(S.r=G=L[s])*(K=P-p),v+=(S.g=H=L[s+1])*K,w+=(S.b=I=L[s+2])*K,x+=(S.a=J=L[s+3])*K,C+=G,D+=H,E+=I,F+=J,S=S.next,O>p&&(r+=d);for(s=n,U=R,V=T,o=0;e>o;o++)q=s<<2,L[q+3]=J=x*W>>X,J>0?(J=255/J,L[q]=(u*W>>X)*J,L[q+1]=(v*W>>X)*J,L[q+2]=(w*W>>X)*J):L[q]=L[q+1]=L[q+2]=0,u-=y,v-=z,w-=A,x-=B,y-=U.r,z-=U.g,A-=U.b,B-=U.a,q=n+((q=o+P)<O?q:O)*d<<2,u+=C+=U.r=L[q],v+=D+=U.g=L[q+1],w+=E+=U.b=L[q+2],x+=F+=U.a=L[q+3],U=U.next,y+=G=V.r,z+=H=V.g,A+=I=V.b,B+=J=V.a,C-=G,D-=H,E-=I,F-=J,V=V.next,s+=d}l.putImageData(j,b,c)}}function e(a,b,c,d,e,i){if(!(isNaN(i)||1>i)){i|=0;var j,k=document.getElementById(a),l=k.getContext("2d");try{try{j=l.getImageData(b,c,d,e)}catch(m){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),j=l.getImageData(b,c,d,e)}catch(m){throw alert("Cannot access local image"),new Error("unable to access local image data: "+m)}}}catch(m){throw alert("Cannot access image"),new Error("unable to access image data: "+m)}var n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=j.data,I=i+i+1,J=d-1,K=e-1,L=i+1,M=L*(L+1)/2,N=new f,O=N;for(p=1;I>p;p++)if(O=O.next=new f,p==L)var P=O;O.next=N;var Q=null,R=null;t=s=0;var S=g[i],T=h[i];for(o=0;e>o;o++){for(A=B=C=u=v=w=0,x=L*(D=H[s]),y=L*(E=H[s+1]),z=L*(F=H[s+2]),u+=M*D,v+=M*E,w+=M*F,O=N,p=0;L>p;p++)O.r=D,O.g=E,O.b=F,O=O.next;for(p=1;L>p;p++)q=s+((p>J?J:p)<<2),u+=(O.r=D=H[q])*(G=L-p),v+=(O.g=E=H[q+1])*G,w+=(O.b=F=H[q+2])*G,A+=D,B+=E,C+=F,O=O.next;for(Q=N,R=P,n=0;d>n;n++)H[s]=u*S>>T,H[s+1]=v*S>>T,H[s+2]=w*S>>T,u-=x,v-=y,w-=z,x-=Q.r,y-=Q.g,z-=Q.b,q=t+((q=n+i+1)<J?q:J)<<2,A+=Q.r=H[q],B+=Q.g=H[q+1],C+=Q.b=H[q+2],u+=A,v+=B,w+=C,Q=Q.next,x+=D=R.r,y+=E=R.g,z+=F=R.b,A-=D,B-=E,C-=F,R=R.next,s+=4;t+=d}for(n=0;d>n;n++){for(B=C=A=v=w=u=0,s=n<<2,x=L*(D=H[s]),y=L*(E=H[s+1]),z=L*(F=H[s+2]),u+=M*D,v+=M*E,w+=M*F,O=N,p=0;L>p;p++)O.r=D,O.g=E,O.b=F,O=O.next;for(r=d,p=1;i>=p;p++)s=r+n<<2,u+=(O.r=D=H[s])*(G=L-p),v+=(O.g=E=H[s+1])*G,w+=(O.b=F=H[s+2])*G,A+=D,B+=E,C+=F,O=O.next,K>p&&(r+=d);for(s=n,Q=N,R=P,o=0;e>o;o++)q=s<<2,H[q]=u*S>>T,H[q+1]=v*S>>T,H[q+2]=w*S>>T,u-=x,v-=y,w-=z,x-=Q.r,y-=Q.g,z-=Q.b,q=n+((q=o+L)<K?q:K)*d<<2,u+=A+=Q.r=H[q],v+=B+=Q.g=H[q+1],w+=C+=Q.b=H[q+2],Q=Q.next,x+=D=R.r,y+=E=R.g,z+=F=R.b,A-=D,B-=E,C-=F,R=R.next,s+=d}l.putImageData(j,b,c)}}function f(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var g=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],h=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24],i={image:b,canvasRGBA:c,canvasRGB:e};"undefined"!=typeof d&&d.amd?d("../bower_components/canvg/StackBlur",[],function(){return i}):"undefined"!=typeof module&&module.exports&&(module.exports=i),a.stackBlur=i}("undefined"!=typeof window?window:this),function(a,b){"undefined"!=typeof d&&d.amd?d("../bower_components/canvg/canvg",["rgbcolor","stackblur"],b):"undefined"!=typeof module&&module.exports&&(module.exports=b(c("rgbcolor"),c("stackblur"))),a.canvg=b(a.RGBColor,a.stackBlur)}("undefined"!=typeof window?window:this,function(a,b){function c(a){var b=[0,0,0],c=function(c,d){var e=a.match(c);null!=e&&(b[d]+=e.length,a=a.replace(c," "))};return a=a.replace(/:not\(([^\)]*)\)/g,"     $1 "),a=a.replace(/{[^]*/gm," "),c(g,1),c(h,0),c(j,1),c(k,2),c(l,1),c(m,1),a=a.replace(/[\*\s\+>~]/g," "),a=a.replace(/[#\.]/g," "),c(n,2),b.join("")}function d(d){var f={opts:d};f.FRAMERATE=30,f.MAX_VIRTUAL_PIXELS=3e4,f.log=function(){},1==f.opts.log&&"undefined"!=typeof console&&(f.log=function(a){console.log(a)}),f.init=function(a){var b=0;f.UniqueId=function(){return b++,"canvg"+b},f.Definitions={},f.Styles={},f.StylesSpecificity={},f.Animations=[],f.Images=[],f.ctx=a,f.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(a,b){this.viewPorts.push({width:a,height:b})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){return this.Current().width},this.height=function(){return this.Current().height},this.ComputeSize=function(a){return null!=a&&"number"==typeof a?a:"x"==a?this.width():"y"==a?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},f.init(),f.ImagesLoaded=function(){for(var a=0;a<f.Images.length;a++)if(!f.Images[a].loaded)return!1;return!0},f.trim=function(a){return a.replace(/^\s+|\s+$/g,"")},f.compressSpaces=function(a){return a.replace(/[\s\r\t\n]+/gm," ")},f.ajax=function(a){var b;return b=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),b?(b.open("GET",a,!1),b.send(null),b.responseText):null},f.parseXml=function(a){if("undefined"!=typeof Windows&&"undefined"!=typeof Windows.Data&&"undefined"!=typeof Windows.Data.Xml){var b=new Windows.Data.Xml.Dom.XmlDocument,c=new Windows.Data.Xml.Dom.XmlLoadSettings;return c.prohibitDtd=!1,b.loadXml(a,c),b}if(window.DOMParser){var d=new DOMParser;return d.parseFromString(a,"text/xml")}a=a.replace(/<!DOCTYPE svg[^>]*>/,"");var b=new ActiveXObject("Microsoft.XMLDOM");return b.async="false",b.loadXML(a),b},f.Property=function(a,b){this.name=a,this.value=b},f.Property.prototype.getValue=function(){return this.value},f.Property.prototype.hasValue=function(){return null!=this.value&&""!==this.value},f.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var a=parseFloat(this.value);return(this.value+"").match(/%$/)&&(a/=100),a},f.Property.prototype.valueOrDefault=function(a){return this.hasValue()?this.value:a},f.Property.prototype.numValueOrDefault=function(a){return this.hasValue()?this.numValue():a},f.Property.prototype.addOpacity=function(b){var c=this.value;if(null!=b.value&&""!=b.value&&"string"==typeof this.value){var d=new a(this.value);d.ok&&(c="rgba("+d.r+", "+d.g+", "+d.b+", "+b.numValue()+")")}return new f.Property(this.name,c)},f.Property.prototype.getDefinition=function(){var a=this.value.match(/#([^\)'"]+)/);return a&&(a=a[1]),a||(a=this.value),f.Definitions[a]},f.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")},f.Property.prototype.getFillStyleDefinition=function(a,b){var c=this.getDefinition();if(null!=c&&c.createGradient)return c.createGradient(f.ctx,a,b);if(null!=c&&c.createPattern){if(c.getHrefAttribute().hasValue()){var d=c.attribute("patternTransform");c=c.getHrefAttribute().getDefinition(),d.hasValue()&&(c.attribute("patternTransform",!0).value=d.value)}return c.createPattern(f.ctx,a)}return null},f.Property.prototype.getDPI=function(){return 96},f.Property.prototype.getEM=function(a){var b=12,c=new f.Property("fontSize",f.Font.Parse(f.ctx.font).fontSize);return c.hasValue()&&(b=c.toPixels(a)),b},f.Property.prototype.getUnits=function(){var a=this.value+"";return a.replace(/[0-9\.\-]/g,"")},f.Property.prototype.toPixels=function(a,b){if(!this.hasValue())return 0;var c=this.value+"";if(c.match(/em$/))return this.numValue()*this.getEM(a);if(c.match(/ex$/))return this.numValue()*this.getEM(a)/2;if(c.match(/px$/))return this.numValue();if(c.match(/pt$/))return this.numValue()*this.getDPI(a)*(1/72);if(c.match(/pc$/))return 15*this.numValue();if(c.match(/cm$/))return this.numValue()*this.getDPI(a)/2.54;if(c.match(/mm$/))return this.numValue()*this.getDPI(a)/25.4;if(c.match(/in$/))return this.numValue()*this.getDPI(a);if(c.match(/%$/))return this.numValue()*f.ViewPort.ComputeSize(a);var d=this.numValue();return b&&1>d?d*f.ViewPort.ComputeSize(a):d},f.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var a=this.value+"";return a.match(/s$/)?1e3*this.numValue():(a.match(/ms$/),this.numValue())},f.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var a=this.value+"";return a.match(/deg$/)?this.numValue()*(Math.PI/180):a.match(/grad$/)?this.numValue()*(Math.PI/200):a.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)};var g={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};return f.Property.prototype.toTextBaseline=function(){return this.hasValue()?g[this.value]:null},f.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(a,b,c,d,e,g){var h=null!=g?this.Parse(g):this.CreateFont("","","","","",f.ctx.font);return{fontFamily:e||h.fontFamily,fontSize:d||h.fontSize,fontStyle:a||h.fontStyle,fontWeight:c||h.fontWeight,fontVariant:b||h.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var a=this;this.Parse=function(b){for(var c={},d=f.trim(f.compressSpaces(b||"")).split(" "),e={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},g="",h=0;h<d.length;h++)e.fontStyle||-1==a.Styles.indexOf(d[h])?e.fontVariant||-1==a.Variants.indexOf(d[h])?e.fontWeight||-1==a.Weights.indexOf(d[h])?e.fontSize?"inherit"!=d[h]&&(g+=d[h]):("inherit"!=d[h]&&(c.fontSize=d[h].split("/")[0]),e.fontStyle=e.fontVariant=e.fontWeight=e.fontSize=!0):("inherit"!=d[h]&&(c.fontWeight=d[h]),e.fontStyle=e.fontVariant=e.fontWeight=!0):("inherit"!=d[h]&&(c.fontVariant=d[h]),e.fontStyle=e.fontVariant=!0):("inherit"!=d[h]&&(c.fontStyle=d[h]),e.fontStyle=!0);return""!=g&&(c.fontFamily=g),c}},f.ToNumberArray=function(a){for(var b=f.trim(f.compressSpaces((a||"").replace(/,/g," "))).split(" "),c=0;c<b.length;c++)b[c]=parseFloat(b[c]);return b},f.Point=function(a,b){this.x=a,this.y=b},f.Point.prototype.angleTo=function(a){return Math.atan2(a.y-this.y,a.x-this.x)},f.Point.prototype.applyTransform=function(a){var b=this.x*a[0]+this.y*a[2]+a[4],c=this.x*a[1]+this.y*a[3]+a[5];this.x=b,this.y=c},f.CreatePoint=function(a){var b=f.ToNumberArray(a);return new f.Point(b[0],b[1])},f.CreatePath=function(a){for(var b=f.ToNumberArray(a),c=[],d=0;d<b.length;d+=2)c.push(new f.Point(b[d],b[d+1]));return c},f.BoundingBox=function(a,b,c,d){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=function(){return this.x1},this.y=function(){return this.y1},this.width=function(){return this.x2-this.x1},this.height=function(){return this.y2-this.y1},this.addPoint=function(a,b){null!=a&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=a,this.x2=a),a<this.x1&&(this.x1=a),a>this.x2&&(this.x2=a)),null!=b&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=b,this.y2=b),b<this.y1&&(this.y1=b),b>this.y2&&(this.y2=b))},this.addX=function(a){this.addPoint(a,null)},this.addY=function(a){this.addPoint(null,a)},this.addBoundingBox=function(a){this.addPoint(a.x1,a.y1),this.addPoint(a.x2,a.y2)},this.addQuadraticCurve=function(a,b,c,d,e,f){var g=a+2/3*(c-a),h=b+2/3*(d-b),i=g+1/3*(e-a),j=h+1/3*(f-b);this.addBezierCurve(a,b,g,i,h,j,e,f)},this.addBezierCurve=function(a,b,c,d,e,f,g,h){var j=[a,b],k=[c,d],l=[e,f],m=[g,h];for(this.addPoint(j[0],j[1]),this.addPoint(m[0],m[1]),i=0;i<=1;i++){var n=function(a){return Math.pow(1-a,3)*j[i]+3*Math.pow(1-a,2)*a*k[i]+3*(1-a)*Math.pow(a,2)*l[i]+Math.pow(a,3)*m[i]},o=6*j[i]-12*k[i]+6*l[i],p=-3*j[i]+9*k[i]-9*l[i]+3*m[i],q=3*k[i]-3*j[i];if(0!=p){var r=Math.pow(o,2)-4*q*p;if(!(0>r)){var s=(-o+Math.sqrt(r))/(2*p);s>0&&1>s&&(0==i&&this.addX(n(s)),1==i&&this.addY(n(s)));var t=(-o-Math.sqrt(r))/(2*p);t>0&&1>t&&(0==i&&this.addX(n(t)),1==i&&this.addY(n(t)))}}else{if(0==o)continue;var u=-q/o;u>0&&1>u&&(0==i&&this.addX(n(u)),1==i&&this.addY(n(u)))}}},this.isPointInBox=function(a,b){return this.x1<=a&&a<=this.x2&&this.y1<=b&&b<=this.y2},this.addPoint(a,b),this.addPoint(c,d)},f.Transform=function(a){var b=this;this.Type={},this.Type.translate=function(a){this.p=f.CreatePoint(a),this.apply=function(a){a.translate(this.p.x||0,this.p.y||0)},this.unapply=function(a){a.translate(-1*this.p.x||0,-1*this.p.y||0)},this.applyToPoint=function(a){a.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(a){var b=f.ToNumberArray(a);this.angle=new f.Property("angle",b[0]),this.cx=b[1]||0,this.cy=b[2]||0,this.apply=function(a){a.translate(this.cx,this.cy),a.rotate(this.angle.toRadians()),a.translate(-this.cx,-this.cy)},this.unapply=function(a){a.translate(this.cx,this.cy),a.rotate(-1*this.angle.toRadians()),a.translate(-this.cx,-this.cy)},this.applyToPoint=function(a){var b=this.angle.toRadians();a.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),a.applyTransform([Math.cos(b),Math.sin(b),-Math.sin(b),Math.cos(b),0,0]),a.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(a){this.p=f.CreatePoint(a),this.apply=function(a){a.scale(this.p.x||1,this.p.y||this.p.x||1)},this.unapply=function(a){a.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)},this.applyToPoint=function(a){a.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(a){this.m=f.ToNumberArray(a),this.apply=function(a){a.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},this.unapply=function(a){var b=this.m[0],c=this.m[2],d=this.m[4],e=this.m[1],f=this.m[3],g=this.m[5],h=0,i=0,j=1,k=1/(b*(f*j-g*i)-c*(e*j-g*h)+d*(e*i-f*h));a.transform(k*(f*j-g*i),k*(g*h-e*j),k*(d*i-c*j),k*(b*j-d*h),k*(c*g-d*f),k*(d*e-b*g))},this.applyToPoint=function(a){a.applyTransform(this.m)}},this.Type.SkewBase=function(a){this.base=b.Type.matrix,this.base(a),this.angle=new f.Property("angle",a)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(a){this.base=b.Type.SkewBase,this.base(a),this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(a){this.base=b.Type.SkewBase,this.base(a),this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.apply=function(a){for(var b=0;b<this.transforms.length;b++)this.transforms[b].apply(a)},this.unapply=function(a){for(var b=this.transforms.length-1;b>=0;b--)this.transforms[b].unapply(a)},this.applyToPoint=function(a){for(var b=0;b<this.transforms.length;b++)this.transforms[b].applyToPoint(a)};for(var c=f.trim(f.compressSpaces(a)).replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),d=0;d<c.length;d++){var e=f.trim(c[d].split("(")[0]),g=c[d].split("(")[1].replace(")",""),h=new this.Type[e](g);h.type=e,this.transforms.push(h)}},f.AspectRatio=function(a,b,c,d,e,g,h,i,j,k){b=f.compressSpaces(b),b=b.replace(/^defer\s/,"");var l=b.split(" ")[0]||"xMidYMid",m=b.split(" ")[1]||"meet",n=c/d,o=e/g,p=Math.min(n,o),q=Math.max(n,o);"meet"==m&&(d*=p,g*=p),"slice"==m&&(d*=q,g*=q),j=new f.Property("refX",j),k=new f.Property("refY",k),j.hasValue()&&k.hasValue()?a.translate(-p*j.toPixels("x"),-p*k.toPixels("y")):(l.match(/^xMid/)&&("meet"==m&&p==o||"slice"==m&&q==o)&&a.translate(c/2-d/2,0),l.match(/YMid$/)&&("meet"==m&&p==n||"slice"==m&&q==n)&&a.translate(0,e/2-g/2),l.match(/^xMax/)&&("meet"==m&&p==o||"slice"==m&&q==o)&&a.translate(c-d,0),l.match(/YMax$/)&&("meet"==m&&p==n||"slice"==m&&q==n)&&a.translate(0,e-g)),"none"==l?a.scale(n,o):"meet"==m?a.scale(p,p):"slice"==m&&a.scale(q,q),a.translate(null==h?0:-h,null==i?0:-i)},f.Element={},f.EmptyProperty=new f.Property("EMPTY",""),f.Element.ElementBase=function(a){if(this.attributes={},this.styles={},this.stylesSpecificity={},this.children=[],this.attribute=function(a,b){var c=this.attributes[a];return null!=c?c:(1==b&&(c=new f.Property(a,""),this.attributes[a]=c),c||f.EmptyProperty)},this.getHrefAttribute=function(){for(var a in this.attributes)if(a.match(/:href$/))return this.attributes[a];return f.EmptyProperty},this.style=function(a,b,c){var d=this.styles[a];if(null!=d)return d;var e=this.attribute(a);if(null!=e&&e.hasValue())return this.styles[a]=e,e;if(1!=c){var g=this.parent;if(null!=g){var h=g.style(a);if(null!=h&&h.hasValue())return h}}return 1==b&&(d=new f.Property(a,""),this.styles[a]=d),d||f.EmptyProperty},this.render=function(a){if("none"!=this.style("display").value&&"hidden"!=this.style("visibility").value){if(a.save(),this.attribute("mask").hasValue()){var b=this.attribute("mask").getDefinition();null!=b&&b.apply(a,this)}else if(this.style("filter").hasValue()){var c=this.style("filter").getDefinition();null!=c&&c.apply(a,this)}else this.setContext(a),this.renderChildren(a),this.clearContext(a);a.restore()}},this.setContext=function(){},this.clearContext=function(){},this.renderChildren=function(a){for(var b=0;b<this.children.length;b++)this.children[b].render(a)},this.addChild=function(a,b){var c=a;b&&(c=f.CreateElement(a)),c.parent=this,"title"!=c.type&&this.children.push(c)},null!=a&&1==a.nodeType){for(var b=0;b<a.attributes.length;b++){var c=a.attributes[b];this.attributes[c.nodeName]=new f.Property(c.nodeName,c.nodeValue)}for(var d in f.Styles)if(e(a,d)){var g=f.Styles[d],h=f.StylesSpecificity[d];if(null!=g)for(var i in g){var j=this.stylesSpecificity[i];"undefined"==typeof j&&(j="000"),h>j&&(this.styles[i]=g[i],this.stylesSpecificity[i]=h)}}if(this.attribute("style").hasValue())for(var g=this.attribute("style").value.split(";"),b=0;b<g.length;b++)if(""!=f.trim(g[b])){var k=g[b].split(":"),i=f.trim(k[0]),l=f.trim(k[1]);this.styles[i]=new f.Property(i,l)}this.attribute("id").hasValue()&&null==f.Definitions[this.attribute("id").value]&&(f.Definitions[this.attribute("id").value]=this);for(var b=0;b<a.childNodes.length;b++){var m=a.childNodes[b];if(1==m.nodeType&&this.addChild(m,!0),this.captureTextNodes&&(3==m.nodeType||4==m.nodeType)){var n=m.nodeValue||m.text||"";""!=f.trim(f.compressSpaces(n))&&this.addChild(new f.Element.tspan(m),!1)}}}},f.Element.RenderedElementBase=function(a){this.base=f.Element.ElementBase,this.base(a),this.setContext=function(a){if(this.style("fill").isUrlDefinition()){var b=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity"));null!=b&&(a.fillStyle=b)}else if(this.style("fill").hasValue()){var c=this.style("fill");"currentColor"==c.value&&(c.value=this.style("color").value),"inherit"!=c.value&&(a.fillStyle="none"==c.value?"rgba(0,0,0,0)":c.value)}if(this.style("fill-opacity").hasValue()){var c=new f.Property("fill",a.fillStyle);c=c.addOpacity(this.style("fill-opacity")),a.fillStyle=c.value}if(this.style("stroke").isUrlDefinition()){var b=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity"));null!=b&&(a.strokeStyle=b)}else if(this.style("stroke").hasValue()){var d=this.style("stroke");"currentColor"==d.value&&(d.value=this.style("color").value),"inherit"!=d.value&&(a.strokeStyle="none"==d.value?"rgba(0,0,0,0)":d.value)}if(this.style("stroke-opacity").hasValue()){var d=new f.Property("stroke",a.strokeStyle);d=d.addOpacity(this.style("stroke-opacity")),a.strokeStyle=d.value}if(this.style("stroke-width").hasValue()){var e=this.style("stroke-width").toPixels();a.lineWidth=0==e?.001:e}if(this.style("stroke-linecap").hasValue()&&(a.lineCap=this.style("stroke-linecap").value),this.style("stroke-linejoin").hasValue()&&(a.lineJoin=this.style("stroke-linejoin").value),this.style("stroke-miterlimit").hasValue()&&(a.miterLimit=this.style("stroke-miterlimit").value),this.style("stroke-dasharray").hasValue()&&"none"!=this.style("stroke-dasharray").value){var g=f.ToNumberArray(this.style("stroke-dasharray").value);"undefined"!=typeof a.setLineDash?a.setLineDash(g):"undefined"!=typeof a.webkitLineDash?a.webkitLineDash=g:"undefined"==typeof a.mozDash||1==g.length&&0==g[0]||(a.mozDash=g);var h=this.style("stroke-dashoffset").numValueOrDefault(1);"undefined"!=typeof a.lineDashOffset?a.lineDashOffset=h:"undefined"!=typeof a.webkitLineDashOffset?a.webkitLineDashOffset=h:"undefined"!=typeof a.mozDashOffset&&(a.mozDashOffset=h)}if("undefined"!=typeof a.font&&(a.font=f.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString()),this.attribute("transform").hasValue()){var i=new f.Transform(this.attribute("transform").value);i.apply(a)}if(this.style("clip-path",!1,!0).hasValue()){var j=this.style("clip-path",!1,!0).getDefinition();null!=j&&j.apply(a)}this.style("opacity").hasValue()&&(a.globalAlpha=this.style("opacity").numValue())}},f.Element.RenderedElementBase.prototype=new f.Element.ElementBase,f.Element.PathElementBase=function(a){this.base=f.Element.RenderedElementBase,this.base(a),this.path=function(a){return null!=a&&a.beginPath(),new f.BoundingBox},this.renderChildren=function(a){this.path(a),f.Mouse.checkPath(this,a),""!=a.fillStyle&&("inherit"!=this.style("fill-rule").valueOrDefault("inherit")?a.fill(this.style("fill-rule").value):a.fill()),""!=a.strokeStyle&&a.stroke();var b=this.getMarkers();if(null!=b){if(this.style("marker-start").isUrlDefinition()){var c=this.style("marker-start").getDefinition();c.render(a,b[0][0],b[0][1])}if(this.style("marker-mid").isUrlDefinition())for(var c=this.style("marker-mid").getDefinition(),d=1;d<b.length-1;d++)c.render(a,b[d][0],b[d][1]);if(this.style("marker-end").isUrlDefinition()){var c=this.style("marker-end").getDefinition();c.render(a,b[b.length-1][0],b[b.length-1][1])}}},this.getBoundingBox=function(){return this.path()},this.getMarkers=function(){return null}},f.Element.PathElementBase.prototype=new f.Element.RenderedElementBase,f.Element.svg=function(a){this.base=f.Element.RenderedElementBase,this.base(a),this.baseClearContext=this.clearContext,this.clearContext=function(a){this.baseClearContext(a),f.ViewPort.RemoveCurrent()},this.baseSetContext=this.setContext,this.setContext=function(a){a.strokeStyle="rgba(0,0,0,0)",a.lineCap="butt",a.lineJoin="miter",a.miterLimit=4,"undefined"!=typeof a.font&&"undefined"!=typeof window.getComputedStyle&&(a.font=window.getComputedStyle(a.canvas).getPropertyValue("font")),this.baseSetContext(a),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),a.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var b=f.ViewPort.width(),c=f.ViewPort.height();if(this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),"undefined"==typeof this.root){b=this.attribute("width").toPixels("x"),c=this.attribute("height").toPixels("y");var d=0,e=0;this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(d=-this.attribute("refX").toPixels("x"),e=-this.attribute("refY").toPixels("y")),"visible"!=this.attribute("overflow").valueOrDefault("hidden")&&(a.beginPath(),a.moveTo(d,e),a.lineTo(b,e),a.lineTo(b,c),a.lineTo(d,c),a.closePath(),a.clip())}if(f.ViewPort.SetCurrent(b,c),this.attribute("viewBox").hasValue()){var g=f.ToNumberArray(this.attribute("viewBox").value),h=g[0],i=g[1];b=g[2],c=g[3],f.AspectRatio(a,this.attribute("preserveAspectRatio").value,f.ViewPort.width(),b,f.ViewPort.height(),c,h,i,this.attribute("refX").value,this.attribute("refY").value),f.ViewPort.RemoveCurrent(),f.ViewPort.SetCurrent(g[2],g[3])}}},f.Element.svg.prototype=new f.Element.RenderedElementBase,f.Element.rect=function(a){this.base=f.Element.PathElementBase,this.base(a),this.path=function(a){var b=this.attribute("x").toPixels("x"),c=this.attribute("y").toPixels("y"),d=this.attribute("width").toPixels("x"),e=this.attribute("height").toPixels("y"),g=this.attribute("rx").toPixels("x"),h=this.attribute("ry").toPixels("y");return this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(h=g),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(g=h),g=Math.min(g,d/2),h=Math.min(h,e/2),null!=a&&(a.beginPath(),a.moveTo(b+g,c),a.lineTo(b+d-g,c),a.quadraticCurveTo(b+d,c,b+d,c+h),a.lineTo(b+d,c+e-h),a.quadraticCurveTo(b+d,c+e,b+d-g,c+e),a.lineTo(b+g,c+e),a.quadraticCurveTo(b,c+e,b,c+e-h),a.lineTo(b,c+h),a.quadraticCurveTo(b,c,b+g,c),a.closePath()),new f.BoundingBox(b,c,b+d,c+e)}},f.Element.rect.prototype=new f.Element.PathElementBase,f.Element.circle=function(a){this.base=f.Element.PathElementBase,this.base(a),this.path=function(a){var b=this.attribute("cx").toPixels("x"),c=this.attribute("cy").toPixels("y"),d=this.attribute("r").toPixels();return null!=a&&(a.beginPath(),a.arc(b,c,d,0,2*Math.PI,!0),a.closePath()),new f.BoundingBox(b-d,c-d,b+d,c+d)}},f.Element.circle.prototype=new f.Element.PathElementBase,f.Element.ellipse=function(a){this.base=f.Element.PathElementBase,this.base(a),this.path=function(a){var b=4*((Math.sqrt(2)-1)/3),c=this.attribute("rx").toPixels("x"),d=this.attribute("ry").toPixels("y"),e=this.attribute("cx").toPixels("x"),g=this.attribute("cy").toPixels("y");return null!=a&&(a.beginPath(),a.moveTo(e,g-d),a.bezierCurveTo(e+b*c,g-d,e+c,g-b*d,e+c,g),a.bezierCurveTo(e+c,g+b*d,e+b*c,g+d,e,g+d),a.bezierCurveTo(e-b*c,g+d,e-c,g+b*d,e-c,g),a.bezierCurveTo(e-c,g-b*d,e-b*c,g-d,e,g-d),a.closePath()),new f.BoundingBox(e-c,g-d,e+c,g+d)}},f.Element.ellipse.prototype=new f.Element.PathElementBase,f.Element.line=function(a){this.base=f.Element.PathElementBase,this.base(a),this.getPoints=function(){return[new f.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new f.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},this.path=function(a){var b=this.getPoints();return null!=a&&(a.beginPath(),a.moveTo(b[0].x,b[0].y),a.lineTo(b[1].x,b[1].y)),new f.BoundingBox(b[0].x,b[0].y,b[1].x,b[1].y)},this.getMarkers=function(){var a=this.getPoints(),b=a[0].angleTo(a[1]);return[[a[0],b],[a[1],b]]}},f.Element.line.prototype=new f.Element.PathElementBase,f.Element.polyline=function(a){this.base=f.Element.PathElementBase,this.base(a),this.points=f.CreatePath(this.attribute("points").value),this.path=function(a){var b=new f.BoundingBox(this.points[0].x,this.points[0].y);null!=a&&(a.beginPath(),a.moveTo(this.points[0].x,this.points[0].y));for(var c=1;c<this.points.length;c++)b.addPoint(this.points[c].x,this.points[c].y),null!=a&&a.lineTo(this.points[c].x,this.points[c].y);return b},this.getMarkers=function(){for(var a=[],b=0;b<this.points.length-1;b++)a.push([this.points[b],this.points[b].angleTo(this.points[b+1])]);return a.push([this.points[this.points.length-1],a[a.length-1][1]]),a}},f.Element.polyline.prototype=new f.Element.PathElementBase,f.Element.polygon=function(a){this.base=f.Element.polyline,this.base(a),this.basePath=this.path,this.path=function(a){var b=this.basePath(a);return null!=a&&(a.lineTo(this.points[0].x,this.points[0].y),a.closePath()),b}},f.Element.polygon.prototype=new f.Element.polyline,f.Element.path=function(a){this.base=f.Element.PathElementBase,this.base(a);var b=this.attribute("d").value;b=b.replace(/,/gm," "),b=b.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),b=b.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),b=b.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2"),b=b.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),b=b.replace(/([0-9])([+\-])/gm,"$1 $2"),b=b.replace(/(\.[0-9]*)(\.)/gm,"$1 $2"),b=b.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),b=f.compressSpaces(b),b=f.trim(b),this.PathParser=new function(a){this.tokens=a.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new f.Point(0,0),this.control=new f.Point(0,0),this.current=new f.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return this.isEnd()?!0:null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var a=new f.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(a)},this.getAsControlPoint=function(){var a=this.getPoint();return this.control=a,a},this.getAsCurrentPoint=function(){var a=this.getPoint();return this.current=a,a},this.getReflectedControlPoint=function(){if("c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase()&&"q"!=this.previousCommand.toLowerCase()&&"t"!=this.previousCommand.toLowerCase())return this.current;var a=new f.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y);

return a},this.makeAbsolute=function(a){return this.isRelativeCommand()&&(a.x+=this.current.x,a.y+=this.current.y),a},this.addMarker=function(a,b,c){null!=c&&this.angles.length>0&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(c)),this.addMarkerAngle(a,null==b?null:b.angleTo(a))},this.addMarkerAngle=function(a,b){this.points.push(a),this.angles.push(b)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var a=0;a<this.angles.length;a++)if(null==this.angles[a])for(var b=a+1;b<this.angles.length;b++)if(null!=this.angles[b]){this.angles[a]=this.angles[b];break}return this.angles}}(b),this.path=function(a){var b=this.PathParser;b.reset();var c=new f.BoundingBox;for(null!=a&&a.beginPath();!b.isEnd();)switch(b.nextCommand(),b.command){case"M":case"m":var d=b.getAsCurrentPoint();for(b.addMarker(d),c.addPoint(d.x,d.y),null!=a&&a.moveTo(d.x,d.y),b.start=b.current;!b.isCommandOrEnd();){var d=b.getAsCurrentPoint();b.addMarker(d,b.start),c.addPoint(d.x,d.y),null!=a&&a.lineTo(d.x,d.y)}break;case"L":case"l":for(;!b.isCommandOrEnd();){var e=b.current,d=b.getAsCurrentPoint();b.addMarker(d,e),c.addPoint(d.x,d.y),null!=a&&a.lineTo(d.x,d.y)}break;case"H":case"h":for(;!b.isCommandOrEnd();){var g=new f.Point((b.isRelativeCommand()?b.current.x:0)+b.getScalar(),b.current.y);b.addMarker(g,b.current),b.current=g,c.addPoint(b.current.x,b.current.y),null!=a&&a.lineTo(b.current.x,b.current.y)}break;case"V":case"v":for(;!b.isCommandOrEnd();){var g=new f.Point(b.current.x,(b.isRelativeCommand()?b.current.y:0)+b.getScalar());b.addMarker(g,b.current),b.current=g,c.addPoint(b.current.x,b.current.y),null!=a&&a.lineTo(b.current.x,b.current.y)}break;case"C":case"c":for(;!b.isCommandOrEnd();){var h=b.current,i=b.getPoint(),j=b.getAsControlPoint(),k=b.getAsCurrentPoint();b.addMarker(k,j,i),c.addBezierCurve(h.x,h.y,i.x,i.y,j.x,j.y,k.x,k.y),null!=a&&a.bezierCurveTo(i.x,i.y,j.x,j.y,k.x,k.y)}break;case"S":case"s":for(;!b.isCommandOrEnd();){var h=b.current,i=b.getReflectedControlPoint(),j=b.getAsControlPoint(),k=b.getAsCurrentPoint();b.addMarker(k,j,i),c.addBezierCurve(h.x,h.y,i.x,i.y,j.x,j.y,k.x,k.y),null!=a&&a.bezierCurveTo(i.x,i.y,j.x,j.y,k.x,k.y)}break;case"Q":case"q":for(;!b.isCommandOrEnd();){var h=b.current,j=b.getAsControlPoint(),k=b.getAsCurrentPoint();b.addMarker(k,j,j),c.addQuadraticCurve(h.x,h.y,j.x,j.y,k.x,k.y),null!=a&&a.quadraticCurveTo(j.x,j.y,k.x,k.y)}break;case"T":case"t":for(;!b.isCommandOrEnd();){var h=b.current,j=b.getReflectedControlPoint();b.control=j;var k=b.getAsCurrentPoint();b.addMarker(k,j,j),c.addQuadraticCurve(h.x,h.y,j.x,j.y,k.x,k.y),null!=a&&a.quadraticCurveTo(j.x,j.y,k.x,k.y)}break;case"A":case"a":for(;!b.isCommandOrEnd();){var h=b.current,l=b.getScalar(),m=b.getScalar(),n=b.getScalar()*(Math.PI/180),o=b.getScalar(),p=b.getScalar(),k=b.getAsCurrentPoint(),q=new f.Point(Math.cos(n)*(h.x-k.x)/2+Math.sin(n)*(h.y-k.y)/2,-Math.sin(n)*(h.x-k.x)/2+Math.cos(n)*(h.y-k.y)/2),r=Math.pow(q.x,2)/Math.pow(l,2)+Math.pow(q.y,2)/Math.pow(m,2);r>1&&(l*=Math.sqrt(r),m*=Math.sqrt(r));var s=(o==p?-1:1)*Math.sqrt((Math.pow(l,2)*Math.pow(m,2)-Math.pow(l,2)*Math.pow(q.y,2)-Math.pow(m,2)*Math.pow(q.x,2))/(Math.pow(l,2)*Math.pow(q.y,2)+Math.pow(m,2)*Math.pow(q.x,2)));isNaN(s)&&(s=0);var t=new f.Point(s*l*q.y/m,s*-m*q.x/l),u=new f.Point((h.x+k.x)/2+Math.cos(n)*t.x-Math.sin(n)*t.y,(h.y+k.y)/2+Math.sin(n)*t.x+Math.cos(n)*t.y),v=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2))},w=function(a,b){return(a[0]*b[0]+a[1]*b[1])/(v(a)*v(b))},x=function(a,b){return(a[0]*b[1]<a[1]*b[0]?-1:1)*Math.acos(w(a,b))},y=x([1,0],[(q.x-t.x)/l,(q.y-t.y)/m]),z=[(q.x-t.x)/l,(q.y-t.y)/m],A=[(-q.x-t.x)/l,(-q.y-t.y)/m],B=x(z,A);w(z,A)<=-1&&(B=Math.PI),w(z,A)>=1&&(B=0);var C=1-p?1:-1,D=y+C*(B/2),E=new f.Point(u.x+l*Math.cos(D),u.y+m*Math.sin(D));if(b.addMarkerAngle(E,D-C*Math.PI/2),b.addMarkerAngle(k,D-C*Math.PI),c.addPoint(k.x,k.y),null!=a){var w=l>m?l:m,F=l>m?1:l/m,G=l>m?m/l:1;a.translate(u.x,u.y),a.rotate(n),a.scale(F,G),a.arc(0,0,w,y,y+B,1-p),a.scale(1/F,1/G),a.rotate(-n),a.translate(-u.x,-u.y)}}break;case"Z":case"z":null!=a&&a.closePath(),b.current=b.start}return c},this.getMarkers=function(){for(var a=this.PathParser.getMarkerPoints(),b=this.PathParser.getMarkerAngles(),c=[],d=0;d<a.length;d++)c.push([a[d],b[d]]);return c}},f.Element.path.prototype=new f.Element.PathElementBase,f.Element.pattern=function(a){this.base=f.Element.ElementBase,this.base(a),this.createPattern=function(a){var b=this.attribute("width").toPixels("x",!0),c=this.attribute("height").toPixels("y",!0),d=new f.Element.svg;d.attributes.viewBox=new f.Property("viewBox",this.attribute("viewBox").value),d.attributes.width=new f.Property("width",b+"px"),d.attributes.height=new f.Property("height",c+"px"),d.attributes.transform=new f.Property("transform",this.attribute("patternTransform").value),d.children=this.children;var e=document.createElement("canvas");e.width=b,e.height=c;var g=e.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&g.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0));for(var h=-1;1>=h;h++)for(var i=-1;1>=i;i++)g.save(),g.translate(h*e.width,i*e.height),d.render(g),g.restore();var j=a.createPattern(e,"repeat");return j}},f.Element.pattern.prototype=new f.Element.ElementBase,f.Element.marker=function(a){this.base=f.Element.ElementBase,this.base(a),this.baseRender=this.render,this.render=function(a,b,c){a.translate(b.x,b.y),"auto"==this.attribute("orient").valueOrDefault("auto")&&a.rotate(c),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&a.scale(a.lineWidth,a.lineWidth),a.save();var d=new f.Element.svg;d.attributes.viewBox=new f.Property("viewBox",this.attribute("viewBox").value),d.attributes.refX=new f.Property("refX",this.attribute("refX").value),d.attributes.refY=new f.Property("refY",this.attribute("refY").value),d.attributes.width=new f.Property("width",this.attribute("markerWidth").value),d.attributes.height=new f.Property("height",this.attribute("markerHeight").value),d.attributes.fill=new f.Property("fill",this.attribute("fill").valueOrDefault("black")),d.attributes.stroke=new f.Property("stroke",this.attribute("stroke").valueOrDefault("none")),d.children=this.children,d.render(a),a.restore(),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&a.scale(1/a.lineWidth,1/a.lineWidth),"auto"==this.attribute("orient").valueOrDefault("auto")&&a.rotate(-c),a.translate(-b.x,-b.y)}},f.Element.marker.prototype=new f.Element.ElementBase,f.Element.defs=function(a){this.base=f.Element.ElementBase,this.base(a),this.render=function(){}},f.Element.defs.prototype=new f.Element.ElementBase,f.Element.GradientBase=function(a){this.base=f.Element.ElementBase,this.base(a),this.gradientUnits=this.attribute("gradientUnits").valueOrDefault("objectBoundingBox"),this.stops=[];for(var b=0;b<this.children.length;b++){var c=this.children[b];"stop"==c.type&&this.stops.push(c)}this.getGradient=function(){},this.createGradient=function(a,b,c){var d=this;this.getHrefAttribute().hasValue()&&(d=this.getHrefAttribute().getDefinition());var e=function(a){if(c.hasValue()){var b=new f.Property("color",a);return b.addOpacity(c).value}return a},g=this.getGradient(a,b);if(null==g)return e(d.stops[d.stops.length-1].color);for(var h=0;h<d.stops.length;h++)g.addColorStop(d.stops[h].offset,e(d.stops[h].color));if(this.attribute("gradientTransform").hasValue()){var i=f.ViewPort.viewPorts[0],j=new f.Element.rect;j.attributes.x=new f.Property("x",-f.MAX_VIRTUAL_PIXELS/3),j.attributes.y=new f.Property("y",-f.MAX_VIRTUAL_PIXELS/3),j.attributes.width=new f.Property("width",f.MAX_VIRTUAL_PIXELS),j.attributes.height=new f.Property("height",f.MAX_VIRTUAL_PIXELS);var k=new f.Element.g;k.attributes.transform=new f.Property("transform",this.attribute("gradientTransform").value),k.children=[j];var l=new f.Element.svg;l.attributes.x=new f.Property("x",0),l.attributes.y=new f.Property("y",0),l.attributes.width=new f.Property("width",i.width),l.attributes.height=new f.Property("height",i.height),l.children=[k];var m=document.createElement("canvas");m.width=i.width,m.height=i.height;var n=m.getContext("2d");return n.fillStyle=g,l.render(n),n.createPattern(m,"no-repeat")}return g}},f.Element.GradientBase.prototype=new f.Element.ElementBase,f.Element.linearGradient=function(a){this.base=f.Element.GradientBase,this.base(a),this.getGradient=function(a,b){var c="objectBoundingBox"==this.gradientUnits?b.getBoundingBox():null;this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0);var d="objectBoundingBox"==this.gradientUnits?c.x()+c.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),e="objectBoundingBox"==this.gradientUnits?c.y()+c.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),f="objectBoundingBox"==this.gradientUnits?c.x()+c.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),g="objectBoundingBox"==this.gradientUnits?c.y()+c.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return d==f&&e==g?null:a.createLinearGradient(d,e,f,g)}},f.Element.linearGradient.prototype=new f.Element.GradientBase,f.Element.radialGradient=function(a){this.base=f.Element.GradientBase,this.base(a),this.getGradient=function(a,b){var c=b.getBoundingBox();this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var d="objectBoundingBox"==this.gradientUnits?c.x()+c.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),e="objectBoundingBox"==this.gradientUnits?c.y()+c.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),f=d,g=e;this.attribute("fx").hasValue()&&(f="objectBoundingBox"==this.gradientUnits?c.x()+c.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(g="objectBoundingBox"==this.gradientUnits?c.y()+c.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));var h="objectBoundingBox"==this.gradientUnits?(c.width()+c.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return a.createRadialGradient(f,g,0,d,e,h)}},f.Element.radialGradient.prototype=new f.Element.GradientBase,f.Element.stop=function(a){this.base=f.Element.ElementBase,this.base(a),this.offset=this.attribute("offset").numValue(),this.offset<0&&(this.offset=0),this.offset>1&&(this.offset=1);var b=this.style("stop-color");this.style("stop-opacity").hasValue()&&(b=b.addOpacity(this.style("stop-opacity"))),this.color=b.value},f.Element.stop.prototype=new f.Element.ElementBase,f.Element.AnimateBase=function(a){this.base=f.Element.ElementBase,this.base(a),f.Animations.push(this),this.duration=0,this.begin=this.attribute("begin").toMilliseconds(),this.maxDuration=this.begin+this.attribute("dur").toMilliseconds(),this.getProperty=function(){var a=this.attribute("attributeType").value,b=this.attribute("attributeName").value;return"CSS"==a?this.parent.style(b,!0):this.parent.attribute(b,!0)},this.initialValue=null,this.initialUnits="",this.removed=!1,this.calcValue=function(){return""},this.update=function(a){if(null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits()),this.duration>this.maxDuration){if("indefinite"==this.attribute("repeatCount").value||"indefinite"==this.attribute("repeatDur").value)this.duration=0;else if("freeze"!=this.attribute("fill").valueOrDefault("remove")||this.frozen){if("remove"==this.attribute("fill").valueOrDefault("remove")&&!this.removed)return this.removed=!0,this.getProperty().value=this.parent.animationFrozen?this.parent.animationFrozenValue:this.initialValue,!0}else this.frozen=!0,this.parent.animationFrozen=!0,this.parent.animationFrozenValue=this.getProperty().value;return!1}this.duration=this.duration+a;var b=!1;if(this.begin<this.duration){var c=this.calcValue();if(this.attribute("type").hasValue()){var d=this.attribute("type").value;c=d+"("+c+")"}this.getProperty().value=c,b=!0}return b},this.from=this.attribute("from"),this.to=this.attribute("to"),this.values=this.attribute("values"),this.values.hasValue()&&(this.values.value=this.values.value.split(";")),this.progress=function(){var a={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var b=a.progress*(this.values.value.length-1),c=Math.floor(b),d=Math.ceil(b);a.from=new f.Property("from",parseFloat(this.values.value[c])),a.to=new f.Property("to",parseFloat(this.values.value[d])),a.progress=(b-c)/(d-c)}else a.from=this.from,a.to=this.to;return a}},f.Element.AnimateBase.prototype=new f.Element.ElementBase,f.Element.animate=function(a){this.base=f.Element.AnimateBase,this.base(a),this.calcValue=function(){var a=this.progress(),b=a.from.numValue()+(a.to.numValue()-a.from.numValue())*a.progress;return b+this.initialUnits}},f.Element.animate.prototype=new f.Element.AnimateBase,f.Element.animateColor=function(b){this.base=f.Element.AnimateBase,this.base(b),this.calcValue=function(){var b=this.progress(),c=new a(b.from.value),d=new a(b.to.value);if(c.ok&&d.ok){var e=c.r+(d.r-c.r)*b.progress,f=c.g+(d.g-c.g)*b.progress,g=c.b+(d.b-c.b)*b.progress;return"rgb("+parseInt(e,10)+","+parseInt(f,10)+","+parseInt(g,10)+")"}return this.attribute("from").value}},f.Element.animateColor.prototype=new f.Element.AnimateBase,f.Element.animateTransform=function(a){this.base=f.Element.AnimateBase,this.base(a),this.calcValue=function(){for(var a=this.progress(),b=f.ToNumberArray(a.from.value),c=f.ToNumberArray(a.to.value),d="",e=0;e<b.length;e++)d+=b[e]+(c[e]-b[e])*a.progress+" ";return d}},f.Element.animateTransform.prototype=new f.Element.animate,f.Element.font=function(a){this.base=f.Element.ElementBase,this.base(a),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[];for(var b=0;b<this.children.length;b++){var c=this.children[b];"font-face"==c.type?(this.fontFace=c,c.style("font-family").hasValue()&&(f.Definitions[c.style("font-family").value]=this)):"missing-glyph"==c.type?this.missingGlyph=c:"glyph"==c.type&&(""!=c.arabicForm?(this.isRTL=!0,this.isArabic=!0,"undefined"==typeof this.glyphs[c.unicode]&&(this.glyphs[c.unicode]=[]),this.glyphs[c.unicode][c.arabicForm]=c):this.glyphs[c.unicode]=c)}},f.Element.font.prototype=new f.Element.ElementBase,f.Element.fontface=function(a){this.base=f.Element.ElementBase,this.base(a),this.ascent=this.attribute("ascent").value,this.descent=this.attribute("descent").value,this.unitsPerEm=this.attribute("units-per-em").numValue()},f.Element.fontface.prototype=new f.Element.ElementBase,f.Element.missingglyph=function(a){this.base=f.Element.path,this.base(a),this.horizAdvX=0},f.Element.missingglyph.prototype=new f.Element.path,f.Element.glyph=function(a){this.base=f.Element.path,this.base(a),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.unicode=this.attribute("unicode").value,this.arabicForm=this.attribute("arabic-form").value},f.Element.glyph.prototype=new f.Element.path,f.Element.text=function(a){this.captureTextNodes=!0,this.base=f.Element.RenderedElementBase,this.base(a),this.baseSetContext=this.setContext,this.setContext=function(a){this.baseSetContext(a);var b=this.style("dominant-baseline").toTextBaseline();null==b&&(b=this.style("alignment-baseline").toTextBaseline()),null!=b&&(a.textBaseline=b)},this.getBoundingBox=function(){var a=this.attribute("x").toPixels("x"),b=this.attribute("y").toPixels("y"),c=this.parent.style("font-size").numValueOrDefault(f.Font.Parse(f.ctx.font).fontSize);return new f.BoundingBox(a,b-c,a+Math.floor(2*c/3)*this.children[0].getText().length,b)},this.renderChildren=function(a){this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y"),this.x+=this.getAnchorDelta(a,this,0);for(var b=0;b<this.children.length;b++)this.renderChild(a,this,b)},this.getAnchorDelta=function(a,b,c){var d=this.style("text-anchor").valueOrDefault("start");if("start"!=d){for(var e=0,f=c;f<b.children.length;f++){var g=b.children[f];if(f>c&&g.attribute("x").hasValue())break;e+=g.measureTextRecursive(a)}return-1*("end"==d?e:e/2)}return 0},this.renderChild=function(a,b,c){var d=b.children[c];d.attribute("x").hasValue()?(d.x=d.attribute("x").toPixels("x")+this.getAnchorDelta(a,b,c),d.attribute("dx").hasValue()&&(d.x+=d.attribute("dx").toPixels("x"))):(this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),d.attribute("dx").hasValue()&&(this.x+=d.attribute("dx").toPixels("x")),d.x=this.x),this.x=d.x+d.measureText(a),d.attribute("y").hasValue()?(d.y=d.attribute("y").toPixels("y"),d.attribute("dy").hasValue()&&(d.y+=d.attribute("dy").toPixels("y"))):(this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),d.attribute("dy").hasValue()&&(this.y+=d.attribute("dy").toPixels("y")),d.y=this.y),this.y=d.y,d.render(a);for(var c=0;c<d.children.length;c++)this.renderChild(a,d,c)}},f.Element.text.prototype=new f.Element.RenderedElementBase,f.Element.TextElementBase=function(a){this.base=f.Element.RenderedElementBase,this.base(a),this.getGlyph=function(a,b,c){var d=b[c],e=null;if(a.isArabic){var f="isolated";(0==c||" "==b[c-1])&&c<b.length-2&&" "!=b[c+1]&&(f="terminal"),c>0&&" "!=b[c-1]&&c<b.length-2&&" "!=b[c+1]&&(f="medial"),c>0&&" "!=b[c-1]&&(c==b.length-1||" "==b[c+1])&&(f="initial"),"undefined"!=typeof a.glyphs[d]&&(e=a.glyphs[d][f],null==e&&"glyph"==a.glyphs[d].type&&(e=a.glyphs[d]))}else e=a.glyphs[d];return null==e&&(e=a.missingGlyph),e},this.renderChildren=function(a){var b=this.parent.style("font-family").getDefinition();if(null==b)""!=a.fillStyle&&a.fillText(f.compressSpaces(this.getText()),this.x,this.y),""!=a.strokeStyle&&a.strokeText(f.compressSpaces(this.getText()),this.x,this.y);else{var c=this.parent.style("font-size").numValueOrDefault(f.Font.Parse(f.ctx.font).fontSize),d=this.parent.style("font-style").valueOrDefault(f.Font.Parse(f.ctx.font).fontStyle),e=this.getText();b.isRTL&&(e=e.split("").reverse().join(""));for(var g=f.ToNumberArray(this.parent.attribute("dx").value),h=0;h<e.length;h++){var i=this.getGlyph(b,e,h),j=c/b.fontFace.unitsPerEm;a.translate(this.x,this.y),a.scale(j,-j);var k=a.lineWidth;a.lineWidth=a.lineWidth*b.fontFace.unitsPerEm/c,"italic"==d&&a.transform(1,0,.4,1,0,0),i.render(a),"italic"==d&&a.transform(1,0,-.4,1,0,0),a.lineWidth=k,a.scale(1/j,-1/j),a.translate(-this.x,-this.y),this.x+=c*(i.horizAdvX||b.horizAdvX)/b.fontFace.unitsPerEm,"undefined"==typeof g[h]||isNaN(g[h])||(this.x+=g[h])}}},this.getText=function(){},this.measureTextRecursive=function(a){for(var b=this.measureText(a),c=0;c<this.children.length;c++)b+=this.children[c].measureTextRecursive(a);return b},this.measureText=function(a){var b=this.parent.style("font-family").getDefinition();if(null!=b){var c=this.parent.style("font-size").numValueOrDefault(f.Font.Parse(f.ctx.font).fontSize),d=0,e=this.getText();b.isRTL&&(e=e.split("").reverse().join(""));for(var g=f.ToNumberArray(this.parent.attribute("dx").value),h=0;h<e.length;h++){var i=this.getGlyph(b,e,h);d+=(i.horizAdvX||b.horizAdvX)*c/b.fontFace.unitsPerEm,"undefined"==typeof g[h]||isNaN(g[h])||(d+=g[h])}return d}var j=f.compressSpaces(this.getText());if(!a.measureText)return 10*j.length;a.save(),this.setContext(a);var k=a.measureText(j).width;return a.restore(),k}},f.Element.TextElementBase.prototype=new f.Element.RenderedElementBase,f.Element.tspan=function(a){this.captureTextNodes=!0,this.base=f.Element.TextElementBase,this.base(a),this.text=a.nodeValue||a.text||"",this.getText=function(){return this.text}},f.Element.tspan.prototype=new f.Element.TextElementBase,f.Element.tref=function(a){this.base=f.Element.TextElementBase,this.base(a),this.getText=function(){var a=this.getHrefAttribute().getDefinition();return null!=a?a.children[0].getText():void 0}},f.Element.tref.prototype=new f.Element.TextElementBase,f.Element.a=function(a){this.base=f.Element.TextElementBase,this.base(a),this.hasText=a.childNodes.length>0;for(var b=0;b<a.childNodes.length;b++)3!=a.childNodes[b].nodeType&&(this.hasText=!1);this.text=this.hasText?a.childNodes[0].nodeValue:"",this.getText=function(){return this.text},this.baseRenderChildren=this.renderChildren,this.renderChildren=function(a){if(this.hasText){this.baseRenderChildren(a);var b=new f.Property("fontSize",f.Font.Parse(f.ctx.font).fontSize);f.Mouse.checkBoundingBox(this,new f.BoundingBox(this.x,this.y-b.toPixels("y"),this.x+this.measureText(a),this.y))}else if(this.children.length>0){var c=new f.Element.g;c.children=this.children,c.parent=this,c.render(a)}},this.onclick=function(){window.open(this.getHrefAttribute().value)},this.onmousemove=function(){f.ctx.canvas.style.cursor="pointer"}},f.Element.a.prototype=new f.Element.TextElementBase,f.Element.image=function(a){this.base=f.Element.RenderedElementBase,this.base(a);var b=this.getHrefAttribute().value;if(""!=b){var c=b.match(/\.svg$/);if(f.Images.push(this),this.loaded=!1,c)this.img=f.ajax(b),this.loaded=!0;else{this.img=document.createElement("img"),1==f.opts.useCORS&&(this.img.crossOrigin="Anonymous");var d=this;this.img.onload=function(){d.loaded=!0},this.img.onerror=function(){f.log('ERROR: image "'+b+'" not found'),d.loaded=!0},this.img.src=b}this.renderChildren=function(a){var b=this.attribute("x").toPixels("x"),d=this.attribute("y").toPixels("y"),e=this.attribute("width").toPixels("x"),g=this.attribute("height").toPixels("y");0!=e&&0!=g&&(a.save(),c?a.drawSvg(this.img,b,d,e,g):(a.translate(b,d),f.AspectRatio(a,this.attribute("preserveAspectRatio").value,e,this.img.width,g,this.img.height,0,0),a.drawImage(this.img,0,0)),a.restore())},this.getBoundingBox=function(){var a=this.attribute("x").toPixels("x"),b=this.attribute("y").toPixels("y"),c=this.attribute("width").toPixels("x"),d=this.attribute("height").toPixels("y");return new f.BoundingBox(a,b,a+c,b+d)}}},f.Element.image.prototype=new f.Element.RenderedElementBase,f.Element.g=function(a){this.base=f.Element.RenderedElementBase,this.base(a),this.getBoundingBox=function(){for(var a=new f.BoundingBox,b=0;b<this.children.length;b++)a.addBoundingBox(this.children[b].getBoundingBox());return a}},f.Element.g.prototype=new f.Element.RenderedElementBase,f.Element.symbol=function(a){this.base=f.Element.RenderedElementBase,this.base(a),this.render=function(){}},f.Element.symbol.prototype=new f.Element.RenderedElementBase,f.Element.style=function(a){this.base=f.Element.ElementBase,this.base(a);for(var b="",d=0;d<a.childNodes.length;d++)b+=a.childNodes[d].nodeValue;b=b.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,""),b=f.compressSpaces(b);for(var e=b.split("}"),d=0;d<e.length;d++)if(""!=f.trim(e[d]))for(var g=e[d].split("{"),h=g[0].split(","),i=g[1].split(";"),j=0;j<h.length;j++){var k=f.trim(h[j]);if(""!=k){for(var l={},m=0;m<i.length;m++){var n=i[m].indexOf(":"),o=i[m].substr(0,n),p=i[m].substr(n+1,i[m].length-n);null!=o&&null!=p&&(l[f.trim(o)]=new f.Property(f.trim(o),f.trim(p)))}if(f.Styles[k]=l,f.StylesSpecificity[k]=c(k),"@font-face"==k)for(var q=l["font-family"].value.replace(/"/g,""),r=l.src.value.split(","),s=0;s<r.length;s++)if(r[s].indexOf('format("svg")')>0)for(var t=r[s].indexOf("url"),u=r[s].indexOf(")",t),v=r[s].substr(t+5,u-t-6),w=f.parseXml(f.ajax(v)),x=w.getElementsByTagName("font"),y=0;y<x.length;y++){var z=f.CreateElement(x[y]);f.Definitions[q]=z}}}},f.Element.style.prototype=new f.Element.ElementBase,f.Element.use=function(a){this.base=f.Element.RenderedElementBase,this.base(a),this.baseSetContext=this.setContext,this.setContext=function(a){this.baseSetContext(a),this.attribute("x").hasValue()&&a.translate(this.attribute("x").toPixels("x"),0),this.attribute("y").hasValue()&&a.translate(0,this.attribute("y").toPixels("y"))};var b=this.getHrefAttribute().getDefinition();this.path=function(a){null!=b&&b.path(a)},this.getBoundingBox=function(){return null!=b?b.getBoundingBox():void 0},this.renderChildren=function(a){if(null!=b){var c=b;"symbol"==b.type&&(c=new f.Element.svg,c.type="svg",c.attributes.viewBox=new f.Property("viewBox",b.attribute("viewBox").value),c.attributes.preserveAspectRatio=new f.Property("preserveAspectRatio",b.attribute("preserveAspectRatio").value),c.attributes.overflow=new f.Property("overflow",b.attribute("overflow").value),c.children=b.children),"svg"==c.type&&(this.attribute("width").hasValue()&&(c.attributes.width=new f.Property("width",this.attribute("width").value)),this.attribute("height").hasValue()&&(c.attributes.height=new f.Property("height",this.attribute("height").value)));var d=c.parent;c.parent=null,c.render(a),c.parent=d}}},f.Element.use.prototype=new f.Element.RenderedElementBase,f.Element.mask=function(a){this.base=f.Element.ElementBase,this.base(a),this.apply=function(a,b){var c=this.attribute("x").toPixels("x"),d=this.attribute("y").toPixels("y"),e=this.attribute("width").toPixels("x"),g=this.attribute("height").toPixels("y");if(0==e&&0==g){for(var h=new f.BoundingBox,i=0;i<this.children.length;i++)h.addBoundingBox(this.children[i].getBoundingBox());var c=Math.floor(h.x1),d=Math.floor(h.y1),e=Math.floor(h.width()),g=Math.floor(h.height())}var j=b.attribute("mask").value;b.attribute("mask").value="";var k=document.createElement("canvas");k.width=c+e,k.height=d+g;var l=k.getContext("2d");this.renderChildren(l);var m=document.createElement("canvas");m.width=c+e,m.height=d+g;var n=m.getContext("2d");b.render(n),n.globalCompositeOperation="destination-in",n.fillStyle=l.createPattern(k,"no-repeat"),n.fillRect(0,0,c+e,d+g),a.fillStyle=n.createPattern(m,"no-repeat"),a.fillRect(0,0,c+e,d+g),b.attribute("mask").value=j},this.render=function(){}},f.Element.mask.prototype=new f.Element.ElementBase,f.Element.clipPath=function(a){this.base=f.Element.ElementBase,this.base(a),this.apply=function(a){var b=CanvasRenderingContext2D.prototype.beginPath;CanvasRenderingContext2D.prototype.beginPath=function(){};var c=CanvasRenderingContext2D.prototype.closePath;CanvasRenderingContext2D.prototype.closePath=function(){},b.call(a);for(var d=0;d<this.children.length;d++){var e=this.children[d];if("undefined"!=typeof e.path){var g=null;e.attribute("transform").hasValue()&&(g=new f.Transform(e.attribute("transform").value),g.apply(a)),e.path(a),CanvasRenderingContext2D.prototype.closePath=c,g&&g.unapply(a)}}c.call(a),a.clip(),CanvasRenderingContext2D.prototype.beginPath=b,CanvasRenderingContext2D.prototype.closePath=c},this.render=function(){}},f.Element.clipPath.prototype=new f.Element.ElementBase,f.Element.filter=function(a){this.base=f.Element.ElementBase,this.base(a),this.apply=function(a,b){var c=b.getBoundingBox(),d=Math.floor(c.x1),e=Math.floor(c.y1),f=Math.floor(c.width()),g=Math.floor(c.height()),h=b.style("filter").value;b.style("filter").value="";for(var i=0,j=0,k=0;k<this.children.length;k++){var l=this.children[k].extraFilterDistance||0;i=Math.max(i,l),j=Math.max(j,l)}var m=document.createElement("canvas");m.width=f+2*i,m.height=g+2*j;var n=m.getContext("2d");n.translate(-d+i,-e+j),b.render(n);for(var k=0;k<this.children.length;k++)this.children[k].apply(n,0,0,f+2*i,g+2*j);a.drawImage(m,0,0,f+2*i,g+2*j,d-i,e-j,f+2*i,g+2*j),b.style("filter",!0).value=h},this.render=function(){}},f.Element.filter.prototype=new f.Element.ElementBase,f.Element.feMorphology=function(a){this.base=f.Element.ElementBase,this.base(a),this.apply=function(){}},f.Element.feMorphology.prototype=new f.Element.ElementBase,f.Element.feComposite=function(a){this.base=f.Element.ElementBase,this.base(a),this.apply=function(){}},f.Element.feComposite.prototype=new f.Element.ElementBase,f.Element.feColorMatrix=function(a){function b(a,b,c,d,e,f){return a[c*d*4+4*b+f]}function c(a,b,c,d,e,f,g){a[c*d*4+4*b+f]=g}function d(a,b){var c=e[a];return c*(0>c?b-255:b)}this.base=f.Element.ElementBase,this.base(a);var e=f.ToNumberArray(this.attribute("values").value);switch(this.attribute("type").valueOrDefault("matrix")){case"saturate":var g=e[0];e=[.213+.787*g,.715-.715*g,.072-.072*g,0,0,.213-.213*g,.715+.285*g,.072-.072*g,0,0,.213-.213*g,.715-.715*g,.072+.928*g,0,0,0,0,0,1,0,0,0,0,0,1];break;case"hueRotate":var h=e[0]*Math.PI/180,i=function(a,b,c){return a+Math.cos(h)*b+Math.sin(h)*c};e=[i(.213,.787,-.213),i(.715,-.715,-.715),i(.072,-.072,.928),0,0,i(.213,-.213,.143),i(.715,.285,.14),i(.072,-.072,-.283),0,0,i(.213,-.213,-.787),i(.715,-.715,.715),i(.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case"luminanceToAlpha":e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}this.apply=function(a,e,f,g,h){for(var i=a.getImageData(0,0,g,h),f=0;h>f;f++)for(var e=0;g>e;e++){var j=b(i.data,e,f,g,h,0),k=b(i.data,e,f,g,h,1),l=b(i.data,e,f,g,h,2),m=b(i.data,e,f,g,h,3);c(i.data,e,f,g,h,0,d(0,j)+d(1,k)+d(2,l)+d(3,m)+d(4,1)),c(i.data,e,f,g,h,1,d(5,j)+d(6,k)+d(7,l)+d(8,m)+d(9,1)),c(i.data,e,f,g,h,2,d(10,j)+d(11,k)+d(12,l)+d(13,m)+d(14,1)),c(i.data,e,f,g,h,3,d(15,j)+d(16,k)+d(17,l)+d(18,m)+d(19,1))}a.clearRect(0,0,g,h),a.putImageData(i,0,0)}},f.Element.feColorMatrix.prototype=new f.Element.ElementBase,f.Element.feGaussianBlur=function(a){this.base=f.Element.ElementBase,this.base(a),this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue()),this.extraFilterDistance=this.blurRadius,this.apply=function(a,c,d,e,g){return"undefined"==typeof b.canvasRGBA?void f.log("ERROR: StackBlur.js must be included for blur to work"):(a.canvas.id=f.UniqueId(),a.canvas.style.display="none",document.body.appendChild(a.canvas),b.canvasRGBA(a.canvas.id,c,d,e,g,this.blurRadius),void document.body.removeChild(a.canvas))}},f.Element.feGaussianBlur.prototype=new f.Element.ElementBase,f.Element.title=function(){},f.Element.title.prototype=new f.Element.ElementBase,f.Element.desc=function(){},f.Element.desc.prototype=new f.Element.ElementBase,f.Element.MISSING=function(a){f.log("ERROR: Element '"+a.nodeName+"' not yet implemented.")},f.Element.MISSING.prototype=new f.Element.ElementBase,f.CreateElement=function(a){var b=a.nodeName.replace(/^[^:]+:/,"");b=b.replace(/\-/g,"");var c=null;return c="undefined"!=typeof f.Element[b]?new f.Element[b](a):new f.Element.MISSING(a),c.type=a.nodeName,c},f.load=function(a,b){f.loadXml(a,f.ajax(b))},f.loadXml=function(a,b){f.loadXmlDoc(a,f.parseXml(b))},f.loadXmlDoc=function(a,b){f.init(a);var c=function(b){for(var c=a.canvas;c;)b.x-=c.offsetLeft,b.y-=c.offsetTop,c=c.offsetParent;return window.scrollX&&(b.x+=window.scrollX),window.scrollY&&(b.y+=window.scrollY),b};1!=f.opts.ignoreMouse&&(a.canvas.onclick=function(a){var b=c(new f.Point(null!=a?a.clientX:event.clientX,null!=a?a.clientY:event.clientY));f.Mouse.onclick(b.x,b.y)},a.canvas.onmousemove=function(a){var b=c(new f.Point(null!=a?a.clientX:event.clientX,null!=a?a.clientY:event.clientY));f.Mouse.onmousemove(b.x,b.y)});var d=f.CreateElement(b.documentElement);d.root=!0;var e=!0,g=function(){f.ViewPort.Clear(),a.canvas.parentNode&&f.ViewPort.SetCurrent(a.canvas.parentNode.clientWidth,a.canvas.parentNode.clientHeight),1!=f.opts.ignoreDimensions&&(d.style("width").hasValue()&&(a.canvas.width=d.style("width").toPixels("x"),a.canvas.style.width=a.canvas.width+"px"),d.style("height").hasValue()&&(a.canvas.height=d.style("height").toPixels("y"),a.canvas.style.height=a.canvas.height+"px"));var c=a.canvas.clientWidth||a.canvas.width,g=a.canvas.clientHeight||a.canvas.height;if(1==f.opts.ignoreDimensions&&d.style("width").hasValue()&&d.style("height").hasValue()&&(c=d.style("width").toPixels("x"),g=d.style("height").toPixels("y")),f.ViewPort.SetCurrent(c,g),null!=f.opts.offsetX&&(d.attribute("x",!0).value=f.opts.offsetX),null!=f.opts.offsetY&&(d.attribute("y",!0).value=f.opts.offsetY),
null!=f.opts.scaleWidth||null!=f.opts.scaleHeight){var h=null,i=null,j=f.ToNumberArray(d.attribute("viewBox").value);null!=f.opts.scaleWidth&&(d.attribute("width").hasValue()?h=d.attribute("width").toPixels("x")/f.opts.scaleWidth:isNaN(j[2])||(h=j[2]/f.opts.scaleWidth)),null!=f.opts.scaleHeight&&(d.attribute("height").hasValue()?i=d.attribute("height").toPixels("y")/f.opts.scaleHeight:isNaN(j[3])||(i=j[3]/f.opts.scaleHeight)),null==h&&(h=i),null==i&&(i=h),d.attribute("width",!0).value=f.opts.scaleWidth,d.attribute("height",!0).value=f.opts.scaleHeight,d.attribute("transform",!0).value+=" scale("+1/h+","+1/i+")"}1!=f.opts.ignoreClear&&a.clearRect(0,0,c,g),d.render(a),e&&(e=!1,"function"==typeof f.opts.renderCallback&&f.opts.renderCallback(b))},h=!0;f.ImagesLoaded()&&(h=!1,g()),f.intervalID=setInterval(function(){var a=!1;if(h&&f.ImagesLoaded()&&(h=!1,a=!0),1!=f.opts.ignoreMouse&&(a|=f.Mouse.hasEvents()),1!=f.opts.ignoreAnimation)for(var b=0;b<f.Animations.length;b++)a|=f.Animations[b].update(1e3/f.FRAMERATE);"function"==typeof f.opts.forceRedraw&&1==f.opts.forceRedraw()&&(a=!0),a&&(g(),f.Mouse.runEvents())},1e3/f.FRAMERATE)},f.stop=function(){f.intervalID&&clearInterval(f.intervalID)},f.Mouse=new function(){this.events=[],this.hasEvents=function(){return 0!=this.events.length},this.onclick=function(a,b){this.events.push({type:"onclick",x:a,y:b,run:function(a){a.onclick&&a.onclick()}})},this.onmousemove=function(a,b){this.events.push({type:"onmousemove",x:a,y:b,run:function(a){a.onmousemove&&a.onmousemove()}})},this.eventElements=[],this.checkPath=function(a,b){for(var c=0;c<this.events.length;c++){var d=this.events[c];b.isPointInPath&&b.isPointInPath(d.x,d.y)&&(this.eventElements[c]=a)}},this.checkBoundingBox=function(a,b){for(var c=0;c<this.events.length;c++){var d=this.events[c];b.isPointInBox(d.x,d.y)&&(this.eventElements[c]=a)}},this.runEvents=function(){f.ctx.canvas.style.cursor="";for(var a=0;a<this.events.length;a++)for(var b=this.events[a],c=this.eventElements[a];c;)b.run(c),c=c.parent;this.events=[],this.eventElements=[]}},f}var e,f=function(a,b,c){if(null!=a||null!=b||null!=c){"string"==typeof a&&(a=document.getElementById(a)),null!=a.svg&&a.svg.stop();var e=d(c||{});(1!=a.childNodes.length||"OBJECT"!=a.childNodes[0].nodeName)&&(a.svg=e);var g=a.getContext("2d");"undefined"!=typeof b.documentElement?e.loadXmlDoc(g,b):"<"==b.substr(0,1)?e.loadXml(g,b):e.load(g,b)}else for(var h=document.querySelectorAll("svg"),i=0;i<h.length;i++){var j=h[i],k=document.createElement("canvas");k.width=j.clientWidth,k.height=j.clientHeight,j.parentNode.insertBefore(k,j),j.parentNode.removeChild(j);var l=document.createElement("div");l.appendChild(j),f(k,l.innerHTML)}};e="undefined"!=typeof Element.prototype.matches?function(a,b){return a.matches(b)}:"undefined"!=typeof Element.prototype.webkitMatchesSelector?function(a,b){return a.webkitMatchesSelector(b)}:"undefined"!=typeof Element.prototype.mozMatchesSelector?function(a,b){return a.mozMatchesSelector(b)}:"undefined"!=typeof Element.prototype.msMatchesSelector?function(a,b){return a.msMatchesSelector(b)}:"undefined"!=typeof Element.prototype.oMatchesSelector?function(a,b){return a.oMatchesSelector(b)}:Sizzle.matchesSelector;var g=/(\[[^\]]+\])/g,h=/(#[^\s\+>~\.\[:]+)/g,j=/(\.[^\s\+>~\.\[:]+)/g,k=/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,l=/(:[\w-]+\([^\)]*\))/gi,m=/(:[^\s\+>~\.\[:]+)/g,n=/([^\s\+>~\.\[:]+)/g;return"undefined"!=typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.drawSvg=function(a,b,c,d,e){f(this.canvas,a,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:b,offsetY:c,scaleWidth:d,scaleHeight:e})}),f}),d("../bower_components/FileSaver.js/FileSaver",[],function(){return window.saveAs||"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator)||function(a){if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var b=a.document,c=function(){return a.URL||a.webkitURL||a},d=b.createElementNS("http://www.w3.org/1999/xhtml","a"),e="download"in d,f=function(c){var d=b.createEvent("MouseEvents");d.initMouseEvent("click",!0,!1,a,0,0,0,0,0,!1,!1,!1,!1,0,null),c.dispatchEvent(d)},g=a.webkitRequestFileSystem,h=a.requestFileSystem||g||a.mozRequestFileSystem,i=function(b){(a.setImmediate||a.setTimeout)(function(){throw b},0)},j="application/octet-stream",k=0,l=500,m=function(b){var d=function(){"string"==typeof b?c().revokeObjectURL(b):b.remove()};a.chrome?d():setTimeout(d,l)},n=function(a,b,c){b=[].concat(b);for(var d=b.length;d--;){var e=a["on"+b[d]];if("function"==typeof e)try{e.call(a,c||a)}catch(f){i(f)}}},o=function(b,i){var l,o,p,q=this,r=b.type,s=!1,t=function(){n(q,"writestart progress write writeend".split(" "))},u=function(){if((s||!l)&&(l=c().createObjectURL(b)),o)o.location.href=l;else{var d=a.open(l,"_blank");void 0==d&&"undefined"!=typeof safari&&(a.location.href=l)}q.readyState=q.DONE,t(),m(l)},v=function(a){return function(){return q.readyState!==q.DONE?a.apply(this,arguments):void 0}},w={create:!0,exclusive:!1};return q.readyState=q.INIT,i||(i="download"),e?(l=c().createObjectURL(b),d.href=l,d.download=i,f(d),q.readyState=q.DONE,t(),void m(l)):(a.chrome&&r&&r!==j&&(p=b.slice||b.webkitSlice,b=p.call(b,0,b.size,j),s=!0),g&&"download"!==i&&(i+=".download"),(r===j||g)&&(o=a),h?(k+=b.size,void h(a.TEMPORARY,k,v(function(a){a.root.getDirectory("saved",w,v(function(a){var c=function(){a.getFile(i,w,v(function(a){a.createWriter(v(function(c){c.onwriteend=function(b){o.location.href=a.toURL(),q.readyState=q.DONE,n(q,"writeend",b),m(a)},c.onerror=function(){var a=c.error;a.code!==a.ABORT_ERR&&u()},"writestart progress write abort".split(" ").forEach(function(a){c["on"+a]=q["on"+a]}),c.write(b),q.abort=function(){c.abort(),q.readyState=q.DONE},q.readyState=q.WRITING}),u)}),u)};a.getFile(i,{create:!1},v(function(a){a.remove(),c()}),v(function(a){a.code===a.NOT_FOUND_ERR?c():u()}))}),u)}),u)):void u())},p=o.prototype,q=function(a,b){return new o(a,b)};return p.abort=function(){var a=this;a.readyState=a.DONE,n(a,"abort")},p.readyState=p.INIT=0,p.WRITING=1,p.DONE=2,p.error=p.onwritestart=p.onprogress=p.onwrite=p.onabort=p.onerror=p.onwriteend=null,q}}(window)}),function(){function a(a){return"function"==typeof a||"object"==typeof a&&null!==a}function b(a){return"function"==typeof a}function c(a){return"object"==typeof a&&null!==a}function e(){}function f(){return function(){process.nextTick(j)}}function g(){var a=0,b=new M(j),c=document.createTextNode("");return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}function h(){var a=new MessageChannel;return a.port1.onmessage=j,function(){a.port2.postMessage(0)}}function i(){return function(){setTimeout(j,1)}}function j(){for(var a=0;J>a;a+=2){var b=O[a],c=O[a+1];b(c),O[a]=void 0,O[a+1]=void 0}J=0}function k(){}function l(){return new TypeError("You cannot resolve a promise with itself")}function m(){return new TypeError("A promises callback cannot return that same promise.")}function n(a){try{return a.then}catch(b){return S.error=b,S}}function o(a,b,c,d){try{a.call(b,c,d)}catch(e){return e}}function p(a,b,c){K(function(a){var d=!1,e=o(c,b,function(c){d||(d=!0,b!==c?s(a,c):u(a,c))},function(b){d||(d=!0,v(a,b))},"Settle: "+(a._label||" unknown promise"));!d&&e&&(d=!0,v(a,e))},a)}function q(a,b){b._state===Q?u(a,b._result):a._state===R?v(a,b._result):w(b,void 0,function(b){s(a,b)},function(b){v(a,b)})}function r(a,c){if(c.constructor===a.constructor)q(a,c);else{var d=n(c);d===S?v(a,S.error):void 0===d?u(a,c):b(d)?p(a,c,d):u(a,c)}}function s(b,c){b===c?v(b,l()):a(c)?r(b,c):u(b,c)}function t(a){a._onerror&&a._onerror(a._result),x(a)}function u(a,b){a._state===P&&(a._result=b,a._state=Q,0===a._subscribers.length||K(x,a))}function v(a,b){a._state===P&&(a._state=R,a._result=b,K(t,a))}function w(a,b,c,d){var e=a._subscribers,f=e.length;a._onerror=null,e[f]=b,e[f+Q]=c,e[f+R]=d,0===f&&a._state&&K(x,a)}function x(a){var b=a._subscribers,c=a._state;if(0!==b.length){for(var d,e,f=a._result,g=0;g<b.length;g+=3)d=b[g],e=b[g+c],d?A(c,d,e,f):e(f);a._subscribers.length=0}}function y(){this.error=null}function z(a,b){try{return a(b)}catch(c){return T.error=c,T}}function A(a,c,d,e){var f,g,h,i,j=b(d);if(j){if(f=z(d,e),f===T?(i=!0,g=f.error,f=null):h=!0,c===f)return void v(c,m())}else f=e,h=!0;c._state!==P||(j&&h?s(c,f):i?v(c,g):a===Q?u(c,f):a===R&&v(c,f))}function B(a,b){try{b(function(b){s(a,b)},function(b){v(a,b)})}catch(c){v(a,c)}}function C(a,b,c,d){this._instanceConstructor=a,this.promise=new a(k,d),this._abortOnReject=c,this._validateInput(b)?(this._input=b,this.length=b.length,this._remaining=b.length,this._init(),0===this.length?u(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&u(this.promise,this._result))):v(this.promise,this._validationError())}function D(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function E(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function F(a){this._id=Z++,this._state=void 0,this._result=void 0,this._subscribers=[],k!==a&&(b(a)||D(),this instanceof F||E(),B(this,a))}var G;G=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)};var H,I=G,J=(Date.now||function(){return(new Date).getTime()},Object.create||function(a){if(arguments.length>1)throw new Error("Second argument not supported");if("object"!=typeof a)throw new TypeError("Argument must be an object");return e.prototype=a,new e},0),K=function(a,b){O[J]=a,O[J+1]=b,J+=2,2===J&&H()},L="undefined"!=typeof window?window:{},M=L.MutationObserver||L.WebKitMutationObserver,N="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,O=new Array(1e3);H="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?f():M?g():N?h():i();var P=void 0,Q=1,R=2,S=new y,T=new y;C.prototype._validateInput=function(a){return I(a)},C.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},C.prototype._init=function(){this._result=new Array(this.length)};var U=C;C.prototype._enumerate=function(){for(var a=this.length,b=this.promise,c=this._input,d=0;b._state===P&&a>d;d++)this._eachEntry(c[d],d)},C.prototype._eachEntry=function(a,b){var d=this._instanceConstructor;c(a)?a.constructor===d&&a._state!==P?(a._onerror=null,this._settledAt(a._state,b,a._result)):this._willSettleAt(d.resolve(a),b):(this._remaining--,this._result[b]=this._makeResult(Q,b,a))},C.prototype._settledAt=function(a,b,c){var d=this.promise;d._state===P&&(this._remaining--,this._abortOnReject&&a===R?v(d,c):this._result[b]=this._makeResult(a,b,c)),0===this._remaining&&u(d,this._result)},C.prototype._makeResult=function(a,b,c){return c},C.prototype._willSettleAt=function(a,b){var c=this;w(a,void 0,function(a){c._settledAt(Q,b,a)},function(a){c._settledAt(R,b,a)})};var V=function(a,b){return new U(this,a,!0,b).promise},W=function(a,b){function c(a){s(f,a)}function d(a){v(f,a)}var e=this,f=new e(k,b);if(!I(a))return v(f,new TypeError("You must pass an array to race.")),f;for(var g=a.length,h=0;f._state===P&&g>h;h++)w(e.resolve(a[h]),void 0,c,d);return f},X=function(a,b){var c=this;if(a&&"object"==typeof a&&a.constructor===c)return a;var d=new c(k,b);return s(d,a),d},Y=function(a,b){var c=this,d=new c(k,b);return v(d,a),d},Z=0,$=F;F.all=V,F.race=W,F.resolve=X,F.reject=Y,F.prototype={constructor:F,then:function(a,b){var c=this,d=c._state;if(d===Q&&!a||d===R&&!b)return this;var e=new this.constructor(k),f=c._result;if(d){var g=arguments[d-1];K(function(){A(d,e,g,f)})}else w(c,e,a,b);return e},"catch":function(a){return this.then(null,a)}};var _=function(){var a;a="undefined"!=typeof global?global:"undefined"!=typeof window&&window.document?window:self;var c="Promise"in a&&"resolve"in a.Promise&&"reject"in a.Promise&&"all"in a.Promise&&"race"in a.Promise&&function(){var c;return new a.Promise(function(a){c=a}),b(c)}();c||(a.Promise=$)},aa={Promise:$,polyfill:_};"function"==typeof d&&d.amd?d("../bower_components/es6-promise/promise",[],function(){return aa}):"undefined"!=typeof module&&module.exports?module.exports=aa:"undefined"!=typeof this&&(this.ES6Promise=aa)}.call(this),d("../node_modules/requirejs-text/text",["module"],function(a){var b,d,e,f,g,h=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],i=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,j=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,k="undefined"!=typeof location&&location.href,l=k&&location.protocol&&location.protocol.replace(/\:/,""),m=k&&location.hostname,n=k&&(location.port||void 0),o={},p=a.config&&a.config()||{};return b={version:"2.0.12",strip:function(a){if(a){a=a.replace(i,"");var b=a.match(j);b&&(a=b[1])}else a="";return a},jsEscape:function(a){return a.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:p.createXhr||function(){var a,b,c;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(b=0;3>b;b+=1){c=h[b];try{a=new ActiveXObject(c)}catch(d){}if(a){h=[c];break}}return a},parseName:function(a){var b,c,d,e=!1,f=a.indexOf("."),g=0===a.indexOf("./")||0===a.indexOf("../");return-1!==f&&(!g||f>1)?(b=a.substring(0,f),c=a.substring(f+1,a.length)):b=a,d=c||b,f=d.indexOf("!"),-1!==f&&(e="strip"===d.substring(f+1),d=d.substring(0,f),c?c=d:b=d),{moduleName:b,ext:c,strip:e}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(a,c,d,e){var f,g,h,i=b.xdRegExp.exec(a);return i?(f=i[2],g=i[3],g=g.split(":"),h=g[1],g=g[0],!(f&&f!==c||g&&g.toLowerCase()!==d.toLowerCase()||(h||g)&&h!==e)):!0},finishLoad:function(a,c,d,e){d=c?b.strip(d):d,p.isBuild&&(o[a]=d),e(d)},load:function(a,c,d,e){if(e&&e.isBuild&&!e.inlineText)return void d();p.isBuild=e&&e.isBuild;var f=b.parseName(a),g=f.moduleName+(f.ext?"."+f.ext:""),h=c.toUrl(g),i=p.useXhr||b.useXhr;return 0===h.indexOf("empty:")?void d():void(!k||i(h,l,m,n)?b.get(h,function(c){b.finishLoad(a,f.strip,c,d)},function(a){d.error&&d.error(a)}):c([g],function(a){b.finishLoad(f.moduleName+"."+f.ext,f.strip,a,d)}))},write:function(a,c,d){if(o.hasOwnProperty(c)){var e=b.jsEscape(o[c]);d.asModule(a+"!"+c,"define(function () { return '"+e+"';});\n")}},writeFile:function(a,c,d,e,f){var g=b.parseName(c),h=g.ext?"."+g.ext:"",i=g.moduleName+h,j=d.toUrl(g.moduleName+h)+".js";b.load(i,d,function(){var c=function(a){return e(j,a)};c.asModule=function(a,b){return e.asModule(a,j,b)},b.write(a,i,c,f)},f)}},"node"===p.env||!p.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(d=c.nodeRequire("fs"),b.get=function(a,b,c){try{var e=d.readFileSync(a,"utf8");0===e.indexOf("\ufeff")&&(e=e.substring(1)),b(e)}catch(f){c&&c(f)}}):"xhr"===p.env||!p.env&&b.createXhr()?b.get=function(a,c,d,e){var f,g=b.createXhr();if(g.open("GET",a,!0),e)for(f in e)e.hasOwnProperty(f)&&g.setRequestHeader(f.toLowerCase(),e[f]);p.onXhr&&p.onXhr(g,a),g.onreadystatechange=function(){var b,e;4===g.readyState&&(b=g.status||0,b>399&&600>b?(e=new Error(a+" HTTP status: "+b),e.xhr=g,d&&d(e)):c(g.responseText),p.onXhrComplete&&p.onXhrComplete(g,a))},g.send(null)}:"rhino"===p.env||!p.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?b.get=function(a,b){var c,d,e="utf-8",f=new java.io.File(a),g=java.lang.System.getProperty("line.separator"),h=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(f),e)),i="";try{for(c=new java.lang.StringBuffer,d=h.readLine(),d&&d.length()&&65279===d.charAt(0)&&(d=d.substring(1)),null!==d&&c.append(d);null!==(d=h.readLine());)c.append(g),c.append(d);i=String(c.toString())}finally{h.close()}b(i)}:("xpconnect"===p.env||!p.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(e=Components.classes,f=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),g="@mozilla.org/windows-registry-key;1"in e,b.get=function(a,b){var c,d,h,i={};g&&(a=a.replace(/\//g,"\\")),h=new FileUtils.File(a);try{c=e["@mozilla.org/network/file-input-stream;1"].createInstance(f.nsIFileInputStream),c.init(h,1,0,!1),d=e["@mozilla.org/intl/converter-input-stream;1"].createInstance(f.nsIConverterInputStream),d.init(c,"utf-8",c.available(),f.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),d.readString(c.available(),i),d.close(),c.close(),b(i.value)}catch(j){throw new Error((h&&h.path||"")+": "+j)}}),b}),d("../node_modules/requirejs-text/text!print.style.css",[],function(){return"body > * {\r\n    visibility: hidden;\r\n}\r\nbody {\r\n    overflow: hidden;\r\n}\r\nbody * {\r\n    visibility: hidden !important;\r\n}\r\n\r\n.graphical-report__print-block {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    visibility: visible !important;\r\n    display: block !important;\r\n    width: 100%;\r\n    /*height: 100%;*/\r\n}\r\n"}),function(){function a(b){this.map={};var c=this;b instanceof a?b.forEach(function(a,b){b.forEach(function(b){c.append(a,b)})}):b&&Object.getOwnPropertyNames(b).forEach(function(a){c.append(a,b[a])})}function b(a){return a.bodyUsed?Promise.reject(new TypeError("Already read")):void(a.bodyUsed=!0)}function c(a){return new Promise(function(b,c){a.onload=function(){b(a.result)},a.onerror=function(){c(a.error)}})}function d(a){var b=new FileReader;return b.readAsArrayBuffer(a),c(b)}function e(a){var b=new FileReader;return b.readAsText(a),c(b)}function f(){return this.bodyUsed=!1,l?(this.blob=function(){var a=b(this);return a?a:Promise.resolve(this._bodyBlob)},this.arrayBuffer=function(){return this.blob().then(d)},this.text=function(){return this.blob().then(e)}):this.text=function(){var a=b(this);return a?a:Promise.resolve(this._bodyText)},"FormData"in self&&(this.formData=function(){return this.text().then(i)}),this.json=function(){return this.text().then(JSON.parse)},this}function g(a){var b=a.toUpperCase();return m.indexOf(b)>-1?b:a}function h(b,c){c=c||{},this.url=b,this._body=c.body,this.credentials=c.credentials||"omit",this.headers=new a(c.headers),this.method=g(c.method||"GET"),this.mode=c.mode||null,this.referrer=null}function i(a){var b=new FormData;return a.trim().split("&").forEach(function(a){if(a){var c=a.split("="),d=c.shift().replace(/\+/g," "),e=c.join("=").replace(/\+/g," ");b.append(decodeURIComponent(d),decodeURIComponent(e))}}),b}function j(b){var c=new a,d=b.getAllResponseHeaders().trim().split("\n");return d.forEach(function(a){var b=a.trim().split(":"),d=b.shift().trim(),e=b.join(":").trim();c.append(d,e)}),c}function k(a,b){b||(b={}),l?this._bodyBlob="string"==typeof a?new Blob([a]):a:this._bodyText=a,this.type="default",this.url=null,this.status=b.status,this.statusText=b.statusText,this.headers=b.headers,this.url=b.url||""}if(!self.fetch){a.prototype.append=function(a,b){a=a.toLowerCase();var c=this.map[a];c||(c=[],this.map[a]=c),c.push(b)},a.prototype["delete"]=function(a){delete this.map[a.toLowerCase()]},a.prototype.get=function(a){var b=this.map[a.toLowerCase()];return b?b[0]:null},a.prototype.getAll=function(a){return this.map[a.toLowerCase()]||[]},a.prototype.has=function(a){return this.map.hasOwnProperty(a.toLowerCase())},a.prototype.set=function(a,b){this.map[a.toLowerCase()]=[b]},a.prototype.forEach=function(a){var b=this;Object.getOwnPropertyNames(this.map).forEach(function(c){a(c,b.map[c])})};var l="FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(a){return!1}}(),m=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];h.prototype.fetch=function(){var a=this;return new Promise(function(b,c){function d(){return"responseURL"in e?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):void 0}var e=new XMLHttpRequest;e.onload=function(){var a=1223===e.status?204:e.status;if(100>a||a>599)return void c(new TypeError("Network request failed"));var f={status:a,statusText:e.statusText,headers:j(e),url:d()},g="response"in e?e.response:e.responseText;b(new k(g,f))},e.onerror=function(){c(new TypeError("Network request failed"))},e.open(a.method,a.url),"responseType"in e&&l&&(e.responseType="blob"),a.headers.forEach(function(a,b){b.forEach(function(b){e.setRequestHeader(a,b)})}),e.send(void 0===a._body?null:a._body)})},f.call(h.prototype),f.call(k.prototype),self.Headers=a,self.Request=h,self.Response=k,self.fetch=function(a,b){return new h(a,b).fetch()},self.fetch.polyfill=!0}}(),d("../bower_components/fetch/fetch",function(){}),function(a){"function"==typeof d&&d.amd?d("export",["tauCharts","canvg","FileSaver","promise","print.style.css","fetch"],function(b,c,d,e,f){return window.Promise=window.Promise||e.Promise,a(b,c,d,window.Promise,f)}):a(this.tauCharts,this.canvg,this.saveAs)}(function(a,b,c,d,e){function f(a){return Math.log(a)/Math.LN10}function g(e){return{_createDataUrl:function(a){var c=this._cssPaths.map(function(a){return fetch(a).then(function(a){return a.text()})});return d.all(c).then(function(a){return a.join(" ")}).then(function(c){var d=o(c),e=document.createElement("div"),f=a.getSVG().cloneNode(!0);e.appendChild(f),i.select(f).attr("version",1.1).attr("xmlns","http://www.w3.org/2000/svg"),f.insertBefore(d,f.firstChild),this._renderAdditionalInfo(f,a);var g=document.createElement("canvas");return g.height=f.getAttribute("height"),g.width=f.getAttribute("width"),b(g,f.parentNode.innerHTML),g.toDataURL("image/png")}.bind(this))},_findUnit:function(a){var b=a.getConfig(),c=a.getConfig(),d=function(a){var b=c.scales[a];return b&&b.dim&&b.source&&c.sources[b.source].dims[b.dim]};return k(b.unit,function(a){if(d(a.color))return!0;if(d(a.size)){var b=c.scales[a.size];return"measure"===c.sources[b.source].dims[b.dim].type}})},_toPng:function(a){this._createDataUrl(a).then(function(a){for(var b=atob(a.substring("data:image/png;base64,".length)),d=new Uint8Array(b.length),e=0,f=b.length;f>e;++e)d[e]=b.charCodeAt(e);var g=new Blob([d.buffer],{type:"image/png"});c(g,(this._fileName||"export")+".png")}.bind(this))},_toPrint:function(a){this._createDataUrl(a).then(function(a){h=document.createElement("img"),h.classList.add("graphical-report__print-block");var b=h;document.body.appendChild(b),b.src=a,document.head.appendChild(p),b.onload=function(){window.print()}})},_renderColorLegend:function(a,b,c,d){var f=this._unit.color,g=this._unit.color.dim;a.guide=a.guide||{},a.guide.color=a.guide.color||{};var h=j.isObject(a.guide.color.label)?a.guide.color.label.text:a.guide.color.label,i=h||f.dim,k=this._getColorMap(c.getData({excludeFilter:["legend"]}),f,g).values,l=function(){this.attr("transform",function(a,b){return"translate(5,"+20*(b+1)+")"}),this.append("circle").attr("r",6).attr("class",function(a){return a.color}),this.append("text").attr("x",12).attr("y",5).text(function(a){return j.escape(m(a.label)?"No "+i:a.label)}).style({"font-size":e.fontSize+"px"})},n=b.append("g").attr("class","legend").attr("transform","translate("+(d+10)+","+e.paddingTop+")");return n.append("text").text(i.toUpperCase()).style({"text-transform":"uppercase","font-weight":"600","font-size":e.fontSize+"px"}),n.selectAll("g").data(k).enter().append("g").call(l),{h:20*k.length+20,w:0}},_renderSizeLegend:function(a,b,c,d,g){var h=this._unit.size,i=this._unit.size.scaleDim;a.guide=a.guide||{},a.guide.size=this._unit.config.guide.size;var k,m=a.guide.size.label.text||i,n=j.sortBy(c.getData(),function(a){return h(a[i])}),o=n.length,p=n[0][i],q=n[o-1][i];if(q-p){var r=f(q-p),s=0>4-r?0:Math.round(4-r),t=Math.pow(10,s),u=(q-p)/5;k=j([p,p+u,p+2*u,p+3*u,q]).chain().map(function(a){return a===q||a===p?a:Math.round(a*t)/t}).unique().value()}else k=[p];var v=k.map(function(b){var c=h(b);return{diameter:l(2*c+2),radius:c,value:b,className:a.color?"color-definite":""}}.bind(this)).reverse(),w=Math.max.apply(null,j.pluck(v,"diameter")),x=e.fontSize,y=0,z=function(){this.attr("transform",function(){y+=w;var a="translate(5,"+y+")";return y+=10,a}),this.append("circle").attr("r",function(a){return a.radius}).attr("class",function(a){return a.className}).style({opacity:.4}),this.append("g").attr("transform",function(){return"translate("+w+","+x/2+")"}).append("text").attr("x",function(){return 0}).attr("y",function(){return 0}).text(function(a){return a.value}).style({"font-size":x+"px"})},A=b.append("g").attr("class","legend").attr("transform","translate("+(d+10)+","+(e.paddingTop+g.h+20)+")");A.append("text").text(m.toUpperCase()).style({"text-transform":"uppercase","font-weight":"600","font-size":x+"px"}),A.selectAll("g").data(v).enter().append("g").call(z)},_renderAdditionalInfo:function(a,b){var c=this._findUnit(b);if(c){var d={h:0,w:0},e=b.getConfig();a=i.select(a);{var f=parseInt(a.attr("width"),10);a.attr("height")}a.attr("width",f+160);var g=function(a){var b=e.scales[a];return b&&b.dim&&b.source&&e.sources[b.source].dims[b.dim]};if(g(c.color)){var h=this._renderColorLegend(c,a,b,f);d.h=h.h,d.w=h.w}var e=b.getConfig(),j=e.scales[c.size];c.size&&j.dim&&"measure"===e.sources[j.source].dims[j.dim].type&&this._renderSizeLegend(c,a,b,f,d)}},onUnitDraw:function(b,c){a.api.isChartElement(c)&&(this._unit=c)},_getColorMap:function(a,b,c){return j(a).chain().map(function(a){var d=a[c];return{color:b(d),value:d,label:d}}).uniq(function(a){return a.value}).value().reduce(function(a,b){return a.brewer[b.value]=b.color,a.values.push(b),a},{brewer:{},values:[]})},_select:function(a,b){a=a||"";var c=this["_to"+a.charAt(0).toUpperCase()+a.slice(1)];c&&c.call(this,b)},_handleMenu:function(a,b,c){a.addEventListener("click",function(a){if("a"===a.target.tagName.toLowerCase()){var d=a.target.getAttribute("data-value");this._select(d,b),c.hide()}}.bind(this)),a.addEventListener("mouseover",function(a){"a"===a.target.tagName.toLowerCase()&&a.target.focus()}.bind(this)),a.addEventListener("keydown",function(a){if(a.keyCode===n.ESCAPE&&c.hide(),a.keyCode===n.DOWN&&(a.target.parentNode.nextSibling?a.target.parentNode.nextSibling.childNodes[0].focus():a.target.parentNode.parentNode.firstChild.childNodes[0].focus()),a.keyCode===n.UP&&(a.target.parentNode.previousSibling?a.target.parentNode.previousSibling.childNodes[0].focus():a.target.parentNode.parentNode.lastChild.childNodes[0].focus()),a.keyCode===n.ENTER){var d=a.target.getAttribute("data-value");this._select(d,b)}a.preventDefault()}.bind(this));var d=null,e=t(),f=e?"focusin":"focus",g=e?"focusout":"blur";a.addEventListener(g,function(){d=setTimeout(function(){c.hide()},100)},!e),a.addEventListener(f,function(){clearTimeout(d)},!e),this._container.addEventListener("click",function(){c.toggle(),c.hidden||a.querySelectorAll("a")[0].focus()})},init:function(b){e=e||{},this._cssPaths=e.cssPaths,this._fileName=e.fileName,this._cssPaths||(this._cssPaths=[],a.api.globalSettings.log("You should specified cssPath for correct work export plugin","warn")),e=j.defaults(e,{fontSize:13,paddingTop:30}),this._container=b.insertToHeader('<a class="graphical-report__export">Export</a>>');var c=b.addBalloon({place:"bottom-left"});this._popup=c,c.content(['<ul class="graphical-report__export__list">','<li class="graphical-report__export__item"><a href="#" data-value="print" tabindex="1">Print</a></li>','<li class="graphical-report__export__item"><a href="#" data-value="png" tabindex="2">Export to png</a></li>',"</ul>"].join("")),c.attach(this._container);var d=c.getElement();d.setAttribute("tabindex","-1"),this._handleMenu(d,b,c),b.on("exportTo",function(a,b){this._select(b,a)}.bind(this))},destroy:function(){this._popup&&this._popup.destroy()}}}var h,i=a.api.d3,j=a.api._,k=function(a,b){if(b(a))return a;var c,d,e,f=a.units||[];for(c=0;c<f.length;c+=1)if(d=f[c],e=k(d,b))return e},l=function(a){return a=Math.round(a),a%2?a+1:a},m=function(a){return null===a||""===a||"undefined"==typeof a},n={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},o=function(a,b){b=b||"all";var c=document.createElement("style");return c.setAttribute("media",b),c.innerHTML=a,c},p=o(e,"print"),q=function(){p&&p.parentNode&&p.parentNode.removeChild(p),h&&h.parentNode&&h.parentNode.removeChild(h)},r=/PhantomJS/.test(navigator.userAgent);r||("onafterprint"in window?window.addEventListener("afterprint",q):window.matchMedia("screen").addListener(function(a){a.matches&&q()}));var s,t=function(){function a(){b=!0}if(s)return s;var b=!1,c=document.createElement("a");return c.href="#",c.addEventListener("focusin",a,!1),document.body.appendChild(c),c.focus(),document.body.removeChild(c),s=b,b};return a.api.plugins.add("exportTo",g),g}),d("tauCharts",function(){return a}),c.config({map:{"*":{canvg:"../bower_components/canvg/canvg",FileSaver:"../bower_components/FileSaver.js/FileSaver",rgbcolor:"../bower_components/canvg/rgbcolor",stackblur:"../bower_components/canvg/StackBlur",fetch:"../bower_components/fetch/fetch",promise:"../bower_components/es6-promise/promise","print.style.css":"../node_modules/requirejs-text/text!print.style.css"}}}),c("export")}),function(a){if("function"==typeof define&&define.amd)define(["tauCharts"],function(b){return a(b)});else if("object"==typeof module&&module.exports){var b=require("tauCharts");module.exports=a(b)}else a(this.tauCharts)}(function(a){function b(a){return Math.log(a)/Math.LN10}var c=function(a,b){if(b(a))return a;var d,e,f,g=a.units||[];for(d=0;d<g.length;d+=1)if(e=g[d],f=c(e,b))return f},d=function(a){return a=Math.round(a),a%2?a+1:a},e=a.api._,f=a.api.d3,g=function(a){return null===a||""===a||"undefined"==typeof a},h=function(){return{_delegateEvent:function(a,b,c,d){a.addEventListener(b,function(a){for(var b=a.target;b!==a.currentTarget&&null!==b;)b.classList.contains(c)&&d(a,b),b=b.parentNode})},_findUnit:function(a){var b=a.getConfig(),d=a.getConfig(),e=function(a){var b=d.scales[a];return b&&b.dim&&b.source&&d.sources[b.source].dims[b.dim]};return c(b.unit,function(a){if(e(a.color))return!0;if(e(a.size)){var b=d.scales[a.size];return"measure"===d.sources[b.source].dims[b.dim].type}})},init:function(a){this._isNeedLegend(a)&&(this._currentFilters={},this._storageValues={},this._container=a.insertToRightSidebar(this._containerTemplate),this._delegateEvent(this._container,"click","graphical-report__legend__item-color",function(b,c){this._toggleLegendItem(c,a)}.bind(this)),this._delegateEvent(this._container,"mouseover","graphical-report__legend__item-color",function(b,c){this._highlightToggle(c,a,!0)}.bind(this)),this._delegateEvent(this._container,"mouseout","graphical-report__legend__item-color",function(b,c){this._highlightToggle(c,a,!1)}.bind(this)))},_highlightToggle:function(a,b,c){var d=b.getSVG(),e=f.select(d);if(a.classList.contains("disabled")&&(c=!1),c){var g=a.getAttribute("data-value"),h=this._storageValues[g],i=h.color;e.selectAll(".i-role-element").classed({"graphical-report__highlighted":!1}),e.selectAll(".i-role-element."+i).filter(function(a){var b=a.data.hasOwnProperty(h.dimension)?a.data[h.dimension]:a.data.tags[h.dimension];return b===h.value}).classed({"graphical-report__highlighted":!0}),e.classed({"graphical-report__highlighted_chart":!0})}else e.selectAll(".i-role-element").classed({"graphical-report__highlighted":!1}),e.classed({"graphical-report__highlighted_chart":!1})},_toggleLegendItem:function(a,b){var c=a.getAttribute("data-value"),d=e.keys(this._currentFilters);if(d.length!==this._colorScaleSize-1||this._currentFilters.hasOwnProperty(c))if(this._currentFilters.hasOwnProperty(c)){var f=this._currentFilters[c];delete this._currentFilters[c],a.classList.remove("disabled"),b.removeFilter(f)}else{this._currentFilters[c]=1;var g=this._storageValues[c],h={tag:"legend",predicate:function(a){var b=a[g.dimension];return b!==g.value}};a.classList.add("disabled"),
this._currentFilters[c]=b.addFilter(h)}},_isNeedLegend:function(a){return Boolean(this._findUnit(a))},onUnitDraw:function(b,c){a.api.isChartElement(c)&&(this._unit=c)},_getColorMap:function(a,b,c){return e(a).chain().map(function(a){var d=a[c];return{color:b(d),value:d,label:d}}).uniq(function(a){return a.value}).value().reduce(function(a,b){return a.brewer[b.value]=b.color,a.values.push(b),a},{brewer:{},values:[]})},_containerTemplate:'<div class="graphical-report__legend"></div>',_template:e.template('<div class="graphical-report__legend"><div class="graphical-report__legend__title"><%=name%></div><%=items%></div>'),_itemTemplate:e.template(["<div data-value='<%=value%>' class=\"graphical-report__legend__item graphical-report__legend__item-color <%=classDisabled%>\">",'<div class="graphical-report__legend__guide__wrap"><div class="graphical-report__legend__guide <%=color%>" ></div></div><%=label%>',"</div>"].join("")),_itemSizeTemplate:e.template(['<div class="graphical-report__legend__item graphical-report__legend__item--size">','<div class="graphical-report__legend__guide__wrap">','<svg class="graphical-report__legend__guide graphical-report__legend__guide--size  <%=className%>" style="width: <%=diameter%>px;height: <%=diameter%>px;"><circle cx="<%=radius%>" cy="<%=radius%>" class="graphical-report__dot" r="<%=radius%>"></circle></svg>',"</div><%=value%>","</div>"].join("")),_renderColorLegend:function(a,b){var c=b.getConfig(),d=function(a){var b=c.scales[a];return b&&b.dim&&b.source&&c.sources[b.source].dims[b.dim]};if(d(a.color)){var f=this._unit.color,h=this._unit.color.dim;a.guide=a.guide||{},a.guide.color=a.guide.color||{};var i=e.isObject(a.guide.color.label)?a.guide.color.label.text:a.guide.color.label,j=i||f.dim,k=this._getColorMap(b.getData({excludeFilter:["legend"]}),f,h);b.configGPL.scales[this._unit.config.color].brewer=k.brewer;var l=e.reduce(k.values,function(a,b){var c={dimension:h,value:b.value},d=JSON.stringify(c),f=e.escape(g(b.label)?"No "+j:b.label);return a.items.push(this._itemTemplate({color:b.color,classDisabled:this._currentFilters[d]?"disabled":"",label:f,value:e.escape(d)})),a.storageValues[d]=e.extend({color:b.color},c),a},{items:[],storageValues:{}},this);this._storageValues=l.storageValues,this._container.insertAdjacentHTML("beforeend",this._template({items:l.items.join(""),name:j})),this._colorScaleSize=l.items.length}},_renderSizeLegend:function(a,c){var f=c.getConfig(),g=f.scales[a.size];if(a.size&&g.dim&&"measure"===f.sources[g.source].dims[g.dim].type){var h=this._unit.size,i=this._unit.size.scaleDim;a.guide=a.guide||{},a.guide.size=this._unit.config.guide.size;var j,k=a.guide.size.label.text||i,l=e.sortBy(c.getData(),function(a){return h(a[i])}),m=l.length,n=l[0][i],o=l[m-1][i];if(o-n){var p=b(o-n),q=Math.round(4-p),r=Math.pow(10,q),s=(o-n)/5,t=[n,n+s,n+2*s,n+3*s,o];j=e(t).chain().map(function(a){return a===o||a===n?a:Math.round(a*r)/r}).unique().value()}else j=[n];var u=e.map(j,function(b){var c=h(b);return this._itemSizeTemplate({diameter:d(2*c+2),radius:c,value:b,className:a.color?"color-definite":"color-default-size"})},this).reverse();this._container.insertAdjacentHTML("beforeend",this._template({items:u.join(""),name:k}))}},onRender:function(a){if(this._container){this._container.innerHTML="";var b=this._findUnit(a);this._renderColorLegend(b,a),this._renderSizeLegend(b,a)}}}};return a.api.plugins.add("legend",h),h}),function(a){if("function"==typeof define&&define.amd)define(["tauCharts"],function(b){return a(b)});else if("object"==typeof module&&module.exports){var b=require("tauCharts");module.exports=a(b)}else a(this.tauCharts)}(function(a){function b(b){return b=b||{},{template:['<div class="i-role-content graphical-report__tooltip__content"></div>','<div class="i-role-exclude graphical-report__tooltip__exclude">','<div class="graphical-report__tooltip__exclude__wrap">','<span class="tau-icon-close-gray"></span>Exclude',"</div>","</div>"].join(""),itemTemplate:['<div class="graphical-report__tooltip__list__item">','<div class="graphical-report__tooltip__list__elem"><%=label%></div>','<div class="graphical-report__tooltip__list__elem"><%=value%></div>',"</div>"].join(""),onExcludeData:function(){},_drawPoint:function(a,b,c,d){this.circle&&this.circle.remove(),this.circle=a.append("circle").attr("cx",b).attr("cy",c).attr("class",d).attr("r",4),this.circle.node().addEventListener("mouseover",function(){clearTimeout(this._timeoutHideId)}.bind(this),!1),this.circle.node().addEventListener("mouseleave",function(){this._hide()}.bind(this),!1)},formatters:{},labels:{},init:function(a){this._chart=a,this._dataFields=b.fields,this._getDataFields=b.getFields,c.extend(this,c.omit(b,"fields","getFields")),this._timeoutHideId=null,this._dataWithCoords={},this._unitMeta={},this._templateItem=c.template(this.itemTemplate),this._tooltip=a.addBalloon({spacing:3,auto:!0,effectClass:"fade"}),this._elementTooltip=this._tooltip.getElement();var d=a.getConfig(),e=this._findDimensionGuides(d),f=c.reduce(e,function(a,b,d){return a[d]=c.last(b),a},{}),g=this._generateDefaultFormatters(f,d.scales);c.extend(this.formatters,g);var h=this._generateDefaultLabels(f);c.extend(this.labels,h);var i=this._elementTooltip;i.addEventListener("mouseover",function(){clearTimeout(this._timeoutHideId)}.bind(this),!1),i.addEventListener("mouseleave",function(){this._hide()}.bind(this),!1),i.addEventListener("click",function(a){for(var b=a.target;b!==a.currentTarget&&null!==b;)b.classList.contains("i-role-exclude")&&(this._exclude(),this._hide()),b=b.parentNode}.bind(this),!1),i.insertAdjacentHTML("afterbegin",this.template),this.afterInit(this._elementTooltip)},afterInit:function(){},onUnitDraw:function(b,c){if(a.api.isChartElement(c)){var d=this._generateKey(c.config.options.uid);this._unitMeta[d]=c;var e=c.config.frames.reduce(function(a,b){return a.concat(b.data)},[]);this._dataWithCoords[d]=e.map(function(a){return{x:c.xScale(a[c.xScale.dim]),y:c.yScale(a[c.yScale.dim]),item:a}},this)}},renderItem:function(a,b){return this._templateItem({label:a,value:b})},render:function(a,b){return b=c.unique(b),b.map(function(b){var c=a[b],d=this._getFormatter(b)(c),e=this._getLabel(b);return this.renderItem(e,d,b,c)},this).join("")},afterRender:function(){},onRender:function(a){c.isFunction(this._getDataFields)&&(this._dataFields=this._getDataFields(a)),this._hide()},_getFormatter:function(a){return this.formatters[a]||c.identity},_getLabel:function(a){return this.labels[a]||a},_generateDefaultLabels:function(a){return c.reduce(a,function(a,b,c){return b.label?(a[c]=b.label,b.label.hasOwnProperty("text")&&(a[c]=b.label.text)):a[c]=c,a},{})},_generateDefaultFormatters:function(b){return c.reduce(b,function(b,c,d){var e=function(b){if(null==b)return null;var d=c.tickPeriod||c.tickFormat;if(d){var e="x-time-auto"===d?"day":d;return a.api.tickFormat.get(e)(b)}return c.tickLabel?b[c.tickLabel]:b};return b[d]=function(a){var b=e(a);return null==b?"No "+c.label:b},b},{})},_findDimensionGuides:function(a){var b={},c=a.scales,d=function(a,d){var e=d[a];if(e){var f=(d.guide||{})[a],g=c[e].dim;if(g&&f){var h=f.tickLabel?g.replace(new RegExp("\\."+f.tickLabel),""):g;b[h]||(b[h]=[]),b[h].push(f)}}};return f(a.unit,function(a){return d("x",a),d("y",a),d("color",a),d("size",a),!1}),b},_exclude:function(){this._chart.addFilter({tag:"exclude",predicate:function(a){return function(b){return JSON.stringify(b)!==JSON.stringify(a)}}(this._currentElement)}),this.onExcludeData(this._currentElement)},_calculateLength:function(a,b,c,d){return(c-a)*(c-a)+(d-b)*(d-b)},_calculateLengthToLine:function(a,b,c,d,f,g){var h={x:c-a,y:d-b},i={x:f-a,y:g-b},j=h.x*i.x+h.y*i.y;if(0>j)return e(a,f,b,g);var k={x:a-c,y:b-d},l={x:f-c,y:g-d},m=k.x*l.x+k.y*l.y;return 0>m?e(c,f,d,g):Math.abs(((c-a)*(g-b)-(d-b)*(f-a))/e(a,c,b,d))},_generateKey:function(a){return JSON.stringify(a)},_getFields:function(a){if(this._dataFields)return this._dataFields;for(var b=[a.size&&a.size.dim,a.color&&a.color.dim],d=[],e=[];a=a.parentUnit;)d.push(a.xScale.dim),e.push(a.yScale.dim);return c.compact(b.concat(e,d).reverse())},_handleLineElement:function(a,b,e){var f=a.elementData,g=this._dataWithCoords[b],h=g.filter(function(a){return c.contains(f.data,a.item)});if(1===h.length)return h[0].item;var i=c.reduce(h,function(a,b,c,d){var f;if(c+1===d.length){var g=b;b=d[c-1],f=g}else f=d[c+1];var h=this._calculateLengthToLine(b.x,b.y,f.x,f.y,e[0],e[1]);return h<a.h&&(a.h=h,a.points={point1:b,point2:f}),a}.bind(this),{h:1/0,points:{}}),j=c.min(i.points,function(a){return this._calculateLength(a.x,a.y,e[0],e[1])},this);return this._drawPoint(d.select(a.element.parentNode),j.x,j.y,this._unitMeta[b].color(a.elementData.tags[this._unitMeta[b].color.dim])),j.item},_onElementMouseOver:function(b,c,d,e){clearTimeout(this._timeoutHideId);var f=this._generateKey(c.unit&&c.unit.config.options.uid),g=c.elementData;if(a.api.isLineElement(c.unit)&&(g=this._handleLineElement(c,f,d)),this._currentElement!==g){var h=this._elementTooltip.querySelectorAll(".i-role-content");if(h[0]){var i=this._getFields(this._unitMeta[f]);h[0].innerHTML=this.render(g,i)}else console.log("template should contain i-role-content class");this._show(e),this._currentElement=g}},onElementMouseOver:function(a,b){var e=d.mouse(document.body),f=d.mouse(b.element);clearTimeout(this._timeoutShowId),this._timeoutShowId=c.delay(this._onElementMouseOver.bind(this),200,a,b,f,e)},onElementMouseOut:function(){this._hide()},_show:function(a){this._tooltip.show(a[0],a[1]).updateSize()},_hide:function(){clearTimeout(this._timeoutShowId),this._timeoutHideId=setTimeout(function(){this._currentElement=null,this._tooltip.hide(),this.circle&&this.circle.remove()}.bind(this),300)},_destroyTooltip:function(){this.circle&&this.circle.remove(),this._tooltip.destroy()},destroy:function(){this._destroyTooltip()}}}var c=a.api._,d=a.api.d3,e=function(a,b,c,d){return Math.sqrt((b-a)*(b-a)+(d-c)*(d-c))},f=function(a,b){if(b(a))return a;var c,d,e,g=a.units||[];for(c=0;c<g.length;c+=1)if(d=g[c],e=f(d,b))return e};return a.api.plugins.add("tooltip",b),b}),function(a){if("function"==typeof define&&define.amd)define(["tauCharts"],function(b){return a(b)});else if("object"==typeof module&&module.exports){var b=require("tauCharts");module.exports=a(b)}else a(this.tauCharts)}(function(a){function b(a){var b=d.defaults(a||{},{type:"linear",hideError:!1,showPanel:!0,showTrend:!0,models:["linear","exponential","logarithmic"]});return{init:function(a){if(this._chart=a,this._isApplicable=this.checkIfApplicable(a),b.showPanel){this._container=a.insertToRightSidebar(this.containerTemplate);var c="applicable-true";this._isApplicable||(c="applicable-false",this._error=["Trend line can't be computed for categorical data.","Each axis should be either a measure or a date."].join(" ")),this._container.classList.add(c),b.hideError&&this._container.classList.add("hide-trendline-error"),this.uiChangeEventsDispatcher=function(a){var c=a.target,d=c.classList;d.contains("i-role-show-trend")&&(b.showTrend=c.checked),d.contains("i-role-change-model")&&(b.type=c.value),this._chart.refresh()}.bind(this),this._container.addEventListener("change",this.uiChangeEventsDispatcher,!1)}},checkIfApplicable:function(a){var b=this,c=a.getConfig(),d=!1;return a.traverseSpec(c,function(a,e){b.predicateIsApplicable(c,a,e)&&(d=!0)}),d},predicateIsApplicable:function(a,b,c){if(c&&"COORDS.RECT"!==c.type)return!1;if(-1===b.type.indexOf("ELEMENT."))return!1;var d=a.scales[b.x],e=a.scales[b.y];return"ordinal"===d.type||"ordinal"===e.type?!1:!0},onSpecReady:function(a,e){var f=this;b.showTrend&&(e.transformations=e.transformations||{},e.transformations.regression=function(a,b){var e=b.x,f=b.y,g=a.map(function(a){var b=d.isDate(a[e])?a[e].getTime():a[e],c=d.isDate(a[f])?a[f].getTime():a[f];return[b,c]}),h=c(b.type,g),i=d(h.points).chain().filter(function(a){return null!==a[0]&&null!==a[1]}).sortBy(function(a){return a[0]}).map(function(a){var b={};return b[e]=a[0],b[f]=a[1],b}).value();return i.length>1?i:[]},a.traverseSpec(e,function(a,c){if(f.predicateIsApplicable(e,a,c)){var d=e.scales[a.x],g=e.scales[a.y],h=JSON.parse(JSON.stringify(a));h.type="ELEMENT.LINE",h.transformation=h.transformation||[],h.transformation.push({type:"regression",args:{type:b.type,x:d.dim,y:g.dim}}),h.guide=h.guide||{},h.guide.cssClass="graphical-report__trendline",h.guide.widthCssClass="graphical-report__line-width-1",c.units.push(h)}}))},containerTemplate:'<div class="graphical-report__trendlinepanel"></div>',template:d.template(['<label class="graphical-report__trendlinepanel__title graphical-report__checkbox">','<input type="checkbox" class="graphical-report__checkbox__input i-role-show-trend" <%= showTrend %> />','<span class="graphical-report__checkbox__icon"></span>','<span class="graphical-report__checkbox__text">',"<%= title %>","</span>","</label>","<div>",'<select class="i-role-change-model graphical-report__select graphical-report__trendlinepanel__control">',"<%= models %> />","</select>","</div>",'<div class="graphical-report__trendlinepanel__error-message"><%= error %></div>'].join("")),onRender:function(a){if(this._container){this._container.innerHTML=this.template({title:"Trend line",error:this._error,showTrend:b.showTrend&&this._isApplicable?"checked":"",models:b.models.map(function(a){var c=b.type===a?"selected":"";return"<option "+c+' value="'+a+'">'+a+"</option>"})});var c=function(a){return function(){e.select(this).classed({active:a,"graphical-report__line-width-1":!a,"graphical-report__line-width-3":a})}},d=e.select(a.getSVG());d.selectAll(".graphical-report__trendline").on("mouseenter",c(!0)).on("mouseleave",c(!1))}}}}var c=function(){"use strict";var a=function(a,b){var c=0,d=0,e=0,f=0,g=0,h=a.length-1,i=new Array(b);for(c=0;h>c;c++){for(f=c,d=c+1;h>d;d++)Math.abs(a[c][d])>Math.abs(a[c][f])&&(f=d);for(e=c;h+1>e;e++)g=a[e][c],a[e][c]=a[e][f],a[e][f]=g;for(d=c+1;h>d;d++)for(e=h;e>=c;e--)a[e][d]-=a[e][c]*a[c][d]/a[c][c]}for(d=h-1;d>=0;d--){for(g=0,e=d+1;h>e;e++)g+=a[e][d]*i[e];i[d]=(a[h][d]-g)/a[d][d]}return i},b={linear:function(a){for(var b=[0,0,0,0,0],c=0,d=[];c<a.length;c++)a[c][1]&&(b[0]+=a[c][0],b[1]+=a[c][1],b[2]+=a[c][0]*a[c][0],b[3]+=a[c][0]*a[c][1],b[4]+=a[c][1]*a[c][1]);var e=(c*b[3]-b[0]*b[1])/(c*b[2]-b[0]*b[0]);e=isNaN(e)?0:e;for(var f=b[1]/c-e*b[0]/c,g=0,h=a.length;h>g;g++){var i=[a[g][0],a[g][0]*e+f];d.push(i)}var j="y = "+Math.round(100*e)/100+"x + "+Math.round(100*f)/100;return{equation:[e,f],points:d,string:j}},exponential:function(a){var b=[0,0,0,0,0,0],c=0,d=[];for(i=a.length;i>c;c++)a[c][1]&&(b[0]+=a[c][0],b[1]+=a[c][1],b[2]+=a[c][0]*a[c][0]*a[c][1],b[3]+=a[c][1]*Math.log(a[c][1]),b[4]+=a[c][0]*a[c][1]*Math.log(a[c][1]),b[5]+=a[c][0]*a[c][1]);for(var e=b[1]*b[2]-b[5]*b[5],f=Math.pow(Math.E,(b[2]*b[3]-b[5]*b[4])/e),g=(b[1]*b[4]-b[5]*b[3])/e,h=0,i=a.length;i>h;h++){var j=[a[h][0],f*Math.pow(Math.E,g*a[h][0])];d.push(j)}var k="y = "+Math.round(100*f)/100+"e^("+Math.round(100*g)/100+"x)";return{equation:[f,g],points:d,string:k}},logarithmic:function(a){var b=[0,0,0,0],c=0,d=[];for(h=a.length;h>c;c++)a[c][1]&&(b[0]+=Math.log(a[c][0]),b[1]+=a[c][1]*Math.log(a[c][0]),b[2]+=a[c][1],b[3]+=Math.pow(Math.log(a[c][0]),2));for(var e=(c*b[1]-b[2]*b[0])/(c*b[3]-b[0]*b[0]),f=(b[2]-e*b[0])/c,g=0,h=a.length;h>g;g++){var i=[a[g][0],f+e*Math.log(a[g][0])];d.push(i)}var j="y = "+Math.round(100*f)/100+" + "+Math.round(100*e)/100+" ln(x)";return{equation:[f,e],points:d,string:j}},power:function(a){var b=[0,0,0,0],c=0,d=[];for(h=a.length;h>c;c++)a[c][1]&&(b[0]+=Math.log(a[c][0]),b[1]+=Math.log(a[c][1])*Math.log(a[c][0]),b[2]+=Math.log(a[c][1]),b[3]+=Math.pow(Math.log(a[c][0]),2));for(var e=(c*b[1]-b[2]*b[0])/(c*b[3]-b[0]*b[0]),f=Math.pow(Math.E,(b[2]-e*b[0])/c),g=0,h=a.length;h>g;g++){var i=[a[g][0],f*Math.pow(a[g][0],e)];d.push(i)}var j="y = "+Math.round(100*f)/100+"x^"+Math.round(100*e)/100;return{equation:[f,e],points:d,string:j}},polynomial:function(b,c){"undefined"==typeof c&&(c=2);for(var d=[],e=[],f=[],g=0,h=0,i=0,j=c+1;j>i;i++){for(var k=0,l=b.length;l>k;k++)b[k][1]&&(g+=Math.pow(b[k][0],i)*b[k][1]);d.push(g),g=0;for(var m=[],n=0;j>n;n++){for(var k=0,l=b.length;l>k;k++)b[k][1]&&(h+=Math.pow(b[k][0],i+n));m.push(h),h=0}e.push(m)}e.push(d);for(var o=a(e,j),i=0,l=b.length;l>i;i++){for(var p=0,q=0;q<o.length;q++)p+=o[q]*Math.pow(b[i][0],q);f.push([b[i][0],p])}for(var r="y = ",i=o.length-1;i>=0;i--)r+=i>1?Math.round(100*o[i])/100+"x^"+i+" + ":1==i?Math.round(100*o[i])/100+"x + ":Math.round(100*o[i])/100;return{equation:o,points:f,string:r}},lastvalue:function(a){for(var b=[],c=null,d=0;d<a.length;d++)a[d][1]?(c=a[d][1],b.push([a[d][0],a[d][1]])):b.push([a[d][0],c]);return{equation:[c],points:b,string:""+c}},loess:function(a){function b(a,b){var d=a.map(function(a){return a[0]}),e=a.map(function(a){return a[1]}),f=c(d,e,b);return d.map(function(a,b){return[a,f[b]]})}function c(a,b,c){function d(a){var b=1-a*a*a;return b*b*b}for(var e=[],f=0,g=Math.floor(c*a.length)-1,h=0;h<a.length;h++){var i=a[h];h>0&&g<a.length-1&&a[g+1]-a[h]<a[h]-a[f]&&(f++,g++);var j;j=a[h]-a[f]>a[g]-a[h]?f:g;for(var k=Math.abs(1/(a[j]-i)),l=0,m=0,n=0,o=0,p=0,q=f;g>=q;){var r,s=a[q],t=b[q];r=h>q?i-s:s-i;var u=d(r*k),v=s*u;l+=u,m+=v,n+=s*v,o+=t*u,p+=t*v,q++}var w,x=m/l,y=o/l,z=p/l,A=n/l;w=A==x*x?0:(z-x*y)/(A-x*x);var B=y-w*x;e[h]=w*i+B}return e}return{equation:"loess",points:b(a,.5),string:"loess"}}};return function(a,c,d){return"string"==typeof a?b[a](c,d):void 0}}(),d=a.api._,e=a.api.d3;return a.api.plugins.add("trendline",b),b});