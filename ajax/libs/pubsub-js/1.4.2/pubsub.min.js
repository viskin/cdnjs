(function(a,b){if(typeof exports==="object"&&module){module.exports=b()}else{if(typeof define==="function"&&define.amd){define(b)}else{a.PubSub=b()}}}((typeof window==="object"&&window)||this,function(){var k={},e={},i=-1;function h(m){var l;for(l in m){if(m.hasOwnProperty(l)){return true}}return false}function j(m){return function l(){throw m}}function b(m,n,o){try{m(n,o)}catch(l){setTimeout(j(l),0)}}function f(l,m,n){l(m,n)}function d(m,o,p,r){var q=e[o],l=r?f:b,n;if(!e.hasOwnProperty(o)){return}for(n in q){if(q.hasOwnProperty(n)){l(q[n],m,p)}}}function c(l,m,o){return function n(){var q=String(l),p=q.lastIndexOf(".");d(l,l,m,o);while(p!==-1){q=q.substr(0,p);p=q.lastIndexOf(".");d(l,q,m)}}}function g(n){var m=String(n),o=Boolean(e.hasOwnProperty(m)&&h(e[m])),l=m.lastIndexOf(".");while(!o&&l!==-1){m=m.substr(0,l);l=m.lastIndexOf(".");o=Boolean(e.hasOwnProperty(m)&&h(e[m]))}return o}function a(n,o,m,q){var p=c(n,o,q),l=g(n);if(!l){return false}if(m===true){p()}else{setTimeout(p,0)}return true}k.publish=function(l,m){return a(l,m,false,k.immediateExceptions)};k.publishSync=function(l,m){return a(l,m,true,k.immediateExceptions)};k.subscribe=function(n,m){if(typeof m!=="function"){return false}if(!e.hasOwnProperty(n)){e[n]={}}var l="uid_"+String(++i);e[n][l]=m;return l};k.unsubscribe=function(s){var r=typeof s==="string",n=false,l,q,p,o;for(l in e){if(e.hasOwnProperty(l)){q=e[l];if(r&&q[s]){delete q[s];n=s;break}else{if(!r){for(p in q){if(q.hasOwnProperty(p)&&q[p]===s){delete q[p];n=true}}}}}}return n};return k}));